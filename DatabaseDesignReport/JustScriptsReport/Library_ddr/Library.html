<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title></title>
<link href="Styles.css" type="text/css" rel="stylesheet">
</head>
<body>
<p>
<span class="partheading"><a name="valFileOptionOverviewSectionAnchor_"/>Library.fp7</span>
</p>
<table width="100%" border="1">
<tbody>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Overview</td><td class="chartsubheads" width="1%">&nbsp;</td><td class="chartsubheads" colSpan="2">File Options</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg" width="32%">Tables</td><td class="regularcharttext" width="8%"><a href="#valTablesSectionAnchor_">12</a></td><td class="regularcharttext">&nbsp;</td><td class="chartheadersnobg" width="%26">Default custom menu set</td><td class="regularcharttext" width="33%">HGT</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Relationships</td><td class="regularcharttext">0</td><td class="regularcharttext">&nbsp;</td><td class="chartsubheads" colSpan="2">When opening file</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts</td><td class="regularcharttext">0</td><td class="regularcharttext">&nbsp;</td><td class="chartheadersnobg" width="%26">Login using</td><td class="regularcharttext" width="33%">Account Name; Account= Normal</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts</td><td class="regularcharttext"><a href="#valScriptsSectionAnchor_">303</a></td><td class="regularcharttext">&nbsp;</td><td class="chartheadersnobg">Switch to layout</td><td class="regularcharttext">defaultSetup</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Value Lists</td><td class="regularcharttext">0</td><td class="regularcharttext">&nbsp;</td><td class="chartheadersnobg">Perform script</td><td class="regularcharttext"><a href="#33086ScriptAnchor_">startDatabase</a></td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions</td><td class="regularcharttext">0</td><td class="regularcharttext">&nbsp;</td><td class="chartsubheads" colSpan="2">When closing file</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Accounts</td><td class="regularcharttext">0</td><td class="regularcharttext">&nbsp;</td><td class="chartheadersnobg">Perform script</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Privilege Sets</td><td class="regularcharttext">0</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Extended Privileges</td><td class="regularcharttext">0</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">FileMaker Data Sources</td><td class="regularcharttext">0</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">ODBC Data Sources</td><td class="regularcharttext">0</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Menu Sets</td><td class="regularcharttext">0</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Menus</td><td class="regularcharttext">0</td>
</tr>
</tbody>
</table>

<p>
<span class="partheading"><a name="valTablesSectionAnchor_"/>Tables</span>
</p>
<table width="95%" border="1">
<tbody>
<tr class="chartheaders" vAlign="top">
<td width="15%">Table Name</td><td width="29%">
<div align="left">Statistics</div>
</td><td width="29%">Occurrences in Relationship Graph</td>
</tr>
<tr class="regularcharttext" vAlign="top">
<td><a href="#32790BaseTableAnchor_">tagGroup</a></td><td>
<div align="left"><a href="#32790BaseTableAnchor_">14 fields</a> defined, 29 records</div>
</td><td></td>
</tr>
<tr class="regularcharttext" vAlign="top">
<td><a href="#32787BaseTableAnchor_">tag</a></td><td>
<div align="left"><a href="#32787BaseTableAnchor_">25 fields</a> defined, 106 records</div>
</td><td></td>
</tr>
<tr class="regularcharttext" vAlign="top">
<td><a href="#32774BaseTableAnchor_">test</a></td><td>
<div align="left"><a href="#32774BaseTableAnchor_">21 fields</a> defined, 1 record</div>
</td><td></td>
</tr>
<tr class="regularcharttext" vAlign="top">
<td><a href="#32788BaseTableAnchor_">testSubjectFocus</a></td><td>
<div align="left"><a href="#32788BaseTableAnchor_">14 fields</a> defined, 0 record</div>
</td><td></td>
</tr>
<tr class="regularcharttext" vAlign="top">
<td><a href="#32777BaseTableAnchor_">testlearn</a></td><td>
<div align="left"><a href="#32777BaseTableAnchor_">59 fields</a> defined, 131 records</div>
</td><td></td>
</tr>
<tr class="regularcharttext" vAlign="top">
<td><a href="#32797BaseTableAnchor_">learnWebsite</a></td><td>
<div align="left"><a href="#32797BaseTableAnchor_">5 fields</a> defined, 0 record</div>
</td><td></td>
</tr>
<tr class="regularcharttext" vAlign="top">
<td><a href="#32793BaseTableAnchor_">reference</a></td><td>
<div align="left"><a href="#32793BaseTableAnchor_">83 fields</a> defined, 110 records</div>
</td><td></td>
</tr>
<tr class="regularcharttext" vAlign="top">
<td><a href="#32779BaseTableAnchor_">report</a></td><td>
<div align="left"><a href="#32779BaseTableAnchor_">36 fields</a> defined, 0 record</div>
</td><td></td>
</tr>
<tr class="regularcharttext" vAlign="top">
<td><a href="#32789BaseTableAnchor_">TEMP</a></td><td>
<div align="left"><a href="#32789BaseTableAnchor_">91 fields</a> defined, 1 record</div>
</td><td></td>
</tr>
<tr class="regularcharttext" vAlign="top">
<td><a href="#32775BaseTableAnchor_">backup</a></td><td>
<div align="left"><a href="#32775BaseTableAnchor_">3 fields</a> defined, 1 record</div>
</td><td></td>
</tr>
<tr class="regularcharttext" vAlign="top">
<td><a href="#32791BaseTableAnchor_">locationListTEMP</a></td><td>
<div align="left"><a href="#32791BaseTableAnchor_">1 field</a> defined, 7 records</div>
</td><td></td>
</tr>
<tr class="regularcharttext" vAlign="top">
<td><a href="#32798BaseTableAnchor_">referenceType</a></td><td>
<div align="left"><a href="#32798BaseTableAnchor_">33 fields</a> defined, 89 records</div>
</td><td></td>
</tr>
</tbody>
</table>
<p>
<span class="partheading"><a name="valFieldsSectionAnchor_"/>Fields</span>
</p>
		<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td colSpan="9">Table Name: <a name="32790BaseTableAnchor_"/>tagGroup - 14 Fields</td>
</tr>
<tr class="chartheaders" vAlign="top">
<td width="8%">Field Name</td><td width="7%">Type</td><td width="14%">Options</td><td width="10%">Comments</td><td width="13%">On Layouts</td><td width="15%">In Relationships</td><td width="22%">In Scripts</td><td width="11%">In Value Lists</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327901FieldAnchor_"/>_Lgroup</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Do not replace existing value for field (if any)</li>
<li>Context table: <em>groupTest</em>
<br>Calculation: <strong>Month</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) &amp; 
(<strong>If</strong> ( <strong>Day</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) &gt; 9 ; <strong>Day</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) ; 0 &amp;  (<strong>Day</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) ) ) )&amp; 
<strong>Year</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) &amp;
(<strong>If</strong> ( <strong>Hour</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) &gt; 9 ; <strong>Hour</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ; 0 &amp;  (<strong>Hour</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ) ) )&amp;  
(<strong>If</strong> ( <strong>Minute</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) )&gt; 9 ; <strong>Minute</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ; 0 &amp;  (<strong>Minute</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ) ) )&amp;  
(<strong>If</strong> ( <strong>Seconds</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) &gt; 9 ; <strong>Seconds</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ; 0 &amp;  (<strong>Seconds</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ) ) )&amp;  
<em>groupTest</em>::_Number</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
<li>Not empty</li>
<li>Unique</li>
<li>Strict validation</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327902FieldAnchor_"/>_Number</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
<li>Serial: Generate: On creation, Next value: 89, Increment: 1</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327907FieldAnchor_"/>match</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
<li>Index Language: English</li>
</ul>
</td><td>matchFieldLibraryThemeLocationLibrarySectionEtc</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327908FieldAnchor_"/>name</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
<li>Strict validation</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
<li>Index Language: English</li>
</ul>
</td><td>itemNameWhichIsReallyATagButSeemsBetterHereSpaceWiseThanPuttingTheseTagsInMainTagTable</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279025FieldAnchor_"/>nameSpelling</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
<li>Strict validation</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
<li>Index Language: English</li>
</ul>
</td><td>usedToRememberOldSpellingWhenSpellingOfNameIsChanged</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279024FieldAnchor_"/>order</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279010FieldAnchor_"/>ksection</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td>sectionRulesBelongTo</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279011FieldAnchor_"/>defaultSectionInfo</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279012FieldAnchor_"/>testReportPicture</td><td>Normal, Binary</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
</ul>
</td><td>seenOnTheIntroductoryPageInTheReportForTheTest</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279013FieldAnchor_"/>CaptionORinuseCheck</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>seenOnTheIntroductoryPageInTheReportForTheTestORusedToDetermineIfTestItemIsInUse</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279014FieldAnchor_"/>URLORHealth</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>seenOnTheIntroductoryPageInTheReportForTheTest</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279026FieldAnchor_"/>kRecordCreatorNode</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279027FieldAnchor_"/>kSectionCreatorNodesCreator</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279028FieldAnchor_"/>aboutSection</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>seenOnTheIntroductoryPageInTheReportForTheTestORinfoDescribingAuthorsOfSectionAndUsersRights</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
		</tbody>
</table>
	<br>
		<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td colSpan="9">Table Name: <a name="32787BaseTableAnchor_"/>tag - 25 Fields</td>
</tr>
<tr class="chartheaders" vAlign="top">
<td width="8%">Field Name</td><td width="7%">Type</td><td width="14%">Options</td><td width="10%">Comments</td><td width="13%">On Layouts</td><td width="15%">In Relationships</td><td width="22%">In Scripts</td><td width="11%">In Value Lists</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327872FieldAnchor_"/>_Ltag</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
<li>Do not replace existing value for field (if any)</li>
<li>Context table: <em>tagLocation</em>
<br>Calculation: <strong>Month</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) &amp; 
(<strong>If</strong> ( <strong>Day</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) &gt; 9 ; <strong>Day</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) ; 0 &amp;  (<strong>Day</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) ) ) )&amp; 
<strong>Year</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) &amp;
(<strong>If</strong> ( <strong>Hour</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) &gt; 9 ; <strong>Hour</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ; 0 &amp;  (<strong>Hour</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ) ) )&amp;  
(<strong>If</strong> ( <strong>Minute</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) )&gt; 9 ; <strong>Minute</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ; 0 &amp;  (<strong>Minute</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ) ) )&amp;  
(<strong>If</strong> ( <strong>Seconds</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) &gt; 9 ; <strong>Seconds</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ; 0 &amp;  (<strong>Seconds</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ) ) )&amp;  
<em>tagLocation</em>::_Number</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
<li>Not empty</li>
<li>Unique</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278712FieldAnchor_"/>_Number</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
<li>Serial: Generate: On creation, Next value: 935, Increment: 1</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278730FieldAnchor_"/>kfile</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 3</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327877FieldAnchor_"/>ksection</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278726FieldAnchor_"/>kcsection</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>KeyChainlistOfKeysUsedToShowTagInMoreThanOneSection</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327871FieldAnchor_"/>kGroupOrTest</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td>FocusAndAttributeGroupKeysAndNamesComeFromGroupTableWhileTestKeysAndNamesComeFromTestTable</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278723FieldAnchor_"/>match</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
<li>Index Language: English</li>
</ul>
</td><td>matchFieldUsedByCitationMenusToShowOnlyRelevantInformation</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278728FieldAnchor_"/>notesOrHealth</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327876FieldAnchor_"/>orderOrLock</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td>orderORsectionLockUsedToPreventChangesByAnyoneButNodeCreator</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327873FieldAnchor_"/>tag</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278724FieldAnchor_"/>tagSpelling</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>usedBySystemToCheckIfUserChangedSpellingAfterSavingRecordAndIfDidSystemFindsAllRecordsWIthOldSpellingAndUpdatesThem</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278727FieldAnchor_"/>Kpicture1</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>pictureOfTag</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278733FieldAnchor_"/>pictureFileName1</td><td>Calculated, Text</td><td><strong>Calculation:</strong>
<ul>
<li>Context table: <em>tagMenus</em>
</li>
<li>
<strong>Case</strong> ( <strong>FilterValues</strong> ( <em>citationPicture1</em>::kfileLocation ; "8162011225532313" )  = "8162011225532313"  &amp; &para;;   <strong>Substitute</strong> ( <strong>Case</strong> ( <strong>Get</strong> ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; <strong>Middle</strong> ( <strong>Get</strong> ( FilePath ) ; 6 ; <strong>Length</strong> ( <strong>Get</strong> (FilePath ) ) - <strong>Length</strong> ( <strong>Get</strong> (FileName ) ) - 9) &amp; "x/" &amp; <em>citationPicture1</em>::fileName ; " " ; "%20" ) ; 

<strong>FilterValues</strong> ( <em>citationPicture1</em>::kfileLocation ; "8162011225558314" )  = "8162011225558314" &amp; &para;; <strong>Substitute</strong> ( <strong>Case</strong> ( <strong>Get</strong> ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; <strong>Middle</strong> ( <strong>Get</strong> ( FilePath ) ; 6 ; <strong>Length</strong> ( <strong>Get</strong> (FilePath ) ) - <strong>Length</strong> ( <strong>Get</strong> (FileName ) ) - 9) &amp; <em>citationPicture1</em>::fileName ; " " ; "%20" ) ; 

<strong>FilterValues</strong> ( <em>citationPicture1</em>::kfileLocation ; "8162011225605315" )  = "8162011225605315"   &amp; &para;; 

<strong>Substitute</strong> ( <strong>Case</strong> ( <strong>Get</strong> ( SystemPlatform ) =  - 2 ; "file:/" ; "file:///" ) &amp; <em>tagPathPicture1_button</em>::tag ; " " ; "%20" ) &amp;

<strong>Case</strong> ( <strong>Left</strong> ( <em>citationPicture1</em>::fileName ; 1 ) =  "/" ; <strong>Substitute</strong> ( <em>citationPicture1</em>::fileName ; " " ; "%20" ) ;

 "/" &amp; <strong>Substitute</strong> ( <em>citationPicture1</em>::fileName ; " " ; "%20" ) ) ; 


<strong>//from testlearn table
</strong>

<strong>FilterValues</strong> ( <em>TLPicture1</em>::kfileLocation ; "8162011225532313" )  = "8162011225532313"  &amp; &para;;   <strong>Substitute</strong> ( <strong>Case</strong> ( <strong>Get</strong> ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; <strong>Middle</strong> ( <strong>Get</strong> ( FilePath ) ; 6 ; <strong>Length</strong> ( <strong>Get</strong> (FilePath ) ) - <strong>Length</strong> ( <strong>Get</strong> (FileName ) ) - 9) &amp; "x/" &amp; <em>TLPicture1</em>::filename ; " " ; "%20" ) ; 

<strong>FilterValues</strong> ( <em>TLPicture1</em>::kfileLocation ; "8162011225558314" )  = "8162011225558314" &amp; &para;; <strong>Substitute</strong> ( <strong>Case</strong> ( <strong>Get</strong> ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; <strong>Middle</strong> ( <strong>Get</strong> ( FilePath ) ; 6 ; <strong>Length</strong> ( <strong>Get</strong> (FilePath ) ) - <strong>Length</strong> ( <strong>Get</strong> (FileName ) ) - 9) &amp; <em>TLPicture1</em>::filename ; " " ; "%20" ) ; 

<strong>FilterValues</strong> ( <em>TLPicture2</em>::kfileLocation ; "8162011225605315" )  = "8162011225605315"   &amp; &para;; <em>tagTLPathPicture1_button</em>::tag &amp; <em>TLPicture1</em>::filename ; 

"")</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Do not store calculation results</li>
<li>Index Language: English</li>
</ul>
</td><td>dueToFilemakerWebViewerOnlySeeingFieldsNativeToLayoutThisCalcIsRequiredToDuplicateRelatedFieldInfo</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278735FieldAnchor_"/>Kpicture2</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>pictureOfTag</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278736FieldAnchor_"/>pictureFileName2</td><td>Calculated, Text</td><td><strong>Calculation:</strong>
<ul>
<li>Context table: <em>tagMenus</em>
</li>
<li>
<strong>Case</strong> ( <strong>FilterValues</strong> ( <em>citationPicture2</em>::kfileLocation ; "8162011225532313" )  = "8162011225532313"  &amp; &para;;   <strong>Substitute</strong> ( <strong>Case</strong> ( <strong>Get</strong> ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; <strong>Middle</strong> ( <strong>Get</strong> ( FilePath ) ; 6 ; <strong>Length</strong> ( <strong>Get</strong> (FilePath ) ) - <strong>Length</strong> ( <strong>Get</strong> (FileName ) ) - 9) &amp; "x/" &amp; <em>citationPicture2</em>::fileName ; " " ; "%20" ) ; 

<strong>FilterValues</strong> ( <em>citationPicture2</em>::kfileLocation ; "8162011225558314" )  = "8162011225558314" &amp; &para;; <strong>Substitute</strong> ( <strong>Case</strong> ( <strong>Get</strong> ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; <strong>Middle</strong> ( <strong>Get</strong> ( FilePath ) ; 6 ; <strong>Length</strong> ( <strong>Get</strong> (FilePath ) ) - <strong>Length</strong> ( <strong>Get</strong> (FileName ) ) - 9) &amp; <em>citationPicture2</em>::fileName ; " " ; "%20" ) ; 

<strong>FilterValues</strong> ( <em>citationPicture2</em>::kfileLocation ; "8162011225605315" )  = "8162011225605315"   &amp; &para;; 

<strong>Substitute</strong> ( <strong>Case</strong> ( <strong>Get</strong> ( SystemPlatform ) =  - 2 ; "file:/" ; "file:///" ) &amp; <em>tagPathPicture2_button</em>::tag ; " " ; "%20" ) &amp;

<strong>Case</strong> ( <strong>Left</strong> ( <em>citationPicture2</em>::fileName ; 1 ) =  "/" ; <strong>Substitute</strong> ( <em>citationPicture2</em>::fileName ; " " ; "%20" ) ;

 "/" &amp; <strong>Substitute</strong> ( <em>citationPicture2</em>::fileName ; " " ; "%20" ) )  ; 


<strong>//from testlearn table
</strong>

<strong>FilterValues</strong> ( <em>TLPicture2</em>::kfileLocation ; "8162011225532313" )  = "8162011225532313"  &amp; &para;;   <strong>Substitute</strong> ( <strong>Case</strong> ( <strong>Get</strong> ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; <strong>Middle</strong> ( <strong>Get</strong> ( FilePath ) ; 6 ; <strong>Length</strong> ( <strong>Get</strong> (FilePath ) ) - <strong>Length</strong> ( <strong>Get</strong> (FileName ) ) - 9) &amp; "x/" &amp; <em>TLPicture2</em>::filename ; " " ; "%20" ) ; 

<strong>FilterValues</strong> ( <em>TLPicture2</em>::kfileLocation ; "8162011225558314" )  = "8162011225558314" &amp; &para;; <strong>Substitute</strong> ( <strong>Case</strong> ( <strong>Get</strong> ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; <strong>Middle</strong> ( <strong>Get</strong> ( FilePath ) ; 6 ; <strong>Length</strong> ( <strong>Get</strong> (FilePath ) ) - <strong>Length</strong> ( <strong>Get</strong> (FileName ) ) - 9) &amp; <em>TLPicture2</em>::filename ; " " ; "%20" ) ; 

<strong>FilterValues</strong> ( <em>TLPicture2</em>::kfileLocation ; "8162011225605315" )  = "8162011225605315"   &amp; &para;; <em>tagTLPathPicture2_button</em>::tag &amp; <em>TLPicture2</em>::filename ; 

"")</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Do not store calculation results</li>
<li>Index Language: English</li>
</ul>
</td><td>dueToFilemakerWebViewerOnlySeeingFieldsNativeToLayoutThisCalcIsRequiredToDuplicateRelatedFieldInfo</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278738FieldAnchor_"/>Kpicture3</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>pictureOfTag</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278739FieldAnchor_"/>pictureFileName3</td><td>Calculated, Text</td><td><strong>Calculation:</strong>
<ul>
<li>Context table: <em>tagMenus</em>
</li>
<li>
<strong>Case</strong> ( <strong>FilterValues</strong> ( <em>citationPicture3</em>::kfileLocation ; "8162011225532313" )  = "8162011225532313"  &amp; &para;;   <strong>Substitute</strong> ( <strong>Case</strong> ( <strong>Get</strong> ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; <strong>Middle</strong> ( <strong>Get</strong> ( FilePath ) ; 6 ; <strong>Length</strong> ( <strong>Get</strong> (FilePath ) ) - <strong>Length</strong> ( <strong>Get</strong> (FileName ) ) - 9) &amp; "x/" &amp; <em>citationPicture3</em>::fileName ; " " ; "%20" ) ; 

<strong>FilterValues</strong> ( <em>citationPicture3</em>::kfileLocation ; "8162011225558314" )  = "8162011225558314" &amp; &para;; <strong>Substitute</strong> ( <strong>Case</strong> ( <strong>Get</strong> ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; <strong>Middle</strong> ( <strong>Get</strong> ( FilePath ) ; 6 ; <strong>Length</strong> ( <strong>Get</strong> (FilePath ) ) - <strong>Length</strong> ( <strong>Get</strong> (FileName ) ) - 9) &amp; <em>citationPicture3</em>::fileName ; " " ; "%20" ) ; 

<strong>FilterValues</strong> ( <em>citationPicture3</em>::kfileLocation ; "8162011225605315" )  = "8162011225605315"   &amp; &para;; 

<strong>Substitute</strong> ( <strong>Case</strong> ( <strong>Get</strong> ( SystemPlatform ) =  - 2 ; "file:/" ; "file:///" ) &amp; <em>tagPathPicture3_button</em>::tag ; " " ; "%20" ) &amp;

<strong>Case</strong> ( <strong>Left</strong> ( <em>citationPicture3</em>::fileName ; 1 ) =  "/" ; <strong>Substitute</strong> ( <em>citationPicture3</em>::fileName ; " " ; "%20" ) ;

 "/" &amp; <strong>Substitute</strong> ( <em>citationPicture3</em>::fileName ; " " ; "%20" ) )  ; 


<strong>//from testlearn table
</strong>

<strong>FilterValues</strong> ( <em>TLPicture3</em>::kfileLocation ; "8162011225532313" )  = "8162011225532313"  &amp; &para;;   <strong>Substitute</strong> ( <strong>Case</strong> ( <strong>Get</strong> ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; <strong>Middle</strong> ( <strong>Get</strong> ( FilePath ) ; 6 ; <strong>Length</strong> ( <strong>Get</strong> (FilePath ) ) - <strong>Length</strong> ( <strong>Get</strong> (FileName ) ) - 9) &amp; "x/" &amp; <em>TLPicture3</em>::filename ; " " ; "%20" ) ; 

<strong>FilterValues</strong> ( <em>TLPicture3</em>::kfileLocation ; "8162011225558314" )  = "8162011225558314" &amp; &para;; <strong>Substitute</strong> ( <strong>Case</strong> ( <strong>Get</strong> ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; <strong>Middle</strong> ( <strong>Get</strong> ( FilePath ) ; 6 ; <strong>Length</strong> ( <strong>Get</strong> (FilePath ) ) - <strong>Length</strong> ( <strong>Get</strong> (FileName ) ) - 9) &amp; <em>TLPicture3</em>::filename ; " " ; "%20" ) ; 

<strong>FilterValues</strong> ( <em>TLPicture3</em>::kfileLocation ; "8162011225605315" )  = "8162011225605315"   &amp; &para;; <em>tagTLPathPicture2_button</em>::tag &amp; <em>TLPicture3</em>::filename ; 

"")</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Do not store calculation results</li>
<li>Index Language: English</li>
</ul>
</td><td>dueToFilemakerWebViewerOnlySeeingFieldsNativeToLayoutThisCalcIsRequiredToDuplicateRelatedFieldInfo</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278729FieldAnchor_"/>Ktitle1</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
<li>Index Language: English</li>
</ul>
</td><td>webPageDocumentEtcForMoreInfoAboutTag</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278743FieldAnchor_"/>Ktitle2</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>webPageDocumentEtcForMoreInfoAboutTag</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278744FieldAnchor_"/>Ktitle3</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>webPageDocumentEtcForMoreInfoAboutTag</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278745FieldAnchor_"/>pictureURL1</td><td>Calculated, Text</td><td><strong>Calculation:</strong>
<ul>
<li>Context table: <em>tagMenus</em>
</li>
<li>
<em>citationPicture1</em>::URL <strong>or</strong> <em>TLPicture1</em>::URL</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Do not store calculation results</li>
<li>Index Language: English</li>
</ul>
</td><td>dueToFilemakerWebViewerOnlySeeingFieldsNativeToLayoutThisCalcIsRequiredToDuplicateRelatedFieldInfo</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278746FieldAnchor_"/>pictureURL2</td><td>Calculated, Text</td><td><strong>Calculation:</strong>
<ul>
<li>Context table: <em>tagMenus</em>
</li>
<li>
<em>citationPicture2</em>::URL <strong>or</strong> <em>TLPicture2</em>::URL</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Do not store calculation results</li>
<li>Index Language: English</li>
</ul>
</td><td>dueToFilemakerWebViewerOnlySeeingFieldsNativeToLayoutThisCalcIsRequiredToDuplicateRelatedFieldInfo</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278747FieldAnchor_"/>pictureURL3</td><td>Calculated, Text</td><td><strong>Calculation:</strong>
<ul>
<li>Context table: <em>tagMenus</em>
</li>
<li>
<em>citationPicture3</em>::URL <strong>or</strong> <em>TLPicture3</em>::URL</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Do not store calculation results</li>
<li>Index Language: English</li>
</ul>
</td><td>dueToFilemakerWebViewerOnlySeeingFieldsNativeToLayoutThisCalcIsRequiredToDuplicateRelatedFieldInfo</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278751FieldAnchor_"/>kRecordCreatorNode</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278752FieldAnchor_"/>kRecordModifierNode</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
		</tbody>
</table>
	<br>
		<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td colSpan="9">Table Name: <a name="32774BaseTableAnchor_"/>test - 21 Fields</td>
</tr>
<tr class="chartheaders" vAlign="top">
<td width="8%">Field Name</td><td width="7%">Type</td><td width="14%">Options</td><td width="10%">Comments</td><td width="13%">On Layouts</td><td width="15%">In Relationships</td><td width="22%">In Scripts</td><td width="11%">In Value Lists</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327741FieldAnchor_"/>_Ltest</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Do not replace existing value for field (if any)</li>
<li>Context table: <em>test</em>
<br>Calculation: <strong>Month</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) &amp; 
(<strong>If</strong> ( <strong>Day</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) &gt; 9 ; <strong>Day</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) ; 0 &amp;  (<strong>Day</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) ) ) )&amp; 
<strong>Year</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) &amp;
(<strong>If</strong> ( <strong>Hour</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) &gt; 9 ; <strong>Hour</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ; 0 &amp;  (<strong>Hour</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ) ) )&amp;  
(<strong>If</strong> ( <strong>Minute</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) )&gt; 9 ; <strong>Minute</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ; 0 &amp;  (<strong>Minute</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ) ) )&amp;  
(<strong>If</strong> ( <strong>Seconds</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) &gt; 9 ; <strong>Seconds</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ; 0 &amp;  (<strong>Seconds</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ) ) )&amp;  
<em>test</em>::_number</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
<li>Strict data type: Numeric</li>
<li>Not empty</li>
<li>Unique</li>
<li>Strict validation</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277432781FieldAnchor_"/>_number</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
<li>Serial: Generate: On creation, Next value: 6, Increment: 1</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277432834FieldAnchor_"/>ksection</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277483FieldAnchor_"/>ktestGroup</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277432841FieldAnchor_"/>ktestItemList</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td>usedToDetermineWhichListOfTestItemsWillBeUsedForAnTestSuchAsItsOwnOrAnothertestsList</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277432782FieldAnchor_"/>kcfocusALL</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td>keychainForAllATestsFocuses</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277432798FieldAnchor_"/>kgtester</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277432820FieldAnchor_"/>kgaudienceLocation</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277432835FieldAnchor_"/>kgreportNumber</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277432788FieldAnchor_"/>testName</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Always Validate</li>
<li>Not empty</li>
<li>Strict validation</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277432842FieldAnchor_"/>rule</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
<li>Do not replace existing value for field (if any)</li>
<li>Context table: <em>test</em>
<br>Calculation: "[delete] &para;
How do you inspect a ________________?  &para;
Checklist of items to be inspected: EG Gap Items, windows, doors jams, attic access, outlets, switches, vent openings, cracks or holes, light fixtures, etc. holes for draining, and air and water supply. What do I ask for at the hardware store to get a new one IF THE TERM USED IS SPECIALIZED? &para;
[delete] 
&para;&para;&para;

[delete] &para;
Why is it being inspected (should be part of list on main page) &para;
[delete] 

&para;&para;&para;

Findings&para;
(see pictures and comments below)

&para;&para;&para;

Recommendations&para;
[delete] &para;
Check with your local hardware store on ways of ceiling these problems: aerosal foam insulation, new ruber ciells.  &para;
[delete] 

"</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277432791FieldAnchor_"/>order</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277432795FieldAnchor_"/>retire</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>ifRecordRequiresChangesTheSplitTheRecordRetireOldRecord</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277432818FieldAnchor_"/>glocationNameGlobal</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277432819FieldAnchor_"/>gcontactNameGlobal</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277432821FieldAnchor_"/>gprogressGlobal</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277432840FieldAnchor_"/>mtestGroup</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Constant data: testGroup</li>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>matchFieldUsedToMakeTagOneTableOnlyDisplayGroupsLabeledWithTheWordsTestGroup</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277432845FieldAnchor_"/>kRecordCreatorNode</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277432846FieldAnchor_"/>kRecordModifierNode</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277432847FieldAnchor_"/>RecordModifyDate</td><td>Normal, Timestamp</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277432848FieldAnchor_"/>testNameRevert</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>usedToRevertBackToSpellingIfSpellingWasChangedByDraggingTextIntoField</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
		</tbody>
</table>
	<br>
		<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td colSpan="9">Table Name: <a name="32788BaseTableAnchor_"/>testSubjectFocus - 14 Fields</td>
</tr>
<tr class="chartheaders" vAlign="top">
<td width="8%">Field Name</td><td width="7%">Type</td><td width="14%">Options</td><td width="10%">Comments</td><td width="13%">On Layouts</td><td width="15%">In Relationships</td><td width="22%">In Scripts</td><td width="11%">In Value Lists</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327883FieldAnchor_"/>_LtestSubjectLocation</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Do not replace existing value for field (if any)</li>
<li>Context table: <em>tagTestSubjectLocation</em>
<br>Calculation: <strong>Month</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) &amp; 
(<strong>If</strong> ( <strong>Day</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) &gt; 9 ; <strong>Day</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) ; 0 &amp;  (<strong>Day</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) ) ) )&amp; 
<strong>Year</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) &amp;
(<strong>If</strong> ( <strong>Hour</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) &gt; 9 ; <strong>Hour</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ; 0 &amp;  (<strong>Hour</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ) ) )&amp;  
(<strong>If</strong> ( <strong>Minute</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) )&gt; 9 ; <strong>Minute</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ; 0 &amp;  (<strong>Minute</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ) ) )&amp;  
(<strong>If</strong> ( <strong>Seconds</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) &gt; 9 ; <strong>Seconds</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ; 0 &amp;  (<strong>Seconds</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ) ) )&amp;  
<em>tagTestSubjectLocation</em>::_number</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
<li>Not empty</li>
<li>Unique</li>
<li>Strict validation</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278811FieldAnchor_"/>_number</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
<li>Serial: Generate: On creation, Next value: 10, Increment: 1</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327881FieldAnchor_"/>knode</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278813FieldAnchor_"/>ksection</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327882FieldAnchor_"/>kfocus</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327884FieldAnchor_"/>kfocusAttribute1</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278812FieldAnchor_"/>kfocusAttribute2</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327885FieldAnchor_"/>focusName</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327886FieldAnchor_"/>inUse</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>preventsRecordFromBeingDeletedIfThisFieldIsNotBlank</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327887FieldAnchor_"/>order</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327888FieldAnchor_"/>TimeStart</td><td>Normal, Time</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327889FieldAnchor_"/>TimeTotal</td><td>Normal, Time</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278815FieldAnchor_"/>reportNumber</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td>whichReportDoesItBelongTo</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278820FieldAnchor_"/>kRecordCreatorNode</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
		</tbody>
</table>
	<br>
		<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td colSpan="9">Table Name: <a name="32777BaseTableAnchor_"/>testlearn - 59 Fields</td>
</tr>
<tr class="chartheaders" vAlign="top">
<td width="8%">Field Name</td><td width="7%">Type</td><td width="14%">Options</td><td width="10%">Comments</td><td width="13%">On Layouts</td><td width="15%">In Relationships</td><td width="22%">In Scripts</td><td width="11%">In Value Lists</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733254FieldAnchor_"/>_Number</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
<li>Serial: Generate: On creation, Next value: 2377, Increment: 1</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277731FieldAnchor_"/>_Ltestlearn</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Do not replace existing value for field (if any)</li>
<li>Context table: <em>testlearnReportTags</em>
<br>Calculation: <strong>Month</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) &amp; 
(<strong>If</strong> ( <strong>Day</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) &gt; 9 ; <strong>Day</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) ; 0 &amp;  (<strong>Day</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) ) ) )&amp; 
<strong>Year</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) &amp;
(<strong>If</strong> ( <strong>Hour</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) &gt; 9 ; <strong>Hour</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ; 0 &amp;  (<strong>Hour</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ) ) )&amp;  
(<strong>If</strong> ( <strong>Minute</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) )&gt; 9 ; <strong>Minute</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ; 0 &amp;  (<strong>Minute</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ) ) )&amp;  
(<strong>If</strong> ( <strong>Seconds</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) &gt; 9 ; <strong>Seconds</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ; 0 &amp;  (<strong>Seconds</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ) ) )&amp;  
<em>testlearnReportTags</em>::_Number</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
<li>Strict data type: Numeric</li>
<li>Unique</li>
<li>Strict validation</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277732FieldAnchor_"/>ktestSubject</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733274FieldAnchor_"/>ktest</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td>usedToLinkRecordToTestRecordAsTestDiscovery</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733291FieldAnchor_"/>kaudienceLocation</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733317FieldAnchor_"/>kNodePrimary</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td>usedToCreditPersonWhoCreatedText</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733298FieldAnchor_"/>kcsection</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733305FieldAnchor_"/>kreportNumber</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td>whichReportDoesItBelongTo</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733312FieldAnchor_"/>kcKeywordOther</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td>allTheKeysForAllTheTagsAppliedToAnEvidenceRecord</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733284FieldAnchor_"/>Location</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733276FieldAnchor_"/>Caption</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733283FieldAnchor_"/>Picture</td><td>Normal, Binary</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733292FieldAnchor_"/>InspectionItemCount</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733293FieldAnchor_"/>CheckboxCaption</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733294FieldAnchor_"/>recordnumberglobal</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733295FieldAnchor_"/>recordcountglobal</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733290FieldAnchor_"/>inUse</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>scriptFillsFieldWithTrueIfRecordIsInUse</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733310FieldAnchor_"/>inUseNumberOfTimes</td><td>Calculated, Number</td><td><strong>Calculation:</strong>
<ul>
<li>Context table: <em>testlearnReportTags</em>
</li>
<li>
<strong>ValueCount</strong> ( <em>testlearnReportTags</em>::inUse )</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
</ul>
</td><td>tellsUserHowManyReportSectionsThisEvidenceIsBeingUsedBy</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733296FieldAnchor_"/>InspectionItemCountLocation</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733297FieldAnchor_"/>OK</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733299FieldAnchor_"/>backupPhotoNumber</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733300FieldAnchor_"/>TimeStart</td><td>Normal, Timestamp</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733301FieldAnchor_"/>TimeStop</td><td>Normal, Timestamp</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733302FieldAnchor_"/>TimeTotal</td><td>Normal, Timestamp</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733306FieldAnchor_"/>timestamp</td><td>Normal, Timestamp</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Creation timestamp</li>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td>whatDateWasFindingMade</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733311FieldAnchor_"/>orderDiscovery</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
</ul>
</td><td>forOrderingDiscoveriesForReporting</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733314FieldAnchor_"/>kNodeOther</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td>listOfKeysThatConditionallyFormatNodesInTagWindowViaAVariableFilteredByEachNodeRecord</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733315FieldAnchor_"/>kHealth</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>copyrightTypeLettingUserKnowWhatWillHappenToTheirHealthIfTheyViolateIt</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733318FieldAnchor_"/>kmedium</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td>typeOfMediumInformationExistsInPrimarilyUsedToCreateButtonToInformUserWhatKindOfItmeWillOpenWhenClicked</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733323FieldAnchor_"/>kcitation</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
<li>Index Language: English</li>
</ul>
</td><td>ifDerivativeWorkThisFieldCapturesCitationOfOrginalWork</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733324FieldAnchor_"/>kfileLocation</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>conditionalFormatsFieldsRequiredToBeFilledInBasedOnWhereFileIsLocated</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733325FieldAnchor_"/>kfolderPath</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733327FieldAnchor_"/>kKeywordPrimary</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td>allTheKeysForAllTheTagsAppliedToAnEvidenceRecord</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733328FieldAnchor_"/>OtherKeyWords</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733329FieldAnchor_"/>NodeOthers</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul></ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
<li>Strict validation</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733330FieldAnchor_"/>URL</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733331FieldAnchor_"/>filename</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733333FieldAnchor_"/>kcreference</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>allReferencesThisWorkOwesItsExistenceTo</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733334FieldAnchor_"/>concatenateLong</td><td>Calculated, Text</td><td><strong>Calculation:</strong>
<ul>
<li>Context table: <em>testlearn</em>
</li>
<li>
<strong>//NODE
</strong><strong>Case</strong> ( <em>tagTLNodePrimary</em>::tag = "" <strong>and</strong> <em>testlearn</em>::NodeOthers = "" ; <strong>TextColor</strong> ( "author not entered" ; <strong>RGB</strong> ( 119 ; 119 ; 119 ) ) ;
<em>tagTLNodePrimary</em>::tag &ne; "" ; <em>tagTLNodePrimary</em>::tag ) &amp; 
<strong>Case</strong> ( <em>testlearn</em>::NodeOthers = "" ; "" ;  "; " &amp; <em>testlearn</em>::NodeOthers) &amp; 

<strong>//COPY DATE
</strong><strong>Case</strong> ( <em>testlearn</em>::timestamp = "" ; <strong>TextColor</strong> ( "  (date deleted).  " ; <strong>RGB</strong> ( 119 ; 119 ; 119 ) )  ;
"  (" &amp; <strong>Month</strong> ( <em>testlearn</em>::timestamp ) &amp; "/" &amp; <strong>Day</strong> ( <em>testlearn</em>::timestamp ) &amp; "/" &amp; <strong>Year</strong> ( <em>testlearn</em>::timestamp ) &amp;  " " &amp; <strong>Hour</strong> ( <em>testlearn</em>::timestamp ) &amp; ":" &amp; <strong>Minute</strong> ( <em>testlearn</em>::timestamp )  &amp; ").  "  ) &amp; 

<strong>//TITLE 
</strong><strong>Case</strong> ( <em>testlearn</em>::Caption = "" ; <strong>TextColor</strong> ( "title (first paragraph of text) not entered.  "; <strong>RGB</strong> ( 119 ; 119 ; 119 ) ) ; 
<strong>TextFont</strong> ( 
<strong>Left</strong> ( ( <strong>Case</strong> ( <strong>Right</strong> ( <strong>LeftValues</strong> ( <em>testlearn</em>::Caption ; 1 ) ; 1 )  = &para; ; <strong>LeftWords</strong> ( <strong>LeftValues</strong> ( <em>testlearn</em>::Caption ; 1 ) ; 100 ) ; <strong>LeftValues</strong> ( <em>testlearn</em>::Caption ; 1 ))) ; 100 )
 &amp; <strong>Case</strong>( <strong>Length</strong> ( <em>testlearn</em>::Caption)  &gt; 100 ; "[...]" ; "" )
 ; "Arial" ) 
&amp; ".  " ) &amp; 

<strong>//EMAIL 
</strong><strong>//Case ( testlearn::emailDate = "" ; "" ; "emailed " &amp; Month( testlearn::emailDate ) &amp; "/" &amp; Day ( testlearn::emailDate ) &amp; "/" &amp; Year ( testlearn::emailDate ) ) &amp; ".  " &amp; 
</strong>
<strong>//COPYIST 
</strong><strong>Left</strong> ( ( <strong>Case</strong> ( <strong>Right</strong> ( <strong>LeftValues</strong> ( <em>testlearn</em>::organEmailRecipient ; 1 ) ; 1 )  = &para; ; <strong>LeftWords</strong> ( <strong>LeftValues</strong> ( <em>testlearn</em>::organEmailRecipient ; 1 ) ; 100 ) ; <strong>LeftValues</strong> ( <em>testlearn</em>::organEmailRecipient ; 1 ))) ; 100 ) &amp; 

<strong>//COPYIST PUNCTUATION 
</strong><strong>Case</strong> ( <em>testlearn</em>::organEmailRecipient &ne; "" <strong>and</strong> <em>testlearn</em>::URLPubDate = "" <strong>and</strong> <em>testlearn</em>::URL = "" ;  ".  " ;
<em>testlearn</em>::organEmailRecipient &ne; "" <strong>and</strong> <em>testlearn</em>::URLPubDate &ne; "" <strong>and</strong> <em>testlearn</em>::URL = "" ;  ": " ;
<em>testlearn</em>::organEmailRecipient &ne; "" <strong>and</strong> <em>testlearn</em>::URLPubDate = "" <strong>and</strong> <em>testlearn</em>::URL &ne; "" ;  ": " ;
<em>testlearn</em>::organEmailRecipient &ne; "" <strong>and</strong> <em>testlearn</em>::URLPubDate &ne; "" <strong>and</strong> <em>testlearn</em>::URL &ne; "" ;  ": " )  &amp; 

<strong>//URL 
</strong><strong>Case</strong> ( <em>testlearn</em>::URLPubDate = "" ; 
<strong>Case</strong> ( <em>testlearn</em>::URLPubDate = "" <strong>and</strong> <em>testlearn</em>::URL = "" ; "" ; <strong>TextColor</strong> ( "(retrieved date not entered)"; <strong>RGB</strong> ( 119 ; 119 ; 119 ) ) ) ; "posted " &amp; <strong>Month</strong>( <em>testlearn</em>::URLPubDate ) &amp; "/" &amp; <strong>Day</strong> ( <em>testlearn</em>::URLPubDate ) &amp; "/" &amp; <strong>Year</strong> ( <em>testlearn</em>::URLPubDate ) )  &amp; 
<strong>Case</strong> (<em>testlearn</em>::URL = "" ; <strong>Case</strong> ( <em>testlearn</em>::URLPubDate = "" <strong>and</strong> <em>testlearn</em>::URL = "" ; "" ; <strong>TextColor</strong> ( " URL not entered.  " ; <strong>RGB</strong> ( 119 ; 119 ; 119 ) ) ) ; 
" to " &amp; 
<strong>Case</strong> ( <strong>Left</strong> ( <em>testlearn</em>::URL ; 12 ) = "https://www." ; <strong>Middle</strong> ( <em>testlearn</em>::URL ; 13 ; 100 ); 
<strong>Left</strong> ( <em>testlearn</em>::URL ; 11 ) = "http://www." ; <strong>Middle</strong> ( <em>testlearn</em>::URL ; 12 ; 100 );
<strong>Left</strong> ( <em>testlearn</em>::URL ; 7 ) = "http://" ; <strong>Middle</strong> ( <em>testlearn</em>::URL ; 8 ; 100 );
<strong>Left</strong> ( <em>testlearn</em>::URL ; 4 ) = "www." ; <strong>Middle</strong> ( <em>testlearn</em>::URL ; 5 ; 100 );
<em>testlearn</em>::URL)  &amp; "    ")  &amp; 

<strong>//HEALTH/COPYRIGHT 
</strong><strong>Case</strong> ( <em>tagTLHealth</em>::tag = "" ; <strong>TextColor</strong> ( "health (copyright) not selected" ; <strong>RGB</strong> ( 119 ; 119 ; 119 ) ) &amp; " in "; 
<strong>Case</strong> ( <strong>Right</strong> ( <strong>LeftValues</strong> ( <em>tagTLHealth</em>::tag ; 1 ) ; 1 )  = &para; ; <strong>Left</strong> ( <em>tagTLHealth</em>::tag ; ( <strong>Length</strong> ( <strong>LeftValues</strong> ( <em>tagTLHealth</em>::tag ; 1 ) ) - 1) ); <strong>LeftValues</strong> ( <em>tagTLHealth</em>::tag ; 1 )) )
  &amp; 
<strong>Case</strong> ( <em>testlearn</em>::timestamp = "" ; <strong>TextColor</strong> ( "  (date deleted).  " ; <strong>RGB</strong> ( 119 ; 119 ; 119 ) )  ; " " &amp; <strong>Year</strong> ( <em>testlearn</em>::timestamp ) &amp; ".  "  ) &amp;  

<strong>//KEYWORDS
</strong><strong>Case</strong> ( <em>tagTLKeywordPrimary</em>::tag = "" ; "" ; <strong>TextStyleAdd</strong> ( <em>tagTLKeywordPrimary</em>::tag ; <strong>Bold</strong> )  &amp; ", " ) &amp; 
<em>testlearn</em>::OtherKeyWords</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Do not store calculation results</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733335FieldAnchor_"/>filterFind</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td>usedToLimitRecordToSpecificFindsLikeLibraryOrTagCitations</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733336FieldAnchor_"/>kRecordCreatorNode</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733337FieldAnchor_"/>kRecordModifierNode</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
<li>Context table: <em>testlearnReportTags</em>
<br>Calculation: <em>TEMP</em>::kdefaultNodePrimary</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Always Validate</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733338FieldAnchor_"/>RecordModifyDate</td><td>Normal, Timestamp</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733339FieldAnchor_"/>incomplete</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>checkboxForUserToFlagARecordAsNeedingMoreInfo</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733340FieldAnchor_"/>date</td><td>Calculated, Date</td><td><strong>Calculation:</strong>
<ul>
<li>Context table: <em>testlearnReportTags</em>
</li>
<li>
<strong>GetAsDate</strong> ( <em>testlearnReportTags</em>::timestamp )</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
</ul>
</td><td>dateMade</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733341FieldAnchor_"/>copyrightYear</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733342FieldAnchor_"/>URLPubDate</td><td>Normal, Date</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733343FieldAnchor_"/>kcsample</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
<li>Index Language: English</li>
</ul>
</td><td>usedToCreateSample</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733345FieldAnchor_"/>gkaudienceLocation</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733346FieldAnchor_"/>kctest</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
<li>Index Language: English</li>
</ul>
</td><td>keychainUsedToLinkRecordToItemRecordAndShowItOnInfoLayoutInReportAndTestModes</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733347FieldAnchor_"/>orderTest</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td>forOrderingTestInformation</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733348FieldAnchor_"/>title</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>requiredBeforeSystemWillAllARecordToBeAddedToATag</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733349FieldAnchor_"/>kctestItem</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
<li>Index Language: English</li>
</ul>
</td><td>keychainUsedToCheckOffTestItemsCompletedForASpecificTestLocationItemByConditionallyFormattingTestItemsInTagWindowInReportAndTestModes</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733350FieldAnchor_"/>organEmailRecipient</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>ifOrganIsEmailThenWhoDidItGoTo</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733351FieldAnchor_"/>korgan</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>nameOfFirstWebsiteWhereTextWasPrinted</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733352FieldAnchor_"/>kcopyist</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733353FieldAnchor_"/>emailDate</td><td>Normal, Date</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733354FieldAnchor_"/>concatenateLongPASTE</td><td>Calculated, Text</td><td><strong>Calculation:</strong>
<ul>
<li>Context table: <em>testlearn</em>
</li>
<li>
<strong>//NODE
</strong><strong>Case</strong> ( <em>tagTLNodePrimary</em>::tag = "" <strong>and</strong> <em>testlearn</em>::NodeOthers = "" ; <strong>TextStyleAdd</strong> ( "author not entered" ; <strong>Italic</strong> ) ;
<em>tagTLNodePrimary</em>::tag &ne; "" ; <em>tagTLNodePrimary</em>::tag ) &amp; 
<strong>Case</strong> ( <em>testlearn</em>::NodeOthers = "" ; "" ;  "; " &amp; <em>testlearn</em>::NodeOthers) &amp; 

<strong>//COPY DATE
</strong><strong>Case</strong> ( <em>testlearn</em>::timestamp = "" ; <strong>TextStyleAdd</strong> ( "  (date deleted).  " ; <strong>Italic</strong> )  ;
"  (" &amp; <strong>Month</strong> ( <em>testlearn</em>::timestamp ) &amp; "/" &amp; <strong>Day</strong> ( <em>testlearn</em>::timestamp ) &amp; "/" &amp; <strong>Year</strong> ( <em>testlearn</em>::timestamp ) &amp;  " " &amp; <strong>Hour</strong> ( <em>testlearn</em>::timestamp ) &amp; ":" &amp; <strong>Minute</strong> ( <em>testlearn</em>::timestamp )  &amp; ").  "  ) &amp; 

<strong>//TITLE 
</strong><strong>Case</strong> ( <em>testlearn</em>::Caption = "" ; <strong>TextStyleAdd</strong> ( "title (first paragraph of text) not entered.  "; <strong>Italic</strong> ) ; 
<strong>TextFont</strong> ( 
<strong>Left</strong> ( ( <strong>Case</strong> ( <strong>Right</strong> ( <strong>LeftValues</strong> ( <em>testlearn</em>::Caption ; 1 ) ; 1 )  = &para; ; <strong>LeftWords</strong> ( <strong>LeftValues</strong> ( <em>testlearn</em>::Caption ; 1 ) ; 100 ) ; <strong>LeftValues</strong> ( <em>testlearn</em>::Caption ; 1 ))) ; 100 )
 &amp; <strong>Case</strong>( <strong>Length</strong> ( <em>testlearn</em>::Caption)  &gt; 100 ; "[...]" ; "" )
 ; "Arial" ) 
&amp; ".  " ) &amp; 

<strong>//EMAIL 
</strong><strong>//Case ( testlearn::emailDate = "" ; "" ; "emailed " &amp; Month( testlearn::emailDate ) &amp; "/" &amp; Day ( testlearn::emailDate ) &amp; "/" &amp; Year ( testlearn::emailDate ) ) &amp; ".  " &amp; 
</strong>
<strong>//COPYIST 
</strong><strong>Left</strong> ( ( <strong>Case</strong> ( <strong>Right</strong> ( <strong>LeftValues</strong> ( <em>testlearn</em>::organEmailRecipient ; 1 ) ; 1 )  = &para; ; <strong>LeftWords</strong> ( <strong>LeftValues</strong> ( <em>testlearn</em>::organEmailRecipient ; 1 ) ; 100 ) ; <strong>LeftValues</strong> ( <em>testlearn</em>::organEmailRecipient ; 1 ))) ; 100 ) &amp; 

<strong>//COPYIST PUNCTUATION 
</strong><strong>Case</strong> ( <em>testlearn</em>::organEmailRecipient &ne; "" <strong>and</strong> <em>testlearn</em>::URLPubDate = "" <strong>and</strong> <em>testlearn</em>::URL = "" ;  ".  " ;
<em>testlearn</em>::organEmailRecipient &ne; "" <strong>and</strong> <em>testlearn</em>::URLPubDate &ne; "" <strong>and</strong> <em>testlearn</em>::URL = "" ;  ": " ;
<em>testlearn</em>::organEmailRecipient &ne; "" <strong>and</strong> <em>testlearn</em>::URLPubDate = "" <strong>and</strong> <em>testlearn</em>::URL &ne; "" ;  ": " ;
<em>testlearn</em>::organEmailRecipient &ne; "" <strong>and</strong> <em>testlearn</em>::URLPubDate &ne; "" <strong>and</strong> <em>testlearn</em>::URL &ne; "" ;  ": " )  &amp; 

<strong>//URL 
</strong><strong>Case</strong> ( <em>testlearn</em>::URLPubDate = "" ; 
<strong>Case</strong> ( <em>testlearn</em>::URLPubDate = "" <strong>and</strong> <em>testlearn</em>::URL = "" ; "" ; <strong>TextStyleAdd</strong> ( "(retrieved date not entered)"; <strong>Italic</strong> ) ) ; "posted " &amp; <strong>Month</strong>( <em>testlearn</em>::URLPubDate ) &amp; "/" &amp; <strong>Day</strong> ( <em>testlearn</em>::URLPubDate ) &amp; "/" &amp; <strong>Year</strong> ( <em>testlearn</em>::URLPubDate ) )  &amp; 
<strong>Case</strong> (<em>testlearn</em>::URL = "" ; <strong>Case</strong> ( <em>testlearn</em>::URLPubDate = "" <strong>and</strong> <em>testlearn</em>::URL = "" ; "" ; <strong>TextStyleAdd</strong> ( " URL not entered.  " ; <strong>Italic</strong> ) ) ; 
" to " &amp; 
<strong>Case</strong> ( <strong>Left</strong> ( <em>testlearn</em>::URL ; 12 ) = "https://www." ; <strong>Middle</strong> ( <em>testlearn</em>::URL ; 13 ; 100 ); 
<strong>Left</strong> ( <em>testlearn</em>::URL ; 11 ) = "http://www." ; <strong>Middle</strong> ( <em>testlearn</em>::URL ; 12 ; 100 );
<strong>Left</strong> ( <em>testlearn</em>::URL ; 7 ) = "http://" ; <strong>Middle</strong> ( <em>testlearn</em>::URL ; 8 ; 100 );
<strong>Left</strong> ( <em>testlearn</em>::URL ; 4 ) = "www." ; <strong>Middle</strong> ( <em>testlearn</em>::URL ; 5 ; 100 );
<em>testlearn</em>::URL)  &amp; "    ")  &amp; 

<strong>//HEALTH/COPYRIGHT 
</strong><strong>Case</strong> ( <em>tagTLHealth</em>::tag = "" ; <strong>TextStyleAdd</strong> ( "health (copyright) not selected" ; <strong>Italic</strong> ) &amp; " in "; 
<strong>Case</strong> ( <strong>Right</strong> ( <strong>LeftValues</strong> ( <em>tagTLHealth</em>::tag ; 1 ) ; 1 )  = &para; ; <strong>Left</strong> ( <em>tagTLHealth</em>::tag ; ( <strong>Length</strong> ( <strong>LeftValues</strong> ( <em>tagTLHealth</em>::tag ; 1 ) ) - 1) ); <strong>LeftValues</strong> ( <em>tagTLHealth</em>::tag ; 1 )) )
  &amp; 
<strong>Case</strong> ( <em>testlearn</em>::timestamp = "" ; <strong>TextStyleAdd</strong> ( "  (date deleted).  " ; <strong>Italic</strong> )  ; " " &amp; <strong>Year</strong> ( <em>testlearn</em>::timestamp ) &amp; ".  "  ) <strong>// &amp;  
</strong>
<strong>//KEYWORDS
</strong><strong>// Case ( tagTLKeywordPrimary::tag = "" ; "" ; TextStyleAdd ( tagTLKeywordPrimary::tag ; Bold )  &amp; ", " ) &amp; 
</strong><strong>//testlearn::OtherKeyWords</strong>
</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Do not store calculation results</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277733355FieldAnchor_"/>sampleCasePoint</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
		</tbody>
</table>
	<br>
		<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td colSpan="9">Table Name: <a name="32797BaseTableAnchor_"/>learnWebsite - 5 Fields</td>
</tr>
<tr class="chartheaders" vAlign="top">
<td width="8%">Field Name</td><td width="7%">Type</td><td width="14%">Options</td><td width="10%">Comments</td><td width="13%">On Layouts</td><td width="15%">In Relationships</td><td width="22%">In Scripts</td><td width="11%">In Value Lists</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327971FieldAnchor_"/>_LlearnWebsite</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Do not replace existing value for field (if any)</li>
<li>Context table: <em>learnWebsite</em>
<br>Calculation: <strong>Month</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) &amp; 
(<strong>If</strong> ( <strong>Day</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) &gt; 9 ; <strong>Day</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) ; 0 &amp;  (<strong>Day</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) ) ) )&amp; 
<strong>Year</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) &amp;
(<strong>If</strong> ( <strong>Hour</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) &gt; 9 ; <strong>Hour</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ; 0 &amp;  (<strong>Hour</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ) ) )&amp;  
(<strong>If</strong> ( <strong>Minute</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) )&gt; 9 ; <strong>Minute</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ; 0 &amp;  (<strong>Minute</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ) ) )&amp;  
(<strong>If</strong> ( <strong>Seconds</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) &gt; 9 ; <strong>Seconds</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ; 0 &amp;  (<strong>Seconds</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ) ) )&amp;  
<em>learnWebsite</em>::_Number</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
<li>Strict data type: Numeric</li>
<li>Unique</li>
<li>Strict validation</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327972FieldAnchor_"/>_Number</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
<li>Serial: Generate: On creation, Next value: 2, Increment: 1</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327973FieldAnchor_"/>URL</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327974FieldAnchor_"/>URLPubDate</td><td>Normal, Timestamp</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Creation timestamp</li>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327975FieldAnchor_"/>ktestlearn</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
		</tbody>
</table>
	<br>
		<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td colSpan="9">Table Name: <a name="32793BaseTableAnchor_"/>reference - 83 Fields</td>
</tr>
<tr class="chartheaders" vAlign="top">
<td width="8%">Field Name</td><td width="7%">Type</td><td width="14%">Options</td><td width="10%">Comments</td><td width="13%">On Layouts</td><td width="15%">In Relationships</td><td width="22%">In Scripts</td><td width="11%">In Value Lists</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327931FieldAnchor_"/>_Number</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Serial: Generate: On creation, Next value: 1361, Increment: 1</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
<li>Strict validation</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327932FieldAnchor_"/>_Lreference</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
<li>Do not replace existing value for field (if any)</li>
<li>Context table: <em>reference</em>
<br>Calculation: <strong>Month</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) &amp; 
(<strong>If</strong> ( <strong>Day</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) &gt; 9 ; <strong>Day</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) ; 0 &amp;  (<strong>Day</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) ) ) )&amp; 
<strong>Year</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) &amp;
(<strong>If</strong> ( <strong>Hour</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) &gt; 9 ; <strong>Hour</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ; 0 &amp;  (<strong>Hour</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ) ) )&amp;  
(<strong>If</strong> ( <strong>Minute</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) )&gt; 9 ; <strong>Minute</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ; 0 &amp;  (<strong>Minute</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ) ) )&amp;  
(<strong>If</strong> ( <strong>Seconds</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) &gt; 9 ; <strong>Seconds</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ; 0 &amp;  (<strong>Seconds</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ) ) )&amp;  
<em>reference</em>::_Number</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
<li>Strict data type: Numeric</li>
<li>Unique</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327933FieldAnchor_"/>ktestSubject</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327934FieldAnchor_"/>ktest</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327935FieldAnchor_"/>kcsection</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327936FieldAnchor_"/>knodePrimary</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279339FieldAnchor_"/>knodeOther</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279340FieldAnchor_"/>NodeOthers</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279338FieldAnchor_"/>referenceDump</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>ifUserJustWantsToCopyAWholeCitationWithoutPartingItUpIntoNodeOrganEtcThenUserPutsItInThisFieldAndSystemUsesItForReference</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279315FieldAnchor_"/>kcopyist</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279319FieldAnchor_"/>kmedium</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279318FieldAnchor_"/>kHealth</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>descriptionOfUseageRigths</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279317FieldAnchor_"/>kcopyrightType</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>registeredCreativeCommonsGNUetc</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279336FieldAnchor_"/>CopyrightYear</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279337FieldAnchor_"/>kcopyrightHolder</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>keysAreMadeViaTheCopyrightHolderScript</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279323FieldAnchor_"/>kfolderpath</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279321FieldAnchor_"/>kkeywordPrimary</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279320FieldAnchor_"/>kkeywordOther</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279341FieldAnchor_"/>OtherKeyWords</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327937FieldAnchor_"/>pubYear</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327938FieldAnchor_"/>URL</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327939FieldAnchor_"/>URLdate</td><td>Normal, Date</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279310FieldAnchor_"/>Title</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279311FieldAnchor_"/>korgan</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279312FieldAnchor_"/>volumeNumber</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279313FieldAnchor_"/>PubDate</td><td>Normal, Date</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279314FieldAnchor_"/>pageNumberRange</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>pageRangeInBook</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279316FieldAnchor_"/>OrginalCitation</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279322FieldAnchor_"/>thoughtsNotesEtc</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279324FieldAnchor_"/>fileName</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279326FieldAnchor_"/>referenceLong</td><td>Calculated, Text</td><td><strong>Calculation:</strong>
<ul>
<li>Context table: <em>reference</em>
</li>
<li>
<strong>Case</strong> (
<em>reference</em>::referenceNodes &ne; ""
<strong>or</strong> <em>tagNodePrimary</em>::tag &ne; ""
<strong>or</strong> <em>reference</em>::NodeOthers &ne; "" 
<strong>or</strong> <em>reference</em>::pubYear &ne; "" 
<strong>or</strong> <em>reference</em>::PubDate &ne; "" 
<strong>or</strong> <em>reference</em>::Title &ne; "" 
<strong>or</strong> <em>reference</em>::korgan &ne; "" 
<strong>or</strong> <em>reference</em>::volumeNumber &ne; "" 
<strong>or</strong> <em>reference</em>::issueNumber &ne; "" 
<strong>or</strong> <em>reference</em>::pageNumberRange &ne; "" 
<strong>or</strong> <em>reference</em>::TimeRange &ne; "" 
<strong>or</strong> <em>tagCopyist</em>::tag &ne; ""
<strong>or</strong> <em>reference</em>::URL &ne; "" <strong>and</strong> <em>reference</em>::referenceDump = ""
<strong>or</strong> <em>reference</em>::URLdate &ne; ""
<strong>or</strong> <em>tagHealth</em>::tag &ne; ""
<strong>or</strong> <em>reference</em>::CopyrightYear &ne; "" ;

<strong>//GOVT AUTHOR 
</strong><strong>Case</strong> ( <em>reference</em>::governmentAuthor = "" ; 

<strong>//NODE
</strong><strong>Case</strong> ( <em>reference</em>::referenceNodes &ne; "" ; <em>reference</em>::referenceNodes ; 
<strong>Case</strong> ( <em>reference</em>::governmentAuthor = "" <strong>and</strong> <em>reference</em>::referenceNodes  =  "" <strong>and</strong> <em>tagNodePrimary</em>::tag = "" <strong>and</strong> <em>reference</em>::NodeOthers = "" ; 
<strong>Case</strong> ( <em>reference</em>::compilationTitle = "" <strong>and</strong> <em>refMedia</em>::NOitalics = "" <strong>and</strong> <em>reference</em>::korgan = "" ; <strong>TextStyleAdd</strong> ( <em>reference</em>::Title ; <strong>Italic</strong> ) ; <em>reference</em>::Title ) &amp; 
<strong>//INFO TYPE
</strong><strong>Case</strong> (<em>refMedia</em>::mediumName = "" ; "" ; " [" &amp; 
<strong>Case</strong> (
<em>refMediaType</em>::typeName = ""  <strong>and</strong> <em>refMediaType</em>::type &ne; " other"; 
<strong>Case</strong> ( <em>refMediaType</em>::key = 1 <strong>and</strong> <em>refMedia</em>::key = 200 ; "Web " &amp; <em>refMedia</em>::mediumName ;
<strong>TextStyleAdd</strong> ( <strong>Left</strong> ( <em>refMedia</em>::mediumName ; 1 ) ; <strong>Uppercase</strong> )  &amp;  <strong>Middle</strong> ( <em>refMedia</em>::mediumName ; 2 ; 99 ) ) ;
<strong>Case</strong> (
<em>refMedia</em>::mediumName = "" ; 
<strong>Case</strong> ( <em>refMediaType</em>::type = " other" ; <em>reference</em>::TypeOfMediumOther ; <em>refMediaType</em>::typeName ) ;
<strong>Case</strong> ( <em>refMediaType</em>::type = " other" ; <em>reference</em>::TypeOfMediumOther ; <em>refMediaType</em>::typeName ) &amp; " "  &amp; <em>refMedia</em>::mediumName )) &amp;
<strong>Case</strong> ( <em>reference</em>::bookChapter &ne; "" ; " "  &amp; <em>reference</em>::bookChapter &amp; "]" ; "]" ) ) )  &amp; 
<strong>Case</strong> ( <em>reference</em>::referenceNodes  =  "" <strong>and</strong> <em>tagNodePrimary</em>::tag &ne; "" ; <em>tagNodePrimary</em>::tag  ) &amp; 
<strong>Case</strong> ( <em>reference</em>::NodeOthers &ne; "" <strong>and</strong> <em>tagNodePrimary</em>::tag = "" ; <em>reference</em>::NodeOthers ;  
<strong>Case</strong> ( <em>reference</em>::NodeOthers &ne; "" <strong>and</strong> <em>tagNodePrimary</em>::tag &ne; "" ;    "; " &amp; <em>reference</em>::NodeOthers ) ) ) 

 ; <em>reference</em>::governmentAuthor ) &amp;

<strong>//PUB DATE
</strong><strong>//NONE
</strong><strong>Case</strong> ( <em>reference</em>::pubYear = "" <strong>and</strong> <em>reference</em>::PubDate = "" <strong>and</strong> <em>reference</em>::pubDateOther = "" ; " (n.d.). "    ;
<strong>//DATE
</strong><em>reference</em>::PubDate &ne; ""  ; " (" &amp; <strong>Year</strong> ( <em>reference</em>::PubDate ) &amp; ", " &amp; <strong>MonthName</strong> ( <em>reference</em>::PubDate ) &amp; " " &amp; <strong>Day</strong> ( <em>reference</em>::PubDate ) &amp; "). "  ; 
<strong>//DATE RANGER
</strong><em>reference</em>::pubDateOther &ne; ""  ; " (" &amp; <em>reference</em>::pubDateOther &amp; "). "  ; 
<strong>//ONLY YEAR
</strong><em>reference</em>::pubYear &ne; ""  ; " (" &amp; <em>reference</em>::pubYear  &amp; "). " )  &amp; 

<strong>//REF TITLE 
</strong><strong>Case</strong> ( <em>reference</em>::referenceNodes  =  "" <strong>and</strong> <em>tagNodePrimary</em>::tag = "" <strong>and</strong> <em>reference</em>::NodeOthers = "" <strong>and</strong> <em>reference</em>::governmentAuthor = "" ; "" ;
<strong>Case</strong> ( <em>reference</em>::Title = "" ; "" ; 
<strong>Case</strong> ( <em>reference</em>::compilationTitle = "" <strong>and</strong> <em>refMedia</em>::NOitalics = "" <strong>and</strong> <em>reference</em>::korgan = "" ; <strong>TextStyleAdd</strong> ( <em>reference</em>::Title ; <strong>Italic</strong> ) ; <em>reference</em>::Title ) &amp;

<strong>//INFO TYPE
</strong><strong>Case</strong> (<em>refMedia</em>::mediumName = "" ; "" ; " [" &amp; 
<strong>Case</strong> (
<em>refMediaType</em>::typeName = ""  <strong>and</strong> <em>refMediaType</em>::type &ne; " other"; 
<strong>Case</strong> ( <em>refMediaType</em>::key = 1 <strong>and</strong> <em>refMedia</em>::key = 200 ; "Web " &amp; <em>refMedia</em>::mediumName ;
<strong>TextStyleAdd</strong> ( <strong>Left</strong> ( <em>refMedia</em>::mediumName ; 1 ) ; <strong>Uppercase</strong> )  &amp;  <strong>Middle</strong> ( <em>refMedia</em>::mediumName ; 2 ; 99 ) ) ;
<strong>Case</strong> (
<em>refMedia</em>::mediumName = "" ; 
<strong>Case</strong> ( <em>refMediaType</em>::type = " other" ; <em>reference</em>::TypeOfMediumOther ; <em>refMediaType</em>::typeName ) ;
<strong>Case</strong> ( <em>refMediaType</em>::type = " other" ; <em>reference</em>::TypeOfMediumOther ; <em>refMediaType</em>::typeName ) &amp; " "  &amp; <em>refMedia</em>::mediumName )) &amp;
<strong>Case</strong> ( <em>reference</em>::bookChapter &ne; "" ; " "  &amp; <em>reference</em>::bookChapter &amp; "]" ; "]" ) ) &amp; 
 ". " ) ) &amp; 

<strong>//UNIVERSITY
</strong><strong>Case</strong> ( <em>reference</em>::dissertationThesisUniversity  &ne; "" ; <em>reference</em>::dissertationThesisUniversity &amp; ". " ) &amp; 

<strong>//GOVERNMENT AUTHOR continued
</strong><strong>Case</strong> ( <em>reference</em>::governmentAuthor  &ne; "" ;
<strong>Case</strong> ( <em>reference</em>::knodePrimary  =  "" <strong>and</strong> <em>reference</em>::knodeOther = "" <strong>and</strong> <em>reference</em>::referenceNodes = "" ; "" ; "By " &amp; 

<strong>//NODE continued
</strong><strong>Case</strong> ( <em>reference</em>::referenceNodes &ne; "" ; <em>reference</em>::referenceNodes ; 
<strong>Case</strong> ( <em>reference</em>::referenceNodes  =  "" <strong>and</strong> <em>tagNodePrimary</em>::tag &ne; "" ; <em>tagNodePrimary</em>::tag  ) &amp; 
<strong>Case</strong> ( <em>reference</em>::NodeOthers &ne; "" <strong>and</strong> <em>tagNodePrimary</em>::tag = "" ; <em>reference</em>::NodeOthers ;  
<strong>Case</strong> ( <em>reference</em>::NodeOthers &ne; "" <strong>and</strong> <em>tagNodePrimary</em>::tag &ne; "" ;    "; " &amp; <em>reference</em>::NodeOthers ) ) ) 
 &amp; ". " ) ) &amp;

<strong>//GOVT DOC INFO 
</strong><strong>Case</strong> ( <em>reference</em>::GovernmentDocInfo = "" ; "" ; "(" &amp; <em>reference</em>::GovernmentDocInfo &amp; "). " ) &amp;

<strong>//EMAIL RECIPIENT'S NAME
</strong><strong>Case</strong> ( <em>reference</em>::emailRecipient = ""; "" ; 
"Received by " &amp; <em>reference</em>::emailRecipient &amp; ". " ) &amp; 

<strong>//EDITORS OF PUBLICATION
</strong><strong>Case</strong> ( <em>reference</em>::compilationEditors = ""; "" ; "In "  &amp; <em>reference</em>::compilationEditors &amp; 
<strong>Case</strong> ( <em>reference</em>::compilationAbbr = "" ; ": " ; " ("  &amp; 
<strong>Case</strong> ( <em>reference</em>::compilationNumberOfEditors = "" ;
<strong>Case</strong> ( <strong>ValueCount</strong> ( <em>reference</em>::compilationAbbr ) = 3 ; "Comp., Ed. and Trans." ; 
<strong>Case</strong> ( <strong>ValueCount</strong> ( <em>reference</em>::compilationAbbr ) = 2 ; 
<strong>Case</strong> ( <strong>FilterValues</strong> ( <em>reference</em>::compilationAbbr ; 3 &amp; &para; )   &ne;  3 &amp; &para; ; "Comp. and Ed." ;
<strong>Case</strong> ( <strong>FilterValues</strong> ( <em>reference</em>::compilationAbbr ; 1 ) &ne; 1 &amp; &para; ; "Comp. and Trans." ;
<strong>Case</strong> ( <strong>FilterValues</strong> ( <em>reference</em>::compilationAbbr ; 2 ) &ne; 2 &amp; &para; ; "Ed. and Trans." ))) ; 
<strong>Case</strong> ( <em>reference</em>::compilationAbbr = 1 ; "Ed." ; <strong>Case</strong> ( <em>reference</em>::compilationAbbr = 2 ; "Comp." ;  <strong>Case</strong> ( <em>reference</em>::compilationAbbr = 3 ; "Trans." )))  )) ;
<strong>//2 OR MORE
</strong><strong>Case</strong> ( <strong>ValueCount</strong> ( <em>reference</em>::compilationAbbr ) = 3 ; "Comps., Eds. and Trans." ; 
<strong>Case</strong> ( <strong>ValueCount</strong> ( <em>reference</em>::compilationAbbr ) = 2 ; 
<strong>Case</strong> ( <strong>FilterValues</strong> ( <em>reference</em>::compilationAbbr ; 3 &amp; &para; )   &ne;  3 &amp; &para; ; "Comps. and Eds." ;
<strong>Case</strong> ( <strong>FilterValues</strong> ( <em>reference</em>::compilationAbbr ; 1 ) &ne; 1 &amp; &para; ; "Comps. and Trans." ;
<strong>Case</strong> ( <strong>FilterValues</strong> ( <em>reference</em>::compilationAbbr ; 2 ) &ne; 2 &amp; &para; ; "Eds. and Trans." ))) ; 
<strong>Case</strong> ( <em>reference</em>::compilationAbbr = 1 ; "Ed" ; <strong>Case</strong> ( <em>reference</em>::compilationAbbr = 2 ; "Comp" ;  <strong>Case</strong> ( <em>reference</em>::compilationAbbr = 3 ; "Tran" )) ) 
&amp; "s." ))) 
&amp; "), "  )) &amp;   

<strong>//EDITED BOOK OR CONFERENCE PROCEEDINGS
</strong><strong>Case</strong> ( <em>reference</em>::compilationTitle = "" ; "" ; 
<strong>TextStyleAdd</strong> ( <em>reference</em>::compilationTitle ; <strong>Italic</strong> ) ) &amp; 

<strong>//PUBLICATION 
</strong><strong>Case</strong> ( <em>refMedia</em>::key = 3 ; "In "  &amp; <em>reference</em>::compilationEditors ; 
"") &amp; 
<strong>Case</strong> ( <em>reference</em>::compilationTitle &ne; ""  <strong>or</strong> <em>reference</em>::conferenceTitle &ne; "" ; "" ;
<strong>Case</strong> ( <em>reference</em>::korgan &ne; "" ; <strong>TextStyleAdd</strong> ( <em>tagOrgan</em>::tag ;
<strong>Case</strong> ( <em>refMedia</em>::key = 8  <strong>or</strong>  <em>reference</em>::compilationTitle &ne; ""; "" ; <strong>Italic</strong> )))) &amp; 

<strong>//PUBLICATION PUNCTUATION 
</strong><strong>Case</strong> ( <em>reference</em>::compilationTitle &ne; "" <strong>or</strong> <em>reference</em>::conferenceTitle &ne; "" ; "" ;
<strong>Case</strong> ( <em>reference</em>::korgan &ne; "" <strong>and</strong> <em>reference</em>::volumeNumber = "" <strong>and</strong> <em>reference</em>::pageNumberRange = ""  <strong>and</strong> <em>reference</em>::pageNumberOther = ""
 <strong>or</strong> <em>reference</em>::korgan &ne; "" <strong>and</strong> <em>refMediaType</em>::key = 4 ;  ". " ;
<em>reference</em>::korgan &ne; "" <strong>and</strong> <em>reference</em>::volumeNumber &ne; "" <strong>and</strong> <em>reference</em>::pageNumberRange &amp; <em>reference</em>::pageNumberOther = "" ;  ": " ;
<em>reference</em>::korgan &ne; "" <strong>and</strong> <em>reference</em>::volumeNumber = "" <strong>and</strong> <em>reference</em>::pageNumberRange &amp; <em>reference</em>::pageNumberOther &ne; "" ;  ": " ;
<em>reference</em>::korgan &ne; "" <strong>and</strong> <em>reference</em>::volumeNumber &ne; "" <strong>and</strong> <em>reference</em>::pageNumberRange &amp; <em>reference</em>::pageNumberOther &ne; "" ;  ": " 
; "") )  &amp; 

<strong>//PRESENTATION INTRO WORDS
</strong><strong>Case</strong> ( <em>reference</em>::conferenceIntroWords  =  "" ; ""; <em>reference</em>::conferenceIntroWords &amp;  " " ) &amp;

<strong>//PRESENTATION TITLE
</strong><strong>Case</strong> ( <em>reference</em>::conferenceTitle  =  "" ; "" ; <em>reference</em>::conferenceTitle ) &amp; 

<strong>//PRESENTATION SUBTITLE
</strong><strong>Case</strong> ( <em>reference</em>::conferenceSubTitle  =  "" ; "" ; ": " &amp; <em>reference</em>::conferenceSubTitle) &amp; 

<strong>//PRESENTATION LOCATION
</strong><strong>Case</strong> ( <em>reference</em>::conferenceLocation  =  "" ; "" ; 
<strong>Case</strong> ( <em>refMediaType</em>::key = 333 ; ", " &amp; <em>reference</em>::conferenceLocation; ", " &amp; <em>reference</em>::conferenceLocation ) &amp; 
<strong>Case</strong> ( <em>reference</em>::conferenceDate =  "" ; "" ; ", " ) ) &amp; 

<strong>//PRESENTATION DATE
</strong><strong>Case</strong> ( <em>reference</em>::conferenceDate =  "" ; "" ; <em>reference</em>::conferenceDate ) &amp;

<strong>//PRESENTATION PERIOD
</strong><strong>Case</strong> ( <em>reference</em>::conferenceTitle &ne;"" <strong>or</strong> <em>reference</em>::conferenceSubTitle &ne;"" <strong>or</strong> <em>reference</em>::conferenceLocation &ne;"" <strong>or</strong> <em>reference</em>::conferenceDate &ne;"" ; "." ) &amp;

<strong>//EDITED BOOK OR CONFERENCE PROCEEDINGS
</strong><strong>Case</strong> ( <em>reference</em>::compilationTitle &ne; "" <strong>and</strong> <em>reference</em>::volumeNumber = "" <strong>and</strong> <em>reference</em>::pageNumberRange = ""  <strong>and</strong> <em>reference</em>::pageNumberOther = ""  ;  ". " ;
<em>reference</em>::compilationTitle &ne; "" <strong>and</strong> <em>reference</em>::volumeNumber &ne; "" <strong>and</strong> <em>reference</em>::pageNumberRange &amp; <em>reference</em>::pageNumberOther = "" ;  ": " ;
<em>reference</em>::compilationTitle &ne; "" <strong>and</strong> <em>reference</em>::volumeNumber = "" <strong>and</strong> <em>reference</em>::pageNumberRange &amp; <em>reference</em>::pageNumberOther &ne; "" ;  ": " ;
<em>reference</em>::compilationTitle &ne; "" <strong>and</strong> <em>reference</em>::volumeNumber &ne; "" <strong>and</strong> <em>reference</em>::pageNumberRange &amp; <em>reference</em>::pageNumberOther &ne; "" ;  ": " 
; "")  &amp; 

<strong>//VOLUME
</strong><strong>Case</strong> ( <em>reference</em>::volumeNumber  &ne;  "" ; <em>reference</em>::volumeNumber &amp; 

<strong>//ISSUE
</strong><strong>Case</strong> ( <em>reference</em>::issueNumber  =  "" ; "." ) ) &amp; 
<strong>Case</strong> ( <em>reference</em>::issueNumber  &ne;  "" ; "(" &amp; <em>reference</em>::issueNumber &amp; ")" &amp; "." ) &amp; 

<strong>//PAGE RANGE
</strong><strong>Case</strong> ( <em>reference</em>::pageNumberRange &ne; "" <strong>and</strong> <em>refMediaType</em>::key &ne; 4 <strong>and</strong> <em>refMediaType</em>::key &ne; 3; 
<strong>Case</strong> ( <em>reference</em>::pageNumberOther &ne; ""; " " ; " pp. " ) &amp; <em>reference</em>::pageNumberRange &amp; ". " ) &amp; 

<strong>//TIME LENGTH
</strong><strong>Case</strong> ( <em>reference</em>::TimeRange  &ne;  "" ; " Time " &amp; <strong>Hour</strong> ( <em>reference</em>::TimeRange )  &amp; ":" &amp; 
<strong>Case</strong> ( <strong>Length</strong> ( <strong>Minute</strong> ( <em>reference</em>::TimeRange ) )  = 2 ; <strong>Minute</strong> ( <em>reference</em>::TimeRange ) ; "0" &amp; <strong>Minute</strong> ( <em>reference</em>::TimeRange ) ) &amp; ":" &amp; 
<strong>Case</strong> ( <strong>Length</strong> ( <strong>Seconds</strong> ( <em>reference</em>::TimeRange ) )  = 2 ; <strong>Seconds</strong> ( <em>reference</em>::TimeRange ) ; "0" &amp; <strong>Seconds</strong> ( <em>reference</em>::TimeRange ) )
&amp; "."  ) &amp; 


<strong>//PUBLISHER 
</strong><strong>Case</strong> ( <em>reference</em>::publisherLocation  &ne;  "" ; " " &amp; <em>reference</em>::publisherLocation &amp; ":" ; "" ) &amp; " " &amp; <em>tagCopyist</em>::tag &amp; 

<strong>//PUBLISHER PUNCTUATION 
</strong><strong>Case</strong> ( <em>tagCopyist</em>::tag &ne; "" <strong>and</strong> <em>reference</em>::URLdate = "" <strong>and</strong> <em>reference</em>::URL = "" ;  ".  " ;
<em>tagCopyist</em>::tag &ne; "" <strong>and</strong> <em>reference</em>::URLdate &ne; "" <strong>and</strong> <em>reference</em>::URL = "" ;  ". " ;
<em>tagCopyist</em>::tag &ne; "" <strong>and</strong> <em>reference</em>::URLdate = "" <strong>and</strong> <em>reference</em>::URL &ne; "" ;  ". " ;
<em>tagCopyist</em>::tag &ne; "" <strong>and</strong> <em>reference</em>::URLdate &ne; "" <strong>and</strong> <em>reference</em>::URL &ne; "" ;  ". " )  &amp; 

<strong>//MEDIA TYPE
</strong><strong>//Case (refMediaType::key = "" ; "" ; "[" &amp; refMediaType::mediumName &amp;  "] " )  &amp; 
</strong>
<strong>//HEALTH/COPYRIGHT  BEGIN ----
</strong>
<strong>//YEAR
</strong><strong>Case</strong> ( <em>reference</em>::CopyrightYear = ""  ; ""  ; "Copyright " &amp; <em>reference</em>::CopyrightYear ) &amp;

<strong>//YEAR PUNCTUATION
</strong><strong>Case</strong> ( <em>reference</em>::kcopyrightHolder = ""  <strong>and</strong> <em>reference</em>::CopyrightYear &ne; "" <strong>and</strong> <em>reference</em>::copyrightOtherHolder = "" ; "." ; "" )  &amp; 

<strong>//COPYRIGHT HOLDER
</strong><strong>Case</strong> ( <em>reference</em>::CopyrightYear = "" <strong>and</strong> <em>reference</em>::kHealth &ne; "" ; "Copyright" )  &amp; 
<strong>Case</strong> ( <em>reference</em>::kcopyrightHolder &ne; ""  ;  " by the" ;
<strong>Case</strong> ( <em>reference</em>::copyrightOtherHolder &ne; "" ; " by" ; "" ) ) &amp; 

<strong>//AUTHOR
</strong><strong>Case</strong> ( (<em>reference</em>::referenceNodes &amp; "&para;"  = <strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; <em>reference</em>::referenceNodes &amp; "&para;" ) <strong>and</strong> <em>reference</em>::kcopyrightHolder &ne; "")
<strong>or</strong> ("node738fds8ef"  &amp; "&para;"  = <strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; "node738fds8ef"  &amp; "&para;" ))
<strong>or</strong> ("governmentAuthor6767767676"  &amp; "&para;"  = <strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; "governmentAuthor6767767676"  &amp; "&para;" )) ;  " Author" ; "" )  &amp; 

<strong>//AUTHOR "AND"
</strong><strong>Case</strong> ( ("node738fds8ef"  &amp; "&para;"  = <strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; "node738fds8ef"  &amp; "&para;" ) <strong>or</strong> 
 "governmentAuthor6767767676"  &amp; "&para;"  = <strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; "governmentAuthor6767767676"  &amp; "&para;" ) <strong>or</strong>
(<em>reference</em>::referenceNodes &amp; "&para;" = <strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; <em>reference</em>::referenceNodes &amp; "&para;" )  <strong>and</strong> <em>reference</em>::kcopyrightHolder &ne; "" ) )

 <strong>and</strong> <strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; "editors857398f839" &amp; "&para;" ) 
   +    <strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; <em>reference</em>::korgan &amp; "&para;" )  
   +    <strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; <em>reference</em>::kcopyist &amp; "&para;" ) &gt; 0   

 <strong>or</strong> 

("node738fds8ef"  &amp; "&para;"  = <strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; "node738fds8ef"  &amp; "&para;" ) <strong>or</strong> 
"governmentAuthor6767767676"  &amp; "&para;"  = <strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; "governmentAuthor6767767676"  &amp; "&para;" ) <strong>or</strong>
(<em>reference</em>::referenceNodes &amp; "&para;" = <strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; <em>reference</em>::referenceNodes &amp; "&para;" )  <strong>and</strong> <em>reference</em>::kcopyrightHolder &ne; "" ) )

 <strong>and</strong> <em>reference</em>::copyrightOtherHolder &ne; "" ; " and" ; "") &amp; 

<strong>//EDITOR
</strong><strong>Case</strong> ( "editors857398f839" &amp; "&para;"  = <strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; "editors857398f839" &amp; "&para;" ) ;  " Editor" ; "" )  &amp; 

<strong>//EDITOR "AND"
</strong><strong>Case</strong> ( <strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; "editors857398f839" &amp; "&para;" )   &ne; ""
<strong>and</strong> (<strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; <em>reference</em>::korgan &amp; "&para;" )
 <strong>or</strong> <strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; <em>reference</em>::kcopyist &amp; "&para;" )) = 1; " and" ; "")  &amp; 

<strong>//PUBLICATION
</strong><strong>Case</strong> ( <em>reference</em>::korgan &amp; "&para;"  = <strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; <em>reference</em>::korgan &amp; "&para;" ) ;  
<strong>Case</strong> (<em>refMediaType</em>::key = 3 ; " Website" ; " Publication" ) )  &amp; 

<strong>//PUBLICATION "AND"
</strong><strong>Case</strong> ( <strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; <em>reference</em>::korgan &amp; "&para;" )   &gt; 0
<strong>and</strong> <strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; <em>reference</em>::kcopyist &amp; "&para;" )  &gt; 0; " and" ; "")  &amp; 

<strong>//PUBLISHER
</strong><strong>Case</strong> ( <em>reference</em>::kcopyist &amp; "&para;"  = <strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; <em>reference</em>::kcopyist &amp; "&para;" ) ;  
<strong>Case</strong> ( <em>reference</em>::publisherTypeAlternative = 3 ; " " &amp; <em>reference</em>::publisherTypeOther ; 
<strong>Case</strong> ( <em>reference</em>::publisherTypeAlternative = 2 ;  " Sponsor" ; 
<strong>Case</strong> ( <em>reference</em>::publisherTypeAlternative = 1 ; " Distributor" ;
<strong>Case</strong> ( <em>reference</em>::publisherTypeOther &ne; "" ; " " &amp; <em>reference</em>::publisherTypeOther ;
<strong>Case</strong> ( <em>reference</em>::publisherTypeAlternative = ""  ; " Publisher"  ))))))  &amp; 

<strong>//PUBLISHER "AND"
</strong><strong>Case</strong> ( <em>reference</em>::kcopyrightHolder &ne; ""
<strong>and</strong> <em>reference</em>::copyrightOtherHolder &ne; ""; " and" ; "")  &amp; 

<strong>//OTHER COPYRIGHT HOLDER
</strong><strong>Case</strong> ( <em>reference</em>::copyrightOtherHolder &ne; "" ;  " " &amp; <em>reference</em>::copyrightOtherHolder )  &amp; 

<strong>//COPYRIGHT HOLDER PUNCTUATION
</strong><strong>Case</strong> ( <em>reference</em>::kcopyrightHolder = "" <strong>and</strong> <em>reference</em>::copyrightOtherHolder = ""  ; ""  ; ".") &amp; 

<strong>//COPYRIGHT RESTRICTIONS
</strong><strong>Case</strong> (<em>reference</em>::kHealth = 8102011220941282 ; " All rights reserved." ;
<em>reference</em>::kHealth = 31620121746441229 ; " Creative Commons Attribution 3.0 Unported License." ;

<em>reference</em>::kHealth = 31620121841541232 ; " Creative Commons Attribution-ShareAlike 3.0 Unported License." ;

<em>reference</em>::kHealth = 31620121902441234 ; " Creative Commons Attribution-NoDerivs 3.0 Unported License." ;

<em>reference</em>::kHealth = 31620121837161231 ; " Creative Commons Attribution-NonCommercial 3.0 Unported License." ;

<em>reference</em>::kHealth = 121620112002051049 ; " Creative Commons Attribution-NonCommercial-NoDerivs 3.0 Unported License." ;

<em>reference</em>::kHealth = 8162011231825326 ; " Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License." ;


<em>reference</em>::kHealth = 8162011231722325 ; " All rights reserved." ;

<em>tagHealth</em>::tag &ne; "" ; " " &amp; 

<strong>Case</strong> ( <strong>Right</strong> ( <em>tagHealth</em>::tag ; 1 ) = "." ; <em>tagHealth</em>::tag ; <em>tagHealth</em>::tag &amp; "." ) ; "" )  &amp; 

<strong>//END COPYRIGHT HOLDER  ------
</strong>
<strong>//ISBN as in B as in Blam!
</strong><strong>Case</strong> ( <em>reference</em>::ISBN = ""  <strong>or</strong> <em>reference</em>::library only &ne; "" ; ""  ; 
<strong>Case</strong> ( <em>reference</em>::URL = "" ; " ISBN search: http://www.worldcat.org/search?q=bn%3A" &amp; <em>reference</em>::ISBN ;
" ISBN: " &amp; <em>reference</em>::ISBN &amp; "." ) ) &amp; 

<strong>Case</strong> ( <em>reference</em>::URLdoi = ""  ; ""  ; 
<strong>Case</strong> ( <em>reference</em>::library only = "" ;
<strong>Case</strong> ( <em>reference</em>::URL = "" <strong>and</strong> <em>reference</em>::URLdate = "" ; " DOI link: http://dx.doi.org/" &amp; <em>reference</em>::URLdoi  ;
" DOI: " &amp; <em>reference</em>::URLdoi &amp; "." ) ) ) &amp; 

<strong>//ISSN as in S as in Sam!
</strong><strong>Case</strong> ( <em>reference</em>::ISSN = "" <strong>or</strong> <em>reference</em>::library only &ne; ""; ""  ; 
<strong>Case</strong> ( <em>reference</em>::URL = "" ; " ISSN search: http://www.worldcat.org/ISSN/" &amp; <em>reference</em>::ISSN ;
" ISSN: " &amp; <em>reference</em>::ISSN &amp; "." ) ) &amp; 

<strong>//DOI (hide url and show doi)
</strong><strong>//Case ( reference::URLdoi = "" ; ""  ; 
</strong><strong>//Case ( reference::URL = "" and reference::URLdate = "" and reference::library only = "" ; " DOI search: http://dx.doi.org/" &amp; reference::URLdoi) ) &amp; 
</strong>
<strong>//URL 
</strong><strong>Case</strong> (<em>reference</em>::library only &ne; "" ; 
<strong>Case</strong> (<em>reference</em>::URLdoi &ne; "" ; 
<strong>Case</strong> (<em>reference</em>::ISSN &ne; "" <strong>and</strong> <em>reference</em>::ISBN &ne; "" ; " Library ISBN search: http://www.worldcat.org/search?q=bn%3A" &amp; <em>reference</em>::ISBN &amp; " or " &amp; "ISSN search http://www.worldcat.org/ISSN/" &amp; <em>reference</em>::ISSN ;
<strong>Case</strong> (<em>reference</em>::ISSN &ne; "" ; " Library ISSN search: http://www.worldcat.org/ISSN/" &amp; <em>reference</em>::ISSN ; 
<strong>Case</strong> (<em>reference</em>::ISBN &ne; "" ; " Library ISBN search: http://www.worldcat.org/search?q=bn%3A" &amp; <em>reference</em>::ISBN ;
" Library copy: http://www.worldcat.org" )))  &amp; " or Publisher's copy: " &amp; 
<strong>Case</strong> ( <strong>Left</strong> (<em>reference</em>::URLdoi ; 4 )  &ne;  "doi: " ; "http://dx.doi.org/"  &amp; <em>reference</em>::URLdoi &amp; " )    " ;
"http://dx.doi.org/"  &amp; <strong>Middle</strong> (<em>reference</em>::URLdoi ; 5; 99 ) &amp; " )   " ) ;
" Library copy: http://www.worldcat.org   " ) ;
<strong>Case</strong> ( <em>reference</em>::URLdate = "" ; 
<strong>Case</strong> ( <em>reference</em>::URLdate = "" <strong>and</strong> <em>reference</em>::URL = "" ; "" ; " Website: " &amp; <em>reference</em>::URL ) ;
<strong>Case</strong> (<em>reference</em>::library only &ne; "" ; "" ; " Retrieved " &amp; <strong>Month</strong>( <em>reference</em>::URLdate ) &amp; "/" &amp; <strong>Day</strong> ( <em>reference</em>::URLdate ) &amp; "/" &amp; <strong>Year</strong> ( <em>reference</em>::URLdate ) )  &amp; 
<strong>Case</strong> (<em>reference</em>::URL = "" ; <strong>Case</strong> ( <em>reference</em>::URLdate = "" <strong>and</strong> <em>reference</em>::URL = "" ; "" ; <strong>TextColor</strong> ( " URL not entered.  " ; <strong>RGB</strong> ( 119 ; 119 ; 119 ) ) ) ; 
" from " ) &amp; 
<em>reference</em>::URL  &amp; "  ") ) ; 

<strong>//REFERENCE DUMP
</strong><em>reference</em>::referenceDump )</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Do not store calculation results</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279327FieldAnchor_"/>referenceShort</td><td>Calculated, Text</td><td><strong>Calculation:</strong>
<ul>
<li>Context table: <em>reference</em>
</li>
<li>
<strong>LeftWords</strong> (  
<strong>If</strong> ( <em>reference</em>::referenceNodes &ne; "" ; <em>reference</em>::referenceNodes ;  

<strong>//TextStyleAdd ( 
</strong>
<em>tagNodePrimary</em>::tag 

<strong>//; Bold ) 
</strong>
&amp; 

<strong>If</strong> ( <em>reference</em>::NodeOthers = "" ; "" ; "; " &amp; <em>reference</em>::NodeOthers ) ) 
; 2 )&amp; 

<strong>//PUB DATE
</strong><strong>Case</strong> (<em>TEMP</em>::InventoryLibaryYN &ne; "" ; "" ;
<strong>//NONE
</strong><strong>Case</strong> ( <em>reference</em>::pubYear = "" <strong>and</strong> <em>reference</em>::PubDate = "" <strong>and</strong> <em>reference</em>::pubDateOther = "" ;
<strong>//DATE
</strong><em>reference</em>::PubDate &ne; "" ; " (" &amp; <strong>Year</strong> ( <em>reference</em>::PubDate ) &amp; ", " &amp; <strong>MonthName</strong> ( <em>reference</em>::PubDate ) &amp; " " &amp; <strong>Day</strong> ( <em>reference</em>::PubDate ) &amp; "). "  ; 
<strong>//DATE RANGER
</strong><em>reference</em>::pubDateOther &ne; ""  ; " (" &amp; <em>reference</em>::pubDateOther &amp; "). "  ; 
<strong>//ONLY YEAR
</strong><em>reference</em>::pubYear &ne; ""  ; " (" &amp; <em>reference</em>::pubYear  &amp; "). " ) ) &amp; 


<strong>If</strong> ( <em>reference</em>::Title &ne; "" ; <em>reference</em>::Title ; "filename: " &amp; <em>reference</em>::fileName )  &amp; ".  " &amp; 


<strong>//WORD KEYWORD
</strong><strong>TextColor</strong> (  
<strong>Case</strong> (<em>tagKeywordPrimary</em>::tag = ""  <strong>and</strong> <em>reference</em>::OtherKeyWords = "" ; "" ;
<em>tagKeywordPrimary</em>::tag  &ne;  ""  <strong>and</strong> <em>reference</em>::OtherKeyWords = "" ; "keyword:  " ;
<em>tagKeywordPrimary</em>::tag  &ne;  ""  <strong>and</strong> <em>reference</em>::OtherKeyWords  &ne;  "" ; "keywords: " ;
<em>tagKeywordPrimary</em>::tag = ""  <strong>and</strong> <strong>ValueCount</strong> ( <em>reference</em>::kkeywordOther ) &gt; 1 ; "keywords: " ;
<em>tagKeywordPrimary</em>::tag = ""  <strong>and</strong> <strong>ValueCount</strong> ( <em>reference</em>::kkeywordOther )  =  1 ; "keyword: " ) &amp; 

<strong>If</strong> ( <em>reference</em>::kkeywordPrimary = "" ; "" ;  

<strong>//TextStyleAdd ( 
</strong><em>tagKeywordPrimary</em>::tag 
<strong>//; Bold )
</strong> ) &amp; 

<strong>If</strong> ( <em>reference</em>::kkeywordOther = "" ; "" ; ", " &amp; <em>reference</em>::OtherKeyWords )

; <strong>RGB</strong> ( 130 ; 130 ; 130 ) )</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Do not store calculation results</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279328FieldAnchor_"/>referenceNodes</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
<li>Index Language: English</li>
</ul>
</td><td>usedAsThePlaceToPasteCopyOfNodeListAsItAppearsOnPublication</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279347FieldAnchor_"/>mFileLocation</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
<li>Do not replace existing value for field (if any)</li>
<li>Context table: <em>reference</em>
<br>Calculation: "fileLocation"</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>matchFieldForValueListFolderLocationValuesMainOtherAndx</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279342FieldAnchor_"/>referenceNodesOLD</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>usedByChangeSpellingOfCitationNodesScriptToKnowIfSpellingHasBeenChangedAndToChangeKeyInCopyrightHolderField</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279343FieldAnchor_"/>filterFind</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td>usedToLimitRecordToSpecificFindsLikeLibraryOrTagCitations</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279344FieldAnchor_"/>picture</td><td>Normal, Binary</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
</ul>
</td><td>pictureThatWasNotCreatedByUser</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279345FieldAnchor_"/>kfileLocation</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>conditionalFormatsFieldsRequiredToBeFilledInBasedOnWhereFileIsLocated</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279346FieldAnchor_"/>rights</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
</ul>
</td><td>checkboxOfAllCreativeCommonsDefinitionOfRights</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279349FieldAnchor_"/>kcitation</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>ifDerivativeWorkThisFieldCapturesCitationOfOrginalWork</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279350FieldAnchor_"/>incomplete</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>checkboxForUserToFlagARecordAsNeedingMoreInfo</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279351FieldAnchor_"/>lock</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>usedToPreventChangesToRecord</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279352FieldAnchor_"/>referenceNodeAndTitle</td><td>Calculated, Text</td><td><strong>Calculation:</strong>
<ul>
<li>Context table: <em>reference</em>
</li>
<li>
<strong>TextStyleAdd</strong> ( <em>tagNodePrimary</em>::tag ; <strong>Bold</strong> ) &amp; ".  " &amp; 

<em>reference</em>::Title</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Do not store calculation results</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279353FieldAnchor_"/>kcreatorNode</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
<li>Do not replace existing value for field (if any)</li>
<li>Context table: <em>reference</em>
<br>Calculation: <em>TEMP</em>::kdefaultNodePrimary</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
</ul>
</td><td>keyOfRecordCreatorNode</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279354FieldAnchor_"/>kmodifierNode</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
<li>Do not replace existing value for field (if any)</li>
<li>Context table: <em>reference</em>
<br>Calculation: <em>TEMP</em>::kdefaultNodePrimary</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>keyOfRecordModifierNode</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279355FieldAnchor_"/>modifyDate</td><td>Normal, Timestamp</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Modification timestamp</li>
<li>Allow editing</li>
<li>Do not replace existing value for field (if any)</li>
<li>Context table: <em>reference</em>
<br>Calculation: <strong>Get</strong> ( <strong>CurrentTimeStamp</strong> )</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td>dateRecordWasModified</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279356FieldAnchor_"/>referenceForReferenceWindow</td><td>Calculated, Text</td><td><strong>Calculation:</strong>
<ul>
<li>Context table: <em>reference</em>
</li>
<li>
<strong>Case</strong> (
<em>reference</em>::referenceNodes &ne; ""
<strong>or</strong> <em>tagNodePrimary</em>::tag &ne; ""
<strong>or</strong> <em>reference</em>::NodeOthers &ne; "" 
<strong>or</strong> <em>reference</em>::pubYear &ne; "" 
<strong>or</strong> <em>reference</em>::PubDate &ne; "" 
<strong>or</strong> <em>reference</em>::Title &ne; "" 
<strong>or</strong> <em>reference</em>::korgan &ne; "" 
<strong>or</strong> <em>reference</em>::volumeNumber &ne; "" 
<strong>or</strong> <em>reference</em>::issueNumber &ne; "" 
<strong>or</strong> <em>reference</em>::pageNumberRange &ne; "" 
<strong>or</strong> <em>reference</em>::TimeRange &ne; "" 
<strong>or</strong> <em>tagCopyist</em>::tag &ne; ""
<strong>or</strong> <em>reference</em>::URL &ne; "" <strong>and</strong> <em>reference</em>::referenceDump = ""
<strong>or</strong> <em>reference</em>::URLdate &ne; ""
<strong>or</strong> <em>tagHealth</em>::tag &ne; ""
<strong>or</strong> <em>reference</em>::CopyrightYear &ne; "" ;

<strong>//GOVT AUTHOR 
</strong><strong>Case</strong> ( <em>reference</em>::governmentAuthor = "" ; 

<strong>//NODE
</strong><strong>Case</strong> ( <em>reference</em>::referenceNodes &ne; "" ; <em>reference</em>::referenceNodes ; 
<strong>Case</strong> ( <em>reference</em>::governmentAuthor = "" <strong>and</strong> <em>reference</em>::referenceNodes  =  "" <strong>and</strong> <em>tagNodePrimary</em>::tag = "" <strong>and</strong> <em>reference</em>::NodeOthers = "" ; 
<strong>Case</strong> ( <em>reference</em>::compilationTitle = "" <strong>and</strong> <em>refMedia</em>::NOitalics = "" <strong>and</strong> <em>reference</em>::korgan = "" ; <strong>TextStyleAdd</strong> ( <em>reference</em>::Title ; <strong>Italic</strong> ) ; <em>reference</em>::Title ) &amp; 
<strong>//INFO TYPE
</strong><strong>Case</strong> (<em>refMedia</em>::mediumName = "" ; "" ; " [" &amp; 
<strong>Case</strong> (
<em>refMediaType</em>::typeName = ""  <strong>and</strong> <em>refMediaType</em>::type &ne; " other"; 
<strong>Case</strong> ( <em>refMediaType</em>::key = 1 <strong>and</strong> <em>refMedia</em>::key = 200 ; "Web " &amp; <em>refMedia</em>::mediumName ;
<strong>TextStyleAdd</strong> ( <strong>Left</strong> ( <em>refMedia</em>::mediumName ; 1 ) ; <strong>Uppercase</strong> )  &amp;  <strong>Middle</strong> ( <em>refMedia</em>::mediumName ; 2 ; 99 ) ) ;
<strong>Case</strong> (
<em>refMedia</em>::mediumName = "" ; 
<strong>Case</strong> ( <em>refMediaType</em>::type = " other" ; <em>reference</em>::TypeOfMediumOther ; <em>refMediaType</em>::typeName ) ;
<strong>Case</strong> ( <em>refMediaType</em>::type = " other" ; <em>reference</em>::TypeOfMediumOther ; <em>refMediaType</em>::typeName ) &amp; " "  &amp; <em>refMedia</em>::mediumName )) &amp;
<strong>Case</strong> ( <em>reference</em>::bookChapter &ne; "" ; " "  &amp; <em>reference</em>::bookChapter &amp; "]" ; "]" ) ) )  &amp; 
<strong>Case</strong> ( <em>reference</em>::referenceNodes  =  "" <strong>and</strong> <em>tagNodePrimary</em>::tag &ne; "" ; <em>tagNodePrimary</em>::tag  ) &amp; 
<strong>Case</strong> ( <em>reference</em>::NodeOthers &ne; "" <strong>and</strong> <em>tagNodePrimary</em>::tag = "" ; <em>reference</em>::NodeOthers ;  
<strong>Case</strong> ( <em>reference</em>::NodeOthers &ne; "" <strong>and</strong> <em>tagNodePrimary</em>::tag &ne; "" ;    "; " &amp; <em>reference</em>::NodeOthers ) ) ) 

 ; <em>reference</em>::governmentAuthor ) &amp;

<strong>//PUB DATE
</strong><strong>Case</strong> (<em>TEMP</em>::InventoryLibaryYN &ne; "" ; "" ;
<strong>//NONE
</strong><strong>Case</strong> ( <em>reference</em>::pubYear = "" <strong>and</strong> <em>reference</em>::PubDate = "" <strong>and</strong> <em>reference</em>::pubDateOther = "" ;
<strong>//DATE
</strong><em>reference</em>::PubDate &ne; "" ; " (" &amp; <strong>Year</strong> ( <em>reference</em>::PubDate ) &amp; ", " &amp; <strong>MonthName</strong> ( <em>reference</em>::PubDate ) &amp; " " &amp; <strong>Day</strong> ( <em>reference</em>::PubDate ) &amp; "). "  ; 
<strong>//DATE RANGER
</strong><em>reference</em>::pubDateOther &ne; ""  ; " (" &amp; <em>reference</em>::pubDateOther &amp; "). "  ; 
<strong>//ONLY YEAR
</strong><em>reference</em>::pubYear &ne; ""  ; " (" &amp; <em>reference</em>::pubYear  &amp; "). " ) ) &amp; 

<strong>//REF TITLE 
</strong><strong>Case</strong> ( <em>reference</em>::referenceNodes  =  "" <strong>and</strong> <em>tagNodePrimary</em>::tag = "" <strong>and</strong> <em>reference</em>::NodeOthers = "" <strong>and</strong> <em>reference</em>::governmentAuthor = "" ; "" ;
<strong>Case</strong> ( <em>reference</em>::Title = "" ; "" ; 
<strong>Case</strong> ( <em>reference</em>::compilationTitle = "" <strong>and</strong> <em>refMedia</em>::NOitalics = "" <strong>and</strong> <em>reference</em>::korgan = "" ; <strong>TextStyleAdd</strong> ( <em>reference</em>::Title ; <strong>Italic</strong> ) ; <em>reference</em>::Title ) &amp;

<strong>//INFO TYPE
</strong><strong>Case</strong> (<em>refMedia</em>::mediumName = "" ; "" ; " [" &amp; 
<strong>Case</strong> (
<em>refMediaType</em>::typeName = ""  <strong>and</strong> <em>refMediaType</em>::type &ne; " other"; 
<strong>Case</strong> ( <em>refMediaType</em>::key = 1 <strong>and</strong> <em>refMedia</em>::key = 200 ; "Web " &amp; <em>refMedia</em>::mediumName ;
<strong>TextStyleAdd</strong> ( <strong>Left</strong> ( <em>refMedia</em>::mediumName ; 1 ) ; <strong>Uppercase</strong> )  &amp;  <strong>Middle</strong> ( <em>refMedia</em>::mediumName ; 2 ; 99 ) ) ;
<strong>Case</strong> (
<em>refMedia</em>::mediumName = "" ; 
<strong>Case</strong> ( <em>refMediaType</em>::type = " other" ; <em>reference</em>::TypeOfMediumOther ; <em>refMediaType</em>::typeName ) ;
<strong>Case</strong> ( <em>refMediaType</em>::type = " other" ; <em>reference</em>::TypeOfMediumOther ; <em>refMediaType</em>::typeName ) &amp; " "  &amp; <em>refMedia</em>::mediumName )) &amp;
<strong>Case</strong> ( <em>reference</em>::bookChapter &ne; "" ; " "  &amp; <em>reference</em>::bookChapter &amp; "]" ; "]" ) ) &amp; 
 ". " ) ) &amp; 

<strong>//UNIVERSITY
</strong><strong>Case</strong> ( <em>reference</em>::dissertationThesisUniversity  &ne; "" ; <em>reference</em>::dissertationThesisUniversity &amp; ". " ) &amp; 

<strong>//GOVERNMENT AUTHOR continued
</strong><strong>Case</strong> ( <em>reference</em>::governmentAuthor  &ne; "" ;
<strong>Case</strong> ( <em>reference</em>::knodePrimary  =  "" <strong>and</strong> <em>reference</em>::knodeOther = "" <strong>and</strong> <em>reference</em>::referenceNodes = "" ; "" ; "By " &amp; 

<strong>//NODE continued
</strong><strong>Case</strong> ( <em>reference</em>::referenceNodes &ne; "" ; <em>reference</em>::referenceNodes ; 
<strong>Case</strong> ( <em>reference</em>::referenceNodes  =  "" <strong>and</strong> <em>tagNodePrimary</em>::tag &ne; "" ; <em>tagNodePrimary</em>::tag  ) &amp; 
<strong>Case</strong> ( <em>reference</em>::NodeOthers &ne; "" <strong>and</strong> <em>tagNodePrimary</em>::tag = "" ; <em>reference</em>::NodeOthers ;  
<strong>Case</strong> ( <em>reference</em>::NodeOthers &ne; "" <strong>and</strong> <em>tagNodePrimary</em>::tag &ne; "" ;    "; " &amp; <em>reference</em>::NodeOthers ) ) ) 
 &amp; ". " ) ) &amp;

<strong>//GOVT DOC INFO 
</strong><strong>Case</strong> ( <em>reference</em>::GovernmentDocInfo = "" ; "" ; "(" &amp; <em>reference</em>::GovernmentDocInfo &amp; "). " ) &amp;

<strong>//EMAIL RECIPIENT'S NAME
</strong><strong>Case</strong> ( <em>reference</em>::emailRecipient = ""; "" ; 
"Received by " &amp; <em>reference</em>::emailRecipient &amp; ". " ) &amp; 

<strong>//EDITORS OF PUBLICATION
</strong><strong>Case</strong> ( <em>reference</em>::compilationEditors = ""; "" ; "In "  &amp; <em>reference</em>::compilationEditors &amp; 
<strong>Case</strong> ( <em>reference</em>::compilationAbbr = "" ; ": " ; " ("  &amp; 
<strong>Case</strong> ( <em>reference</em>::compilationNumberOfEditors = "" ;
<strong>Case</strong> ( <strong>ValueCount</strong> ( <em>reference</em>::compilationAbbr ) = 3 ; "Comp., Ed. and Trans." ; 
<strong>Case</strong> ( <strong>ValueCount</strong> ( <em>reference</em>::compilationAbbr ) = 2 ; 
<strong>Case</strong> ( <strong>FilterValues</strong> ( <em>reference</em>::compilationAbbr ; 3 &amp; &para; )   &ne;  3 &amp; &para; ; "Comp. and Ed." ;
<strong>Case</strong> ( <strong>FilterValues</strong> ( <em>reference</em>::compilationAbbr ; 1 ) &ne; 1 &amp; &para; ; "Comp. and Trans." ;
<strong>Case</strong> ( <strong>FilterValues</strong> ( <em>reference</em>::compilationAbbr ; 2 ) &ne; 2 &amp; &para; ; "Ed. and Trans." ))) ; 
<strong>Case</strong> ( <em>reference</em>::compilationAbbr = 1 ; "Ed." ; <strong>Case</strong> ( <em>reference</em>::compilationAbbr = 2 ; "Comp." ;  <strong>Case</strong> ( <em>reference</em>::compilationAbbr = 3 ; "Trans." )))  )) ;
<strong>//2 OR MORE
</strong><strong>Case</strong> ( <strong>ValueCount</strong> ( <em>reference</em>::compilationAbbr ) = 3 ; "Comps., Eds. and Trans." ; 
<strong>Case</strong> ( <strong>ValueCount</strong> ( <em>reference</em>::compilationAbbr ) = 2 ; 
<strong>Case</strong> ( <strong>FilterValues</strong> ( <em>reference</em>::compilationAbbr ; 3 &amp; &para; )   &ne;  3 &amp; &para; ; "Comps. and Eds." ;
<strong>Case</strong> ( <strong>FilterValues</strong> ( <em>reference</em>::compilationAbbr ; 1 ) &ne; 1 &amp; &para; ; "Comps. and Trans." ;
<strong>Case</strong> ( <strong>FilterValues</strong> ( <em>reference</em>::compilationAbbr ; 2 ) &ne; 2 &amp; &para; ; "Eds. and Trans." ))) ; 
<strong>Case</strong> ( <em>reference</em>::compilationAbbr = 1 ; "Ed" ; <strong>Case</strong> ( <em>reference</em>::compilationAbbr = 2 ; "Comp" ;  <strong>Case</strong> ( <em>reference</em>::compilationAbbr = 3 ; "Tran" )) ) 
&amp; "s." ))) 
&amp; "), "  )) &amp;   

<strong>//EDITED BOOK OR CONFERENCE PROCEEDINGS
</strong><strong>Case</strong> ( <em>reference</em>::compilationTitle = "" ; "" ; 
<strong>TextStyleAdd</strong> ( <em>reference</em>::compilationTitle ; <strong>Italic</strong> ) ) &amp; 

<strong>//PUBLICATION 
</strong><strong>Case</strong> ( <em>refMedia</em>::key = 3 ; "In "  &amp; <em>reference</em>::compilationEditors ; 
"") &amp; 
<strong>Case</strong> ( <em>reference</em>::compilationTitle &ne; ""  <strong>or</strong> <em>reference</em>::conferenceTitle &ne; "" ; "" ;
<strong>Case</strong> ( <em>reference</em>::korgan &ne; "" ; <strong>TextStyleAdd</strong> ( <em>tagOrgan</em>::tag ;
<strong>Case</strong> ( <em>refMedia</em>::key = 8  <strong>or</strong>  <em>reference</em>::compilationTitle &ne; ""; "" ; <strong>Italic</strong> )))) &amp; 

<strong>//PUBLICATION PUNCTUATION 
</strong><strong>Case</strong> ( <em>reference</em>::compilationTitle &ne; "" <strong>or</strong> <em>reference</em>::conferenceTitle &ne; "" ; "" ;
<strong>Case</strong> ( <em>reference</em>::korgan &ne; "" <strong>and</strong> <em>reference</em>::volumeNumber = "" <strong>and</strong> <em>reference</em>::pageNumberRange = ""  <strong>and</strong> <em>reference</em>::pageNumberOther = ""
 <strong>or</strong> <em>reference</em>::korgan &ne; "" <strong>and</strong> <em>refMediaType</em>::key = 4 ;  ". " ;
<em>reference</em>::korgan &ne; "" <strong>and</strong> <em>reference</em>::volumeNumber &ne; "" <strong>and</strong> <em>reference</em>::pageNumberRange &amp; <em>reference</em>::pageNumberOther = "" ;  ": " ;
<em>reference</em>::korgan &ne; "" <strong>and</strong> <em>reference</em>::volumeNumber = "" <strong>and</strong> <em>reference</em>::pageNumberRange &amp; <em>reference</em>::pageNumberOther &ne; "" ;  ": " ;
<em>reference</em>::korgan &ne; "" <strong>and</strong> <em>reference</em>::volumeNumber &ne; "" <strong>and</strong> <em>reference</em>::pageNumberRange &amp; <em>reference</em>::pageNumberOther &ne; "" ;  ": " 
; "") )  &amp; 

<strong>//PRESENTATION INTRO WORDS
</strong><strong>Case</strong> ( <em>reference</em>::conferenceIntroWords  =  "" ; ""; <em>reference</em>::conferenceIntroWords &amp;  " " ) &amp;

<strong>//PRESENTATION TITLE
</strong><strong>Case</strong> ( <em>reference</em>::conferenceTitle  =  "" ; "" ; <em>reference</em>::conferenceTitle) &amp; 

<strong>//PRESENTATION SUBTITLE
</strong><strong>Case</strong> ( <em>reference</em>::conferenceSubTitle  =  "" ; "" ; ": " &amp; <em>reference</em>::conferenceSubTitle) &amp; 

<strong>//PRESENTATION LOCATION
</strong><strong>Case</strong> ( <em>reference</em>::conferenceLocation  =  "" ; "" ; 
<strong>Case</strong> ( <em>refMediaType</em>::key = 333 ; ", " &amp; <em>reference</em>::conferenceLocation; ", " &amp; <em>reference</em>::conferenceLocation ) &amp; 
<strong>Case</strong> ( <em>reference</em>::conferenceDate =  "" ; "" ; ", " ) ) &amp; 

<strong>//PRESENTATION DATE
</strong><strong>Case</strong> ( <em>reference</em>::conferenceDate =  "" ; "" ; <em>reference</em>::conferenceDate ) &amp;

<strong>//PRESENTATION PERIOD
</strong><strong>Case</strong> ( <em>reference</em>::conferenceTitle &ne;"" <strong>or</strong> <em>reference</em>::conferenceSubTitle &ne;"" <strong>or</strong> <em>reference</em>::conferenceLocation &ne;"" <strong>or</strong> <em>reference</em>::conferenceDate &ne;"" ; "." ) &amp;

<strong>//EDITED BOOK OR CONFERENCE PROCEEDINGS
</strong><strong>Case</strong> ( <em>reference</em>::compilationTitle &ne; "" <strong>and</strong> <em>reference</em>::volumeNumber = "" <strong>and</strong> <em>reference</em>::pageNumberRange = ""  <strong>and</strong> <em>reference</em>::pageNumberOther = ""  ;  ". " ;
<em>reference</em>::compilationTitle &ne; "" <strong>and</strong> <em>reference</em>::volumeNumber &ne; "" <strong>and</strong> <em>reference</em>::pageNumberRange &amp; <em>reference</em>::pageNumberOther = "" ;  ": " ;
<em>reference</em>::compilationTitle &ne; "" <strong>and</strong> <em>reference</em>::volumeNumber = "" <strong>and</strong> <em>reference</em>::pageNumberRange &amp; <em>reference</em>::pageNumberOther &ne; "" ;  ": " ;
<em>reference</em>::compilationTitle &ne; "" <strong>and</strong> <em>reference</em>::volumeNumber &ne; "" <strong>and</strong> <em>reference</em>::pageNumberRange &amp; <em>reference</em>::pageNumberOther &ne; "" ;  ": " 
; "")  &amp; 

<strong>//VOLUME
</strong><strong>Case</strong> ( <em>reference</em>::volumeNumber  &ne;  "" ; <em>reference</em>::volumeNumber &amp; 

<strong>//ISSUE
</strong><strong>Case</strong> ( <em>reference</em>::issueNumber  =  "" ; "." ) ) &amp; 
<strong>Case</strong> ( <em>reference</em>::issueNumber  &ne;  "" ; "(" &amp; <em>reference</em>::issueNumber &amp; ")" &amp; "." ) &amp; 

<strong>//PAGE RANGE
</strong><strong>Case</strong> ( <em>reference</em>::pageNumberRange &ne; "" <strong>and</strong> <em>refMediaType</em>::key &ne; 4 <strong>and</strong> <em>refMediaType</em>::key &ne; 3; 
<strong>Case</strong> ( <em>reference</em>::pageNumberOther &ne; ""; " " ; " pp. " ) &amp; <em>reference</em>::pageNumberRange &amp; ". " ) &amp; 

<strong>//TIME LENGTH
</strong><strong>Case</strong> ( <em>reference</em>::TimeRange  &ne;  "" ; " Time " &amp; <strong>Hour</strong> ( <em>reference</em>::TimeRange )  &amp; ":" &amp; 
<strong>Case</strong> ( <strong>Length</strong> ( <strong>Minute</strong> ( <em>reference</em>::TimeRange ) )  = 2 ; <strong>Minute</strong> ( <em>reference</em>::TimeRange ) ; "0" &amp; <strong>Minute</strong> ( <em>reference</em>::TimeRange ) ) &amp; ":" &amp; 
<strong>Case</strong> ( <strong>Length</strong> ( <strong>Seconds</strong> ( <em>reference</em>::TimeRange ) )  = 2 ; <strong>Seconds</strong> ( <em>reference</em>::TimeRange ) ; "0" &amp; <strong>Seconds</strong> ( <em>reference</em>::TimeRange ) )
&amp; "."  ) &amp; 


<strong>//PUBLISHER 
</strong><strong>Case</strong> ( <em>reference</em>::publisherLocation  &ne;  "" ; " " &amp; <em>reference</em>::publisherLocation &amp; ":" ; "" ) &amp; " " &amp; <em>tagCopyist</em>::tag &amp; 

<strong>//PUBLISHER PUNCTUATION 
</strong><strong>Case</strong> ( <em>tagCopyist</em>::tag &ne; "" <strong>and</strong> <em>reference</em>::URLdate = "" <strong>and</strong> <em>reference</em>::URL = "" ;  ".  " ;
<em>tagCopyist</em>::tag &ne; "" <strong>and</strong> <em>reference</em>::URLdate &ne; "" <strong>and</strong> <em>reference</em>::URL = "" ;  ". " ;
<em>tagCopyist</em>::tag &ne; "" <strong>and</strong> <em>reference</em>::URLdate = "" <strong>and</strong> <em>reference</em>::URL &ne; "" ;  ". " ;
<em>tagCopyist</em>::tag &ne; "" <strong>and</strong> <em>reference</em>::URLdate &ne; "" <strong>and</strong> <em>reference</em>::URL &ne; "" ;  ". " )  &amp; 

<strong>//MEDIA TYPE
</strong><strong>//Case (refMediaType::key = "" ; "" ; "[" &amp; refMediaType::mediumName &amp;  "] " )  &amp; 
</strong>
<strong>//HEALTH/COPYRIGHT  BEGIN ----
</strong>
<strong>//YEAR
</strong><strong>Case</strong> ( <em>reference</em>::CopyrightYear = ""  ; ""  ; "Copyright " &amp; <em>reference</em>::CopyrightYear ) &amp;

<strong>//YEAR PUNCTUATION
</strong><strong>Case</strong> ( <em>reference</em>::kcopyrightHolder = ""  <strong>and</strong> <em>reference</em>::CopyrightYear &ne; "" <strong>and</strong> <em>reference</em>::copyrightOtherHolder = "" ; "." ; "" )  &amp; 

<strong>//COPYRIGHT HOLDER
</strong><strong>Case</strong> ( <em>reference</em>::CopyrightYear = "" <strong>and</strong> <em>reference</em>::kHealth &ne; "" ; "Copyright" )  &amp; 
<strong>Case</strong> ( <em>reference</em>::kcopyrightHolder &ne; ""  ;  " by the" ;
<strong>Case</strong> ( <em>reference</em>::copyrightOtherHolder &ne; "" ; " by" ; "" ) ) &amp; 

<strong>//AUTHOR
</strong><strong>Case</strong> ( (<em>reference</em>::referenceNodes &amp; "&para;"  = <strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; <em>reference</em>::referenceNodes &amp; "&para;" ) <strong>and</strong> <em>reference</em>::kcopyrightHolder &ne; "")
<strong>or</strong> ("node738fds8ef"  &amp; "&para;"  = <strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; "node738fds8ef"  &amp; "&para;" ))
<strong>or</strong> ("governmentAuthor6767767676"  &amp; "&para;"  = <strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; "governmentAuthor6767767676"  &amp; "&para;" )) ;  " Author" ; "" )  &amp; 

<strong>//AUTHOR "AND"
</strong><strong>Case</strong> ( ("node738fds8ef"  &amp; "&para;"  = <strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; "node738fds8ef"  &amp; "&para;" ) <strong>or</strong> 
 "governmentAuthor6767767676"  &amp; "&para;"  = <strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; "governmentAuthor6767767676"  &amp; "&para;" ) <strong>or</strong>
(<em>reference</em>::referenceNodes &amp; "&para;" = <strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; <em>reference</em>::referenceNodes &amp; "&para;" )  <strong>and</strong> <em>reference</em>::kcopyrightHolder &ne; "" ) )

 <strong>and</strong> <strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; "editors857398f839" &amp; "&para;" ) 
   +    <strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; <em>reference</em>::korgan &amp; "&para;" )  
   +    <strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; <em>reference</em>::kcopyist &amp; "&para;" ) &gt; 0   

 <strong>or</strong> 

("node738fds8ef"  &amp; "&para;"  = <strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; "node738fds8ef"  &amp; "&para;" ) <strong>or</strong> 
"governmentAuthor6767767676"  &amp; "&para;"  = <strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; "governmentAuthor6767767676"  &amp; "&para;" ) <strong>or</strong>
(<em>reference</em>::referenceNodes &amp; "&para;" = <strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; <em>reference</em>::referenceNodes &amp; "&para;" )  <strong>and</strong> <em>reference</em>::kcopyrightHolder &ne; "" ) )

 <strong>and</strong> <em>reference</em>::copyrightOtherHolder &ne; "" ; " and" ; "") &amp; 

<strong>//EDITOR
</strong><strong>Case</strong> ( "editors857398f839" &amp; "&para;"  = <strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; "editors857398f839" &amp; "&para;" ) ;  " Editor" ; "" )  &amp; 

<strong>//EDITOR "AND"
</strong><strong>Case</strong> ( <strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; "editors857398f839" &amp; "&para;" )   &ne; ""
<strong>and</strong> (<strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; <em>reference</em>::korgan &amp; "&para;" )
 <strong>or</strong> <strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; <em>reference</em>::kcopyist &amp; "&para;" )) = 1; " and" ; "")  &amp; 

<strong>//PUBLICATION
</strong><strong>Case</strong> ( <em>reference</em>::korgan &amp; "&para;"  = <strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; <em>reference</em>::korgan &amp; "&para;" ) ;  
<strong>Case</strong> (<em>refMediaType</em>::key = 3 ; " Website" ; " Publication" ) )  &amp; 

<strong>//PUBLICATION "AND"
</strong><strong>Case</strong> ( <strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; <em>reference</em>::korgan &amp; "&para;" )   &gt; 0
<strong>and</strong> <strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; <em>reference</em>::kcopyist &amp; "&para;" )  &gt; 0; " and" ; "")  &amp; 

<strong>//PUBLISHER
</strong><strong>Case</strong> ( <em>reference</em>::kcopyist &amp; "&para;"  = <strong>FilterValues</strong> ( <em>reference</em>::kcopyrightHolder ; <em>reference</em>::kcopyist &amp; "&para;" ) ;  
<strong>Case</strong> ( <em>reference</em>::publisherTypeAlternative = 3 ; " " &amp; <em>reference</em>::publisherTypeOther ; 
<strong>Case</strong> ( <em>reference</em>::publisherTypeAlternative = 2 ;  " Sponsor" ; 
<strong>Case</strong> ( <em>reference</em>::publisherTypeAlternative = 1 ; " Distributor" ;
<strong>Case</strong> ( <em>reference</em>::publisherTypeOther &ne; "" ; " " &amp; <em>reference</em>::publisherTypeOther ;
<strong>Case</strong> ( <em>reference</em>::publisherTypeAlternative = ""  ; " Publisher"  ))))))  &amp; 

<strong>//PUBLISHER "AND"
</strong><strong>Case</strong> ( <em>reference</em>::kcopyrightHolder &ne; ""
<strong>and</strong> <em>reference</em>::copyrightOtherHolder &ne; ""; " and" ; "")  &amp; 

<strong>//OTHER COPYRIGHT HOLDER
</strong><strong>Case</strong> ( <em>reference</em>::copyrightOtherHolder &ne; "" ;  " " &amp; <em>reference</em>::copyrightOtherHolder )  &amp; 

<strong>//COPYRIGHT HOLDER PUNCTUATION
</strong><strong>Case</strong> ( <em>reference</em>::kcopyrightHolder = "" <strong>and</strong> <em>reference</em>::copyrightOtherHolder = ""  ; ""  ; ".") &amp; 

<strong>//COPYRIGHT RESTRICTIONS
</strong><strong>Case</strong> (<em>reference</em>::kHealth = 8102011220941282 ; " All rights reserved." ;
<em>reference</em>::kHealth = 31620121746441229 ; " Creative Commons Attribution 3.0 Unported License." ;

<em>reference</em>::kHealth = 31620121841541232 ; " Creative Commons Attribution-ShareAlike 3.0 Unported License." ;

<em>reference</em>::kHealth = 31620121902441234 ; " Creative Commons Attribution-NoDerivs 3.0 Unported License." ;

<em>reference</em>::kHealth = 31620121837161231 ; " Creative Commons Attribution-NonCommercial 3.0 Unported License." ;

<em>reference</em>::kHealth = 121620112002051049 ; " Creative Commons Attribution-NonCommercial-NoDerivs 3.0 Unported License." ;

<em>reference</em>::kHealth = 8162011231825326 ; " Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License." ;


<em>reference</em>::kHealth = 8162011231722325 ; " All rights reserved." ;

<em>tagHealth</em>::tag &ne; "" ; " " &amp; 

<strong>Case</strong> ( <strong>Right</strong> ( <em>tagHealth</em>::tag ; 1 ) = "." ; <em>tagHealth</em>::tag ; <em>tagHealth</em>::tag &amp; "." ) ; "" )  &amp; 

<strong>//END COPYRIGHT HOLDER  ------
</strong>
<strong>//ISBN as in B as in Blam!
</strong><strong>Case</strong> ( <em>reference</em>::ISBN = ""  <strong>or</strong> <em>reference</em>::library only &ne; "" ; ""  ; 
<strong>Case</strong> ( <em>reference</em>::URL = "" ; " ISBN search: http://www.worldcat.org/search?q=bn%3A" &amp; <em>reference</em>::ISBN ;
" ISBN: " &amp; <em>reference</em>::ISBN &amp; "." ) ) &amp; 

<strong>Case</strong> ( <em>reference</em>::URLdoi = ""  ; ""  ; 
<strong>Case</strong> ( <em>reference</em>::library only = "" ;
<strong>Case</strong> ( <em>reference</em>::URL = "" <strong>and</strong> <em>reference</em>::URLdate = "" ; " DOI: http://dx.doi.org/" &amp; <em>reference</em>::URLdoi  ;
" DOI: http://dx.doi.org/" &amp;  <em>reference</em>::URLdoi &amp; "." ) ) ) &amp; 

<strong>//ISSN as in S as in Sam!
</strong><strong>Case</strong> ( <em>reference</em>::ISSN = "" <strong>or</strong> <em>reference</em>::library only &ne; ""; ""  ; 
<strong>Case</strong> ( <em>reference</em>::URL = "" ; " ISSN search: http://www.worldcat.org/ISSN/" &amp; <em>reference</em>::ISSN ;
" ISSN: " &amp; <em>reference</em>::ISSN &amp; "." ) ) &amp; 

<strong>//DOI (hide url and show doi)
</strong><strong>//Case ( reference::URLdoi = "" ; ""  ; 
</strong><strong>//Case ( reference::URL = "" and reference::URLdate = "" and reference::library only = "" ; " DOI search: http://dx.doi.org/" &amp; reference::URLdoi) ) &amp; 
</strong>
<strong>//URL 
</strong><strong>Case</strong> (<em>reference</em>::library only &ne; "" ; 
<strong>Case</strong> (<em>reference</em>::URLdoi &ne; "" ; 
<strong>Case</strong> (<em>reference</em>::ISSN &ne; "" <strong>and</strong> <em>reference</em>::ISBN &ne; "" ; " Library ISBN search: http://www.worldcat.org/search?q=bn%3A" &amp; <em>reference</em>::ISBN &amp; " or " &amp; "ISSN search http://www.worldcat.org/ISSN/" &amp; <em>reference</em>::ISSN ;
<strong>Case</strong> (<em>reference</em>::ISSN &ne; "" ; " Library ISSN search: http://www.worldcat.org/ISSN/" &amp; <em>reference</em>::ISSN ; 
<strong>Case</strong> (<em>reference</em>::ISBN &ne; "" ; " Library ISBN search: http://www.worldcat.org/search?q=bn%3A" &amp; <em>reference</em>::ISBN ;
" Library copy: http://www.worldcat.org" )))  &amp; " or Publisher's copy: " &amp; 
<strong>Case</strong> ( <strong>Left</strong> (<em>reference</em>::URLdoi ; 4 )  &ne;  "doi: " ; "http://dx.doi.org/"  &amp; <em>reference</em>::URLdoi &amp; "   " ;
"http://dx.doi.org/"  &amp; <strong>Middle</strong> (<em>reference</em>::URLdoi ; 5; 99 ) &amp; " )   " ) ;
" Library copy: http://www.worldcat.org   " ) ;
<strong>Case</strong> ( <em>reference</em>::URLdate = "" ; 
<strong>Case</strong> ( <em>reference</em>::URLdate = "" <strong>and</strong> <em>reference</em>::URL = "" ; "" ; " Website: " &amp; <em>reference</em>::URL ) ;
<strong>Case</strong> (<em>reference</em>::library only &ne; "" ; "" ; " Retrieved " &amp; <strong>Month</strong>( <em>reference</em>::URLdate ) &amp; "/" &amp; <strong>Day</strong> ( <em>reference</em>::URLdate ) &amp; "/" &amp; <strong>Year</strong> ( <em>reference</em>::URLdate ) )  &amp; 
<strong>Case</strong> (<em>reference</em>::URL = "" ; <strong>Case</strong> ( <em>reference</em>::URLdate = "" <strong>and</strong> <em>reference</em>::URL = "" ; "" ; <strong>TextColor</strong> ( " URL not entered.  " ; <strong>RGB</strong> ( 119 ; 119 ; 119 ) ) ) ; 
" from " ) &amp; 
<em>reference</em>::URL  &amp; "  ") ) &amp;

&para; &amp; 

<strong>//KEYWORD
</strong><strong>Case</strong> (<em>tagKeywordPrimary</em>::tag = ""  <strong>and</strong> <em>reference</em>::OtherKeyWords = "" ; "" ;
<em>tagKeywordPrimary</em>::tag  &ne;  ""  <strong>and</strong> <em>reference</em>::OtherKeyWords = "" ; "keyword:  " ;
<em>tagKeywordPrimary</em>::tag  &ne;  ""  <strong>and</strong> <em>reference</em>::OtherKeyWords  &ne;  "" ; "keywords: " ;
<em>tagKeywordPrimary</em>::tag = ""  <strong>and</strong> <strong>ValueCount</strong> ( <em>reference</em>::kkeywordOther ) &gt; 1 ; "keywords: " ;
<em>tagKeywordPrimary</em>::tag = ""  <strong>and</strong> <strong>ValueCount</strong> ( <em>reference</em>::kkeywordOther )  =  1 ; "keyword: " ) &amp; 

<strong>//KEYWORDS
</strong><strong>Case</strong> ( <em>tagKeywordPrimary</em>::tag = "" ; "" ; 
<strong>//TextStyleAdd (
</strong> <em>tagKeywordPrimary</em>::tag  )
<strong>//; Bold )  &amp; ", " )
</strong> &amp; 
<strong>//keyword comma
</strong><strong>Case</strong> (<em>reference</em>::OtherKeyWords = "" ; "" ; ", ")

 &amp; 
<em>reference</em>::OtherKeyWords ; 

<strong>//REFERENCE DUMP
</strong><em>reference</em>::referenceDump &amp;  

<strong>//KEYWORDS
</strong><strong>Case</strong> ( <em>tagKeywordPrimary</em>::tag = "" ; "" ; <strong>TextStyleAdd</strong> ( <em>tagKeywordPrimary</em>::tag ; <strong>Bold</strong> )  &amp; ", " ) &amp; 
<em>reference</em>::OtherKeyWords )</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Do not store calculation results</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279357FieldAnchor_"/>TimeRange</td><td>Normal, Time</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
<li>Range: 00:00:00 - 99:99:99</li>
<li>Error message: Enter time like this 01:10:30</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
</ul>
</td><td>TimeRangeOfMediaClip</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279358FieldAnchor_"/>referenceForPASTE</td><td>Calculated, Text</td><td><strong>Calculation:</strong>
<ul>
<li>Context table: <em>reference</em>
</li>
<li>
<strong>Case</strong> (
<em>reference</em>::referenceNodes &ne; ""
<strong>or</strong> <em>tagNodePrimary</em>::tag &ne; ""
<strong>or</strong> <em>reference</em>::NodeOthers &ne; "" 
<strong>or</strong> <em>reference</em>::pubYear &ne; "" 
<strong>or</strong> <em>reference</em>::PubDate &ne; "" 
<strong>or</strong> <em>reference</em>::Title &ne; "" 
<strong>or</strong> <em>reference</em>::korgan &ne; "" 
<strong>or</strong> <em>reference</em>::volumeNumber &ne; "" 
<strong>or</strong> <em>reference</em>::pageNumberRange &ne; "" 
<strong>or</strong> <em>reference</em>::TimeRange &ne; "" 
<strong>or</strong> <em>tagCopyist</em>::tag &ne; ""
<strong>or</strong> <em>reference</em>::URL &ne; "" <strong>and</strong> <em>reference</em>::referenceDump = ""
<strong>or</strong> <em>reference</em>::URLdate &ne; ""
<strong>or</strong> <em>tagHealth</em>::tag &ne; ""
<strong>or</strong> <em>reference</em>::CopyrightYear &ne; "" ;

<strong>//NODE
</strong><strong>Case</strong> ( <em>reference</em>::referenceNodes &ne; "" ; <em>reference</em>::referenceNodes ; 
<strong>Case</strong> ( <em>reference</em>::referenceNodes  =  "" <strong>and</strong> <em>tagNodePrimary</em>::tag = "" <strong>and</strong> <em>reference</em>::NodeOthers = "" ; <strong>TextColor</strong> ( "author not entered" ; <strong>RGB</strong> ( 119 ; 119 ; 119 ) ) ; <em>tagNodePrimary</em>::tag ) &amp; 
<strong>Case</strong> ( <em>reference</em>::NodeOthers = "" ; "" ;  "; " &amp; <em>reference</em>::NodeOthers) ) &amp; 

<strong>//COPY DATE
</strong><strong>Case</strong> ( <em>reference</em>::pubYear = "" <strong>and</strong> <em>reference</em>::PubDate = ""; <strong>TextStyleAdd</strong> ( " (date unkown).  " ; <strong>Italic</strong> )  ;
<em>reference</em>::pubYear &ne; "" <strong>and</strong> <em>reference</em>::PubDate &ne; "" <strong>or</strong> <em>reference</em>::pubYear = "" <strong>and</strong> <em>reference</em>::PubDate &ne; "" ;
" (" &amp; <strong>Month</strong> ( <em>reference</em>::PubDate ) &amp; "/" &amp; <strong>Day</strong> ( <em>reference</em>::PubDate ) &amp; "/" &amp; <strong>Year</strong> ( <em>reference</em>::PubDate ) &amp; ").  "  ; 
<em>reference</em>::PubDate = "" <strong>and</strong> <em>reference</em>::pubYear &ne;  ""; " (" &amp; <em>reference</em>::pubYear  &amp; ").  " ) &amp; 

<strong>//TITLE 
</strong><strong>Case</strong> ( <em>reference</em>::Title = "" ; <strong>TextStyleAdd</strong> ( "title not entered.  "; <strong>Italic</strong> ) ; <strong>TextFont</strong> ( <em>reference</em>::Title ; "Arial" ) &amp; ".  " ) &amp; 

<strong>//ORGAN 
</strong><strong>Case</strong> ( <em>reference</em>::korgan &ne; "" ; <em>tagOrgan</em>::tag ; 
<strong>Case</strong> ( <em>reference</em>::TimeRange = "" ; <strong>TextStyleAdd</strong> ( "organ tag not selected OR movie time not entered.  "; <strong>Italic</strong> ) ; "" ) ) &amp; 

<strong>//ORGAN PUNCTUATION 
</strong><strong>Case</strong> ( <em>reference</em>::korgan &ne; "" <strong>and</strong> <em>reference</em>::volumeNumber = "" <strong>and</strong> <em>reference</em>::pageNumberRange = "" ;  ".  " ;
<em>reference</em>::korgan &ne; "" <strong>and</strong> <em>reference</em>::volumeNumber &ne; "" <strong>and</strong> <em>reference</em>::pageNumberRange = "" ;  ": " ;
<em>reference</em>::korgan &ne; "" <strong>and</strong> <em>reference</em>::volumeNumber = "" <strong>and</strong> <em>reference</em>::pageNumberRange &ne; "" ;  ": " ;
<em>reference</em>::korgan &ne; "" <strong>and</strong> <em>reference</em>::volumeNumber &ne; "" <strong>and</strong> <em>reference</em>::pageNumberRange &ne; "" ;  ": " )  &amp; 

<strong>//VOLUME, ISSUE, and PAGE RANGE
</strong><strong>Case</strong> ( <em>reference</em>::volumeNumber  &ne;  "" ; <em>reference</em>::volumeNumber &amp; 
<strong>Case</strong> ( <em>reference</em>::issueNumber  =  "" ; " " ) ) &amp; 
<strong>Case</strong> ( <em>reference</em>::issueNumber  &ne;  "" ; "(" &amp; <em>reference</em>::issueNumber &amp; ")" &amp; " " ) &amp; 
<strong>Case</strong> ( <em>reference</em>::pageNumberRange = "" <strong>and</strong> <em>reference</em>::volumeNumber &ne; "" ; <strong>TextStyleAdd</strong> ( "page range not entered" ; <strong>Italic</strong> )  &amp; "." ;
<em>reference</em>::pageNumberRange &ne; "" ; "pp " &amp; <em>reference</em>::pageNumberRange &amp; ".  " )&amp; 

<strong>//TIME LENGTH
</strong><strong>Case</strong> ( <em>reference</em>::TimeRange  &ne;  "" ; <em>reference</em>::TimeRange &amp; ".  " )  &amp; 

<strong>//COPYIST 
</strong><em>tagCopyist</em>::tag &amp; 

<strong>//COPYIST PUNCTUATION 
</strong><strong>Case</strong> ( <em>tagCopyist</em>::tag &ne; "" <strong>and</strong> <em>reference</em>::URLdate = "" <strong>and</strong> <em>reference</em>::URL = "" ;  ".  " ;
<em>tagCopyist</em>::tag &ne; "" <strong>and</strong> <em>reference</em>::URLdate &ne; "" <strong>and</strong> <em>reference</em>::URL = "" ;  ": " ;
<em>tagCopyist</em>::tag &ne; "" <strong>and</strong> <em>reference</em>::URLdate = "" <strong>and</strong> <em>reference</em>::URL &ne; "" ;  ": " ;
<em>tagCopyist</em>::tag &ne; "" <strong>and</strong> <em>reference</em>::URLdate &ne; "" <strong>and</strong> <em>reference</em>::URL &ne; "" ;  ": " )  &amp; 

<strong>//URL 
</strong><strong>Case</strong> ( <em>reference</em>::URLdate = "" ; 
<strong>Case</strong> ( <em>reference</em>::URLdate = "" <strong>and</strong> <em>reference</em>::URL = "" ; "" ; <strong>TextStyleAdd</strong> ( "(retrieved date not entered)"; <strong>Italic</strong> ) ) ; "retrieved " &amp; <strong>Month</strong>( <em>reference</em>::URLdate ) &amp; "/" &amp; <strong>Day</strong> ( <em>reference</em>::URLdate ) &amp; "/" &amp; <strong>Year</strong> ( <em>reference</em>::URLdate ) )  &amp; 
<strong>Case</strong> (<em>reference</em>::URL = "" ; <strong>Case</strong> ( <em>reference</em>::URLdate = "" <strong>and</strong> <em>reference</em>::URL = "" ; "" ; <strong>TextStyleAdd</strong> ( "URL not entered.  " ; <strong>Italic</strong> ) ) ; 
" from " &amp; 
<strong>//Case ( Left ( reference::URL ; 12 ) = "https://www." ; Middle ( reference::URL ; 13 ; 100 ); 
</strong><strong>//Left ( reference::URL ; 11 ) = "http://www." ; Middle ( reference::URL ; 12 ; 100 );
</strong><strong>//Left ( reference::URL ; 7 ) = "http://" ; Middle ( reference::URL ; 8 ; 100 );
</strong><strong>//Left ( reference::URL ; 4 ) = "www." ; Middle ( reference::URL ; 5 ; 100 );
</strong><strong>//reference::URL)  &amp; "    ") &amp;  
</strong><em>reference</em>::URL  &amp; "    " ) &amp;

<strong>//HEALTH/COPYRIGHT 
</strong><strong>Case</strong> ( <em>tagHealth</em>::tag = "" ; <strong>TextStyleAdd</strong> ( "health (copyright) not selected" ; <strong>Italic</strong> ) &amp; " in "; 
<strong>Case</strong> ( <strong>Right</strong> ( <strong>LeftValues</strong> ( <em>tagHealth</em>::tag ; 1 ) ; 1 )  = &para; ; <strong>Left</strong> ( <em>tagHealth</em>::tag ; ( <strong>Length</strong> ( <strong>LeftValues</strong> ( <em>tagHealth</em>::tag ; 1 ) ) - 1) ); <strong>LeftValues</strong> ( <em>tagHealth</em>::tag ; 1 )) )
&amp; 
<strong>Case</strong> ( <em>reference</em>::CopyrightYear = "" ; <strong>TextStyleAdd</strong> ( "copyright year not entered.  " ; <strong>Italic</strong> )  ; <em>reference</em>::CopyrightYear &amp; ".  "  ) ; <strong>//&amp; 
</strong>
<strong>//KEYWORDS
</strong><strong>//Case ( tagKeywordPrimary::tag = "" ; "" ; TextStyleAdd ( tagKeywordPrimary::tag ; Bold )  &amp; ", " ) &amp; 
</strong><strong>//reference::OtherKeyWords ; 
</strong>
<strong>//REFERENCE DUMP
</strong><em>reference</em>::referenceDump ) <strong>//&amp;  
</strong>
<strong>//KEYWORDS
</strong><strong>//Case ( tagKeywordPrimary::tag = "" ; "" ; TextStyleAdd ( tagKeywordPrimary::tag ; Bold )  &amp; ", " ) &amp; 
</strong><strong>//reference::OtherKeyWords )</strong>
</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Do not store calculation results</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279359FieldAnchor_"/>referenceForReferenceSort</td><td>Calculated, Text</td><td><strong>Calculation:</strong>
<ul>
<li>Context table: <em>reference</em>
</li>
<li>
<strong>//NODE
</strong><strong>Case</strong> ( <em>reference</em>::referenceNodes &ne; "" ; <em>reference</em>::referenceNodes ; 
<strong>Case</strong> ( <em>reference</em>::referenceNodes  =  "" <strong>and</strong> <em>tagNodePrimary</em>::tag = "" <strong>and</strong> <em>reference</em>::NodeOthers = "" ; <strong>TextColor</strong> ( "author not entered" ; <strong>RGB</strong> ( 119 ; 119 ; 119 ) ) ; <em>tagNodePrimary</em>::tag ) &amp; 
<strong>Case</strong> ( <em>reference</em>::NodeOthers = "" ; "" ;  "; " &amp; <em>reference</em>::NodeOthers) )
 &amp;  

<strong>//COPY DATE
</strong><strong>Case</strong> ( <em>reference</em>::pubYear = "" <strong>and</strong> <em>reference</em>::PubDate = ""; <strong>TextColor</strong> ( " (copy date not entered).  " ; <strong>RGB</strong> ( 119 ; 119 ; 119 ) )  ;
<em>reference</em>::pubYear &ne; "" <strong>and</strong> <em>reference</em>::PubDate &ne; "" <strong>or</strong> <em>reference</em>::pubYear = "" <strong>and</strong> <em>reference</em>::PubDate &ne; "" ;
" (" &amp; <strong>Month</strong> ( <em>reference</em>::PubDate ) &amp; "/" &amp; <strong>Day</strong> ( <em>reference</em>::PubDate ) &amp; "/" &amp; <strong>Year</strong> ( <em>reference</em>::PubDate ) &amp; ").  "  ; 
<em>reference</em>::PubDate = "" <strong>and</strong> <em>reference</em>::pubYear &ne;  ""; " (" &amp; <em>reference</em>::pubYear  &amp; ").  " ) &amp; 

<strong>//TITLE 
</strong><strong>Case</strong> ( <em>reference</em>::Title = "" ; <strong>TextColor</strong> ( "title not entered.  "; <strong>RGB</strong> ( 119 ; 119 ; 119 ) ) ; <strong>TextFont</strong> ( <em>reference</em>::Title ; "Arial" ) &amp; ".  " )</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Do not store calculation results</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279360FieldAnchor_"/>createDate</td><td>Normal, Timestamp</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Creation timestamp</li>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td>dateRecordWasCreated</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279361FieldAnchor_"/>show</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>checkboxForUserToShowRecordInLearnSectionAsWayToFilterReferencesGivenByAnotherUserFromOverWhelmingLearnReferences</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279362FieldAnchor_"/>library only</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279363FieldAnchor_"/>URLdoi</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279364FieldAnchor_"/>issueNumber</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279365FieldAnchor_"/>publisherLocation</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279366FieldAnchor_"/>compilationTitle</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279367FieldAnchor_"/>compilationEditors</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279368FieldAnchor_"/>kmedia</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279369FieldAnchor_"/>kmediaType</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279371FieldAnchor_"/>compilationNumberOfEditors</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279372FieldAnchor_"/>pubYearMonthRange</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>for journals that have a month range spelled out like May-July, or Spring</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279373FieldAnchor_"/>ISBN</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279374FieldAnchor_"/>pubDateOther</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>Spring, May-July, etc.</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279378FieldAnchor_"/>bookChapter</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279379FieldAnchor_"/>letterDate</td><td>Normal, Date</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279380FieldAnchor_"/>compilationAbbr</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279381FieldAnchor_"/>emailRecipient</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279382FieldAnchor_"/>conferenceIntroWords</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279383FieldAnchor_"/>conferenceTitle</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279384FieldAnchor_"/>conferenceSubTitle</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279385FieldAnchor_"/>conferenceLocation</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279386FieldAnchor_"/>conferenceDate</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279387FieldAnchor_"/>conferenceGroupName</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279389FieldAnchor_"/>TypeOfMediumOther</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>forKindle and other ebook readers</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279390FieldAnchor_"/>GovernmentDocInfo</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279392FieldAnchor_"/>governmentAuthor</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279393FieldAnchor_"/>ISSN</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279395FieldAnchor_"/>publisherTypeAlternative</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279396FieldAnchor_"/>copyrightOtherHolder</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279397FieldAnchor_"/>publisherTypeOther</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279398FieldAnchor_"/>pageNumberOther</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>section number, number of words, etc.</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279399FieldAnchor_"/>dissertationThesisUniversity</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
		</tbody>
</table>
	<br>
		<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td colSpan="9">Table Name: <a name="32779BaseTableAnchor_"/>report - 36 Fields</td>
</tr>
<tr class="chartheaders" vAlign="top">
<td width="8%">Field Name</td><td width="7%">Type</td><td width="14%">Options</td><td width="10%">Comments</td><td width="13%">On Layouts</td><td width="15%">In Relationships</td><td width="22%">In Scripts</td><td width="11%">In Value Lists</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277932805FieldAnchor_"/>_Lreport</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Do not replace existing value for field (if any)</li>
<li>Context table: <em>report</em>
<br>Calculation: <strong>Month</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) &amp; 
(<strong>If</strong> ( <strong>Day</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) &gt; 9 ; <strong>Day</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) ; 0 &amp;  (<strong>Day</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) ) ) )&amp; 
<strong>Year</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) &amp;
(<strong>If</strong> ( <strong>Hour</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) &gt; 9 ; <strong>Hour</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ; 0 &amp;  (<strong>Hour</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ) ) )&amp;  
(<strong>If</strong> ( <strong>Minute</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) )&gt; 9 ; <strong>Minute</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ; 0 &amp;  (<strong>Minute</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ) ) )&amp;  
(<strong>If</strong> ( <strong>Seconds</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) &gt; 9 ; <strong>Seconds</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ; 0 &amp;  (<strong>Seconds</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ) ) )&amp;  
<em>report</em>::_Number</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
<li>Not empty</li>
<li>Unique</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277932806FieldAnchor_"/>_Number</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
<li>Serial: Generate: On creation, Next value: 11, Increment: 1</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277932846FieldAnchor_"/>ksection</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277932845FieldAnchor_"/>kreportNumber</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277932807FieldAnchor_"/>ktestSubject</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277932813FieldAnchor_"/>ktest</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277932815FieldAnchor_"/>krecommendation</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277932816FieldAnchor_"/>order</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277932818FieldAnchor_"/>kthingRecommendationID</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277932819FieldAnchor_"/>kgeneralSpecificItemRecommendationID</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277932812FieldAnchor_"/>general_info</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277932827FieldAnchor_"/>textMain</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277932828FieldAnchor_"/>textPhotoRow1</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277932829FieldAnchor_"/>pagenumberItem</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277932837FieldAnchor_"/>pagenumberTheme</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277932833FieldAnchor_"/>CurrentRecord</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>usedByRecordLoadScriptToHighlightForUserWhatRecordIsSelectedUsingConditionalFormatting</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277932826FieldAnchor_"/>PictureCaption</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 4</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277932810FieldAnchor_"/>_kfContactGeography</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277932821FieldAnchor_"/>_kfContactGeography2</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277932822FieldAnchor_"/>_kfContactGeography3</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277932823FieldAnchor_"/>_kfContactGeography4</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277932824FieldAnchor_"/>_kfContactGeography5</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277932817FieldAnchor_"/>Picture</td><td>Normal, Binary</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 4</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277932820FieldAnchor_"/>_kfPhoto</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277932834FieldAnchor_"/>_kfPhoto2</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277932835FieldAnchor_"/>_kfPhoto3</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277932836FieldAnchor_"/>_kfPhoto4</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277932840FieldAnchor_"/>TOC</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
<li>Do not replace existing value for field (if any)</li>
<li>Context table: <em>report</em>
<br>Calculation: "Introduction&para;
Summary&para;
Another Item&para;
And Another Item
"</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>tableOfContentItemsPreceedingMainReportLikeIntroduction</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277932841FieldAnchor_"/>TOCnumbers</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
<li>Do not replace existing value for field (if any)</li>
<li>Context table: <em>report</em>
<br>Calculation: "i&para;
ii&para;
iii&para;
iv
"</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>tableOfContentItemsPreceedingMainReportLikeIntroductionPageNumbers</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277932843FieldAnchor_"/>ReportCover</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277932844FieldAnchor_"/>ReportPDFtitle</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277932847FieldAnchor_"/>kRecordCreatorNode</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277932848FieldAnchor_"/>kRecordModifierNode</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277932849FieldAnchor_"/>RecordModifyDate</td><td>Normal, Timestamp</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277932850FieldAnchor_"/>khealth</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3277932851FieldAnchor_"/>textPhotoRow2</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
		</tbody>
</table>
	<br>
		<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td colSpan="9">Table Name: <a name="32789BaseTableAnchor_"/>TEMP - 91 Fields</td>
</tr>
<tr class="chartheaders" vAlign="top">
<td width="8%">Field Name</td><td width="7%">Type</td><td width="14%">Options</td><td width="10%">Comments</td><td width="13%">On Layouts</td><td width="15%">In Relationships</td><td width="22%">In Scripts</td><td width="11%">In Value Lists</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278917FieldAnchor_"/>ktestItemList</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>usedToFindNewTestItemInRuleTableAndIncreaseInUseNumberByOne</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278919FieldAnchor_"/>ktestItemListOLD</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>usedToFindOldTestItemInRuleTableAndDecreaseInUseNumberByOne</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278937FieldAnchor_"/>filePath</td><td>Calculated, Number</td><td><strong>Calculation:</strong>
<ul>
<li>Context table: <em>TEMP</em>
</li>
<li>
<strong>Get</strong> (FilePath)</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>usedToSupplyMemorySwitchDatabaseWithThisFilesLocation</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278938FieldAnchor_"/>import</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>usedToCloseImportFile</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278924FieldAnchor_"/>kabout</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>pulldownListLimiterOnReportLayoutForSelectingAvailbleItems</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278922FieldAnchor_"/>ktest</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>usedOnReportToCreateNewDiscoveries</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327892FieldAnchor_"/>ksection</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278926FieldAnchor_"/>mSection</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Constant data: library</li>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>matchFieldUsedToMakeRuleTableOnlyDisplayItemsLabeledWithTheWordSection</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327893FieldAnchor_"/>sectionName</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327894FieldAnchor_"/>kfocus</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278929FieldAnchor_"/>locationSection</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>forLocationPulldownMenu</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327895FieldAnchor_"/>LocationName</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278915FieldAnchor_"/>LocationNameComplete</td><td>Calculated, Text</td><td><strong>Calculation:</strong>
<ul>
<li>Context table: <em>TEMP</em>
</li>
<li>
<strong>Trim</strong> (  

<strong>Case</strong> ( 
<em>TEMP</em>::orderLocation = 1; <em>TEMP</em>::LocationName  &amp; <strong>If</strong> ( <em>TEMP</em>::LocationName &ne; "" ;  " " ; "" ) ;
<em>TEMP</em>::orderMod1 = 1; <em>TEMP</em>::modifier1name &amp; <strong>If</strong> ( <em>TEMP</em>::modifier1name &ne; "" ;  " " ; "" );
<em>TEMP</em>::orderMod2 = 1; <em>TEMP</em>::modifier2name &amp; <strong>If</strong> ( <em>TEMP</em>::modifier2name &ne; "" ;  " " ; "" ) ;
"" ) &amp; 

<strong>Case</strong> ( 
<em>TEMP</em>::orderLocation = 2; <em>TEMP</em>::LocationName  &amp; <strong>If</strong> ( <em>TEMP</em>::LocationName &ne; "" ;  " " ; "" );
<em>TEMP</em>::orderMod1 = 2; <em>TEMP</em>::modifier1name   &amp; <strong>If</strong> ( <em>TEMP</em>::modifier1name &ne; "" ;  " " ; "" );
<em>TEMP</em>::orderMod2 = 2; <em>TEMP</em>::modifier2name &amp; <strong>If</strong> ( <em>TEMP</em>::modifier2name &ne; "" ;  " " ; "" ) ;
"" ) &amp; 

<strong>Case</strong> ( 
<em>TEMP</em>::orderLocation = 3; <em>TEMP</em>::LocationName &amp; <strong>If</strong> ( <em>TEMP</em>::LocationName &ne; "" ;  " " ; "" );
<em>TEMP</em>::orderMod1= 3; <em>TEMP</em>::modifier1name &amp; <strong>If</strong> ( <em>TEMP</em>::modifier1name &ne; "" ;  " " ; "" );
<em>TEMP</em>::orderMod2 = 3; <em>TEMP</em>::modifier2name &amp; <strong>If</strong> ( <em>TEMP</em>::modifier2name &ne; "" ;  " " ; "" );
"" )

)</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327896FieldAnchor_"/>kmodifier1</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327897FieldAnchor_"/>modifier1name</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278910FieldAnchor_"/>kmodifier2</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278911FieldAnchor_"/>modifier2name</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278912FieldAnchor_"/>orderLocation</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278913FieldAnchor_"/>orderMod1</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278914FieldAnchor_"/>orderMod2</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278936FieldAnchor_"/>pageNumber</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>TOCsetup</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278930FieldAnchor_"/>RemoveFocusList</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>populatedByDeleteFocusScriptToInformUserOfAllReportsFocusIsCurrentlyBeingUsedBy</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278916FieldAnchor_"/>reportNumber</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278923FieldAnchor_"/>showFavorites</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>usedOnReportToAllowOtherScritsToKnowIfUserIsShowingFavorites</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278934FieldAnchor_"/>mSwitch</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Constant data: text</li>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>matchFieldUsedToMakePulldownRelationshipWithSwitchTablePossible</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327891FieldAnchor_"/>theme</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278925FieldAnchor_"/>mtestGroup</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Constant data: testGroup</li>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>matchFieldUsedToMakeRuleTableOnlyDisplayItemsLabeledWithTheWordsTestGroup</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278920FieldAnchor_"/>TimeStamp</td><td>Normal, Timestamp</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>usedToCreateTimeStampWhenAddingPhotosToDatabase</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278921FieldAnchor_"/>kuserLocation</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278939FieldAnchor_"/>theme Copy</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278940FieldAnchor_"/>newEvidenceListWindow</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>usedToOpenAndCloseListOfEvidenceOnReportModule</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278941FieldAnchor_"/>EvidenceItemNameAndNumber</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278943FieldAnchor_"/>sortKey</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278944FieldAnchor_"/>sortNode</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278945FieldAnchor_"/>sortCopyist</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278946FieldAnchor_"/>sortMedium</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278947FieldAnchor_"/>sortPath</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278948FieldAnchor_"/>tagName</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>usedBySpellCheckTagScriptToMakeSureOnlyTheTagWhoseSpellingIsChallengedGetsChanged</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278949FieldAnchor_"/>testName</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>usedOnCitationTagLayout</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278950FieldAnchor_"/>sortOrgan</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278951FieldAnchor_"/>sortHealth</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278952FieldAnchor_"/>sortCite</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278954FieldAnchor_"/>layoutRtagN</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>remembersUsersChoiceOfNoneOneOrThreePictureTagLayoutReference</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278955FieldAnchor_"/>layoutRtagK</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>remembersUsersChoiceOfNoneOneOrThreePictureTagLayoutReference</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278956FieldAnchor_"/>layoutLtagK</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>remembersUsersChoiceOfNoneOneOrThreePictureTagLayoutLearn</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278957FieldAnchor_"/>layoutLtagN</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>remembersUsersChoiceOfNoneOneOrThreePictureTagLayoutLearn</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278958FieldAnchor_"/>sortRef</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278959FieldAnchor_"/>DetailmoreORLessLayout</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>remembersUsersChoiceOfNoneOneOrThreePictureTagLayout</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278960FieldAnchor_"/>kdefaultNodePrimary</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>usedToSetCreatorOfAllNewRecords</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278961FieldAnchor_"/>kdefaultHealth</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>usedToSetHealthCopyrightOfAllNewTestAndLearnRecords</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278962FieldAnchor_"/>kdefaultNodeOther</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>usedToSetOtherCreatorsOfAllNewRecords</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278963FieldAnchor_"/>DEFAULTNodeOtherNames</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>listOfOtherNodeNames</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278964FieldAnchor_"/>DefaultPicturePrimary</td><td>Calculated, Text</td><td><strong>Calculation:</strong>
<ul>
<li>Context table: <em>tempSetup</em>
</li>
<li>
<strong>Case</strong> ( <strong>FilterValues</strong> ( <em>defaultPictureRef</em>::kfileLocation ; "8162011225532313" )  = "8162011225532313"  &amp; &para;;   <strong>Substitute</strong> ( "file:/" &amp; <strong>Middle</strong> ( <strong>Get</strong> ( FilePath ) ; 6 ; <strong>Length</strong> ( <strong>Get</strong> (FilePath ) ) - <strong>Length</strong> ( <strong>Get</strong> (FileName ) ) - 9) &amp; "x/" &amp; <em>defaultPictureRef</em>::fileName ; " " ; "%20" ) ; 

<strong>FilterValues</strong> ( <em>defaultPictureRef</em>::kfileLocation ; "8162011225558314" )  = "8162011225558314" &amp; &para;; <strong>Substitute</strong> ( "file:/" &amp; <strong>Middle</strong> ( <strong>Get</strong> ( FilePath ) ; 6 ; <strong>Length</strong> ( <strong>Get</strong> (FilePath ) ) - <strong>Length</strong> ( <strong>Get</strong> (FileName ) ) - 9) &amp; <em>defaultPictureRef</em>::fileName ; " " ; "%20" ) ; 

<strong>FilterValues</strong> ( <em>defaultPictureRef</em>::kfileLocation ; "8162011225605315" )  = "8162011225605315"   &amp; &para;;

<strong>Substitute</strong> ( <strong>Case</strong> ( <strong>Get</strong> ( SystemPlatform ) =  - 2 ; "file:/" ; "file:///" ) &amp; <em>tagDefaultFolderPathRef</em>::tag ; " " ; "%20" ) &amp;

<strong>Case</strong> ( <strong>Left</strong> ( <em>defaultPictureRef</em>::fileName ; 1 ) =  "/" ; <strong>Substitute</strong> ( <em>defaultPictureRef</em>::fileName ; " " ; "%20" ) ;

 "/" &amp; <strong>Substitute</strong> ( <em>defaultPictureRef</em>::fileName ; " " ; "%20" ) );


<strong>//from testlearn table
</strong>

<strong>FilterValues</strong> ( <em>defaultPictureTL</em>::kfileLocation ; "8162011225532313" )  = "8162011225532313"  &amp; &para;;   <strong>Substitute</strong> ( "file:/" &amp; <strong>Middle</strong> ( <strong>Get</strong> ( FilePath ) ; 6 ; <strong>Length</strong> ( <strong>Get</strong> (FilePath ) ) - <strong>Length</strong> ( <strong>Get</strong> (FileName ) ) - 9) &amp; "x/" &amp; <em>defaultPictureTL</em>::filename ; " " ; "%20" ) ; 

<strong>FilterValues</strong> ( <em>defaultPictureTL</em>::kfileLocation ; "8162011225558314" )  = "8162011225558314" &amp; &para;; <strong>Substitute</strong> ( "file:/" &amp; <strong>Middle</strong> ( <strong>Get</strong> ( FilePath ) ; 6 ; <strong>Length</strong> ( <strong>Get</strong> (FilePath ) ) - <strong>Length</strong> ( <strong>Get</strong> (FileName ) ) - 9) &amp; <em>defaultPictureTL</em>::filename ; " " ; "%20" ) ; 

<strong>FilterValues</strong> ( <em>defaultPictureTL</em>::kfileLocation ; "8162011225605315" )  = "8162011225605315"   &amp; &para;; <em>tagDefaultFolderPathTL</em>::tag &amp; <em>defaultPictureTL</em>::filename ; 

"")</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Do not store calculation results</li>
<li>Index Language: English</li>
</ul>
</td><td>dueToFilemakerWebViewerOnlySeeingFieldsNativeToLayoutThisCalcIsRequiredToDuplicateRelatedFieldInfo</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278967FieldAnchor_"/>DefaultmoreORLessLayoutNode</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>remembersUsersChoiceOfNoneOneOrThreePictureTagLayoutDefault</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278968FieldAnchor_"/>layoutLmain</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>remembersUsersChoiceOfLayoutVIewOnLearnMainLayout</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278969FieldAnchor_"/>sortSample</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278970FieldAnchor_"/>tempListNode</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278971FieldAnchor_"/>TLSampleSort</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278972FieldAnchor_"/>TLTestSort</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278973FieldAnchor_"/>sortTest</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278974FieldAnchor_"/>kdefaultNodeTestSubject</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>usedToSetTestSubjectForATest</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278976FieldAnchor_"/>DefaultPictureTS</td><td>Calculated, Text</td><td><strong>Calculation:</strong>
<ul>
<li>Context table: <em>tempSetup</em>
</li>
<li>
<strong>Case</strong> ( <strong>FilterValues</strong> ( <em>defaultPictureRef_TS</em>::kfileLocation ; "8162011225532313" )  = "8162011225532313"  &amp; &para;;   <strong>Substitute</strong> ( "file:/" &amp; <strong>Middle</strong> ( <strong>Get</strong> ( FilePath ) ; 6 ; <strong>Length</strong> ( <strong>Get</strong> (FilePath ) ) - <strong>Length</strong> ( <strong>Get</strong> (FileName ) ) - 9) &amp; "x/" &amp; <em>defaultPictureRef_TS</em>::fileName ; " " ; "%20" ) ; 

<strong>FilterValues</strong> ( <em>defaultPictureRef_TS</em>::kfileLocation ; "8162011225558314" )  = "8162011225558314" &amp; &para;; <strong>Substitute</strong> ( "file:/" &amp; <strong>Middle</strong> ( <strong>Get</strong> ( FilePath ) ; 6 ; <strong>Length</strong> ( <strong>Get</strong> (FilePath ) ) - <strong>Length</strong> ( <strong>Get</strong> (FileName ) ) - 9) &amp; <em>defaultPictureRef_TS</em>::fileName ; " " ; "%20" ) ; 

<strong>FilterValues</strong> ( <em>defaultPictureRef_TS</em>::kfileLocation ; "8162011225605315" )  = "8162011225605315"   &amp; &para;; 
<strong>Substitute</strong> ( <strong>Case</strong> ( <strong>Get</strong> ( SystemPlatform ) =  - 2 ; "file:/" ; "file:///" ) &amp; <em>tagDefaultFolderPathRef_TS</em>::tag ; " " ; "%20" ) &amp;

<strong>Case</strong> ( <strong>Left</strong> ( <em>defaultPictureRef_TS</em>::fileName ; 1 ) =  "/" ; <strong>Substitute</strong> ( <em>defaultPictureRef_TS</em>::fileName ; " " ; "%20" ) ;

 "/" &amp; <strong>Substitute</strong> ( <em>defaultPictureRef_TS</em>::fileName ; " " ; "%20" ) );


<strong>//from testlearn table
</strong>

<strong>FilterValues</strong> ( <em>defaultPictureTL_TS</em>::kfileLocation ; "8162011225532313" )  = "8162011225532313"  &amp; &para;;   <strong>Substitute</strong> ( "file:/" &amp; <strong>Middle</strong> ( <strong>Get</strong> ( FilePath ) ; 6 ; <strong>Length</strong> ( <strong>Get</strong> (FilePath ) ) - <strong>Length</strong> ( <strong>Get</strong> (FileName ) ) - 9) &amp; "x/" &amp; <em>defaultPictureTL_TS</em>::filename ; " " ; "%20" ) ; 

<strong>FilterValues</strong> ( <em>defaultPictureTL_TS</em>::kfileLocation ; "8162011225558314" )  = "8162011225558314" &amp; &para;; <strong>Substitute</strong> ( "file:/" &amp; <strong>Middle</strong> ( <strong>Get</strong> ( FilePath ) ; 6 ; <strong>Length</strong> ( <strong>Get</strong> (FilePath ) ) - <strong>Length</strong> ( <strong>Get</strong> (FileName ) ) - 9) &amp; <em>defaultPictureTL_TS</em>::filename ; " " ; "%20" ) ; 

<strong>FilterValues</strong> ( <em>defaultPictureTL_TS</em>::kfileLocation ; "8162011225605315" )  = "8162011225605315"   &amp; &para;; <em>tagDefaultFolderPathTL_TS</em>::tag &amp; <em>defaultPictureTL_TS</em>::filename ; 

"")</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Do not store calculation results</li>
<li>Index Language: English</li>
</ul>
</td><td>dueToFilemakerWebViewerOnlySeeingFieldsNativeToLayoutThisCalcIsRequiredToDuplicateRelatedFieldInfo</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278977FieldAnchor_"/>sortLocation</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278978FieldAnchor_"/>pulldownAttribute</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278980FieldAnchor_"/>testerAndsubject</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>usedOnTestLayouts</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278981FieldAnchor_"/>userLocationName</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278982FieldAnchor_"/>kctest</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278984FieldAnchor_"/>fileName</td><td>Calculated, Text</td><td><strong>Calculation:</strong>
<ul>
<li>Context table: <em>TEMP</em>
</li>
<li>
<strong>Get</strong> ( FileName )</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
<li>Index Language: English</li>
</ul>
</td><td>usedOnDefaultLayoutToDisplayFileName</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278986FieldAnchor_"/>mFocus</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Constant data: focus</li>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>matchFieldUsedToMakeTagGroupTableOnlyDisplayItemsLabeledWithTheWordFocus</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278987FieldAnchor_"/>mAttribute</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Constant data: attribute</li>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>matchFieldUsedToMakeTagGroupTableOnlyDisplayItemsLabeledWithTheWordAttribute</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278988FieldAnchor_"/>kcfocuses</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278989FieldAnchor_"/>sortTestItem</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278990FieldAnchor_"/>mTestItemGroup</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Constant data: testItemGroup</li>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>matchFieldUsedToMakeGroupTagTableOnlyDisplayItemsLabeledWithtestItemGroupInTheNameSpellingField</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278991FieldAnchor_"/>addTestItemGroup</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>usedToAddANewTestItemGroupOnSetupTestItemLayou</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278992FieldAnchor_"/>ktestListtTestName</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>storesNameOfTestBelongingToATestList</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278994FieldAnchor_"/>filePathLibraryToSwitchTo</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>usedToSwitchToAnotherLibrary</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278995FieldAnchor_"/>DEFAULTNodePrimaryName</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>PrimaryNodeName</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278996FieldAnchor_"/>DefaultPicturePrimary Copy</td><td>Calculated, Text</td><td><strong>Calculation:</strong>
<ul>
<li>Context table: <em>tempSetup</em>
</li>
<li>
<strong>Case</strong> ( <strong>FilterValues</strong> ( <em>defaultPictureRef</em>::kfileLocation ; "8162011225532313" )  = "8162011225532313"  &amp; &para;;   <strong>Substitute</strong> ( "file:/" &amp; <strong>Middle</strong> ( <strong>Get</strong> ( FilePath ) ; 6 ; <strong>Length</strong> ( <strong>Get</strong> (FilePath ) ) - <strong>Length</strong> ( <strong>Get</strong> (FileName ) ) - 9) &amp; "x/" &amp; <em>defaultPictureRef</em>::fileName ; " " ; "%20" ) ; 

<strong>FilterValues</strong> ( <em>defaultPictureRef</em>::kfileLocation ; "8162011225558314" )  = "8162011225558314" &amp; &para;; <strong>Substitute</strong> ( "file:/" &amp; <strong>Middle</strong> ( <strong>Get</strong> ( FilePath ) ; 6 ; <strong>Length</strong> ( <strong>Get</strong> (FilePath ) ) - <strong>Length</strong> ( <strong>Get</strong> (FileName ) ) - 9) &amp; <em>defaultPictureRef</em>::fileName ; " " ; "%20" ) ; 

<strong>FilterValues</strong> ( <em>defaultPictureRef</em>::kfileLocation ; "8162011225605315" )  = "8162011225605315"   &amp; &para;; 

<strong>Substitute</strong> ( <strong>Case</strong> ( <strong>Get</strong> ( SystemPlatform ) =  - 2 ; "file:/" ; "file:///" ) &amp; <em>tagDefaultFolderPathRef</em>::tag ; " " ; "%20" ) &amp;

<strong>Case</strong> ( <strong>Left</strong> ( <em>defaultPictureRef</em>::fileName ; 1 ) =  "/" ; <strong>Substitute</strong> ( <em>defaultPictureRef</em>::fileName ; " " ; "%20" ) ;

 "/" &amp; <strong>Substitute</strong> ( <em>defaultPictureRef</em>::fileName ; " " ; "%20" ) );


<strong>//from testlearn table
</strong>

<strong>FilterValues</strong> ( <em>defaultPictureTL</em>::kfileLocation ; "8162011225532313" )  = "8162011225532313"  &amp; &para;;   <strong>Substitute</strong> ( "file:/" &amp; <strong>Middle</strong> ( <strong>Get</strong> ( FilePath ) ; 6 ; <strong>Length</strong> ( <strong>Get</strong> (FilePath ) ) - <strong>Length</strong> ( <strong>Get</strong> (FileName ) ) - 9) &amp; "x/" &amp; <em>defaultPictureTL</em>::filename ; " " ; "%20" ) ; 

<strong>FilterValues</strong> ( <em>defaultPictureTL</em>::kfileLocation ; "8162011225558314" )  = "8162011225558314" &amp; &para;; <strong>Substitute</strong> ( "file:/" &amp; <strong>Middle</strong> ( <strong>Get</strong> ( FilePath ) ; 6 ; <strong>Length</strong> ( <strong>Get</strong> (FilePath ) ) - <strong>Length</strong> ( <strong>Get</strong> (FileName ) ) - 9) &amp; <em>defaultPictureTL</em>::filename ; " " ; "%20" ) ; 

<strong>FilterValues</strong> ( <em>defaultPictureTL</em>::kfileLocation ; "8162011225605315" )  = "8162011225605315"   &amp; &para;; <em>tagDefaultFolderPathTL</em>::tag &amp; <em>defaultPictureTL</em>::filename ; 

"")</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Do not store calculation results</li>
<li>Index Language: English</li>
</ul>
</td><td>dueToFilemakerWebViewerOnlySeeingFieldsNativeToLayoutThisCalcIsRequiredToDuplicateRelatedFieldInfo</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278997FieldAnchor_"/>textORcheck</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>usedToDetermineIfAddTextOrCheckScriptAddsTheTextOfATestItemOrChecksItOffTheList</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278998FieldAnchor_"/>mTag</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>matchFieldUsedToMakeMoveTagPulldownOnlyDisplayGroupsThatMatchSelectedTagType</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3278999FieldAnchor_"/>duplicateOtherKeywords</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="32789100FieldAnchor_"/>kcsample</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="32789102FieldAnchor_"/>verionNumber</td><td>Calculated, Text</td><td><strong>Calculation:</strong>
<ul>
<li>Context table: <em>TEMP</em>
</li>
<li>"3.01 beta"</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="32789103FieldAnchor_"/>nodeLock</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>usedToStopNewRecordsBeingCreatedByALockedNode</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="32789104FieldAnchor_"/>nodeLockedShow</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>aCheckboxUsedToAllowUserToTurnOnConditionalFormattingForLockedRecords</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="32789105FieldAnchor_"/>paste</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul></ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
<li>Strict validation</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>usedToTemporarilyHoldCopyOfSample</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="32789106FieldAnchor_"/>mHealth</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Constant data: health</li>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>matchFieldUsedToMakeMoveTagPulldownOnlyDisplayGroupsThatMatchSelectedTagType</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="32789107FieldAnchor_"/>CopyNodeIDforNewDatabase</td><td>Calculated, Text</td><td><strong>Calculation:</strong>
<ul>
<li>Context table: <em>TEMP</em>
</li>
<li>
<em>TEMP</em>::kdefaultNodePrimary</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Do not store calculation results</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="32789108FieldAnchor_"/>Help</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 50</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="32789111FieldAnchor_"/>helpName</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="32789112FieldAnchor_"/>InventoryLibaryYN</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>yes no checkbox</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
		</tbody>
</table>
	<br>
		<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td colSpan="9">Table Name: <a name="32775BaseTableAnchor_"/>backup - 3 Fields</td>
</tr>
<tr class="chartheaders" vAlign="top">
<td width="8%">Field Name</td><td width="7%">Type</td><td width="14%">Options</td><td width="10%">Comments</td><td width="13%">On Layouts</td><td width="15%">In Relationships</td><td width="22%">In Scripts</td><td width="11%">In Value Lists</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327751FieldAnchor_"/>backup</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td>field is filled during backup process. So if it is not blank then the back up script should be performed. </td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327752FieldAnchor_"/>filepath</td><td>Calculated, Text</td><td><strong>Calculation:</strong>
<ul>
<li>Context table: <em>backup</em>
</li>
<li>
<strong>Get</strong> ( FilePath )</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
<li>Index Language: English</li>
</ul>
</td><td>neccessary to capture users choice of filepath, which is then copied and pasted between databases to falicitate a restore.</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327753FieldAnchor_"/>newLibrary</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
		</tbody>
</table>
	<br>
		<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td colSpan="9">Table Name: <a name="32791BaseTableAnchor_"/>locationListTEMP - 1 Fields</td>
</tr>
<tr class="chartheaders" vAlign="top">
<td width="8%">Field Name</td><td width="7%">Type</td><td width="14%">Options</td><td width="10%">Comments</td><td width="13%">On Layouts</td><td width="15%">In Relationships</td><td width="22%">In Scripts</td><td width="11%">In Value Lists</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327912FieldAnchor_"/>ktag</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td>usedToCreateValueListForAllowedLocationsForSpecificReportItems</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
		</tbody>
</table>
	<br>
		<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td colSpan="9">Table Name: <a name="32798BaseTableAnchor_"/>referenceType - 33 Fields</td>
</tr>
<tr class="chartheaders" vAlign="top">
<td width="8%">Field Name</td><td width="7%">Type</td><td width="14%">Options</td><td width="10%">Comments</td><td width="13%">On Layouts</td><td width="15%">In Relationships</td><td width="22%">In Scripts</td><td width="11%">In Value Lists</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327981FieldAnchor_"/>_LreferenceType</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Do not replace existing value for field (if any)</li>
<li>Context table: <em>refMedia</em>
<br>Calculation: <strong>Month</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) &amp; 
(<strong>If</strong> ( <strong>Day</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) &gt; 9 ; <strong>Day</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) ; 0 &amp;  (<strong>Day</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) ) ) )&amp; 
<strong>Year</strong> ( <strong>Get</strong> ( <strong>CurrentDate</strong> ) ) &amp;
(<strong>If</strong> ( <strong>Hour</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) &gt; 9 ; <strong>Hour</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ; 0 &amp;  (<strong>Hour</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ) ) )&amp;  
(<strong>If</strong> ( <strong>Minute</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) )&gt; 9 ; <strong>Minute</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ; 0 &amp;  (<strong>Minute</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ) ) )&amp;  
(<strong>If</strong> ( <strong>Seconds</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) &gt; 9 ; <strong>Seconds</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ; 0 &amp;  (<strong>Seconds</strong> ( <strong>Get</strong> ( <strong>CurrentTime</strong> ) ) ) ) )&amp;  
<em>refMedia</em>::_Number</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
<li>Not empty</li>
<li>Unique</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327982FieldAnchor_"/>_Number</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
<li>Serial: Generate: On creation, Next value: 109, Increment: 1</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: All</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327983FieldAnchor_"/>medium</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327984FieldAnchor_"/>type</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: Minimal</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327985FieldAnchor_"/>key</td><td>Normal, Number</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327986FieldAnchor_"/>mediumName</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td>used in reference</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327988FieldAnchor_"/>fIssue_edition</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327989FieldAnchor_"/>fVolume</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279810FieldAnchor_"/>fPageRange</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279811FieldAnchor_"/>fCity</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279812FieldAnchor_"/>fPublisher</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279813FieldAnchor_"/>fDateYear</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279814FieldAnchor_"/>fISBN</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279815FieldAnchor_"/>fTimeLength</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279816FieldAnchor_"/>fDate</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279818FieldAnchor_"/>fDateOther</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279819FieldAnchor_"/>fURL</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279820FieldAnchor_"/>fDOI</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279821FieldAnchor_"/>fFileInfo</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279822FieldAnchor_"/>fChapter</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279823FieldAnchor_"/>fCompilation</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279824FieldAnchor_"/>fEditor</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279825FieldAnchor_"/>fPublication</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279826FieldAnchor_"/>fletterDate</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279827FieldAnchor_"/>fEmailRecipient</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279828FieldAnchor_"/>fConferencePaperInfo</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279829FieldAnchor_"/>fNoAuthorTitle</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279834FieldAnchor_"/>NOitalics</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279836FieldAnchor_"/>typeName</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279838FieldAnchor_"/>fISSN</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279839FieldAnchor_"/>fGovtCorpAuthor</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279840FieldAnchor_"/>fOtherDocInfo</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="3279841FieldAnchor_"/>fConferenceProceedings</td><td>Normal, Text</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
<li>Indexing: None</li>
<li>Automatically create indexes as needed</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
		</tbody>
</table>
	
<p>
<span class="partheading"><a name="valScriptsSectionAnchor_"/>Script Hierarchy</span>
</p>
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="33297ScriptAnchor_toc"></a><a href="#33297ScriptAnchor_">startclose</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="33086ScriptAnchor_toc"></a><a href="#33086ScriptAnchor_">startDatabase</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32855ScriptAnchor_toc"></a><a href="#32855ScriptAnchor_">start</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33179ScriptAnchor_toc"></a><a href="#33179ScriptAnchor_">closeLibrary</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33337ScriptAnchor_toc"></a><a href="#33337ScriptAnchor_">moreInfo</a></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr>
<td class="script_hier"><a name="33299ScriptAnchor_toc"></a><a href="#33299ScriptAnchor_">libraryNewOrUpdate</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="32791ScriptAnchor_toc"></a><a href="#32791ScriptAnchor_">switchTestList</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33234ScriptAnchor_toc"></a><a href="#33234ScriptAnchor_">update</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33236ScriptAnchor_toc"></a><a href="#33236ScriptAnchor_">createEmptyLibrary</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33244ScriptAnchor_toc"></a><a href="#33244ScriptAnchor_">copyPrimaryNodeID</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33237ScriptAnchor_toc"></a><a href="#33237ScriptAnchor_">sampleCopyForPasting</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33239ScriptAnchor_toc"></a><a href="#33239ScriptAnchor_">sampleCopyCopyText</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32959ScriptAnchor_toc"></a><a href="#32959ScriptAnchor_">import</a></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr>
<td class="script_hier"><a name="33301ScriptAnchor_toc"></a><a href="#33301ScriptAnchor_">changeLibraryOrLibraryName</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="32935ScriptAnchor_toc"></a><a href="#32935ScriptAnchor_">changeSectionName</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33178ScriptAnchor_toc"></a><a href="#33178ScriptAnchor_">switchLibrary</a></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr>
<td class="script_hier"><a name="33305ScriptAnchor_toc"></a><a href="#33305ScriptAnchor_">sectionScripts</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="32936ScriptAnchor_toc"></a><a href="#32936ScriptAnchor_">changeSectionGroupName</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33154ScriptAnchor_toc"></a><a href="#33154ScriptAnchor_">newSectionOnSectionLayout</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33155ScriptAnchor_toc"></a><a href="#33155ScriptAnchor_">deleteSection</a></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr>
<td class="script_hier"><a name="33303ScriptAnchor_toc"></a><a href="#33303ScriptAnchor_">testScreens</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="33323ScriptAnchor_toc"></a><a href="#33323ScriptAnchor_">setup</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="32845ScriptAnchor_toc"></a><a href="#32845ScriptAnchor_">gotoSetupTest</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32930ScriptAnchor_toc"></a><a href="#32930ScriptAnchor_">loadSetupTestRecord</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32925ScriptAnchor_toc"></a><a href="#32925ScriptAnchor_">newTestGroup</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32926ScriptAnchor_toc"></a><a href="#32926ScriptAnchor_">newTest</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32927ScriptAnchor_toc"></a><a href="#32927ScriptAnchor_">deleteTest</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32820ScriptAnchor_toc"></a><a href="#32820ScriptAnchor_">deleteTestItem</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32818ScriptAnchor_toc"></a><a href="#32818ScriptAnchor_">newTestItem</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32929ScriptAnchor_toc"></a><a href="#32929ScriptAnchor_">moveTestItemToNewTestGroupStep1</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33073ScriptAnchor_toc"></a><a href="#33073ScriptAnchor_">newTestItemGroup</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33224ScriptAnchor_toc"></a><a href="#33224ScriptAnchor_">testNameToRevertNamField</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32928ScriptAnchor_toc"></a><a href="#32928ScriptAnchor_">moveTestItemToNewTestGroupStep2</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33342ScriptAnchor_toc"></a><a href="#33342ScriptAnchor_">stuffCheckBox</a></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr>
<td class="script_hier"><a name="33317ScriptAnchor_toc"></a><a href="#33317ScriptAnchor_">test</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="33177ScriptAnchor_toc"></a><a href="#33177ScriptAnchor_">(un)linkTestItemGroupToTestItemList</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33228ScriptAnchor_toc"></a><a href="#33228ScriptAnchor_">testInfoOpenTextNewWindow</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33156ScriptAnchor_toc"></a><a href="#33156ScriptAnchor_">testCheck</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33140ScriptAnchor_toc"></a><a href="#33140ScriptAnchor_">testSetLocationName</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33136ScriptAnchor_toc"></a><a href="#33136ScriptAnchor_">loadtestinfo</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32903ScriptAnchor_toc"></a><a href="#32903ScriptAnchor_">scroll test</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32971ScriptAnchor_toc"></a><a href="#32971ScriptAnchor_">loadTestRecord</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32775ScriptAnchor_toc"></a><a href="#32775ScriptAnchor_">newTestRecord</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32906ScriptAnchor_toc"></a><a href="#32906ScriptAnchor_">linkTestFocusOrUnlinkTestFocus</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32829ScriptAnchor_toc"></a><a href="#32829ScriptAnchor_">gotoTestItem</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32826ScriptAnchor_toc"></a><a href="#32826ScriptAnchor_">step2_OpenInspectionItemsTEST</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33138ScriptAnchor_toc"></a><a href="#33138ScriptAnchor_">loadItemRecord</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32841ScriptAnchor_toc"></a><a href="#32841ScriptAnchor_">step3_OpenOneItemJustLook</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32840ScriptAnchor_toc"></a><a href="#32840ScriptAnchor_">returnToStep3</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32844ScriptAnchor_toc"></a><a href="#32844ScriptAnchor_">done</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32837ScriptAnchor_toc"></a><a href="#32837ScriptAnchor_">delete_Evidence</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32843ScriptAnchor_toc"></a><a href="#32843ScriptAnchor_">OKonInpsection</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32898ScriptAnchor_toc"></a><a href="#32898ScriptAnchor_">OKonReport</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32834ScriptAnchor_toc"></a><a href="#32834ScriptAnchor_">inspectNextRecord</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32835ScriptAnchor_toc"></a><a href="#32835ScriptAnchor_">inspectPreviousRecord</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32839ScriptAnchor_toc"></a><a href="#32839ScriptAnchor_">itemNA</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32836ScriptAnchor_toc"></a><a href="#32836ScriptAnchor_">inspectAddProblemToFinding</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32832ScriptAnchor_toc"></a><a href="#32832ScriptAnchor_">returnToInspectionItems</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32828ScriptAnchor_toc"></a><a href="#32828ScriptAnchor_">CHUNK_countInspectedItems</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33293ScriptAnchor_toc"></a><a href="#33293ScriptAnchor_">exitAndStopclearCitationMatch</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32904ScriptAnchor_toc"></a><a href="#32904ScriptAnchor_">exitAndOrderEvidence</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32893ScriptAnchor_toc"></a><a href="#32893ScriptAnchor_">reportNewEvidence</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32899ScriptAnchor_toc"></a><a href="#32899ScriptAnchor_">reportDeleteEvidence</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32895ScriptAnchor_toc"></a><a href="#32895ScriptAnchor_">reportSelectLocation</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33325ScriptAnchor_toc"></a><a href="#33325ScriptAnchor_">probablyNotInUse</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="32857ScriptAnchor_toc"></a><a href="#32857ScriptAnchor_">returnToStep1</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32856ScriptAnchor_toc"></a><a href="#32856ScriptAnchor_">returnToStep2</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32881ScriptAnchor_toc"></a><a href="#32881ScriptAnchor_">delete_Finding Copy</a></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr>
<td class="script_hier"><a name="33313ScriptAnchor_toc"></a><a href="#33313ScriptAnchor_">testReport</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="32949ScriptAnchor_toc"></a><a href="#32949ScriptAnchor_">pagePulldown</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32848ScriptAnchor_toc"></a><a href="#32848ScriptAnchor_">nextPage</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32849ScriptAnchor_toc"></a><a href="#32849ScriptAnchor_">previousPage</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32865ScriptAnchor_toc"></a><a href="#32865ScriptAnchor_">showModifier1</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32866ScriptAnchor_toc"></a><a href="#32866ScriptAnchor_">showModifier2</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32824ScriptAnchor_toc"></a><a href="#32824ScriptAnchor_">newInspectionLocation</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32825ScriptAnchor_toc"></a><a href="#32825ScriptAnchor_">deleteInspectionLocation</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33327ScriptAnchor_toc"></a><a href="#33327ScriptAnchor_">probablyNotInUse</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="32815ScriptAnchor_toc"></a><a href="#32815ScriptAnchor_">findInspectionItemValueList</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32946ScriptAnchor_toc"></a><a href="#32946ScriptAnchor_">evidenceSpacetime</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32822ScriptAnchor_toc"></a><a href="#32822ScriptAnchor_">evidenceDetailSpacetimeDELETE?????</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32943ScriptAnchor_toc"></a><a href="#32943ScriptAnchor_">evidenceDetailDELETE?????</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32827ScriptAnchor_toc"></a><a href="#32827ScriptAnchor_">deleteInspectionComplement</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32917ScriptAnchor_toc"></a><a href="#32917ScriptAnchor_">newAttribute</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32961ScriptAnchor_toc"></a><a href="#32961ScriptAnchor_">newEvidenceWindow</a></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr>
<td class="script_hier"><a name="32973ScriptAnchor_toc"></a><a href="#32973ScriptAnchor_">evidenceTag</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32846ScriptAnchor_toc"></a><a href="#32846ScriptAnchor_">deleteSetupItems</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32823ScriptAnchor_toc"></a><a href="#32823ScriptAnchor_">deleteInspectionSetupItem</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32809ScriptAnchor_toc"></a><a href="#32809ScriptAnchor_">editReport</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32905ScriptAnchor_toc"></a><a href="#32905ScriptAnchor_">CHUNK_gotoItemViaPulldown</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32962ScriptAnchor_toc"></a><a href="#32962ScriptAnchor_">zoomReport</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32963ScriptAnchor_toc"></a><a href="#32963ScriptAnchor_">unzoomReport</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32802ScriptAnchor_toc"></a><a href="#32802ScriptAnchor_">inUsePart1</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32803ScriptAnchor_toc"></a><a href="#32803ScriptAnchor_">inUsePart3</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32808ScriptAnchor_toc"></a><a href="#32808ScriptAnchor_">deleteRowOfPhotosFromReport</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32878ScriptAnchor_toc"></a><a href="#32878ScriptAnchor_">newRowOfPhotos</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32879ScriptAnchor_toc"></a><a href="#32879ScriptAnchor_">sortReport</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32920ScriptAnchor_toc"></a><a href="#32920ScriptAnchor_">editSectionFocuses</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32913ScriptAnchor_toc"></a><a href="#32913ScriptAnchor_">newFocus</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32914ScriptAnchor_toc"></a><a href="#32914ScriptAnchor_">deleteFocus</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32918ScriptAnchor_toc"></a><a href="#32918ScriptAnchor_">deleteAttribute</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33095ScriptAnchor_toc"></a><a href="#33095ScriptAnchor_">gotoDefaultsOrReport</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33050ScriptAnchor_toc"></a><a href="#33050ScriptAnchor_">previewReport</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33135ScriptAnchor_toc"></a><a href="#33135ScriptAnchor_">reportTagInfo</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33139ScriptAnchor_toc"></a><a href="#33139ScriptAnchor_">reportTagDiscovery</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33221ScriptAnchor_toc"></a><a href="#33221ScriptAnchor_">reportExitOnRecordLoad</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33276ScriptAnchor_toc"></a><a href="#33276ScriptAnchor_">reportPreviewClose</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33143ScriptAnchor_toc"></a><a href="#33143ScriptAnchor_">reportClearDiscoveryLink</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33142ScriptAnchor_toc"></a><a href="#33142ScriptAnchor_">setupUpdateReportNumber</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33131ScriptAnchor_toc"></a><a href="#33131ScriptAnchor_">openDetailWindow !!! FINISH LATER !!!</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33166ScriptAnchor_toc"></a><a href="#33166ScriptAnchor_">Print</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="33167ScriptAnchor_toc"></a><a href="#33167ScriptAnchor_">printThingReport</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33168ScriptAnchor_toc"></a><a href="#33168ScriptAnchor_">TOC</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33169ScriptAnchor_toc"></a><a href="#33169ScriptAnchor_">CHUNK_insertPageNumbers</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33170ScriptAnchor_toc"></a><a href="#33170ScriptAnchor_">CHUNK_pagenumberTheme</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33171ScriptAnchor_toc"></a><a href="#33171ScriptAnchor_">CHUNK_pagenumberItem</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33172ScriptAnchor_toc"></a><a href="#33172ScriptAnchor_">CHUNK_insertPageNumbersbackOnePage</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33173ScriptAnchor_toc"></a><a href="#33173ScriptAnchor_">CHUNK_insertPageNumbersforwardOnePage</a></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr>
<td class="script_hier"><a name="33307ScriptAnchor_toc"></a><a href="#33307ScriptAnchor_">tagMenu</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="32942ScriptAnchor_toc"></a><a href="#32942ScriptAnchor_">backFromTagMenus</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32964ScriptAnchor_toc"></a><a href="#32964ScriptAnchor_">unzoomSetup</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32965ScriptAnchor_toc"></a><a href="#32965ScriptAnchor_">zoomSetup</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32924ScriptAnchor_toc"></a><a href="#32924ScriptAnchor_">gotoSetupReport</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32891ScriptAnchor_toc"></a><a href="#32891ScriptAnchor_">returnToSetup</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32988ScriptAnchor_toc"></a><a href="#32988ScriptAnchor_">menuNode</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32993ScriptAnchor_toc"></a><a href="#32993ScriptAnchor_">menuKey</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33013ScriptAnchor_toc"></a><a href="#33013ScriptAnchor_">menuHealth</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32989ScriptAnchor_toc"></a><a href="#32989ScriptAnchor_">menuMedium</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33068ScriptAnchor_toc"></a><a href="#33068ScriptAnchor_">menuTest</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33071ScriptAnchor_toc"></a><a href="#33071ScriptAnchor_">menuTestItem</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33117ScriptAnchor_toc"></a><a href="#33117ScriptAnchor_">menuSample</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33295ScriptAnchor_toc"></a><a href="#33295ScriptAnchor_">menuCitation</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33064ScriptAnchor_toc"></a><a href="#33064ScriptAnchor_">menuReference</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33004ScriptAnchor_toc"></a><a href="#33004ScriptAnchor_">menuCopyist</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32991ScriptAnchor_toc"></a><a href="#32991ScriptAnchor_">menuPath</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33012ScriptAnchor_toc"></a><a href="#33012ScriptAnchor_">menuOrgan</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32980ScriptAnchor_toc"></a><a href="#32980ScriptAnchor_">newCitationMenuGroup</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32979ScriptAnchor_toc"></a><a href="#32979ScriptAnchor_">newCitationMenuItem</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33042ScriptAnchor_toc"></a><a href="#33042ScriptAnchor_">menuRefAddKeyWords</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33137ScriptAnchor_toc"></a><a href="#33137ScriptAnchor_">gotoMainFromTestTagMenus</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33127ScriptAnchor_toc"></a><a href="#33127ScriptAnchor_">loadItemRecordForTestTagMenu</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33132ScriptAnchor_toc"></a><a href="#33132ScriptAnchor_">addTagToTestSubject</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33069ScriptAnchor_toc"></a><a href="#33069ScriptAnchor_">loadItemRecordForTestSetupTagMenu</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33133ScriptAnchor_toc"></a><a href="#33133ScriptAnchor_">defaultTestLocationMenu</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33128ScriptAnchor_toc"></a><a href="#33128ScriptAnchor_">setOrderForSampleOrTest</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33198ScriptAnchor_toc"></a><a href="#33198ScriptAnchor_">testAddTestItemTextOrKey</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33204ScriptAnchor_toc"></a><a href="#33204ScriptAnchor_">moveTagToNewGroupStep1</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33205ScriptAnchor_toc"></a><a href="#33205ScriptAnchor_">moveTagToNewGroupStep1b </a></td>
</tr>
<tr>
<td class="script_hier"><a name="33203ScriptAnchor_toc"></a><a href="#33203ScriptAnchor_">moveTagToNewGroupStep2</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33088ScriptAnchor_toc"></a><a href="#33088ScriptAnchor_">defaultNodeMenu</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33089ScriptAnchor_toc"></a><a href="#33089ScriptAnchor_">defaultHealthMenu</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33090ScriptAnchor_toc"></a><a href="#33090ScriptAnchor_">defaultSectionMenu</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33231ScriptAnchor_toc"></a><a href="#33231ScriptAnchor_">checkIfLockedOnLearnTagMenus</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33182ScriptAnchor_toc"></a><a href="#33182ScriptAnchor_">menuReferenceNodesOrEditors</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33219ScriptAnchor_toc"></a><a href="#33219ScriptAnchor_">loadItemRecordForSampleTagMenu</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33039ScriptAnchor_toc"></a><a href="#33039ScriptAnchor_">toggleTagMenuWindowView</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32983ScriptAnchor_toc"></a><a href="#32983ScriptAnchor_">TgotoCitationMenu</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32864ScriptAnchor_toc"></a><a href="#32864ScriptAnchor_">showTag</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33247ScriptAnchor_toc"></a><a href="#33247ScriptAnchor_">duplicateTheory</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32987ScriptAnchor_toc"></a><a href="#32987ScriptAnchor_">addTagToMainRecord</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33201ScriptAnchor_toc"></a><a href="#33201ScriptAnchor_">setDefaultSection</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33245ScriptAnchor_toc"></a><a href="#33245ScriptAnchor_">addBackSectionCreatorNode</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33038ScriptAnchor_toc"></a><a href="#33038ScriptAnchor_">loadTagRecord</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32995ScriptAnchor_toc"></a><a href="#32995ScriptAnchor_">addORremoveTagFromCitationStep1</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32992ScriptAnchor_toc"></a><a href="#32992ScriptAnchor_">addORremoveTagFromCitationStep2keyword</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32994ScriptAnchor_toc"></a><a href="#32994ScriptAnchor_">addORremoveTagFromCitationStep2node</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33011ScriptAnchor_toc"></a><a href="#33011ScriptAnchor_">changeSpellingOfCitationNodes</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32996ScriptAnchor_toc"></a><a href="#32996ScriptAnchor_">sortTags</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33066ScriptAnchor_toc"></a><a href="#33066ScriptAnchor_">addORremoveRefTagStep1</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33208ScriptAnchor_toc"></a><a href="#33208ScriptAnchor_">CHUNKaddMainSectionKeysToTagRecordKeychain_addMode</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33211ScriptAnchor_toc"></a><a href="#33211ScriptAnchor_">CHUNKaddMainSectionKeysToTagRecordKeychain</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33212ScriptAnchor_toc"></a><a href="#33212ScriptAnchor_">CHUNKaddMainRecordSectionKeysToCiteOrRefSectionKeychain</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33067ScriptAnchor_toc"></a><a href="#33067ScriptAnchor_">addORremoveCiteOrRefTLTag</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32999ScriptAnchor_toc"></a><a href="#32999ScriptAnchor_">changeSpellingOfKeywordOrNodeTag</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33007ScriptAnchor_toc"></a><a href="#33007ScriptAnchor_">changeSpellingOfTagCategory</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33074ScriptAnchor_toc"></a><a href="#33074ScriptAnchor_">changeSpellingOfDetailCategory</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33000ScriptAnchor_toc"></a><a href="#33000ScriptAnchor_">noCommasAllowed</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33001ScriptAnchor_toc"></a><a href="#33001ScriptAnchor_">deleteKeywordTag</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33002ScriptAnchor_toc"></a><a href="#33002ScriptAnchor_">deleteNodeTag</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33003ScriptAnchor_toc"></a><a href="#33003ScriptAnchor_">deleteMHOCSPtags</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33209ScriptAnchor_toc"></a><a href="#33209ScriptAnchor_">addTagSectionKeysToMainRecordKeychain</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33027ScriptAnchor_toc"></a><a href="#33027ScriptAnchor_">CHUNKaddLinkToTag</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33037ScriptAnchor_toc"></a><a href="#33037ScriptAnchor_">folderPathCheckForForwardSlash</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33043ScriptAnchor_toc"></a><a href="#33043ScriptAnchor_">gotoLessLayoutsTag</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33097ScriptAnchor_toc"></a><a href="#33097ScriptAnchor_">gotoLessLayoutsTL</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33075ScriptAnchor_toc"></a><a href="#33075ScriptAnchor_">gotoLessDetailLayout</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33076ScriptAnchor_toc"></a><a href="#33076ScriptAnchor_">gotoMoreDetailLayout</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33083ScriptAnchor_toc"></a><a href="#33083ScriptAnchor_">showCited</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33243ScriptAnchor_toc"></a><a href="#33243ScriptAnchor_">CHUNKHealthLockedFields</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33099ScriptAnchor_toc"></a><a href="#33099ScriptAnchor_">findMode</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33259ScriptAnchor_toc"></a><a href="#33259ScriptAnchor_">findModeCancel</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33100ScriptAnchor_toc"></a><a href="#33100ScriptAnchor_">findPrimaryTL</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33101ScriptAnchor_toc"></a><a href="#33101ScriptAnchor_">findKeyOtherTL</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33119ScriptAnchor_toc"></a><a href="#33119ScriptAnchor_">findPrimaryRef</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33120ScriptAnchor_toc"></a><a href="#33120ScriptAnchor_">findKeyOtherRef</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33223ScriptAnchor_toc"></a><a href="#33223ScriptAnchor_">CHUNKcheckForDragPasteChanges</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33222ScriptAnchor_toc"></a><a href="#33222ScriptAnchor_">lock</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33226ScriptAnchor_toc"></a><a href="#33226ScriptAnchor_">checkForDraggedPasteChangesIfLocked</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33227ScriptAnchor_toc"></a><a href="#33227ScriptAnchor_">insureEqualityOfSpellFields</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33235ScriptAnchor_toc"></a><a href="#33235ScriptAnchor_">lockNodesRecords</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33238ScriptAnchor_toc"></a><a href="#33238ScriptAnchor_">sampleExit</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32968ScriptAnchor_toc"></a><a href="#32968ScriptAnchor_">newTag</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33129ScriptAnchor_toc"></a><a href="#33129ScriptAnchor_">sortTLRecordsByOrderNumber</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33148ScriptAnchor_toc"></a><a href="#33148ScriptAnchor_">changeTLRecordsSort_Button</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33329ScriptAnchor_toc"></a><a href="#33329ScriptAnchor_">probablyNotInUse</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="33126ScriptAnchor_toc"></a><a href="#33126ScriptAnchor_">loadItemRecordForLearnTagMenuDELETE!!!</a></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr>
<td class="script_hier"><a name="33311ScriptAnchor_toc"></a><a href="#33311ScriptAnchor_">menuFind</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="33118ScriptAnchor_toc"></a><a href="#33118ScriptAnchor_">menuSampleFind</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33102ScriptAnchor_toc"></a><a href="#33102ScriptAnchor_">menuNodeFind</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33103ScriptAnchor_toc"></a><a href="#33103ScriptAnchor_">menuKeyFind</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33105ScriptAnchor_toc"></a><a href="#33105ScriptAnchor_">menuHealthFind</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33107ScriptAnchor_toc"></a><a href="#33107ScriptAnchor_">menuTestFind</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33106ScriptAnchor_toc"></a><a href="#33106ScriptAnchor_">menuMediumFind</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33108ScriptAnchor_toc"></a><a href="#33108ScriptAnchor_">menuCitationFind</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33109ScriptAnchor_toc"></a><a href="#33109ScriptAnchor_">menuReferenceFind</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33110ScriptAnchor_toc"></a><a href="#33110ScriptAnchor_">menuCopyistFind</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33111ScriptAnchor_toc"></a><a href="#33111ScriptAnchor_">menuPathFind</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33112ScriptAnchor_toc"></a><a href="#33112ScriptAnchor_">menuOrganFind</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33122ScriptAnchor_toc"></a><a href="#33122ScriptAnchor_">findReferernce</a></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr>
<td class="script_hier"><a name="33309ScriptAnchor_toc"></a><a href="#33309ScriptAnchor_">pictures</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="32847ScriptAnchor_toc"></a><a href="#32847ScriptAnchor_">pictureInsert</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33193ScriptAnchor_toc"></a><a href="#33193ScriptAnchor_">pictureDelete</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33196ScriptAnchor_toc"></a><a href="#33196ScriptAnchor_">pictureExport</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33144ScriptAnchor_toc"></a><a href="#33144ScriptAnchor_">clearpicture1</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32951ScriptAnchor_toc"></a><a href="#32951ScriptAnchor_">inUsePart2picture1</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32952ScriptAnchor_toc"></a><a href="#32952ScriptAnchor_">inUsePart2picture2</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33145ScriptAnchor_toc"></a><a href="#33145ScriptAnchor_">clearpicture2</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33149ScriptAnchor_toc"></a><a href="#33149ScriptAnchor_">clearpicture3</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33150ScriptAnchor_toc"></a><a href="#33150ScriptAnchor_">clearpicture4</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32953ScriptAnchor_toc"></a><a href="#32953ScriptAnchor_">inUsePart2picture3</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32954ScriptAnchor_toc"></a><a href="#32954ScriptAnchor_">inUsePart2picture4</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33020ScriptAnchor_toc"></a><a href="#33020ScriptAnchor_">addLinksPicturesToTagsMode</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33022ScriptAnchor_toc"></a><a href="#33022ScriptAnchor_">CHUNKaddPictureToTag</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33023ScriptAnchor_toc"></a><a href="#33023ScriptAnchor_">addPicture1ToTag</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33024ScriptAnchor_toc"></a><a href="#33024ScriptAnchor_">addPicture2ToTag</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33025ScriptAnchor_toc"></a><a href="#33025ScriptAnchor_">addPicture3ToTag</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33026ScriptAnchor_toc"></a><a href="#33026ScriptAnchor_">showCitationPicture1inNewWindow</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33056ScriptAnchor_toc"></a><a href="#33056ScriptAnchor_">showCitationPicture2inNewWindow</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33057ScriptAnchor_toc"></a><a href="#33057ScriptAnchor_">showCitationPicture3inNewWindow</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33053ScriptAnchor_toc"></a><a href="#33053ScriptAnchor_">showReferencePicture1</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33054ScriptAnchor_toc"></a><a href="#33054ScriptAnchor_">showReferencePicture2</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33055ScriptAnchor_toc"></a><a href="#33055ScriptAnchor_">showReferencePicture3</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33331ScriptAnchor_toc"></a><a href="#33331ScriptAnchor_">probablyNotInUse</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="33146ScriptAnchor_toc"></a><a href="#33146ScriptAnchor_">inUsePart2picture3 Copy</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33147ScriptAnchor_toc"></a><a href="#33147ScriptAnchor_">inUsePart2picture4 Copy</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33187ScriptAnchor_toc"></a><a href="#33187ScriptAnchor_">addPicture2ToTag Copy</a></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr>
<td class="script_hier"><a name="33319ScriptAnchor_toc"></a><a href="#33319ScriptAnchor_">learn</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="33091ScriptAnchor_toc"></a><a href="#33091ScriptAnchor_">showFileInTagandLearnWindows</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33125ScriptAnchor_toc"></a><a href="#33125ScriptAnchor_">deleteLearnMainRecord</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33152ScriptAnchor_toc"></a><a href="#33152ScriptAnchor_">editLearn</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33232ScriptAnchor_toc"></a><a href="#33232ScriptAnchor_">editTestLearn</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33233ScriptAnchor_toc"></a><a href="#33233ScriptAnchor_">finishTestLearnEdit</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33188ScriptAnchor_toc"></a><a href="#33188ScriptAnchor_">duplicateLearnRecord</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33199ScriptAnchor_toc"></a><a href="#33199ScriptAnchor_">learnOpenTextNewWindow</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33240ScriptAnchor_toc"></a><a href="#33240ScriptAnchor_">gotoLearnWebsite</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33250ScriptAnchor_toc"></a><a href="#33250ScriptAnchor_">findLearnRecord</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33252ScriptAnchor_toc"></a><a href="#33252ScriptAnchor_">cancelLearnFind</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33094ScriptAnchor_toc"></a><a href="#33094ScriptAnchor_">newLearn</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33333ScriptAnchor_toc"></a><a href="#33333ScriptAnchor_">probablyNotInUse</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="33284ScriptAnchor_toc"></a><a href="#33284ScriptAnchor_">findLearnRecord Copy</a></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr>
<td class="script_hier"><a name="33315ScriptAnchor_toc"></a><a href="#33315ScriptAnchor_">reference(citation)</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="32976ScriptAnchor_toc"></a><a href="#32976ScriptAnchor_">newReference</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33229ScriptAnchor_toc"></a><a href="#33229ScriptAnchor_">editReference</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33207ScriptAnchor_toc"></a><a href="#33207ScriptAnchor_">CHUNKaddReferenceNodesAndKeywords</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33065ScriptAnchor_toc"></a><a href="#33065ScriptAnchor_">addORremoveCitationOrReferenceRefTag</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33216ScriptAnchor_toc"></a><a href="#33216ScriptAnchor_">deleteReference</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33031ScriptAnchor_toc"></a><a href="#33031ScriptAnchor_">showFileInReferenceWindow</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33049ScriptAnchor_toc"></a><a href="#33049ScriptAnchor_">showReference1</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33051ScriptAnchor_toc"></a><a href="#33051ScriptAnchor_">showReference2</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33052ScriptAnchor_toc"></a><a href="#33052ScriptAnchor_">showReference3</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33084ScriptAnchor_toc"></a><a href="#33084ScriptAnchor_">internalReferences</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33085ScriptAnchor_toc"></a><a href="#33085ScriptAnchor_">externalReferences</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33184ScriptAnchor_toc"></a><a href="#33184ScriptAnchor_">changeSpellingOfReferenceNodes</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33189ScriptAnchor_toc"></a><a href="#33189ScriptAnchor_">duplicateReferenceRecord</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33190ScriptAnchor_toc"></a><a href="#33190ScriptAnchor_">addModeReferenceLearnToggle</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33251ScriptAnchor_toc"></a><a href="#33251ScriptAnchor_">findReferenceRecord</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33255ScriptAnchor_toc"></a><a href="#33255ScriptAnchor_">sortReferences</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33257ScriptAnchor_toc"></a><a href="#33257ScriptAnchor_">extractCreateDateFromReferenceRecords</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33277ScriptAnchor_toc"></a><a href="#33277ScriptAnchor_">REFERENCE LOOP</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33230ScriptAnchor_toc"></a><a href="#33230ScriptAnchor_">finishReferenceEdit</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32981ScriptAnchor_toc"></a><a href="#32981ScriptAnchor_">editCitation</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33018ScriptAnchor_toc"></a><a href="#33018ScriptAnchor_">showLongCitation</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33082ScriptAnchor_toc"></a><a href="#33082ScriptAnchor_">showCitation</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32984ScriptAnchor_toc"></a><a href="#32984ScriptAnchor_">loadCitation</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33014ScriptAnchor_toc"></a><a href="#33014ScriptAnchor_">clearCitationMatch</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33009ScriptAnchor_toc"></a><a href="#33009ScriptAnchor_">copyrightHolder</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33281ScriptAnchor_toc"></a><a href="#33281ScriptAnchor_">copyrightHolderDeleteEditor</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33292ScriptAnchor_toc"></a><a href="#33292ScriptAnchor_">URLcheck</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33015ScriptAnchor_toc"></a><a href="#33015ScriptAnchor_">removeTextFormatting</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33017ScriptAnchor_toc"></a><a href="#33017ScriptAnchor_">removeTextFormattingAndCommas</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33016ScriptAnchor_toc"></a><a href="#33016ScriptAnchor_">formatTitle</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33035ScriptAnchor_toc"></a><a href="#33035ScriptAnchor_">showFile2</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33036ScriptAnchor_toc"></a><a href="#33036ScriptAnchor_">showFile3</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33028ScriptAnchor_toc"></a><a href="#33028ScriptAnchor_">addFileLink4ToTag</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33029ScriptAnchor_toc"></a><a href="#33029ScriptAnchor_">addFileLink5ToTag</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33030ScriptAnchor_toc"></a><a href="#33030ScriptAnchor_">addFileLink6ToTag</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33032ScriptAnchor_toc"></a><a href="#33032ScriptAnchor_">showFolder</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33242ScriptAnchor_toc"></a><a href="#33242ScriptAnchor_">openCitationURL</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33181ScriptAnchor_toc"></a><a href="#33181ScriptAnchor_">setCitationMatchForAuthors</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33282ScriptAnchor_toc"></a><a href="#33282ScriptAnchor_">publisherCheckboxRadioButtonActionPart1</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33287ScriptAnchor_toc"></a><a href="#33287ScriptAnchor_">insertTimeInRefTimeField</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33288ScriptAnchor_toc"></a><a href="#33288ScriptAnchor_">goToRefRecord</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33290ScriptAnchor_toc"></a><a href="#33290ScriptAnchor_">helpReferenceFields</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33335ScriptAnchor_toc"></a><a href="#33335ScriptAnchor_">probablyNotInUse</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="33210ScriptAnchor_toc"></a><a href="#33210ScriptAnchor_">addReferenceNodesAndKeywords Copy</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32986ScriptAnchor_toc"></a><a href="#32986ScriptAnchor_">DELETE???loadRecordIDcitationlistlalyout</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33280ScriptAnchor_toc"></a><a href="#33280ScriptAnchor_">loadCitation OLD</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33285ScriptAnchor_toc"></a><a href="#33285ScriptAnchor_">findReferenceRecord Copy</a></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr>
<td class="script_hier"><a name="33321ScriptAnchor_toc"></a><a href="#33321ScriptAnchor_">sharedMainLayoutScripts</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="33341ScriptAnchor_toc"></a><a href="#33341ScriptAnchor_">copyAndpastTags</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32985ScriptAnchor_toc"></a><a href="#32985ScriptAnchor_">backToLearnOrDefaultSetup</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33130ScriptAnchor_toc"></a><a href="#33130ScriptAnchor_">backFromSetup</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33096ScriptAnchor_toc"></a><a href="#33096ScriptAnchor_">toggleMainWindowView</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33081ScriptAnchor_toc"></a><a href="#33081ScriptAnchor_">returnToAddRecordPUTONHOLD!!!!</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33093ScriptAnchor_toc"></a><a href="#33093ScriptAnchor_">gotoTimeLogMainWindow</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33116ScriptAnchor_toc"></a><a href="#33116ScriptAnchor_">gotoTimeLogLogWindow</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33186ScriptAnchor_toc"></a><a href="#33186ScriptAnchor_">stopScriptOniPhone</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33195ScriptAnchor_toc"></a><a href="#33195ScriptAnchor_">closeWindow</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33338ScriptAnchor_toc"></a><a href="#33338ScriptAnchor_">closeWindowHaltScript</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32932ScriptAnchor_toc"></a><a href="#32932ScriptAnchor_">backtoSetup</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33070ScriptAnchor_toc"></a><a href="#33070ScriptAnchor_">learn</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32811ScriptAnchor_toc"></a><a href="#32811ScriptAnchor_">Exit</a></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr>
<td class="script_hier"><a name="33266ScriptAnchor_toc"></a><a href="#33266ScriptAnchor_">help</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="33271ScriptAnchor_toc"></a><a href="#33271ScriptAnchor_">helpBack</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33248ScriptAnchor_toc"></a><a href="#33248ScriptAnchor_">help</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33268ScriptAnchor_toc"></a><a href="#33268ScriptAnchor_">libraryHelp</a></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<br>
<p>
<span class="partheading"><a name="33297ScriptAnchor_"></a><a href="#33297ScriptAnchor_toc">startclose</a></span>
</p>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33086ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"><a href="#33297ScriptAnchor_"><span>Parent Folder: [startclose]</span></a></td><td class="script_navbar"><a href="#32855ScriptAnchor_"><span>Next Script: [start]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">startDatabase</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33086ScriptAnchor_">startDatabase</a></li>
<li><a href="#33236ScriptAnchor_">createEmptyLibrary</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Check if database is being started by new library script.</li>
<li>Set Window Title [ Current Window; New Title: "Library Update" ]</li>
<li>Go to Layout [ &ldquo;backup&rdquo; (backup) ]</li>
<li>Delete All Records
[ No dialog ]</li>
<li>New Record/Request</li>
<li>If [ backup::newLibrary = "234874920347574weidf792342f9823984" ]</li>
<li>Show Custom Dialog [ Message: "Are you sure you want to delete the data in " &amp;  TEMP::fileName  &amp; " to make it a new empty one?  If you are not sure, DO NOT CLICK any of the buttons.  Instead, check the folder where this library is located and make sure this is a copy of the orignal and not the original. Next click either the stop or proceed button."; Buttons: &ldquo;stop&rdquo;, &ldquo;proceed&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Set Field [ backup::newLibrary; "" ]</li>
<li>Go to Layout [ &ldquo;defaultSetup&rdquo; (tempSetup) ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Go to Layout [ &ldquo;backup&rdquo; (backup) ]</li>
<li>Perform Script [ &ldquo;createEmptyLibrary&rdquo; ]</li>
<li>Set Field [ backup::newLibrary; "" ]</li>
<li>Go to Layout [ &ldquo;defaultSetup&rdquo; (tempSetup) ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>If [ backup::newLibrary = "newLibrary" ]</li>
<li>Go to Layout [ &ldquo;defaultSetup&rdquo; (tempSetup) ]</li>
<li>Show Custom Dialog [ Message: "1) Create a new, empty library." &amp; &para; &amp; "
2) Import another library's records into version " &amp; tempSetup::verionNumber &amp;   " of the library application."; Buttons: &ldquo;new&rdquo;, &ldquo;import&rdquo;, &ldquo;cancel&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 3 ]</li>
<li>Close Window [ Current Window ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Set Variable [ $$OldNodeID; Value:tempSetup::kdefaultNodePrimary ]</li>
<li>If [ $$OldNodeID = "" ]</li>
<li>Set Variable [ $$OldNodeID; Value:1 ]</li>
<li>End If</li>
<li>Go to Layout [ &ldquo;backup&rdquo; (backup) ]</li>
<li>Perform Script [ &ldquo;createEmptyLibrary&rdquo; ]</li>
<li>Set Field [ backup::newLibrary; "" ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Show Custom Dialog [ Message: "On some imports FileMaker crashes.  Cancel this import and duplicate this Empty Library file if you do not have an extra in case this happens.  If it does happen, delete the updated library, and try again."; Buttons: &ldquo;OK&rdquo;, &ldquo;cancel&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Close Window [ Current Window ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Perform Script [ &ldquo;update&rdquo; ]</li>
<li>Perform Script [ &ldquo;startDatabase&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Check if database is being started by update script.</li>
<li>Paste [ backup::backup ]
[ Select ]</li>
<li>If [ backup::backup  = "update439asdkc;liasdu;irejf.as.dkfupea;lksdfa,sm.eupqoiwendssasdeawsrre5o983498woeirf" ]</li>
<li>Set Field [ backup::backup; "" ]</li>
<li>Copy [ backup::filepath ]
[ Select ]</li>
<li>Close Window [ Name: "Tag Menus"; Current file ]</li>
<li>Close Window [ Current Window ]</li>
<li>End If</li>
<li>#</li>
<li>Go to Layout [ &ldquo;defaultSetup&rdquo; (tempSetup) ]</li>
<li>Show All Records</li>
<li>Delete All Records
[ No dialog ]</li>
<li>New Record/Request</li>
<li>Set Window Title [ Current Window; New Title: "Setup" ]</li>
<li>If [ Get ( SystemPlatform ) = - 2 ]</li>
<li>//  New Window [ Name: "Day"; Height: Get (WindowDesktopHeight) - 21; Width: 344; Top: 0; Left: Get (ScreenWidth) - 688 ]</li>
<li>Move/Resize Window [ Current Window; Height: Get (WindowDesktopHeight) - 21; Width: Get (ScreenWidth) / 2; Top: 0; Left: 0 ]</li>
<li>Else</li>
<li>Move/Resize Window [ Current Window; Height: Get (ScreenHeight); Width: Get (ScreenWidth) / 2; Top: 0; Left: 0 ]</li>
<li>End If</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#goto Tag Menus window</li>
<li>If [ Get ( SystemPlatform ) = - 2 ]</li>
<li>New Window [ Name: "Tag Menus"; Height: Get (WindowDesktopHeight) - 21; Width: Get (ScreenWidth) / 2; Top: 0; Left: Get (ScreenWidth) / 2 ]</li>
<li>Else</li>
<li>New Window [ Name: "Tag Menus"; Height: Get (ScreenHeight); Width: Get (ScreenWidth) / 2; Top: 0; Left: Get (ScreenWidth) / 2 ]</li>
<li>End If</li>
<li>Go to Layout [ &ldquo;defaultHealth&rdquo; (tagMenus) ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#Show regular menus if Admin logs in only.</li>
<li>Show/Hide Text Ruler
[ Hide ]</li>
<li>If [ Get ( AccountName ) = "Admin" ]</li>
<li>Show/Hide Status Area
[ Hide ]</li>
<li>Else</li>
<li>Show/Hide Status Area
[ Lock; Hide ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>Perform Script [ &ldquo;defaultSectionMenu&rdquo; ]</li>
<li>Perform Script [ &ldquo;setDefaultSection&rdquo; ]</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>#</li>
<li>Go to Layout [ &ldquo;startMemorySwitch&rdquo; (MemorySwitch) ]</li>
<li>Show All Records</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ Get ( FilePath ) = MemorySwitch::path ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>If [ Get ( FilePath ) &ne; MemorySwitch::path ]</li>
<li>New Record/Request</li>
<li>Set Field [ MemorySwitch::path; TEMP::filePath ]</li>
<li>Set Field [ MemorySwitch::name; TEMP::fileName ]</li>
<li>End If</li>
<li>Set Field [ MemorySwitch::currentLibraryPath; Get ( FilePath ) ]</li>
<li>#</li>
<li>#Report version number to Memory Switch Table.</li>
<li>Set Field [ MemorySwitch::versionLibrary; tempSetup::verionNumber ]</li>
<li>#</li>
<li>Go to Layout [ &ldquo;defaultSetup&rdquo; (tempSetup) ]</li>
<li>#</li>
<li>#Show regular menus if Admin logs in only.</li>
<li>Show/Hide Text Ruler
[ Hide ]</li>
<li>If [ Get ( AccountName ) = "Admin" ]</li>
<li>Show/Hide Status Area
[ Hide ]</li>
<li>Install Menu Set [ &ldquo;[Standard FileMaker Menus]&rdquo; ]</li>
<li>Else</li>
<li>Show/Hide Status Area
[ Lock; Hide ]</li>
<li>Install Menu Set [ &ldquo;HGT&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>If [ $$import = 1 ]</li>
<li>Set Variable [ $$import ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Perform Script [ &ldquo;defaultNodeMenu&rdquo; ]</li>
<li>Show Custom Dialog [ Message: "Import is almost complete!  Now select yourself as the default node (the one creating new records).  Last, select the default copyright and your import will be done!"; Buttons: &ldquo;OK&rdquo; ]</li>
<li>#</li>
<li>End If</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>backup</em>::newLibrary</li>
<li>
<em>TEMP</em>::fileName</li>
<li>
<em>tempSetup</em>::verionNumber</li>
<li>
<em>tempSetup</em>::kdefaultNodePrimary</li>
<li>
<em>backup</em>::backup</li>
<li>
<em>backup</em>::filepath</li>
<li>
<em>MemorySwitch</em>::path</li>
<li>
<em>TEMP</em>::filePath</li>
<li>
<em>MemorySwitch</em>::name</li>
<li>
<em>MemorySwitch</em>::currentLibraryPath</li>
<li>
<em>MemorySwitch</em>::versionLibrary</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33236ScriptAnchor_">createEmptyLibrary</a></li>
<li><a href="#33234ScriptAnchor_">update</a></li>
<li><a href="#33086ScriptAnchor_">startDatabase</a></li>
<li><a href="#33090ScriptAnchor_">defaultSectionMenu</a></li>
<li><a href="#33201ScriptAnchor_">setDefaultSection</a></li>
<li><a href="#33088ScriptAnchor_">defaultNodeMenu</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>backup</li>
<li>defaultSetup</li>
<li>defaultHealth</li>
<li>startMemorySwitch</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul>
<li>[Standard FileMaker Menus]</li>
<li>HGT</li>
</ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32855ScriptAnchor_"></a><td class="script_navbar"><a href="#33086ScriptAnchor_"><span>Previous Script: [startDatabase]</span></a></td><td class="script_navbar"><a href="#33297ScriptAnchor_"><span>Parent Folder: [startclose]</span></a></td><td class="script_navbar"><a href="#33179ScriptAnchor_"><span>Next Script: [closeLibrary]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">start</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Show/Hide Status Area
[ Lock; Hide ]</li>
<li>Show/Hide Text Ruler
[ Hide ]</li>
<li>#</li>
<li>#capture filepath for use in importing this files data</li>
<li>Go to Layout [ &ldquo;tempStart&rdquo; (TEMP) ]</li>
<li>New Record/Request</li>
<li>Paste [ TEMP::import ]
[ Select ]</li>
<li>Set Field [ TEMP::filePath; Get (FilePath) ]</li>
<li>If [ TEMP::import  =  "adflki3ina;lkfjie8;la;lkdvnma;ldieiasoerueoilanldf83984798374iwuhelfkjdlsidufioawkel" ]</li>
<li>Set Window Title [ Current Window; New Title: "import" ]</li>
<li>End If</li>
<li>Set Field [ TEMP::import; "" ]</li>
<li>Copy [ TEMP::filePath ]
[ Select ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>Close Window [ Name: "import"; Current file ]</li>
<li>Go to Layout [ original layout ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::import</li>
<li>
<em>TEMP</em>::filePath</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>tempStart</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33179ScriptAnchor_"></a><td class="script_navbar"><a href="#32855ScriptAnchor_"><span>Previous Script: [start]</span></a></td><td class="script_navbar"><a href="#33297ScriptAnchor_"><span>Parent Folder: [startclose]</span></a></td><td class="script_navbar"><a href="#33337ScriptAnchor_"><span>Next Script: [moreInfo]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">closeLibrary</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>//  Go to Layout [ &ldquo;startMemorySwitch&rdquo; (MemorySwitch) ]</li>
<li>//  Show All Records</li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  Loop</li>
<li>//  Exit Loop If [ tempSetup::filePath &ne; MemorySwitch::path ]</li>
<li>//  Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>//  End Loop</li>
<li>//  If [ tempSetup::filePath &ne; MemorySwitch::path ]</li>
<li>//  New Record/Request</li>
<li>//  Set Field [ MemorySwitch::path; TEMP::filePath ]</li>
<li>//  Set Field [ MemorySwitch::name; TEMP::fileName ]</li>
<li>//  End If</li>
<li>Close Window [ Current Window ]</li>
<li>Close Window [ Name: "Tag Menus"; Current file ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tempSetup</em>::filePath</li>
<li>
<em>MemorySwitch</em>::path</li>
<li>
<em>TEMP</em>::filePath</li>
<li>
<em>TEMP</em>::fileName</li>
<li>
<em>MemorySwitch</em>::name</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>startMemorySwitch</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33337ScriptAnchor_"></a><td class="script_navbar"><a href="#33179ScriptAnchor_"><span>Previous Script: [closeLibrary]</span></a></td><td class="script_navbar"><a href="#33297ScriptAnchor_"><span>Parent Folder: [startclose]</span></a></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">moreInfo</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>New Window [ Name: "More Info"; Left: Get ( WindowDesktopWidth ) - (Get ( WindowDesktopWidth )  / 2 ) ]</li>
<li>Go to Layout [ &ldquo;moreInfo&rdquo; (tempSetup) ]</li>
<li>Adjust Window
[ Resize to Fit ]</li>
<li>Pause/Resume Script [ Indefinitely ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>moreInfo</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<p>
<span class="partheading"><a name="33299ScriptAnchor_"></a><a href="#33299ScriptAnchor_toc">libraryNewOrUpdate</a></span>
</p>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32791ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"><a href="#33299ScriptAnchor_"><span>Parent Folder: [libraryNewOrUpdate]</span></a></td><td class="script_navbar"><a href="#33234ScriptAnchor_"><span>Next Script: [update]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">switchTestList</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If the user selected the list currently showing then</li>
<li>#stop the script.</li>
<li>If [ TEMP::ktestItemList = TEMP::ktestItemListOLD ]</li>
<li>Go to Field [  ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#switch to the selected test, which may or may</li>
<li>#not have a test-item list.</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ ruleTagMenuTestGroups::match; TEMP::ktestItemList ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#If there is no list, then inform the user of this fact</li>
<li>#at the end of the script, after the name of the list</li>
<li>#is updated.  To do that capture the 401 error message.</li>
<li>If [ Get (LastError) = 401 ]</li>
<li>Set Variable [ $emptyList; Value:1 ]</li>
<li>End If</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuTestGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuTestGroups::_Lgroup; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#assign newly selected test item list to test</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>Set Field [ test::ktestItemList; TEMP::ktestItemList ]</li>
<li>#</li>
<li>#get the switched-to-test's name.</li>
<li>#</li>
<li>#The reason for this whole section of the script</li>
<li>#(getting a test name) is that there is no relationship</li>
<li>#that can be made that would match the key of</li>
<li>#of the named test to this test and thus unlock</li>
<li>#and so allow the layout to show this test name.</li>
<li>#This is because the key to unlock the display of</li>
<li>#a test's name is in a keychain field where many</li>
<li>#keys may exist in list.  Filemaker cannot match</li>
<li>#a lock in one table to list of keys in another table.</li>
<li>#There must be only one key in a field in order</li>
<li>#for Filemaker to know which key to use in a lock.</li>
<li>#The database does not have the intellegence or</li>
<li>#programming to search through a list of keys</li>
<li>#to make a match to a lock field in another table.</li>
<li>#Thus, in order to display the name of the test in use</li>
<li>#we must have the system put that name in a temp</li>
<li>#field with global storage, which then allows it</li>
<li>#to be displayed on any layout where that temp</li>
<li>#field is displayed.  No relationship between the</li>
<li>#the temp table and the layout's table is required</li>
<li>#as long as the temp field is a global field, meaning</li>
<li>#all data in the field is the same for every record</li>
<li>#in the temp table.</li>
<li>#</li>
<li>#Get the ID of the current record so it can be</li>
<li>#looped back to.</li>
<li>Set Variable [ $currentTest; Value:test::_Ltest ]</li>
<li>#</li>
<li>#Turn of the record load triggered script to speed</li>
<li>#up this loop search.</li>
<li>Set Variable [ $$ID; Value:"ignore" ]</li>
<li>#</li>
<li>#Go to the first record and then test it and every</li>
<li>#other record until the test in question is found.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ test::_Ltest = TEMP::ktestItemList ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Set a temp field with this test's name.  This name</li>
<li>#field will then be used to show this test's name on</li>
<li>#the Tag Menus layout for setupTestItems.</li>
<li>Set Field [ TEMP::ktestListtTestName; test::testName ]</li>
<li>#</li>
<li>#go back to current test.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ test::_Ltest = $currentTest ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Set Variable [ $$ID; Value:$currentTest ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#make new and old tag keys identical, so when</li>
<li>#a switch is made this copy can be used as the old key</li>
<li>#in the first part of this script.  Switching automatically</li>
<li>#replaces the current key with whatever is selected,</li>
<li>#thus the need to preserve a copy now, before a switch is made.</li>
<li>Set Field [ TEMP::ktestItemListOLD; TEMP::ktestItemList ]</li>
<li>#</li>
<li>#Update key used for the move pulldown to the new test.</li>
<li>Set Field [ TEMP::mTag; TEMP::ktestItemList ]</li>
<li>#</li>
<li>#return to tag layout and show all selected items</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Go to Layout [ &ldquo;setupTestItem&rdquo; (tagMenus) ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#If list is empty, now tell the user this so they don't</li>
<li>#think the system failed because nothing was found.</li>
<li>If [ $emptyList = 1 ]</li>
<li>Show Custom Dialog [ Message: "This test-item list contains no test items.  You are welcome to create new ones."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::ktestItemList</li>
<li>
<em>TEMP</em>::ktestItemListOLD</li>
<li>
<em>ruleTagMenuTestGroups</em>::match</li>
<li>
<em>ruleTagMenuTestGroups</em>::order</li>
<li>
<em>ruleTagMenuTestGroups</em>::_Lgroup</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>test</em>::ktestItemList</li>
<li>
<em>test</em>::_Ltest</li>
<li>
<em>test</em>::testName</li>
<li>
<em>TEMP</em>::ktestListtTestName</li>
<li>
<em>TEMP</em>::mTag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>setupTestItem</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33234ScriptAnchor_"></a><td class="script_navbar"><a href="#32791ScriptAnchor_"><span>Previous Script: [switchTestList]</span></a></td><td class="script_navbar"><a href="#33299ScriptAnchor_"><span>Parent Folder: [libraryNewOrUpdate]</span></a></td><td class="script_navbar"><a href="#33236ScriptAnchor_"><span>Next Script: [createEmptyLibrary]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">update</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33086ScriptAnchor_">startDatabase</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Go to Layout [ &ldquo;backup&rdquo; (backup) ]</li>
<li>Delete All Records
[ No dialog ]</li>
<li>New Record/Request</li>
<li>Set Field [ backup::backup; "update439asdkc;liasdu;irejf.as.dkfupea;lksdfa,sm.eupqoiwendssasdeawsrre5o983498woeirf" ]</li>
<li>Cut [ backup::backup ]
[ Select ]</li>
<li>#2 open file and determine its location (path) then close it after its location has been pasted using that file's open script into the main data file</li>
<li>#file is unknown so user is given the opportunity to point the database to the backup copy of their choice</li>
<li>Go to Layout [ &ldquo;defaultSetup&rdquo; (tempSetup) ]</li>
<li>Open File [ &lt;unknown&gt; ]</li>
<li>If [ Get (LastError) = 1 ]</li>
<li>Close Window [ Current Window ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Make sure the file has been opened by this script.</li>
<li>Go to Layout [ &ldquo;backup&rdquo; (backup) ]</li>
<li>Paste [ backup::backup ]
[ Select; No style ]</li>
<li>If [ "update439asdkc;liasdu;irejf.as.dkfupea;lksdfa,sm.eupqoiwendssasdeawsrre5o983498woeirf" = backup::backup ]</li>
<li>Show Custom Dialog [ Message: "Close the selected library.  Then click update again to add its records to this updated version of the library application."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Set Variable [ $filepath; Value:backup::backup ]</li>
<li>#</li>
<li>Go to Layout [ &ldquo;tableTestSubjectFocus&rdquo; (tagTestSubjectLocation) ]</li>
<li>Show All Records</li>
<li>Import Records [ Source: &ldquo;$filepath&rdquo;; Target: &ldquo;tagTestSubjectLocation&rdquo;; Method: Add; Character Set: &ldquo;Unicode&rdquo;; Field Mapping: Source field 1 import to tagTestSubjectLocation::knode
Source field 2 import to tagTestSubjectLocation::kfocus
Source field 3 import to tagTestSubjectLocation::_LtestSubjectLocation
Source field 4 import to tagTestSubjectLocation::kfocusAttribute1
Source field 5 import to tagTestSubjectLocation::focusName
Source field 6 import to tagTestSubjectLocation::inUse
Source field 7 import to tagTestSubjectLocation::order
Source field 8 import to tagTestSubjectLocation::TimeStart
Source field 9 import to tagTestSubjectLocation::TimeTotal
Source field 10 import to tagTestSubjectLocation::_number
Source field 11 import to tagTestSubjectLocation::kfocusAttribute2
Source field 12 import to tagTestSubjectLocation::ksection
Source field 13 import to tagTestSubjectLocation::reportNumber
Source field 14 import to tagTestSubjectLocation::kRecordCreatorNode ]
[ No dialog ]</li>
<li>#</li>
<li>Go to Layout [ &ldquo;tableTest&rdquo; (test) ]</li>
<li>Show All Records</li>
<li>Import Records [ Source: &ldquo;$filepath&rdquo;; Target: &ldquo;test&rdquo;; Method: Add; Character Set: &ldquo;Unicode&rdquo;; Field Mapping: Source field 1 import to test::_Ltest
Source field 2 import to test::ktestGroup
Source field 3 import to test::_number
Source field 4 import to test::kcfocusALL
Source field 5 import to test::testName
Source field 6 import to test::order
Source field 7 import to test::retire
Source field 8 import to test::kgtester
Source field 9 import to test::glocationNameGlobal
Source field 10 import to test::gcontactNameGlobal
Source field 11 import to test::kgaudienceLocation
Source field 12 import to test::gprogressGlobal
Source field 13 import to test::ksection
Source field 14 import to test::kgreportNumber
Source field 15 import to test::mtestGroup
Source field 16 import to test::ktestItemList
Source field 17 import to test::rule
Source field 18 import to test::kRecordCreatorNode
Source field 19 import to test::kRecordModifierNode
Source field 20 import to test::RecordModifyDate
Source field 21 import to test::testNameRevert ]
[ No dialog ]</li>
<li>#</li>
<li>Go to Layout [ &ldquo;tableTestLearn&rdquo; (testlearn) ]</li>
<li>Show All Records</li>
<li>Import Records [ Source: &ldquo;$filepath&rdquo;; Target: &ldquo;testlearn&rdquo;; Method: Add; Character Set: &ldquo;Unicode&rdquo;; Field Mapping: Source field 1 import to testlearn::_Ltestlearn
Source field 2 import to testlearn::ktestSubject
Source field 3 import to testlearn::_Number
Source field 4 import to testlearn::ktest
Source field 5 import to testlearn::Caption
Source field 6 import to testlearn::Picture
Source field 7 import to testlearn::Location
Source field 8 import to testlearn::inUse
Source field 9 import to testlearn::kaudienceLocation
Source field 10 import to testlearn::InspectionItemCount
Source field 11 import to testlearn::CheckboxCaption
Source field 12 import to testlearn::recordnumberglobal
Source field 13 import to testlearn::recordcountglobal
Source field 14 import to testlearn::InspectionItemCountLocation
Source field 15 import to testlearn::OK
Source field 16 import to testlearn::kcsection
Source field 17 import to testlearn::backupPhotoNumber
Source field 18 import to testlearn::TimeStart
Source field 19 import to testlearn::TimeStop
Source field 20 import to testlearn::TimeTotal
Source field 21 import to testlearn::kreportNumber
Source field 22 import to testlearn::timestamp
Source field 24 import to testlearn::orderDiscovery
Source field 25 import to testlearn::kcKeywordOther
Source field 26 import to testlearn::kNodeOther
Source field 27 import to testlearn::kHealth
Source field 28 import to testlearn::kNodePrimary
Source field 29 import to testlearn::kmedium
Source field 30 import to testlearn::kcitation
Source field 31 import to testlearn::kfileLocation
Source field 32 import to testlearn::kfolderPath
Source field 33 import to testlearn::kKeywordPrimary
Source field 34 import to testlearn::OtherKeyWords
Source field 35 import to testlearn::NodeOthers
Source field 36 import to testlearn::URL
Source field 37 import to testlearn::filename
Source field 38 import to testlearn::kcreference
Source field 40 import to testlearn::filterFind
Source field 41 import to testlearn::kRecordCreatorNode
Source field 42 import to testlearn::kRecordModifierNode
Source field 43 import to testlearn::RecordModifyDate
Source field 44 import to testlearn::incomplete
Source field 46 import to testlearn::copyrightYear
Source field 47 import to testlearn::URLPubDate
Source field 48 import to testlearn::kcsample
Source field 49 import to testlearn::gkaudienceLocation
Source field 50 import to testlearn::kctest
Source field 51 import to testlearn::orderTest
Source field 52 import to testlearn::title
Source field 53 import to testlearn::kctestItem
Source field 54 import to testlearn::organEmailRecipient
Source field 55 import to testlearn::korgan
Source field 56 import to testlearn::kcopyist
Source field 57 import to testlearn::emailDate
Source field 59 import to testlearn::sampleCasePoint ]
[ No dialog ]</li>
<li>#</li>
<li>Go to Layout [ &ldquo;tableTag&rdquo; (tagTable) ]</li>
<li>Show All Records</li>
<li>Import Records [ Source: &ldquo;$filepath&rdquo;; Target: &ldquo;tagTable&rdquo;; Method: Update matching; Add remaining; Character Set: &ldquo;Unicode&rdquo;; Field Mapping: Source field 1 import to tagTable::kGroupOrTest
Source field 2 match with tagTable::_Ltag
Source field 3 import to tagTable::tag
Source field 4 import to tagTable::orderOrLock
Source field 5 import to tagTable::ksection
Source field 6 import to tagTable::_Number
Source field 7 import to tagTable::match
Source field 8 import to tagTable::tagSpelling
Source field 9 import to tagTable::kcsection
Source field 10 import to tagTable::Kpicture1
Source field 11 import to tagTable::notesOrHealth
Source field 12 import to tagTable::Ktitle1
Source field 13 import to tagTable::kfile
Source field 15 import to tagTable::Kpicture2
Source field 17 import to tagTable::Kpicture3
Source field 19 import to tagTable::Ktitle2
Source field 20 import to tagTable::Ktitle3
Source field 24 import to tagTable::kRecordCreatorNode
Source field 25 import to tagTable::kRecordModifierNode ]
[ No dialog ]</li>
<li>#</li>
<li>Go to Layout [ &ldquo;tableGroupTag&rdquo; (groupTest) ]</li>
<li>Show All Records</li>
<li>Import Records [ Source: &ldquo;$filepath&rdquo;; Target: &ldquo;groupTest&rdquo;; Method: Update matching; Add remaining; Character Set: &ldquo;Unicode&rdquo;; Field Mapping: Source field 1 match with groupTest::_Lgroup
Source field 2 import to groupTest::_Number
Source field 3 import to groupTest::match
Source field 4 import to groupTest::name
Source field 5 import to groupTest::ksection
Source field 6 import to groupTest::defaultSectionInfo
Source field 7 import to groupTest::testReportPicture
Source field 8 import to groupTest::CaptionORinuseCheck
Source field 9 import to groupTest::URLORHealth
Source field 10 import to groupTest::order
Source field 11 import to groupTest::nameSpelling
Source field 12 import to groupTest::kRecordCreatorNode
Source field 13 import to groupTest::kSectionCreatorNodesCreator
Source field 14 import to groupTest::aboutSection ]
[ No dialog ]</li>
<li>#</li>
<li>Go to Layout [ &ldquo;tableReference&rdquo; (reference) ]</li>
<li>Show All Records</li>
<li>Import Records [ Source: &ldquo;$filepath&rdquo;; Target: &ldquo;reference&rdquo;; Method: Update matching; Add remaining; Character Set: &ldquo;Unicode&rdquo;; Field Mapping: Source field 1 import to reference::_Number
Source field 2 match with reference::_Lreference
Source field 3 import to reference::ktestSubject
Source field 4 import to reference::ktest
Source field 5 import to reference::kcsection
Source field 6 import to reference::knodePrimary
Source field 7 import to reference::pubYear
Source field 8 import to reference::URL
Source field 9 import to reference::URLdate
Source field 10 import to reference::Title
Source field 11 import to reference::korgan
Source field 12 import to reference::volumeNumber
Source field 13 import to reference::PubDate
Source field 14 import to reference::pageNumberRange
Source field 15 import to reference::kcopyist
Source field 16 import to reference::OrginalCitation
Source field 17 import to reference::kcopyrightType
Source field 18 import to reference::kHealth
Source field 19 import to reference::kmedium
Source field 20 import to reference::kkeywordOther
Source field 21 import to reference::kkeywordPrimary
Source field 22 import to reference::thoughtsNotesEtc
Source field 23 import to reference::kfolderpath
Source field 24 import to reference::fileName
Source field 27 import to reference::referenceNodes
Source field 28 import to reference::CopyrightYear
Source field 29 import to reference::kcopyrightHolder
Source field 30 import to reference::referenceDump
Source field 31 import to reference::knodeOther
Source field 32 import to reference::NodeOthers
Source field 33 import to reference::OtherKeyWords
Source field 34 import to reference::referenceNodesOLD
Source field 35 import to reference::filterFind
Source field 36 import to reference::picture
Source field 37 import to reference::kfileLocation
Source field 38 import to reference::rights
Source field 39 import to reference::mFileLocation
Source field 40 import to reference::kcitation
Source field 41 import to reference::incomplete
Source field 42 import to reference::lock
Source field 44 import to reference::kcreatorNode
Source field 45 import to reference::kmodifierNode
Source field 46 import to reference::modifyDate
Source field 48 import to reference::TimeRange
Source field 51 import to reference::createDate
Source field 52 import to reference::show
Source field 53 import to reference::library only
Source field 54 import to reference::URLdoi
Source field 55 import to reference::issueNumber
Source field 56 import to reference::publisherLocation
Source field 57 import to reference::compilationTitle
Source field 58 import to reference::compilationEditors
Source field 59 import to reference::kmedia
Source field 60 import to reference::kmediaType
Source field 61 import to reference::compilationNumberOfEditors
Source field 62 import to reference::pubYearMonthRange
Source field 63 import to reference::ISBN
Source field 64 import to reference::pubDateOther
Source field 65 import to reference::bookChapter
Source field 66 import to reference::letterDate
Source field 67 import to reference::compilationAbbr
Source field 68 import to reference::emailRecipient
Source field 69 import to reference::conferenceIntroWords
Source field 70 import to reference::conferenceTitle
Source field 71 import to reference::conferenceSubTitle
Source field 72 import to reference::conferenceLocation
Source field 73 import to reference::conferenceDate
Source field 74 import to reference::conferenceGroupName
Source field 75 import to reference::TypeOfMediumOther
Source field 76 import to reference::GovernmentDocInfo
Source field 77 import to reference::governmentAuthor
Source field 78 import to reference::ISSN
Source field 79 import to reference::publisherTypeAlternative
Source field 80 import to reference::copyrightOtherHolder
Source field 81 import to reference::publisherTypeOther
Source field 82 import to reference::pageNumberOther
Source field 83 import to reference::dissertationThesisUniversity ]
[ No dialog ]</li>
<li>#</li>
<li>Go to Layout [ &ldquo;tableReport&rdquo; (report) ]</li>
<li>Show All Records</li>
<li>Import Records [ Source: &ldquo;$filepath&rdquo;; Target: &ldquo;report&rdquo;; Method: Add; Character Set: &ldquo;Unicode&rdquo;; Field Mapping: Source field 1 import to report::_Lreport
Source field 2 import to report::_Number
Source field 3 import to report::ktestSubject
Source field 4 import to report::_kfContactGeography
Source field 5 import to report::general_info
Source field 6 import to report::ktest
Source field 7 import to report::krecommendation
Source field 8 import to report::order
Source field 9 import to report::Picture
Source field 10 import to report::kthingRecommendationID
Source field 11 import to report::kgeneralSpecificItemRecommendationID
Source field 12 import to report::_kfPhoto
Source field 13 import to report::_kfContactGeography2
Source field 14 import to report::_kfContactGeography3
Source field 15 import to report::_kfContactGeography4
Source field 16 import to report::_kfContactGeography5
Source field 17 import to report::PictureCaption
Source field 18 import to report::textMain
Source field 19 import to report::textPhotoRow1
Source field 20 import to report::pagenumberItem
Source field 21 import to report::CurrentRecord
Source field 22 import to report::_kfPhoto2
Source field 23 import to report::_kfPhoto3
Source field 24 import to report::_kfPhoto4
Source field 25 import to report::pagenumberTheme
Source field 26 import to report::TOC
Source field 27 import to report::TOCnumbers
Source field 28 import to report::ReportCover
Source field 29 import to report::ReportPDFtitle
Source field 30 import to report::kreportNumber
Source field 31 import to report::ksection
Source field 32 import to report::kRecordCreatorNode
Source field 33 import to report::kRecordModifierNode
Source field 34 import to report::RecordModifyDate
Source field 35 import to report::khealth
Source field 36 import to report::textPhotoRow2 ]
[ No dialog ]</li>
<li>#</li>
<li>Set Field [ backup::backup; "" ]</li>
<li>Go to Layout [ &ldquo;defaultSetup&rdquo; (tempSetup) ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Go to Layout [ &ldquo;defaultNode1&rdquo; (tagMenus) ]</li>
<li>//  Perform Script [ &ldquo;defaultNodeMenu&rdquo; ]</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>Go to Layout [ &ldquo;backup&rdquo; (backup) ]</li>
<li>Set Field [ backup::newLibrary; "" ]</li>
<li>Set Field [ backup::backup; "" ]</li>
<li>Go to Layout [ &ldquo;defaultSetup&rdquo; (tempSetup) ]</li>
<li>#</li>
<li>Set Variable [ $$import; Value:1 ]</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>backup</em>::backup</li>
<li>
<em>backup</em>::newLibrary</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33088ScriptAnchor_">defaultNodeMenu</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>backup</li>
<li>defaultSetup</li>
<li>tableTestSubjectFocus</li>
<li>tableTest</li>
<li>tableTestLearn</li>
<li>tableTag</li>
<li>tableGroupTag</li>
<li>tableReference</li>
<li>tableReport</li>
<li>defaultNode1</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul>
<li><a href="#13631611TableAnchor_"><em>tagTestSubjectLocation</em></a></li>
<li><a href="#13631512TableAnchor_"><em>test</em></a></li>
<li><a href="#13631602TableAnchor_"><em>testlearn</em></a></li>
<li><a href="#13631627TableAnchor_"><em>tagTable</em></a></li>
<li><a href="#13631659TableAnchor_"><em>groupTest</em></a></li>
<li><a href="#13631722TableAnchor_"><em>reference</em></a></li>
<li><a href="#13631584TableAnchor_"><em>report</em></a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33236ScriptAnchor_"></a><td class="script_navbar"><a href="#33234ScriptAnchor_"><span>Previous Script: [update]</span></a></td><td class="script_navbar"><a href="#33299ScriptAnchor_"><span>Parent Folder: [libraryNewOrUpdate]</span></a></td><td class="script_navbar"><a href="#33244ScriptAnchor_"><span>Next Script: [copyPrimaryNodeID]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">createEmptyLibrary</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33086ScriptAnchor_">startDatabase</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>#</li>
<li>If [ backup::newLibrary = "" ]</li>
<li>Show Custom Dialog [ Message: "Create a new empty library?"; Buttons: &ldquo;cancel&rdquo;, &ldquo;OK&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#If user decides to create a new library...</li>
<li>If [ backup::newLibrary &ne; "234874920347574weidf792342f9823984" and backup::newLibrary  &ne; "newLibrary" ]</li>
<li>#</li>
<li>#Go to the backup layout, insure there is a record, and</li>
<li>#set with the code to create an empty library.</li>
<li>Go to Layout [ &ldquo;backup&rdquo; (backup) ]</li>
<li>Delete All Records
[ No dialog ]</li>
<li>New Record/Request</li>
<li>Set Field [ backup::newLibrary; "234874920347574weidf792342f9823984" ]</li>
<li>#</li>
<li>#Ask user what to name this new library.</li>
<li>Go to Layout [ original layout ]</li>
<li>#</li>
<li>#A copy not a clone must be created because some</li>
<li>#records are neccessary to running the Library and</li>
<li>#are removed when cloning the Library.</li>
<li>Save a Copy as [  ]
[ copy of current file ]</li>
<li>#</li>
<li>#If the user decides to cancel the script then stop the process.</li>
<li>If [ Get (LastError) = 1 ]</li>
<li>Go to Layout [ &ldquo;backup&rdquo; (backup) ]</li>
<li>Set Field [ backup::newLibrary; "" ]</li>
<li>Go to Layout [ original layout ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Reset the new library code to blank and return to main screen.</li>
<li>Go to Layout [ &ldquo;backup&rdquo; (backup) ]</li>
<li>Set Field [ backup::newLibrary; "" ]</li>
<li>Go to Layout [ original layout ]</li>
<li>Show Custom Dialog [ Message: "Now open your new library.  You will be asked if you want to delete the records in it.  Make sure it is the copy of your current library file and then proceed with the delete."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>Else If [ backup::newLibrary = "234874920347574weidf792342f9823984" or backup::newLibrary =  "newLibrary" ]</li>
<li>Set Field [ backup::newLibrary; "" ]</li>
<li>#</li>
<li>Go to Layout [ &ldquo;tableTemp&rdquo; (TEMP) ]</li>
<li>New Record/Request</li>
<li>Go to Field [ TEMP::addTestItemGroup ]</li>
<li>Loop</li>
<li>Set Field [ "" ]</li>
<li>Exit Loop If [ Get ( ActiveFieldName ) = "userLocationName" ]</li>
<li>Go to Next Field</li>
<li>End Loop</li>
<li>#</li>
<li>Go to Layout [ &ldquo;tableTestSubjectFocus&rdquo; (tagTestSubjectLocation) ]</li>
<li>Show All Records</li>
<li>Delete All Records
[ No dialog ]</li>
<li>#</li>
<li>Go to Layout [ &ldquo;tableTest&rdquo; (test) ]</li>
<li>Show All Records</li>
<li>Delete All Records
[ No dialog ]</li>
<li>#</li>
<li>Go to Layout [ &ldquo;tableTestLearn&rdquo; (testlearn) ]</li>
<li>Show All Records</li>
<li>Delete All Records
[ No dialog ]</li>
<li>#</li>
<li>Go to Layout [ &ldquo;tableGroupTag&rdquo; (groupTest) ]</li>
<li>Perform Find [ Specified Find Requests: Omit Records; Criteria: groupTest::order: &ldquo;*"lock"&rdquo; ]
[ Restore ]</li>
<li>Delete All Records
[ No dialog ]</li>
<li>#</li>
<li>Go to Layout [ &ldquo;tableTag&rdquo; (tagTable) ]</li>
<li>Perform Find [ Specified Find Requests: Omit Records; Criteria: tagTable::orderOrLock: &ldquo;lock&rdquo; ]
[ Restore ]</li>
<li>Delete All Records
[ No dialog ]</li>
<li>#</li>
<li>Go to Layout [ &ldquo;tableReference&rdquo; (reference) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::lock; "lock" ]</li>
<li>Perform Find [  ]</li>
<li>Show Omitted Only</li>
<li>Delete All Records
[ No dialog ]</li>
<li>#</li>
<li>Go to Layout [ &ldquo;tableReport&rdquo; (report) ]</li>
<li>Show All Records</li>
<li>Delete All Records
[ No dialog ]</li>
<li>#</li>
<li>Go to Layout [ &ldquo;defaultSetup&rdquo; (tempSetup) ]</li>
<li>#</li>
<li>Perform Script [ &ldquo;startDatabase&rdquo; ]</li>
<li>Set Field [ tempSetup::fileName; Get ( FileName ) ]</li>
<li>#</li>
<li>#Create first section.</li>
<li>Set Field [ TEMP::kdefaultNodePrimary; $$OldNodeID ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Go to Layout [ &ldquo;defaultSections&rdquo; (ruleSection) ]</li>
<li>Perform Script [ &ldquo;newSectionOnSectionLayout&rdquo; ]</li>
<li>Set Field [ ruleSection::name ]</li>
<li>Set Field [ TEMP::kdefaultNodePrimary; "" ]</li>
<li>If [ $$OldNodeID = 1 ]</li>
<li>Set Variable [ $$OldNodeID ]</li>
<li>End If</li>
<li>#</li>
<li>#Create first node.</li>
<li>Set Variable [ $$stopAddBack; Value:1 ]</li>
<li>Perform Script [ &ldquo;defaultNodeMenu&rdquo; ]</li>
<li>Perform Script [ &ldquo;newCitationMenuGroup&rdquo; ]</li>
<li>If [ $$OldNodeID &ne; "" ]</li>
<li>Set Field [ tagMenus::_Ltag; $$OldNodeID ]</li>
<li>End If</li>
<li>Set Variable [ $$OldNodeID; Value:tagMenus::_Ltag ]</li>
<li>Set Field [ ruleTagMenuGroups::kRecordCreatorNode; $$OldNodeID ]</li>
<li>Set Field [ tagMenus::tag; "lastName, firstName" ]</li>
<li>Perform Script [ &ldquo;addTagToMainRecord&rdquo; ]</li>
<li>Set Variable [ $$stopAddBack ]</li>
<li>#</li>
<li>#Assign node to first created section as its creator.</li>
<li>Go to Layout [ &ldquo;tableGroupTag&rdquo; (groupTest) ]</li>
<li>Perform Find [ Specified Find Requests: Find Records; Criteria: groupTest::kRecordCreatorNode: &ldquo;1&rdquo; ]
[ Restore ]</li>
<li>Sort Records [ Specified Sort Order: groupTest::match; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Field [ groupTest::kRecordCreatorNode; $$OldNodeID ]</li>
<li>Set Field [ groupTest::kSectionCreatorNodesCreator; $$OldNodeID ]</li>
<li>Set Field [ groupTest::aboutSection; "This library is for noting what we learn about  _________________, collecting references to it, and testing or collecting samples of ___________________ to improve the quality of our thinking and doing or __________________ quality (if  _________________ is a thing not a person)." ]</li>
<li>#</li>
<li>#Assign node to first created node group as its creator.</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>Set Field [ groupTest::kRecordCreatorNode; $$OldNodeID ]</li>
<li>Go to Layout [ &ldquo;defaultSetup&rdquo; (tempSetup) ]</li>
<li>#</li>
<li>#Inform user of next steps.</li>
<li>If [ $$OldNodeID &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "Change the name of the first node to your name since you will be the creator of new library records."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Set Variable [ $$OldNodeID ]</li>
<li>Else</li>
<li>Show Custom Dialog [ Message: "Change the name of the first node to your name since you will be the creator of new library records."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>backup</em>::newLibrary</li>
<li>
<em>TEMP</em>::addTestItemGroup</li>
<li>
<em>groupTest</em>::order</li>
<li>
<em>tagTable</em>::orderOrLock</li>
<li>
<em>reference</em>::lock</li>
<li>
<em>tempSetup</em>::fileName</li>
<li>
<em>TEMP</em>::kdefaultNodePrimary</li>
<li>
<em>ruleSection</em>::name</li>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>ruleTagMenuGroups</em>::kRecordCreatorNode</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>groupTest</em>::kRecordCreatorNode</li>
<li>
<em>groupTest</em>::match</li>
<li>
<em>groupTest</em>::kSectionCreatorNodesCreator</li>
<li>
<em>groupTest</em>::aboutSection</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33086ScriptAnchor_">startDatabase</a></li>
<li><a href="#33154ScriptAnchor_">newSectionOnSectionLayout</a></li>
<li><a href="#33088ScriptAnchor_">defaultNodeMenu</a></li>
<li><a href="#32980ScriptAnchor_">newCitationMenuGroup</a></li>
<li><a href="#32987ScriptAnchor_">addTagToMainRecord</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>backup</li>
<li>tableTemp</li>
<li>tableTestSubjectFocus</li>
<li>tableTest</li>
<li>tableTestLearn</li>
<li>tableGroupTag</li>
<li>tableTag</li>
<li>tableReference</li>
<li>tableReport</li>
<li>defaultSetup</li>
<li>defaultSections</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33244ScriptAnchor_"></a><td class="script_navbar"><a href="#33236ScriptAnchor_"><span>Previous Script: [createEmptyLibrary]</span></a></td><td class="script_navbar"><a href="#33299ScriptAnchor_"><span>Parent Folder: [libraryNewOrUpdate]</span></a></td><td class="script_navbar"><a href="#33237ScriptAnchor_"><span>Next Script: [sampleCopyForPasting]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">copyPrimaryNodeID</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>#</li>
<li>Copy [ tempSetup::CopyNodeIDforNewDatabase ]
[ Select ]</li>
<li>Go to Field [  ]</li>
<li>Show Custom Dialog [ Message: tempSetup::DEFAULTNodePrimaryName &amp; "'s ID number " &amp; tempSetup::kdefaultNodePrimary &amp; " has been copied."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tempSetup</em>::CopyNodeIDforNewDatabase</li>
<li>
<em>tempSetup</em>::DEFAULTNodePrimaryName</li>
<li>
<em>tempSetup</em>::kdefaultNodePrimary</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33237ScriptAnchor_"></a><td class="script_navbar"><a href="#33244ScriptAnchor_"><span>Previous Script: [copyPrimaryNodeID]</span></a></td><td class="script_navbar"><a href="#33299ScriptAnchor_"><span>Parent Folder: [libraryNewOrUpdate]</span></a></td><td class="script_navbar"><a href="#33239ScriptAnchor_"><span>Next Script: [sampleCopyCopyText]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">sampleCopyForPasting</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>#</li>
<li>#I commonly click the share button when I do not mean</li>
<li>#click it, so these next two question help the user</li>
<li>#stop this process if it was not intential.  They also</li>
<li>#help the user understand that if they proceed how long</li>
<li>#it is likely to take, so they don't become frustrated.</li>
<li>If [ Get ( FoundCount ) &gt; 999 and Get ( LayoutName ) &ne; "learn4EDIT" ]</li>
<li>Show Custom Dialog [ Message: "FYI: There are more than 1000 records to process.  This may take a few minutes.  Continue?"; Buttons: &ldquo;Yes&rdquo;, &ldquo;No&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>End If</li>
<li>If [ Get ( FoundCount ) &gt; 100 and Get ( LayoutName ) &ne; "learn4EDIT" ]</li>
<li>Show Custom Dialog [ Message: "FYI: There are more than 100 and less than 1000 records to process.  This may take a minute or more.  Continue?"; Buttons: &ldquo;Yes&rdquo;, &ldquo;No&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Begin process of show user selected records and their references.</li>
<li>Set Variable [ $$stopLoadCitation; Value:1 ]</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>Set Variable [ $layoutName; Value:Get ( LayoutName ) ]</li>
<li>Close Window [ Name: "Print/Copy"; Current file ]</li>
<li>New Window [ Name: "Print/Copy" ]</li>
<li>Go to Layout [ &ldquo;learnMenuSample&rdquo; (tagMenus) ]</li>
<li>If [ $$citationMatch = "sample" ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::_Ltag; $$tagsample ]</li>
<li>Perform Find [  ]</li>
<li>If [ tagMenus::notesOrHealth = "" ]</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Close Window [ Name: "Print/Copy"; Current file ]</li>
<li>Show Custom Dialog [ Message: "Select a copyright from the pulldown menu for your theory in the Tag Menus window.  If you are making a case, you probably need to select a no-remix copyright so all your points and evidence are kept together by anyone copying your work."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ Get (LastError) = 400 ]</li>
<li>Go to Layout [ &ldquo;learnPreviewLayout&rdquo; (testlearn) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection ]</li>
<li>Set Field [ testlearn::filterFind; "main" &amp; &para; ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: testlearn::date; descending
testlearn::timestamp; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>End If</li>
<li>End If</li>
<li>Go to Layout [ &ldquo;learnPreviewLayout&rdquo; (testlearn) ]</li>
<li>#</li>
<li>#If user is in QV, then find any linked learn records.</li>
<li>If [ $layoutName = "learn4EDIT" ]</li>
<li>Set Variable [ $findLinkedLearnRecords; Value:testlearn::_Ltestlearn ]</li>
<li>Loop</li>
<li>Go to Object [ Object Name: "ref2" ]</li>
<li>Exit Loop If [ Get (LastError)  = 101 ]</li>
<li>Set Variable [ $findLinkedLearnRecords; Value:refTestLearn::_Ltestlearn &amp; &para; &amp; $findLinkedLearnRecords ]</li>
<li>Go to Portal Row
[ Select; Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Determine how many keys there are.</li>
<li>Set Variable [ $numberOfKeys; Value:ValueCount ($findLinkedLearnRecords ) ]</li>
<li>#</li>
<li>#Find 1st record.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::_Ltestlearn; GetValue ( $findLinkedLearnRecords ; $numberOfKeys ) ]</li>
<li>Perform Find [  ]</li>
<li>Set Variable [ $numberOfKeys; Value:$numberOfKeys - 1 ]</li>
<li>#</li>
<li>If [ $numberOfKeys &ne; 0 ]</li>
<li>Go to Layout [ &ldquo;learn4EDIT&rdquo; (testlearn) ]</li>
<li>Show Custom Dialog [ Message: "The ideas expressed in this record are linked to ideas from previous records.  Do you want to also see these?"; Buttons: &ldquo;Yes&rdquo;, &ldquo;No&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Go to Layout [ &ldquo;learnPreviewLayout&rdquo; (testlearn) ]</li>
<li>#</li>
<li>#Loop thru each key to expand found records until</li>
<li>#all linked records have been found.</li>
<li>Loop</li>
<li>#</li>
<li>#Exit the loop when there are no more keys to check.</li>
<li>Exit Loop If [ $numberOfKeys = 0 ]</li>
<li>#</li>
<li>#Find record.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::_Ltestlearn; GetValue ( $findLinkedLearnRecords ; $numberOfKeys ) ]</li>
<li>Extend Found Set [  ]</li>
<li>#</li>
<li>#Go the next key up from the bottom of the list</li>
<li>#of keys on this section's keychain.</li>
<li>Set Variable [ $numberOfKeys; Value:$numberOfKeys - 1 ]</li>
<li>End Loop</li>
<li>#</li>
<li>Sort Records [ Specified Sort Order: testlearn::date; descending
testlearn::timestamp; descending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>Else</li>
<li>Go to Layout [ &ldquo;learnPreviewLayout&rdquo; (testlearn) ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>End If</li>
<li>#</li>
<li>#Now gather up and add references linked to all records.</li>
<li>Set Variable [ $point; Value:1 ]</li>
<li>Set Variable [ $evidence; Value:1 ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>Loop</li>
<li>Set Variable [ $copy; Value://previous records
Case ( $copy = "" ; "" ; $copy &amp; &para; &amp;  &para;) &amp; 

//text
Case ( testlearn::sampleCasePoint = "" ; $point &amp; "." &amp; $evidence &amp; 

//node
TextColor (
Case ( testlearn::kcitation &ne; "" ; "  Quote from cited work below." ;
 " ["  &amp; 
Case ( tagTLNodePrimary::tag = "" and testlearn::NodeOthers = "" ; TextStyleAdd ( "author not entered" ; Italic ) ;
tagTLNodePrimary::tag &ne; "" ; tagTLNodePrimary::tag ) &amp; 
Case ( testlearn::NodeOthers = "" ; "" ;  "; " &amp; testlearn::NodeOthers) &amp; 

//timestamp
" " &amp; testlearn::timestamp &amp; "]" ) 
 ; RGB ( 119 ; 119 ; 119 ) )  &amp; &para; &amp; 

//main text
TextFont ( testlearn::Caption ; "Georgia" )  ;
$point &amp; TextFont ( testlearn::Caption ; "Georgia" ) ) &amp; &para; &amp; 

//grey remain text
TextColor (

//keyword
Case ( testlearn::OtherKeyWords &ne; "" or testlearn::kKeywordPrimary &ne; "" ; &para; &amp; 
"keywords - " &amp; 

//primary keyword
tagTLKeywordPrimary::tag &amp; 
Case ( testlearn::OtherKeyWords = "" ; "" ; 

//other keyword
Case ( testlearn::kKeywordPrimary &ne; "" ; ", " &amp; testlearn::OtherKeyWords ; testlearn::OtherKeyWords ) ) ) &amp;

//URL
Case ( testlearn::URL &ne; "" ; &para; &amp; testlearn::URL  &amp;

//URLdate
Case ( testlearn::URLPubDate &ne; "" ; " (link validated " &amp; testlearn::URLPubDate &amp; ")" ; " (link validity unavailable)") ; "" ) 

//finsih text color
 ; RGB ( 119 ; 119 ; 119 ) ) ]</li>
<li>#</li>
<li>#Increase evidence number if point is the same.</li>
<li>If [ testlearn::sampleCasePoint = "" ]</li>
<li>Set Variable [ $evidence; Value:$evidence + 1 ]</li>
<li>Else</li>
<li>Set Variable [ $evidence; Value:1 ]</li>
<li>End If</li>
<li>If [ testlearn::kcreference &ne; "" ]</li>
<li>Go to Object [ Object Name: "ref1" ]</li>
<li>If [ refReference::referenceForReferenceWindow &ne; "" ]</li>
<li>Set Variable [ $copy; Value:$copy &amp; &para; &amp; 

//grey text
TextColor (

//references
Case ( testlearn::kcreference &ne; "" ; "References" ; "" )

//finsih text color
 ; RGB ( 119 ; 119 ; 119 ) ) ]</li>
<li>Loop</li>
<li>Go to Object [ Object Name: "ref1" ]</li>
<li>Exit Loop If [ Get (LastError)  = 101 ]</li>
<li>Set Variable [ $copy; Value:Case ( Right ( $copy ; 10 ) = "References" ;
$copy &amp; &para; &amp;  
//grey text
TextColor ( refReference::referenceForReferenceWindow ; RGB ( 119 ; 119 ; 119 ) ) ;
$copy &amp; &para; &amp; &para; &amp; 
//grey text
TextColor ( refReference::referenceForReferenceWindow ; RGB ( 119 ; 119 ; 119 ) ) ) ]</li>
<li>Go to Portal Row
[ Select; Next; Exit after last ]</li>
<li>End Loop</li>
<li>End If</li>
<li>End If</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>Set Variable [ $copy; Value:$copy &amp; &para; &amp;
//grey text
TextColor ( "_______________________________________________" ; RGB ( 119 ; 119 ; 119 ) ) ]</li>
<li>Exit Loop If [ (
FilterValues ( Middle ( GetValue ( testlearn::kcsample ; 1 ) ; 4 ; 42 ) ; $$tagSample &amp; "&para;"  )  = $$tagSample  &amp; &para; 
or 
FilterValues ( Middle ( GetValue ( testlearn::kcsample ; 2 ) ; 4 ; 42 ) ; $$tagSample &amp; "&para;"  )  = $$tagSample &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kcsample ; 3 ) ; 4 ; 42 ) ; $$tagSample &amp; "&para;"  )  = $$tagSample &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kcsample ; 4 ) ; 4 ; 42 ) ; $$tagSample &amp; "&para;"  )  = $$tagSample &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kcsample ; 5 ) ; 4 ; 42 ) ; $$tagSample &amp; "&para;"  )  = $$tagSample &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kcsample ; 6 ) ; 4 ; 42 ) ; $$tagSample &amp; "&para;"  )  = $$tagSample &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kcsample ; 7 ) ; 4 ; 42 ) ; $$tagSample &amp; "&para;"  )  = $$tagSample &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kcsample ; 8 ) ; 4 ; 42 ) ; $$tagSample &amp; "&para;"  )  = $$tagSample &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kcsample ; 9 ) ; 4 ; 42 ) ; $$tagSample &amp; "&para;"  )  = $$tagSample &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kcsample ; 10 ) ; 4 ; 42 ) ; $$tagSample &amp; "&para;"  )  = $$tagSample &amp; &para;
) &ne; 1 and $$tagSample &ne; "" ]</li>
<li>#</li>
<li>#Increase point number if point is different.</li>
<li>If [ testlearn::sampleCasePoint &ne; "" ]</li>
<li>Set Variable [ $point; Value:$point + 1 ]</li>
<li>End If</li>
<li>End Loop</li>
<li>#</li>
<li>#Now get sample title and previous dates of </li>
<li>#publication for this sample if there are any.</li>
<li>If [ $$citationMatch = "Sample" ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Set Variable [ $sample; Value://Sample Title
TextStyleAdd ( tagMenus::tag ; Titlecase ) &amp; &para; &amp; 

Case ( learnSampleWebsite::URLPubDate = "" ;
//author and copyright date
TEMP::DEFAULTNodePrimaryName &amp; " " &amp; Month ( Get ( CurrentDate ) ) &amp; "/" &amp; Day ( Get ( CurrentDate ) ) &amp; "/" &amp; Year ( Get ( CurrentDate ) )  &amp; " " ;

//author and copyright
nodeLockTagMenus::tag &amp; " " &amp; Month ( learnSampleWebsite::URLPubDate ) &amp; "/" &amp; Day ( learnSampleWebsite::URLPubDate ) &amp; "/" &amp; Year ( learnSampleWebsite::URLPubDate )  &amp; " " ) &amp; 

sampleCopyright::tag &amp; " " &amp; 
//title for history
&para; &amp; "Publication History" &amp; 

Case ( learnSampleWebsite::URL = "" ; &para; &amp; "(This posting is the first publication of this version of the theory and presentation of supporting evidence.)" ) ]</li>
<li>//  Set Variable [ $sample; Value://Sample Title
$sample &amp; &para; &amp; sampleCopyright::tag &amp; " " &amp;  Month ( learnSampleWebsite::URLPubDate ) &amp; "/" &amp; Day ( learnSampleWebsite::URLPubDate ) &amp; "/" &amp; Year ( learnSampleWebsite::URLPubDate ) &amp; " by " &amp; nodeLockTagMenus::tag ]</li>
<li>Loop</li>
<li>Go to Object [ Object Name: "publication" ]</li>
<li>Exit Loop If [ Get (LastError)  = 101 ]</li>
<li>Set Variable [ $sample; Value:$sample &amp; &para; &amp; 

Case ( learnSampleWebsite::URLPubDate = "" ; 
learnSampleWebsite::URL ; 
learnSampleWebsite::URL &amp; "  " &amp; Month ( learnSampleWebsite::URLPubDate ) &amp; "/" &amp; Day ( learnSampleWebsite::URLPubDate ) &amp; "/" &amp; Year ( learnSampleWebsite::URLPubDate ) ) ]</li>
<li>Go to Portal Row
[ Select; Next; Exit after last ]</li>
<li>End Loop</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $copy; Value://Sample Title and History
$sample &amp; &para; &amp; &para; &amp; $copy ]</li>
<li>#</li>
<li>#Now create copy text and display it.</li>
<li>Select Window [ Name: "Print/Copy"; Current file ]</li>
<li>Else</li>
<li>If [ $layoutName = "learn4EDIT" ]</li>
<li>Set Variable [ $sample; Value://author and copyright date
TEMP::DEFAULTNodePrimaryName &amp; " " &amp; Month ( Get ( CurrentDate ) ) &amp; "/" &amp; Day ( Get ( CurrentDate ) ) &amp; "/" &amp; Year ( Get ( CurrentDate ) )  &amp; " " ]</li>
<li>Else</li>
<li>Set Variable [ $sample; Value://Sample Title
"Unsaved group of records ordered by date and time of creation!!!  This action is not advised for publishing purposes.  Instead, use the theorize tag to create a saved set of records ordered by you to make the strongest case you can make for publishing sets of records." &amp; &para; &amp; 

//author and copyright date
TEMP::DEFAULTNodePrimaryName &amp; " " &amp; Month ( Get ( CurrentDate ) ) &amp; "/" &amp; Day ( Get ( CurrentDate ) ) &amp; "/" &amp; Year ( Get ( CurrentDate ) )  &amp; " " ]</li>
<li>End If</li>
<li>Go to Layout [ &ldquo;TEMP&rdquo; (TEMP) ]</li>
<li>Set Variable [ $sample; Value:$sample &amp; 

//health/copyright
defaultCopyrightName::tag ]</li>
<li>Go to Layout [ &ldquo;learnPreviewLayout&rdquo; (testlearn) ]</li>
<li>Set Variable [ $copy; Value://Sample Title and History
$sample &amp; &para; &amp; &para; &amp; $copy ]</li>
<li>End If</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Set Field [ TEMP::paste; TextSize ( $copy ; 12 ) ]</li>
<li>Go to Field [  ]</li>
<li>Scroll Window
[ Home ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>tagMenus</em>::notesOrHealth</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>testlearn</em>::kcsection</li>
<li>
<em>testlearn</em>::filterFind</li>
<li>
<em>testlearn</em>::date</li>
<li>
<em>testlearn</em>::timestamp</li>
<li>
<em>testlearn</em>::_Ltestlearn</li>
<li>
<em>refTestLearn</em>::_Ltestlearn</li>
<li>
<em>testlearn</em>::sampleCasePoint</li>
<li>
<em>testlearn</em>::kcitation</li>
<li>
<em>tagTLNodePrimary</em>::tag</li>
<li>
<em>testlearn</em>::NodeOthers</li>
<li>
<em>testlearn</em>::Caption</li>
<li>
<em>testlearn</em>::OtherKeyWords</li>
<li>
<em>testlearn</em>::kKeywordPrimary</li>
<li>
<em>tagTLKeywordPrimary</em>::tag</li>
<li>
<em>testlearn</em>::URL</li>
<li>
<em>testlearn</em>::URLPubDate</li>
<li>
<em>testlearn</em>::kcreference</li>
<li>
<em>refReference</em>::referenceForReferenceWindow</li>
<li>
<em>testlearn</em>::kcsample</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>learnSampleWebsite</em>::URLPubDate</li>
<li>
<em>TEMP</em>::DEFAULTNodePrimaryName</li>
<li>
<em>nodeLockTagMenus</em>::tag</li>
<li>
<em>sampleCopyright</em>::tag</li>
<li>
<em>learnSampleWebsite</em>::URL</li>
<li>
<em>defaultCopyrightName</em>::tag</li>
<li>
<em>TEMP</em>::paste</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>learnMenuSample</li>
<li>learnPreviewLayout</li>
<li>learn4EDIT</li>
<li>TEMP</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33239ScriptAnchor_"></a><td class="script_navbar"><a href="#33237ScriptAnchor_"><span>Previous Script: [sampleCopyForPasting]</span></a></td><td class="script_navbar"><a href="#33299ScriptAnchor_"><span>Parent Folder: [libraryNewOrUpdate]</span></a></td><td class="script_navbar"><a href="#32959ScriptAnchor_"><span>Next Script: [import]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">sampleCopyCopyText</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Copy [ TEMP::paste ]
[ Select ]</li>
<li>Go to Field [  ]</li>
<li>Scroll Window
[ Home ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::paste</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32959ScriptAnchor_"></a><td class="script_navbar"><a href="#33239ScriptAnchor_"><span>Previous Script: [sampleCopyCopyText]</span></a></td><td class="script_navbar"><a href="#33299ScriptAnchor_"><span>Parent Folder: [libraryNewOrUpdate]</span></a></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">import</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#create unique ID for closing import file</li>
<li>Go to Layout [ &ldquo;tempStart&rdquo; (TEMP) ]</li>
<li>New Record/Request</li>
<li>Set Field [ TEMP::import; "adflki3ina;lkfjie8;la;lkdvnma;ldieiasoerueoilanldf83984798374iwuhelfkjdlsidufioawkel" ]</li>
<li>Copy [ TEMP::import ]
[ Select ]</li>
<li>Set Field [ TEMP::import; "" ]</li>
<li>#open import file.  Its startup script will ID it for close</li>
<li>#and will copy its filepath for use in this script</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Open File [ &lt;unknown&gt; ]
[ Open hidden ]</li>
<li>If [ Get (LastError) = 1 ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>Go to Layout [ original layout ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>//  Close Window [ Name: "import" ]</li>
<li>#set file path for import</li>
<li>Paste [ TEMP::filePath ]
[ Select; No style ]</li>
<li>Set Variable [ $path; Value:TEMP::filePath ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>Go to Layout [ original layout ]</li>
<li>#</li>
<li>#import node</li>
<li>Show All Records</li>
<li>Import Records [ Source: &ldquo;$path&rdquo;; Method: Add; Character Set: &ldquo;Mac Roman&rdquo; ]
[ No dialog ]</li>
<li>#</li>
<li>#import item</li>
<li>Go to Layout [ &ldquo;tableTest&rdquo; (test) ]</li>
<li>Show All Records</li>
<li>Import Records [ Source: &ldquo;$path&rdquo;; Target: &ldquo;test&rdquo;; Method: Add; Character Set: &ldquo;Mac Roman&rdquo;; Field Mapping: Source field 1 import to test::_Ltest
Source field 2 import to test::ktestGroup
Source field 3 import to test::_number
Source field 4 import to test::kcfocusALL
Source field 5 import to test::testName
Source field 6 import to test::order
Source field 7 import to test::retire
Source field 9 import to test::kgtester
Source field 12 import to test::glocationNameGlobal
Source field 13 import to test::gcontactNameGlobal
Source field 14 import to test::kgaudienceLocation
Source field 15 import to test::gprogressGlobal
Source field 16 import to test::ksection
Source field 17 import to test::kgreportNumber
Source field 21 import to test::mtestGroup
Source field 22 import to test::ktestItemList
Source field 23 import to test::rule
Source field 24 import to test::kRecordCreatorNode
Source field 25 import to test::kRecordModifierNode
Source field 26 import to test::RecordModifyDate
Source field 27 import to test::testNameRevert ]
[ No dialog ]</li>
<li>#</li>
<li>#import evidence</li>
<li>Go to Layout [ &ldquo;reportTagDiscovery&rdquo; (testlearnReportTags) ]</li>
<li>Show All Records</li>
<li>Import Records [ Source: &ldquo;$path&rdquo;; Target: &ldquo;testlearnReportTags&rdquo;; Method: Add; Character Set: &ldquo;Mac Roman&rdquo;; Field Mapping: Source field 1 import to testlearnReportTags::_Ltestlearn
Source field 2 import to testlearnReportTags::ktestSubject
Source field 3 import to testlearnReportTags::_Number
Source field 5 import to testlearnReportTags::ktest
Source field 6 import to testlearnReportTags::Caption
Source field 7 import to testlearnReportTags::Picture
Source field 8 import to testlearnReportTags::Location
Source field 9 import to testlearnReportTags::inUse
Source field 10 import to testlearnReportTags::kaudienceLocation
Source field 11 import to testlearnReportTags::InspectionItemCount
Source field 12 import to testlearnReportTags::CheckboxCaption
Source field 13 import to testlearnReportTags::recordnumberglobal
Source field 14 import to testlearnReportTags::recordcountglobal
Source field 15 import to testlearnReportTags::InspectionItemCountLocation
Source field 16 import to testlearnReportTags::OK
Source field 17 import to testlearnReportTags::kcsection
Source field 18 import to testlearnReportTags::backupPhotoNumber
Source field 19 import to testlearnReportTags::TimeStart
Source field 20 import to testlearnReportTags::TimeStop
Source field 21 import to testlearnReportTags::TimeTotal
Source field 23 import to testlearnReportTags::kreportNumber
Source field 24 import to testlearnReportTags::timestamp
Source field 26 import to testlearnReportTags::orderDiscovery
Source field 27 import to testlearnReportTags::kcKeywordOther
Source field 28 import to testlearnReportTags::kNodeOther
Source field 29 import to testlearnReportTags::kHealth
Source field 30 import to testlearnReportTags::kNodePrimary
Source field 31 import to testlearnReportTags::kmedium
Source field 32 import to testlearnReportTags::kcitation
Source field 33 import to testlearnReportTags::kfileLocation
Source field 34 import to testlearnReportTags::kfolderPath
Source field 35 import to testlearnReportTags::kKeywordPrimary
Source field 36 import to testlearnReportTags::OtherKeyWords
Source field 37 import to testlearnReportTags::NodeOthers
Source field 38 import to testlearnReportTags::URL
Source field 39 import to testlearnReportTags::filename
Source field 40 import to testlearnReportTags::kcreference
Source field 42 import to testlearnReportTags::filterFind
Source field 43 import to testlearnReportTags::kRecordCreatorNode
Source field 44 import to testlearnReportTags::kRecordModifierNode
Source field 45 import to testlearnReportTags::RecordModifyDate
Source field 46 import to testlearnReportTags::incomplete
Source field 48 import to testlearnReportTags::copyrightYear
Source field 49 import to testlearnReportTags::URLPubDate
Source field 50 import to testlearnReportTags::kcsample
Source field 51 import to testlearnReportTags::gkaudienceLocation
Source field 52 import to testlearnReportTags::kctest
Source field 53 import to testlearnReportTags::orderTest
Source field 54 import to testlearnReportTags::title
Source field 55 import to testlearnReportTags::kctestItem
Source field 56 import to testlearnReportTags::organEmailRecipient
Source field 57 import to testlearnReportTags::korgan
Source field 58 import to testlearnReportTags::kcopyist
Source field 59 import to testlearnReportTags::emailDate
Source field 61 import to testlearnReportTags::sampleCasePoint ]
[ No dialog ]</li>
<li>#</li>
<li>#import locationdetail</li>
<li>Go to Layout [ &ldquo;tableTag&rdquo; (tagTable) ]</li>
<li>Show All Records</li>
<li>Import Records [ Source: &ldquo;$path&rdquo;; Target: &ldquo;tagTable&rdquo;; Method: Add; Character Set: &ldquo;Mac Roman&rdquo;; Field Mapping: Source field 1 import to tagTable::kGroupOrTest
Source field 2 import to tagTable::_Ltag
Source field 3 import to tagTable::tag
Source field 4 import to tagTable::orderOrLock
Source field 5 import to tagTable::ksection
Source field 6 import to tagTable::_Number
Source field 7 import to tagTable::match
Source field 8 import to tagTable::tagSpelling
Source field 9 import to tagTable::kcsection
Source field 10 import to tagTable::Kpicture1
Source field 11 import to tagTable::notesOrHealth
Source field 12 import to tagTable::Ktitle1
Source field 13 import to tagTable::kfile
Source field 15 import to tagTable::Kpicture2
Source field 17 import to tagTable::Kpicture3
Source field 19 import to tagTable::Ktitle2
Source field 20 import to tagTable::Ktitle3
Source field 24 import to tagTable::kRecordCreatorNode
Source field 25 import to tagTable::kRecordModifierNode ]
[ No dialog ]</li>
<li>#</li>
<li>#import text</li>
<li>Go to Layout [ &lt;unknown&gt; ]</li>
<li>Show All Records</li>
<li>Import Records [ Source: &ldquo;$path&rdquo;; Method: Add; Character Set: &ldquo;Mac Roman&rdquo; ]
[ No dialog ]</li>
<li>#</li>
<li>#import nodeLocation</li>
<li>Go to Layout [ &ldquo;tableTestSubjectFocus&rdquo; (tagTestSubjectLocation) ]</li>
<li>Show All Records</li>
<li>Import Records [ Source: &ldquo;$path&rdquo;; Target: &ldquo;tagTestSubjectLocation&rdquo;; Method: Add; Character Set: &ldquo;Mac Roman&rdquo;; Field Mapping: Source field 1 import to tagTestSubjectLocation::knode
Source field 2 import to tagTestSubjectLocation::kfocus
Source field 3 import to tagTestSubjectLocation::_LtestSubjectLocation
Source field 4 import to tagTestSubjectLocation::kfocusAttribute1
Source field 5 import to tagTestSubjectLocation::focusName
Source field 6 import to tagTestSubjectLocation::inUse
Source field 7 import to tagTestSubjectLocation::order
Source field 8 import to tagTestSubjectLocation::TimeStart
Source field 9 import to tagTestSubjectLocation::TimeTotal
Source field 10 import to tagTestSubjectLocation::_number
Source field 11 import to tagTestSubjectLocation::kfocusAttribute2
Source field 12 import to tagTestSubjectLocation::ksection
Source field 13 import to tagTestSubjectLocation::reportNumber
Source field 14 import to tagTestSubjectLocation::kRecordCreatorNode ]
[ No dialog ]</li>
<li>#</li>
<li>#import sectionkind</li>
<li>Go to Layout [ &ldquo;tableGroupTag&rdquo; (groupTest) ]</li>
<li>Show All Records</li>
<li>Import Records [ Source: &ldquo;$path&rdquo;; Target: &ldquo;groupTest&rdquo;; Method: Add; Character Set: &ldquo;Mac Roman&rdquo;; Field Mapping: Source field 1 import to groupTest::_Lgroup
Source field 2 import to groupTest::_Number
Source field 4 import to groupTest::match
Source field 5 import to groupTest::name
Source field 6 import to groupTest::ksection
Source field 7 import to groupTest::defaultSectionInfo
Source field 8 import to groupTest::testReportPicture
Source field 9 import to groupTest::CaptionORinuseCheck
Source field 10 import to groupTest::URLORHealth
Source field 11 import to groupTest::order
Source field 12 import to groupTest::nameSpelling
Source field 13 import to groupTest::kRecordCreatorNode
Source field 14 import to groupTest::kSectionCreatorNodesCreator
Source field 15 import to groupTest::aboutSection ]
[ No dialog ]</li>
<li>#</li>
<li>#import report</li>
<li>Go to Layout [ &ldquo;PrintReportEdit&rdquo; (report) ]</li>
<li>Show All Records</li>
<li>Import Records [ Source: &ldquo;$path&rdquo;; Target: &ldquo;report&rdquo;; Method: Add; Character Set: &ldquo;Mac Roman&rdquo;; Field Mapping: Source field 1 import to report::_Lreport
Source field 2 import to report::_Number
Source field 3 import to report::ktestSubject
Source field 4 import to report::_kfContactGeography
Source field 5 import to report::general_info
Source field 6 import to report::ktest
Source field 7 import to report::krecommendation
Source field 8 import to report::order
Source field 9 import to report::Picture
Source field 10 import to report::kthingRecommendationID
Source field 11 import to report::kgeneralSpecificItemRecommendationID
Source field 12 import to report::_kfPhoto
Source field 13 import to report::_kfContactGeography2
Source field 14 import to report::_kfContactGeography3
Source field 15 import to report::_kfContactGeography4
Source field 16 import to report::_kfContactGeography5
Source field 17 import to report::PictureCaption
Source field 18 import to report::textMain
Source field 19 import to report::textPhotoRow1
Source field 20 import to report::pagenumberItem
Source field 21 import to report::CurrentRecord
Source field 22 import to report::_kfPhoto2
Source field 23 import to report::_kfPhoto3
Source field 24 import to report::_kfPhoto4
Source field 25 import to report::pagenumberTheme
Source field 26 import to report::TOC
Source field 27 import to report::TOCnumbers
Source field 28 import to report::ReportCover
Source field 29 import to report::ReportPDFtitle
Source field 30 import to report::kreportNumber
Source field 31 import to report::ksection
Source field 32 import to report::kRecordCreatorNode
Source field 33 import to report::kRecordModifierNode
Source field 34 import to report::RecordModifyDate
Source field 35 import to report::khealth
Source field 36 import to report::textPhotoRow2 ]
[ No dialog ]</li>
<li>#</li>
<li>#go to main screen</li>
<li>Go to Layout [ &lt;unknown&gt; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::import</li>
<li>
<em>TEMP</em>::filePath</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>tempStart</li>
<li>tableTest</li>
<li>reportTagDiscovery</li>
<li>tableTag</li>
<li>&lt;Missing Layout&gt;</li>
<li>tableTestSubjectFocus</li>
<li>tableGroupTag</li>
<li>PrintReportEdit</li>
<li>&lt;Missing Layout&gt;</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul>
<li>&lt;Missing Table Occurrence&gt;</li>
<li><a href="#13631512TableAnchor_"><em>test</em></a></li>
<li><a href="#13631516TableAnchor_"><em>testlearnReportTags</em></a></li>
<li><a href="#13631627TableAnchor_"><em>tagTable</em></a></li>
<li>&lt;Missing Table Occurrence&gt;</li>
<li><a href="#13631611TableAnchor_"><em>tagTestSubjectLocation</em></a></li>
<li><a href="#13631659TableAnchor_"><em>groupTest</em></a></li>
<li><a href="#13631584TableAnchor_"><em>report</em></a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<p>
<span class="partheading"><a name="33301ScriptAnchor_"></a><a href="#33301ScriptAnchor_toc">changeLibraryOrLibraryName</a></span>
</p>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32935ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"><a href="#33301ScriptAnchor_"><span>Parent Folder: [changeLibraryOrLibraryName]</span></a></td><td class="script_navbar"><a href="#33178ScriptAnchor_"><span>Next Script: [switchLibrary]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">changeSectionName</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ $$stopChangeSectionName &ne; 1 ]</li>
<li>Commit Records/Requests</li>
<li>Set Variable [ $name; Value:ruleSection::name ]</li>
<li>New Window [  ]</li>
<li>Go to Layout [ &ldquo;tableGroupTag&rdquo; (groupTest) ]</li>
<li>#</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ groupTest::match; "section" ]</li>
<li>Set Field [ groupTest::name; "==" &amp; $name ]</li>
<li>Perform Find [  ]</li>
<li>Set Variable [ $count; Value:Get (FoundCount) ]</li>
<li>Close Window [ Current Window ]</li>
<li>If [ $count  &ne;  1 ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Each section must have a unique name."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Set Field [ ruleSection::name; $name &amp; " " &amp;  ruleSection::_Lgroup ]</li>
<li>Set Field [ ruleSection::nameSpelling; $name &amp; " " &amp;  ruleSection::_Lgroup ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Go to Field [  ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>ruleSection</em>::name</li>
<li>
<em>groupTest</em>::match</li>
<li>
<em>groupTest</em>::name</li>
<li>
<em>ruleSection</em>::_Lgroup</li>
<li>
<em>ruleSection</em>::nameSpelling</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>tableGroupTag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33178ScriptAnchor_"></a><td class="script_navbar"><a href="#32935ScriptAnchor_"><span>Previous Script: [changeSectionName]</span></a></td><td class="script_navbar"><a href="#33301ScriptAnchor_"><span>Parent Folder: [changeLibraryOrLibraryName]</span></a></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">switchLibrary</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If on mobile device, stop the script.</li>
<li>If [ Filter ( Get ( ApplicationVersion ) ; "go" ) = "go" ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If library selected is the one open then exit the script.</li>
<li>Set Variable [ $library; Value:tempSetup::filePathLibraryToSwitchTo ]</li>
<li>If [ $library = Get (FilePath) ]</li>
<li>Go to Field [  ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#If library path is blank (which should only happen if</li>
<li>#admin adds library manually with path), then delete</li>
<li>#this library name from the list.</li>
<li>If [ $library = "" ]</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>#</li>
<li>Go to Layout [ &ldquo;startMemorySwitch&rdquo; (MemorySwitch) ]</li>
<li>Show All Records</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $library = MemorySwitch::path ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>If [ $library = MemorySwitch::path ]</li>
<li>Set Variable [ $name; Value:MemorySwitch::name ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>End If</li>
<li>Go to Layout [ &ldquo;defaultSetup&rdquo; (tempSetup) ]</li>
<li>#</li>
<li>#Reset pulldown menu to select the current file's</li>
<li>#name record, so that it will show up as selected when</li>
<li>#the user clicks on the pulldown list again.</li>
<li>Go to Layout [ &ldquo;startMemorySwitch&rdquo; (MemorySwitch) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ MemorySwitch::name; tempSetup::fileName ]</li>
<li>Perform Find [  ]</li>
<li>Set Field [ TEMP::filePathLibraryToSwitchTo; MemorySwitch::path ]</li>
<li>Go to Layout [ &ldquo;defaultSetup&rdquo; (tempSetup) ]</li>
<li>Show Custom Dialog [ Message: $name &amp; " cannot be found.  It has been moved, deleted, or its name has been changed.  Its name has been removed from the switch libraries list.  Find and click on it to put it back on the list."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Open the selected library.</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; $library ; Substitute ( $library ; "file:/" ; "file://" ) ) ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>#</li>
<li>#If the path stored for the selected library failed to open</li>
<li>#the library, then that library is no longer there or its</li>
<li>#name has been changed, so delete it from the </li>
<li>#library list.</li>
<li>If [ Get (LastError) = 5 ]</li>
<li>#</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; $library ; Substitute ( $library ; "file:/" ; "file:///volumes/" ) ) ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>#</li>
<li>If [ Get (LastError) = 5 ]</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>#</li>
<li>Go to Layout [ &ldquo;startMemorySwitch&rdquo; (MemorySwitch) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ MemorySwitch::path; $library ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>If [ $library = MemorySwitch::path ]</li>
<li>Set Variable [ $libraryName; Value:MemorySwitch::name ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>End If</li>
<li>Go to Layout [ &ldquo;defaultSetup&rdquo; (tempSetup) ]</li>
<li>Show Custom Dialog [ Message: $libraryName &amp; " cannot be found.  It has been moved, deleted, or its name has been changed.  Its name has been removed from the switch libraries list.  Find and click on it to put it back on the list."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>#</li>
<li>#Reset pulldown menu to select the current file's</li>
<li>#name record, so that it will show up as selected when</li>
<li>#the user clicks on the pulldown list again.</li>
<li>Go to Layout [ &ldquo;startMemorySwitch&rdquo; (MemorySwitch) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ MemorySwitch::name; tempSetup::fileName ]</li>
<li>Perform Find [  ]</li>
<li>Set Field [ TEMP::filePathLibraryToSwitchTo; MemorySwitch::path ]</li>
<li>Go to Layout [ &ldquo;defaultSetup&rdquo; (tempSetup) ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Reset pulldown menu to select the current file's</li>
<li>#name record, so that it will show up as selected when</li>
<li>#the user clicks on the pulldown list again.</li>
<li>Go to Layout [ &ldquo;startMemorySwitch&rdquo; (MemorySwitch) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ MemorySwitch::name; tempSetup::fileName ]</li>
<li>Perform Find [  ]</li>
<li>Set Field [ TEMP::filePathLibraryToSwitchTo; MemorySwitch::path ]</li>
<li>Go to Layout [ &ldquo;defaultSetup&rdquo; (tempSetup) ]</li>
<li>Close Window [ Current Window ]</li>
<li>Close Window [ Name: "Tag Menus"; Current file ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tempSetup</em>::filePathLibraryToSwitchTo</li>
<li>
<em>MemorySwitch</em>::path</li>
<li>
<em>MemorySwitch</em>::name</li>
<li>
<em>tempSetup</em>::fileName</li>
<li>
<em>TEMP</em>::filePathLibraryToSwitchTo</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>startMemorySwitch</li>
<li>defaultSetup</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<p>
<span class="partheading"><a name="33305ScriptAnchor_"></a><a href="#33305ScriptAnchor_toc">sectionScripts</a></span>
</p>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32936ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"><a href="#33305ScriptAnchor_"><span>Parent Folder: [sectionScripts]</span></a></td><td class="script_navbar"><a href="#33154ScriptAnchor_"><span>Next Script: [newSectionOnSectionLayout]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">changeSectionGroupName</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#</li>
<li>If [ $$stopChangeName = 1 ]</li>
<li>Set Variable [ $$stopChangeName ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>Set Variable [ $$ID; Value:"ignore" ]</li>
<li>Set Variable [ $$IDrecord; Value:test::_Ltest ]</li>
<li>Set Variable [ $$stopTest; Value:1 ]</li>
<li>Commit Records/Requests</li>
<li>Set Variable [ $name; Value:groupTest::name ]</li>
<li>Set Field [ groupTest::name; $name ]</li>
<li>Set Variable [ $section; Value:groupTest::ksection ]</li>
<li>New Window [ Height: 1; Width: 1; Top: -1000; Left: -1000 ]</li>
<li>Go to Layout [ &ldquo;tableGroupTag&rdquo; (groupTest) ]</li>
<li>#</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ groupTest::match; "testGroup" ]</li>
<li>Set Field [ groupTest::name; "==" &amp; $name ]</li>
<li>Set Field [ groupTest::ksection; $section ]</li>
<li>Perform Find [  ]</li>
<li>Set Variable [ $count; Value:Get (FoundCount) ]</li>
<li>Close Window [ Current Window ]</li>
<li>Set Variable [ $$ID; Value:$$IDrecord ]</li>
<li>If [ $count  &ne;  1 ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Each section group must have a unique name."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Set Field [ groupTest::name; $name &amp; " " &amp; groupTest::_Lgroup ]</li>
<li>Set Field [ groupTest::nameSpelling; $name &amp; " " &amp; groupTest::_Lgroup ]</li>
<li>Go to Field [  ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Set Field [ groupTest::nameSpelling; $name ]</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $$stopTest ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>test</em>::_Ltest</li>
<li>
<em>groupTest</em>::name</li>
<li>
<em>groupTest</em>::ksection</li>
<li>
<em>groupTest</em>::match</li>
<li>
<em>groupTest</em>::_Lgroup</li>
<li>
<em>groupTest</em>::nameSpelling</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>tableGroupTag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33154ScriptAnchor_"></a><td class="script_navbar"><a href="#32936ScriptAnchor_"><span>Previous Script: [changeSectionGroupName]</span></a></td><td class="script_navbar"><a href="#33305ScriptAnchor_"><span>Parent Folder: [sectionScripts]</span></a></td><td class="script_navbar"><a href="#33155ScriptAnchor_"><span>Next Script: [deleteSection]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">newSectionOnSectionLayout</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33236ScriptAnchor_">createEmptyLibrary</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>If [ tempSetup::kdefaultNodePrimary = "" ]</li>
<li>#</li>
<li>#When running the create new library script, this script</li>
<li>#is the last script to be called.  The two steps disabled</li>
<li>#below used to halt the process and then I would </li>
<li>#manually have to go the backup layout and type in </li>
<li>#the word newLibrary to create the trigger for the start </li>
<li>#added below, the script now does that for me.</li>
<li>//  Show Custom Dialog [ Message: "Select yourself (the node responsible) from Tag Menus window."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>//  Halt Script</li>
<li>Go to Layout [ &ldquo;backup&rdquo; (backup) ]</li>
<li>Set Field [ backup::newLibrary; "newLibrary" ]</li>
<li>Show Custom Dialog [ Message: "This library is now ready for use.  It will close.  When users next open it they will be asked if they want to use it as a new empty library or import records from an old Library version into it."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Close Window [ Name: "Tag Menus"; Current file ]</li>
<li>Close Window [ Name: "Setup"; Current file ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Create new section record.</li>
<li>New Record/Request</li>
<li>Set Field [ ruleSection::ksection; ruleSection::_Lgroup ]</li>
<li>Set Field [ ruleSection::match; "section" ]</li>
<li>Set Field [ ruleSection::aboutSection; "This library is for noting what we learn about  _________________, collecting references to it, and testing or collecting samples of ___________________ to improve the quality of our thinking and doing or __________________ quality (if  _________________ is a thing not a person)." ]</li>
<li>Set Field [ ruleSection::kRecordCreatorNode; TEMP::kdefaultNodePrimary ]</li>
<li>#Capture the name in case the node is deleted, and</li>
<li>#and the section is not requiring the system to replace</li>
<li>#the current sections creator node, name and all.</li>
<li>Set Field [ ruleSection::CaptionORinuseCheck; TEMP::DEFAULTNodePrimaryName ]</li>
<li>#Capture the creator of the node that created the node</li>
<li>#that created this record.  Wow!  OK, why?  Because</li>
<li>#If we need to recreate this section's creator node</li>
<li>#we will need to know who created its creator node.</li>
<li>Set Field [ ruleSection::kSectionCreatorNodesCreator; nodeLockSection::kRecordCreatorNode ]</li>
<li>Set Field [ ruleSection::name; "Empty Library" ]</li>
<li>Set Field [ ruleSection::nameSpelling; "Empty Library" ]</li>
<li>Go to Field [ ruleSection::name ]</li>
<li>#</li>
<li>#Assign section as default section.</li>
<li>Perform Script [ &ldquo;setDefaultSection&rdquo; ]</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tempSetup</em>::kdefaultNodePrimary</li>
<li>
<em>backup</em>::newLibrary</li>
<li>
<em>ruleSection</em>::_Lgroup</li>
<li>
<em>ruleSection</em>::ksection</li>
<li>
<em>ruleSection</em>::match</li>
<li>
<em>ruleSection</em>::aboutSection</li>
<li>
<em>TEMP</em>::kdefaultNodePrimary</li>
<li>
<em>ruleSection</em>::kRecordCreatorNode</li>
<li>
<em>TEMP</em>::DEFAULTNodePrimaryName</li>
<li>
<em>ruleSection</em>::CaptionORinuseCheck</li>
<li>
<em>nodeLockSection</em>::kRecordCreatorNode</li>
<li>
<em>ruleSection</em>::kSectionCreatorNodesCreator</li>
<li>
<em>ruleSection</em>::name</li>
<li>
<em>ruleSection</em>::nameSpelling</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33201ScriptAnchor_">setDefaultSection</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>backup</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33155ScriptAnchor_"></a><td class="script_navbar"><a href="#33154ScriptAnchor_"><span>Previous Script: [newSectionOnSectionLayout]</span></a></td><td class="script_navbar"><a href="#33305ScriptAnchor_"><span>Parent Folder: [sectionScripts]</span></a></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">deleteSection</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>If [ nodeLockSection::orderOrLock &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "This record is currently locked.  Select the node that created it and enter the password to unlock it, then you will able to start the delete process."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Set variables to conditionally format section to</li>
<li>#be deleted, and its record number so if the</li>
<li>#user cancels the delete, the system can return</li>
<li>#to this record.</li>
<li>Set Variable [ $delete; Value:ruleSection::_Lgroup ]</li>
<li>Set Variable [ $recordNumber; Value:Get (RecordNumber) ]</li>
<li>Set Variable [ $$addTagToCitation; Value:1 ]</li>
<li>Set Variable [ $$stopTest; Value:1 ]</li>
<li>#</li>
<li>#Because there may be no records found, stop</li>
<li>#the system from informing the user of this.</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>#</li>
<li>#See if section has any learn records tagged</li>
<li>#with it, and if so set the learnInUse variable to 1.</li>
<li>Set Variable [ $$stopLoadCitation; Value:1 ]</li>
<li>Go to Layout [ &ldquo;learn1&rdquo; (testlearn) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kcsection; $delete ]</li>
<li>Set Field [ testlearn::filterFind; "main" &amp; &para; ]</li>
<li>Perform Find [  ]</li>
<li>If [ Get (LastError)  &ne; 401 ]</li>
<li>Set Variable [ $learnInUse; Value:1 ]</li>
<li>End If</li>
<li>#</li>
<li>#See if section has any reference records tagged</li>
<li>#with it, and if so set the refInUse variable to 1.</li>
<li>Go to Layout [ &ldquo;Reference&rdquo; (reference) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::kcsection; $delete ]</li>
<li>Perform Find [  ]</li>
<li>If [ Get (LastError)  &ne; 401 ]</li>
<li>Set Variable [ $referenceInUse; Value:1 ]</li>
<li>End If</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>#</li>
<li>#See if section has any tag records tagged</li>
<li>#with it, and if so set the refInUse variable to 1.</li>
<li>Go to Layout [ &ldquo;tableTag&rdquo; (tagTable) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ ruleLibrary 2::ksection; $delete ]</li>
<li>Perform Find [  ]</li>
<li>If [ Get (LastError)  &ne; 401 ]</li>
<li>Set Variable [ $TagInUse; Value:1 ]</li>
<li>End If</li>
<li>#</li>
<li>#See if tags in question are only node tags.</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: tagTable::match: &ldquo;node&rdquo; ]
[ Restore ]</li>
<li>If [ Get (FoundCount) = 0 ]</li>
<li>Set Variable [ $OnlyNodes; Value:1 ]</li>
<li>End If</li>
<li>#</li>
<li>#See if section has any test records tagged</li>
<li>#with it, and if so set the testInUse variable to 1.</li>
<li>Set Variable [ $$ID; Value:"ignore" ]</li>
<li>Go to Layout [ &ldquo;testSetup&rdquo; (test) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ test::ksection; $delete ]</li>
<li>Perform Find [  ]</li>
<li>If [ Get (LastError)  &ne; 401 ]</li>
<li>Set Variable [ $testInUse; Value:1 ]</li>
<li>End If</li>
<li>Set Variable [ $$ID ]</li>
<li>Set Variable [ $$stopTest ]</li>
<li>#</li>
<li>Perform Script [ &ldquo;defaultSectionMenu&rdquo; ]</li>
<li>Go to Record/Request/Page [ $recordNumber ]
[ No dialog ]</li>
<li>If [ $learnInUse = 1  or  $testInUse = 1  or  $referenceInUse = 1 or $TagInUse = 1 ]</li>
<li>Set Variable [ $delete ]</li>
<li>Set Variable [ $$addTagToCitation ]</li>
<li>Refresh Window</li>
<li>Show Custom Dialog [ Message: Case ( $tagInUse = 1 and $OnlyNodes = 1 and $referenceInUse + $learnInUse + $testInUse  = "" ; "Remove this section's node tags." ;

$tagInUse = 1 and $OnlyNodes &ne; 1 and $referenceInUse + $learnInUse + $testInUse  = "" ; "Navigate to all the tag sections in the learn and reference modules and delete their tags before deleting their section." ;

$tagInUse = 1 and $OnlyNodes = 1 and $referenceInUse + $learnInUse + $testInUse  = "" ; "Remove this section's node tags." ;

If ( $referenceInUse + $learnInUse + $testInUse &gt; 1 ; "The following modules contain records and/or tags for this section: " ; "The following module contains records and/or tags for this section: "  ) &amp; 

If ($testInUse = 1 ; "test" ; "" ) &amp; 

Case (
$learnInUse = 1  and $testInUse = 1; ", learn" ; 
$learnInUse = 1  and $testInUse &ne; 1; "learn" ; 
"" ) &amp; 

Case (
$referenceInUse = 1  and $learnInUse = 1; ", reference" ; 
$referenceInUse = 1  and $testInUse = 1; ", reference" ; 
$referenceInUse = 1  and $learnInUse &ne; 1  and $testInUse &ne; 1; " reference" ; 
"" ) &amp; 

If ( $referenceInUse + $learnInUse + $testInUse &gt; 1 ; ".  These records must be deleted before this section can be deleted." ; ".  These records must be deleted before this section can be deleted."  ) ); Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>Set Variable [ $$addTagToCitation ]</li>
<li>#</li>
<li>#If the section being deleted has no records</li>
<li>#then make sure the user really wants to delete it.</li>
<li>Show Custom Dialog [ Message: "Delete " &amp; ruleSection::name &amp; "?"; Buttons: &ldquo;cancel&rdquo;, &ldquo;delete&rdquo; ]</li>
<li>#</li>
<li>#If the user cancels, stop the delete.</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $delete ]</li>
<li>Refresh Window</li>
<li>Set Variable [ $$addTagToCitation ]</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>#If the user confirms, then  delete the section.</li>
<li>Else If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>If [ TEMP::ksection = $delete ]</li>
<li>Set Field [ TEMP::ksection; "" ]</li>
<li>Set Field [ TEMP::sectionName; "" ]</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>End If</li>
<li>Set Variable [ $$addTagToCitation ]</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>End If</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>nodeLockSection</em>::orderOrLock</li>
<li>
<em>ruleSection</em>::_Lgroup</li>
<li>
<em>testlearn</em>::kcsection</li>
<li>
<em>testlearn</em>::filterFind</li>
<li>
<em>reference</em>::kcsection</li>
<li>
<em>ruleLibrary 2</em>::ksection</li>
<li>
<em>tagTable</em>::match</li>
<li>
<em>test</em>::ksection</li>
<li>
<em>ruleSection</em>::name</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>TEMP</em>::sectionName</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33090ScriptAnchor_">defaultSectionMenu</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>learn1</li>
<li>Reference</li>
<li>tableTag</li>
<li>testSetup</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<p>
<span class="partheading"><a name="33303ScriptAnchor_"></a><a href="#33303ScriptAnchor_toc">testScreens</a></span>
</p>
<p>
<span class="partheading"><a name="33323ScriptAnchor_"></a><a href="#33323ScriptAnchor_toc">setup</a></span>
</p>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32845ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"><a href="#33323ScriptAnchor_"><span>Parent Folder: [setup]</span></a></td><td class="script_navbar"><a href="#32930ScriptAnchor_"><span>Next Script: [loadSetupTestRecord]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">gotoSetupTest</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Capture record ID so system can return user </li>
<li>#after editing is complete.</li>
<li>Set Variable [ $$recordNumber; Value:Get (RecordNumber) ]</li>
<li>#</li>
<li>#Capture test and test item IDs so system can</li>
<li>#reset them.  During edit user may go to a</li>
<li>#different test record, thus changing these temp IDs.</li>
<li>Set Variable [ $$itemID; Value:TEMP::ktest ]</li>
<li>Set Variable [ $$detailID; Value:TEMP::ktestItemList ]</li>
<li>#</li>
<li>#Capture layoutname so system can return user </li>
<li>#after editing is complete.</li>
<li>Set Variable [ $$module; Value:Get (LayoutName) ]</li>
<li>#</li>
<li>#Go to detail tag menu so load item record script </li>
<li>#below will work properly.</li>
<li>Go to Layout [ &ldquo;setupTestItem&rdquo; (tagMenus) ]</li>
<li>#</li>
<li>#Set the citation match variable to detail as that</li>
<li>#is the layout the system goes to and that variable</li>
<li>#is needed by the add script if the user should</li>
<li>#click on the add button.</li>
<li>Set Variable [ $$citationMatch; Value:"testItem" ]</li>
<li>#</li>
<li>#Capture record ID so system can return user </li>
<li>#after editing is complete.</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Test"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Report"; Current file ]</li>
<li>End If</li>
<li>End If</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Variable [ $$LearnEdit; Value:testlearn::_Ltestlearn ]</li>
<li>End If</li>
<li>#</li>
<li>#Take user to test setup layout and find all </li>
<li>#test items. If coming from Library Setup window.</li>
<li>Set Variable [ $$ID; Value:"ignore" ]</li>
<li>Go to Layout [ &ldquo;testSetup&rdquo; (test) ]</li>
<li>Sort Records [ Specified Sort Order: groupTest::order; based on value list: &ldquo;order&rdquo;
groupTest::name; ascending
test::order; based on value list: &ldquo;order&rdquo;
test::testName; ascending ]
[ Restore; No dialog ]</li>
<li>Set Window Title [ Current Window; New Title: "Setup" ]</li>
<li>If [ $$module &ne; "testMenuTestItem"  // and  $$module  &ne;  "reportTagItem" ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ test::ksection; TEMP::ksection ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#If not test exist, then make sure Tag Menus</li>
<li>#also shows no items.</li>
<li>If [ Get (LastError) = 401 ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Perform Find [ Specified Find Requests: Find Records; Criteria: tagMenus::_Ltag: &ldquo;"findNOrecords"&rdquo; ]
[ Restore ]</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Sort Records [ Specified Sort Order: groupTest::order; based on value list: &ldquo;order&rdquo;
groupTest::name; ascending
test::order; based on value list: &ldquo;order&rdquo;
test::testName; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#Take user to item user clicked on to edit.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ TEMP::ktest = test::_Ltest ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>If [ TEMP::ktest &ne; test::_Ltest ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>End If</li>
<li>#</li>
<li>#Conditionally format item and its tags.</li>
<li>Set Variable [ $$ID ]</li>
<li>Perform Script [ &ldquo;loadSetupTestRecord&rdquo; ]</li>
<li>Scroll Window
[ Home ]</li>
<li>End If</li>
<li>#</li>
<li>#If coming from the test or report module show</li>
<li>#user the Tag Menus window as they probably</li>
<li>#want to add a new tag.</li>
<li>If [ $$module  =  "testMenuTestItem" or $$module  =  "reportTagItem" ]</li>
<li>//  If [ $$module  =  "reportTagItem" ]</li>
<li>Set Variable [ $$ID; Value:"ignore" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$item = test::_Ltest ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Set Variable [ $$ID ]</li>
<li>Perform Script [ &ldquo;loadSetupTestRecord&rdquo; ]</li>
<li>//  End If</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Go to Record/Request/Page [ $$recordNumber ]
[ No dialog ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::ktest</li>
<li>
<em>TEMP</em>::ktestItemList</li>
<li>
<em>testlearn</em>::_Ltestlearn</li>
<li>
<em>groupTest</em>::order</li>
<li>
<em>groupTest</em>::name</li>
<li>
<em>test</em>::order</li>
<li>
<em>test</em>::testName</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>test</em>::ksection</li>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>test</em>::_Ltest</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32930ScriptAnchor_">loadSetupTestRecord</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>setupTestItem</li>
<li>testSetup</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32930ScriptAnchor_"></a><td class="script_navbar"><a href="#32845ScriptAnchor_"><span>Previous Script: [gotoSetupTest]</span></a></td><td class="script_navbar"><a href="#33323ScriptAnchor_"><span>Parent Folder: [setup]</span></a></td><td class="script_navbar"><a href="#32925ScriptAnchor_"><span>Next Script: [newTestGroup]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">loadSetupTestRecord</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32845ScriptAnchor_">gotoSetupTest</a></li>
<li><a href="#32927ScriptAnchor_">deleteTest</a></li>
<li><a href="#32949ScriptAnchor_">pagePulldown</a></li>
<li><a href="#32848ScriptAnchor_">nextPage</a></li>
<li><a href="#32849ScriptAnchor_">previousPage</a></li>
<li><a href="#33227ScriptAnchor_">insureEqualityOfSpellFields</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Stop script if needed to speed up other scripts.</li>
<li>If [ $$ID = test::_Ltest

 or 

$$ID = "ignore" ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Set all variables needed for performing various</li>
<li>#scripts while in test setup mode.</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $$ID; Value:test::_Ltest ]</li>
<li>#</li>
<li>#The test item list temp fields allow users to switch</li>
<li>#from their current list to another list.</li>
<li>Set Field [ TEMP::ktestItemList; test::ktestItemList ]</li>
<li>Set Field [ TEMP::ktestItemListOLD; test::ktestItemList ]</li>
<li>#</li>
<li>Set Field [ TEMP::ktest; test::_Ltest ]</li>
<li>Set Field [ TEMP::mTag; TEMP::ktest ]</li>
<li>#</li>
<li>#Used on Tag Menus window item layout for switch.</li>
<li>Set Field [ TEMP::testName; test::testName ]</li>
<li>Set Variable [ $$focuses; Value:test::kcfocusALL ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#Get the name of the test for the test item list</li>
<li>#name temp field.</li>
<li>#</li>
<li>#The reason for this whole section of the script</li>
<li>#(getting a test name) is that there is no relationship</li>
<li>#that can be made that would match the key of</li>
<li>#of the named test to this test and thus unlock</li>
<li>#and so allow the layout to show this test's name.</li>
<li>#This is because the key to unlock the display of</li>
<li>#a test's name is in a keychain field where many</li>
<li>#keys may exist in a list.  Filemaker cannot match</li>
<li>#a lock in one table to list of keys in another table.</li>
<li>#There must be only one key in a field in order</li>
<li>#for Filemaker to know which key to use in a lock.</li>
<li>#The database does not have the intellegence or</li>
<li>#programming to search through a list of keys</li>
<li>#to make a match to a lock field in another table.</li>
<li>#Thus, in order to display the name of the test in use</li>
<li>#we must have the system put that name in a temp</li>
<li>#field with global storage, which then allows it</li>
<li>#to be displayed on any layout where that temp</li>
<li>#field is displayed.  No relationship between the</li>
<li>#the temp table and the layout's table is required</li>
<li>#as long as the temp field is a global field, meaning</li>
<li>#all data in the field is the same for every record</li>
<li>#in the temp table.</li>
<li>#</li>
<li>#If the test list belongs (has the key that fits the</li>
<li>#test's lock) the set the temp field with this test's name.</li>
<li>If [ test::_Ltest = test::ktestItemList ]</li>
<li>#</li>
<li>#Set a temp field with this test's name.  This name</li>
<li>#field will then be used to show this test's name on</li>
<li>#the Tag Menus layout for setupTestItems.</li>
<li>Set Field [ TEMP::ktestListtTestName; test::testName ]</li>
<li>#</li>
<li>#If the test list does not belong to this test</li>
<li>#(has the key that fits A DIFFERENT test's lock) </li>
<li>#then set the temp field with this other test's name.</li>
<li>Else If [ test::_Ltest &ne; test::ktestItemList ]</li>
<li>#</li>
<li>#Get the ID of the current record so it can be</li>
<li>#looped back to.</li>
<li>Set Variable [ $currentTest; Value:test::_Ltest ]</li>
<li>#</li>
<li>#Turn of the record load triggered script to speed</li>
<li>#up this loop search.</li>
<li>Set Variable [ $$ID; Value:"ignore" ]</li>
<li>#</li>
<li>#Go to the first record and then test it and every</li>
<li>#other record until the test in question is found.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ test::_Ltest = TEMP::ktestItemList ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Set a temp field with this test's name.  This name</li>
<li>#field will then be used to show this test's name on</li>
<li>#the Tag Menus layout for setupTestItems.</li>
<li>Set Field [ TEMP::ktestListtTestName; test::testName ]</li>
<li>#</li>
<li>#Update key used for the move pulldown.</li>
<li>Set Field [ TEMP::mTag; TEMP::ktestItemList ]</li>
<li>#</li>
<li>#go back to current test.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ test::_Ltest = $currentTest ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Set Variable [ $$ID; Value:$currentTest ]</li>
<li>Refresh Window</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>If [ Get (LastError)  = 112 ]</li>
<li>New Window [ Name: "Tag Menus"; Height: Get (ScreenHeight); Width: Get (ScreenWidth) / 2; Left: Get (ScreenWidth) / 2 ]</li>
<li>Go to Layout [ &ldquo;setupTestFocus&rdquo; (tagLocation) ]</li>
<li>End If</li>
<li>#</li>
<li>#Find test items for test if user is currently looking</li>
<li>#at test items on the Tag Menus window.</li>
<li>If [ Get (LayoutName) = "setupTestItem" ]</li>
<li>Go to Layout [ &ldquo;setupTestItem&rdquo; (tagMenus) ]</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ ruleTagMenuTestGroups::match; TEMP::ktestItemList &amp; &para; ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuTestGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuTestGroups::name; ascending
ruleTagMenuTestGroups::_Lgroup; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>End If</li>
<li>#</li>
<li>#Refresh window in case user was on focus layout.</li>
<li>Refresh Window</li>
<li>#</li>
<li>#Return to setup window and refresh it to highlight</li>
<li>#current record.</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>Refresh Window</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>test</em>::_Ltest</li>
<li>
<em>test</em>::ktestItemList</li>
<li>
<em>TEMP</em>::ktestItemList</li>
<li>
<em>TEMP</em>::ktestItemListOLD</li>
<li>
<em>TEMP</em>::ktest</li>
<li>
<em>TEMP</em>::mTag</li>
<li>
<em>test</em>::testName</li>
<li>
<em>TEMP</em>::testName</li>
<li>
<em>test</em>::kcfocusALL</li>
<li>
<em>TEMP</em>::ktestListtTestName</li>
<li>
<em>ruleTagMenuTestGroups</em>::match</li>
<li>
<em>ruleTagMenuTestGroups</em>::order</li>
<li>
<em>ruleTagMenuTestGroups</em>::name</li>
<li>
<em>ruleTagMenuTestGroups</em>::_Lgroup</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>tagMenus</em>::tag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>setupTestFocus</li>
<li>setupTestItem</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32925ScriptAnchor_"></a><td class="script_navbar"><a href="#32930ScriptAnchor_"><span>Previous Script: [loadSetupTestRecord]</span></a></td><td class="script_navbar"><a href="#33323ScriptAnchor_"><span>Parent Folder: [setup]</span></a></td><td class="script_navbar"><a href="#32926ScriptAnchor_"><span>Next Script: [newTest]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">newTestGroup</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32926ScriptAnchor_">newTest</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If node is currenlty locked then stop script, inform user.</li>
<li>If [ TEMP::nodeLock &ne; "" ]</li>
<li>Go to Field [  ]</li>
<li>Show Custom Dialog [ Message: "The default record creation node -- " &amp; TEMP::DEFAULTNodePrimaryName &amp; " -- is locked.  Select this node in the setuptag window and enter the password to unlock it so that you can create new records attributed to it."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Stop spell check script.</li>
<li>Set Variable [ $$stopTest; Value:1 ]</li>
<li>#</li>
<li>#Create new test group.</li>
<li>Go to Layout [ &ldquo;tableGroupTag&rdquo; (groupTest) ]</li>
<li>New Record/Request</li>
<li>Set Field [ groupTest::ksection; TEMP::ksection ]</li>
<li>Set Field [ groupTest::match; "testGroup" ]</li>
<li>Set Field [ groupTest::kRecordCreatorNode; TEMP::kdefaultNodePrimary ]</li>
<li>#</li>
<li>#Each test group must have a unique name and </li>
<li>#the nameSpelling field is used when the user</li>
<li>#changes the name to a name already in use at</li>
<li>#which point the nameSpelling name can revert</li>
<li>#the user back to the former name (as the name</li>
<li>#field contains the duplicate name which is not</li>
<li>#allowed).</li>
<li>Set Field [ groupTest::name; "test group "  &amp; groupTest::_Lgroup ]</li>
<li>Set Field [ groupTest::nameSpelling; "test group "  &amp; groupTest::_Lgroup ]</li>
<li>Set Variable [ $group; Value:groupTest::_Lgroup ]</li>
<li>#</li>
<li>#Create new test for this group.</li>
<li>Set Variable [ $$ID; Value:"ignore" ]</li>
<li>Go to Layout [ &ldquo;testSetup&rdquo; (test) ]</li>
<li>New Record/Request</li>
<li>Set Variable [ $loopToNewRecord; Value:test::_Ltest ]</li>
<li>Set Field [ test::ksection; TEMP::ksection ]</li>
<li>#( a test group field is neccessary because a section</li>
<li>#  may have more than one test group, and so trying</li>
<li>#  to find a test group using the section key and</li>
<li>#  the testGroup match field would find all groups</li>
<li>#  when we need the system to find one group. )</li>
<li>Set Field [ test::ktestGroup; $group ]</li>
<li>#</li>
<li>#A new test-item list is created with each new test.</li>
<li>#This key field can be changed so that the test-item</li>
<li>#list for another test can be used.  </li>
<li>Set Field [ test::ktestItemList; test::_Ltest ]</li>
<li>#</li>
<li>#Tests do not need unique names.  Unlike other</li>
<li>#names, the names of tests if named the same</li>
<li>#will not confuse the system.  I don't think it will</li>
<li>#confuse the user either, but I am including steps to</li>
<li>#require a unique name so when locked name can</li>
<li>#be revereted back to orignal name.</li>
<li>Set Field [ test::testName; "test" ]</li>
<li>Set Field [ test::testNameRevert; "test" ]</li>
<li>Set Field [ test::kRecordCreatorNode; TEMP::kdefaultNodePrimary ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#Set temp variables for next part of script.</li>
<li>#</li>
<li>#The test item list temp fields allow users to switch</li>
<li>#from their current list to another list.</li>
<li>Set Field [ TEMP::ktestItemList; test::ktestItemList ]</li>
<li>Set Field [ TEMP::ktestItemListOLD; test::ktestItemList ]</li>
<li>#</li>
<li>#Used on tag menus to unlock buttons and link</li>
<li>#new records to test.</li>
<li>Set Field [ TEMP::ktest; test::_Ltest ]</li>
<li>#</li>
<li>#Used on Tag Menus window item layout for switch.</li>
<li>Set Field [ TEMP::testName; test::testName ]</li>
<li>#</li>
<li>#Used on Tag Menus window focus layout for conditional</li>
<li>#formatting.</li>
<li>Set Variable [ $$focuses; Value:test::kcfocusALL ]</li>
<li>#</li>
<li>#</li>
<li>#Go to the tag menus window.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>If [ Get (LastError)  = 112 ]</li>
<li>New Window [ Name: "Tag Menus"; Height: Get (ScreenHeight); Width: Get (ScreenWidth) / 2; Left: Get (ScreenWidth) / 2 ]</li>
<li>Go to Layout [ &ldquo;setupTestFocus&rdquo; (tagLocation) ]</li>
<li>End If</li>
<li>#</li>
<li>#Remember layout user is currently seeing in</li>
<li>#the tag menu window, so user can be returned</li>
<li>#to it at the end of the script.</li>
<li>Set Variable [ $layout; Value:Get (LayoutName) ]</li>
<li>#</li>
<li>#Assign focus to test item as each test must have</li>
<li>#at least one focus.</li>
<li>Perform Script [ &ldquo;editSectionFocuses&rdquo; ]</li>
<li>If [ Get (FoundCount) = 0 ]</li>
<li>Go to Layout [ &ldquo;setupTestFocus&rdquo; (tagLocation) ]</li>
<li>New Record/Request</li>
<li>Set Field [ tagLocation::ksection; TEMP::ksection ]</li>
<li>Set Field [ tagLocation::match; "focus" ]</li>
<li>Set Field [ tagLocation::tag; "test focus" ]</li>
<li>Perform Script [ &ldquo;editSectionFocuses&rdquo; ]</li>
<li>End If</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Perform Script [ &ldquo;linkTestFocusOrUnlinkTestFocus&rdquo; ]</li>
<li>#</li>
<li>//  #Create test item as each test must have at least</li>
<li>//  #one test item.</li>
<li>//  Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>//  Perform Script [ &ldquo;menuTestItem&rdquo; ]</li>
<li>//  Perform Script [ &ldquo;newTestItemGroup&rdquo; ]</li>
<li>//  Set Field [ tagMenus::tag; "test item" ]</li>
<li>//  Go to Field [  ]</li>
<li>#</li>
<li>#Go to selected tag menu window layout.</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Go to Layout [ $layout ]</li>
<li>#</li>
<li>#Set variables for new record.</li>
<li>Select Window [ Name: "setup"; Current file ]</li>
<li>Set Variable [ $$ID; Value:test::_Ltest ]</li>
<li>#</li>
<li>#Sort records.</li>
<li>Sort Records [ Specified Sort Order: ruleSection::name; ascending
groupTest::order; based on value list: &ldquo;order&rdquo;
groupTest::name; ascending
test::order; based on value list: &ldquo;order&rdquo;
test::testName; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Field [ test::testName ]
[ Select/perform ]</li>
<li>#</li>
<li>#Start spell check script.</li>
<li>Set Variable [ $$stopTest ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::nodeLock</li>
<li>
<em>TEMP</em>::DEFAULTNodePrimaryName</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>groupTest</em>::ksection</li>
<li>
<em>groupTest</em>::match</li>
<li>
<em>TEMP</em>::kdefaultNodePrimary</li>
<li>
<em>groupTest</em>::kRecordCreatorNode</li>
<li>
<em>groupTest</em>::_Lgroup</li>
<li>
<em>groupTest</em>::name</li>
<li>
<em>groupTest</em>::nameSpelling</li>
<li>
<em>test</em>::_Ltest</li>
<li>
<em>test</em>::ksection</li>
<li>
<em>test</em>::ktestGroup</li>
<li>
<em>test</em>::ktestItemList</li>
<li>
<em>test</em>::testName</li>
<li>
<em>test</em>::testNameRevert</li>
<li>
<em>test</em>::kRecordCreatorNode</li>
<li>
<em>TEMP</em>::ktestItemList</li>
<li>
<em>TEMP</em>::ktestItemListOLD</li>
<li>
<em>TEMP</em>::ktest</li>
<li>
<em>TEMP</em>::testName</li>
<li>
<em>test</em>::kcfocusALL</li>
<li>
<em>tagLocation</em>::ksection</li>
<li>
<em>tagLocation</em>::match</li>
<li>
<em>tagLocation</em>::tag</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>ruleSection</em>::name</li>
<li>
<em>groupTest</em>::order</li>
<li>
<em>test</em>::order</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32920ScriptAnchor_">editSectionFocuses</a></li>
<li><a href="#32906ScriptAnchor_">linkTestFocusOrUnlinkTestFocus</a></li>
<li><a href="#33071ScriptAnchor_">menuTestItem</a></li>
<li><a href="#33073ScriptAnchor_">newTestItemGroup</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>tableGroupTag</li>
<li>testSetup</li>
<li>setupTestFocus</li>
<li>&lt;Missing Layout&gt;</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32926ScriptAnchor_"></a><td class="script_navbar"><a href="#32925ScriptAnchor_"><span>Previous Script: [newTestGroup]</span></a></td><td class="script_navbar"><a href="#33323ScriptAnchor_"><span>Parent Folder: [setup]</span></a></td><td class="script_navbar"><a href="#32927ScriptAnchor_"><span>Next Script: [deleteTest]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">newTest</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If node is currenlty locked then stop script, inform user.</li>
<li>If [ TEMP::nodeLock &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "The default record creation node -- " &amp; TEMP::DEFAULTNodePrimaryName &amp; " -- is locked.  Select this node in the setuptag window and enter the password to unlock it so that you can create new records attributed to it."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Stop spell check script.</li>
<li>Set Variable [ $$stopTest; Value:1 ]</li>
<li>#</li>
<li>#If there are no tests, then create a new test</li>
<li>#group first and then a test for that group. </li>
<li>#All tests belong to a test groups.</li>
<li>If [ Get (FoundCount) = 0 ]</li>
<li>Perform Script [ &ldquo;newTestGroup&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Set variables needed to create new item.</li>
<li>Set Variable [ $$ID; Value:"ignore" ]</li>
<li>Set Variable [ $group; Value:test::ktestGroup ]</li>
<li>#</li>
<li>#new test</li>
<li>New Record/Request</li>
<li>Set Field [ test::ksection; TEMP::ksection ]</li>
<li>#( a test group field is neccessary because a section</li>
<li>#  may have more than one test group, and so trying</li>
<li>#  to find a test group using the section key and</li>
<li>#  the testGroup match field would find all groups</li>
<li>#  when we need the system to find one group. )</li>
<li>Set Field [ test::ktestGroup; $group ]</li>
<li>#</li>
<li>#A new test-item list is created with each new test.</li>
<li>#This key field can be changed so that the test-item</li>
<li>#list for another test can be used.  </li>
<li>Set Field [ test::ktestItemList; test::_Ltest ]</li>
<li>#</li>
<li>#Tests do not need unique names.  Unlike other</li>
<li>#names, the names of tests if named the same</li>
<li>#will not confuse the system.  I don't think it will</li>
<li>#confuse the user either, but I am including steps to</li>
<li>#require a unique name so when locked name can</li>
<li>#be revereted back to orignal name.</li>
<li>Set Field [ test::testName; "test" ]</li>
<li>Set Field [ test::testNameRevert; "test" ]</li>
<li>Set Field [ test::kRecordCreatorNode; TEMP::kdefaultNodePrimary ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#Set temp variables for next part of script.</li>
<li>#</li>
<li>#The test item list temp fields allow users to switch</li>
<li>#from their current list to another list.</li>
<li>Set Field [ TEMP::ktestItemList; test::ktestItemList ]</li>
<li>Set Field [ TEMP::ktestItemListOLD; test::ktestItemList ]</li>
<li>#</li>
<li>#Used on tag menus to unlock buttons and link</li>
<li>#new records to test.</li>
<li>Set Field [ TEMP::ktest; test::_Ltest ]</li>
<li>#</li>
<li>#Used on Tag Menus window item layout for switch.</li>
<li>Set Field [ TEMP::testName; test::testName ]</li>
<li>#</li>
<li>#Used on Tag Menus window focus layout for conditional</li>
<li>#formatting.</li>
<li>Set Variable [ $$focuses; Value:test::kcfocusALL ]</li>
<li>#</li>
<li>#</li>
<li>#Go to the tag menus window.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>If [ Get (LastError)  = 112 ]</li>
<li>New Window [ Name: "Tag Menus"; Height: Get (ScreenHeight); Width: Get (ScreenWidth) / 2; Left: Get (ScreenWidth) / 2 ]</li>
<li>Go to Layout [ &ldquo;setupTestFocus&rdquo; (tagLocation) ]</li>
<li>End If</li>
<li>#</li>
<li>#Remember layout user is currently seeing in</li>
<li>#the tag menu window, so user can be returned</li>
<li>#to it at the end of the script.</li>
<li>Set Variable [ $layout; Value:Get (LayoutName) ]</li>
<li>#</li>
<li>#Assign focus to test item as each test must have</li>
<li>#at least one focus.</li>
<li>Perform Script [ &ldquo;editSectionFocuses&rdquo; ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Perform Script [ &ldquo;linkTestFocusOrUnlinkTestFocus&rdquo; ]</li>
<li>#</li>
<li>//  #Create test item as each test must have at least</li>
<li>//  #one test item.</li>
<li>//  Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>//  Perform Script [ &ldquo;menuTestItem&rdquo; ]</li>
<li>//  Perform Script [ &ldquo;newTestItemGroup&rdquo; ]</li>
<li>//  Set Field [ tagMenus::tag; "test item" ]</li>
<li>//  Go to Field [  ]</li>
<li>#</li>
<li>#Go to selected tag menu window layout.</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Go to Layout [ $layout ]</li>
<li>#</li>
<li>#Set variables for new record.</li>
<li>Select Window [ Name: "setup"; Current file ]</li>
<li>Set Variable [ $$ID; Value:test::_Ltest ]</li>
<li>#</li>
<li>#Sort records.</li>
<li>Sort Records [ Specified Sort Order: ruleSection::name; ascending
groupTest::order; based on value list: &ldquo;order&rdquo;
groupTest::name; ascending
test::order; based on value list: &ldquo;order&rdquo;
test::testName; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Field [ test::testName ]
[ Select/perform ]</li>
<li>#</li>
<li>#Start spell check script.</li>
<li>Set Variable [ $$stopTest ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::nodeLock</li>
<li>
<em>TEMP</em>::DEFAULTNodePrimaryName</li>
<li>
<em>test</em>::ktestGroup</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>test</em>::ksection</li>
<li>
<em>test</em>::_Ltest</li>
<li>
<em>test</em>::ktestItemList</li>
<li>
<em>test</em>::testName</li>
<li>
<em>test</em>::testNameRevert</li>
<li>
<em>TEMP</em>::kdefaultNodePrimary</li>
<li>
<em>test</em>::kRecordCreatorNode</li>
<li>
<em>TEMP</em>::ktestItemList</li>
<li>
<em>TEMP</em>::ktestItemListOLD</li>
<li>
<em>TEMP</em>::ktest</li>
<li>
<em>TEMP</em>::testName</li>
<li>
<em>test</em>::kcfocusALL</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>ruleSection</em>::name</li>
<li>
<em>groupTest</em>::order</li>
<li>
<em>groupTest</em>::name</li>
<li>
<em>test</em>::order</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32925ScriptAnchor_">newTestGroup</a></li>
<li><a href="#32920ScriptAnchor_">editSectionFocuses</a></li>
<li><a href="#32906ScriptAnchor_">linkTestFocusOrUnlinkTestFocus</a></li>
<li><a href="#33071ScriptAnchor_">menuTestItem</a></li>
<li><a href="#33073ScriptAnchor_">newTestItemGroup</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>setupTestFocus</li>
<li>&lt;Missing Layout&gt;</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32927ScriptAnchor_"></a><td class="script_navbar"><a href="#32926ScriptAnchor_"><span>Previous Script: [newTest]</span></a></td><td class="script_navbar"><a href="#33323ScriptAnchor_"><span>Parent Folder: [setup]</span></a></td><td class="script_navbar"><a href="#32820ScriptAnchor_"><span>Next Script: [deleteTestItem]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">deleteTest</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>If [ nodeLockTest::orderOrLock &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "This record is locked.  Go the node that created it -- " &amp; nodeLockTest::tag &amp; " -- in the setup tag window and enter the password to unlock it so that you can delete it."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Set variables to conditionally format record to</li>
<li>#to be deleted and to supply name for warning</li>
<li>#messages, and to speed up script.</li>
<li>Set Variable [ $delete; Value:test::_Ltest ]</li>
<li>Set Variable [ $$tagTest; Value:test::_Ltest ]</li>
<li>Set Variable [ $$ID; Value:"ignore" ]</li>
<li>If [ test::testName = "" ]</li>
<li>Set Field [ test::testName; test::_Ltest ]</li>
<li>End If</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Check if item is in use as test tag on any Report</li>
<li>#records, and if so stop the script.</li>
<li>#</li>
<li>New Window [ Name: "Report: Discovery Records"; Height: 4; Width: 4 ]</li>
<li>#</li>
<li>Go to Layout [ &ldquo;reportTagDiscovery&rdquo; (testlearnReportTags) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearnReportTags::ktest; $delete ]</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#If records are found using test, then stop script.</li>
<li>If [ Get (FoundCount)  &ne; 0 ]</li>
<li>Move/Resize Window [ Current Window; Height: Get ( ScreenHeight ); Width: 333; Top: 0 ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Discoveries where made for this test (shown).  Delete all these discovery records and then this test  can be deleted."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>#</li>
<li>Close Window [ Current Window ]</li>
<li>Set Variable [ $$ID; Value:test::_Ltest ]</li>
<li>#</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Check if item is in use as test tag on any Learn</li>
<li>#records, and if so stop the script.</li>
<li>Set Variable [ $$stopLoadCitation; Value:1 ]</li>
<li>Go to Layout [ &ldquo;learn1&rdquo; (testlearn) ]</li>
<li>#</li>
<li>Set Window Title [ Current Window; New Title: "Learn" ]</li>
<li>#</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection ]</li>
<li>Set Field [ testlearn::filterFind; "main" ]</li>
<li>Set Field [ testlearn::kctest; "###" &amp; $$tagTest ]</li>
<li>Perform Find [  ]</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>#</li>
<li>#If records are found using test, then stop script.</li>
<li>If [ Get (FoundCount)  &ne; 0 ]</li>
<li>Move/Resize Window [ Current Window; Height: Get ( ScreenHeight ); Width: 333; Top: 0 ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "This test is linked to at least one Learn record.  You can delete this test after removing these links (created in the Learn module)."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>#</li>
<li>Close Window [ Current Window ]</li>
<li>Set Variable [ $$ID; Value:test::_Ltest ]</li>
<li>#</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>Close Window [ Current Window ]</li>
<li>#</li>
<li>#If no records were found using this test, then</li>
<li>#user may delete it.  First the record is highlighted</li>
<li>#in red and the user is asked if they really intend</li>
<li>#to delete this record.</li>
<li>Refresh Window</li>
<li>Go to Field [ test::testName ]
[ Select/perform ]</li>
<li>Scroll Window
[ To Selection ]</li>
<li>Go to Field [  ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Delete " &amp; test::testName &amp; "?"; Buttons: &ldquo;Cancel&rdquo;, &ldquo;Delete&rdquo; ]</li>
<li>#</li>
<li>#If the user cancels the delete, then everything</li>
<li>#goes back to the way it was before the delete</li>
<li>#was started.</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Set Variable [ $delete ]</li>
<li>Set Variable [ $$ID; Value:test::_Ltest ]</li>
<li>Refresh Window</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If the user presses 'delete' the system will now</li>
<li>#check if this test is the last test in its test group.</li>
<li>If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>#</li>
<li>New Window [ Height: 1; Width: 1; Top: -1000; Left: -1000 ]</li>
<li>#</li>
<li>Set Variable [ $section; Value:test::ksection ]</li>
<li>#( a test group field is neccessary because a section</li>
<li>#  may have more than one test group, and so trying</li>
<li>#  to find a test group using the section key and</li>
<li>#  the testGroup match field would find all groups</li>
<li>#  when we need the system to find one group. )</li>
<li>Set Variable [ $group; Value:test::ktestGroup ]</li>
<li>Set Variable [ $test; Value:test::_Ltest ]</li>
<li>#</li>
<li>#Find all tests in this test group.</li>
<li>Go to Layout [ &ldquo;tableTest&rdquo; (test) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ test::ktestGroup; $group ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#If the test is the last test, the user is informed</li>
<li>#of this and asked if knowing this they want to</li>
<li>#delete both the test and the test group, since</li>
<li>#a test group cannot exist without at least one test</li>
<li>#in it.</li>
<li>If [ Get (FoundCount) = 1 ]</li>
<li>#</li>
<li>Close Window [ Current Window ]</li>
<li>#</li>
<li>Set Variable [ $deleteGroup; Value:$delete ]</li>
<li>Refresh Window</li>
<li>Show Custom Dialog [ Title: "!"; Message: "If you delete this group's last test, it will also be deleted."; Buttons: &ldquo;Cancel&rdquo;, &ldquo;Delete&rdquo; ]</li>
<li>#</li>
<li>#If the user cancels the delete, then everything</li>
<li>#goes back to the way it was before the delete</li>
<li>#was started.</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Set Variable [ $delete ]</li>
<li>Set Variable [ $deleteGroup ]</li>
<li>Refresh Window</li>
<li>Set Variable [ $$ID; Value:test::_Ltest ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If the user pressed delete then first the </li>
<li>#test group is deleted.</li>
<li>#</li>
<li>New Window [  ]</li>
<li>#</li>
<li>Go to Layout [ &ldquo;tableGroupTag&rdquo; (groupTest) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ groupTest::_Lgroup; $group ]</li>
<li>Perform Find [  ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>End If</li>
<li>#</li>
<li>#Remove test's key from test-item groups that</li>
<li>#have it plus other keys.</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>Go to Layout [ &ldquo;setupTestItem&rdquo; (tagMenus) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ ruleTagMenuTestGroups::match; $test &amp; &para; ]</li>
<li>Perform Find [  ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>If [ ValueCount (ruleTagMenuTestGroups::match) &gt; 1 ]</li>
<li>Set Variable [ $match; Value:ruleTagMenuTestGroups::match ]</li>
<li>Set Field [ ruleTagMenuTestGroups::match; Substitute ( $match ; $test &amp; "&para;"  ; "" ) ]</li>
<li>End If</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Delete the test's test items that are only linked</li>
<li>#to this one test.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ ruleTagMenuTestGroups::match; $test &amp; &para; ]</li>
<li>Perform Find [  ]</li>
<li>Delete All Records
[ No dialog ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>#</li>
<li>#Finally, the test itself is deleted.</li>
<li>Go to Layout [ &ldquo;tableTest&rdquo; (test) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ test::_Ltest; $test ]</li>
<li>Perform Find [  ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>Close Window [ Current Window ]</li>
<li>#</li>
<li>#If this was the last test and there are no more</li>
<li>#tests, then the test focuses and attributes for </li>
<li>#this test section will also be deleted (as </li>
<li>#without any tests there is no need for a test </li>
<li>#focus or attribute).</li>
<li>If [ Get (FoundCount) = 0 ]</li>
<li>#</li>
<li>Set Field [ TEMP::ktestListtTestName; "" ]</li>
<li>Set Field [ TEMP::ktestItemListOLD; "" ]</li>
<li>Set Field [ TEMP::ktestItemList; "" ]</li>
<li>Set Field [ TEMP::kcfocuses; "" ]</li>
<li>Set Field [ TEMP::kfocus; "" ]</li>
<li>Set Field [ TEMP::ktest; "" ]</li>
<li>#</li>
<li>New Window [  ]</li>
<li>#</li>
<li>Go to Layout [ &ldquo;setupTestFocus&rdquo; (tagLocation) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagLocation::ksection; TEMP::ksection ]</li>
<li>Set Field [ tagLocation::match; "focus" ]</li>
<li>Perform Find [  ]</li>
<li>Delete All Records
[ No dialog ]</li>
<li>#</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagLocation::ksection; TEMP::ksection ]</li>
<li>Set Field [ tagLocation::match; "attribute" ]</li>
<li>Perform Find [  ]</li>
<li>Delete All Records</li>
<li>#</li>
<li>Close Window [ Current Window ]</li>
<li>End If</li>
<li>#</li>
<li>#Load current test's information.</li>
<li>Set Variable [ $$ID ]</li>
<li>Perform Script [ &ldquo;loadSetupTestRecord&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>nodeLockTest</em>::orderOrLock</li>
<li>
<em>nodeLockTest</em>::tag</li>
<li>
<em>test</em>::_Ltest</li>
<li>
<em>test</em>::testName</li>
<li>
<em>testlearnReportTags</em>::ktest</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>testlearn</em>::kcsection</li>
<li>
<em>testlearn</em>::filterFind</li>
<li>
<em>testlearn</em>::kctest</li>
<li>
<em>test</em>::ksection</li>
<li>
<em>test</em>::ktestGroup</li>
<li>
<em>groupTest</em>::_Lgroup</li>
<li>
<em>ruleTagMenuTestGroups</em>::match</li>
<li>
<em>TEMP</em>::ktestListtTestName</li>
<li>
<em>TEMP</em>::ktestItemListOLD</li>
<li>
<em>TEMP</em>::ktestItemList</li>
<li>
<em>TEMP</em>::kcfocuses</li>
<li>
<em>TEMP</em>::kfocus</li>
<li>
<em>TEMP</em>::ktest</li>
<li>
<em>tagLocation</em>::ksection</li>
<li>
<em>tagLocation</em>::match</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32930ScriptAnchor_">loadSetupTestRecord</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>reportTagDiscovery</li>
<li>learn1</li>
<li>tableTest</li>
<li>tableGroupTag</li>
<li>setupTestItem</li>
<li>setupTestFocus</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32820ScriptAnchor_"></a><td class="script_navbar"><a href="#32927ScriptAnchor_"><span>Previous Script: [deleteTest]</span></a></td><td class="script_navbar"><a href="#33323ScriptAnchor_"><span>Parent Folder: [setup]</span></a></td><td class="script_navbar"><a href="#32818ScriptAnchor_"><span>Next Script: [newTestItem]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">deleteTestItem</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If there are no tests, then stop this script as there</li>
<li>#are no test to create things for.</li>
<li>If [ TEMP::ktest = "" ]</li>
<li>Show Custom Dialog [ Message: "There are no tests."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>If [ nodeLockTagMenus::orderOrLock &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "This record is locked.  Go the node that created it -- " &amp; nodeLockTagMenus::tag &amp; " -- in the setup tag window and enter the password to unlock it so that you can delete it."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>If [ Get (FoundCount) = 0 ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Get variables needed for delete and delete messages.</li>
<li>Set Variable [ $delete; Value:tagMenus::_Ltag ]</li>
<li>Set Variable [ $group; Value:ruleTagMenuTestGroups::_Lgroup ]</li>
<li>Set Variable [ $groupName; Value:If ( Char ( ruleTagMenuTestGroups::name )  &le; 20 ; ruleTagMenuTestGroups::name ; Left ( ruleTagMenuTestGroups::name ; 20 ) &amp; "..." ) ]</li>
<li>Set Variable [ $testItemName; Value:If ( Char ( tagMenus::tag )  &le; 20 ; tagMenus::tag ; Left ( tagMenus::tag ; 20 ) &amp; "..." ) ]</li>
<li>#</li>
<li>#find and show all test records that might be using</li>
<li>#this item.</li>
<li>New Window [ Height: 1; Width: 1; Top: -1000; Left: -1000 ]</li>
<li>Set Variable [ $$stopLoadTestRecord; Value:1 ]</li>
<li>Go to Layout [ &ldquo;step4_InspectionFinding&rdquo; (testlearn) ]</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::ktest; $$item ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Check if test item is in use by any discovery records.</li>
<li>Loop</li>
<li>Set Variable [ $number; Value:1 ]</li>
<li>Loop</li>
<li>If [ FilterValues ( GetValue ( testlearn::kctestItem ; $number ) ; $delete &amp; "&para;"  )  = $delete &amp; &para; ]</li>
<li>Set Variable [ $addToInUse; Value:$inUse ]</li>
<li>Set Variable [ $inUse; Value:1 + $addToInUse ]</li>
<li>Set Variable [ $number; Value:"exit" ]</li>
<li>End If</li>
<li>#</li>
<li>#If number was set to exit or if no keys exist, then </li>
<li>#exit loop.</li>
<li>Exit Loop If [ GetValue ( testlearn::kctestItem ; $number )  = "" ]</li>
<li>#</li>
<li>#If variable looked at did not match then raise the number</li>
<li>#to view the next variable.</li>
<li>Set Variable [ $add; Value:$number ]</li>
<li>Set Variable [ $number; Value:$add + 1 ]</li>
<li>End Loop</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Set Variable [ $$stopLoadTestRecord ]</li>
<li>Close Window [ Current Window ]</li>
<li>#</li>
<li>#If in use the stop script.</li>
<li>If [ $inUse &ne; "" ]</li>
<li>Show Custom Dialog [ Message: If ( $inUse = 1 ; "Current test item use = " &amp; $inUse &amp; ".  Uncheck this item in test module from the " &amp; $inUse &amp; " item using it and you will then be able to delete it." ; "Current test item use = " &amp; $inUse &amp; ".  Uncheck this item in test module from the " &amp; $inUse &amp; " items using it and you will then be able to delete it." ); Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Exit any fields and then contionally format field</li>
<li>#to be deleted by this script.</li>
<li>Go to Field [  ]</li>
<li>Refresh Window</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Delete " &amp; $testItemName &amp; "?"; Buttons: &ldquo;Cancel&rdquo;, &ldquo;Delete&rdquo; ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#If the user says yes, first make sure the record</li>
<li>#is not the last record in its group.  If it is and</li>
<li>#the system deleted the record without deleting</li>
<li>#the group too, this group would become</li>
<li>#an orphan as only groups that have records</li>
<li>#attached to them show up for the user to add</li>
<li>#more records to them.  So the group</li>
<li>#record must also be deleted if this is the last</li>
<li>#test item under it.</li>
<li>If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>New Window [ Name: "delete tag"; Height: 1; Width: 1; Top: -1000; Left: -1000 ]</li>
<li>Go to Layout [ &ldquo;tableTag&rdquo; (tagTable) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTable::kGroupOrTest; $group ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#If there are more records under this cateogry</li>
<li>#then the system deletes the current record without</li>
<li>#any more user input.</li>
<li>If [ Get (FoundCount) &ne; 1 ]</li>
<li>Close Window [ Name: "Delete Tag"; Current file ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>Set Variable [ $delete ]</li>
<li>Set Variable [ $group ]</li>
<li>Refresh Window</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>#BUT if only one record is found user is asked</li>
<li>#if they want to delete the category too.</li>
<li>Else If [ Get (FoundCount) = 1 ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Set Variable [ $deleteGroup; Value:$group ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#The records are sorted by category to show</li>
<li>#the user which category is going to be deleted.</li>
<li>If [ TEMP::sortTestItem &ne; "cat" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#Show user warning message dependening on</li>
<li>#whether or not this group is part of other test's</li>
<li>#test-item lists.</li>
<li>If [ ValueCount ( ruleTagMenuTestGroups::match ) &gt; 1 ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Deleting " &amp; $testItemName &amp; " will also delete its group: " &amp; $groupName &amp; ", which is on " &amp; ValueCount ( ruleTagMenuTestGroups::match ) - 1  &amp; " other test-item list(s).  Option 1: delete it from all lists.  Option 2: cancel delete.  UNLINK this group from this list."; Buttons: &ldquo;Cancel&rdquo;, &ldquo;Delete&rdquo; ]</li>
<li>Else If [ ValueCount ( ruleTagMenuTestGroups::match ) = 1 ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Deleting " &amp; $testItemName &amp; " will also delete its group ' " &amp; $groupName &amp; "' as it is the last item in this group."; Buttons: &ldquo;Cancel&rdquo;, &ldquo;Delete&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>#If the user says yes, then delete both the tag and </li>
<li>#the category record.</li>
<li>If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>Select Window [ Name: "delete tag"; Current file ]</li>
<li>Go to Layout [ &ldquo;tableGroupTag&rdquo; (groupTest) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ groupTest::_Lgroup; $group ]</li>
<li>Perform Find [  ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>Close Window [ Name: "Delete Tag"; Current file ]</li>
<li>End If</li>
<li>End If</li>
<li>End If</li>
<li>Set Variable [ $delete ]</li>
<li>Set Variable [ $deleteGroup ]</li>
<li>Refresh Window</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::ktest</li>
<li>
<em>nodeLockTagMenus</em>::orderOrLock</li>
<li>
<em>nodeLockTagMenus</em>::tag</li>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>ruleTagMenuTestGroups</em>::_Lgroup</li>
<li>
<em>ruleTagMenuTestGroups</em>::name</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>testlearn</em>::ktest</li>
<li>
<em>testlearn</em>::kctestItem</li>
<li>
<em>tagTable</em>::kGroupOrTest</li>
<li>
<em>TEMP</em>::sortTestItem</li>
<li>
<em>ruleTagMenuGroups</em>::order</li>
<li>
<em>ruleTagMenuGroups</em>::name</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>ruleTagMenuTestGroups</em>::match</li>
<li>
<em>groupTest</em>::_Lgroup</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>step4_InspectionFinding</li>
<li>tableTag</li>
<li>tableGroupTag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32818ScriptAnchor_"></a><td class="script_navbar"><a href="#32820ScriptAnchor_"><span>Previous Script: [deleteTestItem]</span></a></td><td class="script_navbar"><a href="#33323ScriptAnchor_"><span>Parent Folder: [setup]</span></a></td><td class="script_navbar"><a href="#32929ScriptAnchor_"><span>Next Script: [moveTestItemToNewTestGroupStep1]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">newTestItem</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If node is currenlty locked then stop script, inform user.</li>
<li>If [ TEMP::nodeLock &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "The default record creation node -- " &amp; TEMP::DEFAULTNodePrimaryName &amp; " -- is locked.  Select this node in the setup tag window and enter the password to unlock it so that you can create new records attributed to it."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If there are no tests, then stop this script as there</li>
<li>#are no test to create things for.</li>
<li>If [ TEMP::ktest = "" ]</li>
<li>Show Custom Dialog [ Message: "There are no tests."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If there are no test items, then create a new test</li>
<li>#item group first and then a test for that group. </li>
<li>#All test items belong to test item groups, not</li>
<li>#tests.  This allows test item groups to be added</li>
<li>#to other test's test item lists.</li>
<li>If [ Get (FoundCount) = 0 ]</li>
<li>Perform Script [ &ldquo;newTestItemGroup&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Create an item for this goup of test items.</li>
<li>New Record/Request</li>
<li>Set Field [ tagMenus::match; "testItem" ]</li>
<li>Set Field [ tagMenus::kGroupOrTest; GetNthRecord ( tagMenus::kGroupOrTest ; Get (RecordNumber) - 1 ) ]</li>
<li>Set Field [ tagMenus::ksection; TEMP::ksection ]</li>
<li>Set Field [ tagMenus::tag; "item " &amp; tagMenus::_Ltag ]</li>
<li>Set Field [ tagMenus::kRecordCreatorNode; TEMP::kdefaultNodePrimary ]</li>
<li>Go to Field [  ]</li>
<li>Go to Field [ tagMenus::tag ]
[ Select/perform ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::nodeLock</li>
<li>
<em>TEMP</em>::DEFAULTNodePrimaryName</li>
<li>
<em>TEMP</em>::ktest</li>
<li>
<em>tagMenus</em>::match</li>
<li>
<em>tagMenus</em>::kGroupOrTest</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>tagMenus</em>::ksection</li>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>TEMP</em>::kdefaultNodePrimary</li>
<li>
<em>tagMenus</em>::kRecordCreatorNode</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33073ScriptAnchor_">newTestItemGroup</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32929ScriptAnchor_"></a><td class="script_navbar"><a href="#32818ScriptAnchor_"><span>Previous Script: [newTestItem]</span></a></td><td class="script_navbar"><a href="#33323ScriptAnchor_"><span>Parent Folder: [setup]</span></a></td><td class="script_navbar"><a href="#33073ScriptAnchor_"><span>Next Script: [newTestItemGroup]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">moveTestItemToNewTestGroupStep1</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If node is currenlty locked then stop script, inform user.</li>
<li>If [ nodeLockTest::orderOrLock &ne; "" ]</li>
<li>Go to Field [  ]</li>
<li>Show Custom Dialog [ Message: "This record is locked.  Go the node that created it -- " &amp; nodeLockTest::tag &amp; " -- in the setup tag window and enter the password to unlock it so that you can move it."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Set Variable [ $$groupOLD; Value:test::ktestGroup ]</li>
<li>Set Variable [ $$moveItem; Value:test::_Ltest ]</li>
<li>Refresh Window</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>nodeLockTest</em>::orderOrLock</li>
<li>
<em>nodeLockTest</em>::tag</li>
<li>
<em>test</em>::ktestGroup</li>
<li>
<em>test</em>::_Ltest</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33073ScriptAnchor_"></a><td class="script_navbar"><a href="#32929ScriptAnchor_"><span>Previous Script: [moveTestItemToNewTestGroupStep1]</span></a></td><td class="script_navbar"><a href="#33323ScriptAnchor_"><span>Parent Folder: [setup]</span></a></td><td class="script_navbar"><a href="#33224ScriptAnchor_"><span>Next Script: [testNameToRevertNamField]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">newTestItemGroup</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32925ScriptAnchor_">newTestGroup</a></li>
<li><a href="#32926ScriptAnchor_">newTest</a></li>
<li><a href="#32818ScriptAnchor_">newTestItem</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If node is currenlty locked then stop script, inform user.</li>
<li>If [ TEMP::nodeLock &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "The default record creation node -- " &amp; TEMP::DEFAULTNodePrimaryName &amp; " -- is locked.  Select this node in the setuptag window and enter the password to unlock it so that you can create new records attributed to it."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If there are no tests, then stop this script as there</li>
<li>#are no test to create things for.</li>
<li>If [ TEMP::ktest = "" ]</li>
<li>Show Custom Dialog [ Message: "There are no tests."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>Go to Layout [ &ldquo;tableGroupTag&rdquo; (groupTest) ]</li>
<li>#</li>
<li>New Record/Request</li>
<li>Set Field [ groupTest::ksection; TEMP::ksection ]</li>
<li>#</li>
<li>#Each test-item group must have a unique name and </li>
<li>#the nameSpelling field is used when the user</li>
<li>#changes the name to a name already in use at</li>
<li>#which point the nameSpelling name can revert</li>
<li>#the user back to the former name (as the name</li>
<li>#field contains the duplicate name which is not</li>
<li>#allowed).</li>
<li>Set Field [ groupTest::name; "test item group " &amp; groupTest::_Lgroup ]</li>
<li>Set Field [ groupTest::kRecordCreatorNode; TEMP::kdefaultNodePrimary ]</li>
<li>Set Field [ groupTest::nameSpelling; "testItemGroup" ]</li>
<li>Set Field [ groupTest::match; TEMP::ktest &amp; &para; ]</li>
<li>Set Variable [ $group; Value:groupTest::_Lgroup ]</li>
<li>#</li>
<li>#Create an item for this goup as all groups must</li>
<li>#have at least one item.  Item layout is sorted by</li>
<li>#by group and then item and groups are only </li>
<li>#shown as subheaders.  So without an item</li>
<li>#even if a group it existed it would not show up.</li>
<li>Go to Layout [ original layout ]</li>
<li>New Record/Request</li>
<li>Set Field [ tagMenus::match; "testItem" ]</li>
<li>Set Field [ tagMenus::kGroupOrTest; $group ]</li>
<li>Set Field [ tagMenus::ksection; TEMP::ksection ]</li>
<li>Set Field [ tagMenus::tag; "item " &amp; tagMenus::_Ltag ]</li>
<li>Set Field [ tagMenus::kRecordCreatorNode; TEMP::kdefaultNodePrimary ]</li>
<li>Go to Field [  ]</li>
<li>Go to Field [ tagMenus::tag ]
[ Select/perform ]</li>
<li>#</li>
<li>#If this is the first record to be created the layout</li>
<li>#must be sorted to get it to show the group for </li>
<li>#this first test item.</li>
<li>If [ Get (FoundCount) = 1 ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuTestGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuTestGroups::_Lgroup; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::nodeLock</li>
<li>
<em>TEMP</em>::DEFAULTNodePrimaryName</li>
<li>
<em>TEMP</em>::ktest</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>groupTest</em>::ksection</li>
<li>
<em>groupTest</em>::_Lgroup</li>
<li>
<em>groupTest</em>::name</li>
<li>
<em>TEMP</em>::kdefaultNodePrimary</li>
<li>
<em>groupTest</em>::kRecordCreatorNode</li>
<li>
<em>groupTest</em>::nameSpelling</li>
<li>
<em>groupTest</em>::match</li>
<li>
<em>tagMenus</em>::match</li>
<li>
<em>tagMenus</em>::kGroupOrTest</li>
<li>
<em>tagMenus</em>::ksection</li>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>tagMenus</em>::kRecordCreatorNode</li>
<li>
<em>ruleTagMenuTestGroups</em>::order</li>
<li>
<em>ruleTagMenuTestGroups</em>::_Lgroup</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>tableGroupTag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33224ScriptAnchor_"></a><td class="script_navbar"><a href="#33073ScriptAnchor_"><span>Previous Script: [newTestItemGroup]</span></a></td><td class="script_navbar"><a href="#33323ScriptAnchor_"><span>Parent Folder: [setup]</span></a></td><td class="script_navbar"><a href="#32928ScriptAnchor_"><span>Next Script: [moveTestItemToNewTestGroupStep2]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">testNameToRevertNamField</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ $$stopTest = "" ]</li>
<li>Set Variable [ $$tag; Value:test::_Ltest ]</li>
<li>Perform Script [ &ldquo;CHUNKcheckForDragPasteChanges&rdquo; ]</li>
<li>Set Variable [ $$tag ]</li>
<li>Set Field [ test::testNameRevert; test::testName ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>test</em>::_Ltest</li>
<li>
<em>test</em>::testName</li>
<li>
<em>test</em>::testNameRevert</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33223ScriptAnchor_">CHUNKcheckForDragPasteChanges</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32928ScriptAnchor_"></a><td class="script_navbar"><a href="#33224ScriptAnchor_"><span>Previous Script: [testNameToRevertNamField]</span></a></td><td class="script_navbar"><a href="#33323ScriptAnchor_"><span>Parent Folder: [setup]</span></a></td><td class="script_navbar"><a href="#33342ScriptAnchor_"><span>Next Script: [stuffCheckBox]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">moveTestItemToNewTestGroupStep2</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Stop test record load script to speed up script.</li>
<li>Set Variable [ $$ID; Value:"ignore" ]</li>
<li>#</li>
<li>#Get the newly selected group's ID number.</li>
<li>Set Variable [ $newGroup; Value:test::ktestGroup ]</li>
<li>#</li>
<li>#Reset the test's group ID with its old group ID</li>
<li>#number grabbed by the system in part 1 of </li>
<li>#this script, just in case the user decides to cancel</li>
<li>#move and the test needs to stay put.</li>
<li>Set Field [ test::ktestGroup; $$groupOLD ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Check if this is the last test in the test group.</li>
<li>New Window [  ]</li>
<li>Go to Layout [ &ldquo;tableTest&rdquo; (test) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ test::ktestGroup; $$groupOLD ]</li>
<li>Perform Find [  ]</li>
<li>If [ Get (FoundCount) = 1 ]</li>
<li>Close Window [ Current Window ]</li>
<li>Set Variable [ $deleteGroup; Value:TEMP::ktest ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#If it is the last item inform user that after the move</li>
<li>#the old group will be deleted unless the user</li>
<li>#creates a new item for this group before moving</li>
<li>#the old item.</li>
<li>Show Custom Dialog [ Title: "!"; Message: "After " &amp; test::testName &amp; " is moved its old group will be deleted.  If you want to keep this group then move the test after creating a new test for the old group."; Buttons: &ldquo;Cancel&rdquo;, &ldquo;move&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Set Variable [ $deleteGroup ]</li>
<li>Set Variable [ $$groupOLD ]</li>
<li>Refresh Window</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If the user decides to go ahead with the move,</li>
<li>#first delete the old group.</li>
<li>New Window [  ]</li>
<li>#</li>
<li>Go to Layout [ &ldquo;tableGroupTag&rdquo; (groupTest) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ groupTest::_Lgroup; $$groupOLD ]</li>
<li>Perform Find [  ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>#</li>
<li>End If</li>
<li>#</li>
<li>#Close window opened to perform find, and then</li>
<li>#set group ID of test with the new groups ID number.</li>
<li>Close Window [ Current Window ]</li>
<li>Set Field [ test::ktestGroup; $newGroup ]</li>
<li>Set Variable [ $$groupOLD ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Turn back on the loadrecord script.  The current</li>
<li>#record's info does not need to be reloaded of course</li>
<li>#because it is still the current record.</li>
<li>Set Variable [ $$ID; Value:test::_Ltest ]</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>test</em>::ktestGroup</li>
<li>
<em>TEMP</em>::ktest</li>
<li>
<em>test</em>::testName</li>
<li>
<em>groupTest</em>::_Lgroup</li>
<li>
<em>test</em>::_Ltest</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>tableTest</li>
<li>tableGroupTag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33342ScriptAnchor_"></a><td class="script_navbar"><a href="#32928ScriptAnchor_"><span>Previous Script: [moveTestItemToNewTestGroupStep2]</span></a></td><td class="script_navbar"><a href="#33323ScriptAnchor_"><span>Parent Folder: [setup]</span></a></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">stuffCheckBox</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Go to Field [  ]</li>
<li>If [ tempSetup::InventoryLibaryYN = "" ]</li>
<li>Set Field [ tempSetup::layoutLtagK; "" ]</li>
<li>Set Field [ tempSetup::layoutRtagK; "" ]</li>
<li>Set Field [ tempSetup::layoutLtagN; "" ]</li>
<li>Set Field [ tempSetup::layoutRtagN; "" ]</li>
<li>Else</li>
<li>Set Field [ tempSetup::layoutLtagK; "moreltagNKs2" ]</li>
<li>Set Field [ tempSetup::layoutRtagK; "moreReferenceMenu2SkeywordOrNode1" ]</li>
<li>Set Field [ tempSetup::layoutLtagN; "moreltagNKs2" ]</li>
<li>Set Field [ tempSetup::layoutRtagN; "moreReferenceMenu2SkeywordOrNode1" ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tempSetup</em>::InventoryLibaryYN</li>
<li>
<em>tempSetup</em>::layoutLtagK</li>
<li>
<em>tempSetup</em>::layoutRtagK</li>
<li>
<em>tempSetup</em>::layoutLtagN</li>
<li>
<em>tempSetup</em>::layoutRtagN</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<p>
<span class="partheading"><a name="33317ScriptAnchor_"></a><a href="#33317ScriptAnchor_toc">test</a></span>
</p>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33177ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"><a href="#33317ScriptAnchor_"><span>Parent Folder: [test]</span></a></td><td class="script_navbar"><a href="#33228ScriptAnchor_"><span>Next Script: [testInfoOpenTextNewWindow]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">(un)linkTestItemGroupToTestItemList</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Exit script if any of the current groups test items</li>
<li>#are in use.  ( At a later date, improve this script</li>
<li>#     so it finds the specific records in use and informs</li>
<li>#     user of them specficially so user can find</li>
<li>#     them and know how many their are. )</li>
<li>#</li>
<li>#find and show all test records that might be using</li>
<li>#any item in this group.</li>
<li>Set Variable [ $$stopLoadTestRecord; Value:1 ]</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>Set Variable [ $group; Value:ruleTagMenuTestGroups::_Lgroup ]</li>
<li>New Window [  ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ ruleTagMenuTestGroups::_Lgroup; $group ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Create a variable keychain of all test items that could</li>
<li>#be used.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Variable [ $addToCheck; Value:$check ]</li>
<li>Set Variable [ $check; Value:tagMenus::_Ltag &amp; &para; &amp; $addToCheck ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Check each test item against each test discovery record</li>
<li>#for this test item.</li>
<li>Go to Layout [ &ldquo;step4_InspectionFinding&rdquo; (testlearn) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::ktest; $$item ]</li>
<li>Perform Find [  ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>#The first loop checks for each test item.</li>
<li>Set Variable [ $groupNumber; Value:1 ]</li>
<li>#</li>
<li>#</li>
<li>#The first loop checks for each test item.</li>
<li>Loop</li>
<li>Set Variable [ $item; Value:GetValue ( $check ; $groupNumber ) ]</li>
<li>#</li>
<li>#Second loop checks the selected test item against each</li>
<li>#key in each discovery record's test item keychain.</li>
<li>Loop</li>
<li>Set Variable [ $number; Value:1 ]</li>
<li>Loop</li>
<li>If [ FilterValues ( GetValue ( testlearn::kctestItem ; $number ) ; $item &amp; &para;  )  = $item &amp; &para; ]</li>
<li>Set Variable [ $addToInUse; Value:$inUse ]</li>
<li>Set Variable [ $inUse; Value:$addToInUse &amp; $item &amp; &para; ]</li>
<li>Set Variable [ $number; Value:"exit" ]</li>
<li>End If</li>
<li>#</li>
<li>#If number was set to exit or if no keys exist, then </li>
<li>#exit loop.</li>
<li>Exit Loop If [ GetValue ( testlearn::kctestItem ; $number )  = "" ]</li>
<li>#</li>
<li>#If variable looked at did not match then raise the number</li>
<li>#to view the next variable.</li>
<li>Set Variable [ $add; Value:$number ]</li>
<li>Set Variable [ $number; Value:$add + 1 ]</li>
<li>End Loop</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#If no more items in group then exit loop.</li>
<li>Exit Loop If [ GetValue ( $check ; $groupNumber )  = "" ]</li>
<li>#</li>
<li>#If variable looked at did not match then raise the number</li>
<li>#to view the next variable.</li>
<li>Set Variable [ $addToGroup; Value:$groupNumber ]</li>
<li>Set Variable [ $groupNumber; Value:$addToGroup + 1 ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>End Loop</li>
<li>#</li>
<li>Set Variable [ $$stopLoadTestRecord ]</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>Close Window [ Current Window ]</li>
<li>#</li>
<li>#If in use the stop script.</li>
<li>If [ $inUse &ne; "" ]</li>
<li>Refresh Window</li>
<li>Show Custom Dialog [ Message: "The highlighed items are currently in use.  Uncheck these items from the tests using them and then you will be able to unlink this group of items."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Set Variable [ $inUse ]</li>
<li>Refresh Window</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Capture group key to be linked to or unlinked </li>
<li>#from the current test-item list.</li>
<li>Set Variable [ $addTestItemGroup; Value:addTestItemGroup::addTestItemGroup ]</li>
<li>#</li>
<li>#Open a new window and find this test item group.</li>
<li>New Window [  ]</li>
<li>Go to Layout [ &ldquo;tableGroupTag&rdquo; (groupTest) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ groupTest::_Lgroup; $addTestItemGroup ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Capture current list of testList keys.</li>
<li>Set Variable [ $match; Value:groupTest::match ]</li>
<li>#</li>
<li>#Remove the key from the list of test-item </li>
<li>#group keys, unless it only belongs to this list, </li>
<li>#in which case tell user that rather than </li>
<li>#unlinking it, the list needs to be deleted</li>
<li>#or linked to another test before unlinking it</li>
<li>#from the current test's list.</li>
<li>If [ TEMP::ktestItemList &amp; "&para;"  = FilterValues ( $match ; TEMP::ktestItemList &amp; "&para;" ) ]</li>
<li>#</li>
<li>#Determine if test-item group belongs to more</li>
<li>#than one test.</li>
<li>If [ ValueCount ( groupTest::match ) = 1 ]</li>
<li>Close Window [ Current Window ]</li>
<li>Go to Field [  ]</li>
<li>Show Custom Dialog [ Message: "This group cannot be unlinked because it is only linked to this test-item list and unlinking it would orphan it.  Option 1: delete all items in group to remove it.  Option 2: link it to another test and then unlink it from this test."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ ValueCount ( groupTest::match ) &ne; 1 ]</li>
<li>Set Field [ groupTest::match; Substitute ( $match ; TEMP::ktestItemList &amp; "&para;"  ; "" ) ]</li>
<li>Close Window [ Current Window ]</li>
<li>End If</li>
<li>#</li>
<li>#Add the key to list of test keys, if it is not currently </li>
<li>#part of this list.</li>
<li>Else If [ TEMP::ktestItemList &amp; "&para;" &ne; FilterValues ( $match ; TEMP::ktestItemList &amp; "&para;" ) ]</li>
<li>Set Field [ groupTest::match; TEMP::ktestItemList &amp; &para; &amp; $match ]</li>
<li>Close Window [ Current Window ]</li>
<li>End If</li>
<li>#</li>
<li>#Show newly added group and its test items.</li>
<li>Perform Script [ &ldquo;menuTestItem&rdquo; ]</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>ruleTagMenuTestGroups</em>::_Lgroup</li>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>testlearn</em>::ktest</li>
<li>
<em>testlearn</em>::kctestItem</li>
<li>
<em>addTestItemGroup</em>::addTestItemGroup</li>
<li>
<em>groupTest</em>::_Lgroup</li>
<li>
<em>groupTest</em>::match</li>
<li>
<em>TEMP</em>::ktestItemList</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33071ScriptAnchor_">menuTestItem</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>step4_InspectionFinding</li>
<li>tableGroupTag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33228ScriptAnchor_"></a><td class="script_navbar"><a href="#33177ScriptAnchor_"><span>Previous Script: [(un)linkTestItemGroupToTestItemList]</span></a></td><td class="script_navbar"><a href="#33317ScriptAnchor_"><span>Parent Folder: [test]</span></a></td><td class="script_navbar"><a href="#33156ScriptAnchor_"><span>Next Script: [testCheck]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">testInfoOpenTextNewWindow</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ $$stopOpenNewTextWindow = 1 ]</li>
<li>Set Variable [ $$stopOpenNewTextWindow ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $$stopLoadCitation; Value:1 ]</li>
<li>New Window [  ]</li>
<li>If [ tagTLNodePrimary::orderOrLock = "" and Get (LayoutName) &ne; "testInfo" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Layout [ &ldquo;testInfoText&rdquo; (testlearnReportTags) ]</li>
<li>//  Go to Field [ testlearnReportTags::Caption ]</li>
<li>Else If [ tagTLNodePrimary 2::orderOrLock = "" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Layout [ &ldquo;testInfoText&rdquo; (testlearnReportTags) ]</li>
<li>//  Go to Field [ testlearnReportTags::Caption ]</li>
<li>Else If [ tagTLNodePrimary::orderOrLock &ne; "" or tagTLNodePrimary 2::orderOrLock &ne; "" ]</li>
<li>Go to Layout [ &ldquo;testInfoTextLocked&rdquo; (testlearnReportTags) ]</li>
<li>End If</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Pause/Resume Script [ Indefinitely ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagTLNodePrimary</em>::orderOrLock</li>
<li>
<em>testlearnReportTags</em>::Caption</li>
<li>
<em>tagTLNodePrimary 2</em>::orderOrLock</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>testInfoText</li>
<li>testInfoTextLocked</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33156ScriptAnchor_"></a><td class="script_navbar"><a href="#33228ScriptAnchor_"><span>Previous Script: [testInfoOpenTextNewWindow]</span></a></td><td class="script_navbar"><a href="#33317ScriptAnchor_"><span>Parent Folder: [test]</span></a></td><td class="script_navbar"><a href="#33140ScriptAnchor_"><span>Next Script: [testSetLocationName]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">testCheck</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ Get ( ActiveFieldContents ) = "" ]</li>
<li>Go to Field [  ]</li>
<li>Show Custom Dialog [ Message: "You need to create a test by clicking the 'new/edit' test button above, before you can create a focus for your test.  Sorry if this is confusing.  As youhe test focus screen (this screen) before you can see the test create screen.  "; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33140ScriptAnchor_"></a><td class="script_navbar"><a href="#33156ScriptAnchor_"><span>Previous Script: [testCheck]</span></a></td><td class="script_navbar"><a href="#33317ScriptAnchor_"><span>Parent Folder: [test]</span></a></td><td class="script_navbar"><a href="#33136ScriptAnchor_"><span>Next Script: [loadtestinfo]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">testSetLocationName</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Field [ TEMP::LocationName; discoveryPulldownLocationName::focusName ]</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>discoveryPulldownLocationName</em>::focusName</li>
<li>
<em>TEMP</em>::LocationName</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33136ScriptAnchor_"></a><td class="script_navbar"><a href="#33140ScriptAnchor_"><span>Previous Script: [testSetLocationName]</span></a></td><td class="script_navbar"><a href="#33317ScriptAnchor_"><span>Parent Folder: [test]</span></a></td><td class="script_navbar"><a href="#32903ScriptAnchor_"><span>Next Script: [scroll test]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">loadtestinfo</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32803ScriptAnchor_">inUsePart3</a></li>
<li><a href="#33095ScriptAnchor_">gotoDefaultsOrReport</a></li>
<li><a href="#33135ScriptAnchor_">reportTagInfo</a></li>
<li><a href="#33143ScriptAnchor_">reportClearDiscoveryLink</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#This first section is key to stopping this script</li>
<li>#when another script for example loops thru</li>
<li>#many records each of which would trigger this</li>
<li>#script and really slow down the program and</li>
<li>#create strobe effect that is really irritating to</li>
<li>#look at.</li>
<li>If [ $$stoploadtestinfo = 1 ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#This key effects the conditional formatting </li>
<li>Set Variable [ $$RecordID; Value:Get (RecordID) ]</li>
<li>Go to Field [  ]</li>
<li>Refresh Window</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32903ScriptAnchor_"></a><td class="script_navbar"><a href="#33136ScriptAnchor_"><span>Previous Script: [loadtestinfo]</span></a></td><td class="script_navbar"><a href="#33317ScriptAnchor_"><span>Parent Folder: [test]</span></a></td><td class="script_navbar"><a href="#32971ScriptAnchor_"><span>Next Script: [loadTestRecord]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">scroll test</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Freeze Window</li>
<li>Go to Layout [ &lt;unknown&gt; ]</li>
<li>Go to Layout [ original layout ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>&lt;Missing Layout&gt;</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32971ScriptAnchor_"></a><td class="script_navbar"><a href="#32903ScriptAnchor_"><span>Previous Script: [scroll test]</span></a></td><td class="script_navbar"><a href="#33317ScriptAnchor_"><span>Parent Folder: [test]</span></a></td><td class="script_navbar"><a href="#32775ScriptAnchor_"><span>Next Script: [newTestRecord]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">loadTestRecord</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32775ScriptAnchor_">newTestRecord</a></li>
<li><a href="#32829ScriptAnchor_">gotoTestItem</a></li>
<li><a href="#32837ScriptAnchor_">delete_Evidence</a></li>
<li><a href="#33095ScriptAnchor_">gotoDefaultsOrReport</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#Prevents script from running to speed up other</li>
<li>#scripts that keep calling it up by looping thru</li>
<li>#multiple records.</li>
<li>If [ $$stopLoadTestRecord = 1 ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Set Variable [ $$evidenceToBeTagged; Value:testlearn::_Ltestlearn ]</li>
<li>Set Variable [ $$taggedEvidence; Value:testlearn::kcKeywordOther ]</li>
<li>Set Variable [ $$testItem ]</li>
<li>Set Variable [ $$testItem; Value:testlearn::kctestItem ]</li>
<li>Set Field [ TEMP::EvidenceItemNameAndNumber; testlearn::_Number &amp; " " &amp; InspectItems::testName ]</li>
<li>Set Variable [ $windowName; Value:Get (WindowName) ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>Select Window [ Name: $windowName; Current file ]</li>
<li>Refresh Window</li>
<li>//  Perform Script [ &ldquo;evidenceDetailDELETE?????&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearn</em>::_Ltestlearn</li>
<li>
<em>testlearn</em>::kcKeywordOther</li>
<li>
<em>testlearn</em>::kctestItem</li>
<li>
<em>testlearn</em>::_Number</li>
<li>
<em>InspectItems</em>::testName</li>
<li>
<em>TEMP</em>::EvidenceItemNameAndNumber</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32943ScriptAnchor_">evidenceDetailDELETE?????</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32775ScriptAnchor_"></a><td class="script_navbar"><a href="#32971ScriptAnchor_"><span>Previous Script: [loadTestRecord]</span></a></td><td class="script_navbar"><a href="#33317ScriptAnchor_"><span>Parent Folder: [test]</span></a></td><td class="script_navbar"><a href="#32906ScriptAnchor_"><span>Next Script: [linkTestFocusOrUnlinkTestFocus]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">newTestRecord</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32829ScriptAnchor_">gotoTestItem</a></li>
<li><a href="#33095ScriptAnchor_">gotoDefaultsOrReport</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Variable [ $$stopLoadTestRecord; Value:1 ]</li>
<li>#</li>
<li>#create new inspection record setting all fields with neccessary key copies</li>
<li>#to unlock data </li>
<li>Go to Layout [ &ldquo;step4_InspectionFinding&rdquo; (testlearn) ]</li>
<li>#</li>
<li>#see if a finding record already exists as an N/A, OK or ★ record</li>
<li>#because system does not change one of these</li>
<li>#records when user clicks to see test records</li>
<li>#unless there is only one record.</li>
<li>Enter Find Mode [  ]</li>
<li>#</li>
<li>#find and show all inspection findings</li>
<li>Set Field [ testlearn::ktestSubject; $$contact ]</li>
<li>Set Field [ testlearn::ktest; $$item ]</li>
<li>Set Field [ testlearn::kreportNumber; $$reportNumber ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>//  If [ Get (FoundCount) = 1 and testlearn::InspectionItemCountLocation   =  "N/A" and testlearn::kreportNumber = $$reportNumber or  
Get (FoundCount) = 1 and testlearn::InspectionItemCountLocation   =  "OK" and testlearn::kreportNumber = $$reportNumber or  
Get (FoundCount) = 1 and testlearn::InspectionItemCountLocation    =    "★"  and testlearn::kreportNumber = $$reportNumber ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>If [ testlearn::kaudienceLocation = $$Location and testlearn::InspectionItemCountLocation   =  "N/A" and testlearn::kreportNumber = $$reportNumber or  

testlearn::kaudienceLocation = $$Location and testlearn::InspectionItemCountLocation   =  "OK" and testlearn::kreportNumber = $$reportNumber or  

testlearn::kaudienceLocation = $$Location and testlearn::InspectionItemCountLocation    =    "★"  and testlearn::kreportNumber = $$reportNumber ]</li>
<li>#If a non finding OK or NA record exists, change it into the first finding record</li>
<li>Set Field [ testlearn::InspectionItemCountLocation; 1 ]</li>
<li>Set Field [ testlearn::kreportNumber; $$reportNumber ]</li>
<li>#</li>
<li>#increase number of findings for item in all locations</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::ktestSubject; $$contact ]</li>
<li>Set Field [ testlearn::ktest; $$item ]</li>
<li>Set Field [ testlearn::kreportNumber; $$reportNumber ]</li>
<li>Perform Find [  ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Variable [ $number; Value:Get (FoundCount) ]</li>
<li>Loop</li>
<li>Set Field [ testlearn::InspectionItemCount; $number ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#first see if a report record exists for this item</li>
<li>Go to Layout [ &ldquo;PrintReportEdit&rdquo; (report) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ report::ktestSubject; $$contact ]</li>
<li>Set Field [ report::ktest; $$item ]</li>
<li>Set Field [ report::kreportNumber; $$reportNumber ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>If [ Get ( LastError )  =  401 ]</li>
<li>#</li>
<li>#create new report record and put in all required information</li>
<li>New Record/Request</li>
<li>Set Field [ report::ktestSubject; $$contact ]</li>
<li>Set Field [ report::ktest; $$item ]</li>
<li>Set Field [ report::kreportNumber; $$reportNumber ]</li>
<li>Set Field [ report::ksection; $$library ]</li>
<li>Set Field [ report::kRecordCreatorNode; TEMP::kdefaultNodePrimary ]</li>
<li>Set Field [ report::RecordModifyDate; Get ( CurrentTimeStamp ) ]</li>
<li>Set Field [ report::khealth; TEMP::kdefaultHealth ]</li>
<li>End If</li>
<li>Go to Layout [ &ldquo;step3_InspectionItems&rdquo; (InspectItems) ]</li>
<li>Set Field [ InspectItems::gprogressGlobal; "status: in progress" ]</li>
<li>Go to Layout [ &ldquo;step4_InspectionFinding&rdquo; (testlearn) ]</li>
<li>Set Variable [ $id; Value:testlearn::_Ltestlearn ]</li>
<li>Sort Records [ Specified Sort Order: ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $ID = testlearn::_Ltestlearn ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Set Field [ testlearn::recordnumberglobal; Get (RecordNumber) ]</li>
<li>Set Field [ testlearn::recordcountglobal; Get (FoundCount) ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>New Record/Request</li>
<li>Set Field [ testlearn::ktestSubject; $$contact ]</li>
<li>Set Field [ testlearn::kaudienceLocation; $$location ]</li>
<li>Set Field [ testlearn::kcsection; $$Library ]</li>
<li>Set Field [ testlearn::kreportNumber; $$reportNumber ]</li>
<li>Set Field [ testlearn::Location; $$locationName ]</li>
<li>Set Field [ testlearn::ktest; $$item ]</li>
<li>Set Field [ testlearn::kRecordCreatorNode; TEMP::kdefaultNodePrimary ]</li>
<li>Set Field [ testlearn::RecordModifyDate; Get ( CurrentTimeStamp ) ]</li>
<li>Set Field [ testlearn::kHealth; TEMP::kdefaultHealth ]</li>
<li>#</li>
<li>#increase number of findings for item for this contact's location</li>
<li>Go to Layout [ &ldquo;discoveries&rdquo; (testlearn) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::ktestSubject; $$contact ]</li>
<li>Set Field [ testlearn::kaudienceLocation; $$location ]</li>
<li>Set Field [ testlearn::ktest; $$item ]</li>
<li>Perform Find [  ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Variable [ $number; Value:Get (FoundCount) ]</li>
<li>Loop</li>
<li>Set Field [ testlearn::InspectionItemCountLocation; $number ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#increase number of findings for item</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::ktestSubject; $$contact ]</li>
<li>Set Field [ testlearn::ktest; $$item ]</li>
<li>Set Field [ testlearn::kreportNumber; $$reportNumber ]</li>
<li>Perform Find [  ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Variable [ $number; Value:Get (FoundCount) ]</li>
<li>Loop</li>
<li>Set Field [ testlearn::InspectionItemCount; $number ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#lock item location so it cannot be deleted unless all findings for it are deleted</li>
<li>Go to Layout [ &ldquo;tableTestSubjectFocus&rdquo; (tagTestSubjectLocation) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTestSubjectLocation::_LtestSubjectLocation; $$location ]</li>
<li>Perform Find [  ]</li>
<li>Set Field [ tagTestSubjectLocation::inUse; "t" ]</li>
<li>#refind all location records for this session</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTestSubjectLocation::knode; $$contact ]</li>
<li>Set Field [ tagTestSubjectLocation::ksection; $$Library ]</li>
<li>Set Field [ tagTestSubjectLocation::reportNumber; $$ReportNumber ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#first see if a report record exists for this item</li>
<li>Set Variable [ $$stopLoadReportRecord; Value:1 ]</li>
<li>Go to Layout [ &ldquo;PrintReportEdit&rdquo; (report) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ report::ktestSubject; $$contact ]</li>
<li>Set Field [ report::ktest; $$item ]</li>
<li>Set Field [ report::kreportNumber; $$reportNumber ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>If [ Get (LastError) =  401 ]</li>
<li>#</li>
<li>#create new report record and put in all required information</li>
<li>New Record/Request</li>
<li>Set Field [ report::ktestSubject; $$contact ]</li>
<li>Set Field [ report::ktest; $$item ]</li>
<li>Set Field [ report::kreportNumber; $$reportNumber ]</li>
<li>Set Field [ report::ksection; $$library ]</li>
<li>End If</li>
<li>Set Variable [ $$stopLoadReportRecord ]</li>
<li>Go to Layout [ &ldquo;step3_InspectionItems&rdquo; (InspectItems) ]</li>
<li>Set Field [ InspectItems::gprogressGlobal; "status: in progress" ]</li>
<li>Go to Layout [ &ldquo;step4_InspectionFinding&rdquo; (testlearn) ]</li>
<li>Set Variable [ $id; Value:testlearn::_Ltestlearn ]</li>
<li>Sort Records [ Specified Sort Order: testlearn::Location; ascending
testlearn::_Number; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $ID = testlearn::_Ltestlearn ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Set Field [ testlearn::recordnumberglobal; Get (RecordNumber) ]</li>
<li>Set Field [ testlearn::recordcountglobal; Get (FoundCount) ]</li>
<li>#</li>
<li>#Load new record to set variables.</li>
<li>Set Variable [ $$stopLoadTestRecord ]</li>
<li>Perform Script [ &ldquo;loadTestRecord&rdquo; ]</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearn</em>::ktestSubject</li>
<li>
<em>testlearn</em>::ktest</li>
<li>
<em>testlearn</em>::kreportNumber</li>
<li>
<em>testlearn</em>::InspectionItemCountLocation</li>
<li>
<em>testlearn</em>::kaudienceLocation</li>
<li>
<em>testlearn</em>::InspectionItemCount</li>
<li>
<em>report</em>::ktestSubject</li>
<li>
<em>report</em>::ktest</li>
<li>
<em>report</em>::kreportNumber</li>
<li>
<em>report</em>::ksection</li>
<li>
<em>TEMP</em>::kdefaultNodePrimary</li>
<li>
<em>report</em>::kRecordCreatorNode</li>
<li>
<em>report</em>::RecordModifyDate</li>
<li>
<em>TEMP</em>::kdefaultHealth</li>
<li>
<em>report</em>::khealth</li>
<li>
<em>InspectItems</em>::gprogressGlobal</li>
<li>
<em>testlearn</em>::_Ltestlearn</li>
<li>&lt;Missing Field&gt;</li>
<li>
<em>testlearn</em>::recordnumberglobal</li>
<li>
<em>testlearn</em>::recordcountglobal</li>
<li>
<em>testlearn</em>::kcsection</li>
<li>
<em>testlearn</em>::Location</li>
<li>
<em>testlearn</em>::kRecordCreatorNode</li>
<li>
<em>testlearn</em>::RecordModifyDate</li>
<li>
<em>testlearn</em>::kHealth</li>
<li>
<em>tagTestSubjectLocation</em>::_LtestSubjectLocation</li>
<li>
<em>tagTestSubjectLocation</em>::inUse</li>
<li>
<em>tagTestSubjectLocation</em>::knode</li>
<li>
<em>tagTestSubjectLocation</em>::ksection</li>
<li>
<em>tagTestSubjectLocation</em>::reportNumber</li>
<li>
<em>testlearn</em>::_Number</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32971ScriptAnchor_">loadTestRecord</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>step4_InspectionFinding</li>
<li>PrintReportEdit</li>
<li>step3_InspectionItems</li>
<li>discoveries</li>
<li>tableTestSubjectFocus</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32906ScriptAnchor_"></a><td class="script_navbar"><a href="#32775ScriptAnchor_"><span>Previous Script: [newTestRecord]</span></a></td><td class="script_navbar"><a href="#33317ScriptAnchor_"><span>Parent Folder: [test]</span></a></td><td class="script_navbar"><a href="#32829ScriptAnchor_"><span>Next Script: [gotoTestItem]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">linkTestFocusOrUnlinkTestFocus</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32925ScriptAnchor_">newTestGroup</a></li>
<li><a href="#32926ScriptAnchor_">newTest</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If tag has not yet been selected, then link it.</li>
<li>Set Variable [ $focus; Value:tagLocation::_Ltag ]</li>
<li>Go to Field [  ]</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>If [ $focus &amp; &para; &ne;  FilterValues ( test::kcfocusALL ; $focus &amp; "&para;" ) ]</li>
<li>#</li>
<li>Set Variable [ $currentfocuses; Value:test::kcfocusALL ]</li>
<li>Set Field [ test::kcfocusALL; $focus &amp; "&para;" &amp; $currentfocuses ]</li>
<li>#</li>
<li>#Reset conditional formatting variable for focuses.</li>
<li>Set Variable [ $$focuses; Value:test::kcfocusALL ]</li>
<li>Go to Field [  ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If tag has  been selected, then unlink it.</li>
<li>Set Variable [ $currentfocuses; Value:test::kcfocusALL ]</li>
<li>Set Field [ test::kcfocusALL; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used

If ( ValueCount ( $currentfocuses ) &ne; ValueCount ( Substitute ( $currentfocuses ; $focus &amp; "&para;"  ; "" ) ) ; 

Substitute ( $currentfocuses ; $focus &amp; "&para;"  ; "" ) ; 

Substitute ( $currentfocuses ; $focus ; "" ) 

) ]</li>
<li>#</li>
<li>#Reset conditional formatting variable for focuses.</li>
<li>Set Variable [ $$focuses; Value:test::kcfocusALL ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagLocation</em>::_Ltag</li>
<li>
<em>test</em>::kcfocusALL</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32829ScriptAnchor_"></a><td class="script_navbar"><a href="#32906ScriptAnchor_"><span>Previous Script: [linkTestFocusOrUnlinkTestFocus]</span></a></td><td class="script_navbar"><a href="#33317ScriptAnchor_"><span>Parent Folder: [test]</span></a></td><td class="script_navbar"><a href="#32826ScriptAnchor_"><span>Next Script: [step2_OpenInspectionItemsTEST]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">gotoTestItem</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Set both a variable and temp field with item ID</li>
<li>#or Lock number.  Eventually need to pick one</li>
<li>#or the other, but due to current deadline that</li>
<li>#cleanup will have to come later.</li>
<li>Set Variable [ $$item; Value:InspectItems::_Ltest ]</li>
<li>Set Field [ TEMP::ktest; InspectItems::_Ltest ]</li>
<li>#</li>
<li>#Set initial test item list to check so when user clicks</li>
<li>#on the button next to an item it turns green instead</li>
<li>#inserting its text into the test discovery's text box.</li>
<li>Set Field [ TEMP::textORcheck; "check" ]</li>
<li>#</li>
<li>#Set detail temp fields for use on Tag Menus window.</li>
<li>Set Field [ TEMP::ktestItemList; InspectItems::ktestItemList ]</li>
<li>Set Field [ TEMP::ktestItemListOLD; InspectItems::ktestItemList ]</li>
<li>#</li>
<li>#Prevent test records from loading to speed up</li>
<li>#this script.</li>
<li>Set Variable [ $$stopLoadTestRecord; Value:1 ]</li>
<li>#</li>
<li>#This field does show up elsewhere but I am not</li>
<li>#sure after what it does.  My bad for not making</li>
<li>#thorough comments during earlier developement.</li>
<li>Set Field [ InspectItems::glocationNameGlobal; 
TextStyleAdd ( TEMP::LocationName ; Lowercase ) ]</li>
<li>#</li>
<li>#find and show all test records.</li>
<li>Go to Layout [ &ldquo;step4_InspectionFinding&rdquo; (testlearn) ]</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::ktestSubject; $$contact ]</li>
<li>Set Field [ testlearn::ktest; $$item ]</li>
<li>Set Field [ testlearn::kcsection; $$library ]</li>
<li>Set Field [ testlearn::kreportNumber; $$reportNumber ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Create new test record if there are none.</li>
<li>If [ Get (LastError) =  401 ]</li>
<li>Perform Script [ &ldquo;newTestRecord&rdquo; ]</li>
<li>#</li>
<li>#If there is OK or NA record, change it into a test</li>
<li>#record.  (NA and OK records tell the user they</li>
<li>#have inspected an item and found it OK or not</li>
<li>#needing to be tested.  If OK, the user has decided</li>
<li>#not to record any details.  So a record exist</li>
<li>#but it is not being used to record details.  </li>
<li>#These next steps will turn that non-test record</li>
<li>#into a test record.)</li>
<li>Else If [ Get (FoundCount) = 1 and $$Location = testlearn::kaudienceLocation and testlearn::kreportNumber = $$reportNumber and
testlearn::InspectionItemCountLocation   =  "N/A"  or  

Get (FoundCount) = 1 and $$Location = testlearn::kaudienceLocation and testlearn::kreportNumber = $$reportNumber and
testlearn::InspectionItemCountLocation   =  "OK"  or 

Get (FoundCount) = 1 and $$Location = testlearn::kaudienceLocation and testlearn::kreportNumber = $$reportNumber and
testlearn::InspectionItemCountLocation    =    "★" ]</li>
<li>#</li>
<li>#If there is OK or NA record, change it into a test</li>
<li>#by change NA or OK to 1, as in 1 test record.</li>
<li>Set Field [ testlearn::InspectionItemCountLocation; 1 ]</li>
<li>#</li>
<li>#increase number of test records for item overall</li>
<li>#from zero to 1.</li>
<li>Set Field [ testlearn::InspectionItemCount; 1 ]</li>
<li>Go to Layout [ &ldquo;step4_InspectionFinding&rdquo; (testlearn) ]</li>
<li>End If</li>
<li>#</li>
<li>#Group records by test subject location.</li>
<li>Sort Records [ Specified Sort Order: testlearn::Location; ascending
testlearn::_Number; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#Omit all NA, OK, and star records if any (these</li>
<li>#records function as visual indicators of having</li>
<li>#made a decision not to create a test record</li>
<li>#because NA = it was not applicable, OK=it was</li>
<li>#fine, and star symbol = because a test record</li>
<li>#already created duplicates the finding in this</li>
<li>#test subject location),</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>If [ testlearn::InspectionItemCountLocation   =  "N/A"  or  
testlearn::InspectionItemCountLocation   =  "OK"  or 
testlearn::InspectionItemCountLocation    =    "★" ]</li>
<li>Omit Record</li>
<li>Go to Record/Request/Page
[ Previous ]</li>
<li>End If</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Now go the last test record for this test location</li>
<li>#if any.  It will be conditionally formatted green,</li>
<li>#while other location records will be yellow and</li>
<li>#records from other tests for this item will be blue.</li>
<li>#Blue records indicate a favorite record.</li>
<li>Go to Record/Request/Page
[ Last ]</li>
<li>Loop</li>
<li>Exit Loop If [ testlearn::kaudienceLocation = $$Location ]</li>
<li>Go to Record/Request/Page
[ Previous; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Set the numbers for the navigation arrows</li>
<li>#at the top of the screen: record # / total #.</li>
<li>Set Field [ testlearn::recordnumberglobal; Get (RecordNumber) ]</li>
<li>Set Field [ testlearn::recordcountglobal; Get (FoundCount) ]</li>
<li>#</li>
<li>#Conditionally format current test record and tags.</li>
<li>Set Variable [ $$stopLoadTestRecord ]</li>
<li>Perform Script [ &ldquo;loadTestRecord&rdquo; ]</li>
<li>Set Variable [ $$testItem; Value:testlearn::kctestItem ]</li>
<li>#</li>
<li>#Find all details for this item.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Perform Script [ &ldquo;menuTestItem&rdquo; ]</li>
<li>#</li>
<li>#Return focus to Test window.</li>
<li>Select Window [ Name: "Test"; Current file ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>InspectItems</em>::_Ltest</li>
<li>
<em>TEMP</em>::ktest</li>
<li>
<em>TEMP</em>::textORcheck</li>
<li>
<em>InspectItems</em>::ktestItemList</li>
<li>
<em>TEMP</em>::ktestItemList</li>
<li>
<em>TEMP</em>::ktestItemListOLD</li>
<li>
<em>TEMP</em>::LocationName</li>
<li>
<em>InspectItems</em>::glocationNameGlobal</li>
<li>
<em>testlearn</em>::ktestSubject</li>
<li>
<em>testlearn</em>::ktest</li>
<li>
<em>testlearn</em>::kcsection</li>
<li>
<em>testlearn</em>::kreportNumber</li>
<li>
<em>testlearn</em>::kaudienceLocation</li>
<li>
<em>testlearn</em>::InspectionItemCountLocation</li>
<li>
<em>testlearn</em>::InspectionItemCount</li>
<li>
<em>testlearn</em>::Location</li>
<li>
<em>testlearn</em>::_Number</li>
<li>
<em>testlearn</em>::recordnumberglobal</li>
<li>
<em>testlearn</em>::recordcountglobal</li>
<li>
<em>testlearn</em>::kctestItem</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32775ScriptAnchor_">newTestRecord</a></li>
<li><a href="#32971ScriptAnchor_">loadTestRecord</a></li>
<li><a href="#33071ScriptAnchor_">menuTestItem</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>step4_InspectionFinding</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32826ScriptAnchor_"></a><td class="script_navbar"><a href="#32829ScriptAnchor_"><span>Previous Script: [gotoTestItem]</span></a></td><td class="script_navbar"><a href="#33317ScriptAnchor_"><span>Parent Folder: [test]</span></a></td><td class="script_navbar"><a href="#33138ScriptAnchor_"><span>Next Script: [loadItemRecord]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">step2_OpenInspectionItemsTEST</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Variable [ $$TSRecordNumber; Value:Get (RecordNumber) ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>If [ TEMP::ksection = "" ]</li>
<li>Go to Field [ TEMP::ksection ]
[ Select/perform ]</li>
<li>Halt Script</li>
<li>Else If [ TEMP::reportNumber = "" ]</li>
<li>Go to Field [ TEMP::reportNumber ]
[ Select/perform ]</li>
<li>Halt Script</li>
<li>Else If [ tagTestSubjectLocation::focusName = "" ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Set Field [ TEMP::kdefaultNodeTestSubject; tagTestSubjectLocation::knode ]</li>
<li>Set Field [ tagTestSubjectLocation::TimeStart; Get ( CurrentTime ) ]</li>
<li>Set Variable [ $status; Value:tagTestSubjectLocation::inUse ]</li>
<li>Set Variable [ $$timeRecord; Value:Get ( RecordNumber ) ]</li>
<li>Set Variable [ $$library; Value:TEMP::ksection ]</li>
<li>#</li>
<li>#!!!need to go through database and remove all variables like $$reportnumber that are used in mulitple scripts and make it a temp field.</li>
<li>Set Variable [ $$reportnumber; Value:tagTestSubjectLocation::reportNumber ]</li>
<li>Set Field [ TEMP::reportNumber; tagTestSubjectLocation::reportNumber ]</li>
<li>Set Variable [ $$contact; Value:TEMP::kdefaultNodeTestSubject ]</li>
<li>#</li>
<li>#note general or canned location user identified</li>
<li>Set Variable [ $$locationName; Value:tagTestSubjectLocation::focusName ]</li>
<li>Set Field [ TEMP::LocationName; TextStyleAdd ( $$locationName ; Titlecase ) ]</li>
<li>#</li>
<li>#note new location ID number and name user created for this specific location in the contact's building</li>
<li>Set Variable [ $$location; Value:tagTestSubjectLocation::_LtestSubjectLocation ]</li>
<li>Set Variable [ $$itemLocation; Value:tagTestSubjectLocation::kfocus ]</li>
<li>#</li>
<li>#Goto no tag layout in Tag Menus as this next</li>
<li>#main screen is for selection only.  It does not</li>
<li>#show any records that the user might want to</li>
<li>#tag.  I thought about closing the Tag Menus</li>
<li>#window, but in testing it was odd, and so better</li>
<li>#just to keep the window open and show no tags</li>
<li>#but do change its layout to the look and feel</li>
<li>#of the layouts the user will see in test mode</li>
<li>#in the Tag Menus window.</li>
<li>Go to Layout [ &ldquo;testMenuNoTag&rdquo; (TEMP) ]</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>#</li>
<li>Set Field [ TEMP::testerAndsubject; //tagDefaultNodePrimary::tag &amp; " testing "  &amp; &para; &amp; $testsubjectName  &amp; "'s"&amp; &para;  &amp; tempSetup::sectionName

//$testsubjectName  &amp; &para; &amp; $$locationName  &amp;  &para; &amp;  tempSetup::sectionName

//tempSetup::sectionName &amp; " | " &amp;  $testsubjectName

tempSetup::sectionName &amp; " | " &amp;  tagDefaultTestSubject::tag ]</li>
<li>Set Window Title [ Current Window; New Title: "Test" ]</li>
<li>Go to Layout [ &ldquo;step3_InspectionItems&rdquo; (InspectItems) ]</li>
<li>Enter Find Mode [  ]</li>
<li>#</li>
<li>#now find and show all canned inspection items associated with this generic canned location</li>
<li>Set Field [ InspectItems::kcfocusALL; $$itemLocation ]</li>
<li>Perform Find [  ]</li>
<li>If [ Get ( LastError ) = 401 ]</li>
<li>Go to Layout [ &ldquo;defaultTest&rdquo; (tagTestSubjectLocation) ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "No items have been assigned to this area for assessment."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>//  If [ PatternCount ( Get ( ApplicationVersion ) ; "GO" ) = "GO" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTestInpsection::name; ascending
InspectItems::order; based on value list: &ldquo;order&rdquo; ]
[ Restore; No dialog ]</li>
<li>Set Field [ InspectItems::glocationNameGlobal; $$locationName ]</li>
<li>Set Field [ InspectItems::kgaudienceLocation; $$location ]</li>
<li>Set Field [ InspectItems::gcontactNameGlobal; $$testsubjectName ]</li>
<li>Set Field [ InspectItems::kgreportNumber; $$reportNumber ]</li>
<li>Set Field [ InspectItems::kgtester; TEMP::kdefaultNodeTestSubject ]</li>
<li>If [ $status = "" ]</li>
<li>Set Field [ InspectItems::gprogressGlobal; "status: pending" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ $status = "t" ]</li>
<li>Set Field [ InspectItems::gprogressGlobal; "status: in progress" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Set Field [ InspectItems::gprogressGlobal; "status: done" ]</li>
<li>Scroll Window
[ Home ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>TEMP</em>::reportNumber</li>
<li>
<em>tagTestSubjectLocation</em>::focusName</li>
<li>
<em>tagTestSubjectLocation</em>::knode</li>
<li>
<em>TEMP</em>::kdefaultNodeTestSubject</li>
<li>
<em>tagTestSubjectLocation</em>::TimeStart</li>
<li>
<em>tagTestSubjectLocation</em>::inUse</li>
<li>
<em>tagTestSubjectLocation</em>::reportNumber</li>
<li>
<em>TEMP</em>::LocationName</li>
<li>
<em>tagTestSubjectLocation</em>::_LtestSubjectLocation</li>
<li>
<em>tagTestSubjectLocation</em>::kfocus</li>
<li>
<em>tempSetup</em>::sectionName</li>
<li>
<em>tagDefaultTestSubject</em>::tag</li>
<li>
<em>TEMP</em>::testerAndsubject</li>
<li>
<em>InspectItems</em>::kcfocusALL</li>
<li>
<em>ruleTestInpsection</em>::name</li>
<li>
<em>InspectItems</em>::order</li>
<li>
<em>InspectItems</em>::glocationNameGlobal</li>
<li>
<em>InspectItems</em>::kgaudienceLocation</li>
<li>
<em>InspectItems</em>::gcontactNameGlobal</li>
<li>
<em>InspectItems</em>::kgreportNumber</li>
<li>
<em>InspectItems</em>::kgtester</li>
<li>
<em>InspectItems</em>::gprogressGlobal</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>testMenuNoTag</li>
<li>step3_InspectionItems</li>
<li>defaultTest</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33138ScriptAnchor_"></a><td class="script_navbar"><a href="#32826ScriptAnchor_"><span>Previous Script: [step2_OpenInspectionItemsTEST]</span></a></td><td class="script_navbar"><a href="#33317ScriptAnchor_"><span>Parent Folder: [test]</span></a></td><td class="script_navbar"><a href="#32841ScriptAnchor_"><span>Next Script: [step3_OpenOneItemJustLook]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">loadItemRecord</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>Set Variable [ $$thing; Value:InspectItems::ktestGroup ]</li>
<li>Set Variable [ $$item; Value:InspectItems::_Ltest ]</li>
<li>Set Variable [ $$itemName; Value:InspectItems::testName ]</li>
<li>Set Field [ TEMP::testName; InspectItems::testName ]</li>
<li>Set Field [ TEMP::ktest; InspectItems::_Ltest ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>InspectItems</em>::ktestGroup</li>
<li>
<em>InspectItems</em>::_Ltest</li>
<li>
<em>InspectItems</em>::testName</li>
<li>
<em>TEMP</em>::testName</li>
<li>
<em>TEMP</em>::ktest</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32841ScriptAnchor_"></a><td class="script_navbar"><a href="#33138ScriptAnchor_"><span>Previous Script: [loadItemRecord]</span></a></td><td class="script_navbar"><a href="#33317ScriptAnchor_"><span>Parent Folder: [test]</span></a></td><td class="script_navbar"><a href="#32840ScriptAnchor_"><span>Next Script: [returnToStep3]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">step3_OpenOneItemJustLook</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#</li>
<li>If [ tlResults::InspectionItemCount &ne; "" ]</li>
<li>#note item's ID number and name</li>
<li>Set Variable [ $$item; Value:InspectItems::_Ltest ]</li>
<li>#</li>
<li>Go to Layout [ &ldquo;step4_InspectionFinding&rdquo; (testlearn) ]</li>
<li>Enter Find Mode [  ]</li>
<li>#</li>
<li>#find and show all inspection findings</li>
<li>Set Field [ testlearn::ktestSubject; $$contact ]</li>
<li>Set Field [ testlearn::ktest; $$item ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: testlearn::&lt;Field Missing&gt;; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>If [ testlearn::InspectionItemCountLocation   =  "N/A"  or  
testlearn::InspectionItemCountLocation   =  "OK"  or 
testlearn::InspectionItemCountLocation    =    "★" ]</li>
<li>Omit Record</li>
<li>Go to Record/Request/Page
[ Previous ]</li>
<li>End If</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Go to Record/Request/Page
[ Last ]</li>
<li>Loop</li>
<li>Exit Loop If [ testlearn::&lt;Field Missing&gt; = $$Location ]</li>
<li>Go to Record/Request/Page
[ Previous; Exit after last ]</li>
<li>End Loop</li>
<li>Set Field [ testlearn::recordnumberglobal; Get (RecordNumber) ]</li>
<li>Set Field [ testlearn::recordcountglobal; Get (FoundCount) ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tlResults</em>::InspectionItemCount</li>
<li>
<em>InspectItems</em>::_Ltest</li>
<li>
<em>testlearn</em>::ktestSubject</li>
<li>
<em>testlearn</em>::ktest</li>
<li>&lt;Missing Field&gt;</li>
<li>
<em>testlearn</em>::InspectionItemCountLocation</li>
<li>
<em>testlearn</em>::recordnumberglobal</li>
<li>
<em>testlearn</em>::recordcountglobal</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>step4_InspectionFinding</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32840ScriptAnchor_"></a><td class="script_navbar"><a href="#32841ScriptAnchor_"><span>Previous Script: [step3_OpenOneItemJustLook]</span></a></td><td class="script_navbar"><a href="#33317ScriptAnchor_"><span>Parent Folder: [test]</span></a></td><td class="script_navbar"><a href="#32844ScriptAnchor_"><span>Next Script: [done]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">returnToStep3</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>//  Set Field [ InspectItems::glocationNameGlobal; $$contactName  &amp; ": " &amp; $$locationName ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Go to Layout [ &ldquo;testMenuNoTag&rdquo; (TEMP) ]</li>
<li>Select Window [ Name: "Test"; Current file ]</li>
<li>Set Field [ TEMP::showFavorites; "" ]</li>
<li>Go to Layout [ &ldquo;step3_InspectionItems&rdquo; (InspectItems) ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>InspectItems</em>::glocationNameGlobal</li>
<li>
<em>TEMP</em>::showFavorites</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>testMenuNoTag</li>
<li>step3_InspectionItems</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32844ScriptAnchor_"></a><td class="script_navbar"><a href="#32840ScriptAnchor_"><span>Previous Script: [returnToStep3]</span></a></td><td class="script_navbar"><a href="#33317ScriptAnchor_"><span>Parent Folder: [test]</span></a></td><td class="script_navbar"><a href="#32837ScriptAnchor_"><span>Next Script: [delete_Evidence]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">done</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Freeze Window</li>
<li>Go to Layout [ &ldquo;discoveries&rdquo; (testlearn) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::ktestSubject; $$contact ]</li>
<li>Set Field [ testlearn::kaudienceLocation; $$location ]</li>
<li>Set Field [ InspectItems::kcfocusALL; $$itemLocation ]</li>
<li>Perform Find [  ]</li>
<li>If [ Get ( LastError ) = 401 ]</li>
<li>Go to Layout [ &ldquo;step3_InspectionItems&rdquo; (InspectItems) ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Go to Layout [ &ldquo;tableTestSubjectFocus&rdquo; (tagTestSubjectLocation) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTestSubjectLocation::_LtestSubjectLocation; $$location ]</li>
<li>Perform Find [  ]</li>
<li>If [ tagTestSubjectLocation::inUse = "t" ]</li>
<li>Set Field [ tagTestSubjectLocation::inUse; "d" ]</li>
<li>Go to Layout [ &ldquo;step3_InspectionItems&rdquo; (InspectItems) ]</li>
<li>Set Field [ InspectItems::gprogressGlobal; "status: done" ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Set Field [ tagTestSubjectLocation::inUse; "t" ]</li>
<li>Go to Layout [ &ldquo;step3_InspectionItems&rdquo; (InspectItems) ]</li>
<li>Set Field [ InspectItems::gprogressGlobal; "status: in progress" ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearn</em>::ktestSubject</li>
<li>
<em>testlearn</em>::kaudienceLocation</li>
<li>
<em>InspectItems</em>::kcfocusALL</li>
<li>
<em>tagTestSubjectLocation</em>::_LtestSubjectLocation</li>
<li>
<em>tagTestSubjectLocation</em>::inUse</li>
<li>
<em>InspectItems</em>::gprogressGlobal</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>discoveries</li>
<li>step3_InspectionItems</li>
<li>tableTestSubjectFocus</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32837ScriptAnchor_"></a><td class="script_navbar"><a href="#32844ScriptAnchor_"><span>Previous Script: [done]</span></a></td><td class="script_navbar"><a href="#33317ScriptAnchor_"><span>Parent Folder: [test]</span></a></td><td class="script_navbar"><a href="#32843ScriptAnchor_"><span>Next Script: [OKonInpsection]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">delete_Evidence</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>If [ testlearn::_Ltestlearn = "" ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Set Variable [ $delete; Value:testlearn::_Ltestlearn ]</li>
<li>Set Variable [ $record; Value:Get (RecordNumber) ]</li>
<li>Set Variable [ $TempLocation; Value:testlearn::kaudienceLocation ]</li>
<li>Set Variable [ $TempReportNumber; Value:testlearn::kreportNumber ]</li>
<li>Set Variable [ $TempContact; Value:testlearn::ktestSubject ]</li>
<li>Set Variable [ $$step3_OpenOneItem; Value:1 ]</li>
<li>Go to Field [  ]</li>
<li>Refresh Window</li>
<li>//  If [ $TempLocation  =  $$location ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Delete evidence number "  &amp; testlearn::_Number  &amp; " ?"; Buttons: &ldquo;Cancel&rdquo;, &ldquo;Delete&rdquo; ]</li>
<li>#THIS IS DISABLED AND SHOULD EVENTUALLY</li>
<li>#BE DELETED AFTER TESTING.  THERE USE TO BE</li>
<li>#A FAVORITE FIELD THAT HAS BEEN REMOVED.</li>
<li>#SEE EARLIER VERSIONS FOR HOW THIS FUNCTIONED.</li>
<li>#IN SHORT, IT DID WHAT MAKE INFO BUTTON</li>
<li>#NOW DOES.</li>
<li>//  Else If [ $TempLocation &ne; $$location ]</li>
<li>//  Show Custom Dialog [ Title: "!"; Message: "Delete evidence number "  &amp; testlearn::_Number  &amp; " ?  NOTE: This piece of evidence belongs to "  &amp; tagTLTestSubject::&lt;Field Missing&gt; &amp; "' evidence collection number " &amp; testlearn::kreportNumber  &amp; " ."; Buttons: &ldquo;Cancel&rdquo;, &ldquo;Delete&rdquo; ]</li>
<li>//  End If</li>
<li>If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Variable [ $$stopLoadTestRecord; Value:1 ]</li>
<li>#user may be showing favorites, so first make sure</li>
<li>#only this reports records are showing in case this is</li>
<li>#the last record for this item in which case the report</li>
<li>#page for this item also needs to be deleted.</li>
<li>If [ $TempLocation  =  $$location ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::ktest; $$item ]</li>
<li>Set Field [ testlearn::kreportNumber; $TempReportNumber ]</li>
<li>Set Field [ testlearn::ktestSubject; $TempContact ]</li>
<li>Perform Find [  ]</li>
<li>End If</li>
<li>Go to Record/Request/Page
[ Last ]</li>
<li>If [ Get (RecordNumber) = 1 ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>Go to Layout [ &ldquo;PrintReportEdit&rdquo; (report) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ report::ktestSubject; $TempContact ]</li>
<li>Set Field [ report::ktest; $$item ]</li>
<li>Set Field [ report::kreportNumber; $TempReportNumber ]</li>
<li>Set Field [ report::ksection; $$Library ]</li>
<li>Perform Find [  ]</li>
<li>Delete All Records
[ No dialog ]</li>
<li>Set Variable [ $delete ]</li>
<li>#Unlock Item Location IF this was the last item</li>
<li>Go to Layout [ &ldquo;discoveries&rdquo; (testlearn) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kaudienceLocation; $TempLocation ]</li>
<li>Set Field [ testlearn::kreportNumber; $TempReportNumber ]</li>
<li>Perform Find [  ]</li>
<li>If [ Get ( LastError ) = 401 ]</li>
<li>Go to Layout [ &ldquo;tableTestSubjectFocus&rdquo; (tagTestSubjectLocation) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTestSubjectLocation::_LtestSubjectLocation; $TempLocation ]</li>
<li>Set Field [ tagTestSubjectLocation::reportNumber; $TempReportNumber ]</li>
<li>Perform Find [  ]</li>
<li>Set Field [ tagTestSubjectLocation::inUse; "" ]</li>
<li>#refind all location records for current library report number</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTestSubjectLocation::knode; $TempContact ]</li>
<li>Set Field [ tagTestSubjectLocation::reportNumber; $$reportNumber ]</li>
<li>Set Field [ tagTestSubjectLocation::ksection; $$Library ]</li>
<li>Perform Find [  ]</li>
<li>Go to Layout [ &ldquo;step3_InspectionItems&rdquo; (InspectItems) ]</li>
<li>If [ InspectItems::kgaudienceLocation = $TempLocation ]</li>
<li>Set Field [ InspectItems::gprogressGlobal; "status: pending" ]</li>
<li>End If</li>
<li>End If</li>
<li>Go to Layout [ &ldquo;step3_InspectionItems&rdquo; (InspectItems) ]</li>
<li>Set Field [ InspectItems::glocationNameGlobal; $$locationName ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Go to Record/Request/Page [ $record ]
[ No dialog ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>#THIS IS DISABLED AND SHOULD EVENTUALLY</li>
<li>#BE DELETED AFTER TESTING.  THERE USE TO BE</li>
<li>#A FAVORITE FIELD THAT HAS BEEN REMOVED.</li>
<li>#SEE EARLIER VERSIONS FOR HOW THIS FUNCTIONED.</li>
<li>#IN SHORT, IT DID WHAT MAKE INFO BUTTON</li>
<li>#NOW DOES.</li>
<li>//  #If this is a favorite item and it is the only one then delete the report page created for it.</li>
<li>//  If [ $TempLocation &ne; $$location ]</li>
<li>//  Enter Find Mode [  ]</li>
<li>//  Set Field [ testlearn::ktest; $$item ]</li>
<li>//  Set Field [ testlearn::kreportNumber; $TempReportNumber ]</li>
<li>//  Set Field [ testlearn::ktestSubject; $TempContact ]</li>
<li>//  Perform Find [  ]</li>
<li>//  If [ Get (LastError) = 401 ]</li>
<li>//  Go to Layout [ &ldquo;PrintReportEdit&rdquo; (report) ]</li>
<li>//  Enter Find Mode [  ]</li>
<li>//  Set Field [ report::ktestSubject; $TempContact ]</li>
<li>//  Set Field [ report::ktest; $$item ]</li>
<li>//  Set Field [ report::kreportNumber; $TempReportNumber ]</li>
<li>//  Set Field [ report::ksection; $$Library ]</li>
<li>//  Perform Find [  ]</li>
<li>//  Delete All Records
[ No dialog ]</li>
<li>//  Set Variable [ $delete ]</li>
<li>//  End If</li>
<li>//  End If</li>
<li>#GET ID INFO as is from different location</li>
<li>#Unlock Item Location</li>
<li>#zero out findings for item for this contact's location</li>
<li>#</li>
<li>#decrease number of findings for item for this contact's location</li>
<li>Go to Layout [ &ldquo;discoveries&rdquo; (testlearn) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kaudienceLocation; $TempLocation ]</li>
<li>Set Field [ testlearn::kreportNumber; $TempReportNumber ]</li>
<li>Perform Find [  ]</li>
<li>#Unlock Item Location</li>
<li>If [ Get ( LastError ) = 401 ]</li>
<li>Go to Layout [ &ldquo;tableTestSubjectFocus&rdquo; (tagTestSubjectLocation) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTestSubjectLocation::_LtestSubjectLocation; $TempLocation ]</li>
<li>Perform Find [  ]</li>
<li>Set Field [ tagTestSubjectLocation::inUse; "" ]</li>
<li>#refind all location records for this session</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTestSubjectLocation::knode; $$contact ]</li>
<li>Set Field [ tagTestSubjectLocation::reportNumber; $$reportNumber ]</li>
<li>Set Field [ tagTestSubjectLocation::ksection; $$Library ]</li>
<li>Perform Find [  ]</li>
<li>Go to Layout [ &ldquo;step3_InspectionItems&rdquo; (InspectItems) ]</li>
<li>If [ InspectItems::kgaudienceLocation = $TempLocation ]</li>
<li>Set Field [ InspectItems::gprogressGlobal; "status: pending" ]</li>
<li>End If</li>
<li>Else If [ Get (LastError)  &ne; 401 ]</li>
<li>Go to Layout [ &ldquo;step4_InspectionFinding&rdquo; (testlearn) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::ktest; $$item ]</li>
<li>Set Field [ testlearn::kaudienceLocation; $TempLocation ]</li>
<li>Set Field [ testlearn::kreportNumber; $TempReportNumber ]</li>
<li>Perform Find [  ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Variable [ $number; Value:Get (FoundCount) ]</li>
<li>Loop</li>
<li>Set Field [ testlearn::InspectionItemCountLocation; $number ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>End If</li>
<li>Go to Layout [ &ldquo;step4_InspectionFinding&rdquo; (testlearn) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::ktest; $$item ]</li>
<li>Set Field [ testlearn::kreportNumber; $TempReportNumber ]</li>
<li>Set Field [ testlearn::ktestSubject; $TempContact ]</li>
<li>Perform Find [  ]</li>
<li>Set Variable [ $number; Value:Get (FoundCount) ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ testlearn::InspectionItemCount; $number ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#THIS IS DISABLED AND SHOULD EVENTUALLY</li>
<li>#BE DELETED AFTER TESTING.  THERE USE TO BE</li>
<li>#A FAVORITE FIELD THAT HAS BEEN REMOVED.</li>
<li>#SEE EARLIER VERSIONS FOR HOW THIS FUNCTIONED.</li>
<li>#IN SHORT, IT DID WHAT MAKE INFO BUTTON</li>
<li>#NOW DOES.</li>
<li>//  If [ $TempLocation &ne; $$location ]</li>
<li>//  Enter Find Mode [  ]</li>
<li>//  Set Field [ testlearn::ktestSubject; $$contact ]</li>
<li>//  Set Field [ testlearn::ktest; $$item ]</li>
<li>//  Set Field [ testlearn::kreportNumber; $$reportNumber ]</li>
<li>//  Perform Find [  ]</li>
<li>//  #since this was a favorite record that was deleted, show any favorite records that remain</li>
<li>//  Enter Find Mode [  ]</li>
<li>//  Set Field [ testlearn::ktest; $$item ]</li>
<li>//  Extend Found Set [  ]</li>
<li>//  Sort Records [ Specified Sort Order: testlearn::kcsection; ascending
testlearn::kreportNumber; ascending ]
[ Restore; No dialog ]</li>
<li>//  Go to Record/Request/Page
[ Last ]</li>
<li>//  End If</li>
<li>Set Field [ testlearn::recordnumberglobal; Get (RecordNumber) ]</li>
<li>Set Field [ testlearn::recordcountglobal; Get (FoundCount) ]</li>
<li>Go to Layout [ &ldquo;step4_InspectionFinding&rdquo; (testlearn) ]</li>
<li>#</li>
<li>#</li>
<li>#Load new record to set variables.</li>
<li>Set Variable [ $$stopLoadTestRecord ]</li>
<li>Perform Script [ &ldquo;loadTestRecord&rdquo; ]</li>
<li>#</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Set Variable [ $delete ]</li>
<li>Set Variable [ $$step3_OpenOneItem ]</li>
<li>Refresh Window</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearn</em>::_Ltestlearn</li>
<li>
<em>testlearn</em>::kaudienceLocation</li>
<li>
<em>testlearn</em>::kreportNumber</li>
<li>
<em>testlearn</em>::ktestSubject</li>
<li>
<em>testlearn</em>::_Number</li>
<li>
<em>testlearn</em>::ktest</li>
<li>
<em>report</em>::ktestSubject</li>
<li>
<em>report</em>::ktest</li>
<li>
<em>report</em>::kreportNumber</li>
<li>
<em>report</em>::ksection</li>
<li>
<em>tagTestSubjectLocation</em>::_LtestSubjectLocation</li>
<li>
<em>tagTestSubjectLocation</em>::reportNumber</li>
<li>
<em>tagTestSubjectLocation</em>::inUse</li>
<li>
<em>tagTestSubjectLocation</em>::knode</li>
<li>
<em>tagTestSubjectLocation</em>::ksection</li>
<li>
<em>InspectItems</em>::kgaudienceLocation</li>
<li>
<em>InspectItems</em>::gprogressGlobal</li>
<li>
<em>InspectItems</em>::glocationNameGlobal</li>
<li>
<em>testlearn</em>::InspectionItemCountLocation</li>
<li>
<em>testlearn</em>::InspectionItemCount</li>
<li>
<em>testlearn</em>::kcsection</li>
<li>
<em>testlearn</em>::recordnumberglobal</li>
<li>
<em>testlearn</em>::recordcountglobal</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32971ScriptAnchor_">loadTestRecord</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>PrintReportEdit</li>
<li>discoveries</li>
<li>tableTestSubjectFocus</li>
<li>step3_InspectionItems</li>
<li>step4_InspectionFinding</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32843ScriptAnchor_"></a><td class="script_navbar"><a href="#32837ScriptAnchor_"><span>Previous Script: [delete_Evidence]</span></a></td><td class="script_navbar"><a href="#33317ScriptAnchor_"><span>Parent Folder: [test]</span></a></td><td class="script_navbar"><a href="#32898ScriptAnchor_"><span>Next Script: [OKonReport]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">OKonInpsection</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ testlearn::OK = "" ]</li>
<li>Set Field [ testlearn::OK; TextSize ( "☺" ; 42 ) ]</li>
<li>Go to Field [  ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ testlearn::OK = "☺" ]</li>
<li>Set Field [ testlearn::OK; 
TextSize ( "⚇"; 50 ) ]</li>
<li>Go to Field [  ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ testlearn::OK = "⚇" ]</li>
<li>Set Field [ testlearn::OK; "☹" ]</li>
<li>Go to Field [  ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Set Field [ testlearn::OK; "" ]</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearn</em>::OK</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32898ScriptAnchor_"></a><td class="script_navbar"><a href="#32843ScriptAnchor_"><span>Previous Script: [OKonInpsection]</span></a></td><td class="script_navbar"><a href="#33317ScriptAnchor_"><span>Parent Folder: [test]</span></a></td><td class="script_navbar"><a href="#32834ScriptAnchor_"><span>Next Script: [inspectNextRecord]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">OKonReport</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ testlearnReportTags::OK = "" ]</li>
<li>Set Field [ testlearnReportTags::OK; TextSize ( "☺" ; 30 ) ]</li>
<li>Go to Field [  ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ testlearnReportTags::OK = "☺" ]</li>
<li>Set Field [ testlearnReportTags::OK; 
TextStyleAdd ( TextSize ( "⚇"; 75 ) ; Superscript ) ]</li>
<li>Go to Field [  ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ testlearnReportTags::OK = "⚇" ]</li>
<li>Set Field [ testlearnReportTags::OK; "☹" ]</li>
<li>Go to Field [  ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Set Field [ testlearnReportTags::OK; "" ]</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearnReportTags</em>::OK</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32834ScriptAnchor_"></a><td class="script_navbar"><a href="#32898ScriptAnchor_"><span>Previous Script: [OKonReport]</span></a></td><td class="script_navbar"><a href="#33317ScriptAnchor_"><span>Parent Folder: [test]</span></a></td><td class="script_navbar"><a href="#32835ScriptAnchor_"><span>Next Script: [inspectPreviousRecord]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">inspectNextRecord</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Go to Field [  ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>Set Field [ testlearn::recordnumberglobal; Get (RecordNumber) ]</li>
<li>Set Field [ testlearn::recordcountglobal; Get (FoundCount) ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearn</em>::recordnumberglobal</li>
<li>
<em>testlearn</em>::recordcountglobal</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32835ScriptAnchor_"></a><td class="script_navbar"><a href="#32834ScriptAnchor_"><span>Previous Script: [inspectNextRecord]</span></a></td><td class="script_navbar"><a href="#33317ScriptAnchor_"><span>Parent Folder: [test]</span></a></td><td class="script_navbar"><a href="#32839ScriptAnchor_"><span>Next Script: [itemNA]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">inspectPreviousRecord</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Go to Field [  ]</li>
<li>Go to Record/Request/Page
[ Previous ]</li>
<li>Set Field [ testlearn::recordnumberglobal; Get (RecordNumber) ]</li>
<li>Set Field [ testlearn::recordcountglobal; Get (FoundCount) ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearn</em>::recordnumberglobal</li>
<li>
<em>testlearn</em>::recordcountglobal</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32839ScriptAnchor_"></a><td class="script_navbar"><a href="#32835ScriptAnchor_"><span>Previous Script: [inspectPreviousRecord]</span></a></td><td class="script_navbar"><a href="#33317ScriptAnchor_"><span>Parent Folder: [test]</span></a></td><td class="script_navbar"><a href="#32836ScriptAnchor_"><span>Next Script: [inspectAddProblemToFinding]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">itemNA</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>If [ tlResults::_Ltestlearn = "" ]</li>
<li>Freeze Window</li>
<li>New Window [  ]</li>
<li>#note item's ID number and name</li>
<li>Set Variable [ $$item; Value:InspectItems::_Ltest ]</li>
<li>Set Variable [ $$itemName; Value:InspectItems::testName ]</li>
<li>Set Field [ TEMP::testName ]</li>
<li>Go to Layout [ &ldquo;discoveries&rdquo; (testlearn) ]</li>
<li>New Record/Request</li>
<li>Set Field [ testlearn::ktestSubject; TEMP::kdefaultNodeTestSubject ]</li>
<li>Set Field [ testlearn::kaudienceLocation; $$location ]</li>
<li>Set Field [ testlearn::kreportNumber; $$reportNumber ]</li>
<li>Set Field [ testlearn::Location; $$locationName ]</li>
<li>Set Field [ testlearn::kcsection; $$Library ]</li>
<li>Set Field [ testlearn::ktest; $$item ]</li>
<li>#lock item location so it cannot be deleted unless all findings for it are deleted</li>
<li>Go to Layout [ &ldquo;tableTestSubjectFocus&rdquo; (tagTestSubjectLocation) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTestSubjectLocation::_LtestSubjectLocation; $$location ]</li>
<li>Perform Find [  ]</li>
<li>Set Field [ tagTestSubjectLocation::inUse; "t" ]</li>
<li>#refind all location records for this session</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTestSubjectLocation::knode; TEMP::kdefaultNodeTestSubject ]</li>
<li>Perform Find [  ]</li>
<li>Go to Layout [ &ldquo;step3_InspectionItems&rdquo; (InspectItems) ]</li>
<li>Set Field [ tlResults::InspectionItemCountLocation; "N/A" ]</li>
<li>Set Field [ InspectItems::gprogressGlobal; "status: in progress" ]</li>
<li>Go to Field [  ]</li>
<li>Close Window [ Current Window ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ tlResults::InspectionItemCountLocation  =  "" and 
tlResults::_Ltestlearn &ne; "" ]</li>
<li>Set Field [ tlResults::InspectionItemCountLocation; "N/A" ]</li>
<li>Go to Layout [ &ldquo;step3_InspectionItems&rdquo; (InspectItems) ]</li>
<li>Set Field [ InspectItems::gprogressGlobal; "status: in progress" ]</li>
<li>Set Field [ TEMP::testName ]</li>
<li>Go to Field [  ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ tlResults::InspectionItemCountLocation  =  "N/A" ]</li>
<li>Set Field [ tlResults::InspectionItemCountLocation; "OK" ]</li>
<li>Go to Layout [ &ldquo;step3_InspectionItems&rdquo; (InspectItems) ]</li>
<li>Set Field [ InspectItems::gprogressGlobal; "status: in progress" ]</li>
<li>Set Field [ TEMP::testName ]</li>
<li>Go to Field [  ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ tlResults::InspectionItemCountLocation  =  "N/A" or 
tlResults::InspectionItemCountLocation  =  "OK" ]</li>
<li>If [ TLResultsOnReport::InspectionItemCount = "" ]</li>
<li>Set Field [ TEMP::testName ]</li>
<li>Show Custom Dialog [ Title: "FYI"; Message: "Use the star symbol to referr to other assessment findings.  You currently do not have any for this item."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Set Field [ tlResults::InspectionItemCountLocation; "" ]</li>
<li>Go to Field [  ]</li>
<li>Freeze Window</li>
<li>New Window [  ]</li>
<li>#note item's ID number and name</li>
<li>Set Variable [ $$item; Value:InspectItems::_Ltest ]</li>
<li>Go to Layout [ &ldquo;discoveries&rdquo; (testlearn) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::ktestSubject; TEMP::kdefaultNodeTestSubject ]</li>
<li>Set Field [ testlearn::kaudienceLocation; $$location ]</li>
<li>Set Field [ testlearn::ktest; $$item ]</li>
<li>Perform Find [  ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>#Unlock Item Location</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::ktestSubject; TEMP::kdefaultNodeTestSubject ]</li>
<li>Set Field [ testlearn::kaudienceLocation; $$location ]</li>
<li>Perform Find [  ]</li>
<li>If [ Get ( LastError ) = 401 ]</li>
<li>Go to Layout [ &ldquo;tableTestSubjectFocus&rdquo; (tagTestSubjectLocation) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTestSubjectLocation::_LtestSubjectLocation; $$location ]</li>
<li>Perform Find [  ]</li>
<li>Set Field [ tagTestSubjectLocation::inUse; "" ]</li>
<li>#refind all location records for this session</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTestSubjectLocation::knode; TEMP::kdefaultNodeTestSubject ]</li>
<li>Perform Find [  ]</li>
<li>Go to Layout [ &ldquo;step3_InspectionItems&rdquo; (InspectItems) ]</li>
<li>Set Field [ InspectItems::gprogressGlobal; "status: pending" ]</li>
<li>End If</li>
<li>Close Window [ Current Window ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Set Field [ tlResults::InspectionItemCountLocation; "★" ]</li>
<li>Go to Layout [ &ldquo;step3_InspectionItems&rdquo; (InspectItems) ]</li>
<li>Set Field [ InspectItems::gprogressGlobal; "status: in progress" ]</li>
<li>Go to Field [  ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ tlResults::InspectionItemCountLocation  &ne; "N/A" and 
tlResults::InspectionItemCountLocation  &ne; "OK" and
tlResults::InspectionItemCountLocation   &ne;   "★" ]</li>
<li>Set Field [ TEMP::testName ]</li>
<li>Go to Layout [ &ldquo;step3_InspectionItems&rdquo; (InspectItems) ]</li>
<li>Set Field [ InspectItems::gprogressGlobal; "status: in progress" ]</li>
<li>Go to Field [  ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Freeze Window</li>
<li>New Window [  ]</li>
<li>#note item's ID number and name</li>
<li>Set Variable [ $$item; Value:InspectItems::_Ltest ]</li>
<li>Set Field [ TEMP::testName ]</li>
<li>Go to Layout [ &ldquo;discoveries&rdquo; (testlearn) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::ktestSubject; TEMP::kdefaultNodeTestSubject ]</li>
<li>Set Field [ testlearn::kaudienceLocation; $$location ]</li>
<li>Set Field [ testlearn::ktest; $$item ]</li>
<li>Perform Find [  ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>#Unlock Item Location</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::ktestSubject; TEMP::kdefaultNodeTestSubject ]</li>
<li>Set Field [ testlearn::kaudienceLocation; $$location ]</li>
<li>Perform Find [  ]</li>
<li>If [ Get ( LastError ) = 401 ]</li>
<li>Go to Layout [ &ldquo;tableTestSubjectFocus&rdquo; (tagTestSubjectLocation) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTestSubjectLocation::_LtestSubjectLocation; $$location ]</li>
<li>Perform Find [  ]</li>
<li>Set Field [ tagTestSubjectLocation::inUse; "" ]</li>
<li>#refind all location records for this session</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTestSubjectLocation::knode; TEMP::kdefaultNodeTestSubject ]</li>
<li>Perform Find [  ]</li>
<li>Go to Layout [ &ldquo;step3_InspectionItems&rdquo; (InspectItems) ]</li>
<li>Set Field [ InspectItems::gprogressGlobal; "status: pending" ]</li>
<li>End If</li>
<li>Close Window [ Current Window ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tlResults</em>::_Ltestlearn</li>
<li>
<em>InspectItems</em>::_Ltest</li>
<li>
<em>InspectItems</em>::testName</li>
<li>
<em>TEMP</em>::testName</li>
<li>
<em>TEMP</em>::kdefaultNodeTestSubject</li>
<li>
<em>testlearn</em>::ktestSubject</li>
<li>
<em>testlearn</em>::kaudienceLocation</li>
<li>
<em>testlearn</em>::kreportNumber</li>
<li>
<em>testlearn</em>::Location</li>
<li>
<em>testlearn</em>::kcsection</li>
<li>
<em>testlearn</em>::ktest</li>
<li>
<em>tagTestSubjectLocation</em>::_LtestSubjectLocation</li>
<li>
<em>tagTestSubjectLocation</em>::inUse</li>
<li>
<em>tagTestSubjectLocation</em>::knode</li>
<li>
<em>tlResults</em>::InspectionItemCountLocation</li>
<li>
<em>InspectItems</em>::gprogressGlobal</li>
<li>
<em>TLResultsOnReport</em>::InspectionItemCount</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>discoveries</li>
<li>tableTestSubjectFocus</li>
<li>step3_InspectionItems</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32836ScriptAnchor_"></a><td class="script_navbar"><a href="#32839ScriptAnchor_"><span>Previous Script: [itemNA]</span></a></td><td class="script_navbar"><a href="#33317ScriptAnchor_"><span>Parent Folder: [test]</span></a></td><td class="script_navbar"><a href="#32832ScriptAnchor_"><span>Next Script: [returnToInspectionItems]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">inspectAddProblemToFinding</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Field [ testlearn::Caption; testlearn::Caption &amp; &para;  &amp;  tagDetails::tag ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearn</em>::Caption</li>
<li>
<em>tagDetails</em>::tag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32832ScriptAnchor_"></a><td class="script_navbar"><a href="#32836ScriptAnchor_"><span>Previous Script: [inspectAddProblemToFinding]</span></a></td><td class="script_navbar"><a href="#33317ScriptAnchor_"><span>Parent Folder: [test]</span></a></td><td class="script_navbar"><a href="#32828ScriptAnchor_"><span>Next Script: [CHUNK_countInspectedItems]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">returnToInspectionItems</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Go to Layout [ &ldquo;step3_InspectionItems&rdquo; (InspectItems) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ InspectItems::kcfocusALL; $$genlocation ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: &lt;Table Missing&gt;; ascending ]
[ Restore; No dialog ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>InspectItems</em>::kcfocusALL</li>
<li>&lt;Missing Field&gt;</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>step3_InspectionItems</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32828ScriptAnchor_"></a><td class="script_navbar"><a href="#32832ScriptAnchor_"><span>Previous Script: [returnToInspectionItems]</span></a></td><td class="script_navbar"><a href="#33317ScriptAnchor_"><span>Parent Folder: [test]</span></a></td><td class="script_navbar"><a href="#33293ScriptAnchor_"><span>Next Script: [exitAndStopclearCitationMatch]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">CHUNK_countInspectedItems</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#record the number of recommendations already counted for this item add 1 to it</li>
<li>Set Variable [ $count; Value:testlearn::InspectionItemCount ]</li>
<li>Set Field [ testlearn::InspectionItemCount; $count  + 1 ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearn</em>::InspectionItemCount</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33293ScriptAnchor_"></a><td class="script_navbar"><a href="#32828ScriptAnchor_"><span>Previous Script: [CHUNK_countInspectedItems]</span></a></td><td class="script_navbar"><a href="#33317ScriptAnchor_"><span>Parent Folder: [test]</span></a></td><td class="script_navbar"><a href="#32904ScriptAnchor_"><span>Next Script: [exitAndOrderEvidence]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">exitAndStopclearCitationMatch</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ $$turnOffThisScript = 1 ]</li>
<li>Set Variable [ $$turnOffThisScript; Value:2 ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32904ScriptAnchor_"></a><td class="script_navbar"><a href="#33293ScriptAnchor_"><span>Previous Script: [exitAndStopclearCitationMatch]</span></a></td><td class="script_navbar"><a href="#33317ScriptAnchor_"><span>Parent Folder: [test]</span></a></td><td class="script_navbar"><a href="#32893ScriptAnchor_"><span>Next Script: [reportNewEvidence]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">exitAndOrderEvidence</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Go to Field [  ]</li>
<li>Sort Records [ Specified Sort Order: testlearnReportTags::orderDiscovery; based on value list: &ldquo;order&rdquo;
testlearnReportTags::Location; ascending
testlearnReportTags::timestamp; ascending
testlearnReportTags::_Ltestlearn; ascending ]
[ Restore; No dialog ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearnReportTags</em>::orderDiscovery</li>
<li>
<em>testlearnReportTags</em>::Location</li>
<li>
<em>testlearnReportTags</em>::timestamp</li>
<li>
<em>testlearnReportTags</em>::_Ltestlearn</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32893ScriptAnchor_"></a><td class="script_navbar"><a href="#32904ScriptAnchor_"><span>Previous Script: [exitAndOrderEvidence]</span></a></td><td class="script_navbar"><a href="#33317ScriptAnchor_"><span>Parent Folder: [test]</span></a></td><td class="script_navbar"><a href="#32899ScriptAnchor_"><span>Next Script: [reportDeleteEvidence]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">reportNewEvidence</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>If [ testlearnReportTags::gkaudienceLocation = "" ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Select a test section by 1) clicking on the USE button under a picture or by 2) clicking the test section button (next to new button)."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>New Record/Request</li>
<li>Set Field [ testlearnReportTags::ktestSubject; $$contact ]</li>
<li>Set Field [ testlearnReportTags::kaudienceLocation; TEMP::kuserLocation ]</li>
<li>Set Field [ testlearnReportTags::kcsection; TEMP::ksection ]</li>
<li>Set Field [ testlearnReportTags::kreportNumber; TEMP::reportNumber ]</li>
<li>Set Field [ testlearnReportTags::Location; TEMP::LocationName ]</li>
<li>Set Field [ testlearnReportTags::ktest; TEMP::ktest ]</li>
<li>Set Field [ testlearnReportTags::timestamp; TEMP::TimeStamp ]</li>
<li>Set Field [ testlearn::kRecordCreatorNode; TEMP::kdefaultNodePrimary ]</li>
<li>Set Field [ testlearn::RecordModifyDate; Get ( CurrentTimeStamp ) ]</li>
<li>Set Field [ testlearn::kHealth; TEMP::kdefaultHealth ]</li>
<li>#</li>
<li>#note the new record id so when after you sort the</li>
<li>#the records you will be able to put the focus back on</li>
<li>#this newly created record in a loop at the end of this script.</li>
<li>Set Variable [ $kpn; Value:testlearnReportTags::_Ltestlearn ]</li>
<li>#</li>
<li>#increase number of findings for item for this contact's location</li>
<li>Go to Layout [ &ldquo;discoveries&rdquo; (testlearn) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::ktestSubject; $$contact ]</li>
<li>Set Field [ testlearn::kaudienceLocation; $$location ]</li>
<li>Set Field [ testlearn::ktest; $$item ]</li>
<li>Perform Find [  ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Variable [ $number; Value:Get (FoundCount) ]</li>
<li>Loop</li>
<li>Set Field [ testlearn::InspectionItemCountLocation; $number ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#increase number of findings for item</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::ktestSubject; $$contact ]</li>
<li>Set Field [ testlearn::ktest; $$item ]</li>
<li>Set Field [ testlearn::kreportNumber; $$reportNumber ]</li>
<li>Perform Find [  ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Variable [ $number; Value:Get (FoundCount) ]</li>
<li>Loop</li>
<li>Set Field [ testlearn::InspectionItemCount; $number ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#lock item location so it cannot be deleted unless all findings for it are deleted</li>
<li>Go to Layout [ &ldquo;tableTestSubjectFocus&rdquo; (tagTestSubjectLocation) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTestSubjectLocation::_LtestSubjectLocation; $$location ]</li>
<li>Perform Find [  ]</li>
<li>Set Field [ tagTestSubjectLocation::inUse; "t" ]</li>
<li>#</li>
<li>#refind all location records for this session</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTestSubjectLocation::knode; $$contact ]</li>
<li>Set Field [ tagTestSubjectLocation::ksection; $$Library ]</li>
<li>Set Field [ tagTestSubjectLocation::reportNumber; $$ReportNumber ]</li>
<li>Perform Find [  ]</li>
<li>Go to Layout [ original layout ]</li>
<li>Sort Records [ Specified Sort Order: testlearnReportTags::Location; ascending
testlearnReportTags::timestamp; ascending
testlearnReportTags::_Ltestlearn; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ testlearnReportTags::_Ltestlearn = $kpn ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearnReportTags</em>::gkaudienceLocation</li>
<li>
<em>testlearnReportTags</em>::ktestSubject</li>
<li>
<em>TEMP</em>::kuserLocation</li>
<li>
<em>testlearnReportTags</em>::kaudienceLocation</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>testlearnReportTags</em>::kcsection</li>
<li>
<em>TEMP</em>::reportNumber</li>
<li>
<em>testlearnReportTags</em>::kreportNumber</li>
<li>
<em>TEMP</em>::LocationName</li>
<li>
<em>testlearnReportTags</em>::Location</li>
<li>
<em>TEMP</em>::ktest</li>
<li>
<em>testlearnReportTags</em>::ktest</li>
<li>
<em>TEMP</em>::TimeStamp</li>
<li>
<em>testlearnReportTags</em>::timestamp</li>
<li>
<em>TEMP</em>::kdefaultNodePrimary</li>
<li>
<em>testlearn</em>::kRecordCreatorNode</li>
<li>
<em>testlearn</em>::RecordModifyDate</li>
<li>
<em>TEMP</em>::kdefaultHealth</li>
<li>
<em>testlearn</em>::kHealth</li>
<li>
<em>testlearnReportTags</em>::_Ltestlearn</li>
<li>
<em>testlearn</em>::ktestSubject</li>
<li>
<em>testlearn</em>::kaudienceLocation</li>
<li>
<em>testlearn</em>::ktest</li>
<li>
<em>testlearn</em>::InspectionItemCountLocation</li>
<li>
<em>testlearn</em>::kreportNumber</li>
<li>
<em>testlearn</em>::InspectionItemCount</li>
<li>
<em>tagTestSubjectLocation</em>::_LtestSubjectLocation</li>
<li>
<em>tagTestSubjectLocation</em>::inUse</li>
<li>
<em>tagTestSubjectLocation</em>::knode</li>
<li>
<em>tagTestSubjectLocation</em>::ksection</li>
<li>
<em>tagTestSubjectLocation</em>::reportNumber</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>discoveries</li>
<li>tableTestSubjectFocus</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32899ScriptAnchor_"></a><td class="script_navbar"><a href="#32893ScriptAnchor_"><span>Previous Script: [reportNewEvidence]</span></a></td><td class="script_navbar"><a href="#33317ScriptAnchor_"><span>Parent Folder: [test]</span></a></td><td class="script_navbar"><a href="#32895ScriptAnchor_"><span>Next Script: [reportSelectLocation]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">reportDeleteEvidence</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>#</li>
<li>If [ testlearnReportTags::_Ltestlearn = "" ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ testlearnReportTags::inUse &ne; "" ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: testlearnReportTags::_Number  &amp; " is in use on " &amp; testlearnReportTags::inUseNumberOfTimes &amp; If ( testlearnReportTags::inUseNumberOfTimes = 1 ; " report and must be removed before it can be deleted." ; " reports and must be removed from all of them before it can be deleted." ); Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#make to be deleted record red and capture info for delete</li>
<li>Set Variable [ $delete; Value:testlearnReportTags::_Ltestlearn ]</li>
<li>Set Variable [ $record; Value:Get (RecordNumber) ]</li>
<li>Set Variable [ $TempLocation; Value:testlearnReportTags::kaudienceLocation ]</li>
<li>Set Variable [ $TempReportNumber; Value:testlearnReportTags::kreportNumber ]</li>
<li>Set Variable [ $TempContact; Value:testlearnReportTags::ktestSubject ]</li>
<li>Go to Field [  ]</li>
<li>Refresh Window</li>
<li>If [ testlearnReportTags::ktestSubject +  testlearnReportTags::kreportNumber = $$contact + $$reportNumber ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Delete evidence number "  &amp; testlearnReportTags::_Number  &amp; " ?"; Buttons: &ldquo;Cancel&rdquo;, &ldquo;Delete&rdquo; ]</li>
<li>#THIS IS DISABLED AND SHOULD EVENTUALLY</li>
<li>#BE DELETED AFTER TESTING.  THERE USE TO BE</li>
<li>#A FAVORITE FIELD THAT HAS BEEN REMOVED.</li>
<li>#SEE EARLIER VERSIONS FOR HOW THIS FUNCTIONED.</li>
<li>#IN SHORT, IT DID WHAT MAKE INFO BUTTON</li>
<li>#NOW DOES.</li>
<li>//  Else If [ testlearnReportTags::ktestSubject +  testlearnReportTags::kreportNumber &ne; $$contact + $$reportNumber ]</li>
<li>//  Show Custom Dialog [ Title: "!"; Message: "Delete evidence number "  &amp; testlearnReportTags::_Number  &amp; " ?  NOTE: THIS EVIDENCE IS A FAVORITE BELONGING A DIFFERENT REPORT."; Buttons: &ldquo;Cancel&rdquo;, &ldquo;Delete&rdquo; ]</li>
<li>End If</li>
<li>If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>#user may be showing favorites, so first make sure</li>
<li>#only this reports records are showing in case this is</li>
<li>#the last record for this item in which case the report</li>
<li>#page for this item also needs to be deleted.</li>
<li>If [ testlearnReportTags::ktestSubject +  testlearnReportTags::kreportNumber = $$contact + $$reportNumber ]</li>
<li>Go to Layout [ &ldquo;discoveries&rdquo; (testlearn) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::ktest; $$item ]</li>
<li>Set Field [ testlearn::kreportNumber; $TempReportNumber ]</li>
<li>Set Field [ testlearn::ktestSubject; $TempContact ]</li>
<li>Perform Find [  ]</li>
<li>End If</li>
<li>Go to Record/Request/Page
[ Last ]</li>
<li>If [ Get (RecordNumber) = 1 ]</li>
<li>#switch back to this layout to preserve found record </li>
<li>#set in case more than one record was found</li>
<li>Go to Layout [ &ldquo;reportTagDiscovery&rdquo; (testlearnReportTags) ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Deleting this last piece of evidence will delete this page of the report too, do you wish to proceed?  If you wish to keep this report page then add new evidence before deleting this evidence."; Buttons: &ldquo;Cancel&rdquo;, &ldquo;Delete&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Go to Layout [ &ldquo;discoveries&rdquo; (testlearn) ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>Else If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Set Variable [ $delete ]</li>
<li>Refresh Window</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Go to Layout [ &ldquo;PrintReportEdit&rdquo; (report) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ report::ktestSubject; $TempContact ]</li>
<li>Set Field [ report::ktest; $$item ]</li>
<li>Set Field [ report::kreportNumber; $TempReportNumber ]</li>
<li>Set Field [ report::ksection; $$Library ]</li>
<li>Perform Find [  ]</li>
<li>Delete All Records
[ No dialog ]</li>
<li>Set Variable [ $delete ]</li>
<li>#Unlock Item Location IF this was the last item</li>
<li>Go to Layout [ &ldquo;discoveries&rdquo; (testlearn) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kaudienceLocation; $TempLocation ]</li>
<li>Set Field [ testlearn::kreportNumber; $TempReportNumber ]</li>
<li>Perform Find [  ]</li>
<li>If [ Get ( LastError ) = 401 ]</li>
<li>Go to Layout [ &ldquo;tableTestSubjectFocus&rdquo; (tagTestSubjectLocation) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTestSubjectLocation::_LtestSubjectLocation; $TempLocation ]</li>
<li>Set Field [ tagTestSubjectLocation::reportNumber; $TempReportNumber ]</li>
<li>Perform Find [  ]</li>
<li>Set Field [ tagTestSubjectLocation::inUse; "" ]</li>
<li>#refind all location records for current library report number</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTestSubjectLocation::knode; $TempContact ]</li>
<li>Set Field [ tagTestSubjectLocation::reportNumber; $$reportNumber ]</li>
<li>Set Field [ tagTestSubjectLocation::ksection; $$Library ]</li>
<li>Perform Find [  ]</li>
<li>Go to Layout [ &ldquo;step3_InspectionItems&rdquo; (InspectItems) ]</li>
<li>If [ InspectItems::kgaudienceLocation = $TempLocation ]</li>
<li>Set Field [ InspectItems::gprogressGlobal; "status: pending" ]</li>
<li>End If</li>
<li>End If</li>
<li>Close Window [ Name: "Report"; Current file ]</li>
<li>Close Window [ Name: "Recommendations"; Current file ]</li>
<li>Perform Script [ &ldquo;editReport&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#switch back to this layout so don't have reassign</li>
<li>#fields for inspection layout.  (script was written for</li>
<li>#findings layout)</li>
<li>Go to Layout [ &ldquo;reportTagDiscovery&rdquo; (testlearnReportTags) ]</li>
<li>Go to Record/Request/Page [ $record ]
[ No dialog ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>Go to Layout [ &ldquo;discoveries&rdquo; (testlearn) ]</li>
<li>#THIS IS DISABLED AND SHOULD EVENTUALLY</li>
<li>#BE DELETED AFTER TESTING.  THERE USE TO BE</li>
<li>#A FAVORITE FIELD THAT HAS BEEN REMOVED.</li>
<li>#SEE EARLIER VERSIONS FOR HOW THIS FUNCTIONED.</li>
<li>#IN SHORT, IT DID WHAT MAKE INFO BUTTON</li>
<li>#NOW DOES.</li>
<li>//  #If this is a favorite item and it is the only one then delete the report page created for it.</li>
<li>//  If [ testlearnReportTags::ktestSubject +  testlearnReportTags::kreportNumber &ne; $$contact + $$reportNumber ]</li>
<li>//  Enter Find Mode [  ]</li>
<li>//  Set Field [ testlearn::ktest; $$item ]</li>
<li>//  Set Field [ testlearn::kreportNumber; $TempReportNumber ]</li>
<li>//  Set Field [ testlearn::ktestSubject; $TempContact ]</li>
<li>//  Perform Find [  ]</li>
<li>//  If [ Get (LastError) = 401 ]</li>
<li>//  Go to Layout [ &ldquo;PrintReportEdit&rdquo; (report) ]</li>
<li>//  Enter Find Mode [  ]</li>
<li>//  Set Field [ report::ktestSubject; $TempContact ]</li>
<li>//  Set Field [ report::ktest; $$item ]</li>
<li>//  Set Field [ report::kreportNumber; $TempReportNumber ]</li>
<li>//  Set Field [ report::ksection; $$Library ]</li>
<li>//  Perform Find [  ]</li>
<li>//  Delete All Records
[ No dialog ]</li>
<li>//  Set Variable [ $delete ]</li>
<li>//  End If</li>
<li>//  End If</li>
<li>#GET ID INFO as is from different location</li>
<li>#Unlock Item Location</li>
<li>#zero out findings for item for this contact's location</li>
<li>#</li>
<li>#decrease number of findings for item for this contact's location</li>
<li>Go to Layout [ &ldquo;discoveries&rdquo; (testlearn) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kaudienceLocation; $TempLocation ]</li>
<li>Set Field [ testlearn::kreportNumber; $TempReportNumber ]</li>
<li>Perform Find [  ]</li>
<li>#Unlock Item Location</li>
<li>If [ Get ( LastError ) = 401 ]</li>
<li>Go to Layout [ &ldquo;tableTestSubjectFocus&rdquo; (tagTestSubjectLocation) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTestSubjectLocation::_LtestSubjectLocation; $TempLocation ]</li>
<li>Perform Find [  ]</li>
<li>Set Field [ tagTestSubjectLocation::inUse; "" ]</li>
<li>//  #refind all location records for this session</li>
<li>//  Enter Find Mode [  ]</li>
<li>//  Set Field [ tagTestSubjectLocation::knode; $$contact ]</li>
<li>//  Set Field [ tagTestSubjectLocation::reportNumber; $$reportNumber ]</li>
<li>//  Set Field [ tagTestSubjectLocation::ksection; $$Library ]</li>
<li>//  Perform Find [  ]</li>
<li>//  Go to Layout [ &ldquo;step3_InspectionItems&rdquo; (InspectItems) ]</li>
<li>//  If [ InspectItems::kgaudienceLocation = $TempLocation ]</li>
<li>//  Set Field [ InspectItems::gprogressGlobal; "status: pending" ]</li>
<li>//  End If</li>
<li>Else If [ Get (LastError)  &ne; 401 ]</li>
<li>Go to Layout [ &ldquo;step4_InspectionFinding&rdquo; (testlearn) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::ktest; $$item ]</li>
<li>Set Field [ testlearn::kaudienceLocation; $TempLocation ]</li>
<li>Set Field [ testlearn::kreportNumber; $TempReportNumber ]</li>
<li>Perform Find [  ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Variable [ $number; Value:Get (FoundCount) ]</li>
<li>Loop</li>
<li>Set Field [ testlearn::InspectionItemCountLocation; $number ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>End If</li>
<li>Go to Layout [ &ldquo;step4_InspectionFinding&rdquo; (testlearn) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::ktest; $$item ]</li>
<li>Set Field [ testlearn::kreportNumber; $TempReportNumber ]</li>
<li>Set Field [ testlearn::ktestSubject; $TempContact ]</li>
<li>Perform Find [  ]</li>
<li>Set Variable [ $number; Value:Get (FoundCount) ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ testlearn::InspectionItemCount; $number ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#THIS IS DISABLED AND SHOULD EVENTUALLY</li>
<li>#BE DELETED AFTER TESTING.  THERE USE TO BE</li>
<li>#A FAVORITE FIELD THAT HAS BEEN REMOVED.</li>
<li>#SEE EARLIER VERSIONS FOR HOW THIS FUNCTIONED.</li>
<li>#IN SHORT, IT DID WHAT MAKE INFO BUTTON</li>
<li>#NOW DOES.</li>
<li>//  If [ $TempLocation &ne; $$location ]</li>
<li>//  Enter Find Mode [  ]</li>
<li>//  Set Field [ testlearn::ktestSubject; $$contact ]</li>
<li>//  Set Field [ testlearn::ktest; $$item ]</li>
<li>//  Set Field [ testlearn::kreportNumber; $$reportNumber ]</li>
<li>//  Perform Find [  ]</li>
<li>//  #since this was a favorite record that was deleted, show any favorite records that remain</li>
<li>//  Enter Find Mode [  ]</li>
<li>//  Set Field [ testlearn::ktest; $$item ]</li>
<li>//  Extend Found Set [  ]</li>
<li>//  Sort Records [ Specified Sort Order: testlearn::kcsection; ascending
testlearn::kreportNumber; ascending ]
[ Restore; No dialog ]</li>
<li>//  Go to Record/Request/Page
[ Last ]</li>
<li>//  End If</li>
<li>End If</li>
<li>Go to Layout [ &ldquo;reportTagDiscovery&rdquo; (testlearnReportTags) ]</li>
<li>Set Variable [ $delete ]</li>
<li>Refresh Window</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearnReportTags</em>::_Ltestlearn</li>
<li>
<em>testlearnReportTags</em>::inUse</li>
<li>
<em>testlearnReportTags</em>::_Number</li>
<li>
<em>testlearnReportTags</em>::inUseNumberOfTimes</li>
<li>
<em>testlearnReportTags</em>::kaudienceLocation</li>
<li>
<em>testlearnReportTags</em>::kreportNumber</li>
<li>
<em>testlearnReportTags</em>::ktestSubject</li>
<li>
<em>testlearn</em>::ktest</li>
<li>
<em>testlearn</em>::kreportNumber</li>
<li>
<em>testlearn</em>::ktestSubject</li>
<li>
<em>report</em>::ktestSubject</li>
<li>
<em>report</em>::ktest</li>
<li>
<em>report</em>::kreportNumber</li>
<li>
<em>report</em>::ksection</li>
<li>
<em>testlearn</em>::kaudienceLocation</li>
<li>
<em>tagTestSubjectLocation</em>::_LtestSubjectLocation</li>
<li>
<em>tagTestSubjectLocation</em>::reportNumber</li>
<li>
<em>tagTestSubjectLocation</em>::inUse</li>
<li>
<em>tagTestSubjectLocation</em>::knode</li>
<li>
<em>tagTestSubjectLocation</em>::ksection</li>
<li>
<em>InspectItems</em>::kgaudienceLocation</li>
<li>
<em>InspectItems</em>::gprogressGlobal</li>
<li>
<em>testlearn</em>::InspectionItemCountLocation</li>
<li>
<em>testlearn</em>::InspectionItemCount</li>
<li>
<em>testlearn</em>::kcsection</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32809ScriptAnchor_">editReport</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>discoveries</li>
<li>reportTagDiscovery</li>
<li>PrintReportEdit</li>
<li>tableTestSubjectFocus</li>
<li>step3_InspectionItems</li>
<li>step4_InspectionFinding</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32895ScriptAnchor_"></a><td class="script_navbar"><a href="#32899ScriptAnchor_"><span>Previous Script: [reportDeleteEvidence]</span></a></td><td class="script_navbar"><a href="#33317ScriptAnchor_"><span>Parent Folder: [test]</span></a></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">reportSelectLocation</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ Get ( LayoutName ) = "ReportLocationSelect" ]</li>
<li>#note general or canned location user identified</li>
<li>Set Variable [ $$locationName; Value:testlearnReportTags::gkaudienceLocation ]</li>
<li>Set Field [ TEMP::kuserLocation; $$locationName ]</li>
<li>#</li>
<li>#note new location ID number and name user created for this specific location in the contact's building</li>
<li>Set Variable [ $$location; Value:tagTestSubjectLocation::_LtestSubjectLocation ]</li>
<li>Close Window [ Current Window ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>If [ testlearnReportTags::kreportNumber &ne; $$reportNumber ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "This evidence is a favority from another report, so its location information cannot be used for creating location based evidence for this report."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#set up new discovery field name with this </li>
<li>#item's information.</li>
<li>Set Field [ TEMP::LocationName; testlearnReportTags::Location ]</li>
<li>Set Field [ TEMP::kuserLocation; testlearnReportTags::kaudienceLocation ]</li>
<li>Set Field [ testlearnReportTags::gkaudienceLocation; testlearnReportTags::kaudienceLocation ]</li>
<li>Set Field [ TEMP::TimeStamp; testlearnReportTags::timestamp ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearnReportTags</em>::gkaudienceLocation</li>
<li>
<em>TEMP</em>::kuserLocation</li>
<li>
<em>tagTestSubjectLocation</em>::_LtestSubjectLocation</li>
<li>
<em>testlearnReportTags</em>::kreportNumber</li>
<li>
<em>testlearnReportTags</em>::Location</li>
<li>
<em>TEMP</em>::LocationName</li>
<li>
<em>testlearnReportTags</em>::kaudienceLocation</li>
<li>
<em>testlearnReportTags</em>::timestamp</li>
<li>
<em>TEMP</em>::TimeStamp</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<p>
<span class="partheading"><a name="33325ScriptAnchor_"></a><a href="#33325ScriptAnchor_toc">probablyNotInUse</a></span>
</p>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32857ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"><a href="#33325ScriptAnchor_"><span>Parent Folder: [probablyNotInUse]</span></a></td><td class="script_navbar"><a href="#32856ScriptAnchor_"><span>Next Script: [returnToStep2]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">returnToStep1</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Go to Layout [ &lt;unknown&gt; ]</li>
<li>Set Variable [ $total; Value:&lt;Table Missing&gt;::&lt;Field Missing&gt; ]</li>
<li>Set Field [ &lt;Table Missing&gt;; Abs ( &lt;Table Missing&gt;::&lt;Field Missing&gt; - Get ( CurrentTime ) ) + $total ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>&lt;Missing Field&gt;</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>&lt;Missing Layout&gt;</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32856ScriptAnchor_"></a><td class="script_navbar"><a href="#32857ScriptAnchor_"><span>Previous Script: [returnToStep1]</span></a></td><td class="script_navbar"><a href="#33325ScriptAnchor_"><span>Parent Folder: [probablyNotInUse]</span></a></td><td class="script_navbar"><a href="#32881ScriptAnchor_"><span>Next Script: [delete_Finding Copy]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">returnToStep2</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32809ScriptAnchor_">editReport</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Go to Layout [ &ldquo;defaultSetup&rdquo; (tempSetup) ]</li>
<li>Set Window Title [ Current Window; New Title: "Setup" ]</li>
<li>Move/Resize Window [ Current Window; Height: Get (ScreenHeight); Width: Get (ScreenWidth) / 2; Top: 0; Left: 0 ]</li>
<li>#</li>
<li>#goto Tag Menus window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>If [ Get (LastError)  = 112 ]</li>
<li>New Window [ Name: "Tag Menus"; Height: Get (ScreenHeight); Width: Get (ScreenWidth) / 2; Top: 0; Left: Get (ScreenWidth) / 2 ]</li>
<li>End If</li>
<li>#</li>
<li>Go to Layout [ &ldquo;defaultTest&rdquo; (tagTestSubjectLocation) ]</li>
<li>Perform Script [ &ldquo;defaultTestLocationMenu&rdquo; ]</li>
<li>#</li>
<li>Go to Record/Request/Page [ $$TSRecordNumber ]
[ No dialog ]</li>
<li>Set Variable [ $$TSRecordNumber ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33133ScriptAnchor_">defaultTestLocationMenu</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>defaultSetup</li>
<li>defaultTest</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32881ScriptAnchor_"></a><td class="script_navbar"><a href="#32856ScriptAnchor_"><span>Previous Script: [returnToStep2]</span></a></td><td class="script_navbar"><a href="#33325ScriptAnchor_"><span>Parent Folder: [probablyNotInUse]</span></a></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">delete_Finding Copy</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>If [ testlearn::_Ltestlearn = "" ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Set Variable [ $delete; Value:testlearn::_Ltestlearn ]</li>
<li>Set Variable [ $record; Value:Get (RecordNumber) ]</li>
<li>Set Variable [ $TempLocation; Value:testlearn::kaudienceLocation ]</li>
<li>Set Variable [ $TempReportNumber; Value:testlearn::kreportNumber ]</li>
<li>Go to Field [  ]</li>
<li>Refresh Window</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Delete finding number "  &amp; testlearn::recordnumberglobal  &amp; "?"; Buttons: &ldquo;Cancel&rdquo;, &ldquo;Delete&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>#create new inspection record setting all fields with neccessary key copies</li>
<li>#to unlock data </li>
<li>Go to Record/Request/Page
[ Last ]</li>
<li>If [ Get (RecordNumber) = 1 ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>Go to Layout [ &ldquo;PrintReportEdit&rdquo; (report) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ report::ktestSubject; $$contact ]</li>
<li>Set Field [ report::ktest; $$item ]</li>
<li>Set Field [ report::kreportNumber; $TempReportNumber ]</li>
<li>Set Field [ report::ksection; $$Library ]</li>
<li>Perform Find [  ]</li>
<li>Delete All Records
[ No dialog ]</li>
<li>Set Variable [ $delete ]</li>
<li>#Unlock Item Location</li>
<li>Go to Layout [ &ldquo;discoveries&rdquo; (testlearn) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kaudienceLocation; $TempLocation ]</li>
<li>Set Field [ testlearn::kreportNumber; $TempReportNumber ]</li>
<li>Perform Find [  ]</li>
<li>If [ Get ( LastError ) = 401 ]</li>
<li>Go to Layout [ &ldquo;tableTestSubjectFocus&rdquo; (tagTestSubjectLocation) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTestSubjectLocation::_LtestSubjectLocation; $TempLocation ]</li>
<li>Set Field [ tagTestSubjectLocation::reportNumber; $TempReportNumber ]</li>
<li>Perform Find [  ]</li>
<li>Set Field [ tagTestSubjectLocation::inUse; "" ]</li>
<li>#refind all location records for current library report number</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTestSubjectLocation::knode; $$contact ]</li>
<li>Set Field [ tagTestSubjectLocation::reportNumber; $$reportNumber ]</li>
<li>Set Field [ tagTestSubjectLocation::ksection; $$Library ]</li>
<li>Perform Find [  ]</li>
<li>Go to Layout [ &ldquo;step3_InspectionItems&rdquo; (InspectItems) ]</li>
<li>If [ InspectItems::kgaudienceLocation = $TempLocation ]</li>
<li>Set Field [ InspectItems::gprogressGlobal; "status: pending" ]</li>
<li>End If</li>
<li>End If</li>
<li>Go to Layout [ &ldquo;step3_InspectionItems&rdquo; (InspectItems) ]</li>
<li>Set Field [ InspectItems::glocationNameGlobal; $$locationName ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Go to Record/Request/Page [ $record ]
[ No dialog ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>#If this is a favorite item and it is the only one then delete the report page created for it.</li>
<li>If [ $TempLocation &ne; $$location ]</li>
<li>Enter Find Mode [  ]
[ Pause ]</li>
<li>Set Field [ testlearn::ktest; $$item ]</li>
<li>Set Field [ testlearn::kreportNumber; $TempReportNumber ]</li>
<li>Perform Find [  ]</li>
<li>Go to Record/Request/Page
[ Last ]</li>
<li>If [ Get (RecordNumber) = 1 ]</li>
<li>Go to Layout [ &ldquo;PrintReportEdit&rdquo; (report) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ report::ktestSubject; $$contact ]</li>
<li>Set Field [ report::ktest; $$item ]</li>
<li>Set Field [ report::kreportNumber; $TempReportNumber ]</li>
<li>Set Field [ report::ksection; $$Library ]</li>
<li>Perform Find [  ]</li>
<li>Delete All Records
[ No dialog ]</li>
<li>Set Variable [ $delete ]</li>
<li>End If</li>
<li>End If</li>
<li>#GET ID INFO as is from different location</li>
<li>#Unlock Item Location</li>
<li>#zero out findings for item for this contact's location</li>
<li>#</li>
<li>#decrease number of findings for item for this contact's location</li>
<li>Go to Layout [ &ldquo;discoveries&rdquo; (testlearn) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kaudienceLocation; $TempLocation ]</li>
<li>Perform Find [  ]</li>
<li>#Unlock Item Location</li>
<li>If [ Get ( LastError ) = 401 ]</li>
<li>Go to Layout [ &ldquo;tableTestSubjectFocus&rdquo; (tagTestSubjectLocation) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTestSubjectLocation::_LtestSubjectLocation; $TempLocation ]</li>
<li>Perform Find [  ]</li>
<li>Set Field [ tagTestSubjectLocation::inUse; "" ]</li>
<li>#refind all location records for this session</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTestSubjectLocation::knode; $$contact ]</li>
<li>Set Field [ tagTestSubjectLocation::reportNumber; $$reportNumber ]</li>
<li>Set Field [ tagTestSubjectLocation::ksection; $$Library ]</li>
<li>Perform Find [  ]</li>
<li>Go to Layout [ &ldquo;step3_InspectionItems&rdquo; (InspectItems) ]</li>
<li>If [ InspectItems::kgaudienceLocation = $TempLocation ]</li>
<li>Set Field [ InspectItems::gprogressGlobal; "status: pending" ]</li>
<li>End If</li>
<li>Else If [ Get (LastError)  &ne; 401 ]</li>
<li>Go to Layout [ &ldquo;step4_InspectionFinding&rdquo; (testlearn) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::ktest; $$item ]</li>
<li>Set Field [ testlearn::kaudienceLocation; $TempLocation ]</li>
<li>Perform Find [  ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Variable [ $number; Value:Get (FoundCount) ]</li>
<li>Loop</li>
<li>Set Field [ testlearn::InspectionItemCountLocation; $number ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>End If</li>
<li>Go to Layout [ &ldquo;step4_InspectionFinding&rdquo; (testlearn) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::ktestSubject; $$contact ]</li>
<li>Set Field [ testlearn::ktest; $$item ]</li>
<li>Set Field [ testlearn::kreportNumber; $$reportNumber ]</li>
<li>Perform Find [  ]</li>
<li>Set Variable [ $number; Value:Get (FoundCount) ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ testlearn::InspectionItemCount; $number ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Set Field [ testlearn::recordnumberglobal; Get (RecordNumber) ]</li>
<li>Set Field [ testlearn::recordcountglobal; Get (FoundCount) ]</li>
<li>Go to Layout [ &ldquo;step4_InspectionFinding&rdquo; (testlearn) ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Set Variable [ $delete ]</li>
<li>Refresh Window</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearn</em>::_Ltestlearn</li>
<li>
<em>testlearn</em>::kaudienceLocation</li>
<li>
<em>testlearn</em>::kreportNumber</li>
<li>
<em>testlearn</em>::recordnumberglobal</li>
<li>
<em>report</em>::ktestSubject</li>
<li>
<em>report</em>::ktest</li>
<li>
<em>report</em>::kreportNumber</li>
<li>
<em>report</em>::ksection</li>
<li>
<em>tagTestSubjectLocation</em>::_LtestSubjectLocation</li>
<li>
<em>tagTestSubjectLocation</em>::reportNumber</li>
<li>
<em>tagTestSubjectLocation</em>::inUse</li>
<li>
<em>tagTestSubjectLocation</em>::knode</li>
<li>
<em>tagTestSubjectLocation</em>::ksection</li>
<li>
<em>InspectItems</em>::kgaudienceLocation</li>
<li>
<em>InspectItems</em>::gprogressGlobal</li>
<li>
<em>InspectItems</em>::glocationNameGlobal</li>
<li>
<em>testlearn</em>::ktest</li>
<li>
<em>testlearn</em>::InspectionItemCountLocation</li>
<li>
<em>testlearn</em>::ktestSubject</li>
<li>
<em>testlearn</em>::InspectionItemCount</li>
<li>
<em>testlearn</em>::recordcountglobal</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>PrintReportEdit</li>
<li>discoveries</li>
<li>tableTestSubjectFocus</li>
<li>step3_InspectionItems</li>
<li>step4_InspectionFinding</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<p>
<span class="partheading"><a name="33313ScriptAnchor_"></a><a href="#33313ScriptAnchor_toc">testReport</a></span>
</p>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32949ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"><a href="#33313ScriptAnchor_"><span>Parent Folder: [testReport]</span></a></td><td class="script_navbar"><a href="#32848ScriptAnchor_"><span>Next Script: [nextPage]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">pagePulldown</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Go to Field [  ]</li>
<li>Set Variable [ $$first ]</li>
<li>Set Variable [ $$last ]</li>
<li>Set Variable [ $record; Value:TEMP::ktest ]</li>
<li>If [ test::_Ltest = $record ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ test::_Ltest = $record ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Perform Script [ &ldquo;loadSetupTestRecord&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::ktest</li>
<li>
<em>test</em>::_Ltest</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32930ScriptAnchor_">loadSetupTestRecord</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32848ScriptAnchor_"></a><td class="script_navbar"><a href="#32949ScriptAnchor_"><span>Previous Script: [pagePulldown]</span></a></td><td class="script_navbar"><a href="#33313ScriptAnchor_"><span>Parent Folder: [testReport]</span></a></td><td class="script_navbar"><a href="#32849ScriptAnchor_"><span>Next Script: [previousPage]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">nextPage</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Variable [ $$first ]</li>
<li>Set Variable [ $$last; Value:test::_Ltest ]</li>
<li>Set Variable [ $library; Value:test::ksection ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>If [ test::ksection &ne; $library ]</li>
<li>Go to Record/Request/Page
[ Previous ]</li>
<li>Refresh Window</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>If [ $$last &ne; test::_Ltest or Get (LastError)  = 101 ]</li>
<li>Set Field [ TEMP::theme; test::testName ]</li>
<li>Perform Script [ &ldquo;loadSetupTestRecord&rdquo; ]</li>
<li>//  Go to Layout [ &ldquo;testSetup&rdquo; (test) ]</li>
<li>//  Go to Layout [ original layout ]</li>
<li>End If</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>test</em>::_Ltest</li>
<li>
<em>test</em>::ksection</li>
<li>
<em>test</em>::testName</li>
<li>
<em>TEMP</em>::theme</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32930ScriptAnchor_">loadSetupTestRecord</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>testSetup</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32849ScriptAnchor_"></a><td class="script_navbar"><a href="#32848ScriptAnchor_"><span>Previous Script: [nextPage]</span></a></td><td class="script_navbar"><a href="#33313ScriptAnchor_"><span>Parent Folder: [testReport]</span></a></td><td class="script_navbar"><a href="#32865ScriptAnchor_"><span>Next Script: [showModifier1]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">previousPage</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Variable [ $$last ]</li>
<li>Set Variable [ $$first; Value:test::_Ltest ]</li>
<li>Set Variable [ $library; Value:test::ksection ]</li>
<li>Go to Record/Request/Page
[ Previous ]</li>
<li>If [ test::ksection &ne; $library ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>Refresh Window</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>If [ $$first &ne; test::_Ltest or Get (LastError)  = 101 ]</li>
<li>Set Field [ TEMP::theme; test::testName ]</li>
<li>Perform Script [ &ldquo;loadSetupTestRecord&rdquo; ]</li>
<li>Refresh Window</li>
<li>//  Go to Layout [ &ldquo;testSetup&rdquo; (test) ]</li>
<li>//  Go to Layout [ original layout ]</li>
<li>End If</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>test</em>::_Ltest</li>
<li>
<em>test</em>::ksection</li>
<li>
<em>test</em>::testName</li>
<li>
<em>TEMP</em>::theme</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32930ScriptAnchor_">loadSetupTestRecord</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>testSetup</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32865ScriptAnchor_"></a><td class="script_navbar"><a href="#32849ScriptAnchor_"><span>Previous Script: [previousPage]</span></a></td><td class="script_navbar"><a href="#33313ScriptAnchor_"><span>Parent Folder: [testReport]</span></a></td><td class="script_navbar"><a href="#32866ScriptAnchor_"><span>Next Script: [showModifier2]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">showModifier1</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Commit Records/Requests</li>
<li>If [ TEMP::kmodifier1 = "" ]</li>
<li>Set Field [ TEMP::modifier1name; "" ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#the pulldown menu action selects the id number, </li>
<li>#but not the name.  To put the name into the TEMP </li>
<li>#global field we will need to find it which is what the </li>
<li>#rest of the script does.</li>
<li>Set Variable [ $mod; Value:TEMP::kmodifier1 ]</li>
<li>Go to Layout [ &ldquo;tableTag&rdquo; (tagTable) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTable::_Ltag; $mod ]</li>
<li>Perform Find [  ]</li>
<li>Set Variable [ $name; Value:tagTable::tag ]</li>
<li>Go to Layout [ original layout ]</li>
<li>Set Field [ TEMP::modifier1name; $name ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Tells user to select an order number not in use</li>
<li>#if the order field is blank.</li>
<li>If [ TEMP::orderMod1 = "" ]</li>
<li>Show Custom Dialog [ Message: "Select an order number to place modifier before or after currently selected location: small location or location upstairs for example."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Go to Field [ TEMP::orderMod1 ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::kmodifier1</li>
<li>
<em>TEMP</em>::modifier1name</li>
<li>
<em>tagTable</em>::_Ltag</li>
<li>
<em>tagTable</em>::tag</li>
<li>
<em>TEMP</em>::orderMod1</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>tableTag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32866ScriptAnchor_"></a><td class="script_navbar"><a href="#32865ScriptAnchor_"><span>Previous Script: [showModifier1]</span></a></td><td class="script_navbar"><a href="#33313ScriptAnchor_"><span>Parent Folder: [testReport]</span></a></td><td class="script_navbar"><a href="#32824ScriptAnchor_"><span>Next Script: [newInspectionLocation]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">showModifier2</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Commit Records/Requests</li>
<li>If [ TEMP::kmodifier2 = "" ]</li>
<li>Set Field [ TEMP::modifier2name; "" ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#the pulldown menu action selects the id number, </li>
<li>#but not the name.  To put the name into the TEMP </li>
<li>#global field we will need to find it which is what the </li>
<li>#rest of the script does.</li>
<li>Set Variable [ $mod; Value:TEMP::kmodifier2 ]</li>
<li>Go to Layout [ &ldquo;tableTag&rdquo; (tagTable) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTable::_Ltag; $mod ]</li>
<li>Perform Find [  ]</li>
<li>Set Variable [ $name; Value:tagTable::tag ]</li>
<li>Go to Layout [ original layout ]</li>
<li>Set Field [ TEMP::modifier2name; $name ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Tells user to select an order number not in use</li>
<li>#if the order field is blank.</li>
<li>If [ TEMP::orderMod2 = "" ]</li>
<li>Show Custom Dialog [ Message: "Select an order number to place modifier before or after currently selected location: small location or location upstairs for example."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Go to Field [ TEMP::orderMod2 ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::kmodifier2</li>
<li>
<em>TEMP</em>::modifier2name</li>
<li>
<em>tagTable</em>::_Ltag</li>
<li>
<em>tagTable</em>::tag</li>
<li>
<em>TEMP</em>::orderMod2</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>tableTag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32824ScriptAnchor_"></a><td class="script_navbar"><a href="#32866ScriptAnchor_"><span>Previous Script: [showModifier2]</span></a></td><td class="script_navbar"><a href="#33313ScriptAnchor_"><span>Parent Folder: [testReport]</span></a></td><td class="script_navbar"><a href="#32825ScriptAnchor_"><span>Next Script: [deleteInspectionLocation]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">newInspectionLocation</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>If [ TEMP::ksection = "" ]</li>
<li>Go to Field [ TEMP::ksection ]
[ Select/perform ]</li>
<li>Halt Script</li>
<li>Else If [ TEMP::reportNumber = "" ]</li>
<li>Go to Field [ TEMP::reportNumber ]
[ Select/perform ]</li>
<li>Halt Script</li>
<li>Else If [ TEMP::LocationName = "" ]</li>
<li>Show Custom Dialog [ Message: "A new test focus must have a name picked from the default test focus list, which will be displayed after you click OK."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Go to Field [ TEMP::kfocus ]
[ Select/perform ]</li>
<li>Go to Object [ Object Name: "focus" ]</li>
<li>Halt Script</li>
<li>Else If [ TEMP::kdefaultNodeTestSubject = "" ]</li>
<li>Show Custom Dialog [ Message: "New test focuses are created for specific test nodes.  Pick one or create a new one in the node section before creating a new test focus."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Set Variable [ $tag; Value:TEMP::kfocus ]</li>
<li>Set Variable [ $$stopFocusLoad; Value:1 ]</li>
<li>#Had to capture report number as variable or</li>
<li>#stop record load script which would replace</li>
<li>#the Temp with nothing upon new record creation.</li>
<li>#I decided to capture it.</li>
<li>Set Variable [ $reportNumber; Value:TEMP::reportNumber ]</li>
<li>Set Variable [ $mod1; Value:TEMP::kmodifier1 ]</li>
<li>Set Variable [ $mod2; Value:TEMP::kmodifier2 ]</li>
<li>New Record/Request</li>
<li>Set Variable [ $nodeLocation; Value:tagTestSubjectLocation::_LtestSubjectLocation ]</li>
<li>Set Field [ tagTestSubjectLocation::knode; TEMP::kdefaultNodeTestSubject ]</li>
<li>Set Field [ tagTestSubjectLocation::ksection; TEMP::ksection ]</li>
<li>Set Field [ tagTestSubjectLocation::reportNumber; $reportNumber ]</li>
<li>Set Field [ tagTestSubjectLocation::kfocus; TEMP::kfocus ]</li>
<li>Set Field [ tagTestSubjectLocation::kfocusAttribute1; TEMP::kmodifier1 ]</li>
<li>Set Field [ tagTestSubjectLocation::kfocusAttribute2; TEMP::kmodifier2 ]</li>
<li>Set Field [ tagTestSubjectLocation::focusName; TextStyleAdd ( 

TEMP::LocationName

; Lowercase ) ]</li>
<li>Set Field [ tagTestSubjectLocation::kRecordCreatorNode; TEMP::kdefaultNodePrimary ]</li>
<li>Go to Layout [ original layout ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Set Field [ TEMP::reportNumber; tagTestSubjectLocation::reportNumber ]</li>
<li>Set Variable [ $$stopFocusLoad ]</li>
<li>Go to Field [ tagTestSubjectLocation::focusName ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>TEMP</em>::reportNumber</li>
<li>
<em>TEMP</em>::LocationName</li>
<li>
<em>TEMP</em>::kfocus</li>
<li>
<em>TEMP</em>::kdefaultNodeTestSubject</li>
<li>
<em>TEMP</em>::kmodifier1</li>
<li>
<em>TEMP</em>::kmodifier2</li>
<li>
<em>tagTestSubjectLocation</em>::_LtestSubjectLocation</li>
<li>
<em>tagTestSubjectLocation</em>::knode</li>
<li>
<em>tagTestSubjectLocation</em>::ksection</li>
<li>
<em>tagTestSubjectLocation</em>::reportNumber</li>
<li>
<em>tagTestSubjectLocation</em>::kfocus</li>
<li>
<em>tagTestSubjectLocation</em>::kfocusAttribute1</li>
<li>
<em>tagTestSubjectLocation</em>::kfocusAttribute2</li>
<li>
<em>tagTestSubjectLocation</em>::focusName</li>
<li>
<em>TEMP</em>::kdefaultNodePrimary</li>
<li>
<em>tagTestSubjectLocation</em>::kRecordCreatorNode</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32825ScriptAnchor_"></a><td class="script_navbar"><a href="#32824ScriptAnchor_"><span>Previous Script: [newInspectionLocation]</span></a></td><td class="script_navbar"><a href="#33313ScriptAnchor_"><span>Parent Folder: [testReport]</span></a></td><td class="script_navbar"><a href="#32973ScriptAnchor_"><span>Next Script: [evidenceTag]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">deleteInspectionLocation</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ tagTestSubjectLocation::_LtestSubjectLocation = "" ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ tagTestSubjectLocation::inUse = "t" ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Deleting this set of test items is allowed after you delete all discoveries made during testing."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Set Variable [ $delete; Value:tagTestSubjectLocation::_LtestSubjectLocation ]</li>
<li>Set Variable [ $location; Value:tagTestSubjectLocation::kfocus ]</li>
<li>Go to Field [  ]</li>
<li>Refresh Window</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Delete " &amp; tagTestSubject::tag  &amp; "'s " &amp; "test number " &amp; tagTestSubjectLocation::reportNumber   &amp; " of " &amp;  tagTestSubjectLocation::focusName &amp; "?"; Buttons: &ldquo;Cancel&rdquo;, &ldquo;Delete&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>End If</li>
<li>Go to Layout [ original layout ]</li>
<li>Set Variable [ $delete ]</li>
<li>Refresh Window</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagTestSubjectLocation</em>::_LtestSubjectLocation</li>
<li>
<em>tagTestSubjectLocation</em>::inUse</li>
<li>
<em>tagTestSubjectLocation</em>::kfocus</li>
<li>
<em>tagTestSubject</em>::tag</li>
<li>
<em>tagTestSubjectLocation</em>::reportNumber</li>
<li>
<em>tagTestSubjectLocation</em>::focusName</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32973ScriptAnchor_"></a><td class="script_navbar"><a href="#32825ScriptAnchor_"><span>Previous Script: [deleteInspectionLocation]</span></a></td><td class="script_navbar"><a href="#33313ScriptAnchor_"><span>Parent Folder: [testReport]</span></a></td><td class="script_navbar"><a href="#32846ScriptAnchor_"><span>Next Script: [deleteSetupItems]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">evidenceTag</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Variable [ $$listlayout; Value:"listTag" ]</li>
<li>Perform Script [ &ldquo;evidenceDetailSpacetimeDELETE?????&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32822ScriptAnchor_">evidenceDetailSpacetimeDELETE?????</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32846ScriptAnchor_"></a><td class="script_navbar"><a href="#32973ScriptAnchor_"><span>Previous Script: [evidenceTag]</span></a></td><td class="script_navbar"><a href="#33313ScriptAnchor_"><span>Parent Folder: [testReport]</span></a></td><td class="script_navbar"><a href="#32823ScriptAnchor_"><span>Next Script: [deleteInspectionSetupItem]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">deleteSetupItems</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Go to Object [ Object Name: "item" ]</li>
<li>If [ test::_Ltest  &ne;  "" ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "You can delete this record only after you delete all items assigned to this category in these location(s)."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Go to Field [  ]</li>
<li>Delete Record/Request</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>test</em>::_Ltest</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32823ScriptAnchor_"></a><td class="script_navbar"><a href="#32846ScriptAnchor_"><span>Previous Script: [deleteSetupItems]</span></a></td><td class="script_navbar"><a href="#33313ScriptAnchor_"><span>Parent Folder: [testReport]</span></a></td><td class="script_navbar"><a href="#32809ScriptAnchor_"><span>Next Script: [editReport]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">deleteInspectionSetupItem</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ test::_Ltest = "" ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Set Variable [ $deleteItem; Value:test::_Ltest ]</li>
<li>Set Variable [ $name; Value:test::testName ]</li>
<li>Refresh Window</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Delete " &amp; $name &amp; "?"; Buttons: &ldquo;Cancel&rdquo;, &ldquo;Delete&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Delete Portal Row
[ No dialog ]</li>
<li>End If</li>
<li>Set Variable [ $deleteItem ]</li>
<li>Refresh Window</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>test</em>::_Ltest</li>
<li>
<em>test</em>::testName</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32809ScriptAnchor_"></a><td class="script_navbar"><a href="#32823ScriptAnchor_"><span>Previous Script: [deleteInspectionSetupItem]</span></a></td><td class="script_navbar"><a href="#33313ScriptAnchor_"><span>Parent Folder: [testReport]</span></a></td><td class="script_navbar"><a href="#32905ScriptAnchor_"><span>Next Script: [CHUNK_gotoItemViaPulldown]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">editReport</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32899ScriptAnchor_">reportDeleteEvidence</a></li>
<li><a href="#33167ScriptAnchor_">printThingReport</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Field [ TEMP::kuserLocation; "" ]</li>
<li>Set Variable [ $$TSRecordNumber; Value:Get (RecordNumber) ]</li>
<li>Set Variable [ $$stopLoadReportRecord; Value:1 ]</li>
<li>#</li>
<li>#used for item pulldown selection on report layout</li>
<li>Set Field [ TEMP::kdefaultNodeTestSubject; tagTestSubjectLocation::knode ]</li>
<li>Set Field [ TEMP::kabout; TEMP::kdefaultNodeTestSubject ]</li>
<li>Set Variable [ $$contact; Value:TEMP::kdefaultNodeTestSubject ]</li>
<li>#</li>
<li>#clear global fields for creating new discovery </li>
<li>#records, but put in current timestamp to help</li>
<li>#user understand how info sould be put into </li>
<li>#the timestample field and for easy editing, </li>
<li>#changing date, time, etc.</li>
<li>Set Field [ testlearnReportTags::gkaudienceLocation; "" ]</li>
<li>Set Field [ TEMP::LocationName; "" ]</li>
<li>Set Field [ TEMP::TimeStamp; Get ( CurrentTimeStamp ) ]</li>
<li>#</li>
<li>If [ TEMP::ksection = "" ]</li>
<li>Go to Field [ TEMP::ksection ]
[ Select/perform ]</li>
<li>Show Custom Dialog [ Message: "Select a section before editing a report."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Halt Script</li>
<li>Else If [ TEMP::reportNumber = "" ]</li>
<li>Set Field [  ]</li>
<li>Go to Field [ TEMP::reportNumber ]
[ Select/perform ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Set Variable [ $$library; Value:TEMP::ksection ]</li>
<li>Set Variable [ $$reportNumber; Value:tagTestSubjectLocation::reportNumber ]</li>
<li>Set Field [ TEMP::reportNumber; tagTestSubjectLocation::reportNumber ]</li>
<li>#</li>
<li>#go to correct layout for final part of script to</li>
<li>#to find discoveries for the report item.</li>
<li>Set Field [ TEMP::showFavorites; "" ]</li>
<li>Go to Layout [ &ldquo;reportTagDiscovery&rdquo; (testlearnReportTags) ]</li>
<li>#</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>Set Field [ TEMP::testerAndsubject; //tagDefaultNodePrimary::tag &amp; " testing "  &amp; &para; &amp; $testsubjectName  &amp; "'s"&amp; &para;  &amp; tempSetup::sectionName

//$testsubjectName  &amp; &para; &amp; $$locationName  &amp;  &para; &amp;  tempSetup::sectionName

//tempSetup::sectionName &amp; " | " &amp;  $testsubjectName

tempSetup::sectionName &amp; " | " &amp;  tagDefaultTestSubject::tag  &amp; " | " &amp;  "report "  &amp; $$reportNumber ]</li>
<li>Set Window Title [ Current Window; New Title: "Report" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>#</li>
<li>#find all report pages first, then sort them alphabetically</li>
<li>#and go to the first records.  Use this one to find</li>
<li>#only report records for this item.</li>
<li>Enter Find Mode [  ]</li>
<li>Go to Layout [ &ldquo;PrintReportEdit&rdquo; (report) ]</li>
<li>Set Field [ report::ktestSubject; $$contact ]</li>
<li>Set Field [ report::kreportNumber; $$reportNumber ]</li>
<li>Set Field [ report::ksection; $$library ]</li>
<li>Perform Find [  ]</li>
<li>If [ Get (LastError)  = 401 ]</li>
<li>Perform Script [ &ldquo;returnToStep2&rdquo; ]</li>
<li>Show Custom Dialog [ Message: "No test discoveries to report on."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Set Variable [ $$stopLoadReportRecord ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Set Variable [ $$stopLoadReportRecord ]</li>
<li>Sort Records [ Specified Sort Order: ruleTestReport::name; ascending
reportItem::testName; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>#Use this first record to find</li>
<li>#only report records for this item.</li>
<li>#****haven't decided to use globals or $$variables.  Since $$item is used in many other scripts I'm capturing it here.</li>
<li>Set Field [ TEMP::testName; reportItem::testName ]</li>
<li>Set Field [ TEMP::ktest; report::ktest ]</li>
<li>Set Field [ TEMP::ktestItemList; report::ktest ]</li>
<li>Set Variable [ $$item; Value:report::ktest ]</li>
<li>Set Variable [ $$first; Value:report::ktest ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ report::ktestSubject; $$contact ]</li>
<li>Set Field [ report::kreportNumber; $$reportNumber ]</li>
<li>Set Field [ report::ksection; $$library ]</li>
<li>Set Field [ report::ktest; TEMP::ktest ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: report::ktest; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>View As
[ View as List ]</li>
<li>Scroll Window
[ Home ]</li>
<li>#</li>
<li>#Now find discoveries for this report item.</li>
<li>Perform Script [ &ldquo;CHUNK_gotoItemViaPulldown&rdquo; ]</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::kuserLocation</li>
<li>
<em>tagTestSubjectLocation</em>::knode</li>
<li>
<em>TEMP</em>::kdefaultNodeTestSubject</li>
<li>
<em>TEMP</em>::kabout</li>
<li>
<em>testlearnReportTags</em>::gkaudienceLocation</li>
<li>
<em>TEMP</em>::LocationName</li>
<li>
<em>TEMP</em>::TimeStamp</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>TEMP</em>::reportNumber</li>
<li>
<em>tagTestSubjectLocation</em>::reportNumber</li>
<li>
<em>TEMP</em>::showFavorites</li>
<li>
<em>tempSetup</em>::sectionName</li>
<li>
<em>tagDefaultTestSubject</em>::tag</li>
<li>
<em>TEMP</em>::testerAndsubject</li>
<li>
<em>report</em>::ktestSubject</li>
<li>
<em>report</em>::kreportNumber</li>
<li>
<em>report</em>::ksection</li>
<li>
<em>ruleTestReport</em>::name</li>
<li>
<em>reportItem</em>::testName</li>
<li>
<em>TEMP</em>::testName</li>
<li>
<em>report</em>::ktest</li>
<li>
<em>TEMP</em>::ktest</li>
<li>
<em>TEMP</em>::ktestItemList</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32856ScriptAnchor_">returnToStep2</a></li>
<li><a href="#32905ScriptAnchor_">CHUNK_gotoItemViaPulldown</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>reportTagDiscovery</li>
<li>PrintReportEdit</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32905ScriptAnchor_"></a><td class="script_navbar"><a href="#32809ScriptAnchor_"><span>Previous Script: [editReport]</span></a></td><td class="script_navbar"><a href="#33313ScriptAnchor_"><span>Parent Folder: [testReport]</span></a></td><td class="script_navbar"><a href="#32962ScriptAnchor_"><span>Next Script: [zoomReport]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">CHUNK_gotoItemViaPulldown</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32809ScriptAnchor_">editReport</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Field [ TEMP::kuserLocation; "" ]</li>
<li>#[by David Matson 4.16.11, last modified by same 4.18.11]</li>
<li>#clear the $$finding and $window variables</li>
<li>Set Variable [ $$finding ]</li>
<li>Set Variable [ $$window ]</li>
<li>Set Variable [ $contact; Value:report::ktestSubject ]</li>
<li>Set Variable [ $item; Value:TEMP::ktest ]</li>
<li>#</li>
<li>#clear global fields for creating new discovery </li>
<li>#records, but put in current timestamp to help</li>
<li>#user understand how info sould be put into </li>
<li>#the timestample field and for easy editing, </li>
<li>#changing date, time, etc.</li>
<li>Set Field [ testlearnReportTags::gkaudienceLocation; "" ]</li>
<li>Set Field [ TEMP::LocationName; "" ]</li>
<li>Set Field [ TEMP::TimeStamp; Get ( CurrentTimeStamp ) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ report::ktestSubject; $contact ]</li>
<li>Set Field [ report::ktest; $item ]</li>
<li>Set Field [ report::kreportNumber; $$reportNumber ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: report::ktest; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#****haven't decided to use globals or $$variables.  Since $$item is used in many other scripts I'm capturing it here.</li>
<li>Set Field [ TEMP::ktest; report::ktest ]</li>
<li>Set Field [ TEMP::ktestItemList; report::ktest ]</li>
<li>Set Variable [ $$item; Value:report::ktest ]</li>
<li>Set Field [ TEMP::testName; reportItem::testName ]</li>
<li>Set Field [ TEMP::showFavorites; "" ]</li>
<li>#</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>If [ Get (LastError)  = 112 ]</li>
<li>New Window [ Name: "Tag Menus"; Height: Get ( ScreenHeight ); Width: 330; Left: 0 ]</li>
<li>Go to Layout [ &ldquo;reportTagDiscovery&rdquo; (testlearnReportTags) ]</li>
<li>End If</li>
<li>If [ Left ( Get (LayoutName) ; 18 ) = "reportTagDiscovery" ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearnReportTags::ktestSubject; TEMP::kdefaultNodeTestSubject ]</li>
<li>Set Field [ testlearnReportTags::ktest; TEMP::ktest ]</li>
<li>Set Field [ testlearnReportTags::kreportNumber; TEMP::reportNumber ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: testlearnReportTags::Location; ascending
testlearnReportTags::timestamp; ascending
testlearnReportTags::_Ltestlearn; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ Left ( Get (LayoutName) ; 13 ) = "reportTagInfo" ]</li>
<li>Perform Script [ &ldquo;reportTagInfo&rdquo; ]</li>
<li>Else</li>
<li>#</li>
<li>#Find test list key as it may be different from test key.</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>Set Variable [ $$stopTest; Value:1 ]</li>
<li>Set Variable [ $$ID; Value:"ignore" ]</li>
<li>Go to Layout [ &ldquo;testSetup&rdquo; (test) ]</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ test::_Ltest; TEMP::ktest ]</li>
<li>Perform Find [  ]</li>
<li>Set Field [ TEMP::ktestItemList; test::ktestItemList ]</li>
<li>Go to Layout [ &ldquo;reportTagItem&rdquo; (tagMenus) ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Set Variable [ $$stopTest ]</li>
<li>Set Variable [ $$ID ]</li>
<li>#</li>
<li>#Find test items for section.  </li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ ruleTagMenuTestGroups::match; TEMP::ktestItemList &amp; &para; ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuTestGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuTestGroups::name; ascending
ruleTagMenuTestGroups::_Lgroup; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>End If</li>
<li>Select Window [ Name: "Report"; Current file ]</li>
<li>#[validated by David Matson 4.18.11]</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::kuserLocation</li>
<li>
<em>report</em>::ktestSubject</li>
<li>
<em>TEMP</em>::ktest</li>
<li>
<em>testlearnReportTags</em>::gkaudienceLocation</li>
<li>
<em>TEMP</em>::LocationName</li>
<li>
<em>TEMP</em>::TimeStamp</li>
<li>
<em>report</em>::ktest</li>
<li>
<em>report</em>::kreportNumber</li>
<li>
<em>TEMP</em>::ktestItemList</li>
<li>
<em>reportItem</em>::testName</li>
<li>
<em>TEMP</em>::testName</li>
<li>
<em>TEMP</em>::showFavorites</li>
<li>
<em>TEMP</em>::kdefaultNodeTestSubject</li>
<li>
<em>testlearnReportTags</em>::ktestSubject</li>
<li>
<em>testlearnReportTags</em>::ktest</li>
<li>
<em>TEMP</em>::reportNumber</li>
<li>
<em>testlearnReportTags</em>::kreportNumber</li>
<li>
<em>testlearnReportTags</em>::Location</li>
<li>
<em>testlearnReportTags</em>::timestamp</li>
<li>
<em>testlearnReportTags</em>::_Ltestlearn</li>
<li>
<em>TEMP</em>::DetailmoreORLessLayout</li>
<li>
<em>test</em>::_Ltest</li>
<li>
<em>test</em>::ktestItemList</li>
<li>
<em>ruleTagMenuTestGroups</em>::match</li>
<li>
<em>ruleTagMenuTestGroups</em>::order</li>
<li>
<em>ruleTagMenuTestGroups</em>::name</li>
<li>
<em>ruleTagMenuTestGroups</em>::_Lgroup</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>tagMenus</em>::tag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33135ScriptAnchor_">reportTagInfo</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>reportTagDiscovery</li>
<li>testSetup</li>
<li>reportTagItem</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32962ScriptAnchor_"></a><td class="script_navbar"><a href="#32905ScriptAnchor_"><span>Previous Script: [CHUNK_gotoItemViaPulldown]</span></a></td><td class="script_navbar"><a href="#33313ScriptAnchor_"><span>Parent Folder: [testReport]</span></a></td><td class="script_navbar"><a href="#32963ScriptAnchor_"><span>Next Script: [unzoomReport]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">zoomReport</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Variable [ $$first ]</li>
<li>Set Variable [ $$last; Value:report::ktest ]</li>
<li>Set Field [ TEMP::kuserLocation; "" ]</li>
<li>#[by David Matson 4.16.11, last modified by same 4.18.11]</li>
<li>#clear the $$finding and $window variables</li>
<li>Set Variable [ $$finding ]</li>
<li>Set Variable [ $$window ]</li>
<li>Set Variable [ $contact; Value:report::ktestSubject ]</li>
<li>Set Variable [ $item; Value:report::ktest ]</li>
<li>#basic administration tasks</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>If [ Get (LastError)  = 112 ]</li>
<li>New Window [ Name: "Tag Menus"; Height: Get ( ScreenHeight ); Width: 480; Top: 0; Left: 0 ]</li>
<li>Go to Layout [ &ldquo;reportTagDiscovery&rdquo; (testlearnReportTags) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearnReportTags::ktestSubject; $contact ]</li>
<li>Set Field [ testlearnReportTags::ktest; $item ]</li>
<li>Set Field [ testlearnReportTags::kreportNumber; $$reportNumber ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: testlearnReportTags::Location; ascending
testlearnReportTags::timestamp; ascending
testlearnReportTags::_Ltestlearn; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>Set Zoom Level
[ 150% ]</li>
<li>Move/Resize Window [ Current Window; Height: Get ( ScreenHeight ); Width: 

If ( Get (ScreenWidth) - 933 - 492 &ge; 0 ; Get ( ScreenWidth ) - 933 ; 492 ); Top: 0; Left: If ( Get (ScreenWidth) - 933 - 492 &ge; 0 ; 933 ; Get (ScreenWidth) - 492 ) ]</li>
<li>//  If [ Get (WindowZoomLevel)  = 100 ]</li>
<li>//  Move/Resize Window [ Current Window; Height: Get ( ScreenHeight ); Width: 480; Top: 0; Left: 0 ]</li>
<li>//  Set Zoom Level
[ 150% ]</li>
<li>//  Else If [ Get (WindowZoomLevel)  = 150 ]</li>
<li>//  Move/Resize Window [ Current Window; Height: Get ( ScreenHeight ); Width: 634; Top: 0; Left: 0 ]</li>
<li>//  Set Zoom Level
[ 200% ]</li>
<li>//  Else If [ Get (WindowZoomLevel)  = 200 ]</li>
<li>//  Move/Resize Window [ Current Window; Height: Get ( ScreenHeight ); Width: 942; Top: 0; Left: 0 ]</li>
<li>//  Set Zoom Level
[ 300% ]</li>
<li>//  End If</li>
<li>Select Window [ Name: "Report"; Current file ]</li>
<li>Move/Resize Window [ Current Window; Height: Get ( ScreenHeight ); Width: 933; Top: 0; Left: 0 ]</li>
<li>Set Zoom Level
[ 150% ]</li>
<li>If [ Get (LastError)  = 112 ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>report</em>::ktest</li>
<li>
<em>TEMP</em>::kuserLocation</li>
<li>
<em>report</em>::ktestSubject</li>
<li>
<em>testlearnReportTags</em>::ktestSubject</li>
<li>
<em>testlearnReportTags</em>::ktest</li>
<li>
<em>testlearnReportTags</em>::kreportNumber</li>
<li>
<em>testlearnReportTags</em>::Location</li>
<li>
<em>testlearnReportTags</em>::timestamp</li>
<li>
<em>testlearnReportTags</em>::_Ltestlearn</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>reportTagDiscovery</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32963ScriptAnchor_"></a><td class="script_navbar"><a href="#32962ScriptAnchor_"><span>Previous Script: [zoomReport]</span></a></td><td class="script_navbar"><a href="#33313ScriptAnchor_"><span>Parent Folder: [testReport]</span></a></td><td class="script_navbar"><a href="#32802ScriptAnchor_"><span>Next Script: [inUsePart1]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">unzoomReport</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Variable [ $$first ]</li>
<li>Set Variable [ $$last; Value:report::ktest ]</li>
<li>Set Field [ TEMP::kuserLocation; "" ]</li>
<li>#[by David Matson 4.16.11, last modified by same 4.18.11]</li>
<li>#clear the $$finding and $window variables</li>
<li>Set Variable [ $$finding ]</li>
<li>Set Variable [ $$window ]</li>
<li>Set Variable [ $contact; Value:report::ktestSubject ]</li>
<li>Set Variable [ $item; Value:report::ktest ]</li>
<li>#basic administration tasks</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>If [ Get (LastError)  = 112 ]</li>
<li>New Window [ Name: "Tag Menu"; Height: Get ( ScreenHeight ); Width: Get ( ScreenWidth ) / 2; Top: 0; Left: Get ( ScreenWidth ) / 2 ]</li>
<li>Go to Layout [ &ldquo;reportTagDiscovery&rdquo; (testlearnReportTags) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearnReportTags::ktestSubject; $contact ]</li>
<li>Set Field [ testlearnReportTags::ktest; $item ]</li>
<li>Set Field [ testlearnReportTags::kreportNumber; $$reportNumber ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: testlearnReportTags::Location; ascending
testlearnReportTags::timestamp; ascending
testlearnReportTags::_Ltestlearn; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>Move/Resize Window [ Current Window; Height: Get ( ScreenHeight ); Width: Get ( ScreenWidth ) / 2; Top: 0; Left: Get ( ScreenWidth ) / 2 ]</li>
<li>Set Zoom Level
[ 100% ]</li>
<li>//  If [ Get (WindowZoomLevel)  = 100 ]</li>
<li>//  Move/Resize Window [ Current Window; Height: Get ( ScreenHeight ); Width: 480; Top: 0; Left: 0 ]</li>
<li>//  Set Zoom Level
[ 150% ]</li>
<li>//  Else If [ Get (WindowZoomLevel)  = 150 ]</li>
<li>//  Move/Resize Window [ Current Window; Height: Get ( ScreenHeight ); Width: 634; Top: 0; Left: 0 ]</li>
<li>//  Set Zoom Level
[ 200% ]</li>
<li>//  Else If [ Get (WindowZoomLevel)  = 200 ]</li>
<li>//  Move/Resize Window [ Current Window; Height: Get ( ScreenHeight ); Width: 942; Top: 0; Left: 0 ]</li>
<li>//  Set Zoom Level
[ 300% ]</li>
<li>//  End If</li>
<li>Select Window [ Name: "Report"; Current file ]</li>
<li>Move/Resize Window [ Current Window; Height: Get ( ScreenHeight ); Width: Get ( ScreenWidth ) / 2; Top: 0; Left: 0 ]</li>
<li>Set Zoom Level
[ 100% ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>report</em>::ktest</li>
<li>
<em>TEMP</em>::kuserLocation</li>
<li>
<em>report</em>::ktestSubject</li>
<li>
<em>testlearnReportTags</em>::ktestSubject</li>
<li>
<em>testlearnReportTags</em>::ktest</li>
<li>
<em>testlearnReportTags</em>::kreportNumber</li>
<li>
<em>testlearnReportTags</em>::Location</li>
<li>
<em>testlearnReportTags</em>::timestamp</li>
<li>
<em>testlearnReportTags</em>::_Ltestlearn</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>reportTagDiscovery</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32802ScriptAnchor_"></a><td class="script_navbar"><a href="#32963ScriptAnchor_"><span>Previous Script: [unzoomReport]</span></a></td><td class="script_navbar"><a href="#33313ScriptAnchor_"><span>Parent Folder: [testReport]</span></a></td><td class="script_navbar"><a href="#32803ScriptAnchor_"><span>Next Script: [inUsePart3]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">inUsePart1</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>If [ $$finding &ne; "" ]</li>
<li>Set Variable [ $$Finding ]</li>
<li>Go to Field [  ]</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Report"; Current file ]</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>If [ testlearnReportTags::ktestSubject &amp; $$reportNumber &amp; "&para;" = FilterValues ( testlearnReportTags::inUse ; $$contact &amp; $$reportNumber) ]</li>
<li>Go to Field [  ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Already in use on this section of the report.  Click on " &amp; testlearnReportTags::_Number &amp; " on the Report screen to begin the process of moving it to a different slot.  Click on a different slot to complete the move."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Set Variable [ $$finding; Value:testlearnReportTags::_Ltestlearn ]</li>
<li>Set Variable [ $$window; Value:"Tag Menus" ]</li>
<li>Go to Field [  ]</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Report"; Current file ]</li>
<li>Refresh Window</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearnReportTags</em>::ktestSubject</li>
<li>
<em>testlearnReportTags</em>::inUse</li>
<li>
<em>testlearnReportTags</em>::_Number</li>
<li>
<em>testlearnReportTags</em>::_Ltestlearn</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32803ScriptAnchor_"></a><td class="script_navbar"><a href="#32802ScriptAnchor_"><span>Previous Script: [inUsePart1]</span></a></td><td class="script_navbar"><a href="#33313ScriptAnchor_"><span>Parent Folder: [testReport]</span></a></td><td class="script_navbar"><a href="#32808ScriptAnchor_"><span>Next Script: [deleteRowOfPhotosFromReport]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">inUsePart3</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32951ScriptAnchor_">inUsePart2picture1</a></li>
<li><a href="#32952ScriptAnchor_">inUsePart2picture2</a></li>
<li><a href="#32953ScriptAnchor_">inUsePart2picture3</a></li>
<li><a href="#32954ScriptAnchor_">inUsePart2picture4</a></li>
<li><a href="#33146ScriptAnchor_">inUsePart2picture3 Copy</a></li>
<li><a href="#33147ScriptAnchor_">inUsePart2picture4 Copy</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>//  #Determine if record is a discovery or info record.</li>
<li>//  #This information will be used by other parts of </li>
<li>//  #this script to figure out which Tag Menu layout</li>
<li>//  #to go to when neccessary: discover or info.</li>
<li>//  If [  ]</li>
<li>//  End If</li>
<li>#</li>
<li>#BEGIN A</li>
<li>#[by David Matson 4.18.11, last modified by ]</li>
<li>#If user has selected to copy a finding from the Report window</li>
<li>#to remove it or to move it to another slot...</li>
<li>If [ Get ( ActiveFieldName ) = "_kfPhoto"  and  $$finding = ""   or 
Get ( ActiveFieldName ) = "_kfPhoto2"  and  $$finding = "" or 
Get ( ActiveFieldName ) = "_kfPhoto3"  and  $$finding = "" or 
Get ( ActiveFieldName ) = "_kfPhoto4"  and  $$finding = "" ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN a1</li>
<li>#[by David Matson 4.18.11, last modified by ]</li>
<li>#If user is trying to copy blank field</li>
<li>#stop the script</li>
<li>If [ $$finding = "" and Get (ActiveFieldContents) = "" ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#[validated by David Matson 4.18.11]</li>
<li>#END a1</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#copy it</li>
<li>Set Variable [ $$finding; Value:Get ( ActiveFieldContents ) ]</li>
<li>Set Variable [ $$window; Value:"Report" ]</li>
<li>Refresh Window</li>
<li>Clear [  ]
[ Select ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Inform user of where tag is now located by changing</li>
<li>#conditional formatting: green = in use,</li>
<li>#yellow = reaady to paste, normal colors = not</li>
<li>#use and not copied for pasting.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>If [ Get (LayoutName) &ne; "reportTagDiscovery" ]</li>
<li>Perform Script [ &ldquo;reportTagDiscovery&rdquo; ]</li>
<li>End If</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#find the record that has been copied and cleared</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$finding = testlearnReportTags::_Ltestlearn ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#If it is not a discovery record, go to the info layout.</li>
<li>If [ $$finding &ne; testlearnReportTags::_Ltestlearn ]</li>
<li>Perform Script [ &ldquo;reportTagInfo&rdquo; ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Variable [ $$stoploadtestinfo; Value:1 ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$finding = testlearnReportTags::_Ltestlearn ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Set Variable [ $$stoploadtestinfo ]</li>
<li>Perform Script [ &ldquo;loadtestinfo&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>#inform the user that it is not being used in the Report window</li>
<li>#by removing it from the list of inUse report sections,</li>
<li>#basically removing it from showing on this page but</li>
<li>#not the other pages it is currently being used by.</li>
<li>Set Variable [ $inUse; Value:testlearnReportTags::inUse ]</li>
<li>Set Field [ testlearnReportTags::inUse; Substitute ( testlearnReportTags::inUse ; $$contact &amp; $$reportNumber &amp; "&para;" ; "" ) ]</li>
<li>#</li>
<li>Select Window [ Name: "Report"; Current file ]</li>
<li>Halt Script</li>
<li>#[validated by David Matson 4.18.11]</li>
<li>#END A</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN B</li>
<li>#[by David Matson 4.18.11, last modified by ]</li>
<li>#</li>
<li>#If user has selected to put a copied finding from the Report window, </li>
<li>#into a blank slot,</li>
<li>Else If [ Get ( ActiveFieldName ) = "_kfPhoto"  and Get ( ActiveFieldContents )="" and $$finding  &ne; "" and $$window = "Report"
 or 
Get ( ActiveFieldName ) = "_kfPhoto2"  and Get ( ActiveFieldContents )=""  and $$finding  &ne; "" and $$window = "Report"
 or 
Get ( ActiveFieldName ) = "_kfPhoto3"  and Get ( ActiveFieldContents )=""  and $$finding  &ne; "" and $$window = "Report"
 or 
Get ( ActiveFieldName ) = "_kfPhoto4"  and Get ( ActiveFieldContents )="" and $$finding  &ne; "" and $$window = "Report" ]</li>
<li>#paste ID in blank slot</li>
<li>Set Field [ $$finding ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Inform user of where tag is now located by changing</li>
<li>#conditional formatting: green = in use,</li>
<li>#yellow = reaady to paste, normal colors = not</li>
<li>#use and not copied for pasting.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>If [ Get (LayoutName) &ne; "reportTagDiscovery" ]</li>
<li>Perform Script [ &ldquo;reportTagDiscovery&rdquo; ]</li>
<li>End If</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#find the record that has been copied and cleared</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$finding = testlearnReportTags::_Ltestlearn ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#If it is not a discovery record, go to the info layout.</li>
<li>If [ $$finding &ne; testlearnReportTags::_Ltestlearn ]</li>
<li>Perform Script [ &ldquo;reportTagInfo&rdquo; ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Variable [ $$stoploadtestinfo; Value:1 ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$finding = testlearnReportTags::_Ltestlearn ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Set Variable [ $$stoploadtestinfo ]</li>
<li>Perform Script [ &ldquo;loadtestinfo&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>#inform the user that it is being used in the Report window</li>
<li>#by adding it to the list of report sections where it is used.</li>
<li>#This will increase the used: # by one.</li>
<li>Set Variable [ $inUse; Value:testlearnReportTags::inUse ]</li>
<li>Set Field [ testlearnReportTags::inUse; $inUse  &amp; $$contact &amp; $$reportNumber &amp; "&para;" ]</li>
<li>#</li>
<li>#clear the $$finding and $window variables</li>
<li>Set Variable [ $$finding ]</li>
<li>Set Variable [ $$window ]</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Report"; Current file ]</li>
<li>Refresh Window</li>
<li>Halt Script</li>
<li>#[validated by David Matson 4.18.11]</li>
<li>#END B</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN C</li>
<li>#[by David Matson 4.18.11, last modified by ]</li>
<li>#</li>
<li>#If user has selected to insert a copied finding from the Report window, </li>
<li>#into a slot already occupied,</li>
<li>#PREVENT USER FROM DOING SO.  DISABLE PART C.</li>
<li>Else If [ Get ( ActiveFieldName ) = "_kfPhoto"  and Get ( ActiveFieldContents ) &ne; "" and $$window = "Report"
 or 
Get ( ActiveFieldName ) = "_kfPhoto2"  and Get ( ActiveFieldContents ) &ne; ""  and $$window = "Report"
or 
Get ( ActiveFieldName ) = "_kfPhoto3"  and Get ( ActiveFieldContents ) &ne; "" and $$window = "Report"
 or 
Get ( ActiveFieldName ) = "_kfPhoto4"  and Get ( ActiveFieldContents ) &ne; ""and $$window = "Report" ]</li>
<li>Go to Field [  ]</li>
<li>Show Custom Dialog [ Message: "Click the X button to clear this slot before pasting anything into it.  If you want to copy this item, then 1) click on any green empty slot, 2) re-click on the item want to copy."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>//  #copy the occupying records ID</li>
<li>//  Set Variable [ $ID; Value:Get ( ActiveFieldContents ) ]</li>
<li>//  #paste in the desired records ID in its place (contact and thing IDs are already there)</li>
<li>//  Set Field [ $$finding ]</li>
<li>//  Go to Field [  ]</li>
<li>//  #now go to the Inspection Findings window, note the record the user is on</li>
<li>//  Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>//  Set Variable [ $record; Value:Get ( RecordNumber ) ]</li>
<li>//  Go to Field [  ]</li>
<li>//  #</li>
<li>//  #open new window so as to avoid scroll issue</li>
<li>//  New Window [  ]</li>
<li>//  #</li>
<li>//  #find the record that has been replaced and thus removed from the Report window</li>
<li>//  Enter Find Mode [  ]</li>
<li>//  Set Field [ testlearnReportTags::_Ltestlearn; $ID ]</li>
<li>//  Perform Find [  ]</li>
<li>//  #inform the user that it is not being used in the Report window</li>
<li>//  #by removing it from the list of inUse report sections,</li>
<li>//  #basically removing it from showing on this page but</li>
<li>//  #not the other pages it is currently being used by.</li>
<li>//  Set Variable [ $inUse; Value:testlearnReportTags::inUse ]</li>
<li>//  Set Field [ testlearnReportTags::inUse; Substitute ( testlearnReportTags::inUse ; $$contact &amp; $$reportNumber &amp; "&para;" ; "" ) ]</li>
<li>//  Set Variable [ $ID ]</li>
<li>//  #find the record that has been inserted</li>
<li>//  Enter Find Mode [  ]</li>
<li>//  Set Field [ testlearnReportTags::_Ltestlearn; $$finding ]</li>
<li>//  Perform Find [  ]</li>
<li>//  #inform the user that it is being used in the Report window</li>
<li>//  #by adding it to the list of report sections where it is used</li>
<li>//  Set Variable [ $inUse; Value:testlearnReportTags::inUse ]</li>
<li>//  Set Field [ testlearnReportTags::inUse; testlearnReportTags::inUse  &amp; $$contact &amp; $$reportNumber &amp; "&para;" ]</li>
<li>//  #</li>
<li>//  #finally, re-find the records the user was looking at, and go to specific record the user was on.</li>
<li>//  Set Variable [ $contact; Value:testlearnReportTags::ktestSubject ]</li>
<li>//  Set Variable [ $item; Value:testlearnReportTags::ktest ]</li>
<li>//  Enter Find Mode [  ]</li>
<li>//  Set Field [ testlearnReportTags::ktestSubject; $contact ]</li>
<li>//  Set Field [ testlearnReportTags::ktest; $item ]</li>
<li>//  Set Field [ testlearnReportTags::kreportNumber; $$reportNumber ]</li>
<li>//  Perform Find [  ]</li>
<li>//  If [ TEMP::showFavorites &ne; "" ]</li>
<li>//  Set Field [ TEMP::showFavorites; "" ]</li>
<li>//  Perform Script [ &ldquo;&lt;unknown&gt;&rdquo; ]</li>
<li>//  Else If [ TEMP::showFavorites = "" ]</li>
<li>//  Sort Records [ Specified Sort Order: testlearnReportTags::_Ltestlearn; ascending ]
[ Restore; No dialog ]</li>
<li>//  Go to Record/Request/Page [ $record ]
[ No dialog ]</li>
<li>//  End If</li>
<li>//  #clear the $$finding and $window variables</li>
<li>//  Set Variable [ $$finding ]</li>
<li>//  Set Variable [ $$window ]</li>
<li>//  Close Window [ Current Window ]</li>
<li>//  Halt Script</li>
<li>//  #[validated by David Matson 4.18.11]</li>
<li>//  #END C</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN D</li>
<li>#[by David Matson 4.18.11, last modified by ]</li>
<li>#If user has selected to insert a finding from the finding window</li>
<li>#into an occupied slot on the Report window</li>
<li>#PREVENT USER FROM DOING SO.  DISABLE PART C.</li>
<li>Else If [ Get ( ActiveFieldName ) = "_kfPhoto" and Get ( ActiveFieldContents ) &ne; "" and $$window = "Tag Menus"
 or 
Get ( ActiveFieldName ) = "_kfPhoto2"  and Get ( ActiveFieldContents ) &ne; ""  and $$window = "Tag Menus"
or 
Get ( ActiveFieldName ) = "_kfPhoto3"  and Get ( ActiveFieldContents ) &ne; "" and $$window = "Tag Menus"
 or 
Get ( ActiveFieldName ) = "_kfPhoto4"  and Get ( ActiveFieldContents ) &ne; ""and $$window = "Tag Menus" ]</li>
<li>Go to Field [  ]</li>
<li>Show Custom Dialog [ Message: "Click the X button to clear this slot before pasting anything into it.  If you want to copy this item, then 1) click on any green empty slot, 2) re-click on the item want to copy."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>//  #</li>
<li>//  #</li>
<li>//  #</li>
<li>//  #BEGIN d1</li>
<li>//  #[by David Matson 4.18.11, last modified by ]</li>
<li>//  #If user is trying to copy the same finding into the location it currently occupies</li>
<li>//  #stop the script</li>
<li>//  Set Variable [ $ID; Value:Get ( ActiveFieldContents ) ]</li>
<li>//  If [ $$finding = $ID ]</li>
<li>//  Go to Field [  ]</li>
<li>//  Set Variable [ $$finding ]</li>
<li>//  Halt Script</li>
<li>//  End If</li>
<li>//  #[validated by David Matson 4.18.11]</li>
<li>//  #END d1</li>
<li>//  #</li>
<li>//  #</li>
<li>//  #</li>
<li>//  #paste in the desired records ID in its place (contact and thing IDs are already there)</li>
<li>//  Set Field [ $$finding ]</li>
<li>//  Go to Field [  ]</li>
<li>//  #tell user it is now in use</li>
<li>//  #by adding it to the list of report sections where it is used</li>
<li>//  Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>//  Set Variable [ $inUse; Value:testlearnReportTags::inUse ]</li>
<li>//  Set Field [ testlearnReportTags::inUse; testlearnReportTags::inUse  &amp; $$contact &amp; $$reportNumber &amp; "&para;" ]</li>
<li>//  #clear the $$finding variable</li>
<li>//  Set Variable [ $$finding ]</li>
<li>//  Set Variable [ $$window ]</li>
<li>//  #note the record the user is on</li>
<li>//  Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>//  Set Variable [ $record; Value:Get ( RecordNumber ) ]</li>
<li>//  Go to Field [  ]</li>
<li>//  #</li>
<li>//  #open new window so as to avoid scroll issue</li>
<li>//  New Window [  ]</li>
<li>//  #</li>
<li>//  #find the record that has been replaced and thus removed from the Report window</li>
<li>//  Enter Find Mode [  ]</li>
<li>//  Set Field [ testlearnReportTags::_Ltestlearn; $ID ]</li>
<li>//  Perform Find [  ]</li>
<li>//  #inform the user that it is not being used in the Report window</li>
<li>//  #by removing it from the list of inUse report sections,</li>
<li>//  #basically removing it from showing on this page but</li>
<li>//  #not the other pages it is currently being used by.</li>
<li>//  Set Variable [ $inUse; Value:testlearnReportTags::inUse ]</li>
<li>//  Set Field [ testlearnReportTags::inUse; Substitute ( testlearnReportTags::inUse ; $$contact &amp; $$reportNumber &amp; "&para;" ; "" ) ]</li>
<li>//  Set Variable [ $ID ]</li>
<li>//  #</li>
<li>//  #finally, re-find the records the user was looking at, and go to specific record the user was on.</li>
<li>//  Set Variable [ $contact; Value:testlearnReportTags::ktestSubject ]</li>
<li>//  Set Variable [ $item; Value:testlearnReportTags::ktest ]</li>
<li>//  Enter Find Mode [  ]</li>
<li>//  Set Field [ testlearnReportTags::ktestSubject; $contact ]</li>
<li>//  Set Field [ testlearnReportTags::ktest; $item ]</li>
<li>//  Set Field [ testlearnReportTags::kreportNumber; $$reportNumber ]</li>
<li>//  Perform Find [  ]</li>
<li>//  If [ TEMP::showFavorites &ne; "" ]</li>
<li>//  Set Field [ TEMP::showFavorites; "" ]</li>
<li>//  Perform Script [ &ldquo;&lt;unknown&gt;&rdquo; ]</li>
<li>//  Else If [ TEMP::showFavorites = "" ]</li>
<li>//  Sort Records [ Specified Sort Order: testlearnReportTags::_Ltestlearn; ascending ]
[ Restore; No dialog ]</li>
<li>//  Go to Record/Request/Page [ $record ]
[ No dialog ]</li>
<li>//  End If</li>
<li>//  Close Window [ Current Window ]</li>
<li>//  Go to Field [  ]</li>
<li>//  Halt Script</li>
<li>End If</li>
<li>#END D</li>
<li>#[validated by David Matson 4.18.11]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN E</li>
<li>#[by David Matson 4.16.11, last modified by same 4.18.11]</li>
<li>#If user has selected to copy of a finding from the finding window</li>
<li>#into a blank slot on the report window, put it in there</li>
<li>Set Field [ $$finding ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Inform user of where tag is now located by changing</li>
<li>#conditional formatting: green = in use,</li>
<li>#yellow = reaady to paste, normal colors = not</li>
<li>#use and not copied for pasting.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>If [ Get (LayoutName) &ne; "reportTagDiscovery" ]</li>
<li>Perform Script [ &ldquo;reportTagDiscovery&rdquo; ]</li>
<li>End If</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#find the record that has been copied and cleared</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$finding = testlearnReportTags::_Ltestlearn ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#If it is not a discovery record, go to the info layout.</li>
<li>If [ $$finding &ne; testlearnReportTags::_Ltestlearn ]</li>
<li>Perform Script [ &ldquo;reportTagInfo&rdquo; ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Variable [ $$stoploadtestinfo; Value:1 ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$finding = testlearnReportTags::_Ltestlearn ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Set Variable [ $$stoploadtestinfo ]</li>
<li>Perform Script [ &ldquo;loadtestinfo&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>#inform the user that it is being used in the Report window</li>
<li>#by adding it to the list of report sections where it is used.</li>
<li>#This will increase the used: # by one.</li>
<li>Set Variable [ $inUse; Value:testlearnReportTags::inUse ]</li>
<li>Set Field [ testlearnReportTags::inUse; $inUse  &amp; $$contact &amp; $$reportNumber &amp; "&para;" ]</li>
<li>#</li>
<li>#clear the $$finding and $window variables</li>
<li>Set Variable [ $$finding ]</li>
<li>Set Variable [ $$window ]</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Report"; Current file ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#END E</li>
<li>#[validated by David Matson 4.18.11]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearnReportTags</em>::_Ltestlearn</li>
<li>
<em>testlearnReportTags</em>::inUse</li>
<li>
<em>testlearnReportTags</em>::ktestSubject</li>
<li>
<em>testlearnReportTags</em>::ktest</li>
<li>
<em>testlearnReportTags</em>::kreportNumber</li>
<li>
<em>TEMP</em>::showFavorites</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33139ScriptAnchor_">reportTagDiscovery</a></li>
<li><a href="#33135ScriptAnchor_">reportTagInfo</a></li>
<li><a href="#33136ScriptAnchor_">loadtestinfo</a></li>
<li><a href="#32880ScriptAnchor_">&lt;unknown&gt;</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32808ScriptAnchor_"></a><td class="script_navbar"><a href="#32803ScriptAnchor_"><span>Previous Script: [inUsePart3]</span></a></td><td class="script_navbar"><a href="#33313ScriptAnchor_"><span>Parent Folder: [testReport]</span></a></td><td class="script_navbar"><a href="#32878ScriptAnchor_"><span>Next Script: [newRowOfPhotos]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">deleteRowOfPhotosFromReport</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>If [ Get (RecordNumber) = 1 ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>If [ report::_kfPhoto &ne; ""  or 
report::_kfPhoto2 &ne; ""  or 
report::_kfPhoto3 &ne; ""  or 
report::_kfPhoto4 &ne; "" ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "You may delete this row only after clearing all photo slots."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Set Variable [ $delete; Value:Get (RecordNumber) ]</li>
<li>Refresh Window</li>
<li>Show Custom Dialog [ Message: "Delete this row of photos?"; Buttons: &ldquo;cancel&rdquo;, &ldquo;OK&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>End If</li>
<li>Set Variable [ $delete ]</li>
<li>Refresh Window</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>report</em>::_kfPhoto</li>
<li>
<em>report</em>::_kfPhoto2</li>
<li>
<em>report</em>::_kfPhoto3</li>
<li>
<em>report</em>::_kfPhoto4</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32878ScriptAnchor_"></a><td class="script_navbar"><a href="#32808ScriptAnchor_"><span>Previous Script: [deleteRowOfPhotosFromReport]</span></a></td><td class="script_navbar"><a href="#33313ScriptAnchor_"><span>Parent Folder: [testReport]</span></a></td><td class="script_navbar"><a href="#32879ScriptAnchor_"><span>Next Script: [sortReport]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">newRowOfPhotos</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Variable [ $$item; Value:report::ktest ]</li>
<li>#create new report record and put in all required information</li>
<li>New Record/Request</li>
<li>Set Field [ report::ktestSubject; $$contact ]</li>
<li>Set Field [ report::ktest; $$item ]</li>
<li>Set Field [ report::kreportNumber; $$reportNumber ]</li>
<li>Set Field [ report::ksection; $$library ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>report</em>::ktest</li>
<li>
<em>report</em>::ktestSubject</li>
<li>
<em>report</em>::kreportNumber</li>
<li>
<em>report</em>::ksection</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32879ScriptAnchor_"></a><td class="script_navbar"><a href="#32878ScriptAnchor_"><span>Previous Script: [newRowOfPhotos]</span></a></td><td class="script_navbar"><a href="#33313ScriptAnchor_"><span>Parent Folder: [testReport]</span></a></td><td class="script_navbar"><a href="#32920ScriptAnchor_"><span>Next Script: [editSectionFocuses]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">sortReport</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Sort Records [ Specified Sort Order: report::ktest; ascending ]
[ Restore; No dialog ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>report</em>::ktest</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32920ScriptAnchor_"></a><td class="script_navbar"><a href="#32879ScriptAnchor_"><span>Previous Script: [sortReport]</span></a></td><td class="script_navbar"><a href="#33313ScriptAnchor_"><span>Parent Folder: [testReport]</span></a></td><td class="script_navbar"><a href="#32913ScriptAnchor_"><span>Next Script: [newFocus]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">editSectionFocuses</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32925ScriptAnchor_">newTestGroup</a></li>
<li><a href="#32926ScriptAnchor_">newTest</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If there are no tests, then stop this script as there</li>
<li>#are no test to create things for.</li>
<li>If [ TEMP::ktest = "" ]</li>
<li>Show Custom Dialog [ Message: "There are no tests."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>Go to Layout [ &ldquo;setupTestFocus&rdquo; (tagLocation) ]</li>
<li>#</li>
<li>#Find all test focuses for this test.</li>
<li>#New tests will not have any foci so</li>
<li>#error capture needs to be turned on.</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>View As
[ View as List ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagLocation::ksection; TEMP::ksection ]</li>
<li>Set Field [ tagLocation::match; "focus" ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: tagLocation::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Perform Script [ &ldquo;insureEqualityOfSpellFields&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::ktest</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>tagLocation</em>::ksection</li>
<li>
<em>tagLocation</em>::match</li>
<li>
<em>tagLocation</em>::tag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33227ScriptAnchor_">insureEqualityOfSpellFields</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>setupTestFocus</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32913ScriptAnchor_"></a><td class="script_navbar"><a href="#32920ScriptAnchor_"><span>Previous Script: [editSectionFocuses]</span></a></td><td class="script_navbar"><a href="#33313ScriptAnchor_"><span>Parent Folder: [testReport]</span></a></td><td class="script_navbar"><a href="#32914ScriptAnchor_"><span>Next Script: [deleteFocus]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">newFocus</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If node is currenlty locked then stop script, inform user.</li>
<li>If [ TEMP::nodeLock &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "The default record creation node -- " &amp; TEMP::DEFAULTNodePrimaryName &amp; " -- is locked.  Select this node in the setup tag window and enter the password to unlock it so that you can create new records attributed to it."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If there are no tests, then stop this script as there</li>
<li>#are no test to create things for.</li>
<li>If [ TEMP::ktest = "" ]</li>
<li>Show Custom Dialog [ Message: "There are no tests."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Create new focus that any test in this section could be assigned to.</li>
<li>New Record/Request</li>
<li>Set Field [ tagLocation::ksection; TEMP::ksection ]</li>
<li>Set Field [ tagLocation::match; "focus" ]</li>
<li>Set Field [ tagLocation::kRecordCreatorNode; TEMP::kdefaultNodePrimary ]</li>
<li>Go to Field [ tagLocation::tag ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::nodeLock</li>
<li>
<em>TEMP</em>::DEFAULTNodePrimaryName</li>
<li>
<em>TEMP</em>::ktest</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>tagLocation</em>::ksection</li>
<li>
<em>tagLocation</em>::match</li>
<li>
<em>TEMP</em>::kdefaultNodePrimary</li>
<li>
<em>tagLocation</em>::kRecordCreatorNode</li>
<li>
<em>tagLocation</em>::tag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32914ScriptAnchor_"></a><td class="script_navbar"><a href="#32913ScriptAnchor_"><span>Previous Script: [newFocus]</span></a></td><td class="script_navbar"><a href="#33313ScriptAnchor_"><span>Parent Folder: [testReport]</span></a></td><td class="script_navbar"><a href="#32918ScriptAnchor_"><span>Next Script: [deleteAttribute]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">deleteFocus</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Variable [ $focus; Value:tagLocation::_Ltag ]</li>
<li>Set Variable [ $recordNumber; Value:Get (RecordNumber) ]</li>
<li>#</li>
<li>If [ nodeLockTest::orderOrLock &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "This record is currently locked.  Select the node that created it and enter the password to unlock it, then you will able to start the delete process."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>Go to Layout [ &ldquo;TEMP&rdquo; (TEMP) ]</li>
<li>Show All Records</li>
<li>Delete All Records
[ No dialog ]</li>
<li>#</li>
<li>Go to Layout [ &ldquo;tableTestSubjectFocus&rdquo; (tagTestSubjectLocation) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTestSubjectLocation::kfocus; $focus ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>If [ Get (LastError)  &ne; 401 ]</li>
<li>Loop</li>
<li>Set Variable [ $useList; Value:"Test Subject Focus: " &amp; TextStyleAdd ( tagTestSubjectLocation::focusName  &amp; ": report " &amp; tagTestSubjectLocation::reportNumber; Bold ) &amp; " " &amp; tagTestSubject::tag &amp; "'s "  &amp; nodeLibraryName::name ]</li>
<li>Go to Layout [ &ldquo;TEMP&rdquo; (TEMP) ]</li>
<li>New Record/Request</li>
<li>Set Field [ TEMP::RemoveFocusList; $useList ]</li>
<li>Go to Layout [ &ldquo;tableTestSubjectFocus&rdquo; (tagTestSubjectLocation) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>Go to Layout [ original layout ]</li>
<li>New Window [ Name: "!"; Height: Get (ScreenHeight); Width: Get (ScreenWidth) / 2; Top: 0; Left: Get (ScreenWidth) / 4 ]</li>
<li>Go to Layout [ &ldquo;TEMP&rdquo; (TEMP) ]</li>
<li>View As
[ View as List ]</li>
<li>#</li>
<li>#eliminate duplicate location records</li>
<li>Sort Records [ Specified Sort Order: TEMP::RemoveFocusList; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Variable [ $focus; Value:TEMP::RemoveFocusList ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>If [ TEMP::RemoveFocusList = $focus ]</li>
<li>Omit Record</li>
<li>#</li>
<li>#omit by default moves focus to the next record </li>
<li>#in order to test this next record the focus must move up one record</li>
<li>#</li>
<li>Go to Record/Request/Page
[ Previous ]</li>
<li>#then the script can move down to test this record when it repeats</li>
<li>End If</li>
<li>End Loop</li>
<li>#</li>
<li>Show/Hide Status Area
[ Lock; Hide ]</li>
<li>Show/Hide Text Ruler
[ Hide ]</li>
<li>Pause/Resume Script [ Indefinitely ]</li>
<li>Close Window [ Current Window ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>Go to Layout [ original layout ]</li>
<li>Go to Field [  ]</li>
<li>Go to Record/Request/Page [ $recordNumber ]
[ No dialog ]</li>
<li>Set Variable [ $delete; Value:tagLocation::_Ltag ]</li>
<li>Set Variable [ $name; Value:tagLocation::tag ]</li>
<li>Refresh Window</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Delete " &amp; $name &amp; "?"; Buttons: &ldquo;Cancel&rdquo;, &ldquo;Delete&rdquo; ]</li>
<li>#</li>
<li>If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>If [ tagLocation::_Ltag &amp; "&para;" = FilterValues ( test::kcfocusALL ; tagLocation::_Ltag &amp; "&para;" ) ]</li>
<li>#</li>
<li>#Remove it from the list of inUse focuses.</li>
<li>Set Variable [ $focus; Value:test::kcfocusALL ]</li>
<li>Set Field [ test::kcfocusALL; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used

If ( ValueCount ( test::kcfocusALL ) &ne; ValueCount ( Substitute ( test::kcfocusALL ; tagLocation::_Ltag &amp; "&para;"  ; "" ) ) ; 

Substitute ( test::kcfocusALL ; tagLocation::_Ltag &amp; "&para;"  ; "" ) ; 

Substitute ( test::kcfocusALL ; tagLocation::_Ltag ; "" ) 

) ]</li>
<li>End If</li>
<li>#</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>#</li>
<li>End If</li>
<li>Set Variable [ $delete ]</li>
<li>Refresh Window</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagLocation</em>::_Ltag</li>
<li>
<em>nodeLockTest</em>::orderOrLock</li>
<li>
<em>tagTestSubjectLocation</em>::kfocus</li>
<li>
<em>tagTestSubjectLocation</em>::focusName</li>
<li>
<em>tagTestSubjectLocation</em>::reportNumber</li>
<li>
<em>tagTestSubject</em>::tag</li>
<li>
<em>nodeLibraryName</em>::name</li>
<li>
<em>TEMP</em>::RemoveFocusList</li>
<li>
<em>tagLocation</em>::tag</li>
<li>
<em>test</em>::kcfocusALL</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>TEMP</li>
<li>tableTestSubjectFocus</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32918ScriptAnchor_"></a><td class="script_navbar"><a href="#32914ScriptAnchor_"><span>Previous Script: [deleteFocus]</span></a></td><td class="script_navbar"><a href="#33313ScriptAnchor_"><span>Parent Folder: [testReport]</span></a></td><td class="script_navbar"><a href="#33095ScriptAnchor_"><span>Next Script: [gotoDefaultsOrReport]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">deleteAttribute</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Variable [ $row; Value:Get ( PortalRowNumber ) ]</li>
<li>Go to Field [  ]</li>
<li>Go to Portal Row [ $row ]
[ Select; No dialog ]</li>
<li>Set Variable [ $delete; Value:defaultCopyrightName::_Ltag ]</li>
<li>Set Variable [ $name; Value:defaultCopyrightName::tag ]</li>
<li>Refresh Window</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Delete " &amp; $name &amp; "?"; Buttons: &ldquo;Cancel&rdquo;, &ldquo;Delete&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Delete Portal Row
[ No dialog ]</li>
<li>End If</li>
<li>Set Variable [ $delete ]</li>
<li>Refresh Window</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>defaultCopyrightName</em>::_Ltag</li>
<li>
<em>defaultCopyrightName</em>::tag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33095ScriptAnchor_"></a><td class="script_navbar"><a href="#32918ScriptAnchor_"><span>Previous Script: [deleteAttribute]</span></a></td><td class="script_navbar"><a href="#33313ScriptAnchor_"><span>Parent Folder: [testReport]</span></a></td><td class="script_navbar"><a href="#33050ScriptAnchor_"><span>Next Script: [previewReport]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">gotoDefaultsOrReport</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Determine what module is active and then go</li>
<li>#to the setup module if ...</li>
<li>If [ $$learnRecord = "" and $$testTagRecord = "" ]</li>
<li>#</li>
<li>#If user is in tag field and has changed spelling</li>
<li>#exit this tag record, otherwise current reference record</li>
<li>#will get deleted by the spelling check script.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Go to Field [  ]</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>If [ $$referenceSort = 2 ]</li>
<li>Sort Records [ Specified Sort Order: reference::modifyDate; descending
reference::referenceForReferenceSort; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ $$referenceSort = "" ]</li>
<li>Sort Records [ Specified Sort Order: tagKeywordPrimary::tag; ascending
reference::referenceForReferenceSort; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ $$referenceSort = 1 ]</li>
<li>Sort Records [ Specified Sort Order: reference::createDate; descending
reference::referenceForReferenceSort; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#Addtotag... script is activated by the load record</li>
<li>#trigger.  This script needs to be turned off until</li>
<li>#the section record is looped selected by the user.</li>
<li>Set Variable [ $$stopAddTagToCitation; Value:1 ]</li>
<li>#</li>
<li>Go to Layout [ &ldquo;defaultSetup&rdquo; (tempSetup) ]</li>
<li>Show All Records</li>
<li>Delete All Records
[ No dialog ]</li>
<li>New Record/Request</li>
<li>Set Window Title [ Current Window; New Title: "Setup" ]</li>
<li>Move/Resize Window [ Current Window; Height: Get (ScreenHeight); Width: Get (ScreenWidth) / 2; Top: 0; Left: 0 ]</li>
<li>#</li>
<li>#goto Tag Menus window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>If [ Get (LastError)  = 112 ]</li>
<li>New Window [ Name: "Tag Menus"; Height: Get (ScreenHeight); Width: Get (ScreenWidth) / 2; Top: 0; Left: Get (ScreenWidth) / 2 ]</li>
<li>End If</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>Set Variable [ $$citationitem; Value:tempSetup::ksection ]</li>
<li>Set Variable [ $$citationMatch; Value:"section" ]</li>
<li>Refresh Window</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $$node ]</li>
<li>Set Variable [ $$tagSample ]</li>
<li>Set Variable [ $$tagTest ]</li>
<li>Set Variable [ $$citationRecord ]</li>
<li>Set Variable [ $$primaryNode ]</li>
<li>Set Variable [ $$medium ]</li>
<li>Set Variable [ $$health ]</li>
<li>Set Variable [ $$Path ]</li>
<li>Set Variable [ $$cite ]</li>
<li>Set Variable [ $$ref ]</li>
<li>Set Variable [ $$PrimaryKey ]</li>
<li>Set Variable [ $$Key ]</li>
<li>Set Variable [ $$OtherKey ]</li>
<li>Set Variable [ $$RecordID ]</li>
<li>#</li>
<li>Set Field [ TEMP::ktest; "" ]</li>
<li>#</li>
<li>Set Variable [ $$findMode ]</li>
<li>Set Variable [ $$firstFind ]</li>
<li>Set Variable [ $$firstFindOther ]</li>
<li>Set Variable [ $$found ]</li>
<li>Set Variable [ $$foundOther ]</li>
<li>Set Variable [ $$findLayout ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>#</li>
<li>#Set citationMatch to color menu button with inUse color.</li>
<li>Set Variable [ $$citationMatch; Value:"section" ]</li>
<li>#</li>
<li>Go to Layout [ &ldquo;defaultSections&rdquo; (ruleSection) ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ ruleSection::match; "section" ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>Sort Records [ Specified Sort Order: ruleSection::name; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#Go to citation record's current selection or to first record.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ TEMP::ksection =  ruleSection::ksection ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>If [ TEMP::ksection &ne; ruleSection::ksection ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>End If</li>
<li>Set Variable [ $$stopAddTagToCitation ]</li>
<li>Perform Script [ &ldquo;addTagToMainRecord&rdquo; ]</li>
<li>Refresh Window</li>
<li>Exit Script [  ]</li>
<li>Else If [ $$learnRecord &ne; "" and $$testTagRecord = "" ]</li>
<li>Set Window Title [ Current Window; New Title: "Report" ]</li>
<li>Go to Layout [ &ldquo;PrintReportEdit&rdquo; (report) ]</li>
<li>Scroll Window
[ Home ]</li>
<li>#</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ report::ktestSubject; $$contact ]</li>
<li>Set Field [ report::kreportNumber; $$reportNumber ]</li>
<li>Set Field [ report::ksection; $$library ]</li>
<li>Set Field [ report::ktest; $$returnItem ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: report::ktest; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>View As
[ View as List ]</li>
<li>Scroll Window
[ Home ]</li>
<li>#</li>
<li>#Just in case user went to a different item before</li>
<li>#returning to this item, put the item being tested</li>
<li>#back in the temp field.</li>
<li>Set Field [ TEMP::ktest; $$returnItem ]</li>
<li>Set Field [ TEMP::testName; $$returnItemName ]</li>
<li>#</li>
<li>#Now find discoveries for this report item.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Set Variable [ $$stoploadtestinfo; Value:1 ]</li>
<li>Go to Layout [ &ldquo;reportTagInfo&rdquo; (testlearnReportTags) ]</li>
<li>Perform Script [ &ldquo;reportTagInfo&rdquo; ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ testlearnReportTags::_Ltestlearn = $$learnRecord ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Set Variable [ $$stoploadtestinfo ]</li>
<li>Set Variable [ $$returnItem ]</li>
<li>Set Variable [ $$learnRecord ]</li>
<li>Perform Script [ &ldquo;loadtestinfo&rdquo; ]</li>
<li>#</li>
<li>Else If [ $$learnRecord = "" and $$testTagRecord &ne; "" ]</li>
<li>Set Window Title [ Current Window; New Title: "Test" ]</li>
<li>#</li>
<li>#Prevent test records from loading to speed up</li>
<li>#this script.</li>
<li>Set Variable [ $$stopLoadTestRecord; Value:1 ]</li>
<li>#</li>
<li>#find and show all test records.</li>
<li>Go to Layout [ &ldquo;step4_InspectionFinding&rdquo; (testlearn) ]</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::ktestSubject; $$contact ]</li>
<li>Set Field [ testlearn::ktest; $$returnItem ]</li>
<li>Set Field [ testlearn::kcsection; $$library ]</li>
<li>Set Field [ testlearn::kreportNumber; $$reportNumber ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Just in case user went to a different item before</li>
<li>#returning to this item, put the item being tested</li>
<li>#back in the temp field.</li>
<li>Set Field [ TEMP::ktest; $$returnItem ]</li>
<li>Set Field [ TEMP::testName; $$returnItemName ]</li>
<li>#</li>
<li>#This field does show up elsewhere but I am not</li>
<li>#sure after what it does.  My bad for not making</li>
<li>#thorough comments during earlier developement.</li>
<li>Set Field [ InspectItems::glocationNameGlobal; 
TextStyleAdd ( TEMP::LocationName ; Lowercase ) ]</li>
<li>#</li>
<li>#Create new test record if there are none.</li>
<li>#( I know, there where records here when the</li>
<li>#  the user went to edit them, but the user</li>
<li>#  could have deleted all of them, so it makes</li>
<li>#  to leave this step in for in case that unlikely </li>
<li>#  thing happened ).</li>
<li>If [ Get (LastError) =  401 ]</li>
<li>Perform Script [ &ldquo;newTestRecord&rdquo; ]</li>
<li>#</li>
<li>#If there is OK or NA record, change it into a test</li>
<li>#record.  (NA and OK records tell the user they</li>
<li>#have inspected an item and found it OK or not</li>
<li>#needing to be tested.  If OK, the user has decided</li>
<li>#not to record any details.  So a record exist</li>
<li>#but it is not being used to record details.  </li>
<li>#These next steps will turn that non-test record</li>
<li>#into a test record.)</li>
<li>Else If [ Get (FoundCount) = 1 and $$Location = testlearn::kaudienceLocation and testlearn::kreportNumber = $$reportNumber and
testlearn::InspectionItemCountLocation   =  "N/A"  or  

Get (FoundCount) = 1 and $$Location = testlearn::kaudienceLocation and testlearn::kreportNumber = $$reportNumber and
testlearn::InspectionItemCountLocation   =  "OK"  or 

Get (FoundCount) = 1 and $$Location = testlearn::kaudienceLocation and testlearn::kreportNumber = $$reportNumber and
testlearn::InspectionItemCountLocation    =    "★" ]</li>
<li>#</li>
<li>#If there is OK or NA record, change it into a test</li>
<li>#by change NA or OK to 1, as in 1 test record.</li>
<li>Set Field [ testlearn::InspectionItemCountLocation; 1 ]</li>
<li>#</li>
<li>#increase number of test records for item overall</li>
<li>#from zero to 1.</li>
<li>Set Field [ testlearn::InspectionItemCount; 1 ]</li>
<li>Go to Layout [ &ldquo;step4_InspectionFinding&rdquo; (testlearn) ]</li>
<li>End If</li>
<li>#</li>
<li>#Group records by test subject location.</li>
<li>Sort Records [ Specified Sort Order: testlearn::Location; ascending
testlearn::_Number; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#Omit all NA, OK, and star records if any (these</li>
<li>#records function as visual indicators of having</li>
<li>#made a decision not to create a test record</li>
<li>#because NA = it was not applicable, OK=it was</li>
<li>#fine, and star symbol = because a test record</li>
<li>#already created duplicates the finding in this</li>
<li>#test subject location),</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>If [ testlearn::InspectionItemCountLocation   =  "N/A"  or  
testlearn::InspectionItemCountLocation   =  "OK"  or 
testlearn::InspectionItemCountLocation    =    "★" ]</li>
<li>Omit Record</li>
<li>Go to Record/Request/Page
[ Previous ]</li>
<li>End If</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Now go the test record the user was on.</li>
<li>Go to Record/Request/Page
[ Last ]</li>
<li>Loop</li>
<li>Exit Loop If [ testlearn::_Ltestlearn = $$testLearnRecord ]</li>
<li>Go to Record/Request/Page
[ Previous; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Set the numbers for the navigation arrows</li>
<li>#at the top of the screen: record # / total #.</li>
<li>Set Field [ testlearn::recordnumberglobal; Get (RecordNumber) ]</li>
<li>Set Field [ testlearn::recordcountglobal; Get (FoundCount) ]</li>
<li>#</li>
<li>#Conditionally format current test record and tags.</li>
<li>Set Variable [ $$sopLoadTestRecord ]</li>
<li>Perform Script [ &ldquo;loadTestRecord&rdquo; ]</li>
<li>#</li>
<li>#Find all details for this item.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Perform Script [ &ldquo;reportTagInfo&rdquo; ]</li>
<li>#</li>
<li>#Now go the test record the user was on.</li>
<li>Set Variable [ $$stoploadtestinfo; Value:1 ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ testlearnReportTags::_Ltestlearn = $$testTagRecord ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Set Variable [ $$stoploadtestinfo ]</li>
<li>Perform Script [ &ldquo;loadtestinfo&rdquo; ]</li>
<li>#</li>
<li>#</li>
<li>Set Variable [ $$returnItem ]</li>
<li>Set Variable [ $$testTagRecord ]</li>
<li>Set Variable [ $$testLearnRecord ]</li>
<li>#</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::modifyDate</li>
<li>
<em>reference</em>::referenceForReferenceSort</li>
<li>
<em>tagKeywordPrimary</em>::tag</li>
<li>
<em>reference</em>::createDate</li>
<li>
<em>tempSetup</em>::ksection</li>
<li>
<em>TEMP</em>::ktest</li>
<li>
<em>ruleSection</em>::match</li>
<li>
<em>ruleSection</em>::name</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>ruleSection</em>::ksection</li>
<li>
<em>report</em>::ktestSubject</li>
<li>
<em>report</em>::kreportNumber</li>
<li>
<em>report</em>::ksection</li>
<li>
<em>report</em>::ktest</li>
<li>
<em>TEMP</em>::testName</li>
<li>
<em>testlearnReportTags</em>::_Ltestlearn</li>
<li>
<em>testlearn</em>::ktestSubject</li>
<li>
<em>testlearn</em>::ktest</li>
<li>
<em>testlearn</em>::kcsection</li>
<li>
<em>testlearn</em>::kreportNumber</li>
<li>
<em>TEMP</em>::LocationName</li>
<li>
<em>InspectItems</em>::glocationNameGlobal</li>
<li>
<em>testlearn</em>::kaudienceLocation</li>
<li>
<em>testlearn</em>::InspectionItemCountLocation</li>
<li>
<em>testlearn</em>::InspectionItemCount</li>
<li>
<em>testlearn</em>::Location</li>
<li>
<em>testlearn</em>::_Number</li>
<li>
<em>testlearn</em>::_Ltestlearn</li>
<li>
<em>testlearn</em>::recordnumberglobal</li>
<li>
<em>testlearn</em>::recordcountglobal</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32987ScriptAnchor_">addTagToMainRecord</a></li>
<li><a href="#33135ScriptAnchor_">reportTagInfo</a></li>
<li><a href="#33136ScriptAnchor_">loadtestinfo</a></li>
<li><a href="#32775ScriptAnchor_">newTestRecord</a></li>
<li><a href="#32971ScriptAnchor_">loadTestRecord</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>defaultSetup</li>
<li>defaultSections</li>
<li>PrintReportEdit</li>
<li>reportTagInfo</li>
<li>step4_InspectionFinding</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33050ScriptAnchor_"></a><td class="script_navbar"><a href="#33095ScriptAnchor_"><span>Previous Script: [gotoDefaultsOrReport]</span></a></td><td class="script_navbar"><a href="#33313ScriptAnchor_"><span>Parent Folder: [testReport]</span></a></td><td class="script_navbar"><a href="#33135ScriptAnchor_"><span>Next Script: [reportTagInfo]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">previewReport</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Go to Field [  ]</li>
<li>Select Window [ Name: "Preview"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>New Window [ Name: "Preview" ]</li>
<li>Go to Layout [ &ldquo;PrintReportPreview&rdquo; (report) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ report::ktestSubject; $contact ]</li>
<li>Set Field [ report::ksection; $$library ]</li>
<li>Set Field [ report::ktest; $$item ]</li>
<li>Set Field [ report::kreportNumber; $$reportNumber ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: ruleTestReport::name; ascending
reportItem::testName; ascending ]
[ Restore; No dialog ]</li>
<li>Enter Browse Mode</li>
<li>Enter Preview Mode</li>
<li>Show/Hide Status Area
[ Lock; Show ]</li>
<li>End If</li>
<li>If [ report::ktest &ne; $$item ]</li>
<li>Go to Layout [ &ldquo;PrintReportPreview&rdquo; (report) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ report::ktestSubject; $contact ]</li>
<li>Set Field [ report::ksection; $$library ]</li>
<li>Set Field [ report::ktest; $$item ]</li>
<li>Set Field [ report::kreportNumber; $$reportNumber ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: ruleTestReport::name; ascending
reportItem::testName; ascending ]
[ Restore; No dialog ]</li>
<li>Enter Browse Mode</li>
<li>Enter Preview Mode</li>
<li>Show/Hide Status Area
[ Lock; Show ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Set Variable [ $page; Value:Get (PageNumber) ]</li>
<li>Enter Browse Mode</li>
<li>Enter Preview Mode</li>
<li>Go to Record/Request/Page [ $page ]
[ No dialog ]</li>
<li>Show Custom Dialog [ Message: "Click the 'exit preview' button to close this window.  Click the page numbers (upper left corner) to see additional pages if there are any."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Set Variable [ $$preview; Value:1 ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>report</em>::ktestSubject</li>
<li>
<em>report</em>::ksection</li>
<li>
<em>report</em>::ktest</li>
<li>
<em>report</em>::kreportNumber</li>
<li>
<em>ruleTestReport</em>::name</li>
<li>
<em>reportItem</em>::testName</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>PrintReportPreview</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33135ScriptAnchor_"></a><td class="script_navbar"><a href="#33050ScriptAnchor_"><span>Previous Script: [previewReport]</span></a></td><td class="script_navbar"><a href="#33313ScriptAnchor_"><span>Parent Folder: [testReport]</span></a></td><td class="script_navbar"><a href="#33139ScriptAnchor_"><span>Next Script: [reportTagDiscovery]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">reportTagInfo</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32905ScriptAnchor_">CHUNK_gotoItemViaPulldown</a></li>
<li><a href="#32803ScriptAnchor_">inUsePart3</a></li>
<li><a href="#33095ScriptAnchor_">gotoDefaultsOrReport</a></li>
<li><a href="#33143ScriptAnchor_">reportClearDiscoveryLink</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>#</li>
<li>If [ Left ( Get (LayoutName) ; 6 ) = "report" ]</li>
<li>Go to Layout [ &ldquo;reportTagInfo&rdquo; (testlearnReportTags) ]</li>
<li>Else If [ Left ( Get (LayoutName) ; 6 ) &ne; "report" ]</li>
<li>Go to Layout [ &ldquo;testInfo&rdquo; (testlearnReportTags) ]</li>
<li>End If</li>
<li>#Turn off the loadtagrecord script to speed up the </li>
<li>#loop portion of the script.</li>
<li>Set Variable [ $$stoploadtestinfo; Value:1 ]</li>
<li>Enter Find Mode [  ]</li>
<li>#</li>
<li>#now find and show all canned inspection items associated with this generic canned location</li>
<li>Set Field [ testlearnReportTags::kcsection; TEMP::ksection ]</li>
<li>Set Field [ testlearnReportTags::kctest; "###" &amp; $$item ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Clear sample and test tags.</li>
<li>Set Variable [ $$tagSample ]</li>
<li>Set Variable [ $$tagtest ]</li>
<li>Set Variable [ $$tagRecordID ]</li>
<li>Set Variable [ $$tagEdit ]</li>
<li>#</li>
<li>#</li>
<li>#If sort by order number is on then sort by </li>
<li>#order number.</li>
<li>#Go the first record.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>Loop</li>
<li>#</li>
<li>#The order number is the left three digits of a</li>
<li>#sample or test record lock number.  ( Remember</li>
<li>#each record in the database has lock number or</li>
<li>#ID number.  To open the lock and see any record's</li>
<li>#contents requires a key number that fits the lock.</li>
<li>#So if a lock number is 123, then the key that will</li>
<li>#fit this lock is 123 too. )  Because the sample </li>
<li>#and test key fields (think of key chains) may </li>
<li>#have several keys, because any one learn record</li>
<li>#may be part of more than one sample or test. </li>
<li>#the system must check each learn record's keys</li>
<li>#one at a time to see if any fit the current sample</li>
<li>#or test's lock.  So beginning with number one</li>
<li>#the system checks each key.  The left most 3 numbers</li>
<li>#are order numbers so below you will note that </li>
<li>#they system starts the check on the 4th number</li>
<li>#from the left.</li>
<li>Set Variable [ $number; Value:1 ]</li>
<li>Go to Field [  ]</li>
<li>Loop</li>
<li>#</li>
<li>#The first step is to blank or clear each record's</li>
<li>#order field, so only those records that are part</li>
<li>#of the current sample or test will have order numbers</li>
<li>#and be part of the sort coming right after this</li>
<li>#assignment of sort order numbers.</li>
<li>Set Field [ testlearnReportTags::orderTest; "" ]</li>
<li>#</li>
<li>#When and if a key is found that fits the current</li>
<li>#sample or test record's lock, the order number</li>
<li>#( left most 3 digits ) is caputred and placed in </li>
<li>#in the order field.</li>
<li>Set Field [ testlearnReportTags::orderTest; Left ( GetValue ( testlearnReportTags::kctest ; $number ) ; 3  ) ]</li>
<li>#</li>
<li>#The 'number' variable is made blank to trigger</li>
<li>#the exit from this loop, the order number having</li>
<li>#been assigned.</li>
<li>Set Variable [ $number ]</li>
<li>Exit Loop If [ $number = "" ]</li>
<li>#</li>
<li>#Exit loop if the current record is not part</li>
<li>#of the selected sample or test after checking</li>
<li>#all of its keys.</li>
<li>Exit Loop If [ GetValue ( testlearnReportTags::kctest ; $number )  = "" ]</li>
<li>#</li>
<li>#Add 1 to the 'number' varaible after each key</li>
<li>#in the key field is checked, to direct the system</li>
<li>#to check the next key.</li>
<li>Set Variable [ $add; Value:$number ]</li>
<li>Set Variable [ $number; Value:$add + 1 ]</li>
<li>End Loop</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Sort the records by order field.</li>
<li>Sort Records [ Specified Sort Order: testlearnReportTags::orderTest; based on value list: &ldquo;order&rdquo;
testlearnReportTags::timestamp; descending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#Return focus to record user was focused on at</li>
<li>#the start of this script.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>#</li>
<li>#Turn loadcitation script back on and exit script.</li>
<li>Set Variable [ $$stoploadtestinfo ]</li>
<li>Perform Script [ &ldquo;loadtestinfo&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>testlearnReportTags</em>::kcsection</li>
<li>
<em>testlearnReportTags</em>::kctest</li>
<li>
<em>testlearnReportTags</em>::orderTest</li>
<li>
<em>testlearnReportTags</em>::timestamp</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33136ScriptAnchor_">loadtestinfo</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>reportTagInfo</li>
<li>testInfo</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33139ScriptAnchor_"></a><td class="script_navbar"><a href="#33135ScriptAnchor_"><span>Previous Script: [reportTagInfo]</span></a></td><td class="script_navbar"><a href="#33313ScriptAnchor_"><span>Parent Folder: [testReport]</span></a></td><td class="script_navbar"><a href="#33221ScriptAnchor_"><span>Next Script: [reportExitOnRecordLoad]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">reportTagDiscovery</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32803ScriptAnchor_">inUsePart3</a></li>
<li><a href="#33143ScriptAnchor_">reportClearDiscoveryLink</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Go to Layout [ &ldquo;reportTagDiscovery&rdquo; (testlearnReportTags) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearnReportTags::ktestSubject; TEMP::kdefaultNodeTestSubject ]</li>
<li>Set Field [ testlearnReportTags::ktest; TEMP::ktest ]</li>
<li>Set Field [ testlearnReportTags::kreportNumber; TEMP::reportNumber ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: testlearnReportTags::Location; ascending
testlearnReportTags::timestamp; ascending
testlearnReportTags::_Ltestlearn; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::kdefaultNodeTestSubject</li>
<li>
<em>testlearnReportTags</em>::ktestSubject</li>
<li>
<em>TEMP</em>::ktest</li>
<li>
<em>testlearnReportTags</em>::ktest</li>
<li>
<em>TEMP</em>::reportNumber</li>
<li>
<em>testlearnReportTags</em>::kreportNumber</li>
<li>
<em>testlearnReportTags</em>::Location</li>
<li>
<em>testlearnReportTags</em>::timestamp</li>
<li>
<em>testlearnReportTags</em>::_Ltestlearn</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>reportTagDiscovery</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33221ScriptAnchor_"></a><td class="script_navbar"><a href="#33139ScriptAnchor_"><span>Previous Script: [reportTagDiscovery]</span></a></td><td class="script_navbar"><a href="#33313ScriptAnchor_"><span>Parent Folder: [testReport]</span></a></td><td class="script_navbar"><a href="#33276ScriptAnchor_"><span>Next Script: [reportPreviewClose]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">reportExitOnRecordLoad</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ $$stopLoadReportRecord = 1 ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33276ScriptAnchor_"></a><td class="script_navbar"><a href="#33221ScriptAnchor_"><span>Previous Script: [reportExitOnRecordLoad]</span></a></td><td class="script_navbar"><a href="#33313ScriptAnchor_"><span>Parent Folder: [testReport]</span></a></td><td class="script_navbar"><a href="#33143ScriptAnchor_"><span>Next Script: [reportClearDiscoveryLink]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">reportPreviewClose</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ $$preview = 1 ]</li>
<li>Close Window [ Current Window ]</li>
<li>End If</li>
<li>Set Variable [ $$preview ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33143ScriptAnchor_"></a><td class="script_navbar"><a href="#33276ScriptAnchor_"><span>Previous Script: [reportPreviewClose]</span></a></td><td class="script_navbar"><a href="#33313ScriptAnchor_"><span>Parent Folder: [testReport]</span></a></td><td class="script_navbar"><a href="#33142ScriptAnchor_"><span>Next Script: [setupUpdateReportNumber]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">reportClearDiscoveryLink</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33144ScriptAnchor_">clearpicture1</a></li>
<li><a href="#33145ScriptAnchor_">clearpicture2</a></li>
<li><a href="#33149ScriptAnchor_">clearpicture3</a></li>
<li><a href="#33150ScriptAnchor_">clearpicture4</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#If user is trying to clear a blank field</li>
<li>#stop the script</li>
<li>If [ Get (ActiveFieldContents) = "" ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#Get ID then clear field.</li>
<li>Set Variable [ $clear; Value:Get ( ActiveFieldContents ) ]</li>
<li>Clear [  ]
[ Select ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#tell user it is not in use</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>If [ Get (LayoutName) &ne; "reportTagDiscovery" ]</li>
<li>Perform Script [ &ldquo;reportTagDiscovery&rdquo; ]</li>
<li>End If</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#find the record that has been copied and cleared</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $clear = testlearnReportTags::_Ltestlearn ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#If it is not a discovery record, go to the info layout.</li>
<li>If [ $clear &ne; testlearnReportTags::_Ltestlearn ]</li>
<li>Perform Script [ &ldquo;reportTagInfo&rdquo; ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Variable [ $$stoploadtestinfo; Value:1 ]</li>
<li>Loop</li>
<li>Exit Loop If [ $clear = testlearnReportTags::_Ltestlearn ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Set Variable [ $$stoploadtestinfo ]</li>
<li>Perform Script [ &ldquo;loadtestinfo&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>#inform the user that it is not being used in the Report window</li>
<li>#by removing it from the list of inUse report sections,</li>
<li>#basically removing it from showing on this page but</li>
<li>#not the other pages it is currently being used by.</li>
<li>Set Variable [ $inUse; Value:testlearnReportTags::inUse ]</li>
<li>Set Field [ testlearnReportTags::inUse; Substitute ( testlearnReportTags::inUse ; $$contact &amp; $$reportNumber &amp; "&para;" ; "" ) ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>Select Window [ Name: "Report"; Current file ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearnReportTags</em>::_Ltestlearn</li>
<li>
<em>testlearnReportTags</em>::inUse</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33139ScriptAnchor_">reportTagDiscovery</a></li>
<li><a href="#33135ScriptAnchor_">reportTagInfo</a></li>
<li><a href="#33136ScriptAnchor_">loadtestinfo</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33142ScriptAnchor_"></a><td class="script_navbar"><a href="#33143ScriptAnchor_"><span>Previous Script: [reportClearDiscoveryLink]</span></a></td><td class="script_navbar"><a href="#33313ScriptAnchor_"><span>Parent Folder: [testReport]</span></a></td><td class="script_navbar"><a href="#33131ScriptAnchor_"><span>Next Script: [openDetailWindow !!! FINISH LATER !!!]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">setupUpdateReportNumber</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ Get (FoundCount)  =  0  and  $$stopFocusLoad = "" or 
Get (FoundCount) &ne; 0  and  $$stopFocusLoad = 1 ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Set Field [ TEMP::reportNumber; tagTestSubjectLocation::reportNumber ]</li>
<li>//  Set Field [ TEMP::kdefaultNodeTestSubject; tagTestSubjectLocation::knode ]</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagTestSubjectLocation</em>::reportNumber</li>
<li>
<em>TEMP</em>::reportNumber</li>
<li>
<em>tagTestSubjectLocation</em>::knode</li>
<li>
<em>TEMP</em>::kdefaultNodeTestSubject</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33131ScriptAnchor_"></a><td class="script_navbar"><a href="#33142ScriptAnchor_"><span>Previous Script: [setupUpdateReportNumber]</span></a></td><td class="script_navbar"><a href="#33313ScriptAnchor_"><span>Parent Folder: [testReport]</span></a></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">openDetailWindow !!! FINISH LATER !!!</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Go to Field [  ]</li>
<li>Set Variable [ $$ID; Value:test::_Ltest ]</li>
<li>Set Variable [ $workwindow; Value:Get (WindowName) ]</li>
<li>Set Variable [ $left; Value:Get ( WindowLeft ) ]</li>
<li>Set Variable [ $width; Value:Get ( WindowWidth) ]</li>
<li>Select Window [ Name: $workwindow; Current file ]</li>
<li>Set Field [ TEMP::ktestItemList; test::ktestItemList ]</li>
<li>Set Field [ TEMP::ktestItemListOLD; test::ktestItemList ]</li>
<li>Set Field [ TEMP::ktest; test::_Ltest ]</li>
<li>Set Field [ TEMP::testName; test::testName ]</li>
<li>Set Field [ TEMP::ksection; test::ksection ]</li>
<li>Set Field [ TEMP::sectionName; ruleSection::name ]</li>
<li>Select Window [ Name: "Details"; Current file ]</li>
<li>If [ Get (LastError)  = 112 ]</li>
<li>If [ Get (WindowZoomLevel) = 100 ]</li>
<li>New Window [ Name: "Details"; Height: Get (ScreenHeight); Width: 333; Left: If ( $left + $width + 333 &gt; Get ( ScreenWidth ) ; Get ( ScreenWidth ) - 333 ;  $left + $width  ) ]</li>
<li>Else If [ Get (WindowZoomLevel) = 150 ]</li>
<li>New Window [ Name: "Details"; Height: Get (ScreenHeight); Width: 490; Left: If ( $left + $width &gt; Get ( ScreenWidth )  - 490; Get ( ScreenWidth ) - 490 ;  $left + $width  ) ]</li>
<li>End If</li>
<li>Go to Layout [ &ldquo;setupTestItem&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>#</li>
<li>Set Variable [ $layout; Value:Get (LayoutName) ]</li>
<li>Set Variable [ $$attributeReturnLayout; Value:Get (LayoutName) ]</li>
<li>#Find all details for this item.</li>
<li>Go to Layout [ &ldquo;testMenuTestItemMORE&rdquo; (tagMenus) ]</li>
<li>//  Set Variable [ $$citationMatch; Value:test::_Ltest ]</li>
<li>#</li>
<li>#Find detail tags for library section.  </li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::kGroupOrTest; TEMP::ktestItemList ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#If no records exist then create one.</li>
<li>If [ Get (FoundCount)=0 ]</li>
<li>Perform Script [ &ldquo;newCitationMenuGroup&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuTestGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuTestGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>#Find all locations for this item.</li>
<li>#New items will not have any locations assigned so</li>
<li>#error caputer needs to be turned on.</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Go to Layout [ &ldquo;setupTestFocus&rdquo; (tagLocation) ]</li>
<li>View As
[ View as Form ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ test::_Ltest; $$ID ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>Go to Layout [ $layout ]</li>
<li>Refresh Window</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>test</em>::_Ltest</li>
<li>
<em>test</em>::ktestItemList</li>
<li>
<em>TEMP</em>::ktestItemList</li>
<li>
<em>TEMP</em>::ktestItemListOLD</li>
<li>
<em>TEMP</em>::ktest</li>
<li>
<em>test</em>::testName</li>
<li>
<em>TEMP</em>::testName</li>
<li>
<em>test</em>::ksection</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>ruleSection</em>::name</li>
<li>
<em>TEMP</em>::sectionName</li>
<li>
<em>tagMenus</em>::kGroupOrTest</li>
<li>
<em>ruleTagMenuTestGroups</em>::order</li>
<li>
<em>ruleTagMenuTestGroups</em>::name</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>tagMenus</em>::tag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32980ScriptAnchor_">newCitationMenuGroup</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>setupTestItem</li>
<li>testMenuTestItemMORE</li>
<li>setupTestFocus</li>
<li>&lt;Missing Layout&gt;</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<p>
<span class="partheading"><a name="33327ScriptAnchor_"></a><a href="#33327ScriptAnchor_toc">probablyNotInUse</a></span>
</p>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32815ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"><a href="#33327ScriptAnchor_"><span>Parent Folder: [probablyNotInUse]</span></a></td><td class="script_navbar"><a href="#32946ScriptAnchor_"><span>Next Script: [evidenceSpacetime]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">findInspectionItemValueList</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Variable [ $list; Value:&lt;Table Missing&gt;::&lt;Field Missing&gt; ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ &lt;Table Missing&gt;; $list ]</li>
<li>Perform Find [  ]</li>
<li>If [ Get (LastError) = "401" ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "There are no value lists.  Create a new one if you like."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>&lt;Missing Field&gt;</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32946ScriptAnchor_"></a><td class="script_navbar"><a href="#32815ScriptAnchor_"><span>Previous Script: [findInspectionItemValueList]</span></a></td><td class="script_navbar"><a href="#33327ScriptAnchor_"><span>Parent Folder: [probablyNotInUse]</span></a></td><td class="script_navbar"><a href="#32822ScriptAnchor_"><span>Next Script: [evidenceDetailSpacetimeDELETE?????]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">evidenceSpacetime</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Variable [ $$listlayout; Value:"listSpacetime" ]</li>
<li>Perform Script [ &ldquo;evidenceDetailSpacetimeDELETE?????&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32822ScriptAnchor_">evidenceDetailSpacetimeDELETE?????</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32822ScriptAnchor_"></a><td class="script_navbar"><a href="#32946ScriptAnchor_"><span>Previous Script: [evidenceSpacetime]</span></a></td><td class="script_navbar"><a href="#33327ScriptAnchor_"><span>Parent Folder: [probablyNotInUse]</span></a></td><td class="script_navbar"><a href="#32943ScriptAnchor_"><span>Next Script: [evidenceDetailDELETE?????]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">evidenceDetailSpacetimeDELETE?????</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32946ScriptAnchor_">evidenceSpacetime</a></li>
<li><a href="#32943ScriptAnchor_">evidenceDetailDELETE?????</a></li>
<li><a href="#32973ScriptAnchor_">evidenceTag</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Variable [ $$openedFrom; Value:Get (LayoutName) ]</li>
<li>Set Variable [ $left; Value:Get ( WindowLeft ) ]</li>
<li>Set Variable [ $width; Value:Get ( WindowWidth) ]</li>
<li>Set Field [ TEMP::ktestItemList; InspectItems::ktestItemList ]</li>
<li>Set Field [ TEMP::ktestItemListOLD; InspectItems::ktestItemList ]</li>
<li>Set Field [ TEMP::ktest; InspectItems::_Ltest ]</li>
<li>Set Field [ TEMP::ksection; InspectItems::ksection ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>If [ Get (LastError)  = 112 ]</li>
<li>If [ Get (WindowZoomLevel) = 100 ]</li>
<li>New Window [ Name: "Tag Menus"; Height: Get (ScreenHeight); Width: $width; Left: //If ( $left + $width + 333 &gt; Get ( ScreenWidth ) ; Get ( ScreenWidth ) - 333 ;  $left + $width  )

$width ]</li>
<li>Else If [ Get (WindowZoomLevel) = 150 ]</li>
<li>New Window [ Name: "Tag Menus"; Height: Get (ScreenHeight); Width: $width; Left: //If ( $left + $width + 333 &gt; Get ( ScreenWidth ) ; Get ( ScreenWidth ) - 333 ;  $left + $width  )

$width ]</li>
<li>//  New Window [ Name: "Tag Menus"; Height: Get (ScreenHeight); Width: 490; Left: If ( $left + $width &gt; Get ( ScreenWidth )  - 490; Get ( ScreenWidth ) - 490 ;  $left + $width  ) ]</li>
<li>End If</li>
<li>Go to Layout [ &ldquo;setupTestItem&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>Go to Layout [ $$listlayout ]</li>
<li>#</li>
<li>#Find all details for this item.</li>
<li>Perform Script [ &ldquo;menuTestItem&rdquo; ]</li>
<li>#</li>
<li>#Find all locations for this item.</li>
<li>#New items will not have any locations assigned so</li>
<li>#error caputer needs to be turned on.</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Go to Layout [ &ldquo;setupTestFocus&rdquo; (tagLocation) ]</li>
<li>View As
[ View as Form ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ test::_Ltest; $$item ]</li>
<li>Perform Find [  ]</li>
<li>Go to Layout [ $$listlayout ]</li>
<li>Select Window [ Name: "Test"; Current file ]</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>InspectItems</em>::ktestItemList</li>
<li>
<em>TEMP</em>::ktestItemList</li>
<li>
<em>TEMP</em>::ktestItemListOLD</li>
<li>
<em>InspectItems</em>::_Ltest</li>
<li>
<em>TEMP</em>::ktest</li>
<li>
<em>InspectItems</em>::ksection</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>test</em>::_Ltest</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33071ScriptAnchor_">menuTestItem</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>setupTestItem</li>
<li>setupTestFocus</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32943ScriptAnchor_"></a><td class="script_navbar"><a href="#32822ScriptAnchor_"><span>Previous Script: [evidenceDetailSpacetimeDELETE?????]</span></a></td><td class="script_navbar"><a href="#33327ScriptAnchor_"><span>Parent Folder: [probablyNotInUse]</span></a></td><td class="script_navbar"><a href="#32827ScriptAnchor_"><span>Next Script: [deleteInspectionComplement]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">evidenceDetailDELETE?????</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32971ScriptAnchor_">loadTestRecord</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Variable [ $$listlayout; Value:"testMenuDetail" ]</li>
<li>Perform Script [ &ldquo;evidenceDetailSpacetimeDELETE?????&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32822ScriptAnchor_">evidenceDetailSpacetimeDELETE?????</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32827ScriptAnchor_"></a><td class="script_navbar"><a href="#32943ScriptAnchor_"><span>Previous Script: [evidenceDetailDELETE?????]</span></a></td><td class="script_navbar"><a href="#33327ScriptAnchor_"><span>Parent Folder: [probablyNotInUse]</span></a></td><td class="script_navbar"><a href="#32917ScriptAnchor_"><span>Next Script: [newAttribute]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">deleteInspectionComplement</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ test::_Ltest = "" ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Set Variable [ $deleteComp; Value:&lt;Table Missing&gt;::&lt;Field Missing&gt; ]</li>
<li>Set Variable [ $name; Value:&lt;Table Missing&gt;::&lt;Field Missing&gt; ]</li>
<li>Refresh Window</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Delete " &amp; $name &amp; "?"; Buttons: &ldquo;Cancel&rdquo;, &ldquo;Delete&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Delete Portal Row
[ No dialog ]</li>
<li>End If</li>
<li>Set Variable [ $deleteComp ]</li>
<li>Refresh Window</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>test</em>::_Ltest</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32917ScriptAnchor_"></a><td class="script_navbar"><a href="#32827ScriptAnchor_"><span>Previous Script: [deleteInspectionComplement]</span></a></td><td class="script_navbar"><a href="#33327ScriptAnchor_"><span>Parent Folder: [probablyNotInUse]</span></a></td><td class="script_navbar"><a href="#32961ScriptAnchor_"><span>Next Script: [newEvidenceWindow]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">newAttribute</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32961ScriptAnchor_"></a><td class="script_navbar"><a href="#32917ScriptAnchor_"><span>Previous Script: [newAttribute]</span></a></td><td class="script_navbar"><a href="#33327ScriptAnchor_"><span>Parent Folder: [probablyNotInUse]</span></a></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">newEvidenceWindow</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Variable [ $left; Value:Get ( WindowLeft ) + Get ( WindowWidth) ]</li>
<li>Close Window [ Name: "Copy / Paste Evidence"; Current file ]</li>
<li>New Window [ Name: "Copy / Paste Evidence"; Left: $left ]</li>
<li>Go to Layout [ &lt;unknown&gt; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>&lt;Missing Layout&gt;</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<p>
<span class="partheading"><a name="33166ScriptAnchor_"></a><a href="#33166ScriptAnchor_toc">Print</a></span>
</p>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33167ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"><a href="#33166ScriptAnchor_"><span>Parent Folder: [Print]</span></a></td><td class="script_navbar"><a href="#33168ScriptAnchor_"><span>Next Script: [TOC]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">printThingReport</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>Set Variable [ $record; Value:Get (RecordNumber) ]</li>
<li>Close Window [ Name: "Tag Menus"; Current file ]</li>
<li>#find all contact records, sort them, enter preview (print) mode</li>
<li>Go to Layout [ &ldquo;PrintReport&rdquo; (report) ]</li>
<li>Set Variable [ $contact; Value:report::ktestSubject ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ report::ktestSubject; $contact ]</li>
<li>Set Field [ report::kreportNumber; $$reportNumber ]</li>
<li>Set Field [ report::ksection; $$Library ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: ruleTestReport::name; ascending
reportItem::testName; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>#allow user to preview report will clicking a button in </li>
<li>#a new window to input page numbers for each item</li>
<li>Enter Preview Mode</li>
<li>Set Window Title [ Current Window; New Title: "Report" ]</li>
<li>Move/Resize Window [ Name: "Report"; Current file; Width: Get ( ScreenWidth ) / 2; Left: 0 ]</li>
<li>New Window [ Name: "Numbers"; Width: Get ( ScreenWidth ) / 2; Left: Get ( ScreenWidth ) / 2 ]</li>
<li>Enter Browse Mode</li>
<li>//  Arrange All Windows
[ Tile Vertically ]</li>
<li>Go to Layout [ &ldquo;pageNumbering&rdquo; (report) ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Field [ report::pagenumberTheme; 1 ]</li>
<li>Set Field [ report::CurrentRecord; Get ( RecordID ) ]</li>
<li>Set Variable [ $$themepage; Value:2 ]</li>
<li>Set Field [ TEMP::pageNumber; 1 ]</li>
<li>Select Window [ Name: "Numbers"; Current file ]</li>
<li>Loop</li>
<li>Set Variable [ $duplicate; Value:report::ktest ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>If [ report::ktest = $duplicate ]</li>
<li>Omit Record</li>
<li>Go to Record/Request/Page
[ Previous ]</li>
<li>End If</li>
<li>End Loop</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Pause/Resume Script [ Indefinitely ]</li>
<li>#refind all report records omitted for page numbering</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ report::ktestSubject; $contact ]</li>
<li>Set Field [ report::kreportNumber; $$reportNumber ]</li>
<li>Set Field [ report::ksection; $$Library ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: ruleTestReport::name; ascending
reportItem::testName; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#now save the TOC to every report record in case the one showing gets deleted.</li>
<li>Set Variable [ $TOC; Value:report::TOC ]</li>
<li>Set Variable [ $TOCnumbers; Value:report::TOCnumbers ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ report::TOC; $TOC ]</li>
<li>Set Field [ report::TOCnumbers; $TOCnumbers ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Set Variable [ $path; Value:Get ( TemporaryPath ) ]</li>
<li>Close Window [ Name: "Report"; Current file ]</li>
<li>Adjust Window
[ Resize to Fit ]</li>
<li>Set Zoom Level
[ 100% ]</li>
<li>Go to Layout [ &ldquo;reportCover&rdquo; (report) ]</li>
<li>Enter Browse Mode</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Pause/Resume Script [ Indefinitely ]</li>
<li>#</li>
<li>#pdf report cover</li>
<li>Set Variable [ $cover; Value:report::ReportCover ]</li>
<li>Set Variable [ $pdf; Value:report::ReportPDFtitle ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Variable [ $printcover; Value:report::_Lreport ]</li>
<li>Loop</li>
<li>Set Field [ report::ReportCover; $cover ]</li>
<li>Set Field [ report::ReportPDFtitle; $pdf ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ report::_Lreport; $printcover ]</li>
<li>Perform Find [  ]</li>
<li>If [ Left ( Get (ApplicationVersion) ; 3) = "run"  and Get ( SystemPlatform )  &ne; 3 ]</li>
<li>Show Custom Dialog [ Message: "The report cover, table of contents, and report should now be saved as 3 PDFs.  In the print dialogue box select the PDF option (bottom left corner) and save this first PDF as cover."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Print [ Records being browsed; All Pages; Orientation: Portrait; Paper size: 8.5" x 11" ]
[ Restore ]</li>
<li>Else If [ Left ( Get (ApplicationVersion) ; 3)  &ne;  "run"  or Get ( SystemPlatform ) = 3 ]</li>
<li>Print Setup [ Orientation: Portrait; Paper size: 8.5" x 11" ]
[ Restore; No dialog ]</li>
<li>Save Records as PDF [ File Name: &ldquo;$path/$pdf&rdquo;; Current record ]
[ Document -  Compatibility: Acrobat 5 and later ]
[ Pages -  Number Pages From: 1; Include: All pages ]
[ Security -  Printing: High Resolution; Editing: Any except extracting pages; Enable copying; Enable Screen Reader ]
[ Initial View -  Show: Pages Panel and Page; Page Layout: Default; Magnification: 100% ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#pdf table of contents</li>
<li>Go to Layout [ &ldquo;TOCpdf&rdquo; (report) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ report::ktestSubject; $contact ]</li>
<li>Set Field [ report::kreportNumber; $$reportNumber ]</li>
<li>Set Field [ report::ksection; $$Library ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: report::TOC; ascending
ruleTestReport::name; ascending
reportItem::testName; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Variable [ $duplicate; Value:report::ktest ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>If [ report::ktest = $duplicate ]</li>
<li>Omit Record</li>
<li>Go to Record/Request/Page
[ Previous ]</li>
<li>End If</li>
<li>End Loop</li>
<li>Enter Preview Mode</li>
<li>If [ Left ( Get (ApplicationVersion) ; 3) = "run"  and Get ( SystemPlatform )  &ne; 3 ]</li>
<li>Show Custom Dialog [ Message: "Save this second PDF as TOC."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Print [ Records being browsed; All Pages; Orientation: Portrait; Paper size: 8.5" x 11" ]
[ Restore ]</li>
<li>Else If [ Left ( Get (ApplicationVersion) ; 3)  &ne;  "run"  or Get ( SystemPlatform ) = 3 ]</li>
<li>Save Records as PDF [ File Name: &ldquo;$path/$pdf&rdquo;; Records being browsed ]
[ Document -  Compatibility: Acrobat 5 and later ]
[ Pages -  Number Pages From: 1; Include: All pages ]
[ Security -  Printing: High Resolution; Editing: Any except extracting pages; Enable copying; Enable Screen Reader ]
[ Initial View -  Show: Pages Panel and Page; Page Layout: Default; Magnification: 100% ]
[ Restore; Append; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#pdf report</li>
<li>Go to Layout [ &ldquo;PrintReport&rdquo; (report) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ report::ktestSubject; $contact ]</li>
<li>Set Field [ report::kreportNumber; $$reportNumber ]</li>
<li>Set Field [ report::ksection; $$Library ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: ruleTestReport::name; ascending
reportItem::testName; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Enter Preview Mode</li>
<li>If [ Left ( Get (ApplicationVersion) ; 3) = "run"  and Get ( SystemPlatform )  &ne; 3 ]</li>
<li>Show Custom Dialog [ Message: "Save this third PDF as Report."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Print [ Records being browsed; All Pages; Orientation: Portrait; Paper size: 8.5" x 11" ]
[ Restore ]</li>
<li>Show Custom Dialog [ Message: "Open up all three PDFs.  Drag the cover and TOC page thumbnails into the Report.pdf along with any other PDF thumbnails you wish from Preview's sidebar.  Save this PDF.  Trash the other two."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Else If [ Left ( Get (ApplicationVersion) ; 3)  &ne;  "run"  or Get ( SystemPlatform ) = 3 ]</li>
<li>Save Records as PDF [ File Name: &ldquo;$path/$pdf&rdquo;; Automatically open; Records being browsed ]
[ Document -  Compatibility: Acrobat 5 and later ]
[ Pages -  Number Pages From: 1; Include: All pages ]
[ Security -  Printing: High Resolution; Editing: Any except extracting pages; Enable copying; Enable Screen Reader ]
[ Initial View -  Show: Pages Panel and Page; Page Layout: Default; Magnification: 100% ]
[ Restore; Append; No dialog ]</li>
<li>End If</li>
<li>Set Window Title [ Current Window; New Title: "Setup" ]</li>
<li>Move/Resize Window [ Name: "Setup"; Current file; Width: Get (ScreenWidth) / 2; Top: 0; Left: 0 ]</li>
<li>Go to Layout [ &ldquo;defaultSetup&rdquo; (tempSetup) ]</li>
<li>New Window [ Name: "Tag Menus"; Width: Get (ScreenWidth) / 2; Left: Get (ScreenWidth) / 2 ]</li>
<li>Go to Layout [ &ldquo;defaultTest&rdquo; (tagTestSubjectLocation) ]</li>
<li>//  Perform Script [ &ldquo;defaultTestLocationMenu&rdquo; ]</li>
<li>Perform Script [ &ldquo;editReport&rdquo; ]</li>
<li>Go to Record/Request/Page [ $record ]
[ No dialog ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>report</em>::ktestSubject</li>
<li>
<em>report</em>::kreportNumber</li>
<li>
<em>report</em>::ksection</li>
<li>
<em>ruleTestReport</em>::name</li>
<li>
<em>reportItem</em>::testName</li>
<li>
<em>report</em>::pagenumberTheme</li>
<li>
<em>report</em>::CurrentRecord</li>
<li>
<em>TEMP</em>::pageNumber</li>
<li>
<em>report</em>::ktest</li>
<li>
<em>report</em>::TOC</li>
<li>
<em>report</em>::TOCnumbers</li>
<li>
<em>report</em>::ReportCover</li>
<li>
<em>report</em>::ReportPDFtitle</li>
<li>
<em>report</em>::_Lreport</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33133ScriptAnchor_">defaultTestLocationMenu</a></li>
<li><a href="#32809ScriptAnchor_">editReport</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>PrintReport</li>
<li>pageNumbering</li>
<li>reportCover</li>
<li>TOCpdf</li>
<li>defaultSetup</li>
<li>defaultTest</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33168ScriptAnchor_"></a><td class="script_navbar"><a href="#33167ScriptAnchor_"><span>Previous Script: [printThingReport]</span></a></td><td class="script_navbar"><a href="#33166ScriptAnchor_"><span>Parent Folder: [Print]</span></a></td><td class="script_navbar"><a href="#33169ScriptAnchor_"><span>Next Script: [CHUNK_insertPageNumbers]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">TOC</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Variable [ $record; Value:Get (RecordNumber) ]</li>
<li>Set Variable [ $TOCnumber; Value:report::TOCnumbers ]</li>
<li>Set Variable [ $TOC; Value:report::TOC ]</li>
<li>Go to Field [  ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ report::TOCnumbers; $TOCnumber ]</li>
<li>Set Field [ report::TOC; $TOC ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Go to Record/Request/Page [ $record ]
[ No dialog ]</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>report</em>::TOCnumbers</li>
<li>
<em>report</em>::TOC</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33169ScriptAnchor_"></a><td class="script_navbar"><a href="#33168ScriptAnchor_"><span>Previous Script: [TOC]</span></a></td><td class="script_navbar"><a href="#33166ScriptAnchor_"><span>Parent Folder: [Print]</span></a></td><td class="script_navbar"><a href="#33170ScriptAnchor_"><span>Next Script: [CHUNK_pagenumberTheme]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">CHUNK_insertPageNumbers</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Variable [ $$theme; Value:reportItem::ktestGroup ]</li>
<li>If [ $$themepage = 1 ]</li>
<li>Set Field [ report::pagenumberTheme; TEMP::pageNumber ]</li>
<li>Set Variable [ $$themepage; Value:2 ]</li>
<li>Refresh Window</li>
<li>Else If [ $$themepage = 2 ]</li>
<li>Set Field [ report::pagenumberItem; TEMP::pageNumber ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>Set Field [ report::CurrentRecord; Get ( RecordID ) ]</li>
<li>End If</li>
<li>If [ $$theme  &ne;  reportItem::ktestGroup ]</li>
<li>Set Variable [ $$themepage; Value:1 ]</li>
<li>Set Field [ report::CurrentRecord; Get ( RecordID ) ]</li>
<li>Refresh Window</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reportItem</em>::ktestGroup</li>
<li>
<em>TEMP</em>::pageNumber</li>
<li>
<em>report</em>::pagenumberTheme</li>
<li>
<em>report</em>::pagenumberItem</li>
<li>
<em>report</em>::CurrentRecord</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33170ScriptAnchor_"></a><td class="script_navbar"><a href="#33169ScriptAnchor_"><span>Previous Script: [CHUNK_insertPageNumbers]</span></a></td><td class="script_navbar"><a href="#33166ScriptAnchor_"><span>Parent Folder: [Print]</span></a></td><td class="script_navbar"><a href="#33171ScriptAnchor_"><span>Next Script: [CHUNK_pagenumberItem]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">CHUNK_pagenumberTheme</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Variable [ $$themepage; Value:1 ]</li>
<li>Set Field [ report::CurrentRecord; Get ( RecordID ) ]</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>report</em>::CurrentRecord</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33171ScriptAnchor_"></a><td class="script_navbar"><a href="#33170ScriptAnchor_"><span>Previous Script: [CHUNK_pagenumberTheme]</span></a></td><td class="script_navbar"><a href="#33166ScriptAnchor_"><span>Parent Folder: [Print]</span></a></td><td class="script_navbar"><a href="#33172ScriptAnchor_"><span>Next Script: [CHUNK_insertPageNumbersbackOnePage]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">CHUNK_pagenumberItem</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Variable [ $$themepage; Value:2 ]</li>
<li>Set Field [ report::CurrentRecord; Get ( RecordID ) ]</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>report</em>::CurrentRecord</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33172ScriptAnchor_"></a><td class="script_navbar"><a href="#33171ScriptAnchor_"><span>Previous Script: [CHUNK_pagenumberItem]</span></a></td><td class="script_navbar"><a href="#33166ScriptAnchor_"><span>Parent Folder: [Print]</span></a></td><td class="script_navbar"><a href="#33173ScriptAnchor_"><span>Next Script: [CHUNK_insertPageNumbersforwardOnePage]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">CHUNK_insertPageNumbersbackOnePage</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Select Window [ Name: "Report"; Current file ]</li>
<li>Go to Record/Request/Page
[ Previous ]</li>
<li>Set Variable [ $page; Value:Get ( PageNumber ) ]</li>
<li>Set Field [ TEMP::pageNumber; $page ]</li>
<li>Select Window [ Name: "Numbers"; Current file ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::pageNumber</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33173ScriptAnchor_"></a><td class="script_navbar"><a href="#33172ScriptAnchor_"><span>Previous Script: [CHUNK_insertPageNumbersbackOnePage]</span></a></td><td class="script_navbar"><a href="#33166ScriptAnchor_"><span>Parent Folder: [Print]</span></a></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">CHUNK_insertPageNumbersforwardOnePage</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Select Window [ Name: "Report"; Current file ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>Set Variable [ $page; Value:Get ( PageNumber ) ]</li>
<li>Set Field [ TEMP::pageNumber; $page ]</li>
<li>Select Window [ Name: "Numbers"; Current file ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::pageNumber</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<p>
<span class="partheading"><a name="33307ScriptAnchor_"></a><a href="#33307ScriptAnchor_toc">tagMenu</a></span>
</p>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32942ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#32964ScriptAnchor_"><span>Next Script: [unzoomSetup]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">backFromTagMenus</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ Left ( $$openedFrom ; 4 ) = "step" ]</li>
<li>Close Window [ Current Window ]</li>
<li>Else If [ Get (WindowName) = "Tag Menus" ]</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>Else If [ Get (WindowName) = "Recommendations" ]</li>
<li>Select Window [ Name: "Report"; Current file ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32964ScriptAnchor_"></a><td class="script_navbar"><a href="#32942ScriptAnchor_"><span>Previous Script: [backFromTagMenus]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#32965ScriptAnchor_"><span>Next Script: [zoomSetup]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">unzoomSetup</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Move/Resize Window [ Current Window; Height: Get (ScreenHeight); Width: 700; Top: 0; Left: 0 ]</li>
<li>Set Variable [ $left; Value:Get ( WindowLeft ) ]</li>
<li>Set Variable [ $width; Value:Get ( WindowWidth) ]</li>
<li>Set Zoom Level
[ 100% ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>If [ Get (LastError)  = 112 ]</li>
<li>New Window [ Name: "Tag Menus"; Width: 333; Left: 0 ]</li>
<li>Go to Layout [ &ldquo;setupTestFocus&rdquo; (tagLocation) ]</li>
<li>End If</li>
<li>Set Zoom Level
[ 100% ]</li>
<li>Move/Resize Window [ Current Window; Height: Get (ScreenHeight); Width: 333; Top: 0; Left: If ( $left + $width + 333 &gt; Get ( ScreenWidth ) ; Get ( ScreenWidth ) - 333 ;  $left + $width  ) ]</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>setupTestFocus</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32965ScriptAnchor_"></a><td class="script_navbar"><a href="#32964ScriptAnchor_"><span>Previous Script: [unzoomSetup]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#32924ScriptAnchor_"><span>Next Script: [gotoSetupReport]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">zoomSetup</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Move/Resize Window [ Current Window; Height: Get (ScreenHeight); Width: 700; Top: 0; Left: 0 ]</li>
<li>Set Variable [ $left; Value:Get ( WindowLeft ) ]</li>
<li>Set Variable [ $width; Value:Get ( WindowWidth) ]</li>
<li>Set Zoom Level
[ 150% ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>If [ Get (LastError)  = 112 ]</li>
<li>New Window [ Name: "Tag Menus" ]</li>
<li>Go to Layout [ &ldquo;setupTestFocus&rdquo; (tagLocation) ]</li>
<li>End If</li>
<li>Set Zoom Level
[ 150% ]</li>
<li>Move/Resize Window [ Current Window; Height: Get (ScreenHeight); Width: 490; Top: 0; Left: If ( $left + $width &gt; Get ( ScreenWidth )  - 490; Get ( ScreenWidth ) - 490 ;  $left + $width  ) ]</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>setupTestFocus</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32924ScriptAnchor_"></a><td class="script_navbar"><a href="#32965ScriptAnchor_"><span>Previous Script: [zoomSetup]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#32891ScriptAnchor_"><span>Next Script: [returnToSetup]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">gotoSetupReport</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Close Window [ Name: "Cover Page"; Current file ]</li>
<li>New Window [ Name: "Cover Page" ]</li>
<li>Go to Layout [ &ldquo;setupReport&rdquo; (test) ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>setupReport</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32891ScriptAnchor_"></a><td class="script_navbar"><a href="#32924ScriptAnchor_"><span>Previous Script: [gotoSetupReport]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#32988ScriptAnchor_"><span>Next Script: [menuNode]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">returnToSetup</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33130ScriptAnchor_">backFromSetup</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>//  If [ $$learnEdit &ne; "" and $$defaultMode &ne; 1 ]</li>
<li>//  #Go to testlearn layout and loop back to record.</li>
<li>//  Set Window Title [ Current Window; New Title: "Learn" ]</li>
<li>//  Go to Layout [ &ldquo;learn1&rdquo; (testlearn) ]</li>
<li>//  #</li>
<li>//  #Go to Learn tag menu layout and loop back to record.</li>
<li>//  Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>//  Go to Layout [ &ldquo;defaultSections&rdquo; (ruleSection) ]</li>
<li>//  Perform Script [ &ldquo;defaultSectionMenu&rdquo; ]</li>
<li>//  Select Window [ Name: "Learn"; Current file ]</li>
<li>//  Go to Field [  ]</li>
<li>//  Refresh Window</li>
<li>//  #</li>
<li>//  Set Field [ TEMP::ktest; "" ]</li>
<li>//  #</li>
<li>//  Exit Script [  ]</li>
<li>If [ $$module = "testmenudetail" ]</li>
<li>#</li>
<li>#Go to testlearn layout and loop back to record.</li>
<li>Set Window Title [ Current Window; New Title: "Test" ]</li>
<li>Go to Layout [ &ldquo;step4_InspectionFinding&rdquo; (testlearn) ]</li>
<li>#</li>
<li>#Go to Learn tag menu layout and loop back to record.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Go to Layout [ &ldquo;testMenuTestItem&rdquo; (tagMenus) ]</li>
<li>#</li>
<li>#Reset temp item ID and clear variable holding</li>
<li>#ID while editing item information.</li>
<li>Set Field [ TEMP::ktest; $$itemID ]</li>
<li>Set Field [ TEMP::ktestItemList; $$detailID ]</li>
<li>Set Variable [ $$itemID ]</li>
<li>#</li>
<li>Perform Script [ &ldquo;menuTestItem&rdquo; ]</li>
<li>#</li>
<li>Exit Script [  ]</li>
<li>Else If [ $$module = "reportTagItem" ]</li>
<li>#</li>
<li>#Go to testlearn layout and loop back to record.</li>
<li>Set Window Title [ Current Window; New Title: "Report" ]</li>
<li>Go to Layout [ &ldquo;PrintReportEdit&rdquo; (report) ]</li>
<li>#</li>
<li>#Go to Learn tag menu layout and loop back to record.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Go to Layout [ &ldquo;reportTagItem&rdquo; (tagMenus) ]</li>
<li>#</li>
<li>#Reset temp item ID and clear variable holding</li>
<li>#ID while editing item information.</li>
<li>Set Field [ TEMP::ktest; $$itemID ]</li>
<li>Set Field [ TEMP::ktestItemList; $$detailID ]</li>
<li>Set Variable [ $$itemID ]</li>
<li>#</li>
<li>Perform Script [ &ldquo;menuTestItem&rdquo; ]</li>
<li>#</li>
<li>Exit Script [  ]</li>
<li>Else If [ $$module = "defaultSections" ]</li>
<li>Go to Layout [ &ldquo;defaultSetup&rdquo; (tempSetup) ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Go to Layout [ $$module ]</li>
<li>If [ $$module = "defaultSections" ]</li>
<li>Perform Script [ &ldquo;defaultSectionMenu&rdquo; ]</li>
<li>End If</li>
<li>Go to Record/Request/Page [ $$recordNumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordNumber ]</li>
<li>#</li>
<li>Set Field [ TEMP::ktest; "" ]</li>
<li>#</li>
<li>#</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Go to testlearn layout and loop back to record.</li>
<li>Set Window Title [ Current Window; New Title: "Test" ]</li>
<li>Go to Layout [ &ldquo;step4_InspectionFinding&rdquo; (testlearn) ]</li>
<li>#</li>
<li>#Go to Learn tag menu layout and loop back to record.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Go to Layout [ &ldquo;testMenuTestItem&rdquo; (tagMenus) ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuTestGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuTestGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page [ $$recordNumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordNumber ]</li>
<li>#</li>
<li>Exit Script [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::ktest</li>
<li>
<em>TEMP</em>::ktestItemList</li>
<li>
<em>ruleTagMenuTestGroups</em>::order</li>
<li>
<em>ruleTagMenuTestGroups</em>::name</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>tagMenus</em>::tag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33090ScriptAnchor_">defaultSectionMenu</a></li>
<li><a href="#33071ScriptAnchor_">menuTestItem</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>learn1</li>
<li>defaultSections</li>
<li>step4_InspectionFinding</li>
<li>testMenuTestItem</li>
<li>PrintReportEdit</li>
<li>reportTagItem</li>
<li>defaultSetup</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32988ScriptAnchor_"></a><td class="script_navbar"><a href="#32891ScriptAnchor_"><span>Previous Script: [returnToSetup]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#32993ScriptAnchor_"><span>Next Script: [menuKey]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">menuNode</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32983ScriptAnchor_">TgotoCitationMenu</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If user is in tag field and has changed spelling</li>
<li>#exit this tag record, otherwise current reference record</li>
<li>#will get deleted by the spelling check script.</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Clear sample and test tags so there conditional</li>
<li>#formatting in the Learn window is removed.</li>
<li>If [ $$citationMatch = "sample" or $$citationMatch = "test" ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $$citationItem; Value:testlearn::kNodePrimary ]</li>
<li>Set Variable [ $$tagSample ]</li>
<li>Set Variable [ $$tagtest ]</li>
<li>Set Variable [ $$tagRecordID ]</li>
<li>Set Variable [ $$tagEdit ]</li>
<li>#</li>
<li>#Sort the records by date field, if current sort is</li>
<li>#by order number.</li>
<li>If [ TEMP::TLTestSort = "order" or TEMP::TLSampleSort = "order" ]</li>
<li>Sort Records [ Specified Sort Order: testlearn::date; descending
testlearn::timestamp; descending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#Set the sort preference field to date.</li>
<li>If [ $$citationMatch = "sample" ]</li>
<li>Set Field [ TEMP::TLSampleSort; "" ]</li>
<li>Else If [ $$citationMatch = "test" ]</li>
<li>Set Field [ TEMP::TLTestSort; "" ]</li>
<li>End If</li>
<li>#</li>
<li>End If</li>
<li>End If</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>#</li>
<li>#Set citationMatch to color menu button with inUse color.</li>
<li>Set Variable [ $$citationMatch; Value:"node" ]</li>
<li>#</li>
<li>#Set match temp tag field to limit move pulldown</li>
<li>#to just the groups for this section and item type.</li>
<li>#( if you're wondering why this temp field is a</li>
<li>#    a dupllicate of the citation match variable it</li>
<li>#    is because I didn't need it until a year into</li>
<li>#    writing this database.  At some point, it would</li>
<li>#    probably be good to get rid of the variable. )</li>
<li>Set Field [ TEMP::mTag; $$citationMatch ]</li>
<li>#</li>
<li>#Do not load tag records until the end of script</li>
<li>#to prevent flashing of window and to speed up</li>
<li>#script.</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>#</li>
<li>#Goto correct layout.</li>
<li>#If in add mode ...</li>
<li>If [ $$add = 1 ]</li>
<li>Go to Layout [ &ldquo;addMenuNodeKeyword&rdquo; (tagMenus) ]</li>
<li>#</li>
<li>#If user has elected to show only the tag ...</li>
<li>Else If [ TEMP::layoutRtagN = "" or TEMP::layoutLtagN = "" ]</li>
<li>If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>Go to Layout [ &ldquo;ltagNK2&rdquo; (tagMenus) ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;ltagNKs2&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>Set Field [ TEMP::layoutLtagN; "more" &amp; Get (LayoutName) ]</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "r" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenu2keywordOrNode1&rdquo; (tagMenus) ]</li>
<li>Set Field [ TEMP::layoutRtagN; "more" &amp; Get (LayoutName) ]</li>
<li>End If</li>
<li>#</li>
<li>#If user has elected to show some pictures ...</li>
<li>Else If [ TEMP::layoutRtagN &ne; "" or TEMP::layoutLtagN &ne; "" ]</li>
<li>If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>Go to Layout [ Middle ( TEMP::layoutLtagN ; 5 ; 42 ) ]</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "r" ]</li>
<li>Go to Layout [ Middle ( TEMP::layoutRtagN ; 5 ; 42 ) ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Find node tags. </li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::match; $$citationMatch ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; "==" &amp; TEMP::ksection ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>//  #If no records exist then create one.</li>
<li>//  If [ Get (FoundCount)=0 ]</li>
<li>//  Perform Script [ &ldquo;newCitationMenuGroup&rdquo; ]</li>
<li>//  End If</li>
<li>#</li>
<li>#Sort according to current users wishes.  By default</li>
<li>#the sort will be by category which is set by editCitation script.</li>
<li>If [ TEMP::sortNode = "cat" or TEMP::sortNode = "" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ TEMP::sortNode = "abc" ]</li>
<li>Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#Decided not do this as user may be going to </li>
<li>#node menus to add an node tag to a citation</li>
<li>#the user is planning on adding to a tag</li>
<li>#which means the user may want to remain in</li>
<li>#add to tag mode when clicking on the node menu</li>
<li>#item.  In the first phase of developement</li>
<li>#I thought if the user activitated the add mode</li>
<li>#in either the keyword or node menu that the</li>
<li>#user would not want to see the add button showing</li>
<li>#green in the other window (keyword or node).</li>
<li>#I was trying to keep the add button's on state</li>
<li>#associated only with the menu item where it</li>
<li>#was activitated.  This in testing did not seem</li>
<li>#useful at limited access to node or keyword</li>
<li>#in this mode when both might be needed.</li>
<li>//  #If user was in Add mode for keyword, then reset</li>
<li>//  #mode back to citation mode (or adding node</li>
<li>//  #tags to citations instead of the other way around).</li>
<li>//  If [ $$add = 1 and $$addcitationMatch = "key" ]</li>
<li>//  Perform Script [ &ldquo;addLinksPicturesToTagsMode&rdquo; ]</li>
<li>//  End If</li>
<li>#</li>
<li>#Go to citation record's current selection or to first record.</li>
<li>#Because user may click anywhere to go to a record</li>
<li>#all keys for all menu items must uploaded</li>
<li>#until one is found that matches and then the</li>
<li>#$$citationItem variable can be set.</li>
<li>#Like when the user clicks in a non field area</li>
<li>#a space between fields that then tells filemaker</li>
<li>#to go that record but not to field belonging to</li>
<li>#that record.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$primarykey =  tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>If [ $$primarykey &ne;  tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>End If</li>
<li>#</li>
<li>#Decided this override of above loop is to confusing</li>
<li>#and the proper way to do keep record user wants</li>
<li>#to add to in focus is to open a third window.</li>
<li>#I'm not doing that for now.</li>
<li>//  #If in add mode then go to addRecord.</li>
<li>//  If [ $$add = 1 ]</li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  Loop</li>
<li>//  Exit Loop If [ $$addRecordID = tagMenus::_Ltag ]</li>
<li>//  Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>//  End Loop</li>
<li>//  End If</li>
<li>#</li>
<li>#Inform user of items use on both screens.</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Perform Script [ &ldquo;loadTagRecord&rdquo; ]</li>
<li>#</li>
<li>#Just in case user was in nonTag field on this</li>
<li>#window when user clicked a menu button on </li>
<li>#the other window, exit all  fields.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $$citationItem; Value:testlearn::kNodePrimary ]</li>
<li>Set Variable [ $$tagSample ]</li>
<li>Set Variable [ $$tagRecordID ]</li>
<li>Set Variable [ $$tagEdit ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>#</li>
<li>#If in add mode, find only records tagged with</li>
<li>#current $$citationmatch.</li>
<li>If [ $$add = 1 ]</li>
<li>#</li>
<li>#But, give user option to keep the records currently</li>
<li>#showing in the main window.</li>
<li>Show Custom Dialog [ Message: "In the main window, show only records with pictures and links added to node tags, or keep the current records shown?"; Buttons: &ldquo;keep&rdquo;, &ldquo;show&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#find on reference layout ...</li>
<li>If [ Left (Get (LayoutName) ; 1) = "r" ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::kcsection; TEMP::ksection ]</li>
<li>Set Field [ reference::filterFind; "node" ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#find on learn layout ...</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection ]</li>
<li>Set Field [ testlearn::filterFind; "node" ]</li>
<li>Perform Find [  ]</li>
<li>End If</li>
<li>End If</li>
<li>Set Variable [ $$citationItem; Value:reference::knodePrimary ]</li>
<li>End If</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearn</em>::kNodePrimary</li>
<li>
<em>TEMP</em>::TLTestSort</li>
<li>
<em>TEMP</em>::TLSampleSort</li>
<li>
<em>testlearn</em>::date</li>
<li>
<em>testlearn</em>::timestamp</li>
<li>
<em>TEMP</em>::mTag</li>
<li>
<em>TEMP</em>::layoutRtagN</li>
<li>
<em>TEMP</em>::layoutLtagN</li>
<li>
<em>TEMP</em>::InventoryLibaryYN</li>
<li>
<em>tagMenus</em>::match</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>ruleTagMenuGroups</em>::ksection</li>
<li>
<em>TEMP</em>::sortNode</li>
<li>
<em>ruleTagMenuGroups</em>::order</li>
<li>
<em>ruleTagMenuGroups</em>::name</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>reference</em>::kcsection</li>
<li>
<em>reference</em>::filterFind</li>
<li>
<em>testlearn</em>::kcsection</li>
<li>
<em>testlearn</em>::filterFind</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32980ScriptAnchor_">newCitationMenuGroup</a></li>
<li><a href="#33020ScriptAnchor_">addLinksPicturesToTagsMode</a></li>
<li><a href="#33038ScriptAnchor_">loadTagRecord</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>addMenuNodeKeyword</li>
<li>ltagNK2</li>
<li>ltagNKs2</li>
<li>ReferenceMenu2keywordOrNode1</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32993ScriptAnchor_"></a><td class="script_navbar"><a href="#32988ScriptAnchor_"><span>Previous Script: [menuNode]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33013ScriptAnchor_"><span>Next Script: [menuHealth]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">menuKey</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32983ScriptAnchor_">TgotoCitationMenu</a></li>
<li><a href="#33152ScriptAnchor_">editLearn</a></li>
<li><a href="#32981ScriptAnchor_">editCitation</a></li>
<li><a href="#33070ScriptAnchor_">learn</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Clear sample and test tags so there conditional</li>
<li>#formatting in the Learn window is removed.</li>
<li>If [ $$citationMatch = "sample" or $$citationMatch = "test" ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $$tagSample ]</li>
<li>Set Variable [ $$tagtest ]</li>
<li>Set Variable [ $$tagRecordID ]</li>
<li>Set Variable [ $$tagEdit ]</li>
<li>End If</li>
<li>Sort Records [ Specified Sort Order: testlearn::date; descending
testlearn::timestamp; descending ]
[ Restore; No dialog ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>#</li>
<li>#Set citationMatch to color menu button with inUse color.</li>
<li>Set Variable [ $$citationMatch; Value:"key" ]</li>
<li>#</li>
<li>#Set match temp tag field to limit move pulldown</li>
<li>#to just the groups for this section and item type.</li>
<li>#( if you're wondering why this temp field is a</li>
<li>#    a dupllicate of the citation match variable it</li>
<li>#    is because I didn't need it until a year into</li>
<li>#    writing this database.  At some point, it would</li>
<li>#    probably be good to get rid of the variable. )</li>
<li>Set Field [ TEMP::mTag; $$citationMatch ]</li>
<li>#</li>
<li>#Do not load tag records until the end of script</li>
<li>#to prevent flashing of window and to speed up</li>
<li>#script.</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>#</li>
<li>#Goto correct layout.</li>
<li>#If in add mode ...</li>
<li>If [ $$add = 1 ]</li>
<li>Go to Layout [ &ldquo;addMenuNodeKeyword&rdquo; (tagMenus) ]</li>
<li>#</li>
<li>#If user has elected to show only the tag ...</li>
<li>Else If [ TEMP::layoutRtagK = "" or TEMP::layoutLtagK = "" ]</li>
<li>If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>Go to Layout [ &ldquo;ltagNK2&rdquo; (tagMenus) ]</li>
<li>Set Field [ TEMP::layoutLtagK; "more" &amp; Get (LayoutName) ]</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "r" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenu2keywordOrNode1&rdquo; (tagMenus) ]</li>
<li>Set Field [ TEMP::layoutRtagK; "more" &amp; Get (LayoutName) ]</li>
<li>End If</li>
<li>#</li>
<li>#If user has elected to show some pictures ...</li>
<li>Else If [ TEMP::layoutRtagK &ne; "" or TEMP::layoutLtagK &ne; "" ]</li>
<li>If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>Go to Layout [ Middle ( TEMP::layoutLtagK ; 5 ; 42 ) ]</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "r" ]</li>
<li>Go to Layout [ Middle ( TEMP::layoutRtagK ; 5 ; 42 ) ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Find key tags for library section.  </li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::match; $$citationMatch ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; "==" &amp; TEMP::ksection ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>//  #If no records exist then create one.</li>
<li>//  If [ Get (FoundCount)=0 ]</li>
<li>//  Perform Script [ &ldquo;newCitationMenuGroup&rdquo; ]</li>
<li>//  End If</li>
<li>#</li>
<li>#Sort according to current users wishes.  By default</li>
<li>#the sort will be by category which is set by editCitation script.</li>
<li>If [ TEMP::sortKey = "cat" or TEMP::sortKey = "" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ TEMP::sortKey = "abc" ]</li>
<li>Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#Decided not do this as user may be going to </li>
<li>#node menus to add an node tag to a citation</li>
<li>#the user is planning on adding to a tag</li>
<li>#which means the user may want to remain in</li>
<li>#add to tag mode when clicking on the node menu</li>
<li>#item.  In the first phase of developement</li>
<li>#I thought if the user activitated the add mode</li>
<li>#in either the keyword or node menu that the</li>
<li>#user would not want to see the add button showing</li>
<li>#green in the other window (keyword or node).</li>
<li>#I was trying to keep the add button's on state</li>
<li>#associated only with the menu item where it</li>
<li>#was activitated.  This in testing did not seem</li>
<li>#useful at limited access to node or keyword</li>
<li>#in this mode when both might be needed.</li>
<li>//  #If user was in Add mode for keyword, then reset</li>
<li>//  #mode back to citation mode (or adding node</li>
<li>//  #tags to citations instead of the other way around).</li>
<li>//  If [ $$add = 1 and $$addcitationMatch = "node" ]</li>
<li>//  Perform Script [ &ldquo;addLinksPicturesToTagsMode&rdquo; ]</li>
<li>//  End If</li>
<li>#</li>
<li>#Go to citation record's current selection or to first record.</li>
<li>#Because user may click anywhere to go to a record</li>
<li>#all keys for all menu items must uploaded</li>
<li>#until one is found that matches and then the</li>
<li>#$$citationItem variable can be set.</li>
<li>#Like when the user clicks in a non field area</li>
<li>#a space between fields that then tells filemaker</li>
<li>#to go that record but not to field belonging to</li>
<li>#that record.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$primaryKey =  tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>If [ $$primaryKey &ne;  tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>End If</li>
<li>#</li>
<li>#Inform user of items use on both screens.</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Perform Script [ &ldquo;loadTagRecord&rdquo; ]</li>
<li>#</li>
<li>#Just in case user was in nonTag field on this</li>
<li>#window when user clicked a menu button on </li>
<li>#the other window, exit all  fields.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $$citationItem; Value:testlearn::kKeywordPrimary ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $$citationItem; Value:reference::kkeywordPrimary ]</li>
<li>#</li>
<li>#If in add mode, find only records tagged with</li>
<li>#current $$citationmatch.</li>
<li>If [ $$add = 1 ]</li>
<li>#</li>
<li>#But, give user option to keep the records currently</li>
<li>#showing in the main window.</li>
<li>Show Custom Dialog [ Message: "In the main window, show only records with pictures and links added to keyword tags, or keep the current records shown?"; Buttons: &ldquo;keep&rdquo;, &ldquo;show&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#find on learn layout ...</li>
<li>If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection ]</li>
<li>Set Field [ testlearn::filterFind; "key" ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#find on reference layout ...</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "r" ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::kcsection; TEMP::ksection ]</li>
<li>Set Field [ reference::filterFind; "key" ]</li>
<li>Perform Find [  ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>End If</li>
<li>Refresh Window</li>
<li>#</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearn</em>::date</li>
<li>
<em>testlearn</em>::timestamp</li>
<li>
<em>TEMP</em>::mTag</li>
<li>
<em>TEMP</em>::layoutRtagK</li>
<li>
<em>TEMP</em>::layoutLtagK</li>
<li>
<em>tagMenus</em>::match</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>ruleTagMenuGroups</em>::ksection</li>
<li>
<em>TEMP</em>::sortKey</li>
<li>
<em>ruleTagMenuGroups</em>::order</li>
<li>
<em>ruleTagMenuGroups</em>::name</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>testlearn</em>::kKeywordPrimary</li>
<li>
<em>reference</em>::kkeywordPrimary</li>
<li>
<em>testlearn</em>::kcsection</li>
<li>
<em>testlearn</em>::filterFind</li>
<li>
<em>reference</em>::kcsection</li>
<li>
<em>reference</em>::filterFind</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32980ScriptAnchor_">newCitationMenuGroup</a></li>
<li><a href="#33020ScriptAnchor_">addLinksPicturesToTagsMode</a></li>
<li><a href="#33038ScriptAnchor_">loadTagRecord</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>addMenuNodeKeyword</li>
<li>ltagNK2</li>
<li>ReferenceMenu2keywordOrNode1</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33013ScriptAnchor_"></a><td class="script_navbar"><a href="#32993ScriptAnchor_"><span>Previous Script: [menuKey]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#32989ScriptAnchor_"><span>Next Script: [menuMedium]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">menuHealth</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32983ScriptAnchor_">TgotoCitationMenu</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>#</li>
<li>#Clear sample and test tags so there conditional</li>
<li>#formatting in the Learn window is removed.</li>
<li>If [ $$citationMatch = "sample" or $$citationMatch = "test" ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $$tagSample ]</li>
<li>Set Variable [ $$tagtest ]</li>
<li>Set Variable [ $$tagRecordID ]</li>
<li>Set Variable [ $$tagEdit ]</li>
<li>End If</li>
<li>Sort Records [ Specified Sort Order: testlearn::date; descending
testlearn::timestamp; descending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>#Set citationMatch to color menu button with inUse color.</li>
<li>Set Variable [ $$citationMatch; Value:"health" ]</li>
<li>#</li>
<li>#Set match temp tag field to limit move pulldown</li>
<li>#to just the groups for this section and item type.</li>
<li>#( if you're wondering why this temp field is a</li>
<li>#    a dupllicate of the citation match variable it</li>
<li>#    is because I didn't need it until a year into</li>
<li>#    writing this database.  At some point, it would</li>
<li>#    probably be good to get rid of the variable. )</li>
<li>Set Field [ TEMP::mTag; $$citationMatch ]</li>
<li>#</li>
<li>#Turn off the loadtagrecord script to speed up the </li>
<li>#loop portion of the script.</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>#</li>
<li>#Goto correct layout.</li>
<li>#If in add mode ...</li>
<li>If [ $$add = 1 ]</li>
<li>Go to Layout [ &ldquo;addMenu1&rdquo; (tagMenus) ]</li>
<li>#</li>
<li>#If in learn mode ...</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>Go to Layout [ &ldquo;learnMenuHealth&rdquo; (tagMenus) ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;learnMenuSHealth&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>#</li>
<li>#If in reference mode ...</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "r" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenuHealth&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>#</li>
<li>#Find Permission tags.  Permission tags are available to all library sections.</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::match; $$citationMatch ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Upate language for locked health tags.</li>
<li>Perform Script [ &ldquo;CHUNKHealthLockedFields&rdquo; ]</li>
<li>#</li>
<li>//  #If no records exist then create one.</li>
<li>//  If [ Get (FoundCount)=0 ]</li>
<li>//  Perform Script [ &ldquo;newCitationMenuGroup&rdquo; ]</li>
<li>//  End If</li>
<li>#</li>
<li>#Sort according to current users wishes.  By default</li>
<li>#the sort will be by category which is set by editCitation script.</li>
<li>If [ TEMP::sortHealth = "cat" or TEMP::sortHealth = "" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ TEMP::sortHealth = "abc" ]</li>
<li>Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#Go to citation record's current selection or to first record.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$health =  tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Turn loadtagrecord script back on.</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>#</li>
<li>If [ $$health &ne;  tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Inform user of items use on both screens.</li>
<li>Set Variable [ $$citationItem; Value:tagMenus::_Ltag ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#Just in case user was in nonTag field on this</li>
<li>#window when user clicked a menu button on </li>
<li>#the other window, exit all  fields.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Go to Field [  ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>#</li>
<li>#If in add mode, find only records tagged with</li>
<li>#current $$citationmatch.</li>
<li>If [ $$add = 1 ]</li>
<li>#But, give user option to keep the records currently</li>
<li>#showing in the main window.</li>
<li>Show Custom Dialog [ Message: "In the main window, show only records with pictures and links added to health tags, or keep the current records shown?"; Buttons: &ldquo;keep&rdquo;, &ldquo;show&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#find on reference layout ...</li>
<li>If [ Left (Get (LayoutName) ; 1) = "r" ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::kcsection; TEMP::ksection ]</li>
<li>Set Field [ reference::filterFind; "health" ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#find on learn layout ...</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection ]</li>
<li>Set Field [ testlearn::filterFind; "health" ]</li>
<li>Perform Find [  ]</li>
<li>End If</li>
<li>End If</li>
<li>End If</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearn</em>::date</li>
<li>
<em>testlearn</em>::timestamp</li>
<li>
<em>TEMP</em>::mTag</li>
<li>
<em>TEMP</em>::InventoryLibaryYN</li>
<li>
<em>tagMenus</em>::match</li>
<li>
<em>TEMP</em>::sortHealth</li>
<li>
<em>ruleTagMenuGroups</em>::order</li>
<li>
<em>ruleTagMenuGroups</em>::name</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>reference</em>::kcsection</li>
<li>
<em>reference</em>::filterFind</li>
<li>
<em>testlearn</em>::kcsection</li>
<li>
<em>testlearn</em>::filterFind</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33243ScriptAnchor_">CHUNKHealthLockedFields</a></li>
<li><a href="#32980ScriptAnchor_">newCitationMenuGroup</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>addMenu1</li>
<li>learnMenuHealth</li>
<li>learnMenuSHealth</li>
<li>ReferenceMenuHealth</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32989ScriptAnchor_"></a><td class="script_navbar"><a href="#33013ScriptAnchor_"><span>Previous Script: [menuHealth]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33068ScriptAnchor_"><span>Next Script: [menuTest]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">menuMedium</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32983ScriptAnchor_">TgotoCitationMenu</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#</li>
<li>#Clear sample and test tags so there conditional</li>
<li>#formatting in the Learn window is removed.</li>
<li>If [ $$citationMatch = "sample" or $$citationMatch = "test" ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $$tagSample ]</li>
<li>Set Variable [ $$tagtest ]</li>
<li>Set Variable [ $$tagRecordID ]</li>
<li>Set Variable [ $$tagEdit ]</li>
<li>End If</li>
<li>Sort Records [ Specified Sort Order: testlearn::date; descending
testlearn::timestamp; descending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>#</li>
<li>#</li>
<li>#Set citationMatch to color menu button with inUse color.</li>
<li>Set Variable [ $$citationMatch; Value:"medium" ]</li>
<li>#</li>
<li>#Set match temp tag field to limit move pulldown</li>
<li>#to just the groups for this section and item type.</li>
<li>#( if you're wondering why this temp field is a</li>
<li>#    a dupllicate of the citation match variable it</li>
<li>#    is because I didn't need it until a year into</li>
<li>#    writing this database.  At some point, it would</li>
<li>#    probably be good to get rid of the variable. )</li>
<li>Set Field [ TEMP::mTag; $$citationMatch ]</li>
<li>#</li>
<li>#Turn off the loadtagrecord script to speed up the </li>
<li>#loop portion of the script.</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>#</li>
<li>#Goto correct layout.</li>
<li>#If in add mode ...</li>
<li>If [ $$add = 1 ]</li>
<li>Go to Layout [ &ldquo;addMenu1&rdquo; (tagMenus) ]</li>
<li>#</li>
<li>#If in learn mode ...</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>Go to Layout [ &ldquo;learnMenu1&rdquo; (tagMenus) ]</li>
<li>#</li>
<li>#If in reference mode ...</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "r" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenu1&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>#</li>
<li>#Find medium tags.  Medium tags are available to all library sections.</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::match; $$citationMatch ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>//  #If no records exist then create one.</li>
<li>//  If [ Get (FoundCount)=0 ]</li>
<li>//  Perform Script [ &ldquo;newCitationMenuGroup&rdquo; ]</li>
<li>//  End If</li>
<li>#</li>
<li>#Sort according to current users wishes.  By default</li>
<li>#the sort will be by category which is set by editCitation script.</li>
<li>If [ TEMP::sortMedium = "cat" or TEMP::sortMedium = "" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ TEMP::sortMedium = "abc" ]</li>
<li>Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#Go to citation record's current selection or to first record.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$medium =  tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Turn loadtagrecord script back on.</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>#</li>
<li>If [ $$medium &ne;  tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>//  Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Inform user of items use on both screens.</li>
<li>Set Variable [ $$citationItem; Value:tagMenus::_Ltag ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#Just in case user was in nonTag field on this</li>
<li>#window when user clicked a menu button on </li>
<li>#the other window, exit all  fields.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Go to Field [  ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#If in add mode, find only records tagged with</li>
<li>#current $$citationmatch.</li>
<li>If [ $$add = 1 ]</li>
<li>#</li>
<li>#But, give user option to keep the records currently</li>
<li>#showing in the main window.</li>
<li>Show Custom Dialog [ Message: "In the main window, show only records with pictures and links added to medium tags, or keep the current records shown?"; Buttons: &ldquo;keep&rdquo;, &ldquo;show&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#find on reference layout ...</li>
<li>If [ Left (Get (LayoutName) ; 1) = "r" ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::kcsection; TEMP::ksection ]</li>
<li>Set Field [ reference::filterFind; "medium" ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#find on learn layout ...</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection ]</li>
<li>Set Field [ testlearn::filterFind; "medium" ]</li>
<li>Perform Find [  ]</li>
<li>End If</li>
<li>End If</li>
<li>End If</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearn</em>::date</li>
<li>
<em>testlearn</em>::timestamp</li>
<li>
<em>TEMP</em>::mTag</li>
<li>
<em>tagMenus</em>::match</li>
<li>
<em>TEMP</em>::sortMedium</li>
<li>
<em>ruleTagMenuGroups</em>::order</li>
<li>
<em>ruleTagMenuGroups</em>::name</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>reference</em>::kcsection</li>
<li>
<em>reference</em>::filterFind</li>
<li>
<em>testlearn</em>::kcsection</li>
<li>
<em>testlearn</em>::filterFind</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32980ScriptAnchor_">newCitationMenuGroup</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>addMenu1</li>
<li>learnMenu1</li>
<li>ReferenceMenu1</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33068ScriptAnchor_"></a><td class="script_navbar"><a href="#32989ScriptAnchor_"><span>Previous Script: [menuMedium]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33071ScriptAnchor_"><span>Next Script: [menuTestItem]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">menuTest</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33152ScriptAnchor_">editLearn</a></li>
<li><a href="#33130ScriptAnchor_">backFromSetup</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>#</li>
<li>#If user is in tag field and has changed spelling</li>
<li>#exit this tag record, otherwise current reference record</li>
<li>#will get deleted by the spelling check script.</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Clear sample and test tags.</li>
<li>If [ $$citationMatch = "sample" ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $$citationItem; Value:testlearn::kNodePrimary ]</li>
<li>Set Variable [ $$tagSample ]</li>
<li>Set Variable [ $$tagtest ]</li>
<li>Set Field [ TEMP::ktest; "" ]</li>
<li>Set Variable [ $$tagRecordID ]</li>
<li>Set Variable [ $$tagEdit ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>End If</li>
<li>#</li>
<li>#Clear order numbers.</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>New Window [ Height: 1; Width: 1 ]</li>
<li>Go to Layout [ &ldquo;learnSCRIPTloops&rdquo; (testlearn) ]</li>
<li>Perform Find [ Specified Find Requests: Find Records; Criteria: testlearn::orderTest: &ldquo;###&rdquo; ]
[ Restore ]</li>
<li>Loop</li>
<li>Set Field [ testlearn::orderTest; "" ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Close Window [ Current Window ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>#</li>
<li>#Set citationMatch to color menu button with inUse color.</li>
<li>Set Variable [ $$citationMatch; Value:"test" ]</li>
<li>#</li>
<li>#Turn off the loadtagrecord script to speed up the </li>
<li>#loop portion of the script.</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>#</li>
<li>#Goto correct layout.</li>
<li>If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>Go to Layout [ &ldquo;learnTest&rdquo; (test) ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;learnSTest&rdquo; (test) ]</li>
<li>End If</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "r" ]</li>
<li>Go to Layout [ &ldquo;learnTest&rdquo; (test) ]</li>
<li>End If</li>
<li>#</li>
<li>#Find section tags.  Test tags are library </li>
<li>#items. Any brainstorm or evidence record</li>
<li>#can be tagged with any section item record SO</li>
<li>#find all library sections current record is </li>
<li>#assigned to.</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ test::ksection; TEMP::ksection ]</li>
<li>Perform Find [  ]</li>
<li>#Sort according to current users wishes.  By default</li>
<li>#the sort will be by category which is set by editCitation script.</li>
<li>#</li>
<li>If [ TEMP::sortTest = "cat" or TEMP::sortTest = "" ]</li>
<li>Sort Records [ Specified Sort Order: groupTest::order; based on value list: &ldquo;order&rdquo;
groupTest::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
test::order; ascending
test::testName; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ $$citationMatch = "test" ]</li>
<li>Set Field [ TEMP::sortTest; "abc" ]</li>
<li>End If</li>
<li>#</li>
<li>#Go to citation record's current selection or to first record.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Loop</li>
<li>Set Variable [ $number; Value:1 ]</li>
<li>Go to Field [  ]</li>
<li>Loop</li>
<li>Exit Loop If [ Middle ( GetValue ( $$test ; $number ) ; 4 ; 42 )  &amp; "&para;"   = test::_Ltest &amp; &para; ]</li>
<li>Exit Loop If [ Middle ( GetValue ( $$test ; $number ) ; 4 ; 42 )  = "" ]</li>
<li>Set Variable [ $add; Value:$number ]</li>
<li>Set Variable [ $number; Value:$add + 1 ]</li>
<li>End Loop</li>
<li>Exit Loop If [ Middle ( GetValue ( $$test ; $number ) ; 4 ; 42 )  &amp; "&para;"   = test::_Ltest &amp; &para; ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>If [ Middle ( GetValue ( $$test ; $number ) ; 4 ; 42 )  &amp; "&para;" &ne; test::_Ltest &amp; &para; ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>End If</li>
<li>#</li>
<li>#Turn loadtagrecord script back on and perform</li>
<li>#loadtag... script to highlight any Learn records</li>
<li>#tagged with the current tag record.</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Perform Script [ &ldquo;loadItemRecordForTestTagMenu&rdquo; ]</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearn</em>::kNodePrimary</li>
<li>
<em>TEMP</em>::ktest</li>
<li>
<em>testlearn</em>::orderTest</li>
<li>
<em>TEMP</em>::InventoryLibaryYN</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>test</em>::ksection</li>
<li>
<em>TEMP</em>::sortTest</li>
<li>
<em>groupTest</em>::order</li>
<li>
<em>groupTest</em>::name</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>test</em>::order</li>
<li>
<em>test</em>::testName</li>
<li>
<em>test</em>::_Ltest</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33127ScriptAnchor_">loadItemRecordForTestTagMenu</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>learnSCRIPTloops</li>
<li>learnTest</li>
<li>learnSTest</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33071ScriptAnchor_"></a><td class="script_navbar"><a href="#33068ScriptAnchor_"><span>Previous Script: [menuTest]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33117ScriptAnchor_"><span>Next Script: [menuSample]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">menuTestItem</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32925ScriptAnchor_">newTestGroup</a></li>
<li><a href="#32926ScriptAnchor_">newTest</a></li>
<li><a href="#33177ScriptAnchor_">(un)linkTestItemGroupToTestItemList</a></li>
<li><a href="#32829ScriptAnchor_">gotoTestItem</a></li>
<li><a href="#32822ScriptAnchor_">evidenceDetailSpacetimeDELETE?????</a></li>
<li><a href="#32891ScriptAnchor_">returnToSetup</a></li>
<li><a href="#33020ScriptAnchor_">addLinksPicturesToTagsMode</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>If [ TEMP::ktest = "" ]</li>
<li>Exit Script [  ]</li>
<li>Show Custom Dialog [ Message: "There are no tests."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>#Goto correct layout.</li>
<li>#If in add mode ...</li>
<li>If [ $$add = 1 ]</li>
<li>Go to Layout [ &ldquo;addMenuTestItem&rdquo; (tagMenus) ]</li>
<li>#</li>
<li>#If user has elected to show only the tag ...</li>
<li>Else If [ TEMP::DetailmoreORLessLayout = "" and Left ( Get ( LayoutName ) ; 5 ) = "setup" ]</li>
<li>Go to Layout [ &ldquo;setupTestItem&rdquo; (tagMenus) ]</li>
<li>Else If [ TEMP::DetailmoreORLessLayout &ne; "" and Left ( Get ( LayoutName ) ; 5 ) = "setup" ]</li>
<li>Go to Layout [ &ldquo;setupTestItem&rdquo; (tagMenus) ]</li>
<li>#</li>
<li>#If user has elected to show some pictures ...</li>
<li>Else If [ TEMP::DetailmoreORLessLayout = "" and Left ( Get ( LayoutName ) ; 4 ) = "test" ]</li>
<li>Go to Layout [ &ldquo;testMenuTestItem&rdquo; (tagMenus) ]</li>
<li>Else If [ TEMP::DetailmoreORLessLayout &ne; "" and Left ( Get ( LayoutName ) ; 4 ) = "test" ]</li>
<li>Go to Layout [ &ldquo;testMenuTestItem&rdquo; (tagMenus) ]</li>
<li>#</li>
<li>Else If [ Left ( Get (LayoutName) ; 6 ) = "report" ]</li>
<li>#</li>
<li>#Find test list key as it may be different from test key.</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>Set Variable [ $$stopTest; Value:1 ]</li>
<li>Set Variable [ $$ID; Value:"ignore" ]</li>
<li>Go to Layout [ &ldquo;testSetup&rdquo; (test) ]</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ test::_Ltest; TEMP::ktest ]</li>
<li>Perform Find [  ]</li>
<li>Set Field [ TEMP::ktestItemList; test::ktestItemList ]</li>
<li>Go to Layout [ &ldquo;reportTagItem&rdquo; (tagMenus) ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Set Variable [ $$stopTest ]</li>
<li>Set Variable [ $$ID ]</li>
<li>#</li>
<li>End If</li>
<li>Set Variable [ $$citationMatch; Value:"testItem" ]</li>
<li>Set Field [ TEMP::mTag; TEMP::ktest ]</li>
<li>#</li>
<li>#Find test items for section.  </li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ ruleTagMenuTestGroups::match; TEMP::ktestItemList &amp; &para; ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuTestGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuTestGroups::name; ascending
ruleTagMenuTestGroups::_Lgroup; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>#Just in case user was in nonTag field on this</li>
<li>#window when user clicked a menu button on </li>
<li>#the other window, exit all  fields.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Go to Field [  ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>#</li>
<li>#If in add mode, find only records tagged with</li>
<li>#current $$citationmatch.</li>
<li>If [ $$add = 1 ]</li>
<li>#</li>
<li>#But, give user option to keep the records currently</li>
<li>#showing in the main window.</li>
<li>Show Custom Dialog [ Message: "In the main window, show only records with pictures and links added to test item tags, or keep the current records shown?"; Buttons: &ldquo;keep&rdquo;, &ldquo;show&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#find on learn layout ...</li>
<li>If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection ]</li>
<li>Set Field [ testlearn::filterFind; "testItem" ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#find on reference layout ...</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "r" ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::kcsection; TEMP::ksection ]</li>
<li>Set Field [ reference::filterFind; "testItem" ]</li>
<li>Perform Find [  ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>End If</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::ktest</li>
<li>
<em>TEMP</em>::DetailmoreORLessLayout</li>
<li>
<em>test</em>::_Ltest</li>
<li>
<em>test</em>::ktestItemList</li>
<li>
<em>TEMP</em>::ktestItemList</li>
<li>
<em>TEMP</em>::mTag</li>
<li>
<em>ruleTagMenuTestGroups</em>::match</li>
<li>
<em>ruleTagMenuTestGroups</em>::order</li>
<li>
<em>ruleTagMenuTestGroups</em>::name</li>
<li>
<em>ruleTagMenuTestGroups</em>::_Lgroup</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>testlearn</em>::kcsection</li>
<li>
<em>testlearn</em>::filterFind</li>
<li>
<em>reference</em>::kcsection</li>
<li>
<em>reference</em>::filterFind</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>addMenuTestItem</li>
<li>setupTestItem</li>
<li>testMenuTestItem</li>
<li>testSetup</li>
<li>reportTagItem</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33117ScriptAnchor_"></a><td class="script_navbar"><a href="#33071ScriptAnchor_"><span>Previous Script: [menuTestItem]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33295ScriptAnchor_"><span>Next Script: [menuCitation]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">menuSample</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>#</li>
<li>#If user is in tag field and has changed spelling</li>
<li>#exit this tag record, otherwise current reference record</li>
<li>#will get deleted by the spelling check script.</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Clear sample and test tags.</li>
<li>If [ $$citationMatch = "test" ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $$citationItem; Value:testlearn::kNodePrimary ]</li>
<li>Set Variable [ $$tagSample ]</li>
<li>Set Variable [ $$tagtest ]</li>
<li>Set Variable [ $$tagRecordID ]</li>
<li>Set Variable [ $$tagEdit ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>End If</li>
<li>#</li>
<li>#Clear order numbers.</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>New Window [ Height: 1; Width: 1 ]</li>
<li>Go to Layout [ &ldquo;learnSCRIPTloops&rdquo; (testlearn) ]</li>
<li>Perform Find [ Specified Find Requests: Find Records; Criteria: testlearn::orderTest: &ldquo;###&rdquo; ]
[ Restore ]</li>
<li>Loop</li>
<li>Set Field [ testlearn::orderTest; "" ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Close Window [ Current Window ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>#</li>
<li>#Set citationMatch to color menu button with inUse color.</li>
<li>Set Variable [ $$citationMatch; Value:"sample" ]</li>
<li>#</li>
<li>#Set match temp tag field to limit move pulldown</li>
<li>#to just the groups for this section and item type.</li>
<li>#( if you're wondering why this temp field is a</li>
<li>#    a dupllicate of the citation match variable it</li>
<li>#    is because I didn't need it until a year into</li>
<li>#    writing this database.  At some point, it would</li>
<li>#    probably be good to get rid of the variable. )</li>
<li>Set Field [ TEMP::mTag; $$citationMatch ]</li>
<li>#</li>
<li>#Turn off the loadtagrecord script to speed up the </li>
<li>#loop portion of the script.</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>Set Variable [ $$stopLoadCitation; Value:1 ]</li>
<li>#</li>
<li>#Goto correct layout.</li>
<li>Go to Layout [ &ldquo;learnMenuSample&rdquo; (tagMenus) ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;learnMenuStuffSample&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>#</li>
<li>#Find sample tags for current library section.</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::match; $$citationMatch ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; "==" &amp; TEMP::ksection ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Sort according to current users wishes.  By default</li>
<li>#the sort will be by category which is set by editCitation script.</li>
<li>If [ TEMP::sortSample = "cat" or TEMP::sortSample = "" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ TEMP::sortSample = "abc" ]</li>
<li>Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#Go to citation record's current selection or to first record.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Variable [ $number; Value:1 ]</li>
<li>Go to Field [  ]</li>
<li>Loop</li>
<li>Exit Loop If [ Middle ( GetValue ( $$sample ; $number ) ; 4 ; 42 )  &amp; "&para;"   = tagMenus::_Ltag &amp; &para; ]</li>
<li>Exit Loop If [ Middle ( GetValue ( $$sample ; $number ) ; 4 ; 42 )  = "" ]</li>
<li>Set Variable [ $add; Value:$number ]</li>
<li>Set Variable [ $number; Value:$add + 1 ]</li>
<li>End Loop</li>
<li>Exit Loop If [ Middle ( GetValue ( $$sample ; $number ) ; 4 ; 42 )  &amp; "&para;"   = tagMenus::_Ltag &amp; &para; ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Turn loadtagrecord script back on.</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Perform Script [ &ldquo;insureEqualityOfSpellFields&rdquo; ]</li>
<li>#</li>
<li>#Turn loadtagrecord script back on and perform</li>
<li>#loadtag... script to highlight any Learn records</li>
<li>#tagged with the current tag record.</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Perform Script [ &ldquo;loadItemRecordForSampleTagMenu&rdquo; ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>//  If [ Middle ( GetValue ( $$sample ; $number ) ; 4 ; 42 )  &amp; "&para;" &ne; tagMenus::_Ltag &amp; &para; ]</li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  Select Window [ Name: "Learn"; Current file ]</li>
<li>//  #</li>
<li>//  #If sort by order number is on then sort by </li>
<li>//  #order number.</li>
<li>//  If [ TEMP::TLSampleSort = 1 ]</li>
<li>//  Set Field [ TEMP::TLSampleSort; "" ]</li>
<li>//  Perform Script [ &ldquo;sortTLRecordsByOrderNumber&rdquo; ]</li>
<li>//  Else If [ TEMP::TLSampleSort = "" ]</li>
<li>//  Set Field [ TEMP::TLSampleSort; 1 ]</li>
<li>//  Perform Script [ &ldquo;sortTLRecordsByOrderNumber&rdquo; ]</li>
<li>//  End If</li>
<li>//  Go to Field [  ]</li>
<li>//  Refresh Window</li>
<li>//  Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>//  Exit Script [  ]</li>
<li>//  End If</li>
<li>//  #</li>
<li>//  #Inform user of items use on both screens.</li>
<li>//  Set Variable [ $$citationItem; Value:tagMenus::_Ltag ]</li>
<li>//  Set Variable [ $$tagSample; Value:tagMenus::_Ltag ]</li>
<li>//  Set Variable [ $$sampleORTestID; Value:Get (RecordID) ]</li>
<li>//  Refresh Window</li>
<li>//  #</li>
<li>//  #Just in case user was in nonTag field on this</li>
<li>//  #window when user clicked a menu button on </li>
<li>//  #the other window, exit all  fields.</li>
<li>//  Set Variable [ $$stopLoadCitation ]</li>
<li>//  Select Window [ Name: "Learn"; Current file ]</li>
<li>//  #</li>
<li>//  #If sort by order number is on then sort by </li>
<li>//  #order number.</li>
<li>//  If [ TEMP::TLSampleSort = 1 ]</li>
<li>//  Set Field [ TEMP::TLSampleSort; "" ]</li>
<li>//  Perform Script [ &ldquo;sortTLRecordsByOrderNumber&rdquo; ]</li>
<li>//  Else If [ TEMP::TLSampleSort = "" ]</li>
<li>//  Set Field [ TEMP::TLSampleSort; 1 ]</li>
<li>//  Perform Script [ &ldquo;sortTLRecordsByOrderNumber&rdquo; ]</li>
<li>//  End If</li>
<li>//  Go to Field [  ]</li>
<li>//  Refresh Window</li>
<li>//  Select Window [ Name: "Tag Menus"; Current file ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearn</em>::kNodePrimary</li>
<li>
<em>testlearn</em>::orderTest</li>
<li>
<em>TEMP</em>::mTag</li>
<li>
<em>TEMP</em>::InventoryLibaryYN</li>
<li>
<em>tagMenus</em>::match</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>ruleTagMenuGroups</em>::ksection</li>
<li>
<em>TEMP</em>::sortSample</li>
<li>
<em>ruleTagMenuGroups</em>::order</li>
<li>
<em>ruleTagMenuGroups</em>::name</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>TEMP</em>::TLSampleSort</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33227ScriptAnchor_">insureEqualityOfSpellFields</a></li>
<li><a href="#33219ScriptAnchor_">loadItemRecordForSampleTagMenu</a></li>
<li><a href="#33129ScriptAnchor_">sortTLRecordsByOrderNumber</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>learnSCRIPTloops</li>
<li>learnMenuSample</li>
<li>learnMenuStuffSample</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33295ScriptAnchor_"></a><td class="script_navbar"><a href="#33117ScriptAnchor_"><span>Previous Script: [menuSample]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33064ScriptAnchor_"><span>Next Script: [menuReference]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">menuCitation</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32983ScriptAnchor_">TgotoCitationMenu</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If user is in tag field and has changed spelling</li>
<li>#exit this tag record, otherwise current reference record</li>
<li>#will get deleted by the spelling check script.</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Clear sample and test tags so there conditional</li>
<li>#formatting in the Learn window is removed.</li>
<li>If [ $$citationMatch = "sample" or $$citationMatch = "test" ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $$tagSample ]</li>
<li>Set Variable [ $$tagtest ]</li>
<li>Set Variable [ $$tagRecordID ]</li>
<li>Set Variable [ $$tagEdit ]</li>
<li>End If</li>
<li>#</li>
<li>#Set testlearn internal reference field conditional</li>
<li>#formatting to tan.  </li>
<li>Set Variable [ $$internal ]</li>
<li>Sort Records [ Specified Sort Order: testlearn::date; descending
testlearn::timestamp; descending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>#</li>
<li>#</li>
<li>#Set citationMatch to color menu button with inUse color.</li>
<li>Set Variable [ $$citationMatch; Value:"cite" ]</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>Freeze Window</li>
<li>#</li>
<li>#Goto correct layout.</li>
<li>If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>Go to Layout [ &ldquo;learnMenu3Cite&rdquo; (reference) ]</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "r" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenu3Cite&rdquo; (reference) ]</li>
<li>End If</li>
<li>#</li>
<li>#Find Citations for this library.  </li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>If [ Left (Get (LayoutName) ; 9 ) &ne;  "reference" ]</li>
<li>Set Field [ reference::kcsection; TEMP::ksection ]</li>
<li>Set Field [ reference::show; "show in learn" ]</li>
<li>Else</li>
<li>Set Field [ reference::kcsection; TEMP::ksection ]</li>
<li>End If</li>
<li>//  Set Field [ reference::filterFind; "main" &amp; &para; ]</li>
<li>//  Set Field [ reference::ktest; TEMP::ktest ]</li>
<li>Perform Find [  ]</li>
<li>//  Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: reference::knodePrimary: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>//  Extend Found Set [ Specified Find Requests: Find Records; Criteria: reference::referenceNodes: &ldquo;*&rdquo; AND reference::filterFind: &ldquo;"main"&rdquo; ]
[ Restore ]</li>
<li>//  Extend Found Set [ Specified Find Requests: Find Records; Criteria: reference::referenceNodes: &ldquo;*&rdquo; ]
[ Restore ]</li>
<li>//  Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: reference::Title: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>Sort Records [ Specified Sort Order: tagKeywordPrimary::tag; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#Sort according to current users wishes.  By default</li>
<li>#the sort will be by category which is set by editCitation script.</li>
<li>//  If [ TEMP::sortCite = "cat" ]</li>
<li>//  Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>//  Else If [ TEMP::sortCite = "abc" ]</li>
<li>//  Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>//  End If</li>
<li>Sort Records [ Specified Sort Order: tagKeywordPrimary::orderOrLock; ascending
tagKeywordPrimary::tag; ascending
reference::referenceShort; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#Go to citation record's current selection or to first record.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$cite =  reference::_Lreference ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>If [ $$cite &ne;  reference::_Lreference ]</li>
<li>#</li>
<li>#Decided below was too much help.  User can look</li>
<li>#on main screen to see where cite or reference is located.</li>
<li>//  #Clear reference location variable that conditionally</li>
<li>//  #formatts buttons to tell user where reference is located.</li>
<li>//  Set Variable [ $$refIsRefRecord ]</li>
<li>#</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Go to Field [  ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Decided below was too much help.  User can look</li>
<li>#on main screen to see where cite or reference is located.</li>
<li>//  #Turn on reference location variable that conditionally</li>
<li>//  #formatts buttons to tell user where reference is located.</li>
<li>//  Set Variable [ $$refIsRefRecord; Value:1 ]</li>
<li>#</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>#</li>
<li>#Inform user of items use on both screens.</li>
<li>Set Variable [ $$citationItem; Value:reference::_Lreference ]</li>
<li>Refresh Window</li>
<li>#Just in case user was in nonTag field on this</li>
<li>#window when user clicked a menu button on </li>
<li>#the other window, exit all  fields.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Go to Field [  ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearn</em>::date</li>
<li>
<em>testlearn</em>::timestamp</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>reference</em>::kcsection</li>
<li>
<em>reference</em>::show</li>
<li>
<em>reference</em>::filterFind</li>
<li>
<em>TEMP</em>::ktest</li>
<li>
<em>reference</em>::ktest</li>
<li>
<em>reference</em>::referenceNodes</li>
<li>
<em>tagKeywordPrimary</em>::tag</li>
<li>
<em>TEMP</em>::sortCite</li>
<li>
<em>ruleTagMenuGroups</em>::order</li>
<li>
<em>ruleTagMenuGroups</em>::name</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>tagKeywordPrimary</em>::orderOrLock</li>
<li>
<em>reference</em>::referenceShort</li>
<li>
<em>reference</em>::_Lreference</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>learnMenu3Cite</li>
<li>ReferenceMenu3Cite</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33064ScriptAnchor_"></a><td class="script_navbar"><a href="#33295ScriptAnchor_"><span>Previous Script: [menuCitation]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33004ScriptAnchor_"><span>Next Script: [menuCopyist]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">menuReference</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33085ScriptAnchor_">externalReferences</a></li>
<li><a href="#32985ScriptAnchor_">backToLearnOrDefaultSetup</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Use this bit of code to make the default reference
</li>
<li>#point to the internal (Learn) records instead of</li>
<li>#the external references.  Other scripts with code</li>
<li>#that needs to be turned on: externalReferences, </li>
<li>//  #If library is for inventory then go to container menu.</li>
<li>//  If [ TEMP::InventoryLibaryYN &ne; "" and Get ( LayoutName ) &ne; "learnMenu4STUFFRefCite" ]</li>
<li>//  Set Variable [ $$citationMatch; Value:"ref" ]</li>
<li>//  Perform Script [ &ldquo;externalReferences&rdquo; ]</li>
<li>//  Exit Script [  ]</li>
<li>//  End If</li>
<li>#</li>
<li>#Clear sample and test tags so there conditional</li>
<li>#formatting in the Learn window is removed.</li>
<li>If [ $$citationMatch = "sample" or $$citationMatch = "test" ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $$tagSample ]</li>
<li>Set Variable [ $$tagtest ]</li>
<li>Set Variable [ $$tagRecordID ]</li>
<li>Set Variable [ $$tagEdit ]</li>
<li>End If</li>
<li>Sort Records [ Specified Sort Order: testlearn::date; descending
testlearn::timestamp; descending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>#</li>
<li>#Set citationMatch to color menu button with inUse color.</li>
<li>Set Variable [ $$citationMatch; Value:"ref" ]</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>#</li>
<li>#Set testlearn internal reference  field conditional</li>
<li>#formatting to transparent.  </li>
<li>Set Variable [ $$internal ]</li>
<li>#</li>
<li>#Goto correct layout.</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;learnMenuRefStuff&rdquo; (reference) ]</li>
<li>Else</li>
<li>If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>Go to Layout [ &ldquo;learnMenu3Cite&rdquo; (reference) ]</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "r" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenu3Cite&rdquo; (reference) ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Find References for this section.  </li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::kcsection; TEMP::ksection ]</li>
<li>Set Field [ reference::filterFind; "main" ]</li>
<li>Set Field [ reference::show; "show in learn" ]</li>
<li>//  Set Field [ reference::ktest; TEMP::ktest ]</li>
<li>Perform Find [  ]</li>
<li>//  Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: reference::knodePrimary: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>//  Extend Found Set [ Specified Find Requests: Find Records; Criteria: reference::referenceNodes: &ldquo;*&rdquo; ]
[ Restore ]</li>
<li>//  Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: reference::Title: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>#</li>
<li>#Sort according to current users wishes.  By default</li>
<li>#the sort will be by category which is set by editCitation script.</li>
<li>Sort Records [ Specified Sort Order: tagKeywordPrimary::orderOrLock; ascending
tagKeywordPrimary::tag; ascending
reference::referenceShort; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#Go to citation record's current selection or to first record.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ FilterValues ( $$ref ; reference::_Lreference )  =   reference::_Lreference &amp; &para; ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>If [ FilterValues ( $$ref ; reference::_Lreference )  &ne;  reference::_Lreference &amp; &para; ]</li>
<li>#</li>
<li>#Decided below was too much help.  User can look</li>
<li>#on main screen to see where cite or reference is located.</li>
<li>//  #Clear reference location variable that conditionally</li>
<li>//  #formatts buttons to tell user where reference is located.</li>
<li>//  Set Variable [ $$refIsRefRecord ]</li>
<li>#</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Go to Field [  ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Set Variable [ $stopref ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Decided below was too much help.  User can look</li>
<li>#on main screen to see where cite or reference is located.</li>
<li>//  #Turn on reference location variable that conditionally</li>
<li>//  #formatts buttons to tell user where reference is located.</li>
<li>//  Set Variable [ $$refIsRefRecord; Value:1 ]</li>
<li>#</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>#</li>
<li>#Inform user of items use on both screens.</li>
<li>Set Variable [ $$citationItem; Value:reference::_Lreference ]</li>
<li>Refresh Window</li>
<li>#Just in case user was in nonTag field on this</li>
<li>#window when user clicked a menu button on </li>
<li>#the other window, exit all  fields.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Go to Field [  ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::InventoryLibaryYN</li>
<li>
<em>testlearn</em>::date</li>
<li>
<em>testlearn</em>::timestamp</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>reference</em>::kcsection</li>
<li>
<em>reference</em>::filterFind</li>
<li>
<em>reference</em>::show</li>
<li>
<em>TEMP</em>::ktest</li>
<li>
<em>reference</em>::ktest</li>
<li>
<em>reference</em>::referenceNodes</li>
<li>
<em>tagKeywordPrimary</em>::orderOrLock</li>
<li>
<em>tagKeywordPrimary</em>::tag</li>
<li>
<em>reference</em>::referenceShort</li>
<li>
<em>reference</em>::_Lreference</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33085ScriptAnchor_">externalReferences</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>learnMenuRefStuff</li>
<li>learnMenu3Cite</li>
<li>ReferenceMenu3Cite</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33004ScriptAnchor_"></a><td class="script_navbar"><a href="#33064ScriptAnchor_"><span>Previous Script: [menuReference]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#32991ScriptAnchor_"><span>Next Script: [menuPath]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">menuCopyist</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32983ScriptAnchor_">TgotoCitationMenu</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If user is in tag field and has changed spelling</li>
<li>#exit this tag record, otherwise current reference record</li>
<li>#will get deleted by the spelling check script.</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Set citationMatch to color menu button with inUse color.</li>
<li>Set Variable [ $$citationMatch; Value:"copyist" ]</li>
<li>#</li>
<li>#Set match temp tag field to limit move pulldown</li>
<li>#to just the groups for this section and item type.</li>
<li>#( if you're wondering why this temp field is a</li>
<li>#    a dupllicate of the citation match variable it</li>
<li>#    is because I didn't need it until a year into</li>
<li>#    writing this database.  At some point, it would</li>
<li>#    probably be good to get rid of the variable. )</li>
<li>Set Field [ TEMP::mTag; $$citationMatch ]</li>
<li>#</li>
<li>#Goto correct layout.</li>
<li>#If in add mode ...</li>
<li>If [ $$add = 1 ]</li>
<li>Go to Layout [ &ldquo;addMenu1&rdquo; (tagMenus) ]</li>
<li>#</li>
<li>#If not in add mode ...</li>
<li>Else If [ $$add &ne; 1 ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenu1&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>#</li>
<li>#Find copyist tags.  Copyist tags are available to all library sections.</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::match; $$citationMatch ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>//  #If no records exist then create one.</li>
<li>//  If [ Get (FoundCount)=0 ]</li>
<li>//  Perform Script [ &ldquo;newCitationMenuGroup&rdquo; ]</li>
<li>//  End If</li>
<li>#</li>
<li>#Sort according to current users wishes.  By default</li>
<li>#the sort will be by category which is set by editCitation script.</li>
<li>If [ TEMP::sortCopyist = "cat" or TEMP::sortCopyist = "" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ TEMP::sortCopyist = "abc" ]</li>
<li>Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#Go to citation record's current selection or to first record.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$copyist =  tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>If [ $$copyist &ne;  tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>//  Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Inform user of items use on both screens.</li>
<li>Set Variable [ $$citationItem; Value:tagMenus::_Ltag ]</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>#</li>
<li>#If in add mode, find only records tagged with</li>
<li>#current $$citationmatch on reference layout.</li>
<li>#The learn record is never changed.</li>
<li>If [ Left (Get (LayoutName) ; 1) = "r" ]</li>
<li>If [ $$add = 1 ]</li>
<li>#</li>
<li>#But, give user option to keep the records currently</li>
<li>#showing in the main window.</li>
<li>Show Custom Dialog [ Message: "In the main window, show only records with pictures and links added to copyist tags, or keep the current records shown?"; Buttons: &ldquo;keep&rdquo;, &ldquo;show&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#find on reference layout ...</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::kcsection; TEMP::ksection ]</li>
<li>Set Field [ reference::filterFind; "copyist" ]</li>
<li>Perform Find [  ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Just in case user was in nonTag field on this</li>
<li>#window when user clicked a menu button on </li>
<li>#the other window, exit all  fields.</li>
<li>Go to Field [  ]</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::mTag</li>
<li>
<em>tagMenus</em>::match</li>
<li>
<em>TEMP</em>::sortCopyist</li>
<li>
<em>ruleTagMenuGroups</em>::order</li>
<li>
<em>ruleTagMenuGroups</em>::name</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>reference</em>::kcsection</li>
<li>
<em>reference</em>::filterFind</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32980ScriptAnchor_">newCitationMenuGroup</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>addMenu1</li>
<li>ReferenceMenu1</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32991ScriptAnchor_"></a><td class="script_navbar"><a href="#33004ScriptAnchor_"><span>Previous Script: [menuCopyist]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33012ScriptAnchor_"><span>Next Script: [menuOrgan]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">menuPath</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32983ScriptAnchor_">TgotoCitationMenu</a></li>
<li><a href="#33028ScriptAnchor_">addFileLink4ToTag</a></li>
<li><a href="#33029ScriptAnchor_">addFileLink5ToTag</a></li>
<li><a href="#33030ScriptAnchor_">addFileLink6ToTag</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If user is in tag field and has changed spelling</li>
<li>#exit this tag record, otherwise current reference record</li>
<li>#will get deleted by the spelling check script.</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Clear sample and test tags so there conditional</li>
<li>#formatting in the Learn window is removed.</li>
<li>If [ $$citationMatch = "sample" or $$citationMatch = "test" ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $$tagSample ]</li>
<li>Set Variable [ $$tagtest ]</li>
<li>Set Variable [ $$tagRecordID ]</li>
<li>Set Variable [ $$tagEdit ]</li>
<li>End If</li>
<li>Sort Records [ Specified Sort Order: testlearn::date; descending
testlearn::timestamp; descending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>#</li>
<li>#Set citationMatch to color menu button with inUse color.</li>
<li>Set Variable [ $$citationMatch; Value:"path" ]</li>
<li>#</li>
<li>#Set match temp tag field to limit move pulldown</li>
<li>#to just the groups for this section and item type.</li>
<li>#( if you're wondering why this temp field is a</li>
<li>#    a dupllicate of the citation match variable it</li>
<li>#    is because I didn't need it until a year into</li>
<li>#    writing this database.  At some point, it would</li>
<li>#    probably be good to get rid of the variable. )</li>
<li>Set Field [ TEMP::mTag; $$citationMatch ]</li>
<li>#</li>
<li>#Turn off the loadtagrecord script to speed up the </li>
<li>#loop portion of the script.</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>#</li>
<li>#Goto correct layout.</li>
<li>#If in add mode ...</li>
<li>If [ $$add = 1 ]</li>
<li>Go to Layout [ &ldquo;addMenu1&rdquo; (tagMenus) ]</li>
<li>#</li>
<li>#If in learn mode ...</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>Go to Layout [ &ldquo;learnMenu1&rdquo; (tagMenus) ]</li>
<li>#</li>
<li>#If in reference mode ...</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "r" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenu1&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>#</li>
<li>#Find Path tags.  Path tags are available to all library sections.</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::match; "Path" ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#If no records exist then create one.</li>
<li>If [ Get (FoundCount)=0 ]</li>
<li>Perform Script [ &ldquo;newCitationMenuGroup&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>#Sort according to current users wishes.  By default</li>
<li>#the sort will be by category which is set by editCitation script.</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>#</li>
<li>#Sort according to current users wishes.  By default</li>
<li>#the sort will be by category which is set by editCitation script.</li>
<li>If [ TEMP::sortPath = "cat" or TEMP::sortPath = "" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ TEMP::sortPath = "abc" ]</li>
<li>Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#Go to citation record's current selection or to first record.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$Path =  tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Turn loadtagrecord script back on.</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>#</li>
<li>If [ $$Path &ne;  tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>//  Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Inform user of items use on both screens.</li>
<li>Set Variable [ $$citationItem; Value:tagMenus::_Ltag ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#Just in case user was in nonTag field on this</li>
<li>#window when user clicked a menu button on </li>
<li>#the other window, exit all  fields.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Go to Field [  ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>#</li>
<li>#If in add mode, find only records tagged with</li>
<li>#current $$citationmatch.</li>
<li>If [ $$add = 1 ]</li>
<li>#</li>
<li>#But, give user option to keep the records currently</li>
<li>#showing in the main window.</li>
<li>Show Custom Dialog [ Message: "In the main window, show only records with pictures and links added to file path tags, or keep the current records shown?"; Buttons: &ldquo;keep&rdquo;, &ldquo;show&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#find on reference layout ...</li>
<li>If [ Left (Get (LayoutName) ; 1) = "r" ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::kcsection; TEMP::ksection ]</li>
<li>Set Field [ reference::filterFind; "path" ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#find on learn layout ...</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection ]</li>
<li>Set Field [ testlearn::filterFind; "path" ]</li>
<li>Perform Find [  ]</li>
<li>End If</li>
<li>End If</li>
<li>End If</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearn</em>::date</li>
<li>
<em>testlearn</em>::timestamp</li>
<li>
<em>TEMP</em>::mTag</li>
<li>
<em>tagMenus</em>::match</li>
<li>
<em>TEMP</em>::sortPath</li>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>reference</em>::kcsection</li>
<li>
<em>reference</em>::filterFind</li>
<li>
<em>testlearn</em>::kcsection</li>
<li>
<em>testlearn</em>::filterFind</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32980ScriptAnchor_">newCitationMenuGroup</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>addMenu1</li>
<li>learnMenu1</li>
<li>ReferenceMenu1</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33012ScriptAnchor_"></a><td class="script_navbar"><a href="#32991ScriptAnchor_"><span>Previous Script: [menuPath]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#32980ScriptAnchor_"><span>Next Script: [newCitationMenuGroup]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">menuOrgan</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32983ScriptAnchor_">TgotoCitationMenu</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If user is in tag field and has changed spelling</li>
<li>#exit this tag record, otherwise current reference record</li>
<li>#will get deleted by the spelling check script.</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Set citationMatch to color menu button with inUse color.</li>
<li>Set Variable [ $$citationMatch; Value:"organ" ]</li>
<li>#</li>
<li>#Set match temp tag field to limit move pulldown</li>
<li>#to just the groups for this section and item type.</li>
<li>#( if you're wondering why this temp field is a</li>
<li>#    a dupllicate of the citation match variable it</li>
<li>#    is because I didn't need it until a year into</li>
<li>#    writing this database.  At some point, it would</li>
<li>#    probably be good to get rid of the variable. )</li>
<li>Set Field [ TEMP::mTag; $$citationMatch ]</li>
<li>#</li>
<li>#Goto correct layout.</li>
<li>#If in add mode ...</li>
<li>If [ $$add = 1 ]</li>
<li>Go to Layout [ &ldquo;addMenu1&rdquo; (tagMenus) ]</li>
<li>#</li>
<li>#If in learn mode ...</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "o" ]</li>
<li>Go to Layout [ &ldquo;learnMenu1&rdquo; (tagMenus) ]</li>
<li>#</li>
<li>#If in reference mode ...</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "r" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenu1&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>#</li>
<li>#Find Organ tags.  Organ tags are available to all library sections.</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::match; "organ" ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#If no records exist then create one.</li>
<li>If [ Get (FoundCount)=0 ]</li>
<li>Perform Script [ &ldquo;newCitationMenuGroup&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>#Sort according to current users wishes.  By default</li>
<li>#the sort will be by category which is set by editCitation script.</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>#</li>
<li>#Sort according to current users wishes.  By default</li>
<li>#the sort will be by category which is set by editCitation script.</li>
<li>If [ TEMP::sortOrgan = "cat" or TEMP::sortOrgan = "" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ TEMP::sortOrgan = "abc" ]</li>
<li>Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#Go to citation record's current selection or to first record.</li>
<li>#Because user may click anywhere to go to a record</li>
<li>#all keys for all menu items must uploaded</li>
<li>#until one is found that matches and then the</li>
<li>#$$citationItem variable can be set.</li>
<li>#Like when the user clicks in a non field area</li>
<li>#a space between fields that then tells filemaker</li>
<li>#to go that record but not to field belonging to</li>
<li>#that record.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$Organ =  tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>If [ $$Organ &ne;  tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>//  Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Inform user of items use on both screens.</li>
<li>Set Variable [ $$citationItem; Value:tagMenus::_Ltag ]</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>#Just in case user was in nonTag field on this</li>
<li>#window when user clicked a menu button on </li>
<li>#the other window, exit all  fields.</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#If in add mode, find only records tagged with</li>
<li>#current $$citationmatch on reference layout.</li>
<li>#The learn record is never changed.</li>
<li>If [ Left (Get (LayoutName) ; 1) = "r" ]</li>
<li>If [ $$add = 1 ]</li>
<li>#</li>
<li>#But, give user option to keep the records currently</li>
<li>#showing in the main window.</li>
<li>Show Custom Dialog [ Message: "In the main window, show only records with pictures and links added to organ tags, or keep the current records shown?"; Buttons: &ldquo;keep&rdquo;, &ldquo;show&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#find on reference layout ...</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::kcsection; TEMP::ksection ]</li>
<li>Set Field [ reference::filterFind; "organ" ]</li>
<li>Perform Find [  ]</li>
<li>End If</li>
<li>End If</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::mTag</li>
<li>
<em>tagMenus</em>::match</li>
<li>
<em>TEMP</em>::sortOrgan</li>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>reference</em>::kcsection</li>
<li>
<em>reference</em>::filterFind</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32980ScriptAnchor_">newCitationMenuGroup</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>addMenu1</li>
<li>learnMenu1</li>
<li>ReferenceMenu1</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32980ScriptAnchor_"></a><td class="script_navbar"><a href="#33012ScriptAnchor_"><span>Previous Script: [menuOrgan]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#32979ScriptAnchor_"><span>Next Script: [newCitationMenuItem]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">newCitationMenuGroup</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33236ScriptAnchor_">createEmptyLibrary</a></li>
<li><a href="#33131ScriptAnchor_">openDetailWindow !!! FINISH LATER !!!</a></li>
<li><a href="#32988ScriptAnchor_">menuNode</a></li>
<li><a href="#32993ScriptAnchor_">menuKey</a></li>
<li><a href="#33013ScriptAnchor_">menuHealth</a></li>
<li><a href="#32989ScriptAnchor_">menuMedium</a></li>
<li><a href="#33004ScriptAnchor_">menuCopyist</a></li>
<li><a href="#32991ScriptAnchor_">menuPath</a></li>
<li><a href="#33012ScriptAnchor_">menuOrgan</a></li>
<li><a href="#32979ScriptAnchor_">newCitationMenuItem</a></li>
<li><a href="#33247ScriptAnchor_">duplicateTheory</a></li>
<li><a href="#33107ScriptAnchor_">menuTestFind</a></li>
<li><a href="#33081ScriptAnchor_">returnToAddRecordPUTONHOLD!!!!</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#If node is currenlty locked then stop script, inform user.</li>
<li>If [ TEMP::nodeLock &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "The default node selected is locked.  Select this node in the setup window and enter the password to unlock it, then you will able to create new records assigned to this node."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>If [ tempSetup::kdefaultNodePrimary = "" and $$stopAddBack &ne; 1 ]</li>
<li>Show Custom Dialog [ Message: "Select yourself (the node responsible) from Tag Menus window OR create a node record for yourself?"; Buttons: &ldquo;select&rdquo;, &ldquo;create&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Halt Script</li>
<li>Else</li>
<li>Set Field [ tempSetup::kdefaultNodePrimary; "self" ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>If [ tempSetup::ksection = "" ]</li>
<li>Show Custom Dialog [ Message: "First select a section for this category to be created under, then you may create a new category."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Go to Layout [ &ldquo;tableGroupTag&rdquo; (groupTest) ]</li>
<li>#</li>
<li>New Record/Request</li>
<li>Set Field [ groupTest::ksection; TEMP::ksection ]</li>
<li>Set Field [ groupTest::kRecordCreatorNode; TEMP::kdefaultNodePrimary ]</li>
<li>#</li>
<li>If [ $$citationMatch = "otherkey"  or 
$$citationMatch = "primarykey" ]</li>
<li>Set Field [ groupTest::match; "key" ]</li>
<li>Else If [ $$citationMatch &ne; "otherkey" ]</li>
<li>Set Field [ groupTest::match; $$citationMatch ]</li>
<li>End If</li>
<li>#</li>
<li>Set Field [ groupTest::name; "group" &amp; groupTest::_Lgroup ]</li>
<li>Set Field [ groupTest::nameSpelling; "group" &amp; groupTest::_Lgroup ]</li>
<li>Set Variable [ $group; Value:groupTest::_Lgroup ]</li>
<li>#</li>
<li>If [ $$citationMatch = "sample" ]</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>End If</li>
<li>#</li>
<li>Go to Layout [ original layout ]</li>
<li>New Record/Request</li>
<li>Set Field [ tagMenus::kGroupOrTest; $group ]</li>
<li>#</li>
<li>#Only test focus tags require section.  All other tags</li>
<li>#are linked to groups and then the groups are linked</li>
<li>#to sections.  </li>
<li>If [ $$citationMatch = "location" ]</li>
<li>Set Field [ tagMenus::ksection; TEMP::ksection ]</li>
<li>End If</li>
<li>//  Set Field [ tagMenus::ksection; TEMP::ksection ]</li>
<li>If [ tempSetup::kdefaultNodePrimary = "self" ]</li>
<li>Set Field [ tagMenus::tag; "MyLastName, MyFirstName" ]</li>
<li>Set Field [ TEMP::kdefaultNodePrimary; tagMenus::_Ltag ]</li>
<li>Set Field [ ruleTagMenuGroups::kRecordCreatorNode; tagMenus::_Ltag ]</li>
<li>Else</li>
<li>Set Field [ tagMenus::kRecordCreatorNode; TEMP::kdefaultNodePrimary ]</li>
<li>End If</li>
<li>If [ $$citationMatch = "key" ]</li>
<li>Set Field [ tagMenus::match; "key" ]</li>
<li>Set Field [ tagMenus::tag; "keyword " &amp; tagMenus::_Ltag ]</li>
<li>Else If [ $$citationMatch = "node" ]</li>
<li>Set Field [ tagMenus::match; "node" ]</li>
<li>Else If [ $$citationMatch &ne; "key" or 
$$citationMatch &ne; "node" ]</li>
<li>Set Field [ tagMenus::match; $$citationMatch ]</li>
<li>End If</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>If [ $$citationMatch = "sample" ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Perform Script [ &ldquo;loadItemRecordForSampleTagMenu&rdquo; ]</li>
<li>End If</li>
<li>Go to Field [ tagMenus::tag ]
[ Select/perform ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::nodeLock</li>
<li>
<em>tempSetup</em>::kdefaultNodePrimary</li>
<li>
<em>tempSetup</em>::ksection</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>groupTest</em>::ksection</li>
<li>
<em>TEMP</em>::kdefaultNodePrimary</li>
<li>
<em>groupTest</em>::kRecordCreatorNode</li>
<li>
<em>groupTest</em>::match</li>
<li>
<em>groupTest</em>::_Lgroup</li>
<li>
<em>groupTest</em>::name</li>
<li>
<em>groupTest</em>::nameSpelling</li>
<li>
<em>tagMenus</em>::kGroupOrTest</li>
<li>
<em>tagMenus</em>::ksection</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>ruleTagMenuGroups</em>::kRecordCreatorNode</li>
<li>
<em>tagMenus</em>::kRecordCreatorNode</li>
<li>
<em>tagMenus</em>::match</li>
<li>
<em>ruleTagMenuGroups</em>::name</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33219ScriptAnchor_">loadItemRecordForSampleTagMenu</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>tableGroupTag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32979ScriptAnchor_"></a><td class="script_navbar"><a href="#32980ScriptAnchor_"><span>Previous Script: [newCitationMenuGroup]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33042ScriptAnchor_"><span>Next Script: [menuRefAddKeyWords]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">newCitationMenuItem</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#If node is currenlty locked then stop script, inform user.</li>
<li>If [ TEMP::nodeLock &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "The default node selected is locked.  Select this node in the setup window and enter the password to unlock it, then you will able to create new records assigned to this node."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>If [ tempSetup::kdefaultNodePrimary = "" ]</li>
<li>Show Custom Dialog [ Message: "Select yourself (the node responsible) from Tag Menus window OR create a node record for yourself?"; Buttons: &ldquo;select&rdquo;, &ldquo;create&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Halt Script</li>
<li>Else</li>
<li>Set Field [ tempSetup::kdefaultNodePrimary; "self" ]</li>
<li>End If</li>
<li>End If</li>
<li>If [ Get (FoundCount)  = 0 ]</li>
<li>Perform Script [ &ldquo;newCitationMenuGroup&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Stop spelling check script.</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>New Record/Request</li>
<li>Set Field [ tagMenus::kGroupOrTest; GetNthRecord ( tagMenus::kGroupOrTest ; Get (RecordNumber) - 1 ) ]</li>
<li>If [ tempSetup::kdefaultNodePrimary = "self" ]</li>
<li>Set Field [ TEMP::kdefaultNodePrimary; tagMenus::_Ltag ]</li>
<li>Set Field [ tagMenus::tag; "MyLastName, MyFirstName" ]</li>
<li>Else</li>
<li>Set Field [ tagMenus::kRecordCreatorNode; TEMP::kdefaultNodePrimary ]</li>
<li>End If</li>
<li>#</li>
<li>#Only test focus tags require section.  All other tags</li>
<li>#are linked to groups and then the groups are linked</li>
<li>#to sections.  </li>
<li>If [ $$citationMatch = "location" ]</li>
<li>Set Field [ tagMenus::ksection; TEMP::ksection ]</li>
<li>End If</li>
<li>//  Set Field [ tagMenus::ksection; TEMP::ksection ]</li>
<li>If [ $$citationMatch = "key" ]</li>
<li>Set Field [ tagMenus::match; "key" ]</li>
<li>Set Field [ tagMenus::tag; "keyword " &amp; tagMenus::_Ltag ]</li>
<li>Go to Field [ tagMenus::tag ]
[ Select/perform ]</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ $$citationMatch = "node" ]</li>
<li>Set Field [ tagMenus::match; "node" ]</li>
<li>Else If [ $$citationMatch &ne; "key" or 
$$citationMatch &ne; "node" ]</li>
<li>Set Field [ tagMenus::match; $$citationMatch ]</li>
<li>End If</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>Go to Object [ Object Name: "tag" ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::nodeLock</li>
<li>
<em>tempSetup</em>::kdefaultNodePrimary</li>
<li>
<em>tagMenus</em>::kGroupOrTest</li>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>TEMP</em>::kdefaultNodePrimary</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>tagMenus</em>::kRecordCreatorNode</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>tagMenus</em>::ksection</li>
<li>
<em>tagMenus</em>::match</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32980ScriptAnchor_">newCitationMenuGroup</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33042ScriptAnchor_"></a><td class="script_navbar"><a href="#32979ScriptAnchor_"><span>Previous Script: [newCitationMenuItem]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33137ScriptAnchor_"><span>Next Script: [gotoMainFromTestTagMenus]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">menuRefAddKeyWords</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32983ScriptAnchor_">TgotoCitationMenu</a></li>
<li><a href="#33085ScriptAnchor_">externalReferences</a></li>
<li><a href="#33280ScriptAnchor_">loadCitation OLD</a></li>
<li><a href="#32985ScriptAnchor_">backToLearnOrDefaultSetup</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Ask user if OK to replace keywords.</li>
<li>Show Custom Dialog [ Message: "Add reference's keywords to current Learn record -- " &amp; 

//KEYWORDS
tagKeywordPrimary::tag &amp; ", "  &amp; 
reference::OtherKeyWords  &amp; 

" -- ?  (This will replace all keywords for this record, if there are any.)"; Buttons: &ldquo;no&rdquo;, &ldquo;yes&rdquo; ]</li>
<li>#</li>
<li>#Copy tag's keywords and go to Learn window and</li>
<li>#replace current record's keywords with them. </li>
<li>If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Set Variable [ $citekeywordOther; Value:reference::kkeywordOther ]</li>
<li>Set Variable [ $citekeywordOtherWords; Value:reference::OtherKeyWords ]</li>
<li>Set Variable [ $citekeywordPrimary; Value:reference::kkeywordPrimary ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Set Field [ testlearn::kKeywordPrimary; $citekeywordPrimary ]</li>
<li>Set Field [ testlearn::kcKeywordOther; $citekeywordOther ]</li>
<li>Set Field [ testlearn::OtherKeyWords; $citekeywordOtherWords ]</li>
<li>End If</li>
<li>#</li>
<li>#Return to Tag Menus window.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagKeywordPrimary</em>::tag</li>
<li>
<em>reference</em>::OtherKeyWords</li>
<li>
<em>reference</em>::kkeywordOther</li>
<li>
<em>reference</em>::kkeywordPrimary</li>
<li>
<em>testlearn</em>::kKeywordPrimary</li>
<li>
<em>testlearn</em>::kcKeywordOther</li>
<li>
<em>testlearn</em>::OtherKeyWords</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33137ScriptAnchor_"></a><td class="script_navbar"><a href="#33042ScriptAnchor_"><span>Previous Script: [menuRefAddKeyWords]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33127ScriptAnchor_"><span>Next Script: [loadItemRecordForTestTagMenu]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">gotoMainFromTestTagMenus</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Go to Field [  ]</li>
<li>Select Window [ Name: "Test"; Current file ]</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>Select Window [ Name: "Report"; Current file ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33127ScriptAnchor_"></a><td class="script_navbar"><a href="#33137ScriptAnchor_"><span>Previous Script: [gotoMainFromTestTagMenus]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33132ScriptAnchor_"><span>Next Script: [addTagToTestSubject]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">loadItemRecordForTestTagMenu</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33068ScriptAnchor_">menuTest</a></li>
<li><a href="#32987ScriptAnchor_">addTagToMainRecord</a></li>
<li><a href="#32984ScriptAnchor_">loadCitation</a></li>
<li><a href="#33280ScriptAnchor_">loadCitation OLD</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Capture recordID to conditionally format current record.</li>
<li>If [ $$stopLoadTagRecord &ne; 1 ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#The 'test' variable may have more than one</li>
<li>#key in it.  So we need a variable with just this</li>
<li>#records keys in it to conditionally format all </li>
<li>#learn window records tagged with it.</li>
<li>Set Variable [ $$tagtest; Value:test::_Ltest ]</li>
<li>Set Field [ TEMP::kctest; test::_Ltest ]</li>
<li>Set Variable [ $$SampleOrTestID; Value:Get (RecordID) ]</li>
<li>#</li>
<li>Set Variable [ $$stopLoadCitation; Value:1 ]</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>New Window [  ]</li>
<li>Move/Resize Window [ Current Window; Height: 3; Width: 3; Top: -1000; Left: -1000 ]</li>
<li>Go to Layout [ &ldquo;learn1&rdquo; (testlearn) ]</li>
<li>#Prepare system to stop error message about no</li>
<li>#records being found as the user may not have</li>
<li>#yet tagged any learn records with this test tag.</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection ]</li>
<li>Set Field [ testlearn::filterFind; "main" ]</li>
<li>Perform Find [  ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: testlearn::kctest: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Variable [ $number; Value:1 ]</li>
<li>Loop</li>
<li>Exit Loop If [ (FilterValues ( Middle ( GetValue ( testlearn::kctest ; 1 ) ; 4 ; 42 ) ; $$tagtest &amp; "&para;"  )  = $$tagtest  &amp; &para; 
or 
FilterValues ( Middle ( GetValue ( testlearn::kctest ; 2 ) ; 4 ; 42 ) ; $$tagtest &amp; "&para;"  )  = $$tagtest &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kctest ; 3 ) ; 4 ; 42 ) ; $$tagtest &amp; "&para;"  )  = $$tagtest &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kctest ; 4 ) ; 4 ; 42 ) ; $$tagtest &amp; "&para;"  )  = $$tagtest &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kctest ; 5 ) ; 4 ; 42 ) ; $$tagtest &amp; "&para;"  )  = $$tagtest &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kctest ; 6 ) ; 4 ; 42 ) ; $$tagtest &amp; "&para;"  )  = $$tagtest &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kctest ; 7 ) ; 4 ; 42 ) ; $$tagtest &amp; "&para;"  )  = $$tagtest &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kctest ; 8 ) ; 4 ; 42 ) ; $$tagtest &amp; "&para;"  )  = $$tagtest &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kctest ; 9 ) ; 4 ; 42 ) ; $$tagtest &amp; "&para;"  )  = $$tagtest &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kctest ; 10 ) ; 4 ; 42 ) ; $$tagtest &amp; "&para;"  )  = $$tagtest &amp; &para;

) = 1 ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Set Variable [ $atLeastOneRecord; Value:If ( (FilterValues ( Middle ( GetValue ( testlearn::kctest ; 1 ) ; 4 ; 42 ) ; $$tagtest &amp; "&para;"  )  = $$tagtest  &amp; &para; 
or 
FilterValues ( Middle ( GetValue ( testlearn::kctest ; 2 ) ; 4 ; 42 ) ; $$tagtest &amp; "&para;"  )  = $$tagtest &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kctest ; 3 ) ; 4 ; 42 ) ; $$tagtest &amp; "&para;"  )  = $$tagtest &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kctest ; 4 ) ; 4 ; 42 ) ; $$tagtest &amp; "&para;"  )  = $$tagtest &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kctest ; 5 ) ; 4 ; 42 ) ; $$tagtest &amp; "&para;"  )  = $$tagtest &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kctest ; 6 ) ; 4 ; 42 ) ; $$tagtest &amp; "&para;"  )  = $$tagtest &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kctest ; 7 ) ; 4 ; 42 ) ; $$tagtest &amp; "&para;"  )  = $$tagtest &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kctest ; 8 ) ; 4 ; 42 ) ; $$tagtest &amp; "&para;"  )  = $$tagtest &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kctest ; 9 ) ; 4 ; 42 ) ; $$tagtest &amp; "&para;"  )  = $$tagtest &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kctest ; 10 ) ; 4 ; 42 ) ; $$tagtest &amp; "&para;"  )  = $$tagtest &amp; &para;

) = 1 ; 1 ; "" ) ]</li>
<li>Go to Layout [ original layout ]</li>
<li>Close Window [ Current Window ]</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>#</li>
<li>#This won't work without going through every</li>
<li>#record on the main window to check if it is tagged</li>
<li>#with this record, and that could take a really long</li>
<li>#time.</li>
<li>#So if there are no records tagged with this test item</li>
<li>#then make sure the Main window is sorted by</li>
<li>#date and not by test item sort order.</li>
<li>If [ $atLeastOneRecord &ne; 1 ]</li>
<li>#</li>
<li>#The 'test' variable may have more than one</li>
<li>#key in it.  So we need a variable with just this</li>
<li>#records keys in it to conditionally format all </li>
<li>#learn window records tagged with it.</li>
<li>Set Variable [ $$tagtest; Value:test::_Ltest ]</li>
<li>#</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Refresh Window</li>
<li>Sort Records [ Specified Sort Order: testlearn::date; descending
testlearn::timestamp; descending ]
[ Restore; No dialog ]</li>
<li>Set Field [ TEMP::TLTestSort; "" ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>Else If [ $atLeastOneRecord = 1 ]</li>
<li>#</li>
<li>#The 'test' variable may have more than one</li>
<li>#key in it.  So we need a variable with just this</li>
<li>#records keys in it to conditionally format all </li>
<li>#learn window records tagged with it.</li>
<li>Set Variable [ $$tagtest; Value:test::_Ltest ]</li>
<li>Set Field [ TEMP::kctest; test::_Ltest ]</li>
<li>Set Variable [ $$SampleOrTestID; Value:Get (RecordID) ]</li>
<li>If [ $$add = 1 and $$citationMatch = $$addCitationMatch ]</li>
<li>Else If [ $$add = "" ]</li>
<li>End If</li>
<li>Refresh Window</li>
<li>#</li>
<li>#Just in case user was in nonTag field on this</li>
<li>#window when user clicked a menu button on </li>
<li>#the other window, exit all  fields.</li>
<li>//  If [ TEMP::TLTestSort = "" ]</li>
<li>Set Field [ TEMP::TLTestSort; "order" ]</li>
<li>Set Variable [ $recordNumber; Value:Get (RecordNumber) ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Perform Script [ &ldquo;sortTLRecordsByOrderNumber&rdquo; ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Go to Record/Request/Page [ $recordNumber ]
[ No dialog ]</li>
<li>Set Variable [ $$tagtest; Value:test::_Ltest ]</li>
<li>//  End If</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Go to Field [  ]</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>End If</li>
<li>#</li>
<li>#Unlike exit script, halt scripts will halt all scripts</li>
<li>#currently active.  So if user was on another tag</li>
<li>#record and then clicked on the add tag button</li>
<li>#to for another record, this script will launch.</li>
<li>#Problem is, because the user may want to really</li>
<li>#want to add this tag to the current item in the</li>
<li>#Learn window, after this script runs and finds</li>
<li>#zero records for example (which could happen)</li>
<li>#the add to tag script will run right after it, but</li>
<li>#it will fail to sort the records in the Learn window</li>
<li>#by order number, which this script </li>
<li>#(loadITemRecrodForTestTagMenu) is supposed</li>
<li>#do everytime.  The problem is a record for this</li>
<li>#tag record will exist after the addtotag script has</li>
<li>#run, but this script will not know that having run</li>
<li>#first.  So the user will be left wondering, "how is</li>
<li>#that everytime I click on a new test or sample tag</li>
<li>#record that has record tagged with it in the Learn </li>
<li>#window, the Learn window is sorted by order number</li>
<li>#except for this time?  How did this fail to happen?"</li>
<li>#Well, it failed for the reason given above and </li>
<li>#the sollution below is to use the 'Halt Script"</li>
<li>#command, which will force the user to click</li>
<li>#the add to tag button a second time to add the</li>
<li>#tag (the first time being when the user clicked</li>
<li>#it to move the system focus to this record, which</li>
<li>#triggered this loadItem... scirpt.</li>
<li>Halt Script</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>test</em>::_Ltest</li>
<li>
<em>TEMP</em>::kctest</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>testlearn</em>::kcsection</li>
<li>
<em>testlearn</em>::filterFind</li>
<li>
<em>testlearn</em>::kctest</li>
<li>
<em>testlearn</em>::date</li>
<li>
<em>testlearn</em>::timestamp</li>
<li>
<em>TEMP</em>::TLTestSort</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33129ScriptAnchor_">sortTLRecordsByOrderNumber</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>learn1</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33132ScriptAnchor_"></a><td class="script_navbar"><a href="#33127ScriptAnchor_"><span>Previous Script: [loadItemRecordForTestTagMenu]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33069ScriptAnchor_"><span>Next Script: [loadItemRecordForTestSetupTagMenu]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">addTagToTestSubject</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Get key for tag that is to be added to record.</li>
<li>If [ Get (LayoutName)  &ne;  "defaultLocation" ]</li>
<li>Set Variable [ $tag; Value:tagMenus::_Ltag ]</li>
<li>Else If [ Get (LayoutName) = "defaultLocation" ]</li>
<li>Set Variable [ $tag; Value:tagTestSubjectLocation::knode ]</li>
<li>End If</li>
<li>#</li>
<li>#Remove focus from field so can see </li>
<li>#conditional formatting.</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Conditionally format selected tag.</li>
<li>If [ Get (LayoutName)  &ne;  "defaultLocation" ]</li>
<li>Set Variable [ $$testSubject; Value:tagMenus::_Ltag ]</li>
<li>Else If [ Get (LayoutName) = "defaultLocation" ]</li>
<li>Set Variable [ $$testSubject; Value:tagTestSubjectLocation::knode ]</li>
<li>End If</li>
<li>#</li>
<li>#Select reference, learn, or setup window.</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>#</li>
<li>#If test subject node is in use, then remove it.</li>
<li>If [ tempSetup::kdefaultNodeTestSubject = $tag ]</li>
<li>Set Field [ tempSetup::kdefaultNodeTestSubject; "" ]</li>
<li>#</li>
<li>#Finish removing the key.</li>
<li>Set Variable [ $$testSubject ]</li>
<li>#</li>
<li>#If primary node is not in use add it.</li>
<li>Else If [ tempSetup::kdefaultNodeTestSubject &ne; $tag ]</li>
<li>Set Field [ tempSetup::kdefaultNodeTestSubject; $tag ]</li>
<li>Set Variable [ $$testSubject; Value:tempSetup::kdefaultNodeTestSubject ]</li>
<li>#</li>
<li>#Record must be committed if user decides to </li>
<li>#perform a script on it right after this one or</li>
<li>#perform a find requiring the newly added key.</li>
<li>Commit Records/Requests</li>
<li>#</li>
<li>#goto Tag Menus window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>Refresh Window</li>
<li>#</li>
<li>#goto Tag Menus window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>tagTestSubjectLocation</em>::knode</li>
<li>
<em>tempSetup</em>::kdefaultNodeTestSubject</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33069ScriptAnchor_"></a><td class="script_navbar"><a href="#33132ScriptAnchor_"><span>Previous Script: [addTagToTestSubject]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33133ScriptAnchor_"><span>Next Script: [defaultTestLocationMenu]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">loadItemRecordForTestSetupTagMenu</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ $$ID = test::_Ltest

 or 

$$ID = "ignore" ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $$ID; Value:test::_Ltest ]</li>
<li>Set Variable [ $item; Value:test::testName ]</li>
<li>Set Field [ TEMP::ktest; test::_Ltest ]</li>
<li>Set Field [ TEMP::testName; test::testName ]</li>
<li>Set Field [ TEMP::ksection; test::ksection ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>test</em>::_Ltest</li>
<li>
<em>test</em>::testName</li>
<li>
<em>TEMP</em>::ktest</li>
<li>
<em>TEMP</em>::testName</li>
<li>
<em>test</em>::ksection</li>
<li>
<em>TEMP</em>::ksection</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33133ScriptAnchor_"></a><td class="script_navbar"><a href="#33069ScriptAnchor_"><span>Previous Script: [loadItemRecordForTestSetupTagMenu]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33128ScriptAnchor_"><span>Next Script: [setOrderForSampleOrTest]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">defaultTestLocationMenu</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32856ScriptAnchor_">returnToStep2</a></li>
<li><a href="#33167ScriptAnchor_">printThingReport</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>If [ tempSetup::kdefaultNodePrimary = "" ]</li>
<li>Show Custom Dialog [ Message: "Select yourself (the node responsible for creating new records) by clicking the node button."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Halt Script</li>
<li>Else If [ tempSetup::kdefaultHealth = "" ]</li>
<li>Show Custom Dialog [ Message: "Select the default copyright for any new records that you create by clicking the copyright button (you can always change your mind)."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#A section must be selected before locations</li>
<li>#can be assigned.</li>
<li>If [ TEMP::ksection = "" ]</li>
<li>Perform Script [ &ldquo;defaultSectionMenu&rdquo; ]</li>
<li>Show Custom Dialog [ Message: "You must select a section prior to clicking the 'test' button.  All tests belong to specific sections.  "; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Make sure creator node's group is part of section group.</li>
<li>Perform Script [ &ldquo;addBackSectionCreatorNode&rdquo; ]</li>
<li>//  #</li>
<li>//  #A test subject must be selected before locations</li>
<li>//  #be assigned.</li>
<li>//  If [ tempSetup::kdefaultNodeTestSubject = "" ]</li>
<li>//  Show Custom Dialog [ Message: "Select a test subject."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>//  Perform Script [ &ldquo;defaultNodeMenu&rdquo; ]</li>
<li>//  Exit Script [  ]</li>
<li>//  End If</li>
<li>#</li>
<li>#Set citationMatch to color menu button with inUse color.</li>
<li>Set Variable [ $$citationMatch; Value:"location" ]</li>
<li>#</li>
<li>#Locations are shown are the  general locations</li>
<li>#for a test.  This menu will be used to create</li>
<li>#specific locations for a specific test subject.</li>
<li>#So in the Setup window the system highlights</li>
<li>#the test subject for whom the locations are going</li>
<li>#to be created.</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>Set Variable [ $$citationitem ]</li>
<li>Set Variable [ $$testSubject; Value:tempSetup::kdefaultNodeTestSubject ]</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>#</li>
<li>#Find all test location records.</li>
<li>Go to Layout [ &ldquo;defaultTest&rdquo; (tagTestSubjectLocation) ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>Enter Find Mode [  ]</li>
<li>//  Set Field [ tagTestSubjectLocation::knode; TEMP::kdefaultNodeTestSubject ]</li>
<li>Set Field [ tagTestSubjectLocation::ksection; TEMP::ksection ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Sort</li>
<li>Sort Records [ Specified Sort Order: tagTestSubject::tag; ascending
tagTestSubjectLocation::reportNumber; ascending
tagTestSubjectLocation::order; based on value list: &ldquo;order&rdquo;
tagTestSubjectLocation::focusName; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#</li>
<li>#Just in case user was in nonTag field on this</li>
<li>#window when user clicked a menu button on </li>
<li>#the other window, exit all  fields.</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#goto Tag Menus window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>#</li>
<li>#Clear current temp field of location names in</li>
<li>#case user has selected a section different from</li>
<li>#the one previous, and thus with name that might</li>
<li>#not match those in these temp fields.</li>
<li>Set Field [ TEMP::LocationName; "" ]</li>
<li>Set Field [ TEMP::modifier1name; "" ]</li>
<li>Set Field [ TEMP::modifier2name; "" ]</li>
<li>Set Field [ TEMP::kfocus; "" ]</li>
<li>Set Field [ TEMP::kmodifier1; "" ]</li>
<li>Set Field [ TEMP::kmodifier2; "" ]</li>
<li>Set Field [ TEMP::orderLocation; "" ]</li>
<li>Set Field [ TEMP::orderMod1; "" ]</li>
<li>Set Field [ TEMP::orderMod2; "" ]</li>
<li>#</li>
<li>#Set reportnumber to a default of 1.</li>
<li>Set Field [ TEMP::reportNumber; 1 ]</li>
<li>#</li>
<li>#Set temp keys to unlock pulldown lists for </li>
<li>#section locations.</li>
<li>Go to Layout [ &ldquo;tableGroupTag&rdquo; (groupTest) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ groupTest::ksection; TEMP::ksection ]</li>
<li>Set Field [ groupTest::match; "location" ]</li>
<li>Perform Find [  ]</li>
<li>Set Field [ TEMP::locationSection; groupTest::_Lgroup ]</li>
<li>#</li>
<li>#Set temp keys to unlock pulldown lists for </li>
<li>#section attributes.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ groupTest::ksection; TEMP::ksection ]</li>
<li>Set Field [ groupTest::match; "attribute" ]</li>
<li>Perform Find [  ]</li>
<li>Set Field [ TEMP::pulldownAttribute; groupTest::_Lgroup ]</li>
<li>#</li>
<li>#Return to tag menu layout.</li>
<li>Go to Layout [ &ldquo;defaultTest&rdquo; (tagTestSubjectLocation) ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tempSetup</em>::kdefaultNodePrimary</li>
<li>
<em>tempSetup</em>::kdefaultHealth</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>tempSetup</em>::kdefaultNodeTestSubject</li>
<li>
<em>TEMP</em>::kdefaultNodeTestSubject</li>
<li>
<em>tagTestSubjectLocation</em>::knode</li>
<li>
<em>tagTestSubjectLocation</em>::ksection</li>
<li>
<em>tagTestSubject</em>::tag</li>
<li>
<em>tagTestSubjectLocation</em>::reportNumber</li>
<li>
<em>tagTestSubjectLocation</em>::order</li>
<li>
<em>tagTestSubjectLocation</em>::focusName</li>
<li>
<em>TEMP</em>::LocationName</li>
<li>
<em>TEMP</em>::modifier1name</li>
<li>
<em>TEMP</em>::modifier2name</li>
<li>
<em>TEMP</em>::kfocus</li>
<li>
<em>TEMP</em>::kmodifier1</li>
<li>
<em>TEMP</em>::kmodifier2</li>
<li>
<em>TEMP</em>::orderLocation</li>
<li>
<em>TEMP</em>::orderMod1</li>
<li>
<em>TEMP</em>::orderMod2</li>
<li>
<em>TEMP</em>::reportNumber</li>
<li>
<em>groupTest</em>::ksection</li>
<li>
<em>groupTest</em>::match</li>
<li>
<em>groupTest</em>::_Lgroup</li>
<li>
<em>TEMP</em>::locationSection</li>
<li>
<em>TEMP</em>::pulldownAttribute</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33090ScriptAnchor_">defaultSectionMenu</a></li>
<li><a href="#33245ScriptAnchor_">addBackSectionCreatorNode</a></li>
<li><a href="#33088ScriptAnchor_">defaultNodeMenu</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>defaultTest</li>
<li>tableGroupTag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33128ScriptAnchor_"></a><td class="script_navbar"><a href="#33133ScriptAnchor_"><span>Previous Script: [defaultTestLocationMenu]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33198ScriptAnchor_"><span>Next Script: [testAddTestItemTextOrKey]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">setOrderForSampleOrTest</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Get order number user has selected then exit</li>
<li>#the order field.</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $order; Value:testlearn::orderTest ]</li>
<li>#</li>
<li>#If record is not part of a sample or test exit script.</li>
<li>If [ $$citationMatch = "sample" and testlearn::kcsample = "" ]</li>
<li>Set Field [ testlearn::orderTest; "" ]</li>
<li>Show Custom Dialog [ Message: "You can apply an order number to this record when you make it part of a sample by clicking any square button in Tag Menus window next to a sample tag."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ $$citationMatch = "test" and testlearn::kctest = "" ]</li>
<li>Set Field [ testlearn::orderTest; "" ]</li>
<li>Show Custom Dialog [ Message: "You can apply an order number to this record when you make it part of a test by clicking any square button in Tag Menus window next to a test tag."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#The order number is the left three digits of a</li>
<li>#sample or test record lock number.  ( Remember</li>
<li>#each record in the database has lock number or</li>
<li>#ID number.  To open the lock and see any record's</li>
<li>#contents requires a key number that fits the lock.</li>
<li>#So if a lock number is 123, then the key that will</li>
<li>#fit this lock is 123 too. )  Because the sample </li>
<li>#and test key fields (think of key chains) may </li>
<li>#have several keys, because any one learn record</li>
<li>#may be part of more than one sample or test. </li>
<li>#the system must check each learn record's keys</li>
<li>#one at a time to see if any fit the current sample</li>
<li>#or test's lock.  So beginning with number one</li>
<li>#the system checks each key.  The left most 3 numbers</li>
<li>#are order numbers so below you will note that </li>
<li>#they system starts the check on the 4th number</li>
<li>#from the left.</li>
<li>Set Variable [ $number; Value:1 ]</li>
<li>If [ $$citationMatch = "sample" ]</li>
<li>Loop</li>
<li>If [ Middle ( GetValue ( testlearn::kcsample ; $number ) ; 4 ; 42 )  &amp; "&para;"   = $$tagSample &amp; &para; ]</li>
<li>Set Variable [ $replacementValue; Value:Replace ( GetValue ( testlearn::kcsample ; $number )  ; 1 ; 3 ; $order ) ]</li>
<li>#</li>
<li>#When and if a key is found that fits the current</li>
<li>#sample or test record's lock, the order number</li>
<li>#the user has selected overwrites the left most</li>
<li>#3 digits which by default are 999.</li>
<li>Set Field [ testlearn::kcsample; Substitute ( $$sample ; GetValue ( testlearn::kcsample ; $number )  &amp; "&para;"  ; $replacementValue  &amp; &para;) ]</li>
<li>#</li>
<li>#The 'sample' variable is resset to reflect this change</li>
<li>Set Variable [ $$sample; Value:testlearn::kcsample ]</li>
<li>Set Variable [ $$citationItem ]</li>
<li>#</li>
<li>#The 'number' variable is made blank to trigger</li>
<li>#the exit from this loop, the key having been found.</li>
<li>Set Variable [ $number ]</li>
<li>End If</li>
<li>Exit Loop If [ $number = "" ]</li>
<li>#</li>
<li>#Exit the script if the current record is not part</li>
<li>#of the selected sample or test after checking </li>
<li>#all of its keys.</li>
<li>If [ GetValue ( testlearn::kcsample ; $number )  = "" ]</li>
<li>Set Field [ testlearn::orderTest; "" ]</li>
<li>Show Custom Dialog [ Message: "You can apply an order number to this record when you make it part of the selected sample by clicking the square button in Tag Menus window next to it."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Add 1 to the 'number' varaible after each key</li>
<li>#in the key field is checked, to direct the system</li>
<li>#to check the next key.</li>
<li>Set Variable [ $add; Value:$number ]</li>
<li>Set Variable [ $number; Value:$add + 1 ]</li>
<li>End Loop</li>
<li>#</li>
<li>Else If [ $$citationMatch = "test" ]</li>
<li>Loop</li>
<li>If [ Middle ( GetValue ( testlearn::kctest ; $number ) ; 4 ; 42 )  &amp; "&para;"   = $$tagtest &amp; &para; ]</li>
<li>Set Variable [ $replacementValue; Value:Replace ( GetValue ( testlearn::kctest ; $number )  ; 1 ; 3 ; $order ) ]</li>
<li>#</li>
<li>#When and if a key is found that fits the current</li>
<li>#sample or test record's lock, the order number</li>
<li>#the user has selected overwrites the left most</li>
<li>#3 digits which by default are 999.</li>
<li>Set Field [ testlearn::kctest; Substitute ( $$test ; GetValue ( testlearn::kctest ; $number )  &amp; "&para;"  ; $replacementValue  &amp; &para;) ]</li>
<li>#</li>
<li>#The 'test' variable is resset to reflect this change</li>
<li>Set Variable [ $$test; Value:testlearn::kctest ]</li>
<li>Set Variable [ $$citationItem ]</li>
<li>#</li>
<li>#The 'number' variable is made blank to trigger</li>
<li>#the exit from this loop, the key having been found.</li>
<li>Set Variable [ $number ]</li>
<li>End If</li>
<li>Exit Loop If [ $number = "" ]</li>
<li>#</li>
<li>#Exit the script if the current record is not part</li>
<li>#of the selected sample or test after checking </li>
<li>#all of its keys.</li>
<li>If [ GetValue ( testlearn::kctest ; $number )  = "" ]</li>
<li>Set Field [ testlearn::orderTest; "" ]</li>
<li>Show Custom Dialog [ Message: "You can apply an order number to this record when you make it part of the selected test by clicking the square button in Tag Menus window next to it."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Add 1 to the 'number' varaible after each key</li>
<li>#in the key field is checked, to direct the system</li>
<li>#to check the next key.</li>
<li>Set Variable [ $add; Value:$number ]</li>
<li>Set Variable [ $number; Value:$add + 1 ]</li>
<li>End Loop</li>
<li>End If</li>
<li>Sort Records [  ]
[ No dialog ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearn</em>::orderTest</li>
<li>
<em>testlearn</em>::kcsample</li>
<li>
<em>testlearn</em>::kctest</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33198ScriptAnchor_"></a><td class="script_navbar"><a href="#33128ScriptAnchor_"><span>Previous Script: [setOrderForSampleOrTest]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33204ScriptAnchor_"><span>Next Script: [moveTagToNewGroupStep1]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">testAddTestItemTextOrKey</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>#If text is selected then the user wants to add</li>
<li>#the text of the test item to the caption field.</li>
<li>If [ TEMP::textORcheck = "text" ]</li>
<li>Set Variable [ $tag; Value:tagMenus::tag ]</li>
<li>#</li>
<li>Select Window [ Name: "Test"; Current file ]</li>
<li>Set Variable [ $caption; Value:testlearn::Caption ]</li>
<li>Set Field [ testlearn::Caption; $caption &amp; &para; &amp; $tag ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>#</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If check is selected then the user wants to add</li>
<li>#the key of the test item to the discovery record's</li>
<li>#keychain.</li>
<li>#</li>
<li>#Get key for tag that is to be added to record.</li>
<li>Set Variable [ $tag; Value:tagMenus::_Ltag ]</li>
<li>#</li>
<li>#If test item is in use, then remove it.</li>
<li>Select Window [ Name: "Test"; Current file ]</li>
<li>Set Variable [ $number; Value:1 ]</li>
<li>Loop</li>
<li>If [ FilterValues ( GetValue ( testlearn::kctestItem ; $number ) ; $tag &amp; "&para;"  )  = $tag &amp; &para; ]</li>
<li>Set Field [ testlearn::kctestItem; Substitute ( $$testItem ; GetValue ( testlearn::kctestItem ; $number )  &amp; "&para;"  ; "" ) ]</li>
<li>Set Variable [ $$testItem; Value:testlearn::kctestItem ]</li>
<li>Set Variable [ $number; Value:"exit" ]</li>
<li>#</li>
<li>#Remove one item from inuse items for this group.</li>
<li>#This is essential for the unlink script on the test setup</li>
<li>#module.  A group that has items in use cannot be</li>
<li>#unlinked until all inuse items are unlinked.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Set Variable [ $inUseNumberOfTimes; Value:ruleTagMenuGroups::CaptionORinuseCheck ]</li>
<li>Set Field [ ruleTagMenuGroups::CaptionORinuseCheck; If ( $inUseNumberOfTimes - 1 = 0 ; "" ; $inUseNumberOfTimes - 1 ) ]</li>
<li>End If</li>
<li>#</li>
<li>#If number was set to exit or if no keys exist, then </li>
<li>#exit loop.</li>
<li>Exit Loop If [ GetValue ( testlearn::kctestItem ; $number )  = "" ]</li>
<li>#</li>
<li>#Not sure how this could happen, but leaving it in and</li>
<li>#wishing I had made a comment when I added it.</li>
<li>Exit Loop If [ $number = "" ]</li>
<li>#</li>
<li>#If variable looked at did not match then raise the number</li>
<li>#to view the next variable.</li>
<li>Set Variable [ $add; Value:$number ]</li>
<li>Set Variable [ $number; Value:$add + 1 ]</li>
<li>End Loop</li>
<li>#</li>
<li>If [ $number &ne; "exit" ]</li>
<li>#</li>
<li>#Start by looking at the first variable on the keychain.</li>
<li>Set Variable [ $number; Value:1 ]</li>
<li>Loop</li>
<li>#If test item is not in use add it.</li>
<li>If [ FilterValues ( GetValue ( testlearn::kctestItem ; $number ) ; $tag &amp; "&para;"  ) &ne; $tag &amp; &para; ]</li>
<li>Set Field [ testlearn::kctestItem; $tag &amp; &para; &amp; $$testItem ]</li>
<li>Set Variable [ $$testItem; Value:testlearn::kctestItem ]</li>
<li>Set Variable [ $number ]</li>
<li>#</li>
<li>#Record must be committed if user decides to </li>
<li>#perform a script on it right after this one or</li>
<li>#perform a find requiring the newly added key.</li>
<li>Commit Records/Requests</li>
<li>#</li>
<li>#</li>
<li>#Add one item from inuse items for this group.</li>
<li>#This is essential for the unlink script on the test setup</li>
<li>#module.  A group that has items in use cannot be</li>
<li>#unlinked until all inuse items are unlinked.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Set Variable [ $inUseNumberOfTimes; Value:ruleTagMenuGroups::CaptionORinuseCheck ]</li>
<li>Set Field [ ruleTagMenuGroups::CaptionORinuseCheck; $inUseNumberOfTimes + 1 ]</li>
<li>End If</li>
<li>#</li>
<li>#If number was set to exit or if no keys exist, then </li>
<li>#exit loop.</li>
<li>Exit Loop If [ FilterValues ( GetValue ( testlearn::kctestItem ; $number ) ; $tag &amp; "&para;"  ) = "" ]</li>
<li>#</li>
<li>#Not sure how this could happen, but leaving it in and</li>
<li>#wishing I had made a comment when I added it.</li>
<li>Exit Loop If [ $number = "" ]</li>
<li>#</li>
<li>#If variable looked at did not match then raise the number</li>
<li>#to view the next variable.</li>
<li>Set Variable [ $add; Value:$number ]</li>
<li>Set Variable [ $number; Value:$add + 1 ]</li>
<li>End Loop</li>
<li>End If</li>
<li>//  Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::textORcheck</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>testlearn</em>::Caption</li>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>testlearn</em>::kctestItem</li>
<li>
<em>ruleTagMenuGroups</em>::CaptionORinuseCheck</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33204ScriptAnchor_"></a><td class="script_navbar"><a href="#33198ScriptAnchor_"><span>Previous Script: [testAddTestItemTextOrKey]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33205ScriptAnchor_"><span>Next Script: [moveTagToNewGroupStep1b ]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">moveTagToNewGroupStep1</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If node is currenlty locked then stop script, inform user.</li>
<li>If [ nodeLockTagMenus::orderOrLock &ne; "" ]</li>
<li>Go to Field [  ]</li>
<li>Show Custom Dialog [ Message: "This record is locked.  Go the node that created it -- " &amp; nodeLockTagMenus::tag &amp; " -- in the setup tag window and enter the password to unlock it so that you can move it."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>If [ tagMenus::orderOrLock = "lock" ]</li>
<li>Go to Field [  ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>If [ ValueCount ( ruleTagMenuGroups::ksection ) &gt; 1 ]</li>
<li>#</li>
<li>#If group user is moving tag from is in more than</li>
<li>#one section of the database, then stop the move.</li>
<li>#The problem is that if this tag is in use, and the</li>
<li>#user moves it to a section that does not exist</li>
<li>#in one of the sections using it, then in that section</li>
<li>#the user will not be able to find by this tag or</li>
<li>#or remove it.  The remedy would be to add </li>
<li>#the group being moved to to all the sections using</li>
<li>#the tag.  I leaving this remedy for another day.</li>
<li>Go to Field [  ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: tagMenus::tag &amp; " cannot be moved because its group belongs to more than one section.  Tags can be moved as long as the groups they are being moved from belong to only one section."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Set Variable [ $$groupOLD; Value:tagMenus::kGroupOrTest ]</li>
<li>Set Variable [ $$moveItem; Value:tagMenus::_Ltag ]</li>
<li>Refresh Window</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>nodeLockTagMenus</em>::orderOrLock</li>
<li>
<em>nodeLockTagMenus</em>::tag</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>ruleTagMenuGroups</em>::ksection</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>tagMenus</em>::kGroupOrTest</li>
<li>
<em>tagMenus</em>::_Ltag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33205ScriptAnchor_"></a><td class="script_navbar"><a href="#33204ScriptAnchor_"><span>Previous Script: [moveTagToNewGroupStep1]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33203ScriptAnchor_"><span>Next Script: [moveTagToNewGroupStep2]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">moveTagToNewGroupStep1b </td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Variable [ $$groupOLD ]</li>
<li>Set Variable [ $$moveItem ]</li>
<li>Refresh Window</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33203ScriptAnchor_"></a><td class="script_navbar"><a href="#33205ScriptAnchor_"><span>Previous Script: [moveTagToNewGroupStep1b ]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33088ScriptAnchor_"><span>Next Script: [defaultNodeMenu]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">moveTagToNewGroupStep2</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>//  If [ ValueCount ( ruleTagMenuGroups::ksection ) &gt; 1 ]</li>
<li>//  Exit Script [  ]</li>
<li>//  End If</li>
<li>#</li>
<li>#Stop test record load script to speed up script.</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>#</li>
<li>#Get the newly selected group's ID number.</li>
<li>Set Variable [ $newGroup; Value:tagMenus::kGroupOrTest ]</li>
<li>Set Variable [ $$moveItem; Value:tagMenus::_Ltag ]</li>
<li>Refresh Window</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>#</li>
<li>If [ ValueCount ( ruleTagMenuGroups::ksection ) &gt; 1 ]</li>
<li>#</li>
<li>#If group user is moving tag onto is in more than</li>
<li>#one section of the database, then warn user that</li>
<li>#if the go ahead with the move, they will be unable</li>
<li>#to reverse their decision after moving.</li>
<li>Go to Field [  ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "WARNING: Once the "  &amp; tagMenus::tag &amp; " move is finished it cannot be undone. The group it is being moved to is in more than one section of this database.  Tags cannot be moved out of these types of groups. So are you really sure about this move?"; Buttons: &ldquo;undo move&rdquo;, &ldquo;I am sure!&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>#</li>
<li>#Reset the tag's group ID with its old group ID</li>
<li>#number grabbed by the system in part 1 of </li>
<li>#this script.</li>
<li>Set Field [ tagMenus::kGroupOrTest; $$groupOLD ]</li>
<li>Set Variable [ $$moveItem ]</li>
<li>Set Variable [ $$groupOLD ]</li>
<li>Refresh Window</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Turn back on the loadrecord script.  The current</li>
<li>#record's info does not need to be reloaded of course</li>
<li>#because it is still the current record.</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Reset the tag's group ID with its old group ID</li>
<li>#number grabbed by the system in part 1 of </li>
<li>#this script, just in case the user decides to cancel</li>
<li>#move and the test needs to stay put.</li>
<li>Set Field [ tagMenus::kGroupOrTest; $$groupOLD ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Check if this is the last test in the test group.</li>
<li>New Window [  ]</li>
<li>Go to Layout [ &ldquo;tableTag&rdquo; (tagTable) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTable::kGroupOrTest; $$groupOLD ]</li>
<li>Perform Find [  ]</li>
<li>If [ Get (FoundCount) = 1 ]</li>
<li>Close Window [ Current Window ]</li>
<li>Set Variable [ $group; Value:$$groupOLD ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#If it is the last item inform user that after the move</li>
<li>#the old group will be deleted unless the user</li>
<li>#creates a new item for this group before moving</li>
<li>#the old item.</li>
<li>Show Custom Dialog [ Title: "!"; Message: "After " &amp; tagMenus::tag &amp; " is moved its old group will be deleted.  If you want to keep this group then  create a new tag for the old group before the last tag out of it."; Buttons: &ldquo;Cancel&rdquo;, &ldquo;move&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Set Variable [ $newGroup ]</li>
<li>Set Variable [ $$groupOLD ]</li>
<li>Set Variable [ $$moveItem ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#Turn back on the loadrecord script.  The current</li>
<li>#record's info does not need to be reloaded of course</li>
<li>#because it is still the current record.</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#If the user decides to go ahead with the move,</li>
<li>#first delete the old group.</li>
<li>New Window [  ]</li>
<li>#</li>
<li>Go to Layout [ &ldquo;tableGroupTag&rdquo; (groupTest) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ groupTest::_Lgroup; $$groupOLD ]</li>
<li>Perform Find [  ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>#</li>
<li>End If</li>
<li>#</li>
<li>#Close window opened to perform find, and then</li>
<li>#set group ID of test with the new groups ID number.</li>
<li>Close Window [ Current Window ]</li>
<li>Set Field [ tagMenus::kGroupOrTest; $newGroup ]</li>
<li>Set Variable [ $$groupOLD ]</li>
<li>Set Variable [ $$moveItem ]</li>
<li>Set Variable [ $category ]</li>
<li>Refresh Window</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Turn back on the loadrecord script.  The current</li>
<li>#record's info does not need to be reloaded of course</li>
<li>#because it is still the current record.</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>#</li>
<li>Halt Script</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>ruleTagMenuGroups</em>::ksection</li>
<li>
<em>tagMenus</em>::kGroupOrTest</li>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>tagTable</em>::kGroupOrTest</li>
<li>
<em>groupTest</em>::_Lgroup</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>tableTag</li>
<li>tableGroupTag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33088ScriptAnchor_"></a><td class="script_navbar"><a href="#33203ScriptAnchor_"><span>Previous Script: [moveTagToNewGroupStep2]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33089ScriptAnchor_"><span>Next Script: [defaultHealthMenu]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">defaultNodeMenu</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33086ScriptAnchor_">startDatabase</a></li>
<li><a href="#33234ScriptAnchor_">update</a></li>
<li><a href="#33236ScriptAnchor_">createEmptyLibrary</a></li>
<li><a href="#33133ScriptAnchor_">defaultTestLocationMenu</a></li>
<li><a href="#33020ScriptAnchor_">addLinksPicturesToTagsMode</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#A section must be selected before nodes</li>
<li>#can be assigned.</li>
<li>If [ TEMP::ksection = "" ]</li>
<li>Perform Script [ &ldquo;defaultSectionMenu&rdquo; ]</li>
<li>Show Custom Dialog [ Message: "All nodes are assigned to a library.  You need to go the backup layout in admin mode and type in the words New Library, and then restart this database."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Make sure creator node's group is part of section group.</li>
<li>Perform Script [ &ldquo;addBackSectionCreatorNode&rdquo; ]</li>
<li>#</li>
<li>#Set citationMatch to color menu button with inUse color.</li>
<li>Set Variable [ $$citationMatch; Value:"node" ]</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>Set Variable [ $$citationitem; Value:tempSetup::kdefaultNodePrimary ]</li>
<li>Set Variable [ $$testSubject; Value:tempSetup::kdefaultNodeTestSubject ]</li>
<li>Set Variable [ $$node; Value:tempSetup::kdefaultNodeOther ]</li>
<li>Set Field [ TEMP::mTag; "node" ]</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>#</li>
<li>#Find all node records.</li>
<li>If [ tempSetup::DefaultmoreORLessLayoutNode = "" ]</li>
<li>Go to Layout [ &ldquo;defaultNode1&rdquo; (tagMenus) ]</li>
<li>Set Field [ TEMP::DefaultmoreORLessLayoutNode; "more" &amp; Get (LayoutName) ]</li>
<li>Else If [ tempSetup::DefaultmoreORLessLayoutNode &ne; "" ]</li>
<li>Go to Layout [ Middle ( TEMP::DefaultmoreORLessLayoutNode ; 5 ; 42 ) ]</li>
<li>End If</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::match; $$citationMatch ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; "==" &amp; TEMP::ksection ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Sort according to current users wishes.  By default</li>
<li>#the sort will be by category which is set by editCitation script.</li>
<li>If [ TEMP::sortNode = "cat"
 or 
TEMP::sortNode = "" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ TEMP::sortNode; "cat" ]</li>
<li>Else If [ TEMP::sortNode = "abc" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagSectionName::name; ascending
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#Go to citation record's current selection or to first record.</li>
<li>#Because user may click anywhere to go to a record</li>
<li>#all keys for all menu items must uploaded</li>
<li>#until one is found that matches and then the</li>
<li>#$$citationItem variable can be set.</li>
<li>#Like when the user clicks in a non field area</li>
<li>#a space between fields that then tells filemaker</li>
<li>#to go that record but not to field belonging to</li>
<li>#that record.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$citationitem =  tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>If [ $$citationitem &ne;  tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>End If</li>
<li>#</li>
<li>#Inform user of items use on both screens.</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#</li>
<li>#Just in case user was in nonTag field on this</li>
<li>#window when user clicked a menu button on </li>
<li>#the other window, exit all  fields.</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#goto Tag Menus window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>tempSetup</em>::kdefaultNodePrimary</li>
<li>
<em>tempSetup</em>::kdefaultNodeTestSubject</li>
<li>
<em>tempSetup</em>::kdefaultNodeOther</li>
<li>
<em>TEMP</em>::mTag</li>
<li>
<em>tempSetup</em>::DefaultmoreORLessLayoutNode</li>
<li>
<em>TEMP</em>::DefaultmoreORLessLayoutNode</li>
<li>
<em>tagMenus</em>::match</li>
<li>
<em>ruleTagMenuGroups</em>::ksection</li>
<li>
<em>TEMP</em>::sortNode</li>
<li>
<em>ruleTagMenuGroups</em>::order</li>
<li>
<em>ruleTagMenuGroups</em>::name</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>ruleTagSectionName</em>::name</li>
<li>
<em>tagMenus</em>::_Ltag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33090ScriptAnchor_">defaultSectionMenu</a></li>
<li><a href="#33245ScriptAnchor_">addBackSectionCreatorNode</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>defaultNode1</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33089ScriptAnchor_"></a><td class="script_navbar"><a href="#33088ScriptAnchor_"><span>Previous Script: [defaultNodeMenu]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33090ScriptAnchor_"><span>Next Script: [defaultSectionMenu]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">defaultHealthMenu</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>If [ tempSetup::kdefaultNodePrimary = "" ]</li>
<li>Show Custom Dialog [ Message: "Select yourself (the node responsible for creating new records) by clicking the node button."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#Set citationMatch to color menu button with inUse color.</li>
<li>Set Variable [ $$citationMatch; Value:"health" ]</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>Set Variable [ $$citationitem; Value:tempSetup::kdefaultHealth ]</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>#</li>
<li>#Find all node records.</li>
<li>Go to Layout [ &ldquo;defaultHealth&rdquo; (tagMenus) ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::match; $$citationMatch ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Upate language for locked health tags.</li>
<li>Perform Script [ &ldquo;CHUNKHealthLockedFields&rdquo; ]</li>
<li>#</li>
<li>#Sort according to current users wishes.  By default</li>
<li>#the sort will be by category which is set by editCitation script.</li>
<li>If [ TEMP::sortHealth = "cat"
 or 
TEMP::sortHealth = "" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagSectionName::name; ascending
ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ TEMP::sortHealth = "abc" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagSectionName::name; ascending
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#Go to citation record's current selection or to first record.</li>
<li>#Because user may click anywhere to go to a record</li>
<li>#all keys for all menu items must uploaded</li>
<li>#until one is found that matches and then the</li>
<li>#$$citationItem variable can be set.</li>
<li>#Like when the user clicks in a non field area</li>
<li>#a space between fields that then tells filemaker</li>
<li>#to go that record but not to field belonging to</li>
<li>#that record.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$citationitem =  tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>If [ $$citationitem &ne;  tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>End If</li>
<li>#</li>
<li>#Inform user of items use on both screens.</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#</li>
<li>#Just in case user was in nonTag field on this</li>
<li>#window when user clicked a menu button on </li>
<li>#the other window, exit all  fields.</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#goto Tag Menus window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tempSetup</em>::kdefaultNodePrimary</li>
<li>
<em>tempSetup</em>::kdefaultHealth</li>
<li>
<em>tagMenus</em>::match</li>
<li>
<em>TEMP</em>::sortHealth</li>
<li>
<em>ruleTagSectionName</em>::name</li>
<li>
<em>ruleTagMenuGroups</em>::order</li>
<li>
<em>ruleTagMenuGroups</em>::name</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>tagMenus</em>::_Ltag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33243ScriptAnchor_">CHUNKHealthLockedFields</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>defaultHealth</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33090ScriptAnchor_"></a><td class="script_navbar"><a href="#33089ScriptAnchor_"><span>Previous Script: [defaultHealthMenu]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33231ScriptAnchor_"><span>Next Script: [checkIfLockedOnLearnTagMenus]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">defaultSectionMenu</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33086ScriptAnchor_">startDatabase</a></li>
<li><a href="#33155ScriptAnchor_">deleteSection</a></li>
<li><a href="#32891ScriptAnchor_">returnToSetup</a></li>
<li><a href="#33133ScriptAnchor_">defaultTestLocationMenu</a></li>
<li><a href="#33088ScriptAnchor_">defaultNodeMenu</a></li>
<li><a href="#32985ScriptAnchor_">backToLearnOrDefaultSetup</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Set citationMatch to color menu button with inUse color.</li>
<li>Set Variable [ $$citationMatch; Value:"section" ]</li>
<li>Set Variable [ $$stopAddTagToCitation; Value:1 ]</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>Set Variable [ $$citationitem; Value:TEMP::ksection ]</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Go to Layout [ &ldquo;defaultSections&rdquo; (ruleSection) ]</li>
<li>#</li>
<li>#</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ ruleSection::match; "section" ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>Sort Records [ Specified Sort Order: ruleSection::name; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#Go to citation record's current selection or to first record.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ TEMP::ksection = ruleSection::ksection ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>If [ TEMP::ksection &ne; ruleSection::ksection ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>End If</li>
<li>#</li>
<li>Set Variable [ $$stopAddTagToCitation ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>ruleSection</em>::match</li>
<li>
<em>ruleSection</em>::name</li>
<li>
<em>ruleSection</em>::ksection</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>defaultSections</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33231ScriptAnchor_"></a><td class="script_navbar"><a href="#33090ScriptAnchor_"><span>Previous Script: [defaultSectionMenu]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33182ScriptAnchor_"><span>Next Script: [menuReferenceNodesOrEditors]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">checkIfLockedOnLearnTagMenus</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33038ScriptAnchor_">loadTagRecord</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>If [ $$citationMatch = "key"
//or $$citationMatch = "node"
or $$citationMatch = "health"
or $$citationMatch = "medium"
or $$citationMatch = "path" ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#Used on learn tag menus to keep user out of any </li>
<li>#locked fields.</li>
<li>If [ nodeLockTagMenus::orderOrLock  &ne;  "" and Get ( ActiveFieldName ) = "tag" ]</li>
<li>Set Field [ tagMenus::tag; tagMenus::tagSpelling ]</li>
<li>Go to Field [  ]</li>
<li>Show Custom Dialog [ Message: "This record is locked.  Go the node that created it -- " &amp; nodeLockTagMenus::tag &amp; " -- and enter the password to unlock it."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>If [ nodeLockTagGroup::orderOrLock &ne; "" and Get ( ActiveFieldName ) = "name" ]</li>
<li>//  Set Variable [ $$stopChangeSpellingOfTagCategory; Value:1 ]</li>
<li>Set Field [ ruleTagMenuGroups::name; ruleTagMenuGroups::nameSpelling ]</li>
<li>Go to Field [  ]</li>
<li>Show Custom Dialog [ Message: "This group name is locked.  Go the node that created it -- " &amp; nodeLockTestTagGroup::tag &amp; " -- and enter the password to unlock it."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>nodeLockTagMenus</em>::orderOrLock</li>
<li>
<em>tagMenus</em>::tagSpelling</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>nodeLockTagMenus</em>::tag</li>
<li>
<em>nodeLockTagGroup</em>::orderOrLock</li>
<li>
<em>ruleTagMenuGroups</em>::nameSpelling</li>
<li>
<em>ruleTagMenuGroups</em>::name</li>
<li>
<em>nodeLockTestTagGroup</em>::tag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33182ScriptAnchor_"></a><td class="script_navbar"><a href="#33231ScriptAnchor_"><span>Previous Script: [checkIfLockedOnLearnTagMenus]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33219ScriptAnchor_"><span>Next Script: [loadItemRecordForSampleTagMenu]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">menuReferenceNodesOrEditors</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Set citationLock to color menu button with inUse color.</li>
<li>If [ Get ( ActiveFieldName ) = "referenceNodes" ]</li>
<li>Set Variable [ $$citationMatch; Value:"referenceNodes" ]</li>
<li>Else If [ Get ( ActiveFieldName ) = "compilationEditors" ]</li>
<li>Set Variable [ $$citationMatch; Value:"editors" ]</li>
<li>Else If [ Get ( ActiveFieldName ) = "governmentAuthor" ]</li>
<li>Set Variable [ $$citationMatch; Value:"governmentAuthor" ]</li>
<li>End If</li>
<li>#</li>
<li>Refresh Window</li>
<li>Perform Script [ &ldquo;clearCitationMatch&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33014ScriptAnchor_">clearCitationMatch</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33219ScriptAnchor_"></a><td class="script_navbar"><a href="#33182ScriptAnchor_"><span>Previous Script: [menuReferenceNodesOrEditors]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33039ScriptAnchor_"><span>Next Script: [toggleTagMenuWindowView]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">loadItemRecordForSampleTagMenu</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33117ScriptAnchor_">menuSample</a></li>
<li><a href="#32980ScriptAnchor_">newCitationMenuGroup</a></li>
<li><a href="#33247ScriptAnchor_">duplicateTheory</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Capture recordID to conditionally format current record.</li>
<li>If [ $$stopLoadTagRecord &ne; 1 ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#The 'sample' variable may have more than one</li>
<li>#key in it.  So we need a variable with just this</li>
<li>#records keys in it to conditionally format all </li>
<li>#learn window records tagged with it.</li>
<li>Set Variable [ $$tagsample; Value:tagMenus::_Ltag ]</li>
<li>Set Field [ TEMP::kcsample; tagMenus::_Ltag ]</li>
<li>Set Variable [ $$SampleOrTestID; Value:Get (RecordID) ]</li>
<li>#</li>
<li>Set Variable [ $$stopLoadCitation; Value:1 ]</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>New Window [  ]</li>
<li>Move/Resize Window [ Current Window; Height: 3; Width: 3; Top: -1000; Left: -1000 ]</li>
<li>Go to Layout [ &ldquo;learn1&rdquo; (testlearn) ]</li>
<li>#Prepare system to stop error message about no</li>
<li>#records being found as the user may not have</li>
<li>#yet tagged any learn records with this test tag.</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection ]</li>
<li>Set Field [ testlearn::filterFind; "main" ]</li>
<li>Perform Find [  ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: testlearn::kcsample: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Variable [ $number; Value:1 ]</li>
<li>Loop</li>
<li>Exit Loop If [ (FilterValues ( Middle ( GetValue ( testlearn::kcsample ; 1 ) ; 4 ; 42 ) ; $$tagsample &amp; "&para;"  )  = $$tagsample  &amp; &para; 
or 
FilterValues ( Middle ( GetValue ( testlearn::kcsample ; 2 ) ; 4 ; 42 ) ; $$tagsample &amp; "&para;"  )  = $$tagsample &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kcsample ; 3 ) ; 4 ; 42 ) ; $$tagsample &amp; "&para;"  )  = $$tagsample &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kcsample ; 4 ) ; 4 ; 42 ) ; $$tagsample &amp; "&para;"  )  = $$tagsample &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kcsample ; 5 ) ; 4 ; 42 ) ; $$tagsample &amp; "&para;"  )  = $$tagsample &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kcsample ; 6 ) ; 4 ; 42 ) ; $$tagsample &amp; "&para;"  )  = $$tagsample &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kcsample ; 7 ) ; 4 ; 42 ) ; $$tagsample &amp; "&para;"  )  = $$tagsample &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kcsample ; 8 ) ; 4 ; 42 ) ; $$tagsample &amp; "&para;"  )  = $$tagsample &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kcsample ; 9 ) ; 4 ; 42 ) ; $$tagsample &amp; "&para;"  )  = $$tagsample &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kcsample ; 10 ) ; 4 ; 42 ) ; $$tagsample &amp; "&para;"  )  = $$tagsample &amp; &para;

) = 1 ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Set Variable [ $atLeastOneRecord; Value:If ( (FilterValues ( Middle ( GetValue ( testlearn::kcsample ; 1 ) ; 4 ; 42 ) ; $$tagsample &amp; "&para;"  )  = $$tagsample  &amp; &para; 
or 
FilterValues ( Middle ( GetValue ( testlearn::kcsample ; 2 ) ; 4 ; 42 ) ; $$tagsample &amp; "&para;"  )  = $$tagsample &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kcsample ; 3 ) ; 4 ; 42 ) ; $$tagsample &amp; "&para;"  )  = $$tagsample &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kcsample ; 4 ) ; 4 ; 42 ) ; $$tagsample &amp; "&para;"  )  = $$tagsample &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kcsample ; 5 ) ; 4 ; 42 ) ; $$tagsample &amp; "&para;"  )  = $$tagsample &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kcsample ; 6 ) ; 4 ; 42 ) ; $$tagsample &amp; "&para;"  )  = $$tagsample &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kcsample ; 7 ) ; 4 ; 42 ) ; $$tagsample &amp; "&para;"  )  = $$tagsample &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kcsample ; 8 ) ; 4 ; 42 ) ; $$tagsample &amp; "&para;"  )  = $$tagsample &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kcsample ; 9 ) ; 4 ; 42 ) ; $$tagsample &amp; "&para;"  )  = $$tagsample &amp; &para;
or 
FilterValues ( Middle ( GetValue ( testlearn::kcsample ; 10 ) ; 4 ; 42 ) ; $$tagsample &amp; "&para;"  )  = $$tagsample &amp; &para;

) = 1 ; 1 ; "" ) ]</li>
<li>Go to Layout [ original layout ]</li>
<li>Close Window [ Current Window ]</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>#</li>
<li>#This won't work without going through every</li>
<li>#record on the main window to check if it is tagged</li>
<li>#with this record, and that could take a really long</li>
<li>#time.</li>
<li>#So if there are no records tagged with this test item</li>
<li>#then make sure the Main window is sorted by</li>
<li>#date and not by test item sort order.</li>
<li>If [ $atLeastOneRecord &ne; 1 ]</li>
<li>#</li>
<li>#The 'sample' variable may have more than one</li>
<li>#key in it.  So we need a variable with just this</li>
<li>#records keys in it to conditionally format all </li>
<li>#learn window records tagged with it.</li>
<li>Set Variable [ $$tagsample; Value:tagMenus::_Ltag ]</li>
<li>#</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Refresh Window</li>
<li>Sort Records [ Specified Sort Order: testlearn::date; descending
testlearn::timestamp; descending ]
[ Restore; No dialog ]</li>
<li>Set Field [ TEMP::TLSampleSort; "" ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>Else If [ $atLeastOneRecord = 1 ]</li>
<li>#</li>
<li>#The 'sample' variable may have more than one</li>
<li>#key in it.  So we need a variable with just this</li>
<li>#records keys in it to conditionally format all </li>
<li>#learn window records tagged with it.</li>
<li>Set Variable [ $$tagsample; Value:tagMenus::_Ltag ]</li>
<li>Set Field [ TEMP::kcsample; tagMenus::_Ltag ]</li>
<li>Set Variable [ $$SampleOrTestID; Value:Get (RecordID) ]</li>
<li>If [ $$add = 1 and $$citationMatch = $$addCitationMatch ]</li>
<li>Else If [ $$add = "" ]</li>
<li>End If</li>
<li>Refresh Window</li>
<li>#</li>
<li>#Just in case user was in nonTag field on this</li>
<li>#window when user clicked a menu button on </li>
<li>#the other window, exit all  fields.</li>
<li>//  If [ TEMP::TLTestSort = "" ]</li>
<li>Set Field [ TEMP::TLSampleSort; "order" ]</li>
<li>Set Variable [ $recordNumber; Value:Get (RecordNumber) ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Perform Script [ &ldquo;sortTLRecordsByOrderNumber&rdquo; ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Go to Record/Request/Page [ $recordNumber ]
[ No dialog ]</li>
<li>Set Variable [ $$tagsample; Value:tagMenus::_Ltag ]</li>
<li>//  End If</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Go to Field [  ]</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>End If</li>
<li>#</li>
<li>#Unlike exit script, halt scripts will halt all scripts</li>
<li>#currently active.  So if user was on another tag</li>
<li>#record and then clicked on the add tag button</li>
<li>#to for another record, this script will launch.</li>
<li>#Problem is, because the user may want to really</li>
<li>#want to add this tag to the current item in the</li>
<li>#Learn window, after this script runs and finds</li>
<li>#zero records for example (which could happen)</li>
<li>#the add to tag script will run right after it, but</li>
<li>#it will fail to sort the records in the Learn window</li>
<li>#by order number, which this script </li>
<li>#(loadITemRecrodForTestTagMenu) is supposed</li>
<li>#do everytime.  The problem is a record for this</li>
<li>#tag record will exist after the addtotag script has</li>
<li>#run, but this script will not know that having run</li>
<li>#first.  So the user will be left wondering, "how is</li>
<li>#that everytime I click on a new test or sample tag</li>
<li>#record that has record tagged with it in the Learn </li>
<li>#window, the Learn window is sorted by order number</li>
<li>#except for this time?  How did this fail to happen?"</li>
<li>#Well, it failed for the reason given above and </li>
<li>#the sollution below is to use the 'Halt Script"</li>
<li>#command, which will force the user to click</li>
<li>#the add to tag button a second time to add the</li>
<li>#tag (the first time being when the user clicked</li>
<li>#it to move the system focus to this record, which</li>
<li>#triggered this loadItem... scirpt.</li>
<li>Halt Script</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>TEMP</em>::kcsample</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>testlearn</em>::kcsection</li>
<li>
<em>testlearn</em>::filterFind</li>
<li>
<em>testlearn</em>::kcsample</li>
<li>
<em>testlearn</em>::date</li>
<li>
<em>testlearn</em>::timestamp</li>
<li>
<em>TEMP</em>::TLSampleSort</li>
<li>
<em>TEMP</em>::TLTestSort</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33129ScriptAnchor_">sortTLRecordsByOrderNumber</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>learn1</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33039ScriptAnchor_"></a><td class="script_navbar"><a href="#33219ScriptAnchor_"><span>Previous Script: [loadItemRecordForSampleTagMenu]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#32983ScriptAnchor_"><span>Next Script: [TgotoCitationMenu]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">toggleTagMenuWindowView</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Reveal more or fewer pictures and links for tag.</li>
<li>#</li>
<li>#First toggle from current view to next view.</li>
<li>If [ Left (Get (LayoutName) ; 1) = "l" and $$citationMatch = "key" ]</li>
<li>#from 1 to 2</li>
<li>If [ Right ( Get (LayoutName)  ; 1) = 1
and 
Left ( TEMP::layoutLtagK ; 4 ) = "more" ]</li>
<li>Go to Layout [ &ldquo;ltagNK2&rdquo; (tagMenus) ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;ltagNKs2&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>#from 2 to 3</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 2
and 
Left ( TEMP::layoutLtagK ; 4 ) = "more" ]</li>
<li>Go to Layout [ &ldquo;ltagNK3&rdquo; (tagMenus) ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;ltagNKs3&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>#from 3 to 4</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 3
and 
Left ( TEMP::layoutLtagK ; 4 ) = "more" ]</li>
<li>Go to Layout [ &ldquo;ltagNK4&rdquo; (tagMenus) ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;ltagNKs4&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>#from 4 to 3</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 4
and 
Left ( TEMP::layoutLtagK ; 4 ) = "less" ]</li>
<li>Go to Layout [ &ldquo;ltagNK3&rdquo; (tagMenus) ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;ltagNKs3&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>#from 3 to 2</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 3
and 
Left ( TEMP::layoutLtagK ; 4 ) = "less" ]</li>
<li>Go to Layout [ &ldquo;ltagNK2&rdquo; (tagMenus) ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;ltagNKs2&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>#from 2 to 1</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 2
and 
Left ( TEMP::layoutLtagK ; 4 ) = "less" ]</li>
<li>Go to Layout [ &ldquo;ltagNK1&rdquo; (tagMenus) ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;ltagNKs1&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "l" and $$citationMatch = "node" ]</li>
<li>#from 1 to 2</li>
<li>If [ Right ( Get (LayoutName)  ; 1) = 1
and 
Left ( TEMP::layoutLtagN ; 4 ) = "more" ]</li>
<li>Go to Layout [ &ldquo;ltagNK2&rdquo; (tagMenus) ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;ltagNKs2&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>#from 2 to 3</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 2
and 
Left ( TEMP::layoutLtagN ; 4 ) = "more" ]</li>
<li>Go to Layout [ &ldquo;ltagNK3&rdquo; (tagMenus) ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;ltagNKs3&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>#from 3 to 4</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 3
and 
Left ( TEMP::layoutLtagN ; 4 ) = "more" ]</li>
<li>Go to Layout [ &ldquo;ltagNK4&rdquo; (tagMenus) ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;ltagNKs4&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>#from 4 to 3</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 4
and 
Left ( TEMP::layoutLtagN ; 4 ) = "less" ]</li>
<li>Go to Layout [ &ldquo;ltagNK3&rdquo; (tagMenus) ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;ltagNKs3&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>#from 3 to 2</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 3
and 
Left ( TEMP::layoutLtagN ; 4 ) = "less" ]</li>
<li>Go to Layout [ &ldquo;ltagNK2&rdquo; (tagMenus) ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;ltagNKs2&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>#from 2 to 1</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 2
and 
Left ( TEMP::layoutLtagN ; 4 ) = "less" ]</li>
<li>Go to Layout [ &ldquo;ltagNK1&rdquo; (tagMenus) ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;ltagNKs1&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "r" and $$citationMatch = "key" ]</li>
<li>#from 1 to 2</li>
<li>If [ Right ( Get (LayoutName)  ; 1) = 1
and 
Left ( TEMP::layoutRtagK ; 4 ) = "more" ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenu2SkeywordOrNode2&rdquo; (tagMenus) ]</li>
<li>Else</li>
<li>Go to Layout [ &ldquo;ReferenceMenu2keywordOrNode2&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>#from 2 to 3</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 2
and 
Left ( TEMP::layoutRtagK ; 4 ) = "more" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenu2keywordOrNode3&rdquo; (tagMenus) ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenu2SkeywordOrNode3&rdquo; (tagMenus) ]</li>
<li>Else</li>
<li>Go to Layout [ &ldquo;ReferenceMenu2keywordOrNode3&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>#from 3 to 2</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 3
and 
Left ( TEMP::layoutRtagK ; 4 ) = "less" ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenu2SkeywordOrNode2&rdquo; (tagMenus) ]</li>
<li>Else</li>
<li>Go to Layout [ &ldquo;ReferenceMenu2keywordOrNode2&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>#from 2 to 1</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 2
and 
Left ( TEMP::layoutRtagK ; 4 ) = "less" ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenu2SkeywordOrNode1&rdquo; (tagMenus) ]</li>
<li>Else</li>
<li>Go to Layout [ &ldquo;ReferenceMenu2keywordOrNode1&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "r" and $$citationMatch = "node" ]</li>
<li>#from 1 to 2</li>
<li>If [ Right ( Get (LayoutName)  ; 1) = 1
and 
Left ( TEMP::layoutRtagN ; 4 ) = "more" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenu2keywordOrNode2&rdquo; (tagMenus) ]</li>
<li>#from 2 to 3</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 2
and 
Left ( TEMP::layoutRtagN ; 4 ) = "more" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenu2keywordOrNode3&rdquo; (tagMenus) ]</li>
<li>#from 3 to 2</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 3
and 
Left ( TEMP::layoutRtagN ; 4 ) = "less" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenu2keywordOrNode2&rdquo; (tagMenus) ]</li>
<li>#from 2 to 1</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 2
and 
Left ( TEMP::layoutRtagN ; 4 ) = "less" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenu2keywordOrNode1&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>#</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "d" ]</li>
<li>#from 1 to 2</li>
<li>If [ Right ( Get (LayoutName)  ; 1) = 1
and 
Left ( TEMP::DefaultmoreORLessLayoutNode ; 4 ) = "more" ]</li>
<li>Go to Layout [ &ldquo;defaultNode2&rdquo; (tagMenus) ]</li>
<li>#from 2 to 3</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "d" 
and 
Right ( Get (LayoutName)  ; 1) = 2
and 
Left ( TEMP::DefaultmoreORLessLayoutNode ; 4 ) = "more" ]</li>
<li>Go to Layout [ &ldquo;defaultNode3&rdquo; (tagMenus) ]</li>
<li>#from 3 to 2</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "d" 
and 
Right ( Get (LayoutName)  ; 1) = 3
and 
Left ( TEMP::DefaultmoreORLessLayoutNode ; 4 ) = "less" ]</li>
<li>Go to Layout [ &ldquo;defaultNode2&rdquo; (tagMenus) ]</li>
<li>#from 2 to 1</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "d" 
and 
Right ( Get (LayoutName)  ; 1) = 2
and 
Left ( TEMP::DefaultmoreORLessLayoutNode ; 4 ) = "less" ]</li>
<li>Go to Layout [ &ldquo;defaultNode1&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#Remember layout user is on so they can be</li>
<li>#returned to correct view.</li>
<li>If [ $$citationMatch = "node" ]</li>
<li>If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>#</li>
<li>#from 1 to 2</li>
<li>If [ Right ( Get (LayoutName)  ; 1) = 2
and 
Left ( TEMP::layoutLtagN ; 4 ) = "more" ]</li>
<li>Set Field [ TEMP::layoutLtagN; "more" &amp; Get (LayoutName) ]</li>
<li>#from 2 to 3</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 3
and 
Left ( TEMP::layoutLtagN ; 4 ) = "more" ]</li>
<li>Set Field [ TEMP::layoutLtagN; "more" &amp; Get (LayoutName) ]</li>
<li>#from 3 to 4</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 4
and 
Left ( TEMP::layoutLtagN ; 4 ) = "more" ]</li>
<li>Set Field [ TEMP::layoutLtagN; "less" &amp; Get (LayoutName) ]</li>
<li>#from 4 to 3</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 3
and 
Left ( TEMP::layoutLtagN ; 4 ) = "less" ]</li>
<li>Set Field [ TEMP::layoutLtagN; "less" &amp; Get (LayoutName) ]</li>
<li>#from 3 to 2</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 2
and 
Left ( TEMP::layoutLtagN ; 4 ) = "less" ]</li>
<li>Set Field [ TEMP::layoutLtagN; "less" &amp; Get (LayoutName) ]</li>
<li>#from 2 to 1</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 1
and 
Left ( TEMP::layoutLtagN ; 4 ) = "less" ]</li>
<li>Set Field [ TEMP::layoutLtagN; "more" &amp; Get (LayoutName) ]</li>
<li>End If</li>
<li>#</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "r" ]</li>
<li>#</li>
<li>#from 1 to 2</li>
<li>If [ Right ( Get (LayoutName)  ; 1) = 2
and 
Left ( TEMP::layoutRtagN ; 4 ) = "more" ]</li>
<li>Set Field [ TEMP::layoutRtagN; "more" &amp; Get (LayoutName) ]</li>
<li>#from 2 to 3</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 3
and 
Left ( TEMP::layoutRtagN ; 4 ) = "more" ]</li>
<li>Set Field [ TEMP::layoutRtagN; "less" &amp; Get (LayoutName) ]</li>
<li>#from 3 to 2</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 2
and 
Left ( TEMP::layoutRtagN ; 4 ) = "less" ]</li>
<li>Set Field [ TEMP::layoutRtagN; "less" &amp; Get (LayoutName) ]</li>
<li>#from 2 to 1</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 1
and 
Left ( TEMP::layoutRtagN ; 4 ) = "less" ]</li>
<li>Set Field [ TEMP::layoutRtagN; "more" &amp; Get (LayoutName) ]</li>
<li>End If</li>
<li>#</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "d" ]</li>
<li>#from 1 to 2</li>
<li>If [ Right ( Get (LayoutName)  ; 1) = 2
and 
Left ( TEMP::DefaultmoreORLessLayoutNode ; 4 ) = "more" ]</li>
<li>Set Field [ TEMP::DefaultmoreORLessLayoutNode; "more" &amp; Get (LayoutName) ]</li>
<li>#from 2 to 3</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 3
and 
Left ( TEMP::DefaultmoreORLessLayoutNode ; 4 ) = "more" ]</li>
<li>Set Field [ TEMP::DefaultmoreORLessLayoutNode; "less" &amp; Get (LayoutName) ]</li>
<li>#from 3 to 2</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 2
and 
Left ( TEMP::DefaultmoreORLessLayoutNode ; 4 ) = "less" ]</li>
<li>Set Field [ TEMP::DefaultmoreORLessLayoutNode; "less" &amp; Get (LayoutName) ]</li>
<li>#from 2 to 1</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 1
and 
Left ( TEMP::DefaultmoreORLessLayoutNode ; 4 ) = "less" ]</li>
<li>Set Field [ TEMP::DefaultmoreORLessLayoutNode; "more" &amp; Get (LayoutName) ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>Else If [ $$citationMatch = "key" ]</li>
<li>If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>#</li>
<li>#from 1 to 2</li>
<li>If [ Right ( Get (LayoutName)  ; 1) = 2
and 
Left ( TEMP::layoutLtagK ; 4 ) = "more" ]</li>
<li>Set Field [ TEMP::layoutLtagK; "more" &amp; Get (LayoutName) ]</li>
<li>#from 2 to 3</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 3
and 
Left ( TEMP::layoutLtagK ; 4 ) = "more" ]</li>
<li>Set Field [ TEMP::layoutLtagK; "more" &amp; Get (LayoutName) ]</li>
<li>#from 3 to 4</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 4
and 
Left ( TEMP::layoutLtagK ; 4 ) = "more" ]</li>
<li>Set Field [ TEMP::layoutLtagK; "less" &amp; Get (LayoutName) ]</li>
<li>#from 4 to 3</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 3
and 
Left ( TEMP::layoutLtagK ; 4 ) = "less" ]</li>
<li>Set Field [ TEMP::layoutLtagK; "less" &amp; Get (LayoutName) ]</li>
<li>#from 3 to 2</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 2
and 
Left ( TEMP::layoutLtagK ; 4 ) = "less" ]</li>
<li>Set Field [ TEMP::layoutLtagK; "less" &amp; Get (LayoutName) ]</li>
<li>#from 2 to 1</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 1
and 
Left ( TEMP::layoutLtagK ; 4 ) = "less" ]</li>
<li>Set Field [ TEMP::layoutLtagK; "more" &amp; Get (LayoutName) ]</li>
<li>End If</li>
<li>#</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "r" ]</li>
<li>#</li>
<li>#from 1 to 2</li>
<li>If [ Right ( Get (LayoutName)  ; 1) = 2
and 
Left ( TEMP::layoutRtagK ; 4 ) = "more" ]</li>
<li>Set Field [ TEMP::layoutRtagK; "more" &amp; Get (LayoutName) ]</li>
<li>#from 2 to 3</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 3
and 
Left ( TEMP::layoutRtagK ; 4 ) = "more" ]</li>
<li>Set Field [ TEMP::layoutRtagK; "less" &amp; Get (LayoutName) ]</li>
<li>#from 3 to 2</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 2
and 
Left ( TEMP::layoutRtagK ; 4 ) = "less" ]</li>
<li>Set Field [ TEMP::layoutRtagK; "less" &amp; Get (LayoutName) ]</li>
<li>#from 2 to 1</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 1
and 
Left ( TEMP::layoutRtagK ; 4 ) = "less" ]</li>
<li>Set Field [ TEMP::layoutRtagK; "more" &amp; Get (LayoutName) ]</li>
<li>End If</li>
<li>#</li>
<li>End If</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::layoutLtagK</li>
<li>
<em>TEMP</em>::InventoryLibaryYN</li>
<li>
<em>TEMP</em>::layoutLtagN</li>
<li>
<em>TEMP</em>::layoutRtagK</li>
<li>
<em>TEMP</em>::layoutRtagN</li>
<li>
<em>TEMP</em>::DefaultmoreORLessLayoutNode</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>ltagNK2</li>
<li>ltagNKs2</li>
<li>ltagNK3</li>
<li>ltagNKs3</li>
<li>ltagNK4</li>
<li>ltagNKs4</li>
<li>ltagNK1</li>
<li>ltagNKs1</li>
<li>ReferenceMenu2SkeywordOrNode2</li>
<li>ReferenceMenu2keywordOrNode2</li>
<li>ReferenceMenu2keywordOrNode3</li>
<li>ReferenceMenu2SkeywordOrNode3</li>
<li>ReferenceMenu2SkeywordOrNode1</li>
<li>ReferenceMenu2keywordOrNode1</li>
<li>defaultNode2</li>
<li>defaultNode3</li>
<li>defaultNode1</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32983ScriptAnchor_"></a><td class="script_navbar"><a href="#33039ScriptAnchor_"><span>Previous Script: [toggleTagMenuWindowView]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#32864ScriptAnchor_"><span>Next Script: [showTag]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">TgotoCitationMenu</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32984ScriptAnchor_">loadCitation</a></li>
<li><a href="#33280ScriptAnchor_">loadCitation OLD</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ Get ( ActiveFieldContents ) = "" ]</li>
<li>Go to Field [  ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>If [ $$add = 1 and Get ( ActiveFieldName ) = "kcitation" or $$add = 1 and Get ( ActiveFieldName ) = "kcReference" ]</li>
<li>Go to Field [  ]</li>
<li>Show Custom Dialog [ Message: "Learn records with references or a citation cannot be added to tags.  Doing so would require adding all these reference and cite records' references and cite records, and then all of theirs, and so on.  "; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>//  If [ TEMP::ksection &amp; "&para;"  &ne;  FilterValues ( reference::kcsection ; TEMP::ksection &amp; "&para;" ) ]</li>
<li>//  Go to Field [  ]</li>
<li>//  Show Custom Dialog [ Message: "This reference belongs to the " &amp; ruleRefLibraryName::name &amp; " section." &amp; " You can add pictures and links from any reference record to any tag, but you can only add tags to the current default section's records (name shown top left)."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>//  Exit Script [  ]</li>
<li>//  End If</li>
<li>If [ $$findMode &ne; "" ]</li>
<li>Go to Field [  ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>#</li>
<li>#Conditionally format selected item and button on menu screen.</li>
<li>Set Variable [ $$citationItem; Value:Get (ActiveFieldContents) ]</li>
<li>Set Variable [ $$citationMatch; Value:Get (ActiveFieldName) ]</li>
<li>If [ $$citationMatch = "referenceShort" ]</li>
<li>Set Variable [ $$citationMatch; Value:"kcitation" ]</li>
<li>Set Variable [ $$citationItem; Value:refReference::_Lreference ]</li>
<li>End If</li>
<li>If [ Left (Get (ActiveFieldName); 4) = "kkey"  or Get (ActiveFieldName)  = "" ]</li>
<li>Set Variable [ $$citationMatch; Value:"key" ]</li>
<li>Else If [ Left (Get (ActiveFieldName); 5) = "knode" ]</li>
<li>Set Variable [ $$citationMatch; Value:"node" ]</li>
<li>End If</li>
<li>Refresh Window</li>
<li>#</li>
<li>#Exit field so blinking cursor doesn't show up in empty field.</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $window; Value:Get (WindowName) ]</li>
<li>#</li>
<li>#goto Tag Menus window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>If [ Get (LastError)  = 112 ]</li>
<li>New Window [ Name: "Tag Menus"; Height: Get (ScreenHeight); Width: Get (ScreenWidth) / 2; Top: 0; Left: Get (ScreenWidth) / 2 ]</li>
<li>End If</li>
<li>#</li>
<li>#set citationMatch to color menu button with inUse color.</li>
<li>If [ $window = "Learn" ]</li>
<li>If [ $$citationMatch = "kfolderpath" ]</li>
<li>Go to Layout [ &ldquo;learnMenu1&rdquo; (tagMenus) ]</li>
<li>Perform Script [ &ldquo;menuPath&rdquo; ]</li>
<li>Else If [ $$citationMatch = "kmedium" ]</li>
<li>Set Variable [ $$medium; Value:reference::kmedium ]</li>
<li>Go to Layout [ &ldquo;learnMenu1&rdquo; (tagMenus) ]</li>
<li>Perform Script [ &ldquo;menuMedium&rdquo; ]</li>
<li>Else If [ $$citationMatch = "khealth" ]</li>
<li>Go to Layout [ &ldquo;learnMenuHealth&rdquo; (tagMenus) ]</li>
<li>Perform Script [ &ldquo;menuHealth&rdquo; ]</li>
<li>Else If [ $$citationMatch = "key" ]</li>
<li>Go to Layout [ &ldquo;ltagNK2&rdquo; (tagMenus) ]</li>
<li>Perform Script [ &ldquo;menuKey&rdquo; ]</li>
<li>Else If [ $$citationMatch = "node" ]</li>
<li>Go to Layout [ &ldquo;ltagNK2&rdquo; (tagMenus) ]</li>
<li>Perform Script [ &ldquo;menuNode&rdquo; ]</li>
<li>Else If [ $$citationMatch = "kcitation" ]</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;learnMenuRefStuff&rdquo; (reference) ]</li>
<li>Perform Script [ &ldquo;externalReferences&rdquo; ]</li>
<li>Else</li>
<li>Go to Layout [ &ldquo;learnMenu3Cite&rdquo; (reference) ]</li>
<li>Perform Script [ &ldquo;menuCitation&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>#Go to citation record's current selection or to first record.</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ FilterValues ( $$citationItem ; reference::_Lreference )  =   reference::_Lreference &amp; &para; ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>If [ FilterValues ( $$citationItem ; reference::_Lreference )  &ne;  reference::_Lreference &amp; &para; ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>End If</li>
<li>Set Variable [ $$citationMatch; Value:"ref" ]</li>
<li>Refresh Window</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Refresh Window</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>Else If [ $window = "References" or $window = "Setup" ]</li>
<li>#</li>
<li>#If in add mode, prevent menu scripts from changing</li>
<li>#the main window's set of records.</li>
<li>#Unlike learn records, reference records or created</li>
<li>#for specific uses such as providing a picture</li>
<li>#or link for a specific set of tags, say keyword tags.</li>
<li>#So, in add mode, when clicking on a menu item</li>
<li>#the system finds all the records in the main</li>
<li>#reference window for that menu item.  This </li>
<li>#is not helpful when the user is trying to create </li>
<li>#a new record to add to a tag.  So this next script</li>
<li>#step stops the records shown, including and most</li>
<li>#importantly the record the user is working on</li>
<li>#from disappearing when the system finds only</li>
<li>#records assigned to that menu item.  This then</li>
<li>#allows the user to add tags to the item neccessary</li>
<li>#to make it addable to the the tag menu item the</li>
<li>#user is creating it for!</li>
<li>If [ $$add = 1 ]</li>
<li>Set Variable [ $$add; Value:2 ]</li>
<li>End If</li>
<li>#</li>
<li>If [ $$citationMatch = "kfolderpath" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenu1&rdquo; (tagMenus) ]</li>
<li>Perform Script [ &ldquo;menuPath&rdquo; ]</li>
<li>Else If [ $$citationMatch = "kmedium" ]</li>
<li>Set Variable [ $$medium; Value:reference::kmedium ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenu1&rdquo; (tagMenus) ]</li>
<li>Perform Script [ &ldquo;menuMedium&rdquo; ]</li>
<li>Else If [ $$citationMatch = "khealth" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenuHealth&rdquo; (tagMenus) ]</li>
<li>Perform Script [ &ldquo;menuHealth&rdquo; ]</li>
<li>Else If [ $$citationMatch = "korgan" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenu1&rdquo; (tagMenus) ]</li>
<li>Perform Script [ &ldquo;menuOrgan&rdquo; ]</li>
<li>Else If [ $$citationMatch = "kcopyist" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenu1&rdquo; (tagMenus) ]</li>
<li>Perform Script [ &ldquo;menuCopyist&rdquo; ]</li>
<li>Else If [ $$citationMatch = "key" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenu2keywordOrNode1&rdquo; (tagMenus) ]</li>
<li>Perform Script [ &ldquo;menuKey&rdquo; ]</li>
<li>Else If [ $$citationMatch = "node" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenu2keywordOrNode1&rdquo; (tagMenus) ]</li>
<li>Perform Script [ &ldquo;menuNode&rdquo; ]</li>
<li>Else If [ $$citationMatch = "kcitation" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenu3Cite&rdquo; (reference) ]</li>
<li>Perform Script [ &ldquo;menuRefAddKeyWords&rdquo; ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>#</li>
<li>#If in add mode, allow menu scripts to once again</li>
<li>#change main window records.</li>
<li>If [ $$add = 2 ]</li>
<li>Set Variable [ $$add; Value:1 ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>reference</em>::kcsection</li>
<li>
<em>ruleRefLibraryName</em>::name</li>
<li>
<em>refReference</em>::_Lreference</li>
<li>
<em>reference</em>::kmedium</li>
<li>
<em>TEMP</em>::InventoryLibaryYN</li>
<li>
<em>reference</em>::_Lreference</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32991ScriptAnchor_">menuPath</a></li>
<li><a href="#32989ScriptAnchor_">menuMedium</a></li>
<li><a href="#33013ScriptAnchor_">menuHealth</a></li>
<li><a href="#32993ScriptAnchor_">menuKey</a></li>
<li><a href="#32988ScriptAnchor_">menuNode</a></li>
<li><a href="#33085ScriptAnchor_">externalReferences</a></li>
<li><a href="#33295ScriptAnchor_">menuCitation</a></li>
<li><a href="#33012ScriptAnchor_">menuOrgan</a></li>
<li><a href="#33004ScriptAnchor_">menuCopyist</a></li>
<li><a href="#33042ScriptAnchor_">menuRefAddKeyWords</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>learnMenu1</li>
<li>learnMenuHealth</li>
<li>ltagNK2</li>
<li>learnMenuRefStuff</li>
<li>learnMenu3Cite</li>
<li>ReferenceMenu1</li>
<li>ReferenceMenuHealth</li>
<li>ReferenceMenu2keywordOrNode1</li>
<li>ReferenceMenu3Cite</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32864ScriptAnchor_"></a><td class="script_navbar"><a href="#32983ScriptAnchor_"><span>Previous Script: [TgotoCitationMenu]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33247ScriptAnchor_"><span>Next Script: [duplicateTheory]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">showTag</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Commit Records/Requests</li>
<li>If [ TEMP::kfocus = "" ]</li>
<li>Set Field [ TEMP::LocationName; "" ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#the pulldown menu action selects the id number, </li>
<li>#but not the name.  To put the name into the TEMP </li>
<li>#global field we will need to find it which is what the </li>
<li>#rest of the script does.</li>
<li>Set Variable [ $tag; Value:TEMP::kfocus ]</li>
<li>Go to Layout [ &ldquo;tableTag&rdquo; (tagTable) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTable::_Ltag; $tag ]</li>
<li>Perform Find [  ]</li>
<li>Set Variable [ $name; Value:tagTable::tag ]</li>
<li>Go to Layout [ original layout ]</li>
<li>Set Field [ TEMP::LocationName; $name ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>//  #Tells user to select an order number not in use</li>
<li>//  #if the order field is blank.</li>
<li>//  If [ TEMP::orderLocation = "" ]</li>
<li>//  Show Custom Dialog [ Message: "Order number required.  It can be used to place location before or after any modifiers: small location or location upstairs for example."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>//  Go to Field [ TEMP::orderLocation ]</li>
<li>//  End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::kfocus</li>
<li>
<em>TEMP</em>::LocationName</li>
<li>
<em>tagTable</em>::_Ltag</li>
<li>
<em>tagTable</em>::tag</li>
<li>
<em>TEMP</em>::orderLocation</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>tableTag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33247ScriptAnchor_"></a><td class="script_navbar"><a href="#32864ScriptAnchor_"><span>Previous Script: [showTag]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#32987ScriptAnchor_"><span>Next Script: [addTagToMainRecord]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">duplicateTheory</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If node is currenlty locked then stop script, inform user.</li>
<li>If [ TEMP::nodeLock &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "The default node selected is locked.  Select this node in the setup window and enter the password to unlock it, then you will able to create new records assigned to this node."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>If [ tempSetup::kdefaultNodePrimary = "" ]</li>
<li>Show Custom Dialog [ Message: "Select yourself (the node responsible) from Tag Menus window."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ Get (FoundCount)  = 0 ]</li>
<li>Perform Script [ &ldquo;newCitationMenuGroup&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Duplicate name and copyright of old theory.</li>
<li>Set Variable [ $theoryName; Value:tagMenus::tag &amp; " " &amp; tagMenus::_Ltag ]</li>
<li>Set Variable [ $theoryHealth; Value:tagMenus::notesOrHealth ]</li>
<li>#</li>
<li>#Prepare to find old tags at bottom of script.</li>
<li>Set Variable [ $theoryOld; Value:tagMenus::_Ltag ]</li>
<li>#</li>
<li>#Stop spelling check script.</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>New Record/Request</li>
<li>Set Field [ tagMenus::kGroupOrTest; GetNthRecord ( tagMenus::kGroupOrTest ; Get (RecordNumber) - 1 ) ]</li>
<li>Set Field [ tagMenus::kRecordCreatorNode; TEMP::kdefaultNodePrimary ]</li>
<li>Set Field [ tagMenus::tag; $theoryName ]</li>
<li>Set Field [ tagMenus::tagSpelling; $theoryName ]</li>
<li>Set Field [ tagMenus::notesOrHealth; $theoryHealth ]</li>
<li>#</li>
<li>#Prepare to add new theory key to old theories points</li>
<li>#and evidence records.</li>
<li>Set Variable [ $theoryNew; Value:tagMenus::_Ltag ]</li>
<li>Set Field [ tagMenus::match; "sample" ]</li>
<li>Go to Object [ Object Name: "tag" ]</li>
<li>#</li>
<li>#Go to the other window and start the find process.</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection ]</li>
<li>Set Field [ testlearn::kcsample; "*" &amp; $theoryOld &amp; &para; ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Add new theory key to old theories points and evidence.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Variable [ $allPointsEvidence; Value:testlearn::kcsample ]</li>
<li>Set Field [ testlearn::kcsample; testlearn::orderTest &amp; $theoryNew &amp; &para; &amp; $allPointsEvidence ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Refind all section records.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection ]</li>
<li>Perform Find [  ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ testlearn::_Ltestlearn = $$citationRecord ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>#</li>
<li>#Load new theory.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>Perform Script [ &ldquo;loadItemRecordForSampleTagMenu&rdquo; ]</li>
<li>Show Custom Dialog [ Message: "Change the tag ID number to the current verson number (v2, v3, v4, etc.) of this theory."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::nodeLock</li>
<li>
<em>tempSetup</em>::kdefaultNodePrimary</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>tagMenus</em>::notesOrHealth</li>
<li>
<em>tagMenus</em>::kGroupOrTest</li>
<li>
<em>TEMP</em>::kdefaultNodePrimary</li>
<li>
<em>tagMenus</em>::kRecordCreatorNode</li>
<li>
<em>tagMenus</em>::tagSpelling</li>
<li>
<em>tagMenus</em>::match</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>testlearn</em>::kcsection</li>
<li>
<em>testlearn</em>::kcsample</li>
<li>
<em>testlearn</em>::orderTest</li>
<li>
<em>testlearn</em>::_Ltestlearn</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32980ScriptAnchor_">newCitationMenuGroup</a></li>
<li><a href="#33219ScriptAnchor_">loadItemRecordForSampleTagMenu</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32987ScriptAnchor_"></a><td class="script_navbar"><a href="#33247ScriptAnchor_"><span>Previous Script: [duplicateTheory]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33201ScriptAnchor_"><span>Next Script: [setDefaultSection]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">addTagToMainRecord</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33236ScriptAnchor_">createEmptyLibrary</a></li>
<li><a href="#33095ScriptAnchor_">gotoDefaultsOrReport</a></li>
<li><a href="#33066ScriptAnchor_">addORremoveRefTagStep1</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>#</li>
<li>//  #Due to the fact that users click the add tag button </li>
<li>//  #when they want to find records tagged with a tag, </li>
<li>//  #I'm making it so that users can only add tags in edit mode.</li>
<li>//  If [ Left (Get (LayoutName) ; 3 ) = "ref" and $$stopAdd &ne; 1 ]</li>
<li>//  Show Custom Dialog [ Message: "Click the edit button in the References window (but not in Learn window) to add/change tags.  This inconvience was put in place because users kept forgetting to click find before click the P or O buttons."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>//  Exit Script [  ]</li>
<li>//  End If</li>
<li>#</li>
<li>//  #Because I keep forgetting to press find mode, this</li>
<li>//  #bit of script is to confirm that the user really wants</li>
<li>//  #to add or change the tag of the first record instead of</li>
<li>//  #finding records with selected tag.</li>
<li>//  If [ $$referenceRecordOne = 1 ]</li>
<li>//  Show Custom Dialog [ Message: "Did you mean to ADD this tag to the first record or FIND reference records with this tag?"; Buttons: &ldquo;ADD&rdquo;, &ldquo;FIND&rdquo;, &ldquo;Cancel&rdquo; ]</li>
<li>//  If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>//  #This variable is needed becasue message choice 2</li>
<li>//  #gets carried over to the Find Mode Script, which then</li>
<li>//  #activates tag instead of reference record find mode.</li>
<li>//  Set Variable [ $$ClearMessageChoice; Value:1 ]</li>
<li>//  Perform Script [ &ldquo;findMode&rdquo; ]</li>
<li>//  Else If [ Get ( LastMessageChoice ) = 3 ]</li>
<li>//  Set Variable [ $$referenceRecordOne ]</li>
<li>//  Exit Script [  ]</li>
<li>//  Else If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>//  Set Variable [ $$referenceRecordOne ]</li>
<li>//  End If</li>
<li>//  End If</li>
<li>#</li>
<li>#</li>
<li>#This script adds tags to main reference or learn </li>
<li>#primary tag fields, and a chunk of it adds section </li>
<li>#keys found in the learn or reference record to </li>
<li>#the keyword or node tag group of the tag just </li>
<li>#added, to insure that this tag shows up in every </li>
<li>#section in which the record it tagged shows up.   </li>
<li>#There may be sections where this keyword or </li>
<li>#node tag shows up, and this newly tagged </li>
<li>#reference or learn record does not, which is OK.  </li>
<li>#Reference and learn records do not require all </li>
<li>#the section keys the added tag has.  
</li>
<li>#</li>
<li>#NOTE: Most of these tags except keyword and node </li>
<li>#tags are universal, and so there are no section keys </li>
<li>#to add to them.  In the case of sample and test </li>
<li>#tags, because these tags are section specific, there </li>
<li>#is no reason to add keys from other sections to </li>
<li>#them.  </li>
<li>#</li>
<li>If [ $$stopAddTagToCitation = 1 ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Stop script if user is looking at item/detail tags</li>
<li>#in add mode, as these tags cannot be applied </li>
<li>#to reference records.</li>
<li>If [ $$add = 1 and $$citationMatch = "testSetup" ]</li>
<li>Show Custom Dialog [ Message: "You cannot tag reference records with item tags.  So why then are there buttons?  The buttons show up because I have not made time to create a separate layout just for item tags.  This issue has been logged as a minor irritation."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>//  #Stop script if user trying to add reference or learn record</li>
<li>//  #that has references or citations added to it.</li>
<li>//  #In the future this will be possible, but for now I need</li>
<li>//  #to focus on other things to get the beta released.</li>
<li>//  If [ reference::_Lreference  &ne;  $$cite ]</li>
<li>//  If [ testlearn::kcitation &ne; "" or testlearn::kcreference &ne; "" or reference::kcitation &ne; "" ]</li>
<li>//  Show Custom Dialog [ Message: "For now, you cannot use a record that has its own citation or references added to it as a citation or reference for another record.  This is a known issue, and in a future release it will be resolved.   "; Buttons: &ldquo;OK&rdquo; ]</li>
<li>//  Exit Script [  ]</li>
<li>//  End If</li>
<li>//  End If</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#If reference or learn record that tag was added</li>
<li>#to belongs to more than one section, then </li>
<li>#add these other sections to the tag's group </li>
<li>#keychain so when this tag record is viewed in </li>
<li>#those sections, the reference or learn record </li>
<li>#just added to it will show up as well.</li>
<li>If [ Get ( LayoutTableName ) = "testlearn"  or Get ( LayoutTableName ) = "reference" ]</li>
<li>Perform Script [ &ldquo;CHUNKaddMainRecordSectionKeysToCiteOrRefSectionKeychain&rdquo; ]</li>
<li>#</li>
<li>#Check main checkbox if record is not already</li>
<li>#a main record.  This is because when going to</li>
<li>#edit cite or reference records, only main records</li>
<li>#are shown by default.</li>
<li>If [ "main" &amp; &para; &ne; FilterValues ( testlearn::filterFind ; "main" &amp; &para; ) and Get ( LayoutTableName ) = "testlearn" ]</li>
<li>Set Variable [ $filterFind; Value:testlearn::filterFind ]</li>
<li>Set Field [ testlearn::filterFind; "main" &amp; &para; &amp; $filterFind ]</li>
<li>Else If [ "main" &amp; &para; &ne; FilterValues ( reference::filterFind ; "main" &amp; &para; ) and Get ( LayoutTableName ) = "reference" ]</li>
<li>Set Variable [ $filterFind; Value:reference::filterFind ]</li>
<li>Set Field [ reference::filterFind; "main" &amp; &para; &amp; $filterFind ]</li>
<li>End If</li>
<li>#</li>
<li>Else If [ 1 = 1 ]</li>
<li>Perform Script [ &ldquo;CHUNKaddMainSectionKeysToTagRecordKeychain&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>#Set variable to note table name in case tag is from</li>
<li>#testLearn table, in which case an 'L' will need to be</li>
<li>#added to the tag to conditionally format the buttons</li>
<li>#for Learn Ref and Learn citations in the Tag Menus window.</li>
<li>Set Variable [ $tableName; Value:Get ( LayoutTableName ) ]</li>
<li>#</li>
<li>#</li>
<li>#Get key for tag that is to be added to record.</li>
<li>If [ Right ( Get (LayoutName) ; 4 )  = "test" ]</li>
<li>Set Variable [ $tag; Value:test::_Ltest ]</li>
<li>Set Variable [ $tagName; Value:ruleSection::name ]</li>
<li>Else If [ Right ( Get (LayoutName) ; 5 ) = "3cite" ]</li>
<li>Set Variable [ $tag; Value:reference::_Lreference ]</li>
<li>Else If [ Right ( Get (LayoutName) ; 7 ) = "refcite" ]</li>
<li>Set Variable [ $tag; Value:testlearn::_Ltestlearn ]</li>
<li>Else If [ Right ( Get (LayoutName) ; 8 ) = "sections" ]</li>
<li>Set Variable [ $tag; Value:ruleSection::_Lgroup ]</li>
<li>Set Variable [ $tagName; Value:ruleSection::name ]</li>
<li>#</li>
<li>#Stop check spelling script as this script is triggered</li>
<li>#on section layout by record load trigger, and</li>
<li>#so before user can change the spelling.</li>
<li>Set Variable [ $$stopChangeSectionName; Value:1 ]</li>
<li>Else If [ Right ( Get (LayoutName) ; 4 ) &ne; "cite" ]</li>
<li>Set Variable [ $tag; Value:tagMenus::_Ltag ]</li>
<li>Set Variable [ $lock; Value:tagMenus::orderOrLock ]</li>
<li>End If</li>
<li>#</li>
<li>#Remove focus from field so can see </li>
<li>#conditional formatting.</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#If removing a discovery record, the database</li>
<li>#will jump to the next records tag menu selection.</li>
<li>#So to keep the users focus on the tag they orginally</li>
<li>#selected, the system must record this record's</li>
<li>#number now.  This will be be used below</li>
<li>#for test records only.</li>
<li>Set Variable [ $recordNumber; Value:Get (RecordNumber) ]</li>
<li>#</li>
<li>#Conditionally format selected tag.</li>
<li>If [ Right ( Get (LayoutName) ; 4 ) &ne; "cite" ]</li>
<li>Set Variable [ $$citationItem; Value:tagMenus::_Ltag ]</li>
<li>Else If [ Right ( Get (LayoutName) ; 5 ) = "3cite" ]</li>
<li>Set Variable [ $$citationItem; Value:reference::_Lreference ]</li>
<li>Set Variable [ $citeHealth; Value:reference::kHealth ]</li>
<li>Set Variable [ $citeCopyrightDate; Value:reference::CopyrightYear ]</li>
<li>Set Variable [ $citekeywordOther; Value:reference::kkeywordOther ]</li>
<li>Set Variable [ $citekeywordOtherWords; Value:reference::OtherKeyWords ]</li>
<li>Set Variable [ $citekeywordPrimary; Value:reference::kkeywordPrimary ]</li>
<li>#</li>
<li>Set Variable [ $filename; Value:reference::fileName ]</li>
<li>Set Variable [ $fileLocation; Value:reference::kfileLocation ]</li>
<li>Set Variable [ $folderpath; Value:reference::kfolderpath ]</li>
<li>Set Variable [ $medium; Value:reference::kmedium ]</li>
<li>Set Variable [ $URL; Value:reference::URL ]</li>
<li>Set Variable [ $URLdate; Value:reference::URLdate ]</li>
<li>Else If [ Right ( Get (LayoutName) ; 7 ) = "refcite" ]</li>
<li>Set Variable [ $$citationItem; Value:testlearn::_Ltestlearn ]</li>
<li>Set Variable [ $citeHealth; Value:testlearn::kHealth ]</li>
<li>Set Variable [ $citeCopyrightDate; Value:testlearn::copyrightYear ]</li>
<li>Set Variable [ $citekeywordOther; Value:testlearn::kcKeywordOther ]</li>
<li>Set Variable [ $citekeywordOtherWords; Value:testlearn::OtherKeyWords ]</li>
<li>Set Variable [ $citekeywordPrimary; Value:testlearn::kKeywordPrimary ]</li>
<li>End If</li>
<li>#</li>
<li>//  New Window [ Name: "Add Tag" ]</li>
<li>#</li>
<li>#Select reference, learn, or setup window.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>#</li>
<li>#Check which tag user is looking at and then...</li>
<li>If [ $$citationMatch = "node" ]</li>
<li>#</li>
<li>#If primary node is in use, then remove it.</li>
<li>If [ tempSetup::kdefaultNodePrimary = $tag ]</li>
<li>Set Field [ tempSetup::kdefaultNodePrimary; "" ]</li>
<li>Set Field [ tempSetup::DEFAULTNodePrimaryName; "" ]</li>
<li>#</li>
<li>#Finish removing the key.</li>
<li>Set Variable [ $$citationItem ]</li>
<li>Set Variable [ $$PrimaryNode ]</li>
<li>#</li>
<li>#If primary node is not in use add it and set</li>
<li>#variables to see if it was in the other node</li>
<li>#field so it can be removed from there thus </li>
<li>#preventing the same node showing up twice.</li>
<li>Else If [ tempSetup::kdefaultNodePrimary &ne; $tag ]</li>
<li>Set Field [ tempSetup::kdefaultNodePrimary; $tag ]</li>
<li>Set Field [ tempSetup::nodeLock; $lock ]</li>
<li>Set Field [ tempSetup::DEFAULTNodePrimaryName; tagDefaultNodePrimary::tag ]</li>
<li>Set Variable [ $$node; Value:tempSetup::kdefaultNodeOther ]</li>
<li>Set Field [ tempSetup::kdefaultNodeOther; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used

If ( ValueCount ( $$node ) &ne; ValueCount ( Substitute ( $$node ; $$citationItem &amp; "&para;"  ; "" ) ) ; 

Substitute ( $$node ; $$citationItem &amp; "&para;"  ; "" ) ; 

Substitute ( $$node ; $$citationItem ; "" ) 

) ]</li>
<li>Set Variable [ $$PrimaryNode; Value:testlearn::kNodePrimary ]</li>
<li>Set Variable [ $$node; Value:tempSetup::kdefaultNodeOther ]</li>
<li>Set Variable [ $$skipFirstPartOfScript; Value:1 ]</li>
<li>#</li>
<li>#Record must be committed if user decides to </li>
<li>#perform a script on it right after this one or</li>
<li>#perform a find requiring the newly added key.</li>
<li>Commit Records/Requests</li>
<li>Perform Script [ &ldquo;addORremoveTagFromCitationStep2node&rdquo; ]</li>
<li>Close Window [ Name: "reorder"; Current file ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>Else If [ $$citationMatch = "health" ]</li>
<li>If [ tempSetup::kdefaultHealth = $tag ]</li>
<li>Set Field [ tempSetup::kdefaultHealth; "" ]</li>
<li>Set Variable [ $$citationItem ]</li>
<li>Set Variable [ $$health ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#goto Tag Menus window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>Exit Script [  ]</li>
<li>Else If [ testlearn::kHealth &ne; $tag ]</li>
<li>Set Variable [ $$health; Value:tempSetup::kdefaultHealth ]</li>
<li>Set Field [ tempSetup::kdefaultHealth; $tag ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#goto Tag Menus window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Since sections are required, the deselect script</li>
<li>#steps are not needed.  When the user clicks on</li>
<li>#a new record on the section layout this script</li>
<li>#is triggered and that section set as the default</li>
<li>#section.</li>
<li>Else If [ $$citationMatch = "section" ]</li>
<li>Set Field [ tempSetup::ksection; $tag ]</li>
<li>Set Field [ tempSetup::sectionName; $tagName ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#goto Tag Menus window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#Allow duplicate tag check script to operate.</li>
<li>Set Variable [ $$stopChangeSectionName ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>End If</li>
<li>#</li>
<li>#Record must be committed if user decides to </li>
<li>#perform a script on it right after this one or</li>
<li>#perform a find requiring the newly added key.</li>
<li>Commit Records/Requests</li>
<li>#</li>
<li>#Refresh the windows so changed conditional formatting</li>
<li>#will show up.</li>
<li>Refresh Window</li>
<li>#</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#Check which tag user is looking at and then...</li>
<li>If [ $$citationMatch = "node" ]</li>
<li>#</li>
<li>#If primary node is in use, then remove it.</li>
<li>If [ testlearn::kNodePrimary = $tag ]</li>
<li>Set Field [ testlearn::kNodePrimary; "" ]</li>
<li>#</li>
<li>#Finish removing the key.</li>
<li>Set Variable [ $$citationItem ]</li>
<li>Set Variable [ $$PrimaryNode ]</li>
<li>#</li>
<li>#If primary node is not in use add it and set</li>
<li>#variables to see if it was in the other node</li>
<li>#field so it can be removed from there thus </li>
<li>#preventing the same node showing up twice.</li>
<li>Else If [ testlearn::kNodePrimary &ne; $tag ]</li>
<li>Set Field [ testlearn::kNodePrimary; $tag ]</li>
<li>Set Field [ testlearn::kNodeOther; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used

If ( ValueCount ( $$node ) &ne; ValueCount ( Substitute ( $$node ; $$citationItem &amp; "&para;"  ; "" ) ) ; 

Substitute ( $$node ; $$citationItem &amp; "&para;"  ; "" ) ; 

Substitute ( $$node ; $$citationItem ; "" ) 

) ]</li>
<li>Set Variable [ $$node; Value:testlearn::kNodeOther ]</li>
<li>Set Variable [ $$PrimaryNode; Value:testlearn::kNodePrimary ]</li>
<li>Set Variable [ $$skipFirstPartOfScript; Value:1 ]</li>
<li>#</li>
<li>#Record must be committed if user decides to </li>
<li>#perform a script on it right after this one or</li>
<li>#perform a find requiring the newly added key.</li>
<li>Commit Records/Requests</li>
<li>Perform Script [ &ldquo;addORremoveTagFromCitationStep2node&rdquo; ]</li>
<li>Close Window [ Name: "reorder"; Current file ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>Else If [ $$citationMatch = "medium" ]</li>
<li>If [ testlearn::kmedium = $tag ]</li>
<li>Set Field [ testlearn::kmedium; "" ]</li>
<li>Set Variable [ $$citationItem ]</li>
<li>Set Variable [ $$medium ]</li>
<li>Else If [ testlearn::kmedium &ne; $tag ]</li>
<li>Set Field [ testlearn::kmedium; $tag ]</li>
<li>Set Variable [ $$medium; Value:$tag ]</li>
<li>End If</li>
<li>#</li>
<li>Else If [ $$citationMatch = "ref" ]</li>
<li>If [ testlearn::kcreference= $tag ]</li>
<li>Set Field [ testlearn::kcreference; "" ]</li>
<li>Set Variable [ $$citationItem ]</li>
<li>Set Variable [ $$ref ]</li>
<li>Else If [ testlearn::kcreference &ne; $tag ]</li>
<li>Set Field [ testlearn::kcreference; $tag ]</li>
<li>Set Variable [ $$ref; Value:testlearn::kcreference ]</li>
<li>Perform Script [ &ldquo;CHUNKaddReferenceNodesAndKeywords&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>Else If [ $$citationMatch = "health" ]</li>
<li>If [ testlearn::kHealth = $tag ]</li>
<li>Set Field [ testlearn::kHealth; "" ]</li>
<li>Set Variable [ $$citationItem ]</li>
<li>Set Variable [ $$health ]</li>
<li>Else If [ testlearn::kHealth &ne; $tag ]</li>
<li>Set Field [ testlearn::kHealth; $tag ]</li>
<li>Set Variable [ $$health; Value:testlearn::kHealth ]</li>
<li>End If</li>
<li>#</li>
<li>Else If [ $$citationMatch = "path" ]</li>
<li>If [ testlearn::kfolderPath = $tag ]</li>
<li>Set Field [ testlearn::kfolderPath; "" ]</li>
<li>Set Variable [ $$citationItem ]</li>
<li>Set Variable [ $$Path ]</li>
<li>Else If [ testlearn::kfolderPath &ne; $tag ]</li>
<li>Set Field [ testlearn::kfolderPath; $tag ]</li>
<li>Set Variable [ $$Path; Value:testlearn::kfolderPath ]</li>
<li>End If</li>
<li>#</li>
<li>Else If [ $$citationMatch = "cite" ]</li>
<li>If [ Case ( $tableName = "testLearn" ; testlearn::kcitation = $tag &amp; "L" ; testlearn::kcitation = $tag ) ]</li>
<li>Set Field [ testlearn::kcitation; "" ]</li>
<li>#</li>
<li>//  #Ask user if OK to remove keywords.</li>
<li>//  Show Custom Dialog [ Message: "Use the citation record's keywords?  (This will replace this records keywords if there are any.)"; Buttons: &ldquo;cancel&rdquo;, &ldquo;OK&rdquo; ]</li>
<li>//  If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>//  End If</li>
<li>//  Set Field [ testlearn::kHealth; "" ]</li>
<li>//  Set Field [ testlearn::copyrightYear; "" ]</li>
<li>//  Set Field [ testlearn::kKeywordPrimary; "" ]</li>
<li>//  Set Field [ testlearn::kcKeywordOther; "" ]</li>
<li>//  Set Field [ testlearn::OtherKeyWords; "" ]</li>
<li>//  #</li>
<li>//  Set Field [ testlearn::filename; "" ]</li>
<li>//  Set Field [ testlearn::kfileLocation; "" ]</li>
<li>//  Set Field [ testlearn::kfolderPath; "" ]</li>
<li>//  Set Field [ testlearn::kmedium; "" ]</li>
<li>//  Set Field [ testlearn::URL; "" ]</li>
<li>//  Set Field [ testlearn::URLPubDate; "" ]</li>
<li>#</li>
<li>Set Variable [ $$citationItem ]</li>
<li>Set Variable [ $$cite ]</li>
<li>//  Set Variable [ $citeHealth ]</li>
<li>//  Set Variable [ $citeCopyrightYear ]</li>
<li>//  Set Variable [ $citekeywordOther ]</li>
<li>//  Set Variable [ $citekeywordOtherWords ]</li>
<li>//  Set Variable [ $citekeywordPrimary ]</li>
<li>#The 'L' allows system to learn and reference records apart.</li>
<li>Else If [ testlearn::kcitation &amp; "L" &ne; $tag ]</li>
<li>Set Field [ testlearn::kcitation; Case ( $tableName = "testLearn" ; $tag &amp; "L" ;  $tag ) ]</li>
<li>Set Variable [ $$cite; Value:Case ( $tableName = "testLearn" ; $tag &amp; "L" ;  $tag ) ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#Ask user if OK to replace keywords.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Show Custom Dialog [ Message: "Use citation record's keywords: " &amp; 

//KEYWORDS
Case ( tagKeywordPrimary::tag = "" ; "" ; tagKeywordPrimary::tag ; Bold &amp; ", " ) &amp; 
reference::OtherKeyWords  &amp; 

"?  (This will replace keywords for this record, if there are any.)"; Buttons: &ldquo;no&rdquo;, &ldquo;yes&rdquo; ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Set Field [ testlearn::kKeywordPrimary; $citekeywordPrimary ]</li>
<li>Set Field [ testlearn::kcKeywordOther; $citekeywordOther ]</li>
<li>Set Field [ testlearn::OtherKeyWords; $citekeywordOtherWords ]</li>
<li>End If</li>
<li>#</li>
<li>#Health should blank and take copyright of cited record.</li>
<li>Set Field [ testlearn::kHealth; "" ]</li>
<li>#</li>
<li>#Decided that user needs to go to tag window  to get</li>
<li>#link info, because if changed, it will not change here</li>
<li>#because these items not linked to citation record.</li>
<li>//  Set Field [ testlearn::copyrightYear; $citeCopyrightDate ]</li>
<li>//  Set Field [ testlearn::filename; $filename ]</li>
<li>//  Set Field [ testlearn::kfileLocation; $fileLocation ]</li>
<li>//  Set Field [ testlearn::kfolderPath; $folderpath ]</li>
<li>//  Set Field [ testlearn::kmedium; $medium ]</li>
<li>//  Set Field [ testlearn::URL; $URL ]</li>
<li>//  Set Field [ testlearn::URLPubDate; $URLdate ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Perform Script [ &ldquo;CHUNKaddReferenceNodesAndKeywords&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>Else If [ $$citationMatch = "key" ]</li>
<li>#</li>
<li>#If primary keyword is in use, then remove it.</li>
<li>If [ testlearn::kKeywordPrimary = $tag ]</li>
<li>Set Field [ testlearn::kKeywordPrimary; "" ]</li>
<li>Set Variable [ $$citationItem ]</li>
<li>Set Variable [ $$PrimaryKey ]</li>
<li>#</li>
<li>#If primary keyword is not in use add it and set</li>
<li>#variables to see if it was in the other keyword</li>
<li>#field so it can be removed from there thus </li>
<li>#preventing the same keyword showing up twice.</li>
<li>Else If [ testlearn::kKeywordPrimary &ne; $tag ]</li>
<li>Set Field [ testlearn::kKeywordPrimary; $tag ]</li>
<li>Set Field [ testlearn::kcKeywordOther; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used

If ( ValueCount ( $$key ) &ne; ValueCount ( Substitute ( $$key ; $$citationItem &amp; "&para;"  ; "" ) ) ; 

Substitute ( $$key ; $$citationItem &amp; "&para;"  ; "" ) ; 

Substitute ( $$key ; $$citationItem ; "" ) 

) ]</li>
<li>Set Variable [ $$key; Value:testlearn::kcKeywordOther ]</li>
<li>Set Variable [ $$skipFirstPartOfScript; Value:1 ]</li>
<li>#</li>
<li>#Record must be committed if user decides to </li>
<li>#perform a script on it right after this one or</li>
<li>#perform a find requiring the newly added key.</li>
<li>Commit Records/Requests</li>
<li>Perform Script [ &ldquo;addORremoveTagFromCitationStep2keyword&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>Else If [ $$citationMatch = "test" ]</li>
<li>#</li>
<li>#</li>
<li>#If test item is in use, then remove it.</li>
<li>#</li>
<li>#But first determine if it is a discovery record.</li>
<li>#Because discovery records are created in the</li>
<li>#test module, and then end up here via the</li>
<li>#info check box on the discovery tag menu, these</li>
<li>#records only reason for showing up here in the</li>
<li>#learn module is because of this link.  Once</li>
<li>#the user clears this link, the record will be omitted</li>
<li>#and so to not surprise the user with this omission, </li>
<li>#a warning is given to both inform and allow </li>
<li>#the user to cancel clearing this link.</li>
<li>If [ testlearn::ktest &ne; "" and GetValue ( testlearn::kctest ; 2 )  = "" ]</li>
<li>Show Custom Dialog [ Message: "This discovery record will be removed from this section of your database: learn section.  It will still be available in the " &amp; TEMP::sectionName &amp; " test section as a discovery record for " &amp; TEMP::testName &amp; ", report " &amp; testlearn::kreportNumber &amp; "."; Buttons: &ldquo;OK&rdquo;, &ldquo;Cancel&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>End If</li>
<li>Set Variable [ $number; Value:1 ]</li>
<li>Loop</li>
<li>If [ FilterValues ( Middle ( GetValue ( testlearn::kctest ; $number ) ; 4 ; 42 ) ; $tag &amp; "&para;"  )  = $tag &amp; &para; ]</li>
<li>Set Field [ testlearn::kctest; Substitute ( $$test ; GetValue ( testlearn::kctest ; $number )  &amp; "&para;"  ; "" ) ]</li>
<li>Set Field [ testlearn::orderTest; "" ]</li>
<li>#</li>
<li>#If as discussed above this is a discovery record,</li>
<li>#clear the filterfind field to prevent it from being</li>
<li>#part of the learn record set and then omit it.</li>
<li>If [ testlearn::ktest &ne; "" and testlearn::kctest = "" ]</li>
<li>Set Field [ testlearn::filterFind; "" ]</li>
<li>Omit Record</li>
<li>End If</li>
<li>Set Variable [ $$test; Value:testlearn::kctest ]</li>
<li>Set Variable [ $$citationItem ]</li>
<li>Set Variable [ $number; Value:"exit" ]</li>
<li>End If</li>
<li>Exit Loop If [ GetValue ( testlearn::kctest ; $number )  = "" ]</li>
<li>Exit Loop If [ $number = "" ]</li>
<li>Set Variable [ $add; Value:$number ]</li>
<li>Set Variable [ $number; Value:$add + 1 ]</li>
<li>End Loop</li>
<li>#</li>
<li>#If test item is not in use add it.</li>
<li>If [ $number &ne; "exit" ]</li>
<li>Set Variable [ $number; Value:1 ]</li>
<li>Loop</li>
<li>If [ FilterValues ( Middle ( GetValue ( testlearn::kctest ; $number ) ; 4 ; 42 ) ; $$test &amp; "&para;"  ) &ne; $tag &amp; &para; ]</li>
<li>Set Field [ testlearn::kctest; "100" &amp; $tag &amp; &para; &amp; $$test ]</li>
<li>Set Field [ testlearn::orderTest; "100" ]</li>
<li>Set Variable [ $$test; Value:testlearn::kctest ]</li>
<li>Set Variable [ $number ]</li>
<li>#</li>
<li>#Record must be committed if user decides to </li>
<li>#perform a script on it right after this one or</li>
<li>#perform a find requiring the newly added key.</li>
<li>Commit Records/Requests</li>
<li>End If</li>
<li>Exit Loop If [ FilterValues ( Middle ( GetValue ( testlearn::kctest ; $number ) ; 4 ; 42 ) ; $$test &amp; "&para;"  ) = "" ]</li>
<li>Exit Loop If [ $number = "" ]</li>
<li>Set Variable [ $add; Value:$number ]</li>
<li>Set Variable [ $number; Value:$add + 1 ]</li>
<li>End Loop</li>
<li>#</li>
<li>#If the system is currently sorting test records</li>
<li>#by order number, then give this newly tagged</li>
<li>#record the number 100, and then sort it the records</li>
<li>#so that it shows up as part of the current tag's</li>
<li>#record set. </li>
<li>Set Field [ testlearn::orderTest; "100" ]</li>
<li>Set Field [ TEMP::TLTestSort; "order" ]</li>
<li>Perform Script [ &ldquo;sortTLRecordsByOrderNumber&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>Else If [ $$citationMatch = "sample" ]</li>
<li>#</li>
<li>#If sample item is in use, then remove it.</li>
<li>Set Variable [ $number; Value:1 ]</li>
<li>Loop</li>
<li>If [ FilterValues ( Middle ( GetValue ( testlearn::kcsample ; $number ) ; 4 ; 42 ) ; $tag &amp; "&para;"  )  = $tag &amp; &para; ]</li>
<li>Set Field [ testlearn::kcsample; Substitute ( $$sample ; GetValue ( testlearn::kcsample ; $number )  &amp; "&para;"  ; "" ) ]</li>
<li>Set Field [ testlearn::orderTest; "" ]</li>
<li>Set Variable [ $$sample; Value:testlearn::kcsample ]</li>
<li>Set Variable [ $$citationItem ]</li>
<li>Set Variable [ $number; Value:"exit" ]</li>
<li>End If</li>
<li>Exit Loop If [ GetValue ( testlearn::kcsample ; $number )  = "" ]</li>
<li>Exit Loop If [ $number = "" ]</li>
<li>Set Variable [ $add; Value:$number ]</li>
<li>Set Variable [ $number; Value:$add + 1 ]</li>
<li>End Loop</li>
<li>#</li>
<li>If [ $number &ne; "exit" ]</li>
<li>Set Variable [ $number; Value:1 ]</li>
<li>Loop</li>
<li>#If sample item is not in use add it.</li>
<li>If [ FilterValues ( Middle ( GetValue ( testlearn::kcsample ; $number ) ; 4 ; 42 ) ; $tagS &amp; "&para;"  ) &ne; $tag &amp; &para; ]</li>
<li>//  Set Variable [ $$sample; Value:testlearn::kcsample ]</li>
<li>Set Field [ testlearn::kcsample; "100" &amp; $tag &amp; &para; &amp; $$sample ]</li>
<li>//  Set Field [ testlearn::orderTest; "100" ]</li>
<li>Set Variable [ $$sample; Value:testlearn::kcsample ]</li>
<li>Set Variable [ $number ]</li>
<li>#</li>
<li>#Record must be committed if user decides to </li>
<li>#perform a script on it right after this one or</li>
<li>#perform a find requiring the newly added key.</li>
<li>Commit Records/Requests</li>
<li>End If</li>
<li>Exit Loop If [ FilterValues ( Middle ( GetValue ( testlearn::kcsample ; $number ) ; 4 ; 42 ) ; $tagS &amp; "&para;"  ) = "" ]</li>
<li>Exit Loop If [ $number = "" ]</li>
<li>Set Variable [ $add; Value:$number ]</li>
<li>Set Variable [ $number; Value:$add + 1 ]</li>
<li>End Loop</li>
<li>#</li>
<li>#If the system is currently sorting test records</li>
<li>#by order number, then give this newly tagged</li>
<li>#record the number 100, and then sort it the records</li>
<li>#so that it shows up as part of the current tag's</li>
<li>#record set. </li>
<li>Set Field [ testlearn::orderTest; "100" ]</li>
<li>Set Field [ TEMP::TLTestSort; "order" ]</li>
<li>Perform Script [ &ldquo;sortTLRecordsByOrderNumber&rdquo; ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Record must be committed if user decides to </li>
<li>#perform a script on it right after this one or</li>
<li>#perform a find requiring the newly added key.</li>
<li>Commit Records/Requests</li>
<li>#</li>
<li>#Refresh the windows so changed conditional formatting</li>
<li>#will show up.</li>
<li>Refresh Window</li>
<li>#</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>#Check which tag user is looking at and then...</li>
<li>If [ $$citationMatch = "node" ]</li>
<li>#</li>
<li>#If primary node is in use, then remove it.</li>
<li>If [ reference::knodePrimary = $tag ]</li>
<li>Set Field [ reference::knodePrimary; "" ]</li>
<li>#</li>
<li>#Get the keys currently unlocking who is a </li>
<li>#copyright holder.</li>
<li>Set Variable [ $keyChain; Value:reference::kcopyrightHolder ]</li>
<li>#</li>
<li>#Remove key from keychain if it is on </li>
<li>#the copyright holder keychain.</li>
<li>If [ reference::knodeOther = "" and reference::knodePrimary = "" ]</li>
<li>Set Field [ reference::kcopyrightHolder; Substitute ( $keyChain ; "node738fds8ef" &amp; "&para;"  ; "" ) ]</li>
<li>End If</li>
<li>#</li>
<li>#Finish removing the key.</li>
<li>Set Variable [ $$citationItem ]</li>
<li>Set Variable [ $$PrimaryNode ]</li>
<li>#</li>
<li>#If primary node is not in use add it and set</li>
<li>#variables to see if it was in the other node</li>
<li>#field so it can be removed from there thus </li>
<li>#preventing the same node showing up twice.</li>
<li>Else If [ reference::knodePrimary &ne; $tag ]</li>
<li>Set Field [ reference::knodePrimary; $tag ]</li>
<li>Set Field [ reference::knodeOther; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used

If ( ValueCount ( $$node ) &ne; ValueCount ( Substitute ( $$node ; $$citationItem &amp; "&para;"  ; "" ) ) ; 

Substitute ( $$node ; $$citationItem &amp; "&para;"  ; "" ) ; 

Substitute ( $$node ; $$citationItem ; "" ) 

) ]</li>
<li>Set Variable [ $$node; Value:reference::knodeOther ]</li>
<li>Set Variable [ $$PrimaryNode; Value:reference::knodePrimary ]</li>
<li>Set Variable [ $$skipFirstPartOfScript; Value:1 ]</li>
<li>#</li>
<li>#Record must be committed if user decides to </li>
<li>#perform a script on it right after this one or</li>
<li>#perform a find requiring the newly added key.</li>
<li>Commit Records/Requests</li>
<li>Perform Script [ &ldquo;addORremoveTagFromCitationStep2node&rdquo; ]</li>
<li>Close Window [ Name: "reorder"; Current file ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>Else If [ $$citationMatch = "medium" ]</li>
<li>If [ reference::kmedium = $tag ]</li>
<li>Set Field [ reference::kmedium; "" ]</li>
<li>Set Variable [ $$citationItem ]</li>
<li>Set Variable [ $$medium ]</li>
<li>Else If [ reference::kmedium &ne; $tag ]</li>
<li>Set Field [ reference::kmedium; $tag ]</li>
<li>Set Variable [ $$medium; Value:reference::kmedium ]</li>
<li>End If</li>
<li>#</li>
<li>Else If [ $$citationMatch = "health" ]</li>
<li>If [ reference::kHealth = $tag ]</li>
<li>Set Field [ reference::kHealth; "" ]</li>
<li>Set Variable [ $$citationItem ]</li>
<li>Set Variable [ $$health ]</li>
<li>Else If [ reference::kHealth &ne; $tag ]</li>
<li>Set Field [ reference::kHealth; $tag ]</li>
<li>Set Variable [ $$health; Value:reference::kHealth ]</li>
<li>End If</li>
<li>#</li>
<li>Else If [ $$citationMatch = "cite" ]</li>
<li>If [ reference::kcitation = $tag ]</li>
<li>Set Field [ reference::kcitation; "" ]</li>
<li>Set Variable [ $$citationItem ]</li>
<li>Set Variable [ $$cite ]</li>
<li>Else If [ reference::kcitation &ne; $tag ]</li>
<li>Set Field [ reference::kcitation; $tag ]</li>
<li>Set Variable [ $$cite; Value:reference::kcitation ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Perform Script [ &ldquo;CHUNKaddReferenceNodesAndKeywords&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>Else If [ $$citationMatch = "organ" ]</li>
<li>If [ reference::korgan = $tag ]</li>
<li>Set Field [ reference::korgan; "" ]</li>
<li>#</li>
<li>#Get the keys currently unlocking  </li>
<li>#copyright holder.</li>
<li>Set Variable [ $keyChain; Value:reference::kcopyrightHolder ]</li>
<li>#</li>
<li>#Remove key from keychain if it is on </li>
<li>#the copyright holder keychain.</li>
<li>Set Field [ reference::kcopyrightHolder; Substitute ( $keyChain ; $$citationItem &amp; "&para;"  ; "" ) ]</li>
<li>#Finish removing the key.</li>
<li>Set Variable [ $$citationItem ]</li>
<li>Set Variable [ $$organ ]</li>
<li>#</li>
<li>Else If [ reference::korgan &ne; $tag ]</li>
<li>#</li>
<li>#Get the keys currently unlocking</li>
<li>#copyright holder if on the chain.</li>
<li>Set Variable [ $oldCopyrightKey; Value:reference::korgan ]</li>
<li>If [ FilterValues ( reference::kcopyrightHolder ; $oldCopyrightKey &amp; &para; ) = $oldCopyrightKey &amp; &para; ]</li>
<li>Set Variable [ $keyChain; Value:reference::kcopyrightHolder ]</li>
<li>#</li>
<li>#Remove old key from keychain if it is on </li>
<li>#the copyright holder keychain.</li>
<li>Set Field [ reference::kcopyrightHolder; Substitute ( $keyChain ; $oldCopyrightKey &amp; "&para;"  ; "" ) ]</li>
<li>#</li>
<li>#Add new key to copyright keychain.</li>
<li>Set Variable [ $keyChain; Value:reference::kcopyrightHolder ]</li>
<li>Set Field [ reference::kcopyrightHolder; $tag &amp; "&para;" &amp; $keyChain ]</li>
<li>End If</li>
<li>Set Field [ reference::korgan; $tag ]</li>
<li>Set Variable [ $$organ; Value:reference::korgan ]</li>
<li>End If</li>
<li>#</li>
<li>Else If [ $$citationMatch = "copyist" ]</li>
<li>If [ reference::kcopyist = $tag ]</li>
<li>Set Field [ reference::kcopyist; "" ]</li>
<li>#</li>
<li>#Get the keys currently unlocking</li>
<li>#copyright holder.</li>
<li>Set Variable [ $keyChain; Value:reference::kcopyrightHolder ]</li>
<li>#</li>
<li>#Remove key from keychain if it is on </li>
<li>#the copyright holder keychain.</li>
<li>Set Field [ reference::kcopyrightHolder; Substitute ( $keyChain ; $$citationItem &amp; "&para;"  ; "" ) ]</li>
<li>#Finish removing the key.</li>
<li>Set Variable [ $$citationItem ]</li>
<li>Set Variable [ $$copyist ]</li>
<li>#</li>
<li>Else If [ reference::kcopyist &ne; $tag ]</li>
<li>#</li>
<li>#Get the keys currently unlocking</li>
<li>#copyright holder if on the chain.</li>
<li>Set Variable [ $oldCopyrightKey; Value:reference::kcopyist ]</li>
<li>If [ FilterValues ( reference::kcopyrightHolder ; $oldCopyrightKey &amp; &para; ) = $oldCopyrightKey &amp; &para; ]</li>
<li>Set Variable [ $keyChain; Value:reference::kcopyrightHolder ]</li>
<li>#</li>
<li>#Remove old key from keychain if it is on </li>
<li>#the copyright holder keychain.</li>
<li>Set Field [ reference::kcopyrightHolder; Substitute ( $keyChain ; $oldCopyrightKey &amp; "&para;"  ; "" ) ]</li>
<li>#</li>
<li>#Add new key to copyright keychain.</li>
<li>Set Variable [ $keyChain; Value:reference::kcopyrightHolder ]</li>
<li>Set Field [ reference::kcopyrightHolder; $tag &amp; "&para;" &amp; $keyChain ]</li>
<li>End If</li>
<li>#</li>
<li>Set Field [ reference::kcopyist; $tag ]</li>
<li>Set Variable [ $$copyist; Value:reference::kcopyist ]</li>
<li>End If</li>
<li>#</li>
<li>Else If [ $$citationMatch = "Path" ]</li>
<li>If [ reference::kfolderpath = $tag ]</li>
<li>Set Field [ reference::kfolderpath; "" ]</li>
<li>Set Variable [ $$citationItem ]</li>
<li>Set Variable [ $$Path ]</li>
<li>Else If [ reference::kfolderpath &ne; $tag ]</li>
<li>Set Field [ reference::kfolderpath; $tag ]</li>
<li>Set Variable [ $$Path; Value:reference::kfolderpath ]</li>
<li>End If</li>
<li>#</li>
<li>Else If [ $$citationMatch = "key" ]</li>
<li>#</li>
<li>#If primary keyword is in use, then remove it.</li>
<li>If [ reference::kkeywordPrimary = $tag ]</li>
<li>Set Field [ reference::kkeywordPrimary; "" ]</li>
<li>Set Variable [ $$citationItem ]</li>
<li>Set Variable [ $$PrimaryKey ]</li>
<li>#</li>
<li>#If primary keyword is not in use add it and set</li>
<li>#variables to see if it was in the other keyword</li>
<li>#field so it can be removed from there thus </li>
<li>#preventing the same keyword showing up twice.</li>
<li>Else If [ reference::kkeywordPrimary &ne; $tag ]</li>
<li>Set Field [ reference::kkeywordPrimary; $tag ]</li>
<li>Set Field [ reference::kkeywordOther; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used

If ( ValueCount ( $$key ) &ne; ValueCount ( Substitute ( $$key ; $$citationItem &amp; "&para;"  ; "" ) ) ; 

Substitute ( $$key ; $$citationItem &amp; "&para;"  ; "" ) ; 

Substitute ( $$key ; $$citationItem ; "" ) 

) ]</li>
<li>Set Variable [ $$key; Value:reference::kkeywordOther ]</li>
<li>Set Variable [ $$PrimaryKey; Value:reference::kkeywordPrimary ]</li>
<li>Set Variable [ $$skipFirstPartOfScript; Value:1 ]</li>
<li>#</li>
<li>#Record must be committed if user decides to </li>
<li>#perform a script on it right after this one or</li>
<li>#perform a find requiring the newly added key.</li>
<li>Commit Records/Requests</li>
<li>Perform Script [ &ldquo;addORremoveTagFromCitationStep2keyword&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>End If</li>
<li>#</li>
<li>#Record must be committed if user decides to </li>
<li>#perform a script on it right after this one or</li>
<li>#perform a find requiring the newly added key.</li>
<li>Commit Records/Requests</li>
<li>#</li>
<li>#Refresh the windows so changed conditional formatting</li>
<li>#will show up.</li>
<li>Refresh Window</li>
<li>#</li>
<li>#Since references can only be tagged in edit mode</li>
<li>#this next part of the script is not needed, and actually</li>
<li>#causes problems.</li>
<li>//  #Take user to where record sorts to.</li>
<li>//  #will show up.</li>
<li>//  Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>//  Set Variable [ $record; Value:reference::_Lreference ]</li>
<li>//  If [ $$citationMatch = "node" ]</li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  Sort Records [  ]
[ No dialog ]</li>
<li>//  Loop</li>
<li>//  Exit Loop If [ reference::_Lreference = $record ]</li>
<li>//  Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>//  End Loop</li>
<li>//  Else If [ $$citationMatch = "medium" ]</li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  Sort Records [  ]
[ No dialog ]</li>
<li>//  Loop</li>
<li>//  Exit Loop If [ reference::_Lreference = $record ]</li>
<li>//  Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>//  End Loop</li>
<li>//  Else If [ $$citationMatch = "Path" ]</li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  Sort Records [  ]
[ No dialog ]</li>
<li>//  Loop</li>
<li>//  Exit Loop If [ reference::_Lreference = $record ]</li>
<li>//  Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>//  End Loop</li>
<li>//  Else If [ $$citationMatch = "key" ]</li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  Sort Records [  ]
[ No dialog ]</li>
<li>//  Loop</li>
<li>//  Exit Loop If [ reference::_Lreference = $record ]</li>
<li>//  Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>//  End Loop</li>
<li>//  End If</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>End If</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Go to Record/Request/Page [ $recordNumber ]
[ No dialog ]</li>
<li>#</li>
<li>#Check if any Learn records are tagged with this </li>
<li>#test item (if currently in test mode), and if </li>
<li>#not then sort Learn records by date.</li>
<li>If [ $$citationMatch = "test" and 

(FilterValues ( Middle ( GetValue ( $$test ; 1 ) ; 4 ; 42 ) ; test::_Ltest &amp; "&para;"  )  = test::_Ltest &amp; &para;
 or 

FilterValues ( Middle ( GetValue ( $$test ; 2 ) ; 4 ; 42 ) ; test::_Ltest &amp; "&para;"  )  = test::_Ltest &amp; &para;
 or 

FilterValues ( Middle ( GetValue ( $$test ; 3 ) ; 4 ; 42 ) ; test::_Ltest &amp; "&para;"  )  = test::_Ltest &amp; &para;
 or 

FilterValues ( Middle ( GetValue ( $$test ; 4 ) ; 4 ; 42 ) ; test::_Ltest &amp; "&para;"  )  = test::_Ltest &amp; &para;
 or 

FilterValues ( Middle ( GetValue ( $$test ; 5 ) ; 4 ; 42 ) ; test::_Ltest &amp; "&para;"  )  = test::_Ltest &amp; &para;
 or 

FilterValues ( Middle ( GetValue ( $$test ; 6 ) ; 4 ; 42 ) ; test::_Ltest &amp; "&para;"  )  = test::_Ltest &amp; &para;
 or 

FilterValues ( Middle ( GetValue ( $$test ; 7 ) ; 4 ; 42 ) ; test::_Ltest &amp; "&para;"  )  = test::_Ltest &amp; &para;
 or 

FilterValues ( Middle ( GetValue ( $$test ; 8 ) ; 4 ; 42 ) ; test::_Ltest &amp; "&para;"  )  = test::_Ltest &amp; &para;
 or 

FilterValues ( Middle ( GetValue ( $$test ; 9 ) ; 4 ; 42 ) ; test::_Ltest &amp; "&para;"  )  = test::_Ltest &amp; &para;
 or 

FilterValues ( Middle ( GetValue ( $$test ; 10 ) ; 4 ; 42 ) ; test::_Ltest &amp; "&para;"  )  = test::_Ltest &amp; &para; )

 = 0 ]</li>
<li>Perform Script [ &ldquo;loadItemRecordForTestTagMenu&rdquo; ]</li>
<li>End If</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::_Lreference</li>
<li>
<em>testlearn</em>::kcitation</li>
<li>
<em>testlearn</em>::kcreference</li>
<li>
<em>reference</em>::kcitation</li>
<li>
<em>testlearn</em>::filterFind</li>
<li>
<em>reference</em>::filterFind</li>
<li>
<em>test</em>::_Ltest</li>
<li>
<em>ruleSection</em>::name</li>
<li>
<em>testlearn</em>::_Ltestlearn</li>
<li>
<em>ruleSection</em>::_Lgroup</li>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>reference</em>::kHealth</li>
<li>
<em>reference</em>::CopyrightYear</li>
<li>
<em>reference</em>::kkeywordOther</li>
<li>
<em>reference</em>::OtherKeyWords</li>
<li>
<em>reference</em>::kkeywordPrimary</li>
<li>
<em>reference</em>::fileName</li>
<li>
<em>reference</em>::kfileLocation</li>
<li>
<em>reference</em>::kfolderpath</li>
<li>
<em>reference</em>::kmedium</li>
<li>
<em>reference</em>::URL</li>
<li>
<em>reference</em>::URLdate</li>
<li>
<em>testlearn</em>::kHealth</li>
<li>
<em>testlearn</em>::copyrightYear</li>
<li>
<em>testlearn</em>::kcKeywordOther</li>
<li>
<em>testlearn</em>::OtherKeyWords</li>
<li>
<em>testlearn</em>::kKeywordPrimary</li>
<li>
<em>tempSetup</em>::kdefaultNodePrimary</li>
<li>
<em>tempSetup</em>::DEFAULTNodePrimaryName</li>
<li>
<em>tempSetup</em>::nodeLock</li>
<li>
<em>tagDefaultNodePrimary</em>::tag</li>
<li>
<em>tempSetup</em>::kdefaultNodeOther</li>
<li>
<em>testlearn</em>::kNodePrimary</li>
<li>
<em>tempSetup</em>::kdefaultHealth</li>
<li>
<em>tempSetup</em>::ksection</li>
<li>
<em>tempSetup</em>::sectionName</li>
<li>
<em>testlearn</em>::kNodeOther</li>
<li>
<em>testlearn</em>::kmedium</li>
<li>
<em>testlearn</em>::kfolderPath</li>
<li>
<em>testlearn</em>::filename</li>
<li>
<em>testlearn</em>::kfileLocation</li>
<li>
<em>testlearn</em>::URL</li>
<li>
<em>testlearn</em>::URLPubDate</li>
<li>
<em>tagKeywordPrimary</em>::tag</li>
<li>
<em>testlearn</em>::ktest</li>
<li>
<em>testlearn</em>::kctest</li>
<li>
<em>TEMP</em>::sectionName</li>
<li>
<em>TEMP</em>::testName</li>
<li>
<em>testlearn</em>::kreportNumber</li>
<li>
<em>testlearn</em>::orderTest</li>
<li>
<em>TEMP</em>::TLTestSort</li>
<li>
<em>testlearn</em>::kcsample</li>
<li>
<em>reference</em>::knodePrimary</li>
<li>
<em>reference</em>::kcopyrightHolder</li>
<li>
<em>reference</em>::knodeOther</li>
<li>
<em>reference</em>::korgan</li>
<li>
<em>reference</em>::kcopyist</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33099ScriptAnchor_">findMode</a></li>
<li><a href="#33212ScriptAnchor_">CHUNKaddMainRecordSectionKeysToCiteOrRefSectionKeychain</a></li>
<li><a href="#33211ScriptAnchor_">CHUNKaddMainSectionKeysToTagRecordKeychain</a></li>
<li><a href="#32994ScriptAnchor_">addORremoveTagFromCitationStep2node</a></li>
<li><a href="#33207ScriptAnchor_">CHUNKaddReferenceNodesAndKeywords</a></li>
<li><a href="#32992ScriptAnchor_">addORremoveTagFromCitationStep2keyword</a></li>
<li><a href="#33129ScriptAnchor_">sortTLRecordsByOrderNumber</a></li>
<li><a href="#33127ScriptAnchor_">loadItemRecordForTestTagMenu</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33201ScriptAnchor_"></a><td class="script_navbar"><a href="#32987ScriptAnchor_"><span>Previous Script: [addTagToMainRecord]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33245ScriptAnchor_"><span>Next Script: [addBackSectionCreatorNode]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">setDefaultSection</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33086ScriptAnchor_">startDatabase</a></li>
<li><a href="#33154ScriptAnchor_">newSectionOnSectionLayout</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>#</li>
<li>#Get key for tag that is to be added to record.</li>
<li>Set Variable [ $tag; Value:ruleSection::_Lgroup ]</li>
<li>Set Variable [ $tagName; Value:ruleSection::name ]</li>
<li>#</li>
<li>#Stop check spelling script as this script is triggered</li>
<li>#on section layout by record load trigger, and</li>
<li>#so before user can change the spelling.</li>
<li>Set Variable [ $$stopChangeSectionName; Value:1 ]</li>
<li>#</li>
<li>#Remove focus from field so can see </li>
<li>#conditional formatting.</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#</li>
<li>#Select setup window.</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>#</li>
<li>#Since sections are required, the deselect script</li>
<li>#steps are not needed.  When the user clicks on</li>
<li>#a new record on the section layout this script</li>
<li>#is triggered and that section set as the default</li>
<li>#section.</li>
<li>Set Field [ tempSetup::ksection; $tag ]</li>
<li>Set Field [ tempSetup::sectionName; $tagName ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#goto Tag Menus window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#Allow duplicate tag check script to operate.</li>
<li>Set Variable [ $$stopChangeSectionName ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#TURN INTO CHUNK!!!!!</li>
<li>#TURN INTO CHUNK!!!!!</li>
<li>#CHUNKaddReferenceNodesAndKeywords</li>
<li>#</li>
<li>#Check if nodes selected -- primary, other, and </li>
<li>#test subject -- are in the current section.</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>Set Variable [ $nodePrimary; Value:tempSetup::kdefaultNodePrimary ]</li>
<li>Set Variable [ $nodeOther; Value:tempSetup::kdefaultNodeOther ]</li>
<li>Set Variable [ $nodeTestSubject; Value:tempSetup::kdefaultNodeTestSubject ]</li>
<li>#</li>
<li>#Find all nodes assigned to this section.</li>
<li>Go to Layout [ &ldquo;defaultNode1&rdquo; (tagMenus) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::match; "node" ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; "==" &amp; TEMP::ksection ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#PRIMARY NODE</li>
<li>#Loop thru records to find primary node.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>Loop</li>
<li>#</li>
<li>#If the key matches a lock or no locks exit the loop.</li>
<li>Exit Loop If [ $nodePrimary = tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#If the record the loop ended up on does not accept</li>
<li>#the primary key being tested, then add its</li>
<li>#group to the current section. ( Node groups are</li>
<li>#    are assigned to sections, not individual nodes. </li>
<li>#    So if the user wants one node to be assigned</li>
<li>#    to a new section, its group and all nodes in</li>
<li>#    its group must be assigned to the new section.</li>
<li>#    The reason for this is because the display of</li>
<li>#    nodes by catergory requires that each group</li>
<li>#    have a unique name and that each node belong</li>
<li>#    to a group.  For the node to be the same node</li>
<li>#    The group key it holds has to be the same as</li>
<li>#    well, which means the group has to appear</li>
<li>#    with the node, and with the group comes</li>
<li>#    all the nodes assigned to it. )</li>
<li>If [ $nodePrimary &ne; tagMenus::_Ltag and $nodePrimary  &ne; "" ]</li>
<li>#</li>
<li>#Find the node to be added.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::_Ltag; $nodePrimary ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Next, add the current section key to this node's</li>
<li>#group's keychain.</li>
<li>Set Variable [ $groupSectionKeychain; Value:ruleTagMenuGroups::ksection ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; TEMP::ksection &amp; &para; &amp; $groupSectionKeychain ]</li>
<li>#</li>
<li>#Finally, refind all nodes, which now includes the</li>
<li>#node just added.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::match; "node" ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; "==" &amp; TEMP::ksection ]</li>
<li>Perform Find [  ]</li>
<li>End If</li>
<li>#</li>
<li>#TEST SUBJECT</li>
<li>#Loop thru records to find test subject node.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>Loop</li>
<li>#</li>
<li>#If the key matches a lock or no locks exit the loop.</li>
<li>Exit Loop If [ $nodeTestSubject = tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#If the record the loop ended up on does not accept</li>
<li>#the test subject key being tested, then add its</li>
<li>#group to the current section. ( Node groups are</li>
<li>#    are assigned to sections, not individual nodes. </li>
<li>#    So if the user wants one node to be assigned</li>
<li>#    to a new section, its group and all nodes in</li>
<li>#    its group must be assigned to the new section.</li>
<li>#    The reason for this is because the display of</li>
<li>#    nodes by catergory requires that each group</li>
<li>#    have a unique name and that each node belong</li>
<li>#    to a group.  For the node to be the same node</li>
<li>#    The group key it holds has to be the same as</li>
<li>#    well, which means the group has to appear</li>
<li>#    with the node, and with the group comes</li>
<li>#    all the nodes assigned to it. )</li>
<li>If [ $nodeTestSubject &ne; tagMenus::_Ltag and $nodeTestSubject &ne; "" ]</li>
<li>#</li>
<li>#Find the node to be added.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::_Ltag; $nodeTestSubject ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Next, add the current section key to this node's</li>
<li>#group's keychain.</li>
<li>Set Variable [ $groupSectionKeychain; Value:ruleTagMenuGroups::ksection ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; TEMP::ksection &amp; &para; &amp; $groupSectionKeychain ]</li>
<li>#</li>
<li>#Finally, refind all nodes, which now includes the</li>
<li>#node just added.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::match; "node" ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; "==" &amp; TEMP::ksection ]</li>
<li>Perform Find [  ]</li>
<li>End If</li>
<li>#</li>
<li>#OTHER NODES</li>
<li>#Determine how many keys there are to find for</li>
<li>#on the other nodes' keychain.</li>
<li>Set Variable [ $numberOfNodes; Value:ValueCount ( $nodeOther ) ]</li>
<li>#</li>
<li>#Loop thru each node record, with every key </li>
<li>#in the keychain.</li>
<li>Loop</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>#Exit the loop when there are no more keys to check.</li>
<li>Exit Loop If [ $numberOfNodes = 0 ]</li>
<li>Loop</li>
<li>#</li>
<li>#If the key matches a lock or no locks exit the loop.</li>
<li>#(  The get value calculation works by going to the</li>
<li>#    key in the list specified by the numberOfNodes</li>
<li>#    variable, set before entering the loops.</li>
<li>#    The system starts with the last key and with each</li>
<li>#    loop moves to the next key up, until there are</li>
<li>#    no more keys to check. )</li>
<li>Exit Loop If [ GetValue ( $nodeOther ; $numberOfNodes ) = tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#If the record the loop ended up on does not accept</li>
<li>#the other node key being tested, then add its</li>
<li>#group to the current section. ( Node groups are</li>
<li>#    are assigned to sections, not individual nodes. </li>
<li>#    So if the user wants one node to be assigned</li>
<li>#    to a new section, its group and all nodes in</li>
<li>#    its group must be assigned to the new section.</li>
<li>#    The reason for this is because the display of</li>
<li>#    nodes by catergory requires that each group</li>
<li>#    have a unique name and that each node belong</li>
<li>#    to a group.  For the node to be the same node</li>
<li>#    The group key it holds has to be the same as</li>
<li>#    well, which means the group has to appear</li>
<li>#    with the node, and with the group comes</li>
<li>#    all the nodes assigned to it. )</li>
<li>If [ GetValue ( $nodeOther ; $numberOfNodes ) &ne; tagMenus::_Ltag and $nodeOther &ne; "" ]</li>
<li>#</li>
<li>#Find this node to be added.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::_Ltag; GetValue ( $nodeOther ; $numberOfNodes ) ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Next, add the current section key to this node's</li>
<li>#group's keychain.</li>
<li>Set Variable [ $groupSectionKeychain; Value:ruleTagMenuGroups::ksection ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; TEMP::ksection &amp; &para; &amp; $groupSectionKeychain ]</li>
<li>#</li>
<li>#Finally, refind all nodes, which now includes the</li>
<li>#node just added.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::match; "node" ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; "==" &amp; TEMP::ksection ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>End If</li>
<li>#</li>
<li>#Go the next key up from the bottom of the list</li>
<li>#of keys on this section's keychain.</li>
<li>Set Variable [ $numberOfNodes; Value:$numberOfNodes - 1 ]</li>
<li>End Loop</li>
<li>Go to Layout [ &ldquo;defaultSetup&rdquo; (tempSetup) ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>ruleSection</em>::_Lgroup</li>
<li>
<em>ruleSection</em>::name</li>
<li>
<em>tempSetup</em>::ksection</li>
<li>
<em>tempSetup</em>::sectionName</li>
<li>
<em>tempSetup</em>::kdefaultNodePrimary</li>
<li>
<em>tempSetup</em>::kdefaultNodeOther</li>
<li>
<em>tempSetup</em>::kdefaultNodeTestSubject</li>
<li>
<em>tagMenus</em>::match</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>ruleTagMenuGroups</em>::ksection</li>
<li>
<em>tagMenus</em>::_Ltag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>defaultNode1</li>
<li>defaultSetup</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33245ScriptAnchor_"></a><td class="script_navbar"><a href="#33201ScriptAnchor_"><span>Previous Script: [setDefaultSection]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33038ScriptAnchor_"><span>Next Script: [loadTagRecord]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">addBackSectionCreatorNode</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33133ScriptAnchor_">defaultTestLocationMenu</a></li>
<li><a href="#33088ScriptAnchor_">defaultNodeMenu</a></li>
<li><a href="#32981ScriptAnchor_">editCitation</a></li>
<li><a href="#33070ScriptAnchor_">learn</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>If [ $$stopAddBack = 1 ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Make section creator key.</li>
<li>Go to Layout [ &ldquo;tableGroupTag&rdquo; (groupTest) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ groupTest::_Lgroup; TEMP::ksection ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Check if nodes selected -- primary, other, and </li>
<li>#test subject -- are in the current section.</li>
<li>Set Variable [ $nodePrimary; Value:groupTest::kRecordCreatorNode ]</li>
<li>Set Variable [ $nodeCreator; Value:groupTest::kSectionCreatorNodesCreator ]</li>
<li>Set Variable [ $groupName; Value:groupTest::defaultSectionInfo ]</li>
<li>Set Variable [ $nodeName; Value:groupTest::CaptionORinuseCheck ]</li>
<li>#</li>
<li>#If node record has been deleted then create a new one.</li>
<li>Go to Layout [ &ldquo;defaultNode1&rdquo; (tagMenus) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::_Ltag; $nodePrimary ]</li>
<li>Set Field [ tagMenus::match; "node" ]</li>
<li>Perform Find [  ]</li>
<li>If [ Get (FoundCount) = 0 ]</li>
<li>#</li>
<li>#Find all node records.</li>
<li>Go to Layout [ &ldquo;defaultNode1&rdquo; (tagMenus) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::match; "node" ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; "==" &amp; TEMP::ksection ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#Create a new node group.</li>
<li>Go to Layout [ &ldquo;tableGroupTag&rdquo; (groupTest) ]</li>
<li>#</li>
<li>New Record/Request</li>
<li>Set Field [ groupTest::ksection; TEMP::ksection ]</li>
<li>Set Field [ groupTest::kRecordCreatorNode; $nodePrimary ]</li>
<li>#</li>
<li>Set Field [ groupTest::match; "node" ]</li>
<li>Set Field [ groupTest::name; $groupName ]</li>
<li>Set Field [ groupTest::nameSpelling; $groupName ]</li>
<li>Set Variable [ $group; Value:groupTest::_Lgroup ]</li>
<li>#</li>
<li>#Re-create section's creator node.</li>
<li>Go to Layout [ &ldquo;defaultNode1&rdquo; (tagMenus) ]</li>
<li>New Record/Request</li>
<li>Set Field [ tagMenus::kGroupOrTest; $group ]</li>
<li>Set Field [ tagMenus::ksection; TEMP::ksection ]</li>
<li>Set Field [ tagMenus::kRecordCreatorNode; $nodeCreator ]</li>
<li>Set Field [ tagMenus::_Ltag; $nodePrimary ]</li>
<li>Set Field [ tagMenus::tag; $nodeName ]</li>
<li>Set Field [ tagMenus::tagSpelling; $nodeName ]</li>
<li>Set Field [ tagMenus::match; "node" ]</li>
<li>#</li>
<li>#Return to defaultSection layout.</li>
<li>Go to Layout [ original layout ]</li>
<li>#</li>
<li>#Inform user node was added back.</li>
<li>Show Custom Dialog [ Message: "The creator node for this default section was added back.  If you want to keep it deleted, you will have to delete the section it created right after you delete the section's creator node."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>#</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Find all nodes assigned to this section.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::match; "node" ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; "==" &amp; TEMP::ksection ]</li>
<li>Perform Find [  ]</li>
<li>#PRIMARY NODE</li>
<li>#Loop thru records to find primary node.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>Loop</li>
<li>#</li>
<li>#If the key matches a lock or no locks exit the loop.</li>
<li>Exit Loop If [ $nodePrimary = tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#If the record the loop ended up on does not accept</li>
<li>#the primary key being tested, then add its</li>
<li>#group to the current section. ( Node groups are</li>
<li>#    are assigned to sections, not individual nodes. </li>
<li>#    So if the user wants one node to be assigned</li>
<li>#    to a new section, its group and all nodes in</li>
<li>#    its group must be assigned to the new section.</li>
<li>#    The reason for this is because the display of</li>
<li>#    nodes by catergory requires that each group</li>
<li>#    have a unique name and that each node belong</li>
<li>#    to a group.  For the node to be the same node</li>
<li>#    The group key it holds has to be the same as</li>
<li>#    well, which means the group has to appear</li>
<li>#    with the node, and with the group comes</li>
<li>#    all the nodes assigned to it. )</li>
<li>If [ $nodePrimary &ne; tagMenus::_Ltag and $nodePrimary  &ne; "" ]</li>
<li>#</li>
<li>#Set variable to trigger Message to user.</li>
<li>Set Variable [ $nodeAddedBack; Value:1 ]</li>
<li>#</li>
<li>#Find the node to be added.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::_Ltag; $nodePrimary ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Next, add the current section key to this node's</li>
<li>#group's keychain.</li>
<li>Set Variable [ $groupSectionKeychain; Value:ruleTagMenuGroups::ksection ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; TEMP::ksection &amp; &para; &amp; $groupSectionKeychain ]</li>
<li>#</li>
<li>#Finally, refind all nodes, which now includes the</li>
<li>#node just added.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::match; "node" ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; "==" &amp; TEMP::ksection ]</li>
<li>Perform Find [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Return to defaultSection layout.</li>
<li>Go to Layout [ original layout ]</li>
<li>#</li>
<li>#Inform user node was added back.</li>
<li>If [ $nodeAddedBack = 1 ]</li>
<li>Show Custom Dialog [ Message: "The creator node for this default section was added back.  If you want to keep it deleted, you will have to delete the section it created right after you delete the section's creator node."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>groupTest</em>::_Lgroup</li>
<li>
<em>groupTest</em>::kRecordCreatorNode</li>
<li>
<em>groupTest</em>::kSectionCreatorNodesCreator</li>
<li>
<em>groupTest</em>::defaultSectionInfo</li>
<li>
<em>groupTest</em>::CaptionORinuseCheck</li>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>tagMenus</em>::match</li>
<li>
<em>ruleTagMenuGroups</em>::ksection</li>
<li>
<em>ruleTagMenuGroups</em>::order</li>
<li>
<em>ruleTagMenuGroups</em>::name</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>groupTest</em>::ksection</li>
<li>
<em>groupTest</em>::match</li>
<li>
<em>groupTest</em>::name</li>
<li>
<em>groupTest</em>::nameSpelling</li>
<li>
<em>tagMenus</em>::kGroupOrTest</li>
<li>
<em>tagMenus</em>::ksection</li>
<li>
<em>tagMenus</em>::kRecordCreatorNode</li>
<li>
<em>tagMenus</em>::tagSpelling</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>tableGroupTag</li>
<li>defaultNode1</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33038ScriptAnchor_"></a><td class="script_navbar"><a href="#33245ScriptAnchor_"><span>Previous Script: [addBackSectionCreatorNode]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#32995ScriptAnchor_"><span>Next Script: [addORremoveTagFromCitationStep1]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">loadTagRecord</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32988ScriptAnchor_">menuNode</a></li>
<li><a href="#32993ScriptAnchor_">menuKey</a></li>
<li><a href="#32984ScriptAnchor_">loadCitation</a></li>
<li><a href="#33280ScriptAnchor_">loadCitation OLD</a></li>
<li><a href="#33081ScriptAnchor_">returnToAddRecordPUTONHOLD!!!!</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ $$stopLoadTagRecord &ne; 1 ]</li>
<li>#</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>#Capture recordID to conditionally format current record.</li>
<li>Set Variable [ $$tagRecordID; Value:Get (RecordID) ]</li>
<li>#</li>
<li>//  #If in add mode, capture the recordID to loop</li>
<li>//  #back to it if user navigates away from original</li>
<li>//  #add window.</li>
<li>//  If [ $$add = 1 and $$citationMatch = $$addCitationMatch ]</li>
<li>//  Set Variable [ $$addRecord; Value:tagMenus::_Ltag ]</li>
<li>//  Else If [ $$add = "" ]</li>
<li>//  Set Variable [ $$addRecord ]</li>
<li>//  End If</li>
<li>Refresh Window</li>
<li>Perform Script [ &ldquo;checkIfLockedOnLearnTagMenus&rdquo; ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
<li>#</li>
<li>#NOTE: this script is used on the Tag Menus window</li>
<li>#for Learn records to exit field when a record is</li>
<li>#is first entered, which is a real problem on the</li>
<li>#iPhone as the text edit box opens when the user</li>
<li>#may have clicked only to select the record rather</li>
<li>#than edit it.</li>
<li>#     This field exit command is in the citation load</li>
<li>#script along with a lot of other commands which</li>
<li>#are not needed in this case.  Thus I choose the</li>
<li>#smaller script, which also has conditional formatting</li>
<li>#step which is not used here, but is needed on</li>
<li>#on other layouts.</li>
<li>#     SO...light script with unused command instead</li>
<li>#of heavy script orginally written for loading these</li>
<li>#records when they are main records (here they</li>
<li>#are just tag records).</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagMenus</em>::_Ltag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33231ScriptAnchor_">checkIfLockedOnLearnTagMenus</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32995ScriptAnchor_"></a><td class="script_navbar"><a href="#33038ScriptAnchor_"><span>Previous Script: [loadTagRecord]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#32992ScriptAnchor_"><span>Next Script: [addORremoveTagFromCitationStep2keyword]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">addORremoveTagFromCitationStep1</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Stop script if user is looking at item/detail tags</li>
<li>#in add mode, as these tags cannot be applied </li>
<li>#to reference records.</li>
<li>If [ $$add = 1 and $$citationMatch = "testItem" ]</li>
<li>Show Custom Dialog [ Message: "You cannot tag reference records with item tags.  So why then are there buttons?  The buttons show up because I have not made time to create a separate layout just for item tags.  This issue has been logged as a minor irritation."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>//  #Due to the fact that users click the add tag button </li>
<li>//  #when they want to find records tagged with a tag, </li>
<li>//  #I'm making it so that users can only add tags in edit mode.</li>
<li>//  If [ Left (Get (LayoutName) ; 3 ) = "ref" and $$stopAdd = "" ]</li>
<li>//  Show Custom Dialog [ Message: "Click the edit button in the References window (but not in Learn window) to add/change tags.  This inconvience was put in place because users kept forgetting to click find before click the P or O buttons."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>//  Exit Script [  ]</li>
<li>//  End If</li>
<li>#</li>
<li>#Remove focus from field so can see </li>
<li>#conditional formatting.</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Determine if user is looking at nodes or keywords.</li>
<li>If [ $$citationMatch = "key" ]</li>
<li>Perform Script [ &ldquo;addORremoveTagFromCitationStep2keyword&rdquo; ]</li>
<li>Else If [ $$citationMatch = "node" ]</li>
<li>Perform Script [ &ldquo;addORremoveTagFromCitationStep2node&rdquo; ]</li>
<li>Close Window [ Name: "reorder"; Current file ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>#</li>
<li>#Get the keys currently unlocking who is a </li>
<li>#copyright holder.</li>
<li>Set Variable [ $keyChain; Value:reference::kcopyrightHolder ]</li>
<li>#</li>
<li>#Remove key from keychain if it is on </li>
<li>#the copyright holder keychain.</li>
<li>If [ reference::knodeOther = "" and reference::knodePrimary = "" ]</li>
<li>Set Field [ reference::kcopyrightHolder; Substitute ( $keyChain ; "node738fds8ef" &amp; "&para;"  ; "" ) ]</li>
<li>End If</li>
<li>#</li>
<li>Select Window [ Name: "Tag Menus Change Back When Done"; Current file ]</li>
<li>If [ Get ( WindowName ) = "Tag Menus Change Back When Done" ]</li>
<li>Close Window [ Name: "Tag Menus"; Current file ]</li>
<li>Set Window Title [ Of Window: "Tag Menus Change Back When Done"; Current file; New Title: "Tag Menus" ]</li>
<li>End If</li>
<li>Refresh Window</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::kcopyrightHolder</li>
<li>
<em>reference</em>::knodeOther</li>
<li>
<em>reference</em>::knodePrimary</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32992ScriptAnchor_">addORremoveTagFromCitationStep2keyword</a></li>
<li><a href="#32994ScriptAnchor_">addORremoveTagFromCitationStep2node</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32992ScriptAnchor_"></a><td class="script_navbar"><a href="#32995ScriptAnchor_"><span>Previous Script: [addORremoveTagFromCitationStep1]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#32994ScriptAnchor_"><span>Next Script: [addORremoveTagFromCitationStep2node]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">addORremoveTagFromCitationStep2keyword</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32987ScriptAnchor_">addTagToMainRecord</a></li>
<li><a href="#32995ScriptAnchor_">addORremoveTagFromCitationStep1</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>#</li>
<li>#This script adds tags to main reference or learn </li>
<li>#other tag fields.</li>
<li>If [ $$skipFirstPartOfScript &ne; 1 ]</li>
<li>#</li>
<li>#Get current reference or learn record key. </li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Set Variable [ $$key; Value:testlearn::kcKeywordOther ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Variable [ $$key; Value:reference::kkeywordOther ]</li>
<li>End If</li>
<li>#</li>
<li>Select Window [ Name: "Tag Menus" ]</li>
<li>#</li>
<li>#Create a new window in order to perform the next part</li>
<li>#without moving the focus around on the tag window.</li>
<li>#To do this, as this is being added after the script below</li>
<li>#was written, a hack is needed (so not the best way to</li>
<li>#accomplish this).  Rename the current window and then</li>
<li>#call the new window Tag Menus.  Then when done undo</li>
<li>#the renaming.  </li>
<li>Set Variable [ $currentSelectedTag; Value:tagMenus::_Ltag ]</li>
<li>Set Variable [ $closeWindowWhenDone; Value:1 ]</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>Set Window Title [ Current Window; New Title: "Tag Menus Change Back When Done" ]</li>
<li>New Window [ Name: "Tag Menus"; Height: 1; Width: 1; Top: -1000; Left: -1000 ]</li>
<li>#</li>
<li>#Make sure all tags are showing.  User may be only </li>
<li>#showing a few of the tags after performing a find.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::match; $$citationMatch ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; "==" &amp; TEMP::ksection ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Now loop to user selected tag.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $currentSelectedTag = tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#If tag user clicked has not been added, then add it.</li>
<li>If [ tagMenus::_Ltag &amp; "&para;"  &ne;  FilterValues ( $$key ; tagMenus::_Ltag &amp; "&para;" ) ]</li>
<li>#</li>
<li>#</li>
<li>#Check for duplicates, prior to adding to a record.</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>Set Variable [ $tagName; Value:tagMenus::tag ]</li>
<li>Set Variable [ $tagKey; Value:tagMenus::_Ltag ]</li>
<li>New Window [  ]</li>
<li>Enter Find Mode [ Specified Find Requests: Find Records; Criteria: tagMenus::match: &ldquo;key&rdquo; AND ruleTagMenuGroups::ksection: &ldquo;==7052011234235374&rdquo; ]
[ Restore ]</li>
<li>Set Field [ tagMenus::tag; "==" &amp; $tagName ]</li>
<li>Set Field [ TEMP::ksection ]</li>
<li>Perform Find [  ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>If [ Get ( FoundCount )  &gt;  1 ]</li>
<li>Loop</li>
<li>Exit Loop If [ tagMenus::_Ltag = $tagKey ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Set Field [ tagMenus::tag; $tagName &amp; tagMenus::_Ltag ]</li>
<li>Set Field [ tagMenus::tagSpelling; $tagName &amp; tagMenus::_Ltag ]</li>
<li>#</li>
<li>Close Window [ Current Window ]</li>
<li>Show Custom Dialog [ Message: "Keywords must have different spellings in each section.  The ID number has been added to this keyword to make it different from its duplicate.  Please do change it to something meaningful."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>Else If [ Get ( FoundCount ) &le; 1 ]</li>
<li>Close Window [ Current Window ]</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>Set Variable [ $newKey; Value:tagMenus::_Ltag ]</li>
<li>#</li>
<li>#Set record number so can return user to it when done.</li>
<li>Set Variable [ $recordNumber; Value:Get (RecordNumber) ]</li>
<li>#</li>
<li>#Add keyword in reference or observation window.</li>
<li>#</li>
<li>#</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Set Field [ testlearn::kcKeywordOther; $newKey &amp; "&para;" &amp; $$key ]</li>
<li>Set Variable [ $$key; Value:testlearn::kcKeywordOther ]</li>
<li>If [ testlearn::kKeywordPrimary = $newKey ]</li>
<li>Set Field [ testlearn::kKeywordPrimary; "" ]</li>
<li>Set Variable [ $$citationItem ]</li>
<li>End If</li>
<li>Go to Field [  ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Field [ reference::kkeywordOther; $newKey &amp; "&para;" &amp; $$key ]</li>
<li>Set Variable [ $$key; Value:reference::kkeywordOther ]</li>
<li>If [ reference::kkeywordPrimary = $newKey ]</li>
<li>Set Field [ reference::kkeywordPrimary; "" ]</li>
<li>Set Variable [ $$citationItem ]</li>
<li>End If</li>
<li>Go to Field [  ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#Now re-alphabetize and add new keyword to citation.</li>
<li>Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>#</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Set Variable [ $otherKeys; Value:testlearn::OtherKeyWords ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Variable [ $otherKeys; Value:reference::OtherKeyWords ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#Find and set first value in keyword list.</li>
<li>#It will not have a comma in front like the other items.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Loop</li>
<li>If [ tagMenus::_Ltag &amp; "&para;" = FilterValues ( $$key ; tagMenus::_Ltag &amp; "&para;" ) ]</li>
<li>Set Variable [ $newKey; Value:tagMenus::tag ]</li>
<li>#</li>
<li>#</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Set Field [ testlearn::OtherKeyWords; $newKey ]</li>
<li>Set Variable [ $otherKeys; Value:testlearn::OtherKeyWords ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Field [ reference::OtherKeyWords; $newKey ]</li>
<li>Set Variable [ $otherKeys; Value:reference::OtherKeyWords ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Exit Loop If [ tagMenus::_Ltag &amp; "&para;" = FilterValues ( $$key ; tagMenus::_Ltag &amp; "&para;" ) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Now add remaining keywords to list.</li>
<li>Loop</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>If [ tagMenus::_Ltag &amp; "&para;" = FilterValues ( $$key ; tagMenus::_Ltag &amp; "&para;" ) ]</li>
<li>Set Variable [ $newKey; Value:tagMenus::tag ]</li>
<li>#</li>
<li>#</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Set Field [ testlearn::OtherKeyWords; $otherKeys &amp; ", " &amp; $newKey ]</li>
<li>Set Variable [ $otherKeys; Value:testlearn::OtherKeyWords ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Field [ reference::OtherKeyWords; $otherKeys &amp; ", " &amp; $newKey ]</li>
<li>Set Variable [ $otherKeys; Value:reference::OtherKeyWords ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Commit records so user can change spelling.</li>
<li>#Without commit records the system will not find</li>
<li>#the newly added tag.</li>
<li>Commit Records/Requests</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Sort records according to users wishes.</li>
<li>If [ TEMP::sortKey = "cat" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ TEMP::sortKey = "abc" ]</li>
<li>Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $recordNumber ]
[ No dialog ]</li>
<li>#</li>
<li>#If reference or learn record that tag was added</li>
<li>#to belongs to more than one section, then </li>
<li>#add these other sections to the tag's group </li>
<li>#keychain so when this tag record is viewed in </li>
<li>#those sections, the reference or learn record </li>
<li>#just added to it will show up as well.</li>
<li>Perform Script [ &ldquo;CHUNKaddMainSectionKeysToTagRecordKeychain&rdquo; ]</li>
<li>#</li>
<li>#Now close working Tag Menus window and rename</li>
<li>#users Tag Menus window to Tag Menus.</li>
<li>Close Window [ Name: "Tag Menus"; Current file ]</li>
<li>Set Window Title [ Of Window: "Tag Menus Change Back When Done"; Current file; New Title: "Tag Menus" ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#If tag has been selected, then remove it.</li>
<li>Set Variable [ $removeKey; Value:tagMenus::_Ltag ]</li>
<li>#</li>
<li>#Set record number so can return user to it when done.</li>
<li>Set Variable [ $recordNumber; Value:Get (RecordNumber) ]</li>
<li>#</li>
<li>#</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Set Field [ testlearn::kcKeywordOther; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used

If ( ValueCount ( $$key ) &ne; ValueCount ( Substitute ( $$key ; $removekey &amp; "&para;"  ; "" ) ) ; 

Substitute ( $$key ; $removekey &amp; "&para;"  ; "" ) ; 

Substitute ( $$key ; $removekey ; "" ) 

) ]</li>
<li>Set Variable [ $$key; Value:testlearn::kcKeywordOther ]</li>
<li>Go to Field [  ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Field [ reference::kkeywordOther; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used

If ( ValueCount ( $$key ) &ne; ValueCount ( Substitute ( $$key ; $removekey &amp; "&para;"  ; "" ) ) ; 

Substitute ( $$key ; $removekey &amp; "&para;"  ; "" ) ; 

Substitute ( $$key ; $removekey ; "" ) 

) ]</li>
<li>Set Variable [ $$key; Value:reference::kkeywordOther ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#This next part of the script checks to see if </li>
<li>#the otherKey field was affected.</li>
<li>#</li>
<li>If [ $$skipFirstPartOfScript = 1 ]</li>
<li>#</li>
<li>#</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Set Variable [ $removeKey; Value:testlearn::kKeywordPrimary ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Variable [ $removeKey; Value:reference::kkeywordPrimary ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Set Variable [ $recordNumber; Value:Get (RecordNumber) ]</li>
<li>Else If [ $$skipFirstPartOfScript &ne; 1 ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Set Variable [ $removeKey; Value:tagMenus::tag ]</li>
<li>End If</li>
<li>Refresh Window</li>
<li>#</li>
<li>#Now re-alphabetize after removing keyword.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>If [ $$skipFirstPartOfScript = 1 ]</li>
<li>Set Variable [ $$skipFirstPartOfScript ]</li>
<li>#</li>
<li>#</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Set Variable [ $removeKey; Value:testlearn::kKeywordPrimary ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Variable [ $removeKey; Value:reference::kkeywordPrimary ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#Order list alphabetically to re-construct otherKey</li>
<li>#field belonging to the citation record.</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>New Window [ Name: "reorder"; Height: 1; Width: 1; Top: -1000; Left: -1000 ]</li>
<li>Go to Layout [ &ldquo;ltagSCRIPTloops&rdquo; (tagMenus) ]</li>
<li>Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>#</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Set Variable [ $otherKeys; Value:testlearn::OtherKeyWords ]</li>
<li>Set Variable [ $testLearnRecordKey; Value:testlearn::_Ltestlearn ]</li>
<li>#</li>
<li>#Clear the field now in case all tags have been de-selected.</li>
<li>Set Field [ testlearn::OtherKeyWords; "" ]</li>
<li>Go to Field [  ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Variable [ $otherKeys; Value:reference::OtherKeyWords ]</li>
<li>#</li>
<li>#Clear the field now in case all tags have been de-selected.</li>
<li>Set Field [ reference::OtherKeyWords; "" ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#Find and set first value in keyword list.</li>
<li>#It will not have a comma in front like the other items.</li>
<li>Select Window [ Name: "reorder"; Current file ]</li>
<li>Loop</li>
<li>If [ tagMenus::_Ltag &amp; "&para;" = FilterValues ( $$key ; tagMenus::_Ltag &amp; "&para;" )

and

tagMenus::tag &ne; $removeKey ]</li>
<li>Set Variable [ $newKey; Value:tagMenus::tag ]</li>
<li>#</li>
<li>#</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>//  Select Window [ Name: "Learn"; Current file ]</li>
<li>Go to Layout [ &ldquo;learnSCRIPTloops&rdquo; (testlearn) ]</li>
<li>If [ $testLearnRecordKey &ne; testlearn::_Ltestlearn ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::_Ltestlearn; $testLearnRecordKey ]</li>
<li>Perform Find [  ]</li>
<li>End If</li>
<li>Set Field [ testlearn::OtherKeyWords; $newKey ]</li>
<li>Set Variable [ $otherKeys; Value:testlearn::OtherKeyWords ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Field [ reference::OtherKeyWords; $newKey ]</li>
<li>Set Variable [ $otherKeys; Value:reference::OtherKeyWords ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>Select Window [ Name: "reorder"; Current file ]</li>
<li>Exit Loop If [ tagMenus::_Ltag &amp; "&para;" = FilterValues ( $$key ; tagMenus::_Ltag &amp; "&para;" )

and

tagMenus::tag &ne; $removeKey ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Now add remaining keys to list.</li>
<li>Go to Layout [ &ldquo;ltagSCRIPTloops&rdquo; (tagMenus) ]</li>
<li>If [ Get (LastError) &ne; 101 ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>If [ Get (LastError) = 101 ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Close Window [ Name: "reorder"; Current file ]</li>
<li>Set Variable [ $$skipFirstPartOfScript ]</li>
<li>#</li>
<li>#Now close working Tag Menus window and rename</li>
<li>#users Tag Menus window to Tag Menus.</li>
<li>If [ $closeWindowWhenDone = 1 ]</li>
<li>Close Window [ Name: "Tag Menus"; Current file ]</li>
<li>Set Window Title [ Of Window: "Tag Menus Change Back When Done"; Current file; New Title: "Tag Menus" ]</li>
<li>End If</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Loop</li>
<li>If [ tagMenus::_Ltag &amp; "&para;" = FilterValues ( $$key ; tagMenus::_Ltag &amp; "&para;" )

and

tagMenus::tag &ne; $removeKey ]</li>
<li>Set Variable [ $newKey; Value:tagMenus::tag ]</li>
<li>#</li>
<li>#</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>//  Select Window [ Name: "Learn"; Current file ]</li>
<li>Go to Layout [ &ldquo;learnSCRIPTloops&rdquo; (testlearn) ]</li>
<li>Set Field [ testlearn::OtherKeyWords; $otherKeys &amp; ", " &amp; $newKey ]</li>
<li>Set Variable [ $otherKeys; Value:testlearn::OtherKeyWords ]</li>
<li>Go to Layout [ &ldquo;ltagSCRIPTloops&rdquo; (tagMenus) ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Field [ reference::OtherKeyWords; $otherKeys &amp; ", " &amp; $newKey ]</li>
<li>Set Variable [ $otherKeys; Value:reference::OtherKeyWords ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>Select Window [ Name: "reorder"; Current file ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>End If</li>
<li>#</li>
<li>//  #Sort records according to users wishes.</li>
<li>//  If [ TEMP::sortKey = "cat" ]</li>
<li>//  Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>//  Else If [ TEMP::sortKey = "abc" ]</li>
<li>//  Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>//  End If</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  Scroll Window
[ Home ]</li>
<li>//  Go to Record/Request/Page [ $recordNumber ]
[ No dialog ]</li>
<li>Close Window [ Name: "reorder"; Current file ]</li>
<li>Set Variable [ $$skipFirstPartOfScript ]</li>
<li>#</li>
<li>#Now close working Tag Menus window and rename</li>
<li>#users Tag Menus window to Tag Menus.</li>
<li>If [ $closeWindowWhenDone = 1 ]</li>
<li>Close Window [ Name: "Tag Menus"; Current file ]</li>
<li>Set Window Title [ Of Window: "Tag Menus Change Back When Done"; Current file; New Title: "Tag Menus" ]</li>
<li>End If</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearn</em>::kcKeywordOther</li>
<li>
<em>reference</em>::kkeywordOther</li>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>tagMenus</em>::match</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>ruleTagMenuGroups</em>::ksection</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>tagMenus</em>::tagSpelling</li>
<li>
<em>testlearn</em>::kKeywordPrimary</li>
<li>
<em>reference</em>::kkeywordPrimary</li>
<li>
<em>testlearn</em>::OtherKeyWords</li>
<li>
<em>reference</em>::OtherKeyWords</li>
<li>
<em>TEMP</em>::sortKey</li>
<li>
<em>ruleTagMenuGroups</em>::order</li>
<li>
<em>ruleTagMenuGroups</em>::name</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>testlearn</em>::_Ltestlearn</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33211ScriptAnchor_">CHUNKaddMainSectionKeysToTagRecordKeychain</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>ltagSCRIPTloops</li>
<li>learnSCRIPTloops</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32994ScriptAnchor_"></a><td class="script_navbar"><a href="#32992ScriptAnchor_"><span>Previous Script: [addORremoveTagFromCitationStep2keyword]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33011ScriptAnchor_"><span>Next Script: [changeSpellingOfCitationNodes]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">addORremoveTagFromCitationStep2node</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32987ScriptAnchor_">addTagToMainRecord</a></li>
<li><a href="#32995ScriptAnchor_">addORremoveTagFromCitationStep1</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>#</li>
<li>#This script adds tags to main reference or learn </li>
<li>#other tag fields.</li>
<li>If [ $$skipFirstPartOfScript &ne; 1 ]</li>
<li>#</li>
<li>#Get current record IDs in reference or </li>
<li>#learn or setup window.</li>
<li>#</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>Set Variable [ $$node; Value:tempSetup::kdefaultNodeOther ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Variable [ $$node; Value:testlearn::kNodeOther ]</li>
<li>End If</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Variable [ $$node; Value:reference::knodeOther ]</li>
<li>End If</li>
<li>#</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>#</li>
<li>#</li>
<li>#Create a new window in order to perform the next part</li>
<li>#without moving the focus around on the tag window.</li>
<li>#To do this, as this is being added after the script below</li>
<li>#was written, a hack is needed (so not the best way to</li>
<li>#accomplish this).  Rename the current window and then</li>
<li>#call the new window Tag Menus.  Then when done undo</li>
<li>#the renaming.  </li>
<li>Set Variable [ $currentSelectedTag; Value:tagMenus::_Ltag ]</li>
<li>Set Variable [ $closeWindowWhenDone; Value:1 ]</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>Set Window Title [ Current Window; New Title: "Tag Menus Change Back When Done" ]</li>
<li>New Window [ Name: "Tag Menus"; Height: 1; Width: 1; Top: -1000; Left: -1000 ]</li>
<li>#</li>
<li>#Make sure all tags are showing.  User may be only </li>
<li>#showing a few of the tags after performing a find.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::match; $$citationMatch ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; "==" &amp; TEMP::ksection ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Now loop to user selected tag.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $currentSelectedTag = tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#</li>
<li>#If tag user clicked has not yet been selected, then add it.</li>
<li>If [ tagMenus::_Ltag &amp; "&para;"  &ne;  FilterValues ( $$node ; tagMenus::_Ltag &amp; "&para;" ) ]</li>
<li>#</li>
<li>Set Variable [ $newNode; Value:tagMenus::_Ltag ]</li>
<li>#</li>
<li>#Set record number so can return user to it when done.</li>
<li>Set Variable [ $recordNumber; Value:Get (RecordNumber) ]</li>
<li>#</li>
<li>#</li>
<li>#Add node in reference or observation window.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>Set Field [ tempSetup::kdefaultNodeOther; $newNode &amp; "&para;" &amp; $$Node ]</li>
<li>Set Variable [ $$Node; Value:tempSetup::kdefaultNodeOther ]</li>
<li>If [ tempSetup::kdefaultNodePrimary = $newNode ]</li>
<li>Set Field [ tempSetup::kdefaultNodePrimary; "" ]</li>
<li>Set Variable [ $$citationItem ]</li>
<li>End If</li>
<li>Go to Field [  ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Field [ testlearn::kNodeOther; $newNode &amp; "&para;" &amp; $$Node ]</li>
<li>Set Variable [ $$Node; Value:testlearn::kNodeOther ]</li>
<li>If [ testlearn::kNodePrimary = $newNode ]</li>
<li>Set Field [ testlearn::kNodePrimary; "" ]</li>
<li>Set Variable [ $$citationItem ]</li>
<li>End If</li>
<li>Go to Field [  ]</li>
<li>End If</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Field [ reference::knodeOther; $newNode &amp; "&para;" &amp; $$Node ]</li>
<li>Set Variable [ $$Node; Value:reference::knodeOther ]</li>
<li>If [ reference::knodePrimary = $newNode ]</li>
<li>Set Field [ reference::knodePrimary; "" ]</li>
<li>Set Variable [ $$citationItem ]</li>
<li>End If</li>
<li>Go to Field [  ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#Now re-alphabetize and add new node to citation.</li>
<li>Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>#</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>Set Variable [ $otherNodes; Value:tempSetup::DEFAULTNodeOtherNames ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Variable [ $otherNodes; Value:testlearn::NodeOthers ]</li>
<li>End If</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Variable [ $otherNodes; Value:reference::NodeOthers ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#Find and set first value in node list.</li>
<li>#It will not have a comma in front like the other items.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Loop</li>
<li>If [ tagMenus::_Ltag &amp; "&para;" = FilterValues ( $$Node ; tagMenus::_Ltag &amp; "&para;" ) ]</li>
<li>Set Variable [ $newNode; Value:tagMenus::tag ]</li>
<li>#</li>
<li>#</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>Set Field [ tempSetup::DEFAULTNodeOtherNames; $newNode ]</li>
<li>Set Variable [ $otherNodes; Value:tempSetup::DEFAULTNodeOtherNames ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Field [ testlearn::NodeOthers; $newNode ]</li>
<li>Set Variable [ $otherNodes; Value:testlearn::NodeOthers ]</li>
<li>End If</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Field [ reference::NodeOthers; $newNode ]</li>
<li>Set Variable [ $otherNodes; Value:reference::NodeOthers ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Exit Loop If [ tagMenus::_Ltag &amp; "&para;" = FilterValues ( $$Node ; tagMenus::_Ltag &amp; "&para;" ) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Now add remaining nodes to list.</li>
<li>Loop</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>If [ tagMenus::_Ltag &amp; "&para;" = FilterValues ( $$Node ; tagMenus::_Ltag &amp; "&para;" ) ]</li>
<li>Set Variable [ $newNode; Value:tagMenus::tag ]</li>
<li>#</li>
<li>#</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>Set Field [ tempSetup::DEFAULTNodeOtherNames; $otherNodes &amp; "; " &amp; $newNode ]</li>
<li>Set Variable [ $otherNodes; Value:tempSetup::DEFAULTNodeOtherNames ]</li>
<li>Set Variable [ $setup; Value:1 ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Field [ testlearn::NodeOthers; $otherNodes &amp; "; " &amp; $newNode ]</li>
<li>Set Variable [ $otherNodes; Value:testlearn::NodeOthers ]</li>
<li>End If</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Field [ reference::NodeOthers; $otherNodes &amp; "; " &amp; $newNode ]</li>
<li>Set Variable [ $otherNodes; Value:reference::NodeOthers ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>//  Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Commit records so user can change spelling.</li>
<li>#Without commit, the system will not find</li>
<li>#the newly added tag.</li>
<li>Commit Records/Requests</li>
<li>Go to Field [  ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>#</li>
<li>//  #Sort records according to users wishes.</li>
<li>//  #Sort according to current users wishes.  By default</li>
<li>//  #the sort will be by category which is set by editCitation script.</li>
<li>//  If [ TEMP::sortNode = "cat" and Left (Get (LayoutName) ; 11) = "defaultNode"
 or 
TEMP::sortNode = "" and Left (Get (LayoutName) ; 11) = "defaultNode" ]</li>
<li>//  Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>//  Else If [ TEMP::sortNode = "abc" and Left (Get (LayoutName) ; 11) = "defaultNode" ]</li>
<li>//  Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>//  End If</li>
<li>//  If [ TEMP::sortKey = "cat" and Get (LayoutName) &ne; "defaultNode" ]</li>
<li>//  Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>//  Else If [ TEMP::sortKey = "abc" and Get (LayoutName) &ne; "defaultNode" ]</li>
<li>//  Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>//  End If</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $recordNumber ]
[ No dialog ]</li>
<li>#</li>
<li>#If reference or learn record that tag was added</li>
<li>#to belongs to more than one section, then </li>
<li>#add these other sections to the tag's group </li>
<li>#keychain so when this tag record is viewed in </li>
<li>#those sections, the reference or learn record </li>
<li>#just added to it will show up as well.</li>
<li>If [ $setup &ne; 1 ]</li>
<li>Perform Script [ &ldquo;CHUNKaddMainSectionKeysToTagRecordKeychain&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>#Now close working Tag Menus window and rename</li>
<li>#users Tag Menus window to Tag Menus.</li>
<li>Close Window [ Name: "Tag Menus"; Current file ]</li>
<li>Set Window Title [ Of Window: "Tag Menus Change Back When Done"; Current file; New Title: "Tag Menus" ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#If tag has been selected, then remove it.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Set Variable [ $removeNode; Value:tagMenus::_Ltag ]</li>
<li>#</li>
<li>#Set record number so can return user to it when done.</li>
<li>Set Variable [ $recordNumber; Value:Get (RecordNumber) ]</li>
<li>#</li>
<li>#</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>Set Variable [ $$Node; Value:tempSetup::kdefaultNodeOther ]</li>
<li>Set Field [ tempSetup::kdefaultNodeOther; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used

If ( ValueCount ( $$Node ) &ne; ValueCount ( Substitute ( $$Node ; $removeNode &amp; "&para;"  ; "" ) ) ; 

Substitute ( $$Node ; $removeNode &amp; "&para;"  ; "" ) ; 

Substitute ( $$Node ; $removeNode ; "" ) 

) ]</li>
<li>Set Variable [ $$Node; Value:tempSetup::kdefaultNodeOther ]</li>
<li>Go to Field [  ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Field [ testlearn::kNodeOther; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used

If ( ValueCount ( $$Node ) &ne; ValueCount ( Substitute ( $$Node ; $removeNode &amp; "&para;"  ; "" ) ) ; 

Substitute ( $$Node ; $removeNode &amp; "&para;"  ; "" ) ; 

Substitute ( $$Node ; $removeNode ; "" ) 

) ]</li>
<li>Set Variable [ $$Node; Value:testlearn::kNodeOther ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Field [ reference::knodeOther; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used

If ( ValueCount ( $$Node ) &ne; ValueCount ( Substitute ( $$Node ; $removeNode &amp; "&para;"  ; "" ) ) ; 

Substitute ( $$Node ; $removeNode &amp; "&para;"  ; "" ) ; 

Substitute ( $$Node ; $removeNode ; "" ) 

) ]</li>
<li>Set Variable [ $$Node; Value:reference::knodeOther ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#This next part of the script checks to see if </li>
<li>#the otherNode field was affected.</li>
<li>If [ $$skipFirstPartOfScript = 1 ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>Set Variable [ $removeNode; Value:tempSetup::kdefaultNodePrimary ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Variable [ $removeNode; Value:testlearn::kNodePrimary ]</li>
<li>End If</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Variable [ $removeNode; Value:reference::knodePrimary ]</li>
<li>End If</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Set Variable [ $recordNumber; Value:Get (RecordNumber) ]</li>
<li>Else If [ $$skipFirstPartOfScript &ne; 1 ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Set Variable [ $removeNode; Value:tagMenus::tag ]</li>
<li>End If</li>
<li>Refresh Window</li>
<li>#</li>
<li>#Now re-alphabetize after removing node.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>If [ $$skipFirstPartOfScript = 1 ]</li>
<li>Set Variable [ $$skipFirstPartOfScript ]</li>
<li>#</li>
<li>#</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>Set Variable [ $removeNode; Value:tempSetup::kdefaultNodePrimary ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Variable [ $removeNode; Value:testlearn::kNodePrimary ]</li>
<li>End If</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Variable [ $removeNode; Value:reference::knodePrimary ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#Order list alphabetically to re-construct otherNode</li>
<li>#field belonging to the citation record.</li>
<li>//  Sort Records [  ]
[ No dialog ]</li>
<li>//  Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>New Window [ Name: "reorder"; Height: 1; Width: 1; Top: -1000; Left: -1000 ]</li>
<li>Go to Layout [ &ldquo;ltagSCRIPTloops&rdquo; (tagMenus) ]</li>
<li>Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>#</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>Set Variable [ $otherNodes; Value:tempSetup::DEFAULTNodeOtherNames ]</li>
<li>#</li>
<li>#Clear the field now in case all tags have been de-selected.</li>
<li>Set Field [ tempSetup::DEFAULTNodeOtherNames; "" ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Variable [ $otherNodes; Value:testlearn::NodeOthers ]</li>
<li>#</li>
<li>#Clear the field now in case all tags have been de-selected.</li>
<li>Set Field [ testlearn::NodeOthers; "" ]</li>
<li>End If</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Variable [ $otherNodes; Value:reference::NodeOthers ]</li>
<li>#</li>
<li>#Clear the field now in case all tags have been de-selected.</li>
<li>Set Field [ reference::NodeOthers; "" ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#Find and set first value in node list.</li>
<li>#It will not have a comma in front like the other items.</li>
<li>//  Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Select Window [ Name: "reorder"; Current file ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>If [ tagMenus::_Ltag &amp; "&para;" = FilterValues ( $$Node ; tagMenus::_Ltag &amp; "&para;" )

and

tagMenus::tag &ne; $removeNode ]</li>
<li>Set Variable [ $newNode; Value:tagMenus::tag ]</li>
<li>#</li>
<li>#</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>//  Go to Layout [ &ldquo;learnSCRIPTloops&rdquo; (testlearn) ]</li>
<li>Set Field [ testlearn::NodeOthers; $newNode ]</li>
<li>Set Variable [ $otherNodes; Value:testlearn::NodeOthers ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Field [ tempSetup::DEFAULTNodeOtherNames; $newNode ]</li>
<li>Set Variable [ $otherNodes; Value:tempSetup::DEFAULTNodeOtherNames ]</li>
<li>End If</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Field [ reference::NodeOthers; $newNode ]</li>
<li>Set Variable [ $otherNodes; Value:reference::NodeOthers ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>//  Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Select Window [ Name: "reorder"; Current file ]</li>
<li>Exit Loop If [ tagMenus::_Ltag &amp; "&para;" = FilterValues ( $$Node ; tagMenus::_Ltag &amp; "&para;" )

and

tagMenus::tag &ne; $removeNode ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Now add remaining nodes to alphabetical list.</li>
<li>Go to Layout [ &ldquo;ltagSCRIPTloops&rdquo; (tagMenus) ]</li>
<li>If [ Get (LastError) &ne; 101 ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>If [ Get (LastError) = 101 ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Close Window [ Name: "reorder"; Current file ]</li>
<li>Set Variable [ $$skipFirstPartOfScript ]</li>
<li>#</li>
<li>#Now close working Tag Menus window and rename</li>
<li>#users Tag Menus window to Tag Menus.</li>
<li>If [ $closeWindowWhenDone = 1 ]</li>
<li>Close Window [ Name: "Tag Menus"; Current file ]</li>
<li>Set Window Title [ Of Window: "Tag Menus Change Back When Done"; Current file; New Title: "Tag Menus" ]</li>
<li>End If</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Loop</li>
<li>If [ tagMenus::_Ltag &amp; "&para;" = FilterValues ( $$Node ; tagMenus::_Ltag &amp; "&para;" )

and

tagMenus::tag &ne; $removeNode ]</li>
<li>Set Variable [ $newNode; Value:tagMenus::tag ]</li>
<li>#</li>
<li>#</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>Set Field [ tempSetup::DEFAULTNodeOtherNames; $otherNodes &amp; "; " &amp; $newNode ]</li>
<li>Set Variable [ $otherNodes; Value:tempSetup::DEFAULTNodeOtherNames ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>//  Go to Layout [ &ldquo;learnSCRIPTloops&rdquo; (testlearn) ]</li>
<li>Set Field [ testlearn::NodeOthers; $otherNodes &amp; "; " &amp; $newNode ]</li>
<li>Set Variable [ $otherNodes; Value:testlearn::NodeOthers ]</li>
<li>End If</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Field [ reference::NodeOthers; $otherNodes &amp; "; " &amp; $newNode ]</li>
<li>Set Variable [ $otherNodes; Value:reference::NodeOthers ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>//  Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Select Window [ Name: "reorder"; Current file ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>End If</li>
<li>#</li>
<li>//  #Sort records according to users wishes.</li>
<li>//  #Sort according to current users wishes.  By default</li>
<li>//  #the sort will be by category which is set by editCitation script.</li>
<li>//  If [ TEMP::sortNode = "cat" and Get (LayoutName) = "defaultNode"
 or 
TEMP::sortNode = "" and Get (LayoutName) = "defaultNode" ]</li>
<li>//  Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>//  Else If [ TEMP::sortNode = "abc" and Get (LayoutName) = "defaultNode" ]</li>
<li>//  Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>//  End If</li>
<li>//  If [ TEMP::sortKey = "cat" and Get (LayoutName) &ne; "defaultNode" ]</li>
<li>//  Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>//  Else If [ TEMP::sortKey = "abc" and Get (LayoutName) &ne; "defaultNode" ]</li>
<li>//  Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>//  End If</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  Scroll Window
[ Home ]</li>
<li>//  Go to Record/Request/Page [ $recordNumber ]
[ No dialog ]</li>
<li>Close Window [ Name: "reorder"; Current file ]</li>
<li>Set Variable [ $$skipFirstPartOfScript ]</li>
<li>#</li>
<li>#Now close working Tag Menus window and rename</li>
<li>#users Tag Menus window to Tag Menus.</li>
<li>If [ $closeWindowWhenDone = 1 ]</li>
<li>Close Window [ Name: "Tag Menus"; Current file ]</li>
<li>Set Window Title [ Of Window: "Tag Menus Change Back When Done"; Current file; New Title: "Tag Menus" ]</li>
<li>End If</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tempSetup</em>::kdefaultNodeOther</li>
<li>
<em>testlearn</em>::kNodeOther</li>
<li>
<em>reference</em>::knodeOther</li>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>tagMenus</em>::match</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>ruleTagMenuGroups</em>::ksection</li>
<li>
<em>tempSetup</em>::kdefaultNodePrimary</li>
<li>
<em>testlearn</em>::kNodePrimary</li>
<li>
<em>reference</em>::knodePrimary</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>tempSetup</em>::DEFAULTNodeOtherNames</li>
<li>
<em>testlearn</em>::NodeOthers</li>
<li>
<em>reference</em>::NodeOthers</li>
<li>
<em>TEMP</em>::sortNode</li>
<li>
<em>ruleTagMenuGroups</em>::order</li>
<li>
<em>ruleTagMenuGroups</em>::name</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>TEMP</em>::sortKey</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33211ScriptAnchor_">CHUNKaddMainSectionKeysToTagRecordKeychain</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>ltagSCRIPTloops</li>
<li>learnSCRIPTloops</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33011ScriptAnchor_"></a><td class="script_navbar"><a href="#32994ScriptAnchor_"><span>Previous Script: [addORremoveTagFromCitationStep2node]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#32996ScriptAnchor_"><span>Next Script: [sortTags]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">changeSpellingOfCitationNodes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Variable [ $key; Value:reference::referenceNodes ]</li>
<li>Set Variable [ $keyOLD; Value:reference::referenceNodesOLD ]</li>
<li>Set Variable [ $keyChain; Value:reference::kcopyrightHolder ]</li>
<li>#</li>
<li>#</li>
<li>If [ $keyOLD &amp; "&para;"  = FilterValues ( $keychain ; $keyOLD &amp; "&para;" ) and $key = "" ]</li>
<li>Set Field [ reference::kcopyrightHolder; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used

//If ( ValueCount ( $keyChain ) &ne; ValueCount ( Substitute ( $keyChain ; $key &amp; "&para;"  ; "" ) ) ; 

Substitute ( $keyChain ; $keyOLD &amp; "&para;"  ; "" )   //; 

//Substitute ( $keyChain ; $key ; "" ) 

//) ]</li>
<li>Else If [ $keyOLD &amp; "&para;"  = FilterValues ( $keychain ; $keyOLD &amp; "&para;" ) ]</li>
<li>Set Field [ reference::kcopyrightHolder; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used

//If ( ValueCount ( $keyChain ) &ne; ValueCount ( Substitute ( $keyChain ; $key &amp; "&para;"  ; "" ) ) ; 

Substitute ( $keyChain ; $keyOLD &amp; "&para;"  ; $key &amp; "&para;" )   //; 

//Substitute ( $keyChain ; $key ; "" ) 

//) ]</li>
<li>End If</li>
<li>Set Field [ reference::referenceNodesOLD; $key ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::referenceNodes</li>
<li>
<em>reference</em>::referenceNodesOLD</li>
<li>
<em>reference</em>::kcopyrightHolder</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32996ScriptAnchor_"></a><td class="script_navbar"><a href="#33011ScriptAnchor_"><span>Previous Script: [changeSpellingOfCitationNodes]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33066ScriptAnchor_"><span>Next Script: [addORremoveRefTagStep1]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">sortTags</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Sort records and save sort state for future visits.</li>
<li>If [ $$citationMatch = "key" and TEMP::sortKey = "abc" ]</li>
<li>Set Field [ TEMP::sortKey; "cat" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ $$citationMatch = "node" and TEMP::sortNode = "abc" ]</li>
<li>Set Field [ TEMP::sortNode; "cat" ]</li>
<li>#Disabled this sort because the order lock puts the</li>
<li>#creator node when lock is active at bottom of list v</li>
<li>#in alpha order within category list.</li>
<li>//  Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ $$citationMatch = "medium" and TEMP::sortMedium = "abc" ]</li>
<li>Set Field [ TEMP::sortMedium; "cat" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ $$citationMatch = "copyist" and TEMP::sortCopyist = "abc" ]</li>
<li>Set Field [ TEMP::sortCopyist; "cat" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ $$citationMatch = "path" and TEMP::sortPath = "abc" ]</li>
<li>Set Field [ TEMP::sortPath; "cat" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ $$citationMatch = "health" and TEMP::sortHealth = "abc" ]</li>
<li>Set Field [ TEMP::sortHealth; "cat" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ $$citationMatch = "organ" and TEMP::sortOrgan = "abc" ]</li>
<li>Set Field [ TEMP::sortOrgan; "cat" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ $$citationMatch = "sample" and TEMP::sortSample = "abc" ]</li>
<li>Set Field [ TEMP::sortSample; "cat" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ $$citationMatch = "location" and TEMP::sortLocation = "abc" ]</li>
<li>Set Field [ TEMP::sortLocation; "cat" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ $$citationMatch = "test" and TEMP::sortTest = "abc"
 or 
Left ( Get ( LayoutName ) ; 4 ) = "test" and TEMP::sortTest = "abc" ]</li>
<li>Set Field [ TEMP::sortTest; "cat" ]</li>
<li>Sort Records [ Specified Sort Order: groupTest::order; based on value list: &ldquo;order&rdquo;
groupTest::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
test::order; ascending
test::testName; ascending ]
[ Restore; No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ $$citationMatch = "cite" and TEMP::sortCite = "abc" ]</li>
<li>Set Field [ TEMP::sortCite; "cat" ]</li>
<li>Sort Records [ Specified Sort Order: tagKeywordPrimary::orderOrLock; ascending
tagKeywordPrimary::tag; ascending
reference::referenceShort; ascending ]
[ Restore; No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ $$citationMatch = "ref" and TEMP::sortRef = "abc" ]</li>
<li>Set Field [ TEMP::sortRef; "cat" ]</li>
<li>Sort Records [ Specified Sort Order: tagKeywordPrimary::orderOrLock; ascending
tagKeywordPrimary::tag; ascending
reference::referenceShort; ascending ]
[ Restore; No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ $$citationMatch = "testItem" and TEMP::sortTestItem = "abc" ]</li>
<li>Set Field [ TEMP::sortTestItem; "cat" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuTestGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuTestGroups::_Lgroup; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#Sort records and save sort state for future visits.</li>
<li>If [ $$citationMatch = "key" ]</li>
<li>Set Field [ TEMP::sortKey; "abc" ]</li>
<li>Else If [ $$citationMatch = "node" ]</li>
<li>Set Field [ TEMP::sortNode; "abc" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagSectionName::name; ascending
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ $$citationMatch = "medium" ]</li>
<li>Set Field [ TEMP::sortMedium; "abc" ]</li>
<li>Else If [ $$citationMatch = "copyist" ]</li>
<li>Set Field [ TEMP::sortCopyist; "abc" ]</li>
<li>Else If [ $$citationMatch = "path" ]</li>
<li>Set Field [ TEMP::sortPath; "abc" ]</li>
<li>Else If [ $$citationMatch = "health" ]</li>
<li>Set Field [ TEMP::sortHealth; "abc" ]</li>
<li>Else If [ $$citationMatch = "organ" ]</li>
<li>Set Field [ TEMP::sortOrgan; "abc" ]</li>
<li>Else If [ $$citationMatch = "sample" ]</li>
<li>Set Field [ TEMP::sortSample; "abc" ]</li>
<li>Else If [ $$citationMatch = "location" ]</li>
<li>Set Field [ TEMP::sortLocation; "abc" ]</li>
<li>Else If [ $$citationMatch = "testItem" ]</li>
<li>Set Field [ TEMP::sortTestItem; "abc" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuTestGroups::name; ascending
test::testName; ascending ]
[ Restore; No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ $$citationMatch = "test"
 or 
Left ( Get ( LayoutName ) ; 4 ) = "test" ]</li>
<li>Set Field [ TEMP::sortTest; "abc" ]</li>
<li>Sort Records [ Specified Sort Order: test::testName; ascending ]
[ Restore; No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ $$citationMatch = "cite" ]</li>
<li>Set Field [ TEMP::sortCite; "abc" ]</li>
<li>Sort Records [ Specified Sort Order: reference::referenceShort; ascending ]
[ Restore; No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ $$citationMatch = "ref" ]</li>
<li>Set Field [ TEMP::sortRef; "abc" ]</li>
<li>Sort Records [ Specified Sort Order: reference::referenceShort; ascending ]
[ Restore; No dialog ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::sortKey</li>
<li>
<em>ruleTagMenuGroups</em>::order</li>
<li>
<em>ruleTagMenuGroups</em>::name</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>TEMP</em>::sortNode</li>
<li>
<em>TEMP</em>::sortMedium</li>
<li>
<em>TEMP</em>::sortCopyist</li>
<li>
<em>TEMP</em>::sortPath</li>
<li>
<em>TEMP</em>::sortHealth</li>
<li>
<em>TEMP</em>::sortOrgan</li>
<li>
<em>TEMP</em>::sortSample</li>
<li>
<em>TEMP</em>::sortLocation</li>
<li>
<em>TEMP</em>::sortTest</li>
<li>
<em>groupTest</em>::order</li>
<li>
<em>groupTest</em>::name</li>
<li>
<em>test</em>::order</li>
<li>
<em>test</em>::testName</li>
<li>
<em>TEMP</em>::sortCite</li>
<li>
<em>tagKeywordPrimary</em>::orderOrLock</li>
<li>
<em>tagKeywordPrimary</em>::tag</li>
<li>
<em>reference</em>::referenceShort</li>
<li>
<em>TEMP</em>::sortRef</li>
<li>
<em>TEMP</em>::sortTestItem</li>
<li>
<em>ruleTagMenuTestGroups</em>::order</li>
<li>
<em>ruleTagMenuTestGroups</em>::_Lgroup</li>
<li>
<em>ruleTagSectionName</em>::name</li>
<li>
<em>ruleTagMenuTestGroups</em>::name</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33066ScriptAnchor_"></a><td class="script_navbar"><a href="#32996ScriptAnchor_"><span>Previous Script: [sortTags]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Next Script: [CHUNKaddMainSectionKeysToTagRecordKeychain_addMode]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">addORremoveRefTagStep1</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#Remove focus from field so can see </li>
<li>#conditional formatting.</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Determine if user is looking at cite or ref.</li>
<li>#NOTE: The cite idea is no longer being used.  So,</li>
<li>#when here is time to properly test, these cite script</li>
<li>#steps need to be removed.  END NOTE</li>
<li>If [ $$citationMatch = "cite" ]</li>
<li>Perform Script [ &ldquo;addTagToMainRecord&rdquo; ]</li>
<li>Else If [ $$citationMatch = "ref" ]</li>
<li>If [ Right ( Get (LayoutName) ; 7 ) = "RefCite" ]</li>
<li>#</li>
<li>#Check if tagging would cause record to reference itself.</li>
<li>If [ testlearn::_Ltestlearn = $$citation ]</li>
<li>Show Custom Dialog [ Message: "Records cannot reference themselves."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#Complete process.</li>
<li>Perform Script [ &ldquo;addORremoveCiteOrRefTLTag&rdquo; ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Perform Script [ &ldquo;addORremoveCitationOrReferenceRefTag&rdquo; ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearn</em>::_Ltestlearn</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32987ScriptAnchor_">addTagToMainRecord</a></li>
<li><a href="#33067ScriptAnchor_">addORremoveCiteOrRefTLTag</a></li>
<li><a href="#33065ScriptAnchor_">addORremoveCitationOrReferenceRefTag</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33208ScriptAnchor_"></a><td class="script_navbar"><a href="#33066ScriptAnchor_"><span>Previous Script: [addORremoveRefTagStep1]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33211ScriptAnchor_"><span>Next Script: [CHUNKaddMainSectionKeysToTagRecordKeychain]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">CHUNKaddMainSectionKeysToTagRecordKeychain_addMode</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33207ScriptAnchor_">CHUNKaddReferenceNodesAndKeywords</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Add any section keys just added to the main record</li>
<li>#that are not in this tag's section group keychain, so that</li>
<li>#this tag will show up in all sections the main record</li>
<li>#shows up in.  ( Section tags</li>
<li>#    are assigned to groups, not individual tags. </li>
<li>#    So if the user wants one tag to be assigned</li>
<li>#    to a new section, its group and all tags in</li>
<li>#    its group must be assigned to the new section.</li>
<li>#    The reason for this is because the display of</li>
<li>#    tags by group requires that each group</li>
<li>#    have a unique name and that each tag belong</li>
<li>#    to a group. )</li>
<li>#</li>
<li>#Determine how many keys there are.</li>
<li>Set Variable [ $numberOfKeys; Value:ValueCount ( $$mainKeychain ) ]</li>
<li>#</li>
<li>#Loop thru each key to see if any do not match</li>
<li>#keys in the tag group's keychain.</li>
<li>Loop</li>
<li>#</li>
<li>#Exit the loop when there are no more keys to check.</li>
<li>Exit Loop If [ $numberOfKeys = 0 ]</li>
<li>#</li>
<li>If [ GetValue ( $$mainKeychain ; $numberOfKeys ) &ne; GetValue ( FilterValues ( ruleTagMenuGroups::ksection &amp; &para; ; GetValue ( $$mainKeychain ; $numberOfKeys ) &amp; &para; ) ; 1 ) ]</li>
<li>#</li>
<li>#Next, add the current section key to this </li>
<li>#group's keychain.</li>
<li>Set Variable [ $groupSectionKeychain; Value:ruleTagMenuGroups::ksection ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; GetValue ( $$mainKeychain ; $numberOfKeys )  &amp; &para; &amp; $groupSectionKeychain ]</li>
<li>#</li>
<li>End If</li>
<li>#</li>
<li>#Go the next key up from the bottom of the list</li>
<li>#of keys on this section's keychain.</li>
<li>Set Variable [ $numberOfKeys; Value:$numberOfKeys - 1 ]</li>
<li>End Loop</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>ruleTagMenuGroups</em>::ksection</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33211ScriptAnchor_"></a><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Previous Script: [CHUNKaddMainSectionKeysToTagRecordKeychain_addMode]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33212ScriptAnchor_"><span>Next Script: [CHUNKaddMainRecordSectionKeysToCiteOrRefSectionKeychain]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">CHUNKaddMainSectionKeysToTagRecordKeychain</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32987ScriptAnchor_">addTagToMainRecord</a></li>
<li><a href="#32992ScriptAnchor_">addORremoveTagFromCitationStep2keyword</a></li>
<li><a href="#32994ScriptAnchor_">addORremoveTagFromCitationStep2node</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If reference or learn record that tag was added</li>
<li>#to belongs to more than one section, then </li>
<li>#add these other sections to the tag's group </li>
<li>#keychain so when this tag record is viewed in </li>
<li>#those sections, the reference or learn record </li>
<li>#just added to it will show up as well.</li>
<li>#NOTE: Add only section keys to keyword and node tags.</li>
<li>If [ $$citationMatch = "node" or $$citationMatch = "key" ]</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>Set Variable [ $keychain; Value:reference::kcsection ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>#</li>
<li>#If the user was not looking at Refernce records</li>
<li>#then the keychain variable will be blank and need</li>
<li>#to be filled in.  But if they were then filling it in</li>
<li>#as if Learn records where showing would blank</li>
<li>#the just filled in keychain variable.</li>
<li>If [ $keychain = "" ]</li>
<li>Set Variable [ $keychain; Value:testlearn::kcsection ]</li>
<li>End If</li>
<li>#</li>
<li>#Determine how many keys there are.</li>
<li>Set Variable [ $numberOfKeys; Value:ValueCount ( $keychain ) ]</li>
<li>#</li>
<li>#Loop thru each key to see if any do not match</li>
<li>#keys in the tag group's keychain.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Loop</li>
<li>#</li>
<li>#Exit the loop when there are no more keys to check.</li>
<li>Exit Loop If [ $numberOfKeys = 0 ]</li>
<li>#</li>
<li>If [ GetValue ( $keychain ; $numberOfKeys ) &ne; GetValue ( FilterValues ( ruleTagMenuGroups::ksection &amp; &para; ; GetValue ( $keychain ; $numberOfKeys ) &amp; &para; ) ; 1 ) ]</li>
<li>#</li>
<li>#Next, add the current section key to this </li>
<li>#group's keychain.</li>
<li>Set Variable [ $groupSectionKeychain; Value:ruleTagMenuGroups::ksection ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; GetValue ( $keychain ; $numberOfKeys )  &amp; &para; &amp; $groupSectionKeychain ]</li>
<li>#</li>
<li>End If</li>
<li>#</li>
<li>#Go the next key up from the bottom of the list</li>
<li>#of keys on this section's keychain.</li>
<li>Set Variable [ $numberOfKeys; Value:$numberOfKeys - 1 ]</li>
<li>End Loop</li>
<li>End If</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::kcsection</li>
<li>
<em>testlearn</em>::kcsection</li>
<li>
<em>ruleTagMenuGroups</em>::ksection</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33212ScriptAnchor_"></a><td class="script_navbar"><a href="#33211ScriptAnchor_"><span>Previous Script: [CHUNKaddMainSectionKeysToTagRecordKeychain]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33067ScriptAnchor_"><span>Next Script: [addORremoveCiteOrRefTLTag]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">CHUNKaddMainRecordSectionKeysToCiteOrRefSectionKeychain</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32987ScriptAnchor_">addTagToMainRecord</a></li>
<li><a href="#33067ScriptAnchor_">addORremoveCiteOrRefTLTag</a></li>
<li><a href="#33065ScriptAnchor_">addORremoveCitationOrReferenceRefTag</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If learn record that tag was added</li>
<li>#to belongs to more than one section, then </li>
<li>#add these other sections to the learn or reference</li>
<li>#keychain so when this learn record is viewed in </li>
<li>#those sections, the reference or learn record </li>
<li>#just added to it will show up as well.</li>
<li>#NOTE: Once a learn record is tagged with reference</li>
<li>#records -- other learn and reference records --</li>
<li>#it is prevented in add mode from acquiring new keys</li>
<li>#which would need to be passed along to these added</li>
<li>#records, and then to all of their references, and so on.</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>If [ Get (LastError) = 0 ]</li>
<li>Set Variable [ $keychain; Value:testlearn::kcsection ]</li>
<li>If [ testlearn::kcitation &ne; "" and $$citationMatch = "ref" ]</li>
<li>Show Custom Dialog [ Message: "References can be added after the citation is removed. (Cite the source of an unchanged copy, clip, quote, etc. from one source. Reference the sources of your rewording/remixing of one or more texts, movies, etc.)"; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Halt Script</li>
<li>Else If [ testlearn::kcreference &ne; "" and $$citationMatch = "cite" ]</li>
<li>If [ ValueCount ( testlearn::kcreference ) = 1 ]</li>
<li>Show Custom Dialog [ Message: "A citiation can be added after the referene is removed. (Cite the source of an unchanged copy, clip, quote, etc. from one source. Reference the sources of your rewording/remixing of one or more texts, movies, etc.)"; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Else</li>
<li>Show Custom Dialog [ Message: "A citiation can be added after referenes are removed. (Cite the source of an unchanged copy, clip, quote, etc. from one source. Reference the sources of your rewording/remixing of one or more texts, movies, etc.)"; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Else If [ Get (LastError) &ne; 0 ]</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>Set Variable [ $keychain; Value:reference::kcsection ]</li>
<li>End If</li>
<li>#</li>
<li>#Determine how many keys there are.</li>
<li>Set Variable [ $numberOfKeys; Value:ValueCount ( $keychain ) ]</li>
<li>#</li>
<li>#Loop thru each key to see if any do not match</li>
<li>#keys in the main record's keychain.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Loop</li>
<li>#</li>
<li>#Exit the loop when there are no more keys to check.</li>
<li>Exit Loop If [ $numberOfKeys = 0 ]</li>
<li>#</li>
<li>#If main record being tagged does not have</li>
<li>#one or more of the tag's keys in its keychain then</li>
<li>#add the missing keys.</li>
<li>If [ Get ( LayoutTableName ) = "testlearn"  and  

GetValue ( $keychain ; $numberOfKeys ) &ne; 
GetValue ( FilterValues ( testlearn::kcsection &amp; &para; ; GetValue ( $keychain ; $numberOfKeys ) &amp; &para; ) ; 1 ) ]</li>
<li>#</li>
<li>#Stop script if user trying to add reference or learn record</li>
<li>#that has references or citations added to it.</li>
<li>#Records being added to have to share their section</li>
<li>#keys with all records being added to them.  But</li>
<li>#when a record is addd that is missing some of its</li>
<li>#is added AND that record has records added to it</li>
<li>#as a citation or reference life gets really complicated.</li>
<li>#So to simplify things for now, tag adding cannot happen</li>
<li>#once a record aquires references and tags.  A record</li>
<li>#can be added as a reference or a citation as long as</li>
<li>#it is has all the tags of the record it is being added to.</li>
<li>If [ testlearn::kcitation &ne; "" or testlearn::kcreference &ne; "" or reference::kcitation &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "This record you wish to add can be added if you first remove the citation or references that are linked to it. Once added, these removed records can be added back."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#Next, add the current section key to this </li>
<li>#group's keychain.</li>
<li>Set Variable [ $groupSectionKeychain; Value:testlearn::kcsection ]</li>
<li>Set Field [ testlearn::kcsection; GetValue ( $keychain ; $numberOfKeys )  &amp; &para; &amp; $groupSectionKeychain ]</li>
<li>#</li>
<li>Else If [ Get ( LayoutTableName ) = "reference" and  

GetValue ( $keychain ; $numberOfKeys ) &ne; 
GetValue ( FilterValues ( reference::kcsection &amp; &para; ; GetValue ( $keychain ; $numberOfKeys ) &amp; &para; ) ; 1 ) ]</li>
<li>#</li>
<li>#Stop script if user trying to add reference or learn record</li>
<li>#that has references or citations added to it.</li>
<li>#Records being added to have to share their section</li>
<li>#keys with all records being added to them.  But</li>
<li>#when a record is addd that is missing some of its</li>
<li>#is added AND that record has records added to it</li>
<li>#as a citation or reference life gets really complicated.</li>
<li>#So to simplify things for now, tag adding cannot happen</li>
<li>#once a record aquires references and tags.  A record</li>
<li>#can be added as a reference or a citation as long as</li>
<li>#it is has all the tags of the record it is being added to.</li>
<li>If [ testlearn::kcitation &ne; "" or testlearn::kcreference &ne; "" or reference::kcitation &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "This record you wish to add can be added if you first remove the citation or references that are linked to it. Once added, these removed records can be added back."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#Next, add the current section key to this </li>
<li>#group's keychain.</li>
<li>Set Variable [ $groupSectionKeychain; Value:reference::kcsection ]</li>
<li>Set Field [ reference::kcsection; GetValue ( $keychain ; $numberOfKeys )  &amp; &para; &amp; $groupSectionKeychain ]</li>
<li>#</li>
<li>End If</li>
<li>#</li>
<li>#Go the next key up from the bottom of the list</li>
<li>#of keys on this section's keychain.</li>
<li>Set Variable [ $numberOfKeys; Value:$numberOfKeys - 1 ]</li>
<li>End Loop</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearn</em>::kcsection</li>
<li>
<em>testlearn</em>::kcitation</li>
<li>
<em>testlearn</em>::kcreference</li>
<li>
<em>reference</em>::kcsection</li>
<li>
<em>reference</em>::kcitation</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33067ScriptAnchor_"></a><td class="script_navbar"><a href="#33212ScriptAnchor_"><span>Previous Script: [CHUNKaddMainRecordSectionKeysToCiteOrRefSectionKeychain]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#32999ScriptAnchor_"><span>Next Script: [changeSpellingOfKeywordOrNodeTag]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">addORremoveCiteOrRefTLTag</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33066ScriptAnchor_">addORremoveRefTagStep1</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Conditionally format field in learn or </li>
<li>#observation window.</li>
<li>Set Variable [ $$refTestLearn; Value:1 ]</li>
<li>#</li>
<li>#If reference or learn record that tag was added</li>
<li>#to belongs to more than one section, then </li>
<li>#add these other sections to the tag's group </li>
<li>#keychain so when this tag record is viewed in </li>
<li>#those sections, the reference or learn record </li>
<li>#just added to it will show up as well.</li>
<li>Perform Script [ &ldquo;CHUNKaddMainRecordSectionKeysToCiteOrRefSectionKeychain&rdquo; ]</li>
<li>#</li>
<li>#Check main checkbox if record is not already</li>
<li>#a main record.  This is because when going to</li>
<li>#edit cite or reference records, only main records</li>
<li>#are shown by default.</li>
<li>If [ "main" &amp; &para; &ne; FilterValues ( testlearn::filterFind ; "main" &amp; &para; ) and Get ( LayoutTableName ) = "testlearn" ]</li>
<li>Set Variable [ $filterFind; Value:testlearn::filterFind ]</li>
<li>Set Field [ testlearn::filterFind; "main" &amp; &para; &amp; $filterFind ]</li>
<li>End If</li>
<li>#</li>
<li>#Get current record IDs in reference or </li>
<li>#observation window.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Set Variable [ $$ref; Value:testlearn::kcreference ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Variable [ $$ref; Value:reference::lock ]</li>
<li>End If</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>#</li>
<li>#If tag user clicked has not yet been selected, then add it.</li>
<li>#The 'L' is added to all Tag Menu to conditional format</li>
<li>#the Learn menu button.</li>
<li>If [ testlearn::_Ltestlearn &amp; "L&para;"  &ne;  FilterValues ( $$ref ; testlearn::_Ltestlearn &amp; "L&para;" ) ]</li>
<li>#</li>
<li>Set Variable [ $newRef; Value:testlearn::_Ltestlearn &amp; "L" ]</li>
<li>#</li>
<li>#Set record number so can return user to it when done.</li>
<li>Set Variable [ $recordNumber; Value:Get (RecordNumber) ]</li>
<li>#</li>
<li>#Add reference in reference or observation window.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Set Field [ testlearn::kcreference; $newRef &amp; "&para;" &amp; $$ref ]</li>
<li>Set Variable [ $$ref; Value:testlearn::kcreference ]</li>
<li>Go to Field [  ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Field [ reference::lock; $newRef &amp; "&para;" &amp; $$ref ]</li>
<li>Set Variable [ $$ref; Value:reference::lock ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#Sort records according to users wishes.</li>
<li>Sort Records [ Specified Sort Order: testlearn::date; descending
testlearn::timestamp; descending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $recordNumber ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If tag has been selected, then remove it.</li>
<li>Set Variable [ $removeRef; Value:testlearn::_Ltestlearn &amp; "L" ]</li>
<li>#</li>
<li>#Set record number so can return user to it when done.</li>
<li>Set Variable [ $recordNumber; Value:Get (RecordNumber) ]</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Set Field [ testlearn::kcreference; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used

If ( ValueCount ( $$ref) &ne; ValueCount ( Substitute ( $$ref ; $removeRef &amp; "&para;"  ; "" ) ) ; 

Substitute ( $$ref ; $removeRef &amp; "&para;"  ; "" ) ; 

Substitute ( $$ref ; $removeRef; "" ) 

) ]</li>
<li>Set Variable [ $$ref; Value:testlearn::kcreference ]</li>
<li>Go to Field [  ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Field [ reference::lock; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used

If ( ValueCount ( $$ref ) &ne; ValueCount ( Substitute ( $$ref ; $removeRef&amp; "&para;"  ; "" ) ) ; 

Substitute ( $$ref ; $removeRef &amp; "&para;"  ; "" ) ; 

Substitute ( $$ref ; $removeRef ; "" ) 

) ]</li>
<li>Set Variable [ $$ref; Value:reference::lock ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
<li>#</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>#Sort records according to users wishes.</li>
<li>Sort Records [ Specified Sort Order: testlearn::date; descending
testlearn::timestamp; descending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $recordNumber ]
[ No dialog ]</li>
<li>Set Variable [ $$skipFirstPartOfScript ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearn</em>::filterFind</li>
<li>
<em>testlearn</em>::kcreference</li>
<li>
<em>reference</em>::lock</li>
<li>
<em>testlearn</em>::_Ltestlearn</li>
<li>
<em>testlearn</em>::date</li>
<li>
<em>testlearn</em>::timestamp</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33212ScriptAnchor_">CHUNKaddMainRecordSectionKeysToCiteOrRefSectionKeychain</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32999ScriptAnchor_"></a><td class="script_navbar"><a href="#33067ScriptAnchor_"><span>Previous Script: [addORremoveCiteOrRefTLTag]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33007ScriptAnchor_"><span>Next Script: [changeSpellingOfTagCategory]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">changeSpellingOfKeywordOrNodeTag</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32999ScriptAnchor_">changeSpellingOfKeywordOrNodeTag</a></li>
<li><a href="#33000ScriptAnchor_">noCommasAllowed</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>Allow User Abort [ Off ]</li>
<li>#</li>
<li>If [ $$stopTest   =   1 
//or $$citationMatch = "key"
//or $$citationMatch = "node"
//or $$citationMatch = "health"
or $$citationMatch = "path" ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#First turn back any spelling changes made by dragging</li>
<li>#text into field.</li>
<li>Set Variable [ $$tag; Value:tagMenus::_Ltag ]</li>
<li>Set Variable [ $tagSpelling; Value:tagMenus::tagSpelling ]</li>
<li>Perform Script [ &ldquo;insureEqualityOfSpellFields&rdquo; ]</li>
<li>Set Variable [ $$tag ]</li>
<li>Set Field [ tagMenus::tagSpelling; $tagSpelling ]</li>
<li>#</li>
<li>#If user approved spelling for this tag and no</li>
<li>#changes have been made then cancel the script.</li>
<li>If [ tagMenus::tag = tagMenus::tagSpelling and tagMenus::tag &ne; "" ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If blank, put in ID number.</li>
<li>If [ tagMenus::tag = "" ]</li>
<li>If [ $$citationMatch = "key" ]</li>
<li>Set Field [ tagMenus::tag; "keyword" &amp; tagMenus::_Ltag ]</li>
<li>Else If [ $$citationMatch = "node" ]</li>
<li>Set Field [ tagMenus::tag; "node" &amp; tagMenus::_Ltag ]</li>
<li>End If</li>
<li>Show Custom Dialog [ Message: "Blank tag records are not allowed."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>Perform Script [ &ldquo;removeTextFormattingAndCommas&rdquo; ]</li>
<li>#</li>
<li>#Get the key for this record for later in script</li>
<li>#when it will be used to change the spelling in </li>
<li>#any records tagged with this key, but of course</li>
<li>#showing the old spelling of the tag.  The spellling</li>
<li>#unlike the key is belongs to the tagged record</li>
<li>#not the tag, and so the spelling must be changed</li>
<li>#in every record tagged.</li>
<li>Set Variable [ $$key; Value:tagMenus::_Ltag ]</li>
<li>#</li>
<li>#Commit changes to the spellling.</li>
<li>Commit Records/Requests</li>
<li>Set Variable [ $newSpelling; Value:tagMenus::tag ]</li>
<li>#</li>
<li>#Get library name for use in comment below.</li>
<li>Set Variable [ $libraryName; Value:TEMP::sectionName ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN A - Check if a tag with this spelling </li>
<li>#already exists in this section of the library.</li>
<li>Loop</li>
<li>New Window [  ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::tag; "==" &amp; $newSpelling ]</li>
<li>//  Set Field [ tagMenus::ksection; TEMP::ksection ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; TEMP::ksection ]</li>
<li>Set Field [ tagMenus::match; $$citationMatch ]</li>
<li>Perform Find [  ]</li>
<li>Exit Loop If [ Get (FoundCount)  &le;  1 ]</li>
<li>If [ Get (FoundCount) &gt; 1 ]</li>
<li>Close Window [ Current Window ]</li>
<li>Set Variable [ $turnRed; Value:$newSpelling ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#If change was made to a new tag do this:</li>
<li>If [ tagMenus::tagSpelling = "" ]</li>
<li>If [ $$citationMatch = "node" ]</li>
<li>Show Custom Dialog [ Message: "A node with this exact spelling already exists.  The system allows this, though for your sake add an initial and a picture to help you tell these nodes apart."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Else If [ $$citationMatch = "key" ]</li>
<li>Show Custom Dialog [ Message: "Every tag in this library section must have a unique name.  Change the spelling of the newly created tag or delete it."; Buttons: &ldquo;change&rdquo;, &ldquo;delete&rdquo;; Input #1: tagMenus::tag, "change spelling" ]</li>
<li>End If</li>
<li>#</li>
<li>#If change was made to an old tag do this:</li>
<li>Else If [ tagMenus::tagSpelling &ne; "" ]</li>
<li>If [ $$citationMatch = "node" ]</li>
<li>Show Custom Dialog [ Message: "A node with this exact spelling already exists."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Else If [ $$citationMatch = "key" ]</li>
<li>Show Custom Dialog [ Message: "Every tag in this library section must have a unique name.  Change the spelling of current tag to something new or revert to its old spelling."; Buttons: &ldquo;change&rdquo;, &ldquo;revert&rdquo;; Input #1: tagMenus::tag, "change spelling" ]</li>
<li>Commit Records/Requests</li>
<li>End If</li>
<li>End If</li>
<li>Set Variable [ $turnRed ]</li>
<li>#</li>
<li>#Choice 2</li>
<li>If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>#</li>
<li>#Choice 2: node</li>
<li>If [ $$citationMatch = "node" ]</li>
<li>#If new tag, user has been informed and we can exit.</li>
<li>If [ tagMenus::tagSpelling = "" ]</li>
<li>Set Field [ tagMenus::tagSpelling; tagMenus::tag ]</li>
<li>Refresh Window</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>#If change is made to an existing tag, then go</li>
<li>#to part B.</li>
<li>Else If [ tagMenus::tagSpelling &ne; "" ]</li>
<li>Set Variable [ $exit; Value:1 ]</li>
<li>End If</li>
<li>#</li>
<li>#Choice 2: key</li>
<li>Else If [ $$citationMatch = "key" ]</li>
<li>If [ tagMenus::tagSpelling = "" ]</li>
<li>#If user decided to delete new tag then delete it.</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>Refresh Window</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>#If change is made to an existing tag, then go</li>
<li>#to part B.</li>
<li>Else If [ tagMenus::tagSpelling &ne; "" ]</li>
<li>Set Field [ tagMenus::tag; tagMenus::tagSpelling ]</li>
<li>Refresh Window</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Choice 1</li>
<li>Else If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>#</li>
<li>If [ $$citationMatch = "node" ]</li>
<li>#</li>
<li>#If new tag, user has been informed and we can exit.</li>
<li>If [ tagMenus::tagSpelling = "" ]</li>
<li>Set Field [ tagMenus::tagSpelling; tagMenus::tag ]</li>
<li>Refresh Window</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>#If change is made to an existing tag, then go</li>
<li>#to part B.</li>
<li>Else If [ tagMenus::tagSpelling &ne; "" ]</li>
<li>Set Variable [ $exit; Value:1 ]</li>
<li>End If</li>
<li>#</li>
<li>Else If [ $$citationMatch = "key" ]</li>
<li>#If change was made to a new tag check if spelling</li>
<li>#is already in use.</li>
<li>Set Variable [ $newSpelling; Value:tagMenus::tag ]</li>
<li>Refresh Window</li>
<li>Perform Script [ &ldquo;changeSpellingOfKeywordOrNodeTag&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>End If</li>
<li>End If</li>
<li>End If</li>
<li>Exit Loop If [ $exit = 1 ]</li>
<li>End Loop</li>
<li>#</li>
<li>#END A - Check if a tag with this spelling </li>
<li>#already exists in this section of the library.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN B - Check if a tag with this spelling </li>
<li>#already exists in the library.</li>
<li>If [ $exit &ne; 1 ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenu2keywordOrNodeSpellCheck&rdquo; (tagMenus) ]</li>
<li>#</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::tag; "==" &amp; $newSpelling ]</li>
<li>Set Field [ tagMenus::match; $$citationMatch ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#If duplicates exists ask user what they want to do.</li>
<li>If [ Get (FoundCount) &gt; 1 ]</li>
<li>#</li>
<li>#Show tags under their categories.</li>
<li>Sort Records [ Specified Sort Order: ruleTagSectionName::name; ascending
ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#Go to tag in question.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$key = tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>//  #Filemake has bug where if this commit records</li>
<li>//  #is not here, the comment box that comes up next</li>
<li>//  #will not allow the user to select option 2 until</li>
<li>//  #a few seconds after box appears.  With commmit</li>
<li>//  #this hang up does not happen.</li>
<li>//  Commit Records/Requests</li>
<li>#</li>
<li>#Ask question.</li>
<li>Show Custom Dialog [ Message: "'" &amp; $newSpelling &amp; "' already exists in library.  Keep the new copy of it 1) under light grey category, or 2) remove it from there and add the dark grey category including its copy of '" &amp; $newSpelling &amp; "' to current library section, or"; Buttons: &ldquo;3&rdquo;, &ldquo;2&rdquo;, &ldquo;1&rdquo;; Input #1: tagMenus::tag, "3) Change spelling to make it unique." ]</li>
<li>#</li>
<li>#Choice 3, user wants to keep duplicate.</li>
<li>If [ Get ( LastMessageChoice ) = 3 ]</li>
<li>#Go on to Part C.</li>
<li>#</li>
<li>#</li>
<li>#Choice 2, user wants to add orginal tag to </li>
<li>#current library section and delete the </li>
<li>#duplicate tag.</li>
<li>Else If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>#</li>
<li>#Make key being replaced the old key.</li>
<li>Set Variable [ $$keyOLD; Value:$$key ]</li>
<li>#</li>
<li>#If there is more than one duplicate exit the scirpt</li>
<li>#to allow the user to choose which duplicate to</li>
<li>#to add to the current library.</li>
<li>If [ Get (FoundCount) &gt; 2 ]</li>
<li>Pause/Resume Script [ Indefinitely ]</li>
<li>Set Variable [ $$key; Value:tagMenus::_Ltag ]</li>
<li>#</li>
<li>#If user decided to use light grey category (the</li>
<li>#category the new tag was created under instead</li>
<li>#of using one of the old tags instead under one</li>
<li>#of the dark grey categories) close window and</li>
<li>#and exit the script.</li>
<li>If [ $$key = $$keyOLD ]</li>
<li>#</li>
<li>Close Window [ Current Window ]</li>
<li>#</li>
<li>#Update spelling of word in case of future changes</li>
<li>#to its spelling that would then trigger the first</li>
<li>#part of this scirpt to udpate the spelling in the </li>
<li>#tag list.</li>
<li>Set Field [ tagMenus::tagSpelling; $newSpelling ]</li>
<li>Set Variable [ $$key ]</li>
<li>Set Variable [ $$keyOLD ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Add category to current library section, which</li>
<li>#of course includes the tag of interest.</li>
<li>Set Field [ ruleTagMenuGroups::ksection; TEMP::ksection &amp; &para; &amp; ruleTagMenuGroups::ksection ]</li>
<li>#</li>
<li>#Go to duplicate and delete it.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$keyOLD = tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>Else If [ Get (FoundCount) = 2 ]</li>
<li>#Go to new key and copy it.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$key &ne; tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Set Variable [ $$key; Value:tagMenus::_Ltag ]</li>
<li>#</li>
<li>#Add category to current library section, which</li>
<li>#of course includes the tag/sujbect of interest.</li>
<li>Set Field [ ruleTagMenuGroups::ksection; TEMP::ksection &amp; &para; &amp; ruleTagMenuGroups::ksection ]</li>
<li>#</li>
<li>#Go to duplicate and delete it.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$keyOLD = tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#Turn off recordLoad script and go to EDIT layout</li>
<li>#to change keys in records  tagged with old key.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>Go to Layout [ &ldquo;Reference&rdquo; (reference) ]</li>
<li>#</li>
<li>#Remove focus from other window so don't get</li>
<li>#error 301: record in use, which prevents key from</li>
<li>#being replaced.</li>
<li>Set Variable [ $windowName; Value:Get (WindowName) ]</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>#The field selected does not matter.  It serves</li>
<li>#only to remove the focus.</li>
<li>Go to Field [ tempSetup::kuserLocation ]</li>
<li>Go to Field [  ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>#The field selected does not matter.  It serves</li>
<li>#only to remove the focus.</li>
<li>Go to Field [ testlearn::_Number ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>#The field selected does not matter.  It serves</li>
<li>#only to remove the focus.</li>
<li>Go to Field [ reference::_Number ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
<li>Select Window [ Name: $windowName; Current file ]</li>
<li>#</li>
<li>#If user is consolidating a keyword.</li>
<li>If [ $$citationMatch = "key" ]</li>
<li>#</li>
<li>#Replace old key with selected key to consolidate</li>
<li>#primary records under one key.</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::kkeywordPrimary; $$keyOLD ]</li>
<li>Perform Find [  ]</li>
<li>If [ Get (LastError) &ne; 401 ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ reference::kkeywordPrimary; $$key ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>End If</li>
<li>Commit Records/Requests</li>
<li>#</li>
<li>#Replace old key with selected key to consolidate</li>
<li>#other records under one key.  Since the spelling</li>
<li>#is the same only the key needs to be replaced.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::kkeywordOther; $$keyOLD ]</li>
<li>Perform Find [  ]</li>
<li>If [ Get (LastError) &ne; 401 ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ reference::kkeywordOther; $$key ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>End If</li>
<li>#</li>
<li>#If user is consolidating a node.</li>
<li>Else If [ $$citationMatch = "node" ]</li>
<li>#</li>
<li>#Replace old key with selected key to consolidate</li>
<li>#primary records under one key.</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::knodePrimary; $$keyOLD ]</li>
<li>Perform Find [  ]</li>
<li>If [ Get (LastError) &ne; 401 ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ reference::knodePrimary; $$key ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>End If</li>
<li>#</li>
<li>#Replace old key with selected key to consolidate</li>
<li>#other records under one key.  Since the spelling</li>
<li>#is the same only the key needs to be replaced.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::knodeOther; $$keyOLD ]</li>
<li>Perform Find [  ]</li>
<li>If [ Get (LastError) &ne; 401 ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ reference::knodeOther; $$key ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Return to original layout.</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>#</li>
<li>#Show added category to user with tag under it.</li>
<li>Close Window [ Current Window ]</li>
<li>#If earlier script took user to another window</li>
<li>#to prevent 301 error, then closing the window</li>
<li>#will put the focus on that window which is not</li>
<li>#the correct window, thus this next step.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; TEMP::ksection ]</li>
<li>Set Field [ tagMenus::match; $$citationMatch ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Sort records according to users wishes.</li>
<li>If [ TEMP::sortKey = "cat" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ TEMP::sortKey = "abc" ]</li>
<li>Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#Go to newly added tag.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$key = tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Highlight changes.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>If [ $$citationMatch = "node" ]</li>
<li>Set Variable [ $$citationItem; Value:tempSetup::kdefaultNodePrimary ]</li>
<li>Set Variable [ $$key; Value:testlearn::kNodeOther ]</li>
<li>End If</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>If [ $$citationMatch = "key" ]</li>
<li>Set Variable [ $$citationItem; Value:testlearn::kKeywordPrimary ]</li>
<li>Set Variable [ $$node; Value:testlearn::kcKeywordOther ]</li>
<li>Else If [ $$citationMatch = "node" ]</li>
<li>Set Variable [ $$citationItem; Value:testlearn::kNodePrimary ]</li>
<li>Set Variable [ $$key; Value:testlearn::kNodeOther ]</li>
<li>End If</li>
<li>End If</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>If [ $$citationMatch = "key" ]</li>
<li>Set Variable [ $$citationItem; Value:reference::kkeywordPrimary ]</li>
<li>Set Variable [ $$node; Value:reference::kkeywordOther ]</li>
<li>Else If [ $$citationMatch = "node" ]</li>
<li>Set Variable [ $$citationItem; Value:reference::knodePrimary ]</li>
<li>Set Variable [ $$key; Value:reference::knodeOther ]</li>
<li>End If</li>
<li>End If</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Tag Menus" ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#Clear variables only needed for this script.</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Set Variable [ $$key ]</li>
<li>Set Variable [ $$keyOLD ]</li>
<li>Set Variable [ $$keyOLD ]</li>
<li>#</li>
<li>#This halt step was placed after discovering when</li>
<li>#adding a new group because it contains a tag that</li>
<li>#is spelled the same as a tag already in this section,</li>
<li>#the spell/duplicate check script ends with no field</li>
<li>#selected, but then after the exit step was used the</li>
<li>#the system would enter the field, even though no</li>
<li>#scripts tell the system to take any further action after</li>
<li>#the exit, and on scripts are waiting to finish after</li>
<li>#the spell/duclicate check script finishes.  This halt</li>
<li>#script step takes care of the problem the exit does not.</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>#</li>
<li>#Choice 1, user wants to change spelling.</li>
<li>Else If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Set Variable [ $newSpelling ]</li>
<li>Close Window [ Current Window ]</li>
<li>Perform Script [ &ldquo;changeSpellingOfKeywordOrNodeTag&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#END B - Check if a tag with this spelling </li>
<li>#already exists in the library.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN C - Change spelling of uniquely spelled tag.</li>
<li>#</li>
<li>Close Window [ Current Window ]</li>
<li>#</li>
<li>#If Part B was skipped due to spelling of node</li>
<li>#clear the exit variable which is needed in Part C.</li>
<li>End If</li>
<li>Set Variable [ $exit ]</li>
<li>#</li>
<li>#</li>
<li>Set Variable [ $recordNumber; Value:Get (RecordNumber) ]</li>
<li>#</li>
<li>#If the spellling of the tag has changed or if tag</li>
<li>#is new do the following.</li>
<li>If [ tagMenus::tag &ne; tagMenus::tagSpelling and tagMenus::tagSpelling &ne; "" ]</li>
<li>#Commit records so user can change spelling.</li>
<li>#Without commit records the system will not find</li>
<li>#a newly added tag during the find part script.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>Commit Records/Requests</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Commit Records/Requests</li>
<li>End If</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Commit Records/Requests</li>
<li>End If</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>#</li>
<li>#Replace the old spelling with the new one.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>Set Variable [ $oldSpelling; Value:tagMenus::tagSpelling ]</li>
<li>Set Variable [ $$key; Value:tagMenus::_Ltag ]</li>
<li>#Update spelling of word in case of future changes</li>
<li>Set Field [ tagMenus::tagSpelling; $newSpelling ]</li>
<li>#</li>
<li>#Replace in Reference table.</li>
<li>Go to Layout [ &ldquo;Reference&rdquo; (reference) ]</li>
<li>#</li>
<li>#</li>
<li>#Error notification needs to be turned off in case</li>
<li>#a tag that has never been used has its spelling</li>
<li>#changed, in which case this unused tag will</li>
<li>#will not be found and give the user a notification</li>
<li>#to that effect.</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>Enter Find Mode [  ]</li>
<li>If [ $$citationMatch = "key" ]</li>
<li>Set Field [ reference::kkeywordOther; $$key &amp; &para; ]</li>
<li>Else If [ $$citationMatch = "node" ]</li>
<li>Set Field [ reference::knodeOther; $$key &amp; &para; ]</li>
<li>End If</li>
<li>Perform Find [  ]</li>
<li>Loop</li>
<li>#</li>
<li>#Add comma to last item and before first item </li>
<li>#in list for spelling changes script which has</li>
<li>#to find words separated by commas.</li>
<li>If [ $$citationMatch = "key" ]</li>
<li>Set Variable [ $tags; Value:reference::OtherKeyWords ]</li>
<li>Set Field [ reference::OtherKeyWords; ", ,, " &amp; $tags &amp; ", ,, " ]</li>
<li>Set Variable [ $tags; Value:reference::OtherKeyWords ]</li>
<li>Else If [ $$citationMatch = "node" ]</li>
<li>#</li>
<li>#Create list of values.</li>
<li>Set Variable [ $tags; Value:reference::NodeOthers ]</li>
<li>Set Field [ reference::NodeOthers; Substitute ( $tags ; "; " ; "&para;" ) ]</li>
<li>Set Variable [ $tags; Value:reference::NodeOthers ]</li>
<li>#</li>
<li>#Transfer list from variable to temporary list of records.</li>
<li>#This list will be used next to change the spelling</li>
<li>#of only one item.  If there are two or more items</li>
<li>#in this list with the same spelling, these other</li>
<li>#items will not be affected.  The user after all</li>
<li>#only changed the spellling of one tag, not all the</li>
<li>#tags spelled the same way.</li>
<li>Go to Layout [ &ldquo;TEMPnodeList&rdquo; (TEMP) ]</li>
<li>Set Variable [ $numberOfNodes; Value:ValueCount ( $tags ) ]</li>
<li>Delete All Records
[ No dialog ]</li>
<li>Loop</li>
<li>Exit Loop If [ $numberOfNodes = 0 ]</li>
<li>New Record/Request</li>
<li>Set Field [ TEMP::tempListNode; GetValue ( $tags ; $numberOfNodes ) ]</li>
<li>Set Variable [ $numberOfNodes; Value:$numberOfNodes - 1 ]</li>
<li>End Loop</li>
<li>End If</li>
<li>#</li>
<li>#Change spelling of only one tag.</li>
<li>If [ $$citationMatch = "key" ]</li>
<li>Set Field [ reference::OtherKeyWords; Substitute ( $tags ; ", " &amp; $oldSpelling &amp; ", " ; ", " &amp; $newSpelling &amp; ", " ) ]</li>
<li>Else If [ $$citationMatch = "node" ]</li>
<li>#</li>
<li>#Change spelling of one node.  If two or more</li>
<li>#nodes' spelling is identical leave others alone.</li>
<li>#Reason: nodes can have same spelling and when</li>
<li>#change spelling of one need to leave others alone</li>
<li>#until user specfically changes their spelling too.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>If [ TEMP::tempListNode = $oldSpelling ]</li>
<li>Set Field [ TEMP::tempListNode; $newSpelling ]</li>
<li>Set Variable [ $exit; Value:1 ]</li>
<li>End If</li>
<li>Exit Loop If [ $exit = 1 ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Set Variable [ $exit ]</li>
<li>#</li>
<li>#Sort list alphabetically and recreate otherNode</li>
<li>#field from list.</li>
<li>Sort Records [ Specified Sort Order: TEMP::tempListNode; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ Last ]</li>
<li>Set Variable [ $tags; Value:TEMP::tempListNode ]</li>
<li>Loop</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>Exit Loop If [ Get ( FoundCount ) = 0 ]</li>
<li>Set Variable [ $list; Value:$tags ]</li>
<li>Set Variable [ $tags; Value:TEMP::tempListNode &amp; "; " &amp; $list ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Now create one temp record.  This is done because</li>
<li>#the Setup window shows one temp record that</li>
<li>#contains the current global default node, section, etc.</li>
<li>#information.  The system just deleted all temp</li>
<li>#records, so unless one is now created, the user</li>
<li>#will see a blank setup screen.</li>
<li>New Record/Request</li>
<li>#</li>
<li>#Set the nodeOther field with new alphabetized list.</li>
<li>Go to Layout [ &ldquo;Reference&rdquo; (reference) ]</li>
<li>Set Field [ reference::NodeOthers; $tags ]</li>
<li>End If</li>
<li>#</li>
<li>#Remove comma from front and back of list so it</li>
<li>#looks nice.</li>
<li>If [ $$citationMatch = "key" ]</li>
<li>Set Variable [ $otherKeys; Value:reference::OtherKeyWords ]</li>
<li>Set Field [ reference::OtherKeyWords; Substitute ( $otherKeys ; ", ,, " ; "" ) ]</li>
<li>End If</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Replace in TestLearn table.</li>
<li>Go to Layout [ &ldquo;learn4&rdquo; (testlearn) ]</li>
<li>#</li>
<li>#</li>
<li>#Error notification needs to be turned off in case</li>
<li>#a tag that has never been used has its spelling</li>
<li>#changed, in which case this unused tag will</li>
<li>#will not be found and give the user a notification</li>
<li>#to that effect.</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>Enter Find Mode [  ]</li>
<li>If [ $$citationMatch = "key" ]</li>
<li>Set Field [ testlearn::kcKeywordOther; $$key &amp; &para; ]</li>
<li>Else If [ $$citationMatch = "node" ]</li>
<li>Set Field [ testlearn::kNodeOther; $$key &amp; &para; ]</li>
<li>End If</li>
<li>Perform Find [  ]</li>
<li>Loop</li>
<li>#</li>
<li>#Add comma to last item and before first item </li>
<li>#in list for spelling changes script which has</li>
<li>#to find words separated by commas.</li>
<li>If [ $$citationMatch = "key" ]</li>
<li>Set Variable [ $tags; Value:testlearn::OtherKeyWords ]</li>
<li>Set Field [ testlearn::OtherKeyWords; ", ,, " &amp; $tags &amp; ", ,, " ]</li>
<li>Set Variable [ $tags; Value:testlearn::OtherKeyWords ]</li>
<li>Else If [ $$citationMatch = "node" ]</li>
<li>#</li>
<li>#Create list of values.</li>
<li>Set Variable [ $tags; Value:testlearn::NodeOthers ]</li>
<li>Set Field [ testlearn::NodeOthers; Substitute ( $tags ; "; " ; "&para;" ) ]</li>
<li>Set Variable [ $tags; Value:testlearn::NodeOthers ]</li>
<li>#</li>
<li>#Transfer list from variable to temporary list of records.</li>
<li>#This list will be used next to change the spelling</li>
<li>#of only one item.  If there are two or more items</li>
<li>#in this list with the same spelling, these other</li>
<li>#items will not be affected.  The user after all</li>
<li>#only changed the spellling of one tag, not all the</li>
<li>#tags spelled the same way.</li>
<li>Go to Layout [ &ldquo;TEMPnodeList&rdquo; (TEMP) ]</li>
<li>Set Variable [ $numberOfNodes; Value:ValueCount ( $tags ) ]</li>
<li>Delete All Records
[ No dialog ]</li>
<li>Loop</li>
<li>Exit Loop If [ $numberOfNodes = 0 ]</li>
<li>New Record/Request</li>
<li>Set Field [ TEMP::tempListNode; GetValue ( $tags ; $numberOfNodes ) ]</li>
<li>Set Variable [ $numberOfNodes; Value:$numberOfNodes - 1 ]</li>
<li>End Loop</li>
<li>End If</li>
<li>#</li>
<li>#Change spelling.</li>
<li>If [ $$citationMatch = "key" ]</li>
<li>Set Field [ testlearn::OtherKeyWords; Substitute ( $tags ; ", " &amp; $oldSpelling &amp; ", " ; ", " &amp; $newSpelling &amp; ", " ) ]</li>
<li>Else If [ $$citationMatch = "node" ]</li>
<li>#</li>
<li>#Change spelling of one node.  If two or more</li>
<li>#nodes spelling is identical leave others alone.</li>
<li>#Reason: nodes can have same spelling and when</li>
<li>#change spelling of one need to leave others alone</li>
<li>#until user specfically changes their spelling too.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>If [ TEMP::tempListNode = $oldSpelling ]</li>
<li>Set Field [ TEMP::tempListNode; $newSpelling ]</li>
<li>Set Variable [ $exit; Value:1 ]</li>
<li>End If</li>
<li>Exit Loop If [ $exit = 1 ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Set Variable [ $exit ]</li>
<li>#</li>
<li>#Sort list alphabetically and recreate otherNode</li>
<li>#field from list.</li>
<li>Sort Records [ Specified Sort Order: TEMP::tempListNode; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ Last ]</li>
<li>Set Variable [ $tags; Value:TEMP::tempListNode ]</li>
<li>Loop</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>Exit Loop If [ Get ( FoundCount ) = 0 ]</li>
<li>Set Variable [ $list; Value:$tags ]</li>
<li>Set Variable [ $tags; Value:TEMP::tempListNode &amp; "; " &amp; $list ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Now create one temp record.  This is done because</li>
<li>#the Setup window shows one temp record that</li>
<li>#contains the current global default node, section, etc.</li>
<li>#information.  The system just deleted all temp</li>
<li>#records, so unless one is now created, the user</li>
<li>#will see a blank setup screen.</li>
<li>New Record/Request</li>
<li>#</li>
<li>#Set the nodeOther field with new alphabetized list.</li>
<li>Go to Layout [ &ldquo;learn4&rdquo; (testlearn) ]</li>
<li>Set Field [ testlearn::NodeOthers; $tags ]</li>
<li>End If</li>
<li>#</li>
<li>#Remove comma from front and back of list so it</li>
<li>#looks nice.</li>
<li>If [ $$citationMatch = "key" ]</li>
<li>Set Variable [ $otherKeys; Value:testlearn::OtherKeyWords ]</li>
<li>Set Field [ testlearn::OtherKeyWords; Substitute ( $otherKeys ; ", ,, " ; "" ) ]</li>
<li>End If</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Go to Layout [ original layout ]</li>
<li>#Decided not to re-alaphabetize list as would</li>
<li>#bog down system.  User can do so by taking item</li>
<li>#away and adding at back using the O button on</li>
<li>#the Tag Menus window.</li>
<li>//  #Set record number so can return user to it when done.</li>
<li>//  Set Variable [ $recordNumber; Value:Get (RecordNumber) ]</li>
<li>//  #Now re-alphabetize and add new keyword to citation.</li>
<li>//  Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  Select Window [ Name: "References"; Current file ]</li>
<li>//  If [ Get (LastError) = 112 ]</li>
<li>//  Select Window [ Name: "Learn"; Current file ]</li>
<li>//  Set Variable [ $otherKeys; Value:testlearn::OtherKeyWords ]</li>
<li>//  Else If [ Get (LastError) &ne; 112 ]</li>
<li>//  Set Variable [ $otherKeys; Value:reference::OtherKeyWords ]</li>
<li>//  End If</li>
<li>//  #</li>
<li>//  #Find and set first value in keyword list.</li>
<li>//  #It will not have a comma in front like the other items.</li>
<li>//  Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>//  Loop</li>
<li>//  If [ tagMenus::_Ltag &amp; "&para;" = FilterValues ( $$key ; tagMenus::_Ltag &amp; "&para;" ) ]</li>
<li>//  Set Variable [ $newKey; Value:tagMenus::tag ]</li>
<li>//  #</li>
<li>//  Select Window [ Name: "References"; Current file ]</li>
<li>//  If [ Get (LastError) = 112 ]</li>
<li>//  Select Window [ Name: "Learn"; Current file ]</li>
<li>//  Set Field [ testlearn::OtherKeyWords; $newKey ]</li>
<li>//  Set Variable [ $otherKeys; Value:testlearn::OtherKeyWords ]</li>
<li>//  Else If [ Get (LastError) &ne; 112 ]</li>
<li>//  Set Field [ reference::OtherKeyWords; $newKey ]</li>
<li>//  Set Variable [ $otherKeys; Value:reference::OtherKeyWords ]</li>
<li>//  End If</li>
<li>//  End If</li>
<li>//  #</li>
<li>//  Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>//  Exit Loop If [ tagMenus::_Ltag &amp; "&para;" = FilterValues ( $$key ; tagMenus::_Ltag &amp; "&para;" ) ]</li>
<li>//  Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>//  End Loop</li>
<li>//  #</li>
<li>//  #Now add remaining keywords to list.</li>
<li>//  Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>//  Loop</li>
<li>//  If [ tagMenus::_Ltag &amp; "&para;" = FilterValues ( $$key ; tagMenus::_Ltag &amp; "&para;" ) ]</li>
<li>//  Set Variable [ $newKey; Value:tagMenus::tag ]</li>
<li>//  #</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>//  If [ Get (LastError) = 112 ]</li>
<li>//  Select Window [ Name: "Learn"; Current file ]</li>
<li>//  Set Field [ testlearn::OtherKeyWords; $otherKeys &amp; ", " &amp; $newKey ]</li>
<li>//  Set Variable [ $otherKeys; Value:testlearn::OtherKeyWords ]</li>
<li>//  Else If [ Get (LastError) &ne; 112 ]</li>
<li>//  Set Field [ reference::OtherKeyWords; $otherKeys &amp; ", " &amp; $newKey ]</li>
<li>//  Set Variable [ $otherKeys; Value:reference::OtherKeyWords ]</li>
<li>//  End If</li>
<li>//  End If</li>
<li>//  #</li>
<li>//  Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>//  Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>//  End Loop</li>
<li>#</li>
<li>#Not sure why this update fails at this point.  </li>
<li>#The variable is correct, but the field fails to take</li>
<li>#it, so I moved this this step up to right after old</li>
<li>#spelling variable is created from tagSpelling field.</li>
<li>//  #Update spelling of word in case of future changes</li>
<li>//  #to its spelling that would then trigger the first</li>
<li>//  #part of this scirpt to udpate the spelling in the </li>
<li>//  #tag list.</li>
<li>//  Go to Record/Request/Page [ $recordNumber ]
[ No dialog ]</li>
<li>//  Set Field [ tagMenus::tagSpelling; $newSpelling ]</li>
<li>#</li>
<li>#Sort records according to users wishes.</li>
<li>If [ TEMP::sortKey = "cat" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ TEMP::sortKey = "abc" ]</li>
<li>Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>End If</li>
<li>#</li>
<li>#Update spelling of word in case of future changes</li>
<li>#to its spelling that would then trigger the first</li>
<li>#part of this scirpt to udpate the spelling in the </li>
<li>#tag list.</li>
<li>Set Field [ tagMenus::tagSpelling; $newSpelling ]</li>
<li>#</li>
<li>#END C - Change spelling of uniquely spelled tag.</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>tagMenus</em>::tagSpelling</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>TEMP</em>::sectionName</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>tagMenus</em>::ksection</li>
<li>
<em>ruleTagMenuGroups</em>::ksection</li>
<li>
<em>tagMenus</em>::match</li>
<li>&lt;Missing Field&gt;</li>
<li>
<em>ruleTagSectionName</em>::name</li>
<li>
<em>ruleTagMenuGroups</em>::order</li>
<li>
<em>ruleTagMenuGroups</em>::name</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>tempSetup</em>::kuserLocation</li>
<li>
<em>testlearn</em>::_Number</li>
<li>
<em>reference</em>::_Number</li>
<li>
<em>reference</em>::kkeywordPrimary</li>
<li>
<em>reference</em>::kkeywordOther</li>
<li>
<em>reference</em>::knodePrimary</li>
<li>
<em>reference</em>::knodeOther</li>
<li>
<em>TEMP</em>::sortKey</li>
<li>
<em>tempSetup</em>::kdefaultNodePrimary</li>
<li>
<em>testlearn</em>::kNodeOther</li>
<li>
<em>testlearn</em>::kKeywordPrimary</li>
<li>
<em>testlearn</em>::kcKeywordOther</li>
<li>
<em>testlearn</em>::kNodePrimary</li>
<li>
<em>reference</em>::OtherKeyWords</li>
<li>
<em>reference</em>::NodeOthers</li>
<li>
<em>TEMP</em>::tempListNode</li>
<li>
<em>testlearn</em>::OtherKeyWords</li>
<li>
<em>testlearn</em>::NodeOthers</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33227ScriptAnchor_">insureEqualityOfSpellFields</a></li>
<li><a href="#33017ScriptAnchor_">removeTextFormattingAndCommas</a></li>
<li><a href="#32999ScriptAnchor_">changeSpellingOfKeywordOrNodeTag</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>ReferenceMenu2keywordOrNodeSpellCheck</li>
<li>Reference</li>
<li>TEMPnodeList</li>
<li>learn4</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33007ScriptAnchor_"></a><td class="script_navbar"><a href="#32999ScriptAnchor_"><span>Previous Script: [changeSpellingOfKeywordOrNodeTag]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33074ScriptAnchor_"><span>Next Script: [changeSpellingOfDetailCategory]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">changeSpellingOfTagCategory</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33007ScriptAnchor_">changeSpellingOfTagCategory</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Stop script to speed up other scripts.</li>
<li>If [ $$stopChangeSpellingOfTagCategory &ne; "" ]</li>
<li>Set Variable [ $$stopChangeSpellingOfTagCategory ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#First turn back any spelling changes made by dragging</li>
<li>#text into field.</li>
<li>Set Variable [ $$tag; Value:ruleTagMenuGroups::_Lgroup ]</li>
<li>Perform Script [ &ldquo;CHUNKcheckForDragPasteChanges&rdquo; ]</li>
<li>Set Variable [ $$tag ]</li>
<li>#</li>
<li>#If node is currenlty locked then stop script, inform user.</li>
<li>If [ nodeLockTagMenus::orderOrLock &ne; "" ]</li>
<li>Set Field [ ruleTagMenuGroups::name; ruleTagMenuGroups::nameSpelling ]</li>
<li>Go to Field [  ]</li>
<li>Show Custom Dialog [ Message: "The default node selected is locked.  Select this node in the setup window and enter the password to unlock it, then you will able to edit records assigned to this node."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If user approved spelling for this tag and no</li>
<li>#changes have been made then cancel the script.</li>
<li>If [ ruleTagMenuGroups::name = ruleTagMenuGroups::nameSpelling ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Commit changes to the spellling.</li>
<li>Commit Records/Requests</li>
<li>Set Variable [ $newSpelling; Value:ruleTagMenuGroups::name ]</li>
<li>#</li>
<li>#Check if a tag with this spelling already exists</li>
<li>#in the library.  Stop error capture in case spelling</li>
<li>#is unique and thus no records will be found.</li>
<li>New Window [  ]</li>
<li>Go to Layout [ &ldquo;tableGroupTag&rdquo; (groupTest) ]</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>#</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ groupTest::name; "==" &amp; $newSpelling ]</li>
<li>Set Field [ groupTest::match; $$citationMatch ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>If [ Get (FoundCount)  &gt; 1 ]</li>
<li>#Ask question.</li>
<li>Close Window [ Current Window ]</li>
<li>Set Field [ ruleTagMenuGroups::name; ruleTagMenuGroups::nameSpelling ]</li>
<li>Show Custom Dialog [ Message: "'" &amp; $newSpelling &amp; "' already exists in library.  Each category in the " &amp; $$citationMatch &amp; " must have a unique name.  Change the spelling or cancel the change."; Buttons: &ldquo;change&rdquo;, &ldquo;cancel&rdquo;; Input #1: ruleTagMenuGroups::name ]</li>
<li>#</li>
<li>#</li>
<li>#Choice 1, user wants to change spelling.</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Set Variable [ $newSpelling ]</li>
<li>Perform Script [ &ldquo;changeSpellingOfTagCategory&rdquo; ]</li>
<li>Else If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#If the spellling of the tag has changed or if new tag</li>
<li>#update spelling of word in case of future changes</li>
<li>#to its spelling that would then trigger the first</li>
<li>#part of this scirpt to udpate the spelling in the </li>
<li>#tag list.</li>
<li>Close Window [ Current Window ]</li>
<li>Set Field [ ruleTagMenuGroups::nameSpelling; $newSpelling ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>ruleTagMenuGroups</em>::_Lgroup</li>
<li>
<em>nodeLockTagMenus</em>::orderOrLock</li>
<li>
<em>ruleTagMenuGroups</em>::nameSpelling</li>
<li>
<em>ruleTagMenuGroups</em>::name</li>
<li>
<em>groupTest</em>::name</li>
<li>
<em>groupTest</em>::match</li>
<li>&lt;Missing Field&gt;</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33223ScriptAnchor_">CHUNKcheckForDragPasteChanges</a></li>
<li><a href="#33007ScriptAnchor_">changeSpellingOfTagCategory</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>tableGroupTag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33074ScriptAnchor_"></a><td class="script_navbar"><a href="#33007ScriptAnchor_"><span>Previous Script: [changeSpellingOfTagCategory]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33000ScriptAnchor_"><span>Next Script: [noCommasAllowed]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">changeSpellingOfDetailCategory</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33074ScriptAnchor_">changeSpellingOfDetailCategory</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If user approved spelling for this tag and no</li>
<li>#changes have been made then cancel the script.</li>
<li>If [ ruleTagMenuTestGroups::name = ruleTagMenuTestGroups::nameSpelling ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Commit changes to the spellling.</li>
<li>Commit Records/Requests</li>
<li>Set Variable [ $newSpelling; Value:ruleTagMenuTestGroups::name ]</li>
<li>Set Variable [ $match; Value:ruleTagMenuTestGroups::match ]</li>
<li>#</li>
<li>#Check if a tag with this spelling already exists</li>
<li>#in the library.</li>
<li>New Window [  ]</li>
<li>Go to Layout [ &ldquo;tableGroupTag&rdquo; (groupTest) ]</li>
<li>#</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ groupTest::name; "==" &amp; $newSpelling ]</li>
<li>Set Field [ groupTest::match; $Match ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>If [ Get (FoundCount)  &gt; 1 ]</li>
<li>#Ask question.</li>
<li>Close Window [ Current Window ]</li>
<li>Set Field [ ruleTagMenuTestGroups::name; ruleTagMenuTestGroups::nameSpelling ]</li>
<li>Show Custom Dialog [ Message: "'" &amp; $newSpelling &amp; "' already exists.  Each category for " &amp; TEMP::testName &amp; " must have a unique name.  Change the spelling or cancel the change."; Buttons: &ldquo;change&rdquo;, &ldquo;cancel&rdquo;; Input #1: ruleTagMenuTestGroups::name ]</li>
<li>#</li>
<li>#</li>
<li>#Choice 1, user wants to change spelling.</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Set Variable [ $newSpelling ]</li>
<li>Perform Script [ &ldquo;changeSpellingOfDetailCategory&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#If the spellling of the tag has changed or if new tag</li>
<li>#update spelling of word in case of future changes</li>
<li>#to its spelling that would then trigger the first</li>
<li>#part of this scirpt to udpate the spelling in the </li>
<li>#tag list.</li>
<li>Close Window [ Current Window ]</li>
<li>Set Field [ ruleTagMenuTestGroups::nameSpelling; $newSpelling ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>ruleTagMenuTestGroups</em>::name</li>
<li>
<em>ruleTagMenuTestGroups</em>::nameSpelling</li>
<li>
<em>ruleTagMenuTestGroups</em>::match</li>
<li>
<em>groupTest</em>::name</li>
<li>
<em>groupTest</em>::match</li>
<li>
<em>TEMP</em>::testName</li>
<li>&lt;Missing Field&gt;</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33074ScriptAnchor_">changeSpellingOfDetailCategory</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>tableGroupTag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33000ScriptAnchor_"></a><td class="script_navbar"><a href="#33074ScriptAnchor_"><span>Previous Script: [changeSpellingOfDetailCategory]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33001ScriptAnchor_"><span>Next Script: [deleteKeywordTag]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">noCommasAllowed</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ Filter ( tagMenus::tag ; "," ) = ","  and $$citationMatch = "key" ]</li>
<li>Set Variable [ $tag; Value:tagMenus::tag ]</li>
<li>Show Custom Dialog [ Message: "commas prevent system from keeping track of this item"; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Set Field [ tagMenus::tag; Substitute ( $tag ; "," ; "" ) ]</li>
<li>Else If [ Filter ( tagMenus::tag ; ";" ) = ";"  and $$citationMatch = "node" ]</li>
<li>Set Variable [ $tag; Value:tagMenus::tag ]</li>
<li>Show Custom Dialog [ Message: "semicolons prevent system from keeping track of this item"; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Set Field [ tagMenus::tag; Substitute ( $tag ; ";" ; "" ) ]</li>
<li>End If</li>
<li>If [ $$changeSpelling = 1 ]</li>
<li>Set Variable [ $$changeSpelling; Value:2 ]</li>
<li>Perform Script [ &ldquo;changeSpellingOfKeywordOrNodeTag&rdquo; ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagMenus</em>::tag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32999ScriptAnchor_">changeSpellingOfKeywordOrNodeTag</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33001ScriptAnchor_"></a><td class="script_navbar"><a href="#33000ScriptAnchor_"><span>Previous Script: [noCommasAllowed]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33002ScriptAnchor_"><span>Next Script: [deleteNodeTag]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">deleteKeywordTag</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33002ScriptAnchor_">deleteNodeTag</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Decided to allow user to delete tags created by a locked</li>
<li>#user, but not create tags using a locked user.</li>
<li>#User needs full control over their tags. </li>
<li>#If node is currenlty locked then stop script, inform user.</li>
<li>If [ nodeLockTagMenus::orderOrLock &ne; "" ]</li>
<li>//  Show Custom Dialog [ Message: "FYI &mdash; This record is part of a set of records that can be updated.  You can delete it, but if you update your library this record will be put back if it is part of the update."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Show Custom Dialog [ Message: "This record is locked.  Go the node that created it -- " &amp; nodeLockTagMenus::tag &amp; " -- in the setup tag window and enter the password to unlock it so that you can delete it."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If user is looking at Node switch to that script.</li>
<li>If [ $$citationMatch = "node" ]</li>
<li>Perform Script [ &ldquo;deleteNodeTag&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Exit field so user can see red delete </li>
<li>#formatting later on.</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Prevent all record load scripts (they slow down</li>
<li>#this script and are uneccessary).</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>#</li>
<li>#Set variables to conditionally format section to</li>
<li>#be deleted, and its record number so if the</li>
<li>#user cancels the delete, the system can return</li>
<li>#to this record.</li>
<li>Set Variable [ $delete; Value:tagMenus::_Ltag ]</li>
<li>Set Variable [ $deleteName; Value:tagMenus::tag ]</li>
<li>Set Variable [ $recordNumber; Value:Get (RecordNumber) ]</li>
<li>Set Variable [ $$addTagToCitation; Value:1 ]</li>
<li>Set Variable [ $section; Value:TEMP::ksection ]</li>
<li>Set Variable [ $group; Value:tagMenus::kGroupOrTest ]</li>
<li>#</li>
<li>#Because there may be no records found, stop</li>
<li>#the system from informing the user of this.</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>#</li>
<li>#Open a new window and look for tag in both</li>
<li>#primary and other node fields.</li>
<li>New Window [  ]</li>
<li>#</li>
<li>Loop</li>
<li>Loop</li>
<li>#</li>
<li>#The delete variable is used only to identify the</li>
<li>#node the user clicked the delete button for.</li>
<li>#The check variable is for every keyword in a group</li>
<li>#that the system needs to see if it is in use.</li>
<li>Set Variable [ $check; Value:tagMenus::_Ltag ]</li>
<li>#</li>
<li>#Clear the inUse variable before each run thru</li>
<li>#the loop.  If not cleared, then last time thru</li>
<li>#if this variable had a value in it, that value will</li>
<li>#stay in it even if no finds are made, which then</li>
<li>#tells the system that a no find keyword, has finds.</li>
<li>#So the system must clear this variable before each</li>
<li>#run thru the loop.</li>
<li>Set Variable [ $inUse ]</li>
<li>#</li>
<li>#See if keyword is used by any learn records.</li>
<li>#Look in main kprimary...</li>
<li>Go to Layout [ &ldquo;tableTestLearn&rdquo; (testlearn) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kKeywordPrimary; $check ]</li>
<li>Set Field [ testlearn::kcsection; $section ]</li>
<li>Set Field [ testlearn::filterFind; "main" &amp; &para; ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Look in main kother...</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kcKeywordOther; $check &amp; &para; ]</li>
<li>Set Field [ testlearn::kcsection; $section ]</li>
<li>Set Field [ testlearn::filterFind; "main" &amp; &para; ]</li>
<li>Extend Found Set [  ]</li>
<li>If [ Get (FoundCount) &ne; 0 ]</li>
<li>Set Variable [ $inUse; Value:Get (FoundCount) &amp; " learn" ]</li>
<li>End If</li>
<li>#</li>
<li>#See if keyword is used by any discovery records.</li>
<li>#Check in discovery primary...</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kKeywordPrimary; $check ]</li>
<li>Set Field [ testlearn::kcsection; $section ]</li>
<li>Set Field [ testlearn::ktest; "*" ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Check in other...</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kcKeywordOther; $check ]</li>
<li>Set Field [ testlearn::kcsection; $section ]</li>
<li>Set Field [ testlearn::ktest; "*" ]</li>
<li>Extend Found Set [  ]</li>
<li>#</li>
<li>#See if keyword is used by any reference records.</li>
<li>#Check in primary...</li>
<li>Go to Layout [ &ldquo;Reference&rdquo; (reference) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::kkeywordPrimary; $check ]</li>
<li>Set Field [ reference::kcsection; $section ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Check in other...</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::kkeywordOther; $check ]</li>
<li>Set Field [ reference::kcsection; $section ]</li>
<li>Extend Found Set [  ]</li>
<li>If [ Get (FoundCount) &ne; 0 ]</li>
<li>If [ $inUse &ne; "" ]</li>
<li>Set Variable [ $addToInUse; Value:$inUse ]</li>
<li>Set Variable [ $inUse; Value:$addToInUse &amp; ", " &amp; Get (FoundCount)  &amp; " reference" ]</li>
<li>Else If [ $inUse = "" ]</li>
<li>Set Variable [ $inUse; Value:Get (FoundCount) &amp; " reference" ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Return to keyword layout.</li>
<li>Go to Layout [ &ldquo;ltagNK1&rdquo; (tagMenus) ]</li>
<li>#</li>
<li>#If the current keyword is in use in the section of</li>
<li>#the database from which the delete was requested,</li>
<li>#inform the user of this, and skip the next </li>
<li>#steps of this loop and the next loop, which.</li>
<li>#is for checking if keyword is in use in other sections.</li>
<li>If [ tagMenus::_Ltag = $delete and $inUse &ne; "" ]</li>
<li>#</li>
<li>#If the keyword was in use in the current section</li>
<li>#then do not look for it in other sections.</li>
<li>Set Variable [ $section ]</li>
<li>Exit Loop If [ tagMenus::_Ltag = $delete and $inUse &ne; "" ]</li>
<li>End If</li>
<li>#</li>
<li>#If the current keyword is not in use in the section</li>
<li>#of the database from which this delete was started,</li>
<li>#capture this information.</li>
<li>If [ $delete = tagMenus::_Ltag and $inUse = "" ]</li>
<li>Set Variable [ $deleteNotInUse; Value:"not in use" ]</li>
<li>End If</li>
<li>#</li>
<li>#Exit the loop if there is only 1 member of this group</li>
<li>#or if the system just checked for the intial delete</li>
<li>#keyword in all sections of the database, which</li>
<li>#is why the section variable would be blank.</li>
<li>#In the latter case, the loop would be coming round</li>
<li>#after checking all sections in the database.</li>
<li>#At first the loop is confined to looking at all keywords</li>
<li>#in this section.  Once it has done that, a script</li>
<li>#step below exits the loop only to enter a loop</li>
<li>#that clears the section variable and causes the</li>
<li>#system to re-enter this loop, only with a blank</li>
<li>#section variable so it will look in all sections of the</li>
<li>#database.  When it reaches this step, that blank</li>
<li>#section variable will force it out of this loop and</li>
<li>#a similar script step in the outer loop will do the</li>
<li>#same thereby allowing the system to follow the</li>
<li>#remainder of this script to report on the findings</li>
<li>#made during these discovery loops.</li>
<li>Exit Loop If [ ValueCount ( ruleTagMenuGroups::ksection )  =  1 or $section = "" ]</li>
<li>#</li>
<li>#If the current keyword is not in use in this section</li>
<li>#then check if any of the other keywords in its group</li>
<li>#are in use in this section. These next steps apply</li>
<li>#to discovering inUse info about the other keywords</li>
<li>#in the original keywords group.</li>
<li>#</li>
<li>#Make a list of all keywords in the group that are</li>
<li>#linked to records in this section AND are in use</li>
<li>#(thus the inUse variable will not be blank).</li>
<li>If [ $delete &ne; tagMenus::_Ltag and $inUse &ne; "" ]</li>
<li>Set Variable [ $add; Value:If ( $nodeName = "" ; "" ; $nodeName &amp; "; " ) ]</li>
<li>Set Variable [ $nodeName; Value:$add &amp; tagMenus::tag ]</li>
<li>End If</li>
<li>#</li>
<li>#Capture any InUse variable content for later use</li>
<li>#use in the script.  </li>
<li>Set Variable [ $addToSectionInUse; Value:$sectionInUse ]</li>
<li>Set Variable [ $sectionInUse; Value:$inUse  &amp;  $addToSectionInUse ]</li>
<li>#</li>
<li>#Go the next record.  As this delete may have</li>
<li>#been started on a record in the middle of the group</li>
<li>#these next steps insure that all records are checked</li>
<li>#even if that requires going to the first record </li>
<li>#in order to eventually loop thru all records in a</li>
<li>#group back to the initial record.</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>If [ Get ( LastError ) = 101 ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>End If</li>
<li>#</li>
<li>#There may be more than one group of keywords</li>
<li>#in a section, so this next loop insures that the</li>
<li>#script bypasses other groups' nodes.</li>
<li>If [ tagMenus::kGroupOrTest &ne; $group ]</li>
<li>Loop</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>If [ Get ( LastError ) = 101 ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>End If</li>
<li>Exit Loop If [ tagMenus::kGroupOrTest = $group ]</li>
<li>End Loop</li>
<li>End If</li>
<li>#</li>
<li>#Exit the loop when the intial record is reached</li>
<li>#for the second time.</li>
<li>Exit Loop If [ $delete = tagMenus::_Ltag ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Exit the loop if the system is on the initial record</li>
<li>#and this record is in use and all sections of</li>
<li>#the database have been checked.  </li>
<li>Exit Loop If [ tagMenus::_Ltag = $delete and $inUse &ne; "" and $section = "" ]</li>
<li>Exit Loop If [ ValueCount ( ruleTagMenuGroups::ksection )  =  1 or $section = "" ]</li>
<li>#</li>
<li>#If the current keyword is not in use in the section</li>
<li>#of the database where the delete was started,</li>
<li>#make sure it is not in use in any other section.</li>
<li>Set Variable [ $section ]</li>
<li>#</li>
<li>End Loop</li>
<li>#</li>
<li>Close Window [ Current Window ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#Report on findings and if none delete keyword.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#If the keyword in question was not found in the</li>
<li>#section the user is deleting it from...</li>
<li>If [ $deleteNotInUse &ne; "" ]</li>
<li>#</li>
<li>#But this keyword is in use in other sections...</li>
<li>If [ $inUse &ne; "" ]</li>
<li>#</li>
<li>#If the other keywords in the keyword's group are in</li>
<li>#use in this section, then they must be unlinked</li>
<li>#from the records using them before the group</li>
<li>#all these keywords belong to can be removed from</li>
<li>#this section.</li>
<li>If [ $nodeName &ne; "" ]</li>
<li>Set Variable [ $delete ]</li>
<li>Set Variable [ $$addTagToCitation ]</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Refresh Window</li>
<li>Show Custom Dialog [ Message: "This keyword cannot be deleted as it in use in other sections of the database.  You can remove it from this section after you unlink these other keywords from this group: "  &amp; $nodeName &amp; "."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>#If the other keywords in the keyword's group are not</li>
<li>#in use BUT some of the other default items </li>
<li>#are part of this group, then this group cannot</li>
<li># be removed from this section of the database.</li>
<li>Else If [ $nodeName = "" and $defaultNodeList &ne; "" ]</li>
<li>Set Variable [ $delete ]</li>
<li>Set Variable [ $$addTagToCitation ]</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Refresh Window</li>
<li>Show Custom Dialog [ Message: "This keyword cannot be deleted as it in use in other sections of the database.  You can remove it from this section after the following keywords from this group are unlinked as defaults: "  &amp; $defaultNodeList; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>#If the other keywords in the keyword's group are not</li>
<li>#in use and none of the other default items </li>
<li>#are part of this group, then this group can be </li>
<li>#removed from this section of the database.</li>
<li>#The user is given the option to do this removal.</li>
<li>Else If [ $nodeName = "" and $defaultNodeList = "" ]</li>
<li>Refresh Window</li>
<li>Show Custom Dialog [ Message: "This keyword cannot be deleted as it in use in other sections of the database.  You can remove it from this section along with all the other keywords in its group.  None of them are being used in this section."; Buttons: &ldquo;cancel&rdquo;, &ldquo;remove&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>#</li>
<li>#If the user chooses not to remove the group</li>
<li>#everything goes back to the way it was.</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $delete ]</li>
<li>Set Variable [ $$addTagToCitation ]</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Refresh Window</li>
<li>Exit Script [  ]</li>
<li>Else If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>#</li>
<li>#If the user choses to proceed with the removal,</li>
<li>#the section key is removed from the keyword group's</li>
<li>#key chain.</li>
<li>Set Field [ ruleTagMenuGroups::ksection; Substitute ( ruleTagMenuGroups::ksection &amp; &para; ; TEMP::ksection &amp; &para; ; "" ) ]</li>
<li>#</li>
<li>#For some reason, Filemaker will not remove paragraph</li>
<li>#character along with variable, so can end up with</li>
<li>#huge list of blank variables if this next part of the</li>
<li>#script is not performed to delete empty variables.</li>
<li>Set Variable [ $sectionVariableNumber; Value:ValueCount ( ruleTagMenuGroups::ksection ) ]</li>
<li>Loop</li>
<li>If [ GetValue ( ruleTagMenuGroups::ksection ; $sectionVariableNumber )  &ne;  "" ]</li>
<li>Set Variable [ $sectionKeyMinusBlanks; Value:GetValue ( ruleTagMenuGroups::ksection ; $sectionVariableNumber ) &amp; &para; ]</li>
<li>End If</li>
<li>Set Variable [ $sectionVariableNumber; Value:$sectionVariableNumber - 1 ]</li>
<li>Exit Loop If [ $sectionVariableNumber = 0 ]</li>
<li>End Loop</li>
<li>Set Field [ ruleTagMenuGroups::ksection; $sectionKeyMinusBlanks ]</li>
<li>#</li>
<li>#A find is performed to show the remaining keyword</li>
<li>#groups for this section.</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::match; "key" ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; "==" &amp; TEMP::ksection ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Sort according to current users wishes.  By default</li>
<li>#the sort will be by group which is set by editCitation script.</li>
<li>If [ TEMP::sortKey = "cat"
 or 
TEMP::sortKey = "" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagSectionName::name; ascending
ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ TEMP::sortKey = "abc" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagSectionName::name; ascending
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#Go to citation record's current selection or to first record.</li>
<li>#Because user may click anywhere to go to a record</li>
<li>#all keys for all menu items must uploaded</li>
<li>#until one is found that matches and then the</li>
<li>#$$citationItem variable can be set.</li>
<li>#Like when the user clicks in a non field area</li>
<li>#a space between fields that then tells filemaker</li>
<li>#to go that record but not to field belonging to</li>
<li>#that record.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$citationitem =  tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>If [ $$citationitem &ne;  tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>End If</li>
<li>#</li>
<li>Set Variable [ $$addTagToCitation ]</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#Just in case user was in nonTag field on this</li>
<li>#window when user clicked a menu button on </li>
<li>#the other window, exit all  fields.</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#goto Tag Menus window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>#</li>
<li>End If</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#If the keyword being deleted was not found in</li>
<li>#use in any sections of the database then before</li>
<li>#deleting it make sure the user really wants it deleted.</li>
<li>Set Variable [ $group ]</li>
<li>Refresh Window</li>
<li>Show Custom Dialog [ Message: "Delete current keyword?"; Buttons: &ldquo;cancel&rdquo;, &ldquo;delete&rdquo; ]</li>
<li>Set Variable [ $group; Value:tagMenus::kGroupOrTest ]</li>
<li>Set Variable [ $deleteGroup; Value:ruleTagMenuGroups::name ]</li>
<li>#</li>
<li>#If the user cancels, stop the delete.</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $delete ]</li>
<li>Set Variable [ $group ]</li>
<li>Refresh Window</li>
<li>Refresh Window</li>
<li>Set Variable [ $$addTagToCitation ]</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>#If the user says yes, first make sure the record</li>
<li>#is not the last record in a group.  If it is and</li>
<li>#the system deleted the record without deleting</li>
<li>#the group too, this group would become</li>
<li>#an orphan as only categories that have records</li>
<li>#attached to them show up for the user to add</li>
<li>#more records uner them.  So the group</li>
<li>#record must also be deleted if this is the last</li>
<li>#record under it.</li>
<li>Else If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>New Window [ Name: "delete tag" ]</li>
<li>Go to Layout [ &ldquo;tableTag&rdquo; (tagTable) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTable::kGroupOrTest; $group ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#If there are more records under this cateogry</li>
<li>#then the system deletes the current record without</li>
<li>#any more user input.</li>
<li>If [ Get (FoundCount) &ne; 1 ]</li>
<li>Close Window [ Name: "Delete Tag"; Current file ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>Set Variable [ $delete ]</li>
<li>Set Variable [ $group ]</li>
<li>Refresh Window</li>
<li>Set Variable [ $$addTagToCitation ]</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>#BUT if only one record is found user is asked</li>
<li>#if they want to delete the group too.</li>
<li>Else If [ Get (FoundCount) = 1 ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#The records are sorted by group to show</li>
<li>#the user which group is going to be deleted.</li>
<li>If [ TEMP::sortKey &ne; "cat" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Deleting " &amp; $deleteName &amp; " will also delete its group -- " &amp; $deleteGroup &amp; " -- as it is the last tag in this group."; Buttons: &ldquo;Cancel&rdquo;, &ldquo;Delete&rdquo; ]</li>
<li>#</li>
<li>#If the user says yes, then delete both the tag and </li>
<li>#the group record.</li>
<li>If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>#</li>
<li>#Delete tag.</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>#</li>
<li>#Delete group.</li>
<li>Select Window [ Name: "delete tag"; Current file ]</li>
<li>Go to Layout [ &ldquo;tableGroupTag&rdquo; (groupTest) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ groupTest::_Lgroup; $group ]</li>
<li>Perform Find [  ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>End If</li>
<li>End If</li>
<li>End If</li>
<li>Close Window [ Name: "Delete Tag"; Current file ]</li>
<li>Set Variable [ $delete ]</li>
<li>Set Variable [ $group ]</li>
<li>Refresh Window</li>
<li>Set Variable [ $$addTagToCitation ]</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>If [ $inUse &ne; "" ]</li>
<li>Set Variable [ $delete ]</li>
<li>Set Variable [ $group ]</li>
<li>Refresh Window</li>
<li>Show Custom Dialog [ Message: "This keyword cannot be deleted as it in use x number of times in the following modules (main windows): "  &amp; $inUse &amp; "."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Set Variable [ $$addTagToCitation ]</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>nodeLockTagMenus</em>::orderOrLock</li>
<li>
<em>nodeLockTagMenus</em>::tag</li>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>tagMenus</em>::kGroupOrTest</li>
<li>
<em>testlearn</em>::kKeywordPrimary</li>
<li>
<em>testlearn</em>::kcsection</li>
<li>
<em>testlearn</em>::filterFind</li>
<li>
<em>testlearn</em>::kcKeywordOther</li>
<li>
<em>testlearn</em>::ktest</li>
<li>
<em>reference</em>::kkeywordPrimary</li>
<li>
<em>reference</em>::kcsection</li>
<li>
<em>reference</em>::kkeywordOther</li>
<li>
<em>ruleTagMenuGroups</em>::ksection</li>
<li>
<em>tagMenus</em>::match</li>
<li>
<em>TEMP</em>::sortKey</li>
<li>
<em>ruleTagSectionName</em>::name</li>
<li>
<em>ruleTagMenuGroups</em>::order</li>
<li>
<em>ruleTagMenuGroups</em>::name</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>tagTable</em>::kGroupOrTest</li>
<li>
<em>groupTest</em>::_Lgroup</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33002ScriptAnchor_">deleteNodeTag</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>tableTestLearn</li>
<li>Reference</li>
<li>ltagNK1</li>
<li>tableTag</li>
<li>tableGroupTag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33002ScriptAnchor_"></a><td class="script_navbar"><a href="#33001ScriptAnchor_"><span>Previous Script: [deleteKeywordTag]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33003ScriptAnchor_"><span>Next Script: [deleteMHOCSPtags]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">deleteNodeTag</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33001ScriptAnchor_">deleteKeywordTag</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If the node being checked for deletion is in use</li>
<li>#as a default node then stop the script and inform</li>
<li>#the user of this fact.</li>
<li>If [ FilterValues ( TEMP::kdefaultNodeOther ; tagMenus::_Ltag &amp; "&para;" )  or 
TEMP::kdefaultNodePrimary = tagMenus::_Ltag or 
TEMP::kdefaultNodeTestSubject = tagMenus::_Ltag ]</li>
<li>Show Custom Dialog [ Message: "This node is currently selected as a default and cannot be deleted."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If user is looking at keyword switch to that script.</li>
<li>If [ $$citationMatch = "key" ]</li>
<li>Perform Script [ &ldquo;deleteKeywordTag&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Exit field so user can see red delete </li>
<li>#formatting later on.</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Prevent all record load scripts (they slow down</li>
<li>#this script and are uneccessary).</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>#</li>
<li>#Set variables to conditionally format section to</li>
<li>#be deleted, and its record number so if the</li>
<li>#user cancels the delete, the system can return</li>
<li>#to this record.</li>
<li>Set Variable [ $delete; Value:tagMenus::_Ltag ]</li>
<li>Set Variable [ $deleteName; Value:tagMenus::tag ]</li>
<li>Set Variable [ $recordNumber; Value:Get (RecordNumber) ]</li>
<li>Set Variable [ $$addTagToCitation; Value:1 ]</li>
<li>Set Variable [ $section; Value:TEMP::ksection ]</li>
<li>Set Variable [ $group; Value:tagMenus::kGroupOrTest ]</li>
<li>Set Variable [ $groupName; Value:ruleTagMenuGroups::name ]</li>
<li>#</li>
<li>#Because there may be no records found, stop</li>
<li>#the system from informing the user of this.</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>#</li>
<li>#Open a new window and look for tag in both</li>
<li>#primary and other node fields.</li>
<li>New Window [  ]</li>
<li>#</li>
<li>#See if there is only one section and is so if this node</li>
<li>#is the section's creator.</li>
<li>Go to Layout [ &ldquo;tableGroupTag&rdquo; (groupTest) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ groupTest::match; "section" ]</li>
<li>Perform Find [  ]</li>
<li>If [ Get (FoundCount) = 1 ]</li>
<li>#</li>
<li>#If the current node is the current section's creator note this.</li>
<li>If [ groupTest::kRecordCreatorNode = $delete ]</li>
<li>Set Variable [ $lastSectionCreatorNode; Value:1 ]</li>
<li>Set Field [ groupTest::CaptionORinuseCheck; $deleteName ]</li>
<li>Set Field [ groupTest::defaultSectionInfo; $groupName ]</li>
<li>End If</li>
<li>#</li>
<li>#If the current node is not current section's creator </li>
<li>#check the other sections.</li>
<li>Else</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ groupTest::match; "section" ]</li>
<li>Set Field [ groupTest::kRecordCreatorNode; $delete ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#If the current node is creator of more than one </li>
<li>#node note this.</li>
<li>If [ Get (FoundCount)  &gt; 1 ]</li>
<li>Set Variable [ $SectionCreatorNode; Value:1 ]</li>
<li>Set Variable [ $deleteNotInUse; Value:"not in use" ]</li>
<li>End If</li>
<li>#</li>
<li>#Update sections with current node and node group names.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ groupTest::CaptionORinuseCheck; $deleteName ]</li>
<li>Set Field [ groupTest::defaultSectionInfo; $groupName ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>End If</li>
<li>Go to Layout [ &ldquo;defaultNode1&rdquo; (tagMenus) ]</li>
<li>#</li>
<li>#</li>
<li>Loop</li>
<li>Loop</li>
<li>#</li>
<li>#The delete variable is used only to identify the</li>
<li>#node the user clicked the delete button for.</li>
<li>#The check variable is for every node in a group</li>
<li>#that the system needs to see if it is in use.</li>
<li>Set Variable [ $check; Value:tagMenus::_Ltag ]</li>
<li>#</li>
<li>#If the node being checked for deletion is in use</li>
<li>#as a default node then stop the script and inform</li>
<li>#the user of this fact.</li>
<li>If [ FilterValues ( TEMP::kdefaultNodeOther ; tagMenus::_Ltag &amp; "&para;" )  or 
TEMP::kdefaultNodePrimary = tagMenus::_Ltag or 
TEMP::kdefaultNodeTestSubject = tagMenus::_Ltag ]</li>
<li>If [ $defaultNodeList = "" ]</li>
<li>Set Variable [ $defaultNodeList; Value:tagMenus::tag &amp; "." ]</li>
<li>Else If [ $defaultNodeList &ne; "" ]</li>
<li>Set Variable [ $addDefaultNodeName; Value:$defaultNodeList ]</li>
<li>Set Variable [ $defaultNodeList; Value:tagMenus::tag &amp; "; " &amp; $addDefaultNodeName ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Clear the inUse variable before each run thru</li>
<li>#the loop.  If not cleared, then last time thru</li>
<li>#if this variable had a value in it, that value will</li>
<li>#stay in it even if no finds are made, which then</li>
<li>#tells the system that a no find node, has finds.</li>
<li>#So the system must clear this variable before each</li>
<li>#run thru the loop.</li>
<li>Set Variable [ $inUse ]</li>
<li>#</li>
<li>#See if node is used by any learn records.</li>
<li>#Look in main kprimary...</li>
<li>Go to Layout [ &ldquo;tableTestLearn&rdquo; (testlearn) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kNodePrimary; $check ]</li>
<li>Set Field [ testlearn::kcsection; $section ]</li>
<li>Set Field [ testlearn::filterFind; "main" &amp; &para; ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Look in main kother...</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kNodeOther; $check &amp; &para; ]</li>
<li>Set Field [ testlearn::kcsection; $section ]</li>
<li>Set Field [ testlearn::filterFind; "main" &amp; &para; ]</li>
<li>Extend Found Set [  ]</li>
<li>If [ Get (FoundCount) &ne; 0 ]</li>
<li>Set Variable [ $inUse; Value:Get (FoundCount) &amp; " learn" ]</li>
<li>End If</li>
<li>#</li>
<li>#See if node is used by any discovery records.</li>
<li>#Check in discovery primary...</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kNodePrimary; $check ]</li>
<li>Set Field [ testlearn::kcsection; $section ]</li>
<li>Set Field [ testlearn::ktest; "*" ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Check in other...</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kNodeOther; $check ]</li>
<li>Set Field [ testlearn::kcsection; $section ]</li>
<li>Set Field [ testlearn::ktest; "*" ]</li>
<li>Extend Found Set [  ]</li>
<li>#</li>
<li>#Check in testSubject...</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::ktestSubject; $check ]</li>
<li>Set Field [ testlearn::kcsection; $section ]</li>
<li>Set Field [ testlearn::ktest; "*" ]</li>
<li>Extend Found Set [  ]</li>
<li>If [ Get (FoundCount) &ne; 0 ]</li>
<li>If [ $inUse &ne; "" ]</li>
<li>Set Variable [ $addToInUse; Value:$inUse ]</li>
<li>Set Variable [ $inUse; Value:$addToInUse &amp; ", " &amp; Get (FoundCount)  &amp; " test discovery" ]</li>
<li>Else If [ $inUse = "" ]</li>
<li>Set Variable [ $inUse; Value:Get (FoundCount) &amp; " test discovery" ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#See if node is used by any reference records.</li>
<li>#Check in primary...</li>
<li>Go to Layout [ &ldquo;Reference&rdquo; (reference) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::knodePrimary; $check ]</li>
<li>Set Field [ reference::kcsection; $section ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Check in other...</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::knodeOther; $check ]</li>
<li>Set Field [ reference::kcsection; $section ]</li>
<li>Extend Found Set [  ]</li>
<li>If [ Get (FoundCount) &ne; 0 ]</li>
<li>If [ $inUse &ne; "" ]</li>
<li>Set Variable [ $addToInUse; Value:$inUse ]</li>
<li>Set Variable [ $inUse; Value:$addToInUse &amp; ", " &amp; Get (FoundCount)  &amp; " reference" ]</li>
<li>Else If [ $inUse = "" ]</li>
<li>Set Variable [ $inUse; Value:Get (FoundCount) &amp; " reference" ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#See if node is used by any test focus records.</li>
<li>Go to Layout [ &ldquo;tableTestSubjectFocus&rdquo; (tagTestSubjectLocation) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTestSubjectLocation::knode; $check ]</li>
<li>Set Field [ tagTestSubjectLocation::ksection; $section ]</li>
<li>Perform Find [  ]</li>
<li>If [ Get (FoundCount) &ne; 0 ]</li>
<li>If [ $inUse &ne; "" ]</li>
<li>Set Variable [ $addToInUse; Value:$inUse ]</li>
<li>Set Variable [ $inUse; Value:$addToInUse &amp; ", " &amp; Get (FoundCount)  &amp; " test focus" ]</li>
<li>Else If [ $inUse = "" ]</li>
<li>Set Variable [ $inUse; Value:Get (FoundCount) &amp; " test focus" ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#See if node is used by any section records.</li>
<li>#Check in primary...</li>
<li>Go to Layout [ &ldquo;tableGroupTag&rdquo; (groupTest) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ groupTest::defaultSectionInfo; $check ]</li>
<li>Set Field [ groupTest::ksection; $section ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Check in other...</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ groupTest::CaptionORinuseCheck; $check ]</li>
<li>Set Field [ groupTest::ksection; $section ]</li>
<li>Extend Found Set [  ]</li>
<li>If [ Get (FoundCount) &ne; 0 ]</li>
<li>If [ $inUse &ne; "" ]</li>
<li>Set Variable [ $addToInUse; Value:$inUse ]</li>
<li>Set Variable [ $inUse; Value:$addToInUse &amp; ", " &amp; Get (FoundCount)  &amp; " section" ]</li>
<li>Else If [ $inUse = "" ]</li>
<li>Set Variable [ $inUse; Value:Get (FoundCount) &amp; " section" ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Return to node layout.</li>
<li>Go to Layout [ &ldquo;defaultNode1&rdquo; (tagMenus) ]</li>
<li>#</li>
<li>#If the current node is in use in the section of</li>
<li>#the database from which the delete was requested,</li>
<li>#inform the user of this, and skip the next </li>
<li>#steps of this loop and the next loop, which.</li>
<li>#is for checking if node is in use in other sections.</li>
<li>If [ tagMenus::_Ltag = $delete and $inUse &ne; "" ]</li>
<li>#</li>
<li>#If the node was in use in the current section</li>
<li>#then do not look for it in other sections.</li>
<li>Set Variable [ $section ]</li>
<li>Exit Loop If [ tagMenus::_Ltag = $delete and $inUse &ne; "" ]</li>
<li>End If</li>
<li>#</li>
<li>#If the current node is not in use in the section</li>
<li>#of the database from which this delete was started,</li>
<li>#capture this information.</li>
<li>If [ $delete = tagMenus::_Ltag and $inUse = "" ]</li>
<li>Set Variable [ $deleteNotInUse; Value:"not in use" ]</li>
<li>End If</li>
<li>#</li>
<li>#Exit the loop if there is only 1 member of this group</li>
<li>#or if the system just checked for the intial delete</li>
<li>#node in all sections of the database, which</li>
<li>#is why the section variable would be blank.</li>
<li>#In the latter case, the loop would be coming round</li>
<li>#after checking all sections in the database.</li>
<li>#At first the loop is confined to looking at all nodes</li>
<li>#in this section.  Once it has done that, a script</li>
<li>#step below exits the loop only to enter a loop</li>
<li>#that clears the section variable and causes the</li>
<li>#system to re-enter this loop, only with a blank</li>
<li>#section variable so it will look in all sections of the</li>
<li>#database.  When it reaches this step, that blank</li>
<li>#section variable will force it out of this loop and</li>
<li>#a similar script step in the outer loop will do the</li>
<li>#same thereby allowing the system to follow the</li>
<li>#remainder of this script to report on the findings</li>
<li>#made during these discovery loops.</li>
<li>Exit Loop If [ ValueCount ( ruleTagMenuGroups::ksection )  =  1 or $section = "" ]</li>
<li>#</li>
<li>#If the current node is not in use in this section</li>
<li>#then check if any of the other nodes in its group</li>
<li>#are in use in this section. These next steps apply</li>
<li>#to discovering inUse info about the other nodes</li>
<li>#in the original nodes group.</li>
<li>#</li>
<li>#Make a list of all nodes in the group that are</li>
<li>#linked to records in this section AND are in use</li>
<li>#(thus the inUse variable will not be blank).</li>
<li>If [ $delete &ne; tagMenus::_Ltag and $inUse &ne; "" ]</li>
<li>Set Variable [ $add; Value:If ( $nodeName = "" ; "" ; $nodeName &amp; "; " ) ]</li>
<li>Set Variable [ $nodeName; Value:$add &amp; tagMenus::tag ]</li>
<li>End If</li>
<li>#</li>
<li>#Capture any InUse variable content for later use</li>
<li>#use in the script.  </li>
<li>Set Variable [ $addToSectionInUse; Value:$sectionInUse ]</li>
<li>Set Variable [ $sectionInUse; Value:$inUse  &amp;  $addToSectionInUse ]</li>
<li>#</li>
<li>#Go the next record.  As this delete may have</li>
<li>#been started on a record in the middle of the group</li>
<li>#these next steps insure that all records are checked</li>
<li>#even if that requires going to the first record </li>
<li>#in order to eventually loop thru all records in a</li>
<li>#group back to the initial record.</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>If [ Get ( LastError ) = 101 ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>End If</li>
<li>#</li>
<li>#There may be more than one group of nodes</li>
<li>#in a section, so this next loop insures that the</li>
<li>#script bypasses other groups' nodes.</li>
<li>If [ tagMenus::kGroupOrTest &ne; $group ]</li>
<li>Loop</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>If [ Get ( LastError ) = 101 ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>End If</li>
<li>Exit Loop If [ tagMenus::kGroupOrTest = $group ]</li>
<li>End Loop</li>
<li>End If</li>
<li>#</li>
<li>#Exit the loop when the intial record is reached</li>
<li>#for the second time.</li>
<li>Exit Loop If [ $delete = tagMenus::_Ltag ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Exit the loop if the system is on the initial record</li>
<li>#and this record is in use and all sections of</li>
<li>#the database have been checked.  </li>
<li>Exit Loop If [ tagMenus::_Ltag = $delete and $inUse &ne; "" and $section = "" ]</li>
<li>Exit Loop If [ ValueCount ( ruleTagMenuGroups::ksection )  =  1 or $section = "" ]</li>
<li>#</li>
<li>#If the current node is not in use in the section</li>
<li>#of the database where the delete was started,</li>
<li>#make sure it is not in use in any other section.</li>
<li>Set Variable [ $section ]</li>
<li>#</li>
<li>End Loop</li>
<li>#</li>
<li>Close Window [ Current Window ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#Report on findings and if none delete node.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#If the node in question was not found in the</li>
<li>#section the user is deleting it from...</li>
<li>If [ $deleteNotInUse &ne; "" ]</li>
<li>#</li>
<li>#But this node is in use in other sections...</li>
<li>If [ $inUse &ne; "" or $SectionCreatorNode = 1 ]</li>
<li>#</li>
<li>#If the other nodes in the node's group are in</li>
<li>#use in this section, then they must be unlinked</li>
<li>#from the records using them before the group</li>
<li>#all these nodes belong to can be removed from</li>
<li>#this section.</li>
<li>If [ $nodeName &ne; "" ]</li>
<li>Set Variable [ $delete ]</li>
<li>Set Variable [ $$addTagToCitation ]</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Refresh Window</li>
<li>Show Custom Dialog [ Message: "This node cannot be deleted as it in use in other sections of the database.  You can remove it from this section after you unlink these other nodes from this group: "  &amp; $nodeName &amp; "."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>#If the other nodes in the node's group are not</li>
<li>#in use BUT some of the other default items </li>
<li>#are part of this group, then this group cannot</li>
<li># be removed from this section of the database.</li>
<li>Else If [ $nodeName = "" and $defaultNodeList &ne; "" ]</li>
<li>Set Variable [ $delete ]</li>
<li>Set Variable [ $$addTagToCitation ]</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Refresh Window</li>
<li>Show Custom Dialog [ Message: "This node cannot be deleted as it in use in other sections of the database.  You can remove it from this section after the following nodes from this group are unlinked as defaults: "  &amp; $defaultNodeList; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>#If the other nodes in the node's group are not</li>
<li>#in use and none of the other default items </li>
<li>#are part of this group, then this group can be </li>
<li>#removed from this section of the database.</li>
<li>#The user is given the option to do this removal.</li>
<li>Else If [ $nodeName = "" and $defaultNodeList = "" or $SectionCreatorNode = 1 ]</li>
<li>Refresh Window</li>
<li>Show Custom Dialog [ Message: "This node cannot be deleted as it in use in other sections of the database.  You can remove it from this section along with all the other nodes in its group.  None of them are being used in this section."; Buttons: &ldquo;cancel&rdquo;, &ldquo;remove&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>#</li>
<li>#If the user chooses not to remove the group</li>
<li>#everything goes back to the way it was.</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $delete ]</li>
<li>Set Variable [ $$addTagToCitation ]</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Refresh Window</li>
<li>Exit Script [  ]</li>
<li>Else If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>#</li>
<li>#If the user choses to proceed with the removal,</li>
<li>#the section key is removed from the node group's</li>
<li>#key chain.</li>
<li>Set Field [ ruleTagMenuGroups::ksection; Substitute ( ruleTagMenuGroups::ksection &amp; &para; ; TEMP::ksection &amp; "&para;" ; "" ) ]</li>
<li>#</li>
<li>#For some reason, Filemaker will not remove paragraph</li>
<li>#character along with variable, so can end up with</li>
<li>#huge list of blank variables if this next part of the</li>
<li>#script is not performed to delete empty variables.</li>
<li>Set Variable [ $sectionVariableNumber; Value:ValueCount ( ruleTagMenuGroups::ksection ) ]</li>
<li>Loop</li>
<li>If [ GetValue ( ruleTagMenuGroups::ksection ; $sectionVariableNumber )  &ne;  "" ]</li>
<li>Set Variable [ $sectionKeyMinusBlanks; Value:GetValue ( ruleTagMenuGroups::ksection ; $sectionVariableNumber ) &amp; &para; ]</li>
<li>End If</li>
<li>Set Variable [ $sectionVariableNumber; Value:$sectionVariableNumber - 1 ]</li>
<li>Exit Loop If [ $sectionVariableNumber = 0 ]</li>
<li>End Loop</li>
<li>Set Field [ ruleTagMenuGroups::ksection; $sectionKeyMinusBlanks ]</li>
<li>#</li>
<li>#A find is performed to show the remaining node</li>
<li>#groups for this section.</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::match; "node" ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; "==" &amp; TEMP::ksection ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Sort according to current users wishes.  By default</li>
<li>#the sort will be by group which is set by editCitation script.</li>
<li>If [ TEMP::sortNode = "cat"
 or 
TEMP::sortNode = "" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagSectionName::name; ascending
ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ TEMP::sortNode = "abc" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagSectionName::name; ascending
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#Go to citation record's current selection or to first record.</li>
<li>#Because user may click anywhere to go to a record</li>
<li>#all keys for all menu items must uploaded</li>
<li>#until one is found that matches and then the</li>
<li>#$$citationItem variable can be set.</li>
<li>#Like when the user clicks in a non field area</li>
<li>#a space between fields that then tells filemaker</li>
<li>#to go that record but not to field belonging to</li>
<li>#that record.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$citationitem =  tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>If [ $$citationitem &ne;  tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>End If</li>
<li>#</li>
<li>Set Variable [ $$addTagToCitation ]</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#Just in case user was in nonTag field on this</li>
<li>#window when user clicked a menu button on </li>
<li>#the other window, exit all  fields.</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#goto Tag Menus window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>#</li>
<li>End If</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#If node is parent of library's last remaining section</li>
<li>#tell user this and exit the script.</li>
<li>If [ $lastSectionCreatorNode = 1 ]</li>
<li>Show Custom Dialog [ Message: "This node is the parent of the last section in this library.  It cannot be deleted."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#If the node being deleted was not found in</li>
<li>#use in any sections of the database then before</li>
<li>#deleting it make sure the user really wants it deleted.</li>
<li>Set Variable [ $group ]</li>
<li>Refresh Window</li>
<li>Show Custom Dialog [ Message: "Delete current node?"; Buttons: &ldquo;cancel&rdquo;, &ldquo;delete&rdquo; ]</li>
<li>Set Variable [ $group; Value:tagMenus::kGroupOrTest ]</li>
<li>Set Variable [ $deleteGroup; Value:ruleTagMenuGroups::name ]</li>
<li>#</li>
<li>#If the user cancels, stop the delete.</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $delete ]</li>
<li>Set Variable [ $group ]</li>
<li>Refresh Window</li>
<li>Set Variable [ $$addTagToCitation ]</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>#If the user says yes, first make sure the record</li>
<li>#is not the last record in a group.  If it is and</li>
<li>#the system deleted the record without deleting</li>
<li>#the group too, this group would become</li>
<li>#an orphan as only categories that have records</li>
<li>#attached to them show up for the user to add</li>
<li>#more records uner them.  So the group</li>
<li>#record must also be deleted if this is the last</li>
<li>#record under it.</li>
<li>Else If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>New Window [ Name: "delete tag" ]</li>
<li>Go to Layout [ &ldquo;tableTag&rdquo; (tagTable) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTable::kGroupOrTest; $group ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#If there are more records under this cateogry</li>
<li>#then the system deletes the current record without</li>
<li>#any more user input.</li>
<li>If [ Get (FoundCount) &ne; 1 ]</li>
<li>Close Window [ Name: "Delete Tag"; Current file ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>Set Variable [ $delete ]</li>
<li>Set Variable [ $group ]</li>
<li>Refresh Window</li>
<li>Set Variable [ $$addTagToCitation ]</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>#BUT if only one record is found user is asked</li>
<li>#if they want to delete the group too.</li>
<li>Else If [ Get (FoundCount) = 1 ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#The records are sorted by group to show</li>
<li>#the user which group is going to be deleted.</li>
<li>If [ TEMP::sortKey &ne; "cat" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Deleting " &amp; $deleteName &amp; " will also delete its group -- " &amp; $deleteGroup &amp; " -- as it is the last tag in this group."; Buttons: &ldquo;Cancel&rdquo;, &ldquo;Delete&rdquo; ]</li>
<li>#</li>
<li>#If the user says yes, then delete both the tag and </li>
<li>#the group record.</li>
<li>If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>#</li>
<li>#Delete tag.</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>#</li>
<li>#Delete group.</li>
<li>Select Window [ Name: "delete tag"; Current file ]</li>
<li>Go to Layout [ &ldquo;tableGroupTag&rdquo; (groupTest) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ groupTest::_Lgroup; $group ]</li>
<li>Perform Find [  ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>End If</li>
<li>End If</li>
<li>End If</li>
<li>Close Window [ Name: "Delete Tag"; Current file ]</li>
<li>Set Variable [ $delete ]</li>
<li>Set Variable [ $group ]</li>
<li>Refresh Window</li>
<li>Set Variable [ $$addTagToCitation ]</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>If [ $inUse &ne; "" ]</li>
<li>Set Variable [ $delete; Value:tagMenus::_Ltag ]</li>
<li>Set Variable [ $group ]</li>
<li>Refresh Window</li>
<li>Show Custom Dialog [ Message: "This node cannot be deleted as it in use x number of times in the following modules (main windows): "  &amp; $inUse &amp; "."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Set Variable [ $delete ]</li>
<li>Set Variable [ $$addTagToCitation ]</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Refresh Window</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::kdefaultNodeOther</li>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>TEMP</em>::kdefaultNodePrimary</li>
<li>
<em>TEMP</em>::kdefaultNodeTestSubject</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>tagMenus</em>::kGroupOrTest</li>
<li>
<em>ruleTagMenuGroups</em>::name</li>
<li>
<em>groupTest</em>::match</li>
<li>
<em>groupTest</em>::kRecordCreatorNode</li>
<li>
<em>groupTest</em>::CaptionORinuseCheck</li>
<li>
<em>groupTest</em>::defaultSectionInfo</li>
<li>
<em>testlearn</em>::kNodePrimary</li>
<li>
<em>testlearn</em>::kcsection</li>
<li>
<em>testlearn</em>::filterFind</li>
<li>
<em>testlearn</em>::kNodeOther</li>
<li>
<em>testlearn</em>::ktest</li>
<li>
<em>testlearn</em>::ktestSubject</li>
<li>
<em>reference</em>::knodePrimary</li>
<li>
<em>reference</em>::kcsection</li>
<li>
<em>reference</em>::knodeOther</li>
<li>
<em>tagTestSubjectLocation</em>::knode</li>
<li>
<em>tagTestSubjectLocation</em>::ksection</li>
<li>
<em>groupTest</em>::ksection</li>
<li>
<em>ruleTagMenuGroups</em>::ksection</li>
<li>
<em>tagMenus</em>::match</li>
<li>
<em>TEMP</em>::sortNode</li>
<li>
<em>ruleTagSectionName</em>::name</li>
<li>
<em>ruleTagMenuGroups</em>::order</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>tagTable</em>::kGroupOrTest</li>
<li>
<em>TEMP</em>::sortKey</li>
<li>
<em>groupTest</em>::_Lgroup</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33001ScriptAnchor_">deleteKeywordTag</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>tableGroupTag</li>
<li>defaultNode1</li>
<li>tableTestLearn</li>
<li>Reference</li>
<li>tableTestSubjectFocus</li>
<li>tableTag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33003ScriptAnchor_"></a><td class="script_navbar"><a href="#33002ScriptAnchor_"><span>Previous Script: [deleteNodeTag]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33209ScriptAnchor_"><span>Next Script: [addTagSectionKeysToMainRecordKeychain]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">deleteMHOCSPtags</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>If [ nodeLockTagMenus::orderOrLock &ne; "" and tagMenus::match = "sample" or 
nodeLockTagMenus::orderOrLock &ne; "" and tagMenus::match = "health" or 
nodeLockTagMenus::orderOrLock &ne; "" and tagMenus::match = "test" ]</li>
<li>Show Custom Dialog [ Message: "This record is currently locked.  Select the node that created it and enter the password to unlock it, then you will able to start the delete process."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ tagMenus::orderOrLock &ne; "" and tagMenus::match = "health" ]</li>
<li>Show Custom Dialog [ Message: "This record is locked by the system."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If the copyright being checked for deletion is in use</li>
<li>#as a default copyright then stop the script and inform</li>
<li>#the user of this fact.</li>
<li>If [ FilterValues ( TEMP::kdefaultHealth ; tagMenus::_Ltag &amp; "&para;" ) ]</li>
<li>Show Custom Dialog [ Message: "This copyright is currently selected as the default and cannot be deleted."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Exit field so user can see red delete </li>
<li>#formatting later on.</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Prevent all record load scripts (they slow down</li>
<li>#this script and are uneccessary).</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>#</li>
<li>#Get all variables needed to preform script.</li>
<li>Set Variable [ $tag; Value:tagMenus::_Ltag ]</li>
<li>Set Variable [ $name; Value:tagMenus::tag ]</li>
<li>#</li>
<li>#Open a new window and look for tag in both</li>
<li>#primary and other keyword fields.</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>New Window [ Name: "Delete Tag" ]</li>
<li>#</li>
<li>#Find tagged Reference records.</li>
<li>Go to Layout [ &ldquo;Reference&rdquo; (reference) ]</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>#</li>
<li>#</li>
<li>If [ $$citationMatch = "medium" ]</li>
<li>Set Field [ reference::kmedium; $tag ]</li>
<li>Else If [ $$citationMatch = "path" ]</li>
<li>Set Field [ reference::kfolderpath; $tag ]</li>
<li>Else If [ $$citationMatch = "copyist" ]</li>
<li>Set Field [ reference::kcopyist; $tag ]</li>
<li>Else If [ $$citationMatch = "organ" ]</li>
<li>Set Field [ reference::korgan; $tag ]</li>
<li>Else If [ $$citationMatch = "health" ]</li>
<li>Set Field [ reference::kHealth; $tag ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>Perform Find [  ]</li>
<li>Set Variable [ $refLastError; Value:Get (LastError) ]</li>
<li>#</li>
<li>#</li>
<li>#Find tagged TestLearn records.</li>
<li>Go to Layout [ &ldquo;learn1&rdquo; (testlearn) ]</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>#</li>
<li>#</li>
<li>If [ $$citationMatch = "medium" ]</li>
<li>Set Field [ testlearn::kmedium; $tag ]</li>
<li>Else If [ $$citationMatch = "path" ]</li>
<li>Set Field [ testlearn::kfolderPath; $tag ]</li>
<li>Else If [ $$citationMatch = "sample" ]</li>
<li>Set Field [ testlearn::kcsample; "*" &amp; $tag &amp; &para; ]</li>
<li>Else If [ $$citationMatch = "health" ]</li>
<li>Set Field [ testlearn::kHealth; $tag ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>Perform Find [  ]</li>
<li>Set Variable [ $TLLastError; Value:Get (LastError) ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>#</li>
<li>#If records are found using this tag tell user </li>
<li>#that it must be removed from all records </li>
<li>#before it can be deleted.</li>
<li>//  If [ $TLLastError &ne; 401  and  $refLastError &ne; 401 or
$TLLastError &ne; 401  and  $TLLastError &ne; 400  and  $refLastError &ne; 401 ]</li>
<li>If [ $TLLastError &ne; 401  and  $TLLastError &ne; 400  or  $refLastError &ne; 401 ]</li>
<li>Close Window [ Name: "Delete Tag"; Current file ]</li>
<li>If [ $refLastError &ne; 401 and $TLLastError &ne; 401 ]</li>
<li>Show Custom Dialog [ Message: "In use by Reference and Test Learn records.  Must be removed before deleting. Click the 'find' button and then the square button next to '" &amp; Left ( $name ; 20 ) &amp; If ( Length ( $name ) &gt; 20 ; "..." ; "" ) &amp; "' to find all records using this tag.  Go to all sections if not found here."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Else If [ $refLastError &ne; 401 ]</li>
<li>Show Custom Dialog [ Message: "In use by Reference records.  Must be removed before deleting. Click the 'find' button and then the square button next to '"  &amp; Left ( $name ; 20 ) &amp; If ( Length ( $name ) &gt; 20 ; "..." ; "" )  &amp; "' to find all records using this tag.  Go to all sections if not found here."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Else If [ $TLLastError &ne; 401 ]</li>
<li>Show Custom Dialog [ Message: "In use by Test Learn records.  Must be removed before deleting. Click the 'find' button and then the square button next to '"  &amp; Left ( $name ; 20 ) &amp; If ( Length ( $name ) &gt; 20 ; "..." ; "" )  &amp; "' to find all records using this tag.  Go to all sections if not found here."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>Set Variable [ $delete ]</li>
<li>Refresh Window</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>#If records are not found using this tag make</li>
<li>#sure user wants to delete it.</li>
<li>Else If [ $TLLastError = 401  and $refLastError  &ne;  0  or  

$TLLastError &ne; 0  and $refLastError  =  401  or  

$TLLastError = 401  and $refLastError  =  401 ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Set Variable [ $delete; Value:tagMenus::_Ltag ]</li>
<li>Refresh Window</li>
<li>Set Variable [ $category; Value:tagMenus::kGroupOrTest ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Delete " &amp; $name &amp; "?"; Buttons: &ldquo;Cancel&rdquo;, &ldquo;Delete&rdquo; ]</li>
<li>#</li>
<li>#If the user says yes, first make sure the record</li>
<li>#is not the last record in a category.  If it is and</li>
<li>#the system deleted the record without deleting</li>
<li>#the category too, this category would become</li>
<li>#an orphan as only categories that have records</li>
<li>#attached to them show up for the user to add</li>
<li>#more records uner them.  So the category</li>
<li>#record must also be deleted if this is the last</li>
<li>#record under it.</li>
<li>If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Select Window [ Name: "delete tag"; Current file ]</li>
<li>Go to Layout [ &ldquo;tableTag&rdquo; (tagTable) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTable::kGroupOrTest; $category ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#If there are more records under this cateogry</li>
<li>#then the system deletes the current record without</li>
<li>#any more user input.</li>
<li>If [ Get (FoundCount) &ne; 1 ]</li>
<li>Close Window [ Name: "Delete Tag"; Current file ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>Set Variable [ $delete ]</li>
<li>Set Variable [ $category ]</li>
<li>Refresh Window</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>#BUT if only one record is found user is asked</li>
<li>#if they want to delete the category too.</li>
<li>Else If [ Get (FoundCount) = 1 ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#</li>
<li>#The records are sorted by category to show</li>
<li>#the user which category is going to be deleted.</li>
<li>If [ TEMP::sortMedium &ne; "cat" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ TEMP::sortPath &ne; "cat" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ TEMP::sortCopyist &ne; "cat" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ TEMP::sortHealth &ne; "cat" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ TEMP::sortOrgan &ne; "cat" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Deleting "  &amp; Left ( $name ; 20 ) &amp; If ( Length ( $name ) &gt; 20 ; "..." ; "" )  &amp; " will also delete its category as it is the last item in this category."; Buttons: &ldquo;Cancel&rdquo;, &ldquo;Delete&rdquo; ]</li>
<li>#</li>
<li>#If the user says yes, then delete both the tag and </li>
<li>#the category record.</li>
<li>If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>Select Window [ Name: "delete tag"; Current file ]</li>
<li>Go to Layout [ &ldquo;tableGroupTag&rdquo; (groupTest) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ groupTest::_Lgroup; $category ]</li>
<li>Perform Find [  ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>End If</li>
<li>End If</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#No matter what the user decides (delete or cancel)</li>
<li>#return the user to the window they where looking</li>
<li>#at and restore the sort to what the user orginally</li>
<li>#had selected.</li>
<li>Close Window [ Name: "Delete Tag"; Current file ]</li>
<li>Set Variable [ $delete ]</li>
<li>Set Variable [ $category ]</li>
<li>#</li>
<li>#</li>
<li>If [ TEMP::sortMedium &ne; "cat" ]</li>
<li>Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ TEMP::sortPath &ne; "cat" ]</li>
<li>Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ TEMP::sortCopyist &ne; "cat" ]</li>
<li>Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ TEMP::sortHealth &ne; "cat" ]</li>
<li>Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ TEMP::sortOrgan &ne; "cat" ]</li>
<li>Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>Refresh Window</li>
<li>Set Variable [ $$stoploadCitation ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>nodeLockTagMenus</em>::orderOrLock</li>
<li>
<em>tagMenus</em>::match</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>TEMP</em>::kdefaultHealth</li>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>reference</em>::kmedium</li>
<li>
<em>reference</em>::kfolderpath</li>
<li>
<em>reference</em>::kcopyist</li>
<li>
<em>reference</em>::korgan</li>
<li>
<em>reference</em>::kHealth</li>
<li>
<em>testlearn</em>::kmedium</li>
<li>
<em>testlearn</em>::kfolderPath</li>
<li>
<em>testlearn</em>::kcsample</li>
<li>
<em>testlearn</em>::kHealth</li>
<li>
<em>tagMenus</em>::kGroupOrTest</li>
<li>
<em>tagTable</em>::kGroupOrTest</li>
<li>
<em>TEMP</em>::sortMedium</li>
<li>
<em>ruleTagMenuGroups</em>::order</li>
<li>
<em>ruleTagMenuGroups</em>::name</li>
<li>
<em>TEMP</em>::sortPath</li>
<li>
<em>TEMP</em>::sortCopyist</li>
<li>
<em>TEMP</em>::sortHealth</li>
<li>
<em>TEMP</em>::sortOrgan</li>
<li>
<em>groupTest</em>::_Lgroup</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>Reference</li>
<li>learn1</li>
<li>tableTag</li>
<li>tableGroupTag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33209ScriptAnchor_"></a><td class="script_navbar"><a href="#33003ScriptAnchor_"><span>Previous Script: [deleteMHOCSPtags]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33027ScriptAnchor_"><span>Next Script: [CHUNKaddLinkToTag]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">addTagSectionKeysToMainRecordKeychain</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33027ScriptAnchor_">CHUNKaddLinkToTag</a></li>
<li><a href="#33022ScriptAnchor_">CHUNKaddPictureToTag</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Add all tag's section keys to reference or learn record,</li>
<li>#so that wherever this tag is with this learn or reference</li>
<li>#record's picture, the record the picture came from is</li>
<li>#also available.  This is especially important if the user</li>
<li>#decides to include only one section.  The picture-</li>
<li>#containing record needs to be part of that section!</li>
<li>#BUT, the tag does not need to be in every section</li>
<li>#this picture-containing record is in, unless this record</li>
<li>#is tagged with the tag it is adding the picture to.</li>
<li>#NOTE: add section keys only to keyword and node tags.</li>
<li>If [ $$citationMatch = "node" or $$citationMatch = "key" ]</li>
<li>#</li>
<li>#Discover first if the section keys in the tag's</li>
<li>#keychain are also in the Main record's keychain.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Set Variable [ $keychain; Value:ruleTagMenuGroups::ksection ]</li>
<li>#</li>
<li>#Capture the tag's key to determin later if it is in any</li>
<li>#of this learn or reference record's key fields.</li>
<li>Set Variable [ $tagKey; Value:tagMenus::_Ltag ]</li>
<li>#</li>
<li>#Determine how many keys there are in the tag's</li>
<li>#keychain.</li>
<li>Set Variable [ $numberOfKeys; Value:ValueCount ( $keychain ) ]</li>
<li>#</li>
<li>#Loop thru each key to see if any do not match</li>
<li>#keys in the main record's keychain.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>End If</li>
<li>Loop</li>
<li>#</li>
<li>#Exit the loop when there are no more keys to check.</li>
<li>Exit Loop If [ $numberOfKeys = 0 ]</li>
<li>#</li>
<li>#If main record being tagged does not have</li>
<li>#one or more of the tag's keys in its keychain then</li>
<li>#add the missing keys.</li>
<li>If [ Get ( LayoutTableName ) = "testlearn"  and  

GetValue ( $keychain ; $numberOfKeys ) &ne; 
GetValue ( FilterValues ( testlearn::kcsection &amp; &para; ; GetValue ( $keychain ; $numberOfKeys ) &amp; &para; ) ; 1 ) ]</li>
<li>#</li>
<li>#Next, add the current section key to this </li>
<li>#group's keychain.</li>
<li>Set Variable [ $groupSectionKeychain; Value:testlearn::kcsection ]</li>
<li>Set Field [ testlearn::kcsection; GetValue ( $keychain ; $numberOfKeys )  &amp; &para; &amp; $groupSectionKeychain ]</li>
<li>#</li>
<li>Else If [ Get ( LayoutTableName ) = "reference" and  

GetValue ( $keychain ; $numberOfKeys ) &ne; 
GetValue ( FilterValues ( reference::kcsection &amp; &para; ; GetValue ( $keychain ; $numberOfKeys ) &amp; &para; ) ; 1 ) ]</li>
<li>#</li>
<li>#Next, add the current section key to this </li>
<li>#group's keychain.</li>
<li>Set Variable [ $groupSectionKeychain; Value:reference::kcsection ]</li>
<li>Set Field [ reference::kcsection; GetValue ( $keychain ; $numberOfKeys )  &amp; &para; &amp; $groupSectionKeychain ]</li>
<li>#</li>
<li>End If</li>
<li>#</li>
<li>#Go the next key up from the bottom of the list</li>
<li>#of keys on this section's keychain.</li>
<li>Set Variable [ $numberOfKeys; Value:$numberOfKeys - 1 ]</li>
<li>End Loop</li>
<li>#</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>ruleTagMenuGroups</em>::ksection</li>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>testlearn</em>::kcsection</li>
<li>
<em>reference</em>::kcsection</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33027ScriptAnchor_"></a><td class="script_navbar"><a href="#33209ScriptAnchor_"><span>Previous Script: [addTagSectionKeysToMainRecordKeychain]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33037ScriptAnchor_"><span>Next Script: [folderPathCheckForForwardSlash]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">CHUNKaddLinkToTag</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33028ScriptAnchor_">addFileLink4ToTag</a></li>
<li><a href="#33029ScriptAnchor_">addFileLink5ToTag</a></li>
<li><a href="#33030ScriptAnchor_">addFileLink6ToTag</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Get key for link that is to be added to tag.</li>
<li>If [ Get ( LayoutTableName ) = "reference" ]</li>
<li>Set Variable [ $tag; Value:reference::_Lreference ]</li>
<li>Set Variable [ $number; Value:$$number ]</li>
<li>Set Variable [ $$number ]</li>
<li>Set Variable [ $name; Value:$$name ]</li>
<li>Set Variable [ $$name ]</li>
<li>Set Variable [ $window; Value:Get (WindowName) ]</li>
<li>Else If [ Get ( LayoutTableName ) = "testlearn" ]</li>
<li>Set Variable [ $tag; Value:testlearn::_Ltestlearn ]</li>
<li>Set Variable [ $number; Value:$$number ]</li>
<li>Set Variable [ $$number ]</li>
<li>Set Variable [ $name; Value:$$name ]</li>
<li>Set Variable [ $$name ]</li>
<li>Set Variable [ $window; Value:Get (WindowName) ]</li>
<li>End If</li>
<li>#</li>
<li>#Add all tag's section keys to reference or learn record.</li>
<li>Perform Script [ &ldquo;addTagSectionKeysToMainRecordKeychain&rdquo; ]</li>
<li>#</li>
<li>#Now add all the added record&rsquo;s node and keyword </li>
<li>#tags to any newly added sections.  </li>
<li>Perform Script [ &ldquo;CHUNKaddReferenceNodesAndKeywords&rdquo; ]</li>
<li>#</li>
<li>#Complete process of adding link to tag.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>#</li>
<li>#Remove focus from field so can see </li>
<li>#conditional formatting.</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Remove key from other slots in may be in, to</li>
<li>#prevent duplicates showing up.</li>
<li>If [ tagMenus::Ktitle1 = $tag and $number &ne; 1 ]</li>
<li>Set Field [ tagMenus::Ktitle1; "" ]</li>
<li>Else If [ tagMenus::Ktitle2 = $tag and $number &ne; 2 ]</li>
<li>Set Field [ tagMenus::Ktitle2; "" ]</li>
<li>Else If [ tagMenus::Ktitle3= $tag and $number &ne; 3 ]</li>
<li>Set Field [ tagMenus::Ktitle3; "" ]</li>
<li>End If</li>
<li>#</li>
<li>#Place key in selected slot.</li>
<li>If [ tagMenus::Ktitle1  &ne; $tag and $number  =  1 ]</li>
<li>Set Field [ tagMenus::Ktitle1; $tag ]</li>
<li>Select Window [ Name: $window; Current file ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ tagMenus::Ktitle2  &ne; $tag and $number  =  2 ]</li>
<li>Set Field [ tagMenus::Ktitle2; $tag ]</li>
<li>Select Window [ Name: $window; Current file ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ tagMenus::Ktitle3 &ne; $tag and $number  =  3 ]</li>
<li>Set Field [ tagMenus::Ktitle3; $tag ]</li>
<li>Select Window [ Name: $window; Current file ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Remove it key if it is already in use.</li>
<li>If [ tagMenus::Ktitle1 = $tag and $number = 1 ]</li>
<li>Set Field [ tagMenus::Ktitle1; "" ]</li>
<li>Else If [ tagMenus::Ktitle2 = $tag and $number = 2 ]</li>
<li>Set Field [ tagMenus::Ktitle2; "" ]</li>
<li>Else If [ tagMenus::Ktitle3 = $tag and $number = 3 ]</li>
<li>Set Field [ tagMenus::Ktitle3; "" ]</li>
<li>End If</li>
<li>Select Window [ Name: $window; Current file ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::_Lreference</li>
<li>
<em>testlearn</em>::_Ltestlearn</li>
<li>
<em>tagMenus</em>::Ktitle1</li>
<li>
<em>tagMenus</em>::Ktitle2</li>
<li>
<em>tagMenus</em>::Ktitle3</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33209ScriptAnchor_">addTagSectionKeysToMainRecordKeychain</a></li>
<li><a href="#33207ScriptAnchor_">CHUNKaddReferenceNodesAndKeywords</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33037ScriptAnchor_"></a><td class="script_navbar"><a href="#33027ScriptAnchor_"><span>Previous Script: [CHUNKaddLinkToTag]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33043ScriptAnchor_"><span>Next Script: [gotoLessLayoutsTag]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">folderPathCheckForForwardSlash</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ Right ( tagMenus::tag ; 1 )  &ne;  "/" and $$citationMatch = "folderPath" ]</li>
<li>Show Custom Dialog [ Message: "All filepaths must end with forward slash /.  Make sure you did not copy the file name along with the file path."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagMenus</em>::tag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33043ScriptAnchor_"></a><td class="script_navbar"><a href="#33037ScriptAnchor_"><span>Previous Script: [folderPathCheckForForwardSlash]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33097ScriptAnchor_"><span>Next Script: [gotoLessLayoutsTL]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">gotoLessLayoutsTag</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If in add mode, keep user on the evenMore layout.</li>
<li>If [ $$add = 1 ]</li>
<li>Show Custom Dialog [ Message: "Turn off add mode (click 'add' button) to reduce number of pictures shown and full link names."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Reveal more or fewer pictures and links for tag.</li>
<li>If [ Right ( Get (LayoutName) ; 8 ) = "evenmore" ]</li>
<li>If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>Go to Layout [ &ldquo;ltagNK3&rdquo; (tagMenus) ]</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "r" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenu2keywordOrNode2&rdquo; (tagMenus) ]</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "d" ]</li>
<li>Go to Layout [ &ldquo;defaultNode2&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>Else If [ Right ( Get (LayoutName) ; 4 ) = "more" ]</li>
<li>If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>Go to Layout [ &ldquo;ltagNK2&rdquo; (tagMenus) ]</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "r" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenu2keywordOrNode1&rdquo; (tagMenus) ]</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "d" ]</li>
<li>Go to Layout [ &ldquo;defaultNode1&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Remember layout user is on so they can be</li>
<li>#returned to correct view.</li>
<li>If [ $$citationMatch = "node" ]</li>
<li>If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>Set Field [ TEMP::layoutLtagN; Get (LayoutName) ]</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "r" ]</li>
<li>Set Field [ TEMP::layoutRtagN; Get (LayoutName) ]</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "d" ]</li>
<li>Set Field [ TEMP::DefaultmoreORLessLayoutNode; Get (LayoutName) ]</li>
<li>End If</li>
<li>Else If [ $$citationMatch = "key" ]</li>
<li>If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>Set Field [ TEMP::layoutLtagK; Get (LayoutName) ]</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "r" ]</li>
<li>Set Field [ TEMP::layoutRtagK; Get (LayoutName) ]</li>
<li>End If</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::layoutLtagN</li>
<li>
<em>TEMP</em>::layoutRtagN</li>
<li>
<em>TEMP</em>::DefaultmoreORLessLayoutNode</li>
<li>
<em>TEMP</em>::layoutLtagK</li>
<li>
<em>TEMP</em>::layoutRtagK</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>ltagNK3</li>
<li>ReferenceMenu2keywordOrNode2</li>
<li>defaultNode2</li>
<li>ltagNK2</li>
<li>ReferenceMenu2keywordOrNode1</li>
<li>defaultNode1</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33097ScriptAnchor_"></a><td class="script_navbar"><a href="#33043ScriptAnchor_"><span>Previous Script: [gotoLessLayoutsTag]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33075ScriptAnchor_"><span>Next Script: [gotoLessDetailLayout]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">gotoLessLayoutsTL</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Reveal more or fewer pictures and links for tag.</li>
<li>If [ Right ( Get (LayoutName) ; 8 ) = "evenmore" ]</li>
<li>If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>Go to Layout [ &ldquo;learn3&rdquo; (testlearn) ]</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "t" ]</li>
<li>End If</li>
<li>Else If [ Get (LayoutName) = "learnBigPicture" ]</li>
<li>If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>Go to Layout [ &ldquo;learn2&rdquo; (testlearn) ]</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "t" ]</li>
<li>End If</li>
<li>Else If [ Right ( Get (LayoutName) ; 4 ) = "more" and Right ( Get (LayoutName) ; 8 ) &ne; "evenmore" and Right ( Get (LayoutName) ; 10 ) &ne; "BigPicture" ]</li>
<li>If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>Go to Layout [ &ldquo;learn1&rdquo; (testlearn) ]</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "t" ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Remember layout user is on so they can be</li>
<li>#returned to correct view.</li>
<li>If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>Set Field [ TEMP::layoutLmain; Get (LayoutName) ]</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "t" ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::layoutLmain</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>learn3</li>
<li>learn2</li>
<li>learn1</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33075ScriptAnchor_"></a><td class="script_navbar"><a href="#33097ScriptAnchor_"><span>Previous Script: [gotoLessLayoutsTL]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33076ScriptAnchor_"><span>Next Script: [gotoMoreDetailLayout]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">gotoLessDetailLayout</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If in add mode, keep user on the evenMore layout.</li>
<li>If [ $$add = 1 ]</li>
<li>Show Custom Dialog [ Message: "Turn off add mode (click 'add' button) to reduce number of pictures shown and full link names."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Reveal more or fewer pictures and links for tag.</li>
<li>If [ Right ( Get (LayoutName) ; 8 ) = "evenmore" ]</li>
<li>Go to Layout [ &ldquo;testMenuTestItemMORE&rdquo; (tagMenus) ]</li>
<li>Else If [ Right ( Get (LayoutName) ; 4 ) = "more" ]</li>
<li>Go to Layout [ &ldquo;setupTestItem&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>#</li>
<li>#Remember layout user is on so they can be</li>
<li>#returned to correct view.</li>
<li>Set Field [ TEMP::DetailmoreORLessLayout; Get (LayoutName) ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::DetailmoreORLessLayout</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>testMenuTestItemMORE</li>
<li>setupTestItem</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33076ScriptAnchor_"></a><td class="script_navbar"><a href="#33075ScriptAnchor_"><span>Previous Script: [gotoLessDetailLayout]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33083ScriptAnchor_"><span>Next Script: [showCited]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">gotoMoreDetailLayout</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If in add mode, keep user on the evenMore layout.</li>
<li>If [ $$add = 1 ]</li>
<li>Show Custom Dialog [ Message: "Turn off add mode (click 'add' button) to reduce number of pictures shown and full link names."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Reveal more or fewer pictures and links for tag.</li>
<li>If [ Right ( Get (LayoutName) ; 8 ) = "testItem" ]</li>
<li>Go to Layout [ &ldquo;testMenuTestItemMORE&rdquo; (tagMenus) ]</li>
<li>Else If [ Right ( Get (LayoutName) ; 4 ) = "more" ]</li>
<li>Go to Layout [ &ldquo;addMenuTestItem&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>#</li>
<li>#Remember layout user is on so they can be</li>
<li>#returned to correct view.</li>
<li>Set Field [ TEMP::DetailmoreORLessLayout; Get (LayoutName) ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::DetailmoreORLessLayout</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>testMenuTestItemMORE</li>
<li>addMenuTestItem</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33083ScriptAnchor_"></a><td class="script_navbar"><a href="#33076ScriptAnchor_"><span>Previous Script: [gotoMoreDetailLayout]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33243ScriptAnchor_"><span>Next Script: [CHUNKHealthLockedFields]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">showCited</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If user is not in add mode then inform user they</li>
<li>#must be before the database will show them reference</li>
<li>#data.  The reason for this is because the layout</li>
<li>#in the reference or learn window changes to the</li>
<li>#add tag from these windows to the Tag Menu</li>
<li>#item selected.  So instead of having the system</li>
<li>#automatically go into add mode, the user must</li>
<li>#decide they want to do this and thus be expecting</li>
<li>#a change in the layouts.  Otherwise this change</li>
<li>#could confuse a user.  So at the cost of minor </li>
<li>#inconvience I have chosen not to have the system</li>
<li>#guess the user wants to go into add mode and is </li>
<li>#expecting the system to do that when they click</li>
<li>#one of these numbered buttons on the showEvenMore</li>
<li>#layouts.</li>
<li>#</li>
<li>#</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>End If</li>
<li>Set Window Title [ Current Window; New Title: "References" ]</li>
<li>Go to Layout [ $$citeLayout ]</li>
<li>#</li>
<li>#Prevent record loading script during loops to</li>
<li>#find wanted record, which would slow down system.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>#</li>
<li>#Now loop thru all the records until the record</li>
<li>#that fits the key is found.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ reference::_Lreference = $$cited ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Allow the record load script to run and run it.</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Perform Script [ &ldquo;loadCitation&rdquo; ]</li>
<li>#</li>
<li>#Put focus back on Tag Menus window and conditionally</li>
<li>#format any items that may be linked to record</li>
<li>#in the other window.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::_Lreference</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32984ScriptAnchor_">loadCitation</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33243ScriptAnchor_"></a><td class="script_navbar"><a href="#33083ScriptAnchor_"><span>Previous Script: [showCited]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33099ScriptAnchor_"><span>Next Script: [findMode]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">CHUNKHealthLockedFields</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33013ScriptAnchor_">menuHealth</a></li>
<li><a href="#33089ScriptAnchor_">defaultHealthMenu</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Users cannot delete locked copyright records, but</li>
<li>#they might edit them.  This script insures any edits</li>
<li>#made are replaced with the content from the </li>
<li>#Creative Commons website.</li>
<li>#</li>
<li>If [ $$citationMatch = "health" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>Loop</li>
<li>If [ 9072011223903376 = tagMenus::_Ltag or 9072011223903376 = tagMenus::_Ltag ]</li>
<li>Set Field [ tagMenus::tag; "This media file is in the public domain in the United States." ]</li>
<li>Set Field [ tagMenus::tagSpelling; "This media file is in the public domain in the United States." ]</li>
<li>Set Field [ tagMenus::notesOrHealth; "This applies to U.S. works where the copyright has expired, often because its first publication occurred prior to January 1, 1923.  "  &amp; &para; &amp; "

This image might not be in the public domain outside of the United States; this especially applies in the countries and areas that do not apply the rule of the shorter term for US works, such as Canada, Mainland China (not Hong Kong or Macao), Germany, Mexico, and Switzerland. The creator and year of publication are essential information and must be provided. See Wikipedia:Public domain and Wikipedia:Copyrights for more details." ]</li>
<li>Set Field [ citationPicture1::kcsection; "" ]</li>
<li>#</li>
<li>Else If [ 9072011221202374 = tagTable::_Ltag or 9072011221202374 = tagMenus::_Ltag ]</li>
<li>Set Field [ tagMenus::tag; "This work is in the public domain in the United States, and those countries with a copyright term of life of the author plus 100 years or fewer." ]</li>
<li>Set Field [ tagMenus::tagSpelling; "This work is in the public domain in the United States, and those countries with a copyright term of life of the author plus 100 years or fewer." ]</li>
<li>Set Field [ tagMenus::notesOrHealth; "" ]</li>
<li>Set Field [ citationPicture1::kcsection; "" ]</li>
<li>#</li>
<li>Else If [ 8172011134941327 = tagTable::_Ltag or 8172011134941327 = tagMenus::_Ltag ]</li>
<li>Set Field [ tagMenus::tag; "Public domain in USA.  This image (or other media file) is in the public domain because its copyright has expired." ]</li>
<li>Set Field [ tagMenus::tagSpelling; "Public domain in USA.  This image (or other media file) is in the public domain because its copyright has expired." ]</li>
<li>Set Field [ tagMenus::notesOrHealth; "This applies to Australia, the European Union and those countries with a copyright term of life of the author plus 70 years."  &amp; &para; &amp; "

You must also include a United States public domain tag to indicate why this work is in the public domain in the United States. Note that a few countries have copyright terms longer than 70 years: Mexico has 100 years, Colombia has 80 years, and Guatemala and Samoa have 75 years. This image may not be in the public domain in these countries, which moreover do not implement the rule of the shorter term. C&ocirc;te d'Ivoire has a general copyright term of 99 years and Honduras has 75 years, but they do implement the rule of the shorter term." ]</li>
<li>Set Field [ citationPicture1::kcsection; "" ]</li>
<li>#</li>
<li>Else If [ 8102011220941282 = tagTable::_Ltag or 8102011220941282 = tagMenus::_Ltag ]</li>
<li>Set Field [ tagMenus::tag; "All rights reserved by copyright holder (Do Not Share)" ]</li>
<li>Set Field [ tagMenus::tagSpelling; "All rights reserved by copyright holder (Do Not Share)" ]</li>
<li>Set Field [ tagMenus::notesOrHealth; "" ]</li>
<li>Set Field [ citationPicture1::kcsection; "" ]</li>
<li>#</li>
<li>Else If [ 31620121743201228 = tagTable::_Ltag or 31620121743201228 = tagMenus::_Ltag ]</li>
<li>Set Field [ tagMenus::tag; "No Known Copyright. WARNING: There may be copyrights reserved in some countries, locations, etc." ]</li>
<li>Set Field [ tagMenus::tagSpelling; "No Known Copyright. WARNING: There may be copyrights reserved in some countries, locations, etc." ]</li>
<li>Set Field [ tagMenus::notesOrHealth; "" ]</li>
<li>Set Field [ citationPicture1::kcsection; "" ]</li>
<li>#</li>
<li>Else If [ 31620121746441229 = tagTable::_Ltag or 31620121746441229 = tagMenus::_Ltag ]</li>
<li>Set Field [ tagMenus::tag; "CC BY 3.0 (Attribution 3.0 Unported)" ]</li>
<li>Set Field [ tagMenus::tagSpelling; "CC BY 3.0 (Attribution 3.0 Unported)" ]</li>
<li>Set Field [ tagMenus::notesOrHealth; "This is a human-readable summary of the Legal Code " &amp; &para; &amp; "

Click the health tag-menu view button to reveal link to full code and translations of license if you are not currently seeing the link" &amp; &para; &amp; "
 
You are free:" &amp; &para; &amp; "

    to Share &mdash; to copy, distribute and transmit the work" &amp; &para; &amp; "
    to Remix &mdash; to adapt the work" &amp; &para; &amp; "
    to make commercial use of the work" &amp; &para; &amp; "

Under the following conditions:" &amp; &para; &amp; "

    Attribution &mdash; You must attribute the work in the manner specified by the author or licensor (but not in any way that suggests that they endorse you or your use of the work)."  &amp; &para; &amp; "

With the understanding that:" &amp; &para; &amp; "

    Waiver &mdash; Any of the above conditions can be waived if you get permission from the copyright holder." &amp; &para; &amp; "
    Public Domain &mdash; Where the work or any of its elements is in the public domain under applicable law, that status is in no way affected by the license." &amp; &para; &amp; "
    Other Rights &mdash; In no way are any of the following rights affected by the license:" &amp; &para; &amp; "
        Your fair dealing or fair use rights, or other applicable copyright exceptions and limitations;" &amp; &para; &amp; "
        The author's moral rights;" &amp; &para; &amp; "
        Rights other persons may have either in the work itself or in how the work is used, such as publicity or privacy rights." &amp; &para; &amp; "
    Notice &mdash; For any reuse or distribution, you must make clear to others the license terms of this work. The best way to do this is with a link to this web page.
" ]</li>
<li>Set Field [ citationPicture1::kcsection; "" ]</li>
<li>#</li>
<li>Else If [ 6282014220454904 = tagTable::_Ltag or 6282014220454904 = tagMenus::_Ltag ]</li>
<li>Set Field [ tagMenus::tag; "CC BY 4.0 (Attribution 4.0 International)" ]</li>
<li>Set Field [ tagMenus::tagSpelling; "CC BY 4.0 (Attribution 4.0 International)" ]</li>
<li>Set Field [ tagMenus::notesOrHealth; "This is a human-readable summary of (and not a substitute for) the license. " &amp; &para; &amp; "

Click the health tag-menu view button to reveal link to full code and translations of license if you are not currently seeing the link" &amp; &para; &amp; "

You are free:" &amp; &para; &amp; "

    Share &mdash; copy and redistribute the material in any medium or format" &amp; &para; &amp; "

    Adapt &mdash; remix, transform, and build upon the material" &amp; &para; &amp; "
    for any purpose, even commercially." &amp; &para; &amp; "

The licensor cannot revoke these freedoms as long as you follow the license terms." &amp; &para; &amp; "

Under the following terms:" &amp; &para; &amp; "

    Attribution &mdash; You must give appropriate credit, provide a link to the license, and indicate if changes were made. You may do so in any reasonable manner, but not in any way that suggests the licensor endorses you or your use." &amp; &para; &amp; "

No additional restrictions &mdash; You may not apply legal terms or technological measures that legally restrict others from doing anything the license permits." &amp; &para; &amp; "

Notices:" &amp; &para; &amp; "

    You do not have to comply with the license for elements of the material in the public domain or where your use is permitted by an applicable exception or limitation. " &amp; &para; &amp; "
    No warranties are given. The license may not give you all of the permissions necessary for your intended use. For example, other rights such as publicity, privacy, or moral rights may limit how you use the material. " ]</li>
<li>Set Field [ citationPicture1::kcsection; "" ]</li>
<li>#</li>
<li>Else If [ 31620121837161231 = tagTable::_Ltag or 31620121837161231 = tagMenus::_Ltag ]</li>
<li>Set Field [ tagMenus::tag; "CC BY-NC 3.0 (Attribution-NonCommercial 3.0 Unported)" ]</li>
<li>Set Field [ tagMenus::tagSpelling; "CC BY-NC 3.0 (Attribution-NonCommercial 3.0 Unported)" ]</li>
<li>Set Field [ tagMenus::notesOrHealth; "This is a human-readable summary of the Legal Code " &amp; &para; &amp; "

Click the health tag-menu view button to reveal link to full code and translations of license if you are not currently seeing the link" &amp; &para; &amp; "

You are free:" &amp; &para; &amp; "

    to Share &mdash; to copy, distribute and transmit the work" &amp; &para; &amp; "
    to Remix &mdash; to adapt the work" &amp; &para; &amp; "

Under the following conditions:" &amp; &para; &amp; "

    Attribution &mdash; You must attribute the work in the manner specified by the author or licensor (but not in any way that suggests that they endorse you or your use of the work)." &amp; &para; &amp; "

    Noncommercial &mdash; You may not use this work for commercial purposes." &amp; &para; &amp; "

With the understanding that:" &amp; &para; &amp; "

    Waiver &mdash; Any of the above conditions can be waived if you get permission from the copyright holder." &amp; &para; &amp; "
    Public Domain &mdash; Where the work or any of its elements is in the public domain under applicable law, that status is in no way affected by the license." &amp; &para; &amp; "
    Other Rights &mdash; In no way are any of the following rights affected by the license:" &amp; &para; &amp; "
        Your fair dealing or fair use rights, or other applicable copyright exceptions and limitations;" &amp; &para; &amp; "
        The author's moral rights;" &amp; &para; &amp; "
        Rights other persons may have either in the work itself or in how the work is used, such as publicity or privacy rights." &amp; &para; &amp; "
    Notice &mdash; For any reuse or distribution, you must make clear to others the license terms of this work. The best way to do this is with a link to this web page.
" ]</li>
<li>Set Field [ citationPicture1::kcsection; "" ]</li>
<li>#</li>
<li>Else If [ 6272014222057903 = tagTable::_Ltag or 6272014222057903 = tagMenus::_Ltag ]</li>
<li>Set Field [ tagMenus::tag; "CC BY-NC 4.0 (Attribution-NonCommercial 4.0 International)" ]</li>
<li>Set Field [ tagMenus::tagSpelling; "CC BY-NC 4.0 (Attribution-NonCommercial 4.0 International)" ]</li>
<li>Set Field [ tagMenus::notesOrHealth; "This is a human-readable summary of (and not a substitute for) the license. " &amp; &para; &amp; "

Click the health tag-menu view button to reveal link to full code and translations of license if you are not currently seeing the link" &amp; &para; &amp; "

You are free:" &amp; &para; &amp; "

    Share &mdash; copy and redistribute the material in any medium or format" &amp; &para; &amp; "
    Adapt &mdash; remix, transform, and build upon the material" &amp; &para; &amp; "
The licensor cannot revoke these freedoms as long as you follow the license terms." &amp; &para; &amp; "

Under the following terms:" &amp; &para; &amp; "

    Attribution &mdash; You must give appropriate credit, provide a link to the license, and indicate if changes were made. You may do so in any reasonable manner, but not in any way that suggests the licensor endorses you or your use." &amp; &para; &amp; "

    NonCommercial &mdash; You may not use the material for commercial purposes." &amp; &para; &amp; "

No additional restrictions &mdash; You may not apply legal terms or technological measures that legally restrict others from doing anything the license permits." &amp; &para; &amp; "

Notices:" &amp; &para; &amp; "

    You do not have to comply with the license for elements of the material in the public domain or where your use is permitted by an applicable exception or limitation. " &amp; &para; &amp; "
    No warranties are given. The license may not give you all of the permissions necessary for your intended use. For example, other rights such as publicity, privacy, or moral rights may limit how you use the material. " ]</li>
<li>Set Field [ citationPicture1::kcsection; "" ]</li>
<li>#</li>
<li>Else If [ 31620121841541232 = tagTable::_Ltag or 31620121841541232 = tagMenus::_Ltag ]</li>
<li>Set Field [ tagMenus::tag; "CC BY-SA 3.0 (Attribution-ShareAlike 3.0 Unported)" ]</li>
<li>Set Field [ tagMenus::tagSpelling; "CC BY-SA 3.0 (Attribution-ShareAlike 3.0 Unported)" ]</li>
<li>Set Field [ tagMenus::notesOrHealth; "This is a human-readable summary of the Legal Code " &amp; &para; &amp; "

Click the health tag-menu view button to reveal link to full code and translations of license if you are not currently seeing the link" &amp; &para; &amp; "

 
You are free:" &amp; &para; &amp; "

to Share &mdash; to copy, distribute and transmit the work" &amp; &para; &amp; "
to Remix &mdash; to adapt the work" &amp; &para; &amp; "
to make commercial use of the work" &amp; &para; &amp; "
Under the following conditions:" &amp; &para; &amp; "

Attribution &mdash; You must attribute the work in the manner specified by the author or licensor (but not in any way that suggests that they endorse you or your use of the work)." &amp; &para; &amp; "
Share Alike &mdash; If you alter, transform, or build upon this work, you may distribute the resulting work only under the same or similar license to this one.
With the understanding that:" &amp; &para; &amp; "

Waiver &mdash; Any of the above conditions can be waived if you get permission from the copyright holder." &amp; &para; &amp; "
Public Domain &mdash; Where the work or any of its elements is in the public domain under applicable law, that status is in no way affected by the license." &amp; &para; &amp; "
Other Rights &mdash; In no way are any of the following rights affected by the license:" &amp; &para; &amp; "
Your fair dealing or fair use rights, or other applicable copyright exceptions and limitations;" &amp; &para; &amp; "
The author's moral rights;" &amp; &para; &amp; "
Rights other persons may have either in the work itself or in how the work is used, such as publicity or privacy rights." &amp; &para; &amp; "
Notice &mdash; For any reuse or distribution, you must make clear to others the license terms of this work. " ]</li>
<li>Set Field [ citationPicture1::kcsection; "" ]</li>
<li>#</li>
<li>Else If [ 6282014225223905 = tagTable::_Ltag or 6282014225223905 = tagMenus::_Ltag ]</li>
<li>Set Field [ tagMenus::tag; "CC BY-SA 4.0 (Attribution-ShareAlike 4.0 International)" ]</li>
<li>Set Field [ tagMenus::tagSpelling; "CC BY-SA 4.0 (Attribution-ShareAlike 4.0 International)" ]</li>
<li>Set Field [ tagMenus::notesOrHealth; "This is a human-readable summary of (and not a substitute for) the license. " &amp; &para; &amp; "

Click the health tag-menu view button to reveal link to full code and translations of license if you are not currently seeing the link" &amp; &para; &amp; "

You are free:" &amp; &para; &amp; "

    Share &mdash; copy and redistribute the material in any medium or format" &amp; &para; &amp; "
    Adapt &mdash; remix, transform, and build upon the material" &amp; &para; &amp; "
    for any purpose, even commercially." &amp; &para; &amp; "
The licensor cannot revoke these freedoms as long as you follow the license terms." &amp; &para; &amp; "

Under the following terms:" &amp; &para; &amp; "

    Attribution &mdash; You must give appropriate credit, provide a link to the license, and indicate if changes were made. You may do so in any reasonable manner, but not in any way that suggests the licensor endorses you or your use." &amp; &para; &amp; "

ShareAlike &mdash; If you remix, transform, or build upon the material, you must distribute your contributions under the same license as the original." &amp; &para; &amp; "

No additional restrictions &mdash; You may not apply legal terms or technological measures that legally restrict others from doing anything the license permits." &amp; &para; &amp; "

Notices:" &amp; &para; &amp; "

    You do not have to comply with the license for elements of the material in the public domain or where your use is permitted by an applicable exception or limitation. " &amp; &para; &amp; "
    No warranties are given. The license may not give you all of the permissions necessary for your intended use. For example, other rights such as publicity, privacy, or moral rights may limit how you use the material. " ]</li>
<li>Set Field [ citationPicture1::kcsection; "" ]</li>
<li>#</li>
<li>Else If [ 31620121902441234 = tagTable::_Ltag or 31620121902441234 = tagMenus::_Ltag ]</li>
<li>Set Field [ tagMenus::tag; "CC BY-ND 3.0 (Attribution-NoDerivs 3.0 Unported)" ]</li>
<li>Set Field [ tagMenus::tagSpelling; "CC BY-ND 3.0 (Attribution-NoDerivs 3.0 Unported)" ]</li>
<li>Set Field [ tagMenus::notesOrHealth; "This is a human-readable summary of the Legal Code" &amp; &para; &amp; "

Click the health tag-menu view button to reveal link to full code and translations of license if you are not currently seeing the link" &amp; &para; &amp; "

You are free:" &amp; &para; &amp; "

    to Share &mdash; to copy, distribute and transmit the work" &amp; &para; &amp; "
    to make commercial use of the work" &amp; &para; &amp; "

Under the following conditions:" &amp; &para; &amp; "

    Attribution &mdash; You must attribute the work in the manner specified by the author or licensor (but not in any way that suggests that they endorse you or your use of the work)." &amp; &para; &amp; "

    No Derivative Works &mdash; You may not alter, transform, or build upon this work." &amp; &para; &amp; "

With the understanding that:" &amp; &para; &amp; "

    Waiver &mdash; Any of the above conditions can be waived if you get permission from the copyright holder." &amp; &para; &amp; "
    Public Domain &mdash; Where the work or any of its elements is in the public domain under applicable law, that status is in no way affected by the license." &amp; &para; &amp; "
    Other Rights &mdash; In no way are any of the following rights affected by the license:" &amp; &para; &amp; "
        Your fair dealing or fair use rights, or other applicable copyright exceptions and limitations;" &amp; &para; &amp; "
        The author's moral rights;" &amp; &para; &amp; "
        Rights other persons may have either in the work itself or in how the work is used, such as publicity or privacy rights." &amp; &para; &amp; "
    Notice &mdash; For any reuse or distribution, you must make clear to others the license terms of this work. The best way to do this is with a link to this web page." ]</li>
<li>Set Field [ citationPicture1::kcsection; "" ]</li>
<li>#</li>
<li>Else If [ 6282014232807908 = tagTable::_Ltag or 6282014232807908 = tagMenus::_Ltag ]</li>
<li>Set Field [ tagMenus::tag; "CC BY-ND 4.0 (Attribution-NoDerivs 4.0 International)" ]</li>
<li>Set Field [ tagMenus::tagSpelling; "CC BY-ND 4.0 (Attribution-NoDerivs 4.0 International)" ]</li>
<li>Set Field [ tagMenus::notesOrHealth; "This is a human-readable summary of (and not a substitute for) the license. " &amp; &para; &amp; "

Click the health tag-menu view button to reveal link to full code and translations of license if you are not currently seeing the link" &amp; &para; &amp; "

You are free:" &amp; &para; &amp; "

    Share &mdash; copy and redistribute the material in any medium or format" &amp; &para; &amp; "
    for any purpose, even commercially."  &amp; &para; &amp; "

The licensor cannot revoke these freedoms as long as you follow the license terms." &amp; &para; &amp; "

Under the following terms:" &amp; &para; &amp; "

    Attribution &mdash; You must give appropriate credit, provide a link to the license, and indicate if changes were made. You may do so in any reasonable manner, but not in any way that suggests the licensor endorses you or your use." &amp; &para; &amp; "

    NoDerivatives &mdash; If you remix, transform, or build upon the material, you may not distribute the modified material." &amp; &para; &amp; "

No additional restrictions &mdash; You may not apply legal terms or technological measures that legally restrict others from doing anything the license permits." &amp; &para; &amp; "

Notices:" &amp; &para; &amp; "

    You do not have to comply with the license for elements of the material in the public domain or where your use is permitted by an applicable exception or limitation. " &amp; &para; &amp; "
    No warranties are given. The license may not give you all of the permissions necessary for your intended use. For example, other rights such as publicity, privacy, or moral rights may limit how you use the material. " ]</li>
<li>Set Field [ citationPicture1::kcsection; "" ]</li>
<li>#</li>
<li>Else If [ 8162011231825326 = tagTable::_Ltag or 8162011231825326 = tagMenus::_Ltag ]</li>
<li>Set Field [ tagMenus::tag; "CC BY-NC-SA 3.0 (Attribution-NonCommercial-ShareAlike 3.0 Unported)" ]</li>
<li>Set Field [ tagMenus::tagSpelling; "CC BY-NC-SA 3.0 (Attribution-NonCommercial-ShareAlike 3.0 Unported)" ]</li>
<li>Set Field [ tagMenus::notesOrHealth; "This is a human-readable summary of the Legal Code"  &amp; &para; &amp; "


Click the health tag-menu view button to reveal link to full code and translations of license if you are not currently seeing this link"  &amp; &para; &amp; "



You are free:"  &amp; &para; &amp; "



to Share &mdash; to copy, distribute and transmit the work"  &amp; &para; &amp; "



to Remix &mdash; to adapt the work"  &amp; &para; &amp; "

Under the following conditions:
"  &amp; &para; &amp; "
Attribution &mdash; You must attribute the work in the manner specified by the author or licensor (but not in any way that suggests that they endorse you or your use of the work)."  &amp; &para; &amp; "

Noncommercial &mdash; You may not use this work for commercial purposes."  &amp; &para; &amp; "

Share Alike &mdash; If you alter, transform, or build upon this work, you may distribute the resulting work only under the same or similar license to this one."  &amp; &para; &amp; "

With the understanding that:"  &amp; &para; &amp; "

Waiver &mdash; Any of the above conditions can be waived if you get permission from the copyright holder."  &amp; &para; &amp; "

Public Domain &mdash; Where the work or any of its elements is in the public domain under applicable law, that status is in no way affected by the license."  &amp; &para; &amp; "

Other Rights &mdash; In no way are any of the following rights affected by the license:"  &amp; &para; &amp; "

Your fair dealing or fair use rights, or other applicable copyright exceptions and limitations;"  &amp; &para; &amp; "

The author's moral rights;"  &amp; &para; &amp; "

Rights other persons may have either in the work itself or in how the work is used, such as publicity or privacy rights."  &amp; &para; &amp; "

Notice &mdash; For any reuse or distribution, you must make clear to others the license terms of this work.
" ]</li>
<li>Set Field [ citationPicture1::kcsection; "" ]</li>
<li>#</li>
<li>Else If [ 6282014225704906 = tagTable::_Ltag or 6282014225704906 = tagMenus::_Ltag ]</li>
<li>Set Field [ tagMenus::tag; "CC BY-NC-SA 4.0 (Attribution-NonCommercial-ShareAlike 4.0 International)" ]</li>
<li>Set Field [ tagMenus::tagSpelling; "CC BY-NC-SA 4.0 (Attribution-NonCommercial-ShareAlike 3.0 International)" ]</li>
<li>Set Field [ tagMenus::notesOrHealth; "This is a human-readable summary of (and not a substitute for) the license. " &amp; &para; &amp; "

Click the health tag-menu view button to reveal link to full code and translations of license if you are not currently seeing the link" &amp; &para; &amp; "

You are free:" &amp; &para; &amp; "

    Share &mdash; copy and redistribute the material in any medium or format" &amp; &para; &amp; "

Adapt &mdash; remix, transform, and build upon the material" &amp; &para; &amp; "

The licensor cannot revoke these freedoms as long as you follow the license terms." &amp; &para; &amp; "

Under the following terms:" &amp; &para; &amp; "

    Attribution &mdash; You must give appropriate credit, provide a link to the license, and indicate if changes were made. You may do so in any reasonable manner, but not in any way that suggests the licensor endorses you or your use." &amp; &para; &amp; "

    NonCommercial &mdash; You may not use the material for commercial purposes." &amp; &para; &amp; "

ShareAlike &mdash; If you remix, transform, or build upon the material, you must distribute your contributions under the same license as the original." &amp; &para; &amp; "

No additional restrictions &mdash; You may not apply legal terms or technological measures that legally restrict others from doing anything the license permits." &amp; &para; &amp; "

Notices:" &amp; &para; &amp; "

    You do not have to comply with the license for elements of the material in the public domain or where your use is permitted by an applicable exception or limitation. " &amp; &para; &amp; "
    No warranties are given. The license may not give you all of the permissions necessary for your intended use. For example, other rights such as publicity, privacy, or moral rights may limit how you use the material. " ]</li>
<li>Set Field [ citationPicture1::kcsection; "" ]</li>
<li>#</li>
<li>Else If [ 121620112002051049 = tagTable::_Ltag or 121620112002051049 = tagMenus::_Ltag ]</li>
<li>Set Field [ tagMenus::tag; "CC BY-NC-ND 3.0 (Attribution-NonCommercial-NoDerivs 3.0 Unported)" ]</li>
<li>Set Field [ tagMenus::tagSpelling; "CC BY-NC-ND 3.0 (Attribution-NonCommercial-NoDerivs 3.0 Unported)" ]</li>
<li>Set Field [ tagMenus::notesOrHealth; "This is a human-readable summary of the Legal Code "  &amp; &para; &amp; "

Click the health tag-menu view button to reveal link to full code and translations of license if you are not currently seeing the link"  &amp; &para; &amp; "

You are free:"  &amp; &para; &amp; "

to Share &mdash; to copy, distribute and transmit the work"  &amp; &para; &amp; "

Under the following conditions:"  &amp; &para; &amp; "

Attribution &mdash; You must attribute the work in the manner specified by the author or licensor (but not in any way that suggests that they endorse you or your use of the work)."  &amp; &para; &amp; "

Noncommercial &mdash; You may not use this work for commercial purposes."  &amp; &para; &amp; "

No Derivative Works &mdash; You may not alter, transform, or build upon this work."  &amp; &para; &amp; "

With the understanding that:"  &amp; &para; &amp; "

Waiver &mdash; Any of the above conditions can be waived if you get permission from the copyright holder."  &amp; &para; &amp; "

Public Domain &mdash; Where the work or any of its elements is in the public domain under applicable law, that status is in no way affected by the license."  &amp; &para; &amp; "

Other Rights &mdash; In no way are any of the following rights affected by the license:"  &amp; &para; &amp; "

Your fair dealing or fair use rights, or other applicable copyright exceptions and limitations;"  &amp; &para; &amp; "

The author's moral rights;"  &amp; &para; &amp; "

Rights other persons may have either in the work itself or in how the work is used, such as publicity or privacy rights."  &amp; &para; &amp; "

Notice &mdash; For any reuse or distribution, you must make clear to others the license terms of this work. 
" ]</li>
<li>Set Field [ citationPicture1::kcsection; "" ]</li>
<li>#</li>
<li>Else If [ 6282014230310907 = tagTable::_Ltag or 6282014230310907 = tagMenus::_Ltag ]</li>
<li>Set Field [ tagMenus::tag; "CC BY-NC-ND 4.0 (Attribution-NonCommercial-NoDerivs 4.0 International)" ]</li>
<li>Set Field [ tagMenus::tagSpelling; "CC BY-NC-ND 4.0 (Attribution-NonCommercial-NoDerivs 4.0 International)" ]</li>
<li>Set Field [ tagMenus::notesOrHealth; "This is a human-readable summary of (and not a substitute for) the license. " &amp; &para; &amp; "

Click the health tag-menu view button to reveal link to full code and translations of license if you are not currently seeing the link" &amp; &para; &amp; "

You are free:" &amp; &para; &amp; "

    Share &mdash; copy and redistribute the material in any medium or format." &amp; &para; &amp; "

The licensor cannot revoke these freedoms as long as you follow the license terms." &amp; &para; &amp; "

Under the following terms:" &amp; &para; &amp; "

    Attribution &mdash; You must give appropriate credit, provide a link to the license, and indicate if changes were made. You may do so in any reasonable manner, but not in any way that suggests the licensor endorses you or your use." &amp; &para; &amp; "

    NonCommercial &mdash; You may not use the material for commercial purposes." &amp; &para; &amp; "

NoDerivatives &mdash; If you remix, transform, or build upon the material, you may not distribute the modified material." &amp; &para; &amp; "

No additional restrictions &mdash; You may not apply legal terms or technological measures that legally restrict others from doing anything the license permits." &amp; &para; &amp; "

Notices:" &amp; &para; &amp; "

    You do not have to comply with the license for elements of the material in the public domain or where your use is permitted by an applicable exception or limitation. " &amp; &para; &amp; "
    No warranties are given. The license may not give you all of the permissions necessary for your intended use. For example, other rights such as publicity, privacy, or moral rights may limit how you use the material. " ]</li>
<li>Set Field [ citationPicture1::kcsection; "" ]</li>
<li>#</li>
<li>Else If [ 31620121911511235 = tagTable::_Ltag or 31620121911511235 = tagMenus::_Ltag ]</li>
<li>Set Field [ tagMenus::tag; "No rights reserved by the creator of the work." ]</li>
<li>Set Field [ tagMenus::tagSpelling; "No rights reserved by the creator of the work." ]</li>
<li>Set Field [ tagMenus::notesOrHealth; "I give up all rights to and ask for no credit for my work." ]</li>
<li>Set Field [ citationPicture1::kcsection; "" ]</li>
<li>End If</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>End If</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>tagMenus</em>::tagSpelling</li>
<li>
<em>tagMenus</em>::notesOrHealth</li>
<li>
<em>citationPicture1</em>::kcsection</li>
<li>
<em>tagTable</em>::_Ltag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33099ScriptAnchor_"></a><td class="script_navbar"><a href="#33243ScriptAnchor_"><span>Previous Script: [CHUNKHealthLockedFields]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33259ScriptAnchor_"><span>Next Script: [findModeCancel]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">findMode</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32987ScriptAnchor_">addTagToMainRecord</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>If [ $$findMode= "" ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#If find mode is active then return to browse mode.</li>
<li>If [ Get ( WindowMode ) = 1 ]</li>
<li>#</li>
<li>#If user presses enter find button then perform the </li>
<li>#steps below to complete the find.</li>
<li>Perform Find [  ]</li>
<li>Go to Layout [ $$findLayout ]</li>
<li>Set Variable [ $$findLayout ]</li>
<li>#</li>
<li>#Sort reference or tag records depending on which</li>
<li>#records user is viewing.</li>
<li>If [ Get (LayoutTableName) = "reference" ]</li>
<li>Sort Records [ Specified Sort Order: tagKeywordPrimary::orderOrLock; ascending
tagKeywordPrimary::tag; ascending
reference::referenceShort; ascending ]
[ Restore; No dialog ]</li>
<li>Halt Script</li>
<li>Else</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#If user presses enter find button then perform the </li>
<li>#steps below to complete the find.</li>
<li>End If</li>
<li>#</li>
<li>#Ask user if they want to find a tag or find learn items</li>
<li>#tagged with specific tags (except if they are in test).</li>
<li>If [ Get (LayoutTableName)  &ne;  "test" ]</li>
<li>#</li>
<li>#Show different message for learn and reference sections.</li>
<li>If [ Left (Get (LayoutName) ; 9 ) &ne;  "reference" ]</li>
<li>Show Custom Dialog [ Message: "Find tagged learn records OR find tag(s)?  "; Buttons: &ldquo;tag(s)&rdquo;, &ldquo;learn&rdquo;, &ldquo;cancel&rdquo; ]</li>
<li>#</li>
<li>Else If [ Left (Get (LayoutName) ; 9 )  =   "reference" and $$referenceRecordOne &ne; 2 ]</li>
<li>#</li>
<li>#Eliminate find reference option for citation menu.</li>
<li>If [ $$citationMatch &ne; "cite" ]</li>
<li>Show Custom Dialog [ Message: "Find tagged reference records OR find tag(s)?  "; Buttons: &ldquo;tag(s)&rdquo;, &ldquo;reference&rdquo;, &ldquo;cancel&rdquo; ]</li>
<li>Else</li>
<li>Show Custom Dialog [ Message: "Find tag(s)?  "; Buttons: &ldquo;cancel&rdquo;, &ldquo;tag(s)&rdquo; ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#If user selects to find tags enter find mode first.</li>
<li>If [ Get ( LastMessageChoice ) = 1 and $$ClearMessageChoice &ne; 2 ]</li>
<li>Enter Find Mode [  ]</li>
<li>#</li>
<li>#Determine if user is looking tag or reference records.</li>
<li>If [ Get (LayoutTableName) = "reference" ]</li>
<li>#</li>
<li>#Get the layout name for the return trip after find is done.</li>
<li>Set Variable [ $$findLayout; Value:Get (LayoutName) ]</li>
<li>#</li>
<li>#Show different layouts for learn and reference tag </li>
<li>#menu items.</li>
<li>If [ Left (Get (LayoutName) ; 9 ) &ne;  "reference" ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;learnMenuFINDstuffref&rdquo; (reference) ]</li>
<li>Else</li>
<li>Go to Layout [ &ldquo;learnMenuFINDref&rdquo; (reference) ]</li>
<li>End If</li>
<li>Else</li>
<li>Go to Layout [ &ldquo;referenceMenuFINDref&rdquo; (reference) ]</li>
<li>End If</li>
<li>#</li>
<li>#Limit search to only items user selected to show in</li>
<li>#learn mode if in learn mode.</li>
<li>If [ Left (Get (LayoutName) ; 9 ) &ne;  "reference" ]</li>
<li>Set Field [ reference::kcsection; TEMP::ksection ]</li>
<li>Set Field [ reference::show; "show in learn" ]</li>
<li>#</li>
<li>Else</li>
<li>#Show all reference items for a section if in </li>
<li>#reference mode.</li>
<li>Set Field [ reference::kcsection; TEMP::ksection ]</li>
<li>End If</li>
<li>#</li>
<li>#Select the field where the user needs to enter the </li>
<li>#find information.</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Field [ reference::Title ]</li>
<li>Else</li>
<li>Go to Field [ reference::referenceForReferenceWindow ]</li>
<li>End If</li>
<li>#</li>
<li>#Pause and wait until user is ready to perform find.</li>
<li>Pause/Resume Script [ Indefinitely ]</li>
<li>#</li>
<li>#If user presses enter key then perform the steps below</li>
<li>#to complete the find.</li>
<li>Perform Find [  ]</li>
<li>Go to Layout [ $$findLayout ]</li>
<li>Set Variable [ $$findLayout ]</li>
<li>Sort Records [ Specified Sort Order: tagKeywordPrimary::orderOrLock; ascending
tagKeywordPrimary::tag; ascending
reference::referenceShort; ascending ]
[ Restore; No dialog ]</li>
<li>Halt Script</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>Else</li>
<li>#Limit search to only items user selected to show in</li>
<li>#learn mode if in learn mode.</li>
<li>Set Field [ tagMenus::match; $$citationMatch ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; "==" &amp; TEMP::ksection ]</li>
<li>Set Variable [ $$findLayout; Value:Get (LayoutName) ]</li>
<li>If [ Left (Get (LayoutName) ; 9 ) &ne;  "reference" ]</li>
<li>If [ Left (Get (LayoutName) ; 5 ) = "learn" ]</li>
<li>Go to Layout [ &ldquo;learnMenuFINDrefLearn&rdquo; (testlearn) ]</li>
<li>#Clear these variables so find will work.</li>
<li>Set Field [ tagMenus::match; "" ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; "" ]</li>
<li>Else</li>
<li>Go to Layout [ &ldquo;ltagFINDNK&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>#</li>
<li>Else</li>
<li>#Show all reference items for a section if in </li>
<li>#reference mode.</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;referenceSFINDNK&rdquo; (tagMenus) ]</li>
<li>Else</li>
<li>Go to Layout [ &ldquo;referenceFINDNK&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Select the field where the user needs to enter the </li>
<li>#find information.</li>
<li>If [ Left (Get (LayoutName) ; 5 ) = "learn" ]</li>
<li>Go to Field [ testlearn::Caption ]</li>
<li>Else</li>
<li>Go to Field [ tagMenus::tag ]</li>
<li>End If</li>
<li>#</li>
<li>#Pause and wait until user is ready to perform find.</li>
<li>Pause/Resume Script [ Indefinitely ]</li>
<li>#</li>
<li>#If user presses enter key then perform the steps below</li>
<li>#to complete the find.</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Set Field [ testlearn::sampleCasePoint; "1" ]</li>
<li>End If</li>
<li>Perform Find [  ]</li>
<li>Go to Layout [ $$findLayout ]</li>
<li>Set Variable [ $$findLayout ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>Else If [ Get ( LastMessageChoice ) = 3 ]</li>
<li>#If user cancels then exit exit.</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#So if user wants to find learn records, then go into
</li>
<li>#menu for finding learn records by green button tags.</li>
<li>#</li>
<li>#Find must be done for tags, so if user is showing no</li>
<li>#tags when find is activitated then take user to keywords</li>
<li>#tag menu.</li>
<li>If [ Get (LayoutName) = "ReferenceMenuNoTags" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenu2keywordOrNode1&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>#</li>
<li>Set Variable [ $$findMode; Value:1 ]</li>
<li>Set Variable [ $$findLayout; Value:Get (LayoutName) ]</li>
<li>If [ Right ( Get (LayoutName) ; 7 ) = "refcite" and Left ( Get (LayoutName) ; 1 ) = "l" ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;learnMenu4RefStuffCiteFindTL&rdquo; (testlearn) ]</li>
<li>Else</li>
<li>Go to Layout [ &ldquo;learnMenu4RefCiteFindTL&rdquo; (testlearn) ]</li>
<li>End If</li>
<li>Else If [ Right ( Get (LayoutName) ; 6 ) = "health" and Left ( Get (LayoutName) ; 1 ) = "l" ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;learnSFind&rdquo; (tagMenus) ]</li>
<li>Else</li>
<li>Go to Layout [ &ldquo;learnFind&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>Else If [ Right ( Get (LayoutName) ; 6 ) = "sample" and Left ( Get (LayoutName) ; 1 ) = "l" ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;learnFindStuffSample&rdquo; (tagMenus) ]</li>
<li>Else</li>
<li>End If</li>
<li>Else If [ Left ( Get (LayoutName) ; 6 ) = "ltagNK" and Left ( Get (LayoutName) ; 1 ) = "l" ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;learnKeywordOrNodeSFind&rdquo; (tagMenus) ]</li>
<li>Else</li>
<li>Go to Layout [ &ldquo;learnKeywordOrNodeFind&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>Else If [ Right ( Get (LayoutName) ; 1 ) = "3" and Left ( Get (LayoutName) ; 1 ) = "l" ]</li>
<li>Go to Layout [ &ldquo;learnKeywordOrNodeFind&rdquo; (tagMenus) ]</li>
<li>Else If [ Right ( Get (LayoutName) ; 4 ) = "test" and Left ( Get (LayoutName) ; 1 ) = "l" ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;learnFindSTest&rdquo; (test) ]</li>
<li>Else</li>
<li>Go to Layout [ &ldquo;learnFindTest&rdquo; (test) ]</li>
<li>End If</li>
<li>Else If [ Right ( Get (LayoutName) ; 5 ) = "3cite" and Left ( Get (LayoutName) ; 1 ) = "l" ]</li>
<li>Go to Layout [ &ldquo;learnFindCite&rdquo; (reference) ]</li>
<li>Else If [ Right ( Get (LayoutName) ; 8 ) = "RefStuff" and Left ( Get (LayoutName) ; 1 ) = "l" ]</li>
<li>Go to Layout [ &ldquo;learnFindStuffCite&rdquo; (reference) ]</li>
<li>#</li>
<li>#</li>
<li>Else If [ Right ( Get (LayoutName) ; 5 ) = "menu1" and Left ( Get (LayoutName) ; 1 ) = "r" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenuFind&rdquo; (tagMenus) ]</li>
<li>Else If [ Right ( Get (LayoutName) ; 5 ) = "node1" and Left ( Get (LayoutName) ; 1 ) = "r" ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenu2SkeywordOrNodeFind&rdquo; (tagMenus) ]</li>
<li>Else</li>
<li>Go to Layout [ &ldquo;ReferenceMenu2keywordOrNodeFind&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>Else If [ Right ( Get (LayoutName) ; 5 ) = "node2" and Left ( Get (LayoutName) ; 1 ) = "r" ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenu2SkeywordOrNodeFind&rdquo; (tagMenus) ]</li>
<li>Else</li>
<li>Go to Layout [ &ldquo;ReferenceMenu2keywordOrNodeFind&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>Else If [ Right ( Get (LayoutName) ; 1 ) = "3" and Left ( Get (LayoutName) ; 1 ) = "r" ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenu2SkeywordOrNodeFind&rdquo; (tagMenus) ]</li>
<li>Else</li>
<li>Go to Layout [ &ldquo;ReferenceMenu2keywordOrNodeFind&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Clear the first record question variable so user will </li>
<li>#not be asked if  they wish to find or tag reference records.</li>
<li>Set Variable [ $$referenceRecordOne ]</li>
<li>Set Variable [ $$ClearMessageChoice ]</li>
<li>#</li>
<li>#As going to the other window will be involved</li>
<li>#stop the record load script on that window until</li>
<li>#this script is finished to speed things up and</li>
<li>#stop flashing effect.</li>
<li>//  Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LayoutName) = "ReferenceEDIT" ]</li>
<li>Go to Layout [ &ldquo;Reference&rdquo; (reference) ]</li>
<li>End If</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>If [ Get (LayoutName) = "Learn4Edit" ]</li>
<li>Go to Layout [ &ldquo;learn4&rdquo; (testlearn) ]</li>
<li>End If</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ $$findMode= 1 ]</li>
<li>Set Variable [ $$findMode ]</li>
<li>Set Variable [ $$firstFind ]</li>
<li>Set Variable [ $$firstFindOther ]</li>
<li>Set Variable [ $$found ]</li>
<li>Set Variable [ $$foundOther ]</li>
<li>Go to Layout [ $$findLayout ]</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagKeywordPrimary</em>::orderOrLock</li>
<li>
<em>tagKeywordPrimary</em>::tag</li>
<li>
<em>reference</em>::referenceShort</li>
<li>
<em>ruleTagMenuGroups</em>::order</li>
<li>
<em>ruleTagMenuGroups</em>::name</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>TEMP</em>::InventoryLibaryYN</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>reference</em>::kcsection</li>
<li>
<em>reference</em>::show</li>
<li>
<em>reference</em>::Title</li>
<li>
<em>reference</em>::referenceForReferenceWindow</li>
<li>
<em>tagMenus</em>::match</li>
<li>
<em>ruleTagMenuGroups</em>::ksection</li>
<li>
<em>testlearn</em>::Caption</li>
<li>
<em>testlearn</em>::sampleCasePoint</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>&lt;Missing Layout&gt;</li>
<li>learnMenuFINDstuffref</li>
<li>learnMenuFINDref</li>
<li>referenceMenuFINDref</li>
<li>learnMenuFINDrefLearn</li>
<li>ltagFINDNK</li>
<li>referenceSFINDNK</li>
<li>referenceFINDNK</li>
<li>ReferenceMenu2keywordOrNode1</li>
<li>learnMenu4RefStuffCiteFindTL</li>
<li>learnMenu4RefCiteFindTL</li>
<li>learnSFind</li>
<li>learnFind</li>
<li>learnFindStuffSample</li>
<li>learnKeywordOrNodeSFind</li>
<li>learnKeywordOrNodeFind</li>
<li>learnFindSTest</li>
<li>learnFindTest</li>
<li>learnFindCite</li>
<li>learnFindStuffCite</li>
<li>ReferenceMenuFind</li>
<li>ReferenceMenu2SkeywordOrNodeFind</li>
<li>ReferenceMenu2keywordOrNodeFind</li>
<li>Reference</li>
<li>learn4</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33259ScriptAnchor_"></a><td class="script_navbar"><a href="#33099ScriptAnchor_"><span>Previous Script: [findMode]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33100ScriptAnchor_"><span>Next Script: [findPrimaryTL]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">findModeCancel</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Script activitated if user cancels find and returns user</li>
<li>#to layout they were viewing.</li>
<li>Go to Layout [ $$findLayout ]</li>
<li>Set Variable [ $$findLayout ]</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>&lt;Missing Layout&gt;</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33100ScriptAnchor_"></a><td class="script_navbar"><a href="#33259ScriptAnchor_"><span>Previous Script: [findModeCancel]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33101ScriptAnchor_"><span>Next Script: [findKeyOtherTL]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">findPrimaryTL</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Select tag to be found.</li>
<li>If [ Right ( Get (LayoutName) ; 4 ) = "cite" ]</li>
<li>Set Variable [ $tag; Value:reference::_Lreference ]</li>
<li>Else If [ Right ( Get (LayoutName) ; 4 ) = "find" or Get (LayoutTableName) = "tagMenus" ]</li>
<li>Set Variable [ $tag; Value:tagMenus::_Ltag ]</li>
<li>Else If [ Right ( Get (LayoutName) ; 4 ) = "test" ]</li>
<li>Set Variable [ $tag; Value:test::_Ltest ]</li>
<li>Else If [ Right ( Get (LayoutName) ; 2 ) = "tl" ]</li>
<li>Set Variable [ $tag; Value:testlearn::_Ltestlearn ]</li>
<li>End If</li>
<li>#</li>
<li>#Select the kind of tag to be found.  We grab</li>
<li>#only the first three letters because the shortest</li>
<li>#menu item 'key' has only three letters, and because</li>
<li>#we need the same number of characters/letters</li>
<li>#to make up this variable so when it is added to</li>
<li>#the first part of an item in the found list below</li>
<li>#it can be removed by the system which only</li>
<li>#can be told how many characters to remove.</li>
<li>#This variable is thus a meta tag added to an</li>
<li>#ID number to tell the system from which menu</li>
<li>#did this item come.  This meta tag or tag allows</li>
<li>#us to make a list of ID numbers from various</li>
<li>#tag menus: key, node, medium, etc.  </li>
<li>Set Variable [ $menu; Value:Left ( $$citationMatch ; 1 ) ]</li>
<li>#</li>
<li>#Get the name of the tag for error message</li>
<li>#at bottom of this script if needed.</li>
<li>If [ Right ( Get (LayoutName) ; 4 ) = "cite" ]</li>
<li>Set Variable [ $name; Value:reference::referenceShort ]</li>
<li>Else If [ Right ( Get (LayoutName) ; 4 ) = "find" or Get (LayoutTableName) = "tagMenus" ]</li>
<li>Set Variable [ $name; Value:tagMenus::tag ]</li>
<li>Else If [ Right ( Get (LayoutName) ; 4 ) = "test" ]</li>
<li>Set Variable [ $name; Value:test::testName ]</li>
<li>Else If [ Right ( Get (LayoutName) ; 2 ) = "tl" ]</li>
<li>Set Variable [ $name; Value:testlearn::Caption ]</li>
<li>End If</li>
<li>#</li>
<li>#As going to the other window will be involved</li>
<li>#stop the record load script on that window until</li>
<li>#this script is finished to speed things up and</li>
<li>#stop flashing effect.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>#</li>
<li>#Go to the other window and start the find process.</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection ]</li>
<li>//  Set Field [ testlearn::filterFind; "main" &amp; &para; ]</li>
<li>#</li>
<li>#</li>
<li>If [ $menu = "k" ]</li>
<li>Set Field [ testlearn::kKeywordPrimary; $tag ]</li>
<li>Else If [ $menu = "n" ]</li>
<li>Set Field [ testlearn::kNodePrimary; $tag ]</li>
<li>Else If [ $menu = "m" ]</li>
<li>Set Field [ testlearn::kmedium; $tag ]</li>
<li>Else If [ $menu = "h" ]</li>
<li>Set Field [ testlearn::kHealth; $tag ]</li>
<li>Else If [ $menu = "r" ]</li>
<li>Set Field [ testlearn::kcreference; $tag ]</li>
<li>Else If [ $menu = "c" ]</li>
<li>Set Field [ testlearn::kcitation; $tag ]</li>
<li>Else If [ $menu = "p" ]</li>
<li>Set Field [ testlearn::kfolderPath; $tag ]</li>
<li>Else If [ $menu = "t" ]</li>
<li>Set Field [ testlearn::kctest; "*" &amp; $tag &amp; &para; ]</li>
<li>Else If [ $menu = "s" ]</li>
<li>Set Field [ testlearn::kcsample; "*" &amp; $tag &amp; &para; ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#If this is the first find, note this and perform</li>
<li>#the find.</li>
<li>If [ $$firstFind = "" ]</li>
<li>Set Variable [ $$firstFind; Value:1 ]</li>
<li>Set Variable [ $$found; Value:$menu &amp; $tag &amp; &para; ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#If nothing was found capture the error message</li>
<li>#as steps before showing the error message will</li>
<li>#delete it from the system and we need it to</li>
<li>#activate the error message below if there was </li>
<li>#an error.</li>
<li>Set Variable [ $error; Value:Get (LastError) ]</li>
<li>#</li>
<li>#If this is not the first find and the item that</li>
<li>#the user clicked on to start this script has</li>
<li>#not already been found, then add items tagged</li>
<li>#with it to the current set of found records.</li>
<li>Else If [ $$firstFind = 1 ]</li>
<li>If [ $menu &amp; $tag  &amp; &para; &ne; FilterValues ( $$found ; $menu &amp; $tag) ]</li>
<li>Extend Found Set [  ]</li>
<li>#</li>
<li>#If nothing was found capture the error message</li>
<li>#as steps before showing the error message will</li>
<li>#delete it from the system and we need it to</li>
<li>#activate the error message below if there was </li>
<li>#an error.</li>
<li>Set Variable [ $error; Value:Get (LastError) ]</li>
<li>#</li>
<li>#Add the tag from the list of found tagged records.</li>
<li>Set Variable [ $found; Value:$$found ]</li>
<li>Set Variable [ $$found; Value:$menu &amp; $tag &amp; &para; &amp; $found ]</li>
<li>#</li>
<li>#If this is not the first find and the item that</li>
<li>#the user clicked on to start this script has</li>
<li>#already been found, then remove tag from the</li>
<li>#the list of found tagged records.  </li>
<li>Else If [ $menu &amp; $tag  &amp; &para;= FilterValues ( $$found ; $menu &amp; $tag  &amp; &para;) ]</li>
<li>Set Variable [ $found; Value:$$found ]</li>
<li>Set Variable [ $$found; Value:Substitute ( $found ; $menu &amp; $tag &amp; &para; ; "" ) ]</li>
<li>#</li>
<li>#Enter browse mode to clear the find selections</li>
<li>#set at the beginning of this script. </li>
<li>Enter Browse Mode</li>
<li>#</li>
<li>#If after removing this item from the list of found</li>
<li>#tagged records the list is empty, perform a find</li>
<li>#that will result in zero records being found</li>
<li>#to reflect the fact that the user currently has</li>
<li>#an empty found list.</li>
<li>If [ $$found = "" ]</li>
<li>Set Variable [ $$firstFind ]</li>
<li>Enter Find Mode [  ]</li>
<li>#</li>
<li>#</li>
<li>#Since ID numbers are numbers, the text </li>
<li>#'findnoRecords' entered in the ID field will result</li>
<li>#in zero records being found.</li>
<li>Set Field [ testlearn::kKeywordPrimary; "findNoRecords" ]</li>
<li>#</li>
<li>#</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#If after removing this item from the $$found list,</li>
<li>#the list is not empty, refind all records still on</li>
<li>#the list one tag at a time.</li>
<li>Else If [ $$found &ne; "" ]</li>
<li>#</li>
<li>#Create a copy of the found list.  Items will be</li>
<li>#removed from this one at a time as they are found.</li>
<li>Set Variable [ $findList; Value:$$found ]</li>
<li>#</li>
<li>#Get the menu item name so system will know</li>
<li>#what field to put the ID number into to find</li>
<li>#records tagged with this item.</li>
<li>Set Variable [ $menu; Value:Left ( ( GetValue ( $findList ; 1 ) ) ; 1 ) ]</li>
<li>#</li>
<li>#Get the ID number of the tag to be found.</li>
<li>#(the number 42 is a joke, essentially the number</li>
<li>#needs to be big enough to capture the full ID number</li>
<li>#which is much shorter, but overkill doesn't hurt)</li>
<li>#FYI: joke is from Hitchhiker's Guide to the Galaxy</li>
<li>Set Variable [ $find; Value:Middle ( ( GetValue ( $findList ; 1 ) ) ; 2 ; 42 ) ]</li>
<li>#</li>
<li>#Remove it from the list of tags to be found.</li>
<li>Set Variable [ $subtract; Value:$findList ]</li>
<li>Set Variable [ $findList; Value:Substitute ( $subtract ; $menu &amp; $find &amp; &para; ; "" ) ]</li>
<li>#</li>
<li>#Find main window records tagged with it.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection ]</li>
<li>Set Field [ testlearn::filterFind; "main" &amp; &para; ]</li>
<li>#</li>
<li>#</li>
<li>If [ $menu = "k" ]</li>
<li>Set Field [ testlearn::kKeywordPrimary; $find ]</li>
<li>Else If [ $menu = "n" ]</li>
<li>Set Field [ testlearn::kNodePrimary; $find ]</li>
<li>Else If [ $menu = "m" ]</li>
<li>Set Field [ testlearn::kmedium; $find ]</li>
<li>Else If [ $menu = "h" ]</li>
<li>Set Field [ testlearn::kHealth; $find ]</li>
<li>Else If [ $menu = "r" ]</li>
<li>Set Field [ testlearn::kcreference; $find ]</li>
<li>Else If [ $menu = "c" ]</li>
<li>Set Field [ testlearn::kcitation; $find ]</li>
<li>Else If [ $menu = "p" ]</li>
<li>Set Field [ testlearn::kfolderPath; $find ]</li>
<li>Else If [ $menu = "t" ]</li>
<li>Set Field [ testlearn::ktest; $find ]</li>
<li>Else If [ $menu = "s" ]</li>
<li>Set Field [ testlearn::kcsample; $find ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#If there is more than one item on the $$found</li>
<li>#list, then find the rest of records tagged with</li>
<li>#this items/tags.</li>
<li>Perform Find [  ]</li>
<li>Loop</li>
<li>#</li>
<li>#When the list is empty stop finding stuff.</li>
<li>Exit Loop If [ ValueCount ( $findList ) = 0 ]</li>
<li>#</li>
<li>#Get the menu item name so system will know</li>
<li>#what field to put the ID number into to find</li>
<li>#records tagged with this item.</li>
<li>Set Variable [ $menu; Value:Left ( ( GetValue ( $findList ; 1 ) ) ; 1 ) ]</li>
<li>#</li>
<li>#Get the ID number of the tag to be found.</li>
<li>Set Variable [ $find; Value:Middle ( ( GetValue ( $findList ; 1 ) ) ; 2 ; 42 ) ]</li>
<li>#</li>
<li>#Remove it from the list of tags to be found.</li>
<li>Set Variable [ $subtract; Value:$findList ]</li>
<li>Set Variable [ $findList; Value:Substitute ( $subtract ; $menu &amp; $find &amp; &para; ; "" ) ]</li>
<li>#</li>
<li>#Find main window records tagged with it.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection ]</li>
<li>Set Field [ testlearn::filterFind; "main" &amp; &para; ]</li>
<li>#</li>
<li>#</li>
<li>If [ $menu = "k" ]</li>
<li>Set Field [ testlearn::kKeywordPrimary; $find ]</li>
<li>Else If [ $menu = "n" ]</li>
<li>Set Field [ testlearn::kNodePrimary; $find ]</li>
<li>Else If [ $menu = "m" ]</li>
<li>Set Field [ testlearn::kmedium; $find ]</li>
<li>Else If [ $menu = "h" ]</li>
<li>Set Field [ testlearn::kHealth; $find ]</li>
<li>Else If [ $menu = "r" ]</li>
<li>Set Field [ testlearn::kcreference; $find ]</li>
<li>Else If [ $menu = "c" ]</li>
<li>Set Field [ testlearn::kcitation; $find ]</li>
<li>Else If [ $menu = "p" ]</li>
<li>Set Field [ testlearn::kfolderPath; $find ]</li>
<li>Else If [ $menu = "t" ]</li>
<li>Set Field [ testlearn::ktest; $find ]</li>
<li>Else If [ $menu = "s" ]</li>
<li>Set Field [ testlearn::kcsample; $find ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>Extend Found Set [  ]</li>
<li>End Loop</li>
<li>End If</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Refind any Other Keyword items.</li>
<li>If [ $$foundOther &ne; "" ]</li>
<li>#</li>
<li>#Create a copy of the found list.  Items will be</li>
<li>#removed from this one at a time as they are found.</li>
<li>Set Variable [ $findList; Value:$$foundOther ]</li>
<li>#</li>
<li>#Get the menu item name so system will know</li>
<li>#what field to put the ID number into to find</li>
<li>#records tagged with this item.</li>
<li>Set Variable [ $menu; Value:Left ( ( GetValue ( $findList ; 1 ) ) ; 1 ) ]</li>
<li>#</li>
<li>#Get the ID number of the tag to be found.</li>
<li>Set Variable [ $find; Value:Middle ( ( GetValue ( $findList ; 1 ) ) ; 2 ; 42 ) ]</li>
<li>#</li>
<li>#Remove it from the list of tags to be found.</li>
<li>Set Variable [ $subtract; Value:$findList ]</li>
<li>Set Variable [ $findList; Value:Substitute ( $subtract ; $menu &amp; $find &amp; &para; ; "" ) ]</li>
<li>#</li>
<li>#Find main window records tagged with it.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection ]</li>
<li>Set Field [ testlearn::filterFind; "main" &amp; &para; ]</li>
<li>#</li>
<li>#</li>
<li>If [ $menu = "k" ]</li>
<li>Set Field [ testlearn::kcKeywordOther; $find ]</li>
<li>Else If [ $menu = "n" ]</li>
<li>Set Field [ testlearn::kNodeOther; $find ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>Extend Found Set [  ]</li>
<li>#</li>
<li>#If there is more than one item on the $$foundOther</li>
<li>#list, then find the rest of records tagged with</li>
<li>#this items/tags.</li>
<li>Loop</li>
<li>#</li>
<li>#When the list is empty stop finding stuff.</li>
<li>Exit Loop If [ ValueCount ( $findList ) = 0 ]</li>
<li>#</li>
<li>#Get the menu item name so system will know</li>
<li>#what field to put the ID number into to find</li>
<li>#records tagged with this item.</li>
<li>Set Variable [ $menu; Value:Left ( ( GetValue ( $findList ; 1 ) ) ; 1 ) ]</li>
<li>#</li>
<li>#Get the ID number of the tag to be found.</li>
<li>Set Variable [ $find; Value:Middle ( ( GetValue ( $findList ; 1 ) ) ; 2 ; 42 ) ]</li>
<li>#</li>
<li>#Remove it from the list of tags to be found.</li>
<li>Set Variable [ $subtract; Value:$findList ]</li>
<li>Set Variable [ $findList; Value:Substitute ( $subtract ; $menu &amp; $find &amp; &para; ; "" ) ]</li>
<li>#</li>
<li>#Find main window records tagged with it.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection ]</li>
<li>Set Field [ testlearn::filterFind; "main" &amp; &para; ]</li>
<li>#</li>
<li>#</li>
<li>If [ $menu = "k" ]</li>
<li>Set Field [ testlearn::kcKeywordOther; $find ]</li>
<li>Else If [ $menu = "n" ]</li>
<li>Set Field [ testlearn::kNodeOther; $find ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>Extend Found Set [  ]</li>
<li>End Loop</li>
<li>End If</li>
<li>#</li>
<li>#Sort according to current sort in Main window.</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>#</li>
<li>#Go to first record and preform record load script.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Perform Script [ &ldquo;loadCitation&rdquo; ]</li>
<li>#</li>
<li>#Return focus to Tag Menus window.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>#</li>
<li>#If no records where found tell user why and</li>
<li>#remove tag ID from list of tags attached to records</li>
<li>#in the main window.</li>
<li>If [ $error = 401 ]</li>
<li>If [ $$firstFind = "" ]</li>
<li>Set Variable [ $$found ]</li>
<li>Else If [ $$firstFind &ne; "" ]</li>
<li>Set Variable [ $$found; Value:Substitute ( $found ; $menu &amp; $tag &amp; &para; ; "" ) ]</li>
<li>End If</li>
<li>Refresh Window</li>
<li>#</li>
<li>#</li>
<li>If [ $$citationMatch = "key" ]</li>
<li>Show Custom Dialog [ Message: "'" &amp; $name &amp; "'" &amp; " is not in use as a primary keyword."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Else If [ $$citationMatch = "node" ]</li>
<li>Show Custom Dialog [ Message: "'" &amp; $name &amp; "'" &amp; " is not in use as a primary node."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Else If [ $$citationMatch = "medium" ]</li>
<li>Show Custom Dialog [ Message: "'" &amp; $name &amp; "'" &amp; " is not in use."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Else If [ $$citationMatch = "health" ]</li>
<li>Show Custom Dialog [ Message: "'" &amp; $name &amp; "'" &amp; " is not in use."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Else If [ $$citationMatch = "ref" ]</li>
<li>Show Custom Dialog [ Message: "'" &amp; Left ( $name ; 65 )  &amp; "..." &amp; "'" &amp; " is not in use."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Else If [ $$citationMatch = "cite" ]</li>
<li>Show Custom Dialog [ Message: "'" &amp; Left ( $name ; 65 )  &amp; "..." &amp; "'" &amp; " is not in use."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Else If [ $$citationMatch = "path" ]</li>
<li>Show Custom Dialog [ Message: "'" &amp; $name &amp; "'" &amp; " is not in use."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Else If [ $$citationMatch = "test" ]</li>
<li>Show Custom Dialog [ Message: "'" &amp; $name &amp; "'" &amp; " is not in use."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Else If [ $$citationMatch = "sample" ]</li>
<li>Show Custom Dialog [ Message: "'" &amp; $name &amp; "'" &amp; " is not in use."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::_Lreference</li>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>test</em>::_Ltest</li>
<li>
<em>testlearn</em>::_Ltestlearn</li>
<li>
<em>reference</em>::referenceShort</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>test</em>::testName</li>
<li>
<em>testlearn</em>::Caption</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>testlearn</em>::kcsection</li>
<li>
<em>testlearn</em>::filterFind</li>
<li>
<em>testlearn</em>::kKeywordPrimary</li>
<li>
<em>testlearn</em>::kNodePrimary</li>
<li>
<em>testlearn</em>::kmedium</li>
<li>
<em>testlearn</em>::kHealth</li>
<li>
<em>testlearn</em>::kcreference</li>
<li>
<em>testlearn</em>::kcitation</li>
<li>
<em>testlearn</em>::kfolderPath</li>
<li>
<em>testlearn</em>::kctest</li>
<li>
<em>testlearn</em>::kcsample</li>
<li>
<em>testlearn</em>::ktest</li>
<li>
<em>testlearn</em>::kcKeywordOther</li>
<li>
<em>testlearn</em>::kNodeOther</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32984ScriptAnchor_">loadCitation</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33101ScriptAnchor_"></a><td class="script_navbar"><a href="#33100ScriptAnchor_"><span>Previous Script: [findPrimaryTL]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33119ScriptAnchor_"><span>Next Script: [findPrimaryRef]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">findKeyOtherTL</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#Select tag to be found.</li>
<li>Set Variable [ $tag; Value:tagMenus::_Ltag ]</li>
<li>#</li>
<li>#</li>
<li>#Select the kind of tag to be found.  We grab</li>
<li>#only the first three letters because the shortest</li>
<li>#menu item 'key' has only three letters, and because</li>
<li>#we need the same number of characters/letters</li>
<li>#to make up this variable so when it is added to</li>
<li>#the first part of an item in the found list below</li>
<li>#it can be removed by the system which only</li>
<li>#can be told how many characters to remove.</li>
<li>#This variable is thus a meta tag added to an</li>
<li>#ID number to tell the system from which menu</li>
<li>#did this item come.  This meta tag or tag allows</li>
<li>#us to make a list of ID numbers from various</li>
<li>#tag menus: key, node, medium, etc.  </li>
<li>Set Variable [ $menu; Value:Left ( $$citationMatch ; 1 ) ]</li>
<li>#</li>
<li>#Get the name of the tag for error message</li>
<li>#at bottom of this script if needed.</li>
<li>Set Variable [ $name; Value:tagMenus::tag ]</li>
<li>#</li>
<li>#As going to the other window will be involved</li>
<li>#stop the record load script on that window until</li>
<li>#this script is finished to speed things up and</li>
<li>#stop flashing effect.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>#</li>
<li>#Go to the other window and start the find process.</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection ]</li>
<li>//  Set Field [ testlearn::filterFind; "main" &amp; &para; ]</li>
<li>#</li>
<li>#</li>
<li>If [ $$citationMatch = "key" ]</li>
<li>Set Field [ testlearn::kcKeywordOther; $tag ]</li>
<li>Else If [ $$citationMatch = "node" ]</li>
<li>Set Field [ testlearn::kNodeOther; $tag ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#If this is the first find, note this and perform</li>
<li>#the find.</li>
<li>If [ $$firstFindOther = "" ]</li>
<li>Set Variable [ $$firstFindOther; Value:1 ]</li>
<li>Set Variable [ $$foundOther; Value:$menu &amp; $tag &amp; &para; ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#If nothing was found capture the error message</li>
<li>#as steps before showing the error message will</li>
<li>#delete it from the system and we need it to</li>
<li>#activate the error message below if there was </li>
<li>#an error.</li>
<li>Set Variable [ $error; Value:Get (LastError) ]</li>
<li>#</li>
<li>#If this is not the first find and the item that</li>
<li>#the user clicked on to start this script has</li>
<li>#not already been found, then add items tagged</li>
<li>#with it to the current set of found records.</li>
<li>Else If [ $$firstFindOther = 1 ]</li>
<li>If [ $menu &amp; $tag  &amp; &para; &ne; FilterValues ( $$foundOther ; $menu &amp; $tag) ]</li>
<li>Extend Found Set [  ]</li>
<li>#</li>
<li>#If nothing was found capture the error message</li>
<li>#as steps before showing the error message will</li>
<li>#delete it from the system and we need it to</li>
<li>#activate the error message below if there was </li>
<li>#an error.</li>
<li>Set Variable [ $error; Value:Get (LastError) ]</li>
<li>#</li>
<li>#Add the tag from the list of found tagged records.</li>
<li>Set Variable [ $found; Value:$$foundOther ]</li>
<li>Set Variable [ $$foundOther; Value:$menu &amp; $tag &amp; &para; &amp; $found ]</li>
<li>#</li>
<li>#If this is not the first find and the item that</li>
<li>#the user clicked on to start this script has</li>
<li>#already been found, then remove tag from the</li>
<li>#the list of found other tagged records.  </li>
<li>Else If [ $menu &amp; $tag  &amp; &para;= FilterValues ( $$foundOther ; $menu &amp; $tag  &amp; &para;) ]</li>
<li>Set Variable [ $found; Value:$$foundOther ]</li>
<li>Set Variable [ $$foundOther; Value:Substitute ( $found ; $menu &amp; $tag &amp; &para; ; "" ) ]</li>
<li>#</li>
<li>#Enter browse mode to clear the find selections</li>
<li>#set at the beginning of this script. </li>
<li>Enter Browse Mode</li>
<li>#</li>
<li>#If after removing this item from the list of found other</li>
<li>#tagged records the list is empty, perform a find</li>
<li>#that will result in zero records being found</li>
<li>#to reflect the fact that the user currently has</li>
<li>#an empty found other list.</li>
<li>If [ $$foundOther = "" ]</li>
<li>Set Variable [ $$firstFindOther ]</li>
<li>Enter Find Mode [  ]</li>
<li>#</li>
<li>#</li>
<li>#Since ID numbers are numbers, the text </li>
<li>#'findnoRecords' entered in the ID field will result</li>
<li>#in zero records being found.</li>
<li>If [ $$citationMatch = "key" ]</li>
<li>Set Field [ testlearn::kcKeywordOther; "findNoRecords" &amp; &para; ]</li>
<li>Else If [ $$citationMatch = "node" ]</li>
<li>Set Field [ testlearn::kNodeOther; "findNoRecords" &amp; &para; ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#If after removing this item from the $$foundOther</li>
<li>#list, the list is not empty, refind all records </li>
<li>#still on the list one tag at a time.</li>
<li>Else If [ $$foundOther &ne; "" ]</li>
<li>#</li>
<li>#Create a copy of the found list.  Items will be</li>
<li>#removed from this one at a time as they are found.</li>
<li>Set Variable [ $findList; Value:$$foundOther ]</li>
<li>#</li>
<li>#Get the menu item name so system will know</li>
<li>#what field to put the ID number into to find</li>
<li>#records tagged with this item.</li>
<li>Set Variable [ $menu; Value:Left ( ( GetValue ( $findList ; 1 ) ) ; 1 ) ]</li>
<li>#</li>
<li>#Get the ID number of the tag to be found.</li>
<li>#(the number 42 is a joke, essentially the number</li>
<li>#needs to be big enough to capture the full ID number</li>
<li>#which is much shorter, but overkill doesn't hurt)</li>
<li>#FYI: joke is from Hitchhiker's Guide to the Galaxy</li>
<li>Set Variable [ $find; Value:Middle ( ( GetValue ( $findList ; 1 ) ) ; 2 ; 42 ) ]</li>
<li>#</li>
<li>#Remove it from the list of tags to be found.</li>
<li>Set Variable [ $subtract; Value:$findList ]</li>
<li>Set Variable [ $findList; Value:Substitute ( $subtract ; $menu &amp; $find &amp; &para; ; "" ) ]</li>
<li>#</li>
<li>#Find main window records tagged with it.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection ]</li>
<li>Set Field [ testlearn::filterFind; "main" &amp; &para; ]</li>
<li>#</li>
<li>#</li>
<li>If [ $menu = "k" ]</li>
<li>Set Field [ testlearn::kcKeywordOther; $find ]</li>
<li>Else If [ $menu = "n" ]</li>
<li>Set Field [ testlearn::kNodeOther; $find ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#If there is more than one item on the $$found</li>
<li>#list, then find the rest of records tagged with</li>
<li>#this items/tags.</li>
<li>Perform Find [  ]</li>
<li>Loop</li>
<li>#</li>
<li>#When the list is empty stop finding stuff.</li>
<li>Exit Loop If [ ValueCount ( $findList ) = 0 ]</li>
<li>#</li>
<li>#Get the menu item name so system will know</li>
<li>#what field to put the ID number into to find</li>
<li>#records tagged with this item.</li>
<li>Set Variable [ $menu; Value:Left ( ( GetValue ( $findList ; 1 ) ) ; 1 ) ]</li>
<li>#</li>
<li>#Get the ID number of the tag to be found.</li>
<li>Set Variable [ $find; Value:Middle ( ( GetValue ( $findList ; 1 ) ) ; 2; 42 ) ]</li>
<li>#</li>
<li>#Remove it from the list of tags to be found.</li>
<li>Set Variable [ $subtract; Value:$findList ]</li>
<li>Set Variable [ $findList; Value:Substitute ( $subtract ; $menu &amp; $find &amp; &para; ; "" ) ]</li>
<li>#</li>
<li>#Find main window records tagged with it.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection ]</li>
<li>Set Field [ testlearn::filterFind; "main" &amp; &para; ]</li>
<li>#</li>
<li>#</li>
<li>If [ $menu = "k" ]</li>
<li>Set Field [ testlearn::kcKeywordOther; $find ]</li>
<li>Else If [ $menu = "n" ]</li>
<li>Set Field [ testlearn::kNodeOther; $find ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>Extend Found Set [  ]</li>
<li>End Loop</li>
<li>End If</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Refind primary items.</li>
<li>If [ $$found &ne; "" ]</li>
<li>#</li>
<li>#Create a copy of the found list.  Items will be</li>
<li>#removed from this one at a time as they are found.</li>
<li>Set Variable [ $findList; Value:$$found ]</li>
<li>#</li>
<li>#Get the menu item name so system will know</li>
<li>#what field to put the ID number into to find</li>
<li>#records tagged with this item.</li>
<li>Set Variable [ $menu; Value:Left ( ( GetValue ( $findList ; 1 ) ) ; 1 ) ]</li>
<li>#</li>
<li>#Get the ID number of the tag to be found.</li>
<li>#(the number 42 is a joke, essentially the number</li>
<li>#needs to be big enough to capture the full ID number</li>
<li>#which is much shorter, but overkill doesn't hurt)</li>
<li>#FYI: joke is from Hitchhiker's Guide to the Galaxy</li>
<li>Set Variable [ $find; Value:Middle ( ( GetValue ( $findList ; 1 ) ) ; 2 ; 42 ) ]</li>
<li>#</li>
<li>#Remove it from the list of tags to be found.</li>
<li>Set Variable [ $subtract; Value:$findList ]</li>
<li>Set Variable [ $findList; Value:Substitute ( $subtract ; $menu &amp; $find &amp; &para; ; "" ) ]</li>
<li>#</li>
<li>#Find main window records tagged with it.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection ]</li>
<li>Set Field [ testlearn::filterFind; "main" &amp; &para; ]</li>
<li>#</li>
<li>#</li>
<li>If [ $menu = "k" ]</li>
<li>Set Field [ testlearn::kKeywordPrimary; $find ]</li>
<li>Else If [ $menu = "n" ]</li>
<li>Set Field [ testlearn::kNodePrimary; $find ]</li>
<li>Else If [ $menu = "m" ]</li>
<li>Set Field [ testlearn::kmedium; $find ]</li>
<li>Else If [ $menu = "h" ]</li>
<li>Set Field [ testlearn::kHealth; $find ]</li>
<li>Else If [ $menu = "r" ]</li>
<li>Set Field [ testlearn::kcreference; $find ]</li>
<li>Else If [ $menu = "c" ]</li>
<li>Set Field [ testlearn::kcitation; $find ]</li>
<li>Else If [ $menu = "p" ]</li>
<li>Set Field [ testlearn::kfolderPath; $find ]</li>
<li>Else If [ $menu = "t" ]</li>
<li>Set Field [ testlearn::ktest; $find ]</li>
<li>Else If [ $menu = "s" ]</li>
<li>Set Field [ testlearn::kcsample; $find ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>Extend Found Set [  ]</li>
<li>#</li>
<li>#If there is more than one item on the $$found</li>
<li>#list, then find the rest of records tagged with</li>
<li>#this items/tags.</li>
<li>Loop</li>
<li>#</li>
<li>#When the list is empty stop finding stuff.</li>
<li>Exit Loop If [ ValueCount ( $findList ) = 0 ]</li>
<li>#</li>
<li>#Get the menu item name so system will know</li>
<li>#what field to put the ID number into to find</li>
<li>#records tagged with this item.</li>
<li>Set Variable [ $menu; Value:Left ( ( GetValue ( $findList ; 1 ) ) ; 1 ) ]</li>
<li>#</li>
<li>#Get the ID number of the tag to be found.</li>
<li>Set Variable [ $find; Value:Middle ( ( GetValue ( $findList ; 1 ) ) ; 2 ; 42 ) ]</li>
<li>#</li>
<li>#Remove it from the list of tags to be found.</li>
<li>Set Variable [ $subtract; Value:$findList ]</li>
<li>Set Variable [ $findList; Value:Substitute ( $subtract ; $menu &amp; $find &amp; &para; ; "" ) ]</li>
<li>#</li>
<li>#Find main window records tagged with it.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection ]</li>
<li>Set Field [ testlearn::filterFind; "main" &amp; &para; ]</li>
<li>#</li>
<li>#</li>
<li>If [ $menu = "k" ]</li>
<li>Set Field [ testlearn::kKeywordPrimary; $find ]</li>
<li>Else If [ $menu = "n" ]</li>
<li>Set Field [ testlearn::kNodePrimary; $find ]</li>
<li>Else If [ $menu = "m" ]</li>
<li>Set Field [ testlearn::kmedium; $find ]</li>
<li>Else If [ $menu = "h" ]</li>
<li>Set Field [ testlearn::kHealth; $find ]</li>
<li>Else If [ $menu = "r" ]</li>
<li>Set Field [ testlearn::kcreference; $find ]</li>
<li>Else If [ $menu = "c" ]</li>
<li>Set Field [ testlearn::kcitation; $find ]</li>
<li>Else If [ $menu = "p" ]</li>
<li>Set Field [ testlearn::kfolderPath; $find ]</li>
<li>Else If [ $menu = "t" ]</li>
<li>Set Field [ testlearn::ktest; $find ]</li>
<li>Else If [ $menu = "s" ]</li>
<li>Set Field [ testlearn::kcsample; $find ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>Extend Found Set [  ]</li>
<li>End Loop</li>
<li>End If</li>
<li>#</li>
<li>#Sort according to current sort in Main window.</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>#</li>
<li>#Go to first record and preform record load script.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Perform Script [ &ldquo;loadCitation&rdquo; ]</li>
<li>#</li>
<li>#Return focus to Tag Menus window.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>#</li>
<li>#If no records where found tell user why and</li>
<li>#remove tag ID from list of tags attached to records</li>
<li>#in the main window.</li>
<li>If [ $error = 401 ]</li>
<li>If [ $$firstFind = "" ]</li>
<li>Set Variable [ $$foundOther ]</li>
<li>Else If [ $$firstFind &ne; "" ]</li>
<li>Set Variable [ $$foundOther; Value:Substitute ( $found ; $menu &amp; $tag &amp; &para; ; "" ) ]</li>
<li>End If</li>
<li>Refresh Window</li>
<li>#</li>
<li>#</li>
<li>If [ $$citationMatch = "key" ]</li>
<li>Show Custom Dialog [ Message: "'" &amp; $name &amp; "'" &amp; " is not in use as an other keyword."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Else If [ $$citationMatch = "node" ]</li>
<li>Show Custom Dialog [ Message: "'" &amp; $name &amp; "'" &amp; " is not in use as a primary node."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>testlearn</em>::kcsection</li>
<li>
<em>testlearn</em>::filterFind</li>
<li>
<em>testlearn</em>::kcKeywordOther</li>
<li>
<em>testlearn</em>::kNodeOther</li>
<li>
<em>testlearn</em>::kKeywordPrimary</li>
<li>
<em>testlearn</em>::kNodePrimary</li>
<li>
<em>testlearn</em>::kmedium</li>
<li>
<em>testlearn</em>::kHealth</li>
<li>
<em>testlearn</em>::kcreference</li>
<li>
<em>testlearn</em>::kcitation</li>
<li>
<em>testlearn</em>::kfolderPath</li>
<li>
<em>testlearn</em>::ktest</li>
<li>
<em>testlearn</em>::kcsample</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32984ScriptAnchor_">loadCitation</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33119ScriptAnchor_"></a><td class="script_navbar"><a href="#33101ScriptAnchor_"><span>Previous Script: [findKeyOtherTL]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33120ScriptAnchor_"><span>Next Script: [findKeyOtherRef]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">findPrimaryRef</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Select tag to be found.</li>
<li>Set Variable [ $tag; Value:tagMenus::_Ltag ]</li>
<li>#</li>
<li>#Select the kind of tag to be found.  We grab</li>
<li>#only the first three letters because the shortest</li>
<li>#menu item 'key' has only three letters, and because</li>
<li>#we need the same number of characters/letters</li>
<li>#to make up this variable so when it is added to</li>
<li>#the first part of an item in the found list below</li>
<li>#it can be removed by the system which only</li>
<li>#can be told how many characters to remove.</li>
<li>#This variable is thus a meta tag added to an</li>
<li>#ID number to tell the system from which menu</li>
<li>#did this item come.  This meta tag or tag allows</li>
<li>#us to make a list of ID numbers from various</li>
<li>#tag menus: key, node, medium, etc.  </li>
<li>Set Variable [ $menu; Value:Left ( $$citationMatch ; 1 ) ]</li>
<li>#</li>
<li>#Get the name of the tag for error message</li>
<li>#at bottom of this script if needed.</li>
<li>Set Variable [ $name; Value:tagMenus::tag ]</li>
<li>#</li>
<li>#As going to the other window will be involved</li>
<li>#stop the record load script on that window until</li>
<li>#this script is finished to speed things up and</li>
<li>#stop flashing effect.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>#</li>
<li>#Go to the other window and start the find process.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::kcsection; TEMP::ksection ]</li>
<li>//  Set Field [ reference::filterFind; "main" &amp; &para; ]</li>
<li>#</li>
<li>#</li>
<li>If [ $menu = "k" ]</li>
<li>Set Field [ reference::kkeywordPrimary; $tag ]</li>
<li>Else If [ $menu = "n" ]</li>
<li>Set Field [ reference::knodePrimary; $tag ]</li>
<li>Else If [ $menu = "m" ]</li>
<li>Set Field [ reference::kmedium; $tag ]</li>
<li>Else If [ $menu = "h" ]</li>
<li>Set Field [ reference::kHealth; $tag ]</li>
<li>Else If [ $menu = "p" ]</li>
<li>Set Field [ reference::kfolderpath; $tag ]</li>
<li>Else If [ $menu = "o" ]</li>
<li>Set Field [ reference::korgan; $tag ]</li>
<li>Else If [ $menu = "c" ]</li>
<li>Set Field [ reference::kcopyist; $tag ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#If this is the first find, note this and perform</li>
<li>#the find.</li>
<li>If [ $$firstFind = "" ]</li>
<li>Set Variable [ $$firstFind; Value:1 ]</li>
<li>Set Variable [ $$found; Value:$menu &amp; $tag &amp; &para; ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#If nothing was found capture the error message</li>
<li>#as steps before showing the error message will</li>
<li>#delete it from the system and we need it to</li>
<li>#activate the error message below if there was </li>
<li>#an error.</li>
<li>Set Variable [ $error; Value:Get (LastError) ]</li>
<li>#</li>
<li>#If this is not the first find and the item that</li>
<li>#the user clicked on to start this script has</li>
<li>#not already been found, then add items tagged</li>
<li>#with it to the current set of found records.</li>
<li>Else If [ $$firstFind = 1 ]</li>
<li>If [ $menu &amp; $tag  &amp; &para; &ne; FilterValues ( $$found ; $menu &amp; $tag) ]</li>
<li>Extend Found Set [  ]</li>
<li>#</li>
<li>#If nothing was found capture the error message</li>
<li>#as steps before showing the error message will</li>
<li>#delete it from the system and we need it to</li>
<li>#activate the error message below if there was </li>
<li>#an error.</li>
<li>Set Variable [ $error; Value:Get (LastError) ]</li>
<li>#</li>
<li>#Add the tag from the list of found tagged records.</li>
<li>Set Variable [ $found; Value:$$found ]</li>
<li>Set Variable [ $$found; Value:$menu &amp; $tag &amp; &para; &amp; $found ]</li>
<li>#</li>
<li>#If this is not the first find and the item that</li>
<li>#the user clicked on to start this script has</li>
<li>#already been found, then remove tag from the</li>
<li>#the list of found tagged records.  </li>
<li>Else If [ $menu &amp; $tag  &amp; &para;= FilterValues ( $$found ; $menu &amp; $tag  &amp; &para;) ]</li>
<li>Set Variable [ $found; Value:$$found ]</li>
<li>Set Variable [ $$found; Value:Substitute ( $found ; $menu &amp; $tag &amp; &para; ; "" ) ]</li>
<li>#</li>
<li>#Enter browse mode to clear the find selections</li>
<li>#set at the beginning of this script. </li>
<li>Enter Browse Mode</li>
<li>#</li>
<li>#If after removing this item from the list of found</li>
<li>#tagged records the list is empty, perform a find</li>
<li>#that will result in zero records being found</li>
<li>#to reflect the fact that the user currently has</li>
<li>#an empty found list.</li>
<li>If [ $$found = "" ]</li>
<li>Set Variable [ $$firstFind ]</li>
<li>Enter Find Mode [  ]</li>
<li>#</li>
<li>#</li>
<li>#Since ID numbers are numbers, the text </li>
<li>#'findnoRecords' entered in the ID field will result</li>
<li>#in zero records being found.</li>
<li>Set Field [ reference::kkeywordPrimary; "findNoRecords" ]</li>
<li>#</li>
<li>#</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#If after removing this item from the $$found list,</li>
<li>#the list is not empty, refind all records still on</li>
<li>#the list one tag at a time.</li>
<li>Else If [ $$found &ne; "" ]</li>
<li>#</li>
<li>#Create a copy of the found list.  Items will be</li>
<li>#removed from this one at a time as they are found.</li>
<li>Set Variable [ $findList; Value:$$found ]</li>
<li>#</li>
<li>#Get the menu item name so system will know</li>
<li>#what field to put the ID number into to find</li>
<li>#records tagged with this item.</li>
<li>Set Variable [ $menu; Value:Left ( ( GetValue ( $findList ; 1 ) ) ; 1 ) ]</li>
<li>#</li>
<li>#Get the ID number of the tag to be found.</li>
<li>#(the number 42 is a joke, essentially the number</li>
<li>#needs to be big enough to capture the full ID number</li>
<li>#which is much shorter, but overkill doesn't hurt)</li>
<li>#FYI: joke is from Hitchhiker's Guide to the Galaxy</li>
<li>Set Variable [ $find; Value:Middle ( ( GetValue ( $findList ; 1 ) ) ; 2 ; 42 ) ]</li>
<li>#</li>
<li>#Remove it from the list of tags to be found.</li>
<li>Set Variable [ $subtract; Value:$findList ]</li>
<li>Set Variable [ $findList; Value:Substitute ( $subtract ; $menu &amp; $find &amp; &para; ; "" ) ]</li>
<li>#</li>
<li>#Find main window records tagged with it.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::kcsection; TEMP::ksection ]</li>
<li>Set Field [ reference::filterFind; "main" &amp; &para; ]</li>
<li>#</li>
<li>#</li>
<li>If [ $menu = "k" ]</li>
<li>Set Field [ reference::kkeywordPrimary; $find ]</li>
<li>Else If [ $menu = "n" ]</li>
<li>Set Field [ reference::knodePrimary; $find ]</li>
<li>Else If [ $menu = "m" ]</li>
<li>Set Field [ reference::kmedium; $find ]</li>
<li>Else If [ $menu = "h" ]</li>
<li>Set Field [ reference::kHealth; $find ]</li>
<li>Else If [ $menu = "p" ]</li>
<li>Set Field [ reference::kfolderpath; $find ]</li>
<li>Else If [ $menu = "o" ]</li>
<li>Set Field [ reference::korgan; $find ]</li>
<li>Else If [ $menu = "c" ]</li>
<li>Set Field [ reference::kcopyist; $find ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#If there is more than one item on the $$found</li>
<li>#list, then find the rest of records tagged with</li>
<li>#this items/tags.</li>
<li>Perform Find [  ]</li>
<li>Loop</li>
<li>#</li>
<li>#When the list is empty stop finding stuff.</li>
<li>Exit Loop If [ ValueCount ( $findList ) = 0 ]</li>
<li>#</li>
<li>#Get the menu item name so system will know</li>
<li>#what field to put the ID number into to find</li>
<li>#records tagged with this item.</li>
<li>Set Variable [ $menu; Value:Left ( ( GetValue ( $findList ; 1 ) ) ; 1 ) ]</li>
<li>#</li>
<li>#Get the ID number of the tag to be found.</li>
<li>Set Variable [ $find; Value:Middle ( ( GetValue ( $findList ; 1 ) ) ; 2 ; 42 ) ]</li>
<li>#</li>
<li>#Remove it from the list of tags to be found.</li>
<li>Set Variable [ $subtract; Value:$findList ]</li>
<li>Set Variable [ $findList; Value:Substitute ( $subtract ; $menu &amp; $find &amp; &para; ; "" ) ]</li>
<li>#</li>
<li>#Find main window records tagged with it.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::kcsection; TEMP::ksection ]</li>
<li>Set Field [ reference::filterFind; "main" &amp; &para; ]</li>
<li>#</li>
<li>#</li>
<li>If [ $menu = "k" ]</li>
<li>Set Field [ reference::kkeywordPrimary; $find ]</li>
<li>Else If [ $menu = "n" ]</li>
<li>Set Field [ reference::knodePrimary; $find ]</li>
<li>Else If [ $menu = "m" ]</li>
<li>Set Field [ reference::kmedium; $find ]</li>
<li>Else If [ $menu = "h" ]</li>
<li>Set Field [ reference::kHealth; $find ]</li>
<li>Else If [ $menu = "p" ]</li>
<li>Set Field [ reference::kfolderpath; $find ]</li>
<li>Else If [ $menu = "o" ]</li>
<li>Set Field [ reference::korgan; $find ]</li>
<li>Else If [ $menu = "c" ]</li>
<li>Set Field [ reference::kcopyist; $find ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>Extend Found Set [  ]</li>
<li>End Loop</li>
<li>End If</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Refind any Other Keyword items.</li>
<li>If [ $$foundOther &ne; "" ]</li>
<li>#</li>
<li>#Create a copy of the found list.  Items will be</li>
<li>#removed from this one at a time as they are found.</li>
<li>Set Variable [ $findList; Value:$$foundOther ]</li>
<li>#</li>
<li>#Get the menu item name so system will know</li>
<li>#what field to put the ID number into to find</li>
<li>#records tagged with this item.</li>
<li>Set Variable [ $menu; Value:Left ( ( GetValue ( $findList ; 1 ) ) ; 1 ) ]</li>
<li>#</li>
<li>#Get the ID number of the tag to be found.</li>
<li>Set Variable [ $find; Value:Middle ( ( GetValue ( $findList ; 1 ) ) ; 2 ; 42 ) ]</li>
<li>#</li>
<li>#Remove it from the list of tags to be found.</li>
<li>Set Variable [ $subtract; Value:$findList ]</li>
<li>Set Variable [ $findList; Value:Substitute ( $subtract ; $menu &amp; $find &amp; &para; ; "" ) ]</li>
<li>#</li>
<li>#Find main window records tagged with it.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::kcsection; TEMP::ksection ]</li>
<li>Set Field [ reference::filterFind; "main" &amp; &para; ]</li>
<li>#</li>
<li>#</li>
<li>If [ $menu = "k" ]</li>
<li>Set Field [ reference::kkeywordOther; $find ]</li>
<li>Else If [ $menu = "n" ]</li>
<li>Set Field [ reference::knodeOther; $find ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>Extend Found Set [  ]</li>
<li>#</li>
<li>#If there is more than one item on the $$foundOther</li>
<li>#list, then find the rest of records tagged with</li>
<li>#this items/tags.</li>
<li>Loop</li>
<li>#</li>
<li>#When the list is empty stop finding stuff.</li>
<li>Exit Loop If [ ValueCount ( $findList ) = 0 ]</li>
<li>#</li>
<li>#Get the menu item name so system will know</li>
<li>#what field to put the ID number into to find</li>
<li>#records tagged with this item.</li>
<li>Set Variable [ $menu; Value:Left ( ( GetValue ( $findList ; 1 ) ) ; 1 ) ]</li>
<li>#</li>
<li>#Get the ID number of the tag to be found.</li>
<li>Set Variable [ $find; Value:Middle ( ( GetValue ( $findList ; 1 ) ) ; 2 ; 42 ) ]</li>
<li>#</li>
<li>#Remove it from the list of tags to be found.</li>
<li>Set Variable [ $subtract; Value:$findList ]</li>
<li>Set Variable [ $findList; Value:Substitute ( $subtract ; $menu &amp; $find &amp; &para; ; "" ) ]</li>
<li>#</li>
<li>#Find main window records tagged with it.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::kcsection; TEMP::ksection ]</li>
<li>Set Field [ reference::filterFind; "main" &amp; &para; ]</li>
<li>#</li>
<li>#</li>
<li>If [ $menu = "k" ]</li>
<li>Set Field [ reference::kkeywordOther; $find ]</li>
<li>Else If [ $menu = "n" ]</li>
<li>Set Field [ reference::knodeOther; $find ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>Extend Found Set [  ]</li>
<li>End Loop</li>
<li>End If</li>
<li>#</li>
<li>#Sort according to current sort in Main window.</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>#</li>
<li>#Go to first record and preform record load script.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Perform Script [ &ldquo;loadCitation&rdquo; ]</li>
<li>#</li>
<li>#Return focus to Tag Menus window.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>#</li>
<li>#If no records where found tell user why and</li>
<li>#remove tag ID from list of tags attached to records</li>
<li>#in the main window.</li>
<li>If [ $error = 401 ]</li>
<li>If [ $$firstFind = "" ]</li>
<li>Set Variable [ $$found ]</li>
<li>Else If [ $$firstFind &ne; "" ]</li>
<li>Set Variable [ $$found; Value:Substitute ( $found ; $menu &amp; $tag &amp; &para; ; "" ) ]</li>
<li>End If</li>
<li>Refresh Window</li>
<li>#</li>
<li>#</li>
<li>If [ $$citationMatch = "key" ]</li>
<li>Show Custom Dialog [ Message: "'" &amp; $name &amp; "'" &amp; " is not in use as a primary keyword."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Else If [ $$citationMatch = "node" ]</li>
<li>Show Custom Dialog [ Message: "'" &amp; $name &amp; "'" &amp; " is not in use as a primary node."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Else If [ $$citationMatch = "medium" ]</li>
<li>Show Custom Dialog [ Message: "'" &amp; $name &amp; "'" &amp; " is not in use."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Else If [ $$citationMatch = "health" ]</li>
<li>Show Custom Dialog [ Message: "'" &amp; $name &amp; "'" &amp; " is not in use."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Else If [ $$citationMatch = "path" ]</li>
<li>Show Custom Dialog [ Message: "'" &amp; $name &amp; "'" &amp; " is not in use."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Else If [ $$citationMatch = "organ" ]</li>
<li>Show Custom Dialog [ Message: "'" &amp; $name &amp; "'" &amp; " is not in use."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Else If [ $$citationMatch = "copyist" ]</li>
<li>Show Custom Dialog [ Message: "'" &amp; $name &amp; "'" &amp; " is not in use."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>reference</em>::kcsection</li>
<li>
<em>reference</em>::filterFind</li>
<li>
<em>reference</em>::kkeywordPrimary</li>
<li>
<em>reference</em>::knodePrimary</li>
<li>
<em>reference</em>::kmedium</li>
<li>
<em>reference</em>::kHealth</li>
<li>
<em>reference</em>::kfolderpath</li>
<li>
<em>reference</em>::korgan</li>
<li>
<em>reference</em>::kcopyist</li>
<li>
<em>reference</em>::kkeywordOther</li>
<li>
<em>reference</em>::knodeOther</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32984ScriptAnchor_">loadCitation</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33120ScriptAnchor_"></a><td class="script_navbar"><a href="#33119ScriptAnchor_"><span>Previous Script: [findPrimaryRef]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33223ScriptAnchor_"><span>Next Script: [CHUNKcheckForDragPasteChanges]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">findKeyOtherRef</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#Select tag to be found.</li>
<li>Set Variable [ $tag; Value:tagMenus::_Ltag ]</li>
<li>#</li>
<li>#</li>
<li>#Select the kind of tag to be found.  We grab</li>
<li>#only the first three letters because the shortest</li>
<li>#menu item 'key' has only three letters, and because</li>
<li>#we need the same number of characters/letters</li>
<li>#to make up this variable so when it is added to</li>
<li>#the first part of an item in the found list below</li>
<li>#it can be removed by the system which only</li>
<li>#can be told how many characters to remove.</li>
<li>#This variable is thus a meta tag added to an</li>
<li>#ID number to tell the system from which menu</li>
<li>#did this item come.  This meta tag or tag allows</li>
<li>#us to make a list of ID numbers from various</li>
<li>#tag menus: key, node, medium, etc.  </li>
<li>Set Variable [ $menu; Value:Left ( $$citationMatch ; 1 ) ]</li>
<li>#</li>
<li>#Get the name of the tag for error message</li>
<li>#at bottom of this script if needed.</li>
<li>Set Variable [ $name; Value:tagMenus::tag ]</li>
<li>#</li>
<li>#As going to the other window will be involved</li>
<li>#stop the record load script on that window until</li>
<li>#this script is finished to speed things up and</li>
<li>#stop flashing effect.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>#</li>
<li>#Go to the other window and start the find process.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::kcsection; TEMP::ksection ]</li>
<li>//  Set Field [ reference::filterFind; "main" &amp; &para; ]</li>
<li>#</li>
<li>#</li>
<li>If [ $$citationMatch = "key" ]</li>
<li>Set Field [ reference::kkeywordOther; $tag ]</li>
<li>Else If [ $$citationMatch = "node" ]</li>
<li>Set Field [ reference::knodeOther; $tag ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#If this is the first find, note this and perform</li>
<li>#the find.</li>
<li>If [ $$firstFindOther = "" ]</li>
<li>Set Variable [ $$firstFindOther; Value:1 ]</li>
<li>Set Variable [ $$foundOther; Value:$menu &amp; $tag &amp; &para; ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#If nothing was found capture the error message</li>
<li>#as steps before showing the error message will</li>
<li>#delete it from the system and we need it to</li>
<li>#activate the error message below if there was </li>
<li>#an error.</li>
<li>Set Variable [ $error; Value:Get (LastError) ]</li>
<li>#</li>
<li>#If this is not the first find and the item that</li>
<li>#the user clicked on to start this script has</li>
<li>#not already been found, then add items tagged</li>
<li>#with it to the current set of found records.</li>
<li>Else If [ $$firstFindOther = 1 ]</li>
<li>If [ $menu &amp; $tag  &amp; &para; &ne; FilterValues ( $$foundOther ; $menu &amp; $tag) ]</li>
<li>Extend Found Set [  ]</li>
<li>#</li>
<li>#If nothing was found capture the error message</li>
<li>#as steps before showing the error message will</li>
<li>#delete it from the system and we need it to</li>
<li>#activate the error message below if there was </li>
<li>#an error.</li>
<li>Set Variable [ $error; Value:Get (LastError) ]</li>
<li>#</li>
<li>#Add the tag from the list of found tagged records.</li>
<li>Set Variable [ $found; Value:$$foundOther ]</li>
<li>Set Variable [ $$foundOther; Value:$menu &amp; $tag &amp; &para; &amp; $found ]</li>
<li>#</li>
<li>#If this is not the first find and the item that</li>
<li>#the user clicked on to start this script has</li>
<li>#already been found, then remove tag from the</li>
<li>#the list of found other tagged records.  </li>
<li>Else If [ $menu &amp; $tag  &amp; &para;= FilterValues ( $$foundOther ; $menu &amp; $tag  &amp; &para;) ]</li>
<li>Set Variable [ $found; Value:$$foundOther ]</li>
<li>Set Variable [ $$foundOther; Value:Substitute ( $found ; $menu &amp; $tag &amp; &para; ; "" ) ]</li>
<li>#</li>
<li>#Enter browse mode to clear the find selections</li>
<li>#set at the beginning of this script. </li>
<li>Enter Browse Mode</li>
<li>#</li>
<li>#If after removing this item from the list of found other</li>
<li>#tagged records the list is empty, perform a find</li>
<li>#that will result in zero records being found</li>
<li>#to reflect the fact that the user currently has</li>
<li>#an empty found other list.</li>
<li>If [ $$foundOther = "" ]</li>
<li>Set Variable [ $$firstFindOther ]</li>
<li>Enter Find Mode [  ]</li>
<li>#</li>
<li>#</li>
<li>#Since ID numbers are numbers, the text </li>
<li>#'findnoRecords' entered in the ID field will result</li>
<li>#in zero records being found.</li>
<li>Set Field [ reference::kkeywordPrimary; "findNoRecords" &amp; &para; ]</li>
<li>#</li>
<li>#</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#If after removing this item from the $$foundOther</li>
<li>#list, the list is not empty, refind all records </li>
<li>#still on the list one tag at a time.</li>
<li>Else If [ $$foundOther &ne; "" ]</li>
<li>#</li>
<li>#Create a copy of the found list.  Items will be</li>
<li>#removed from this one at a time as they are found.</li>
<li>Set Variable [ $findList; Value:$$foundOther ]</li>
<li>#</li>
<li>#Get the menu item name so system will know</li>
<li>#what field to put the ID number into to find</li>
<li>#records tagged with this item.</li>
<li>Set Variable [ $menu; Value:Left ( ( GetValue ( $findList ; 1 ) ) ; 1 ) ]</li>
<li>#</li>
<li>#Get the ID number of the tag to be found.</li>
<li>#(the number 42 is a joke, essentially the number</li>
<li>#needs to be big enough to capture the full ID number</li>
<li>#which is much shorter, but overkill doesn't hurt)</li>
<li>#FYI: joke is from Hitchhiker's Guide to the Galaxy</li>
<li>Set Variable [ $find; Value:Middle ( ( GetValue ( $findList ; 1 ) ) ; 2 ; 42 ) ]</li>
<li>#</li>
<li>#Remove it from the list of tags to be found.</li>
<li>Set Variable [ $subtract; Value:$findList ]</li>
<li>Set Variable [ $findList; Value:Substitute ( $subtract ; $menu &amp; $find &amp; &para; ; "" ) ]</li>
<li>#</li>
<li>#Find main window records tagged with it.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::kcsection; TEMP::ksection ]</li>
<li>Set Field [ reference::filterFind; "main" &amp; &para; ]</li>
<li>#</li>
<li>#</li>
<li>If [ $menu = "k" ]</li>
<li>Set Field [ reference::kkeywordOther; $find ]</li>
<li>Else If [ $menu = "n" ]</li>
<li>Set Field [ reference::knodeOther; $find ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#If there is more than one item on the $$found</li>
<li>#list, then find the rest of records tagged with</li>
<li>#this items/tags.</li>
<li>Perform Find [  ]</li>
<li>Loop</li>
<li>#</li>
<li>#When the list is empty stop finding stuff.</li>
<li>Exit Loop If [ ValueCount ( $findList ) = 0 ]</li>
<li>#</li>
<li>#Get the menu item name so system will know</li>
<li>#what field to put the ID number into to find</li>
<li>#records tagged with this item.</li>
<li>Set Variable [ $menu; Value:Left ( ( GetValue ( $findList ; 1 ) ) ; 1 ) ]</li>
<li>#</li>
<li>#Get the ID number of the tag to be found.</li>
<li>Set Variable [ $find; Value:Middle ( ( GetValue ( $findList ; 1 ) ) ; 2; 42 ) ]</li>
<li>#</li>
<li>#Remove it from the list of tags to be found.</li>
<li>Set Variable [ $subtract; Value:$findList ]</li>
<li>Set Variable [ $findList; Value:Substitute ( $subtract ; $menu &amp; $find &amp; &para; ; "" ) ]</li>
<li>#</li>
<li>#Find main window records tagged with it.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::kcsection; TEMP::ksection ]</li>
<li>Set Field [ reference::filterFind; "main" &amp; &para; ]</li>
<li>#</li>
<li>#</li>
<li>If [ $menu = "k" ]</li>
<li>Set Field [ reference::kkeywordOther; $find ]</li>
<li>Else If [ $menu = "n" ]</li>
<li>Set Field [ reference::knodeOther; $find ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>Extend Found Set [  ]</li>
<li>End Loop</li>
<li>End If</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Refind primary items.</li>
<li>If [ $$found &ne; "" ]</li>
<li>#</li>
<li>#Create a copy of the found list.  Items will be</li>
<li>#removed from this one at a time as they are found.</li>
<li>Set Variable [ $findList; Value:$$found ]</li>
<li>#</li>
<li>#Get the menu item name so system will know</li>
<li>#what field to put the ID number into to find</li>
<li>#records tagged with this item.</li>
<li>Set Variable [ $menu; Value:Left ( ( GetValue ( $findList ; 1 ) ) ; 1 ) ]</li>
<li>#</li>
<li>#Get the ID number of the tag to be found.</li>
<li>#(the number 42 is a joke, essentially the number</li>
<li>#needs to be big enough to capture the full ID number</li>
<li>#which is much shorter, but overkill doesn't hurt)</li>
<li>#FYI: joke is from Hitchhiker's Guide to the Galaxy</li>
<li>Set Variable [ $find; Value:Middle ( ( GetValue ( $findList ; 1 ) ) ; 2 ; 42 ) ]</li>
<li>#</li>
<li>#Remove it from the list of tags to be found.</li>
<li>Set Variable [ $subtract; Value:$findList ]</li>
<li>Set Variable [ $findList; Value:Substitute ( $subtract ; $menu &amp; $find &amp; &para; ; "" ) ]</li>
<li>#</li>
<li>#Find main window records tagged with it.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::kcsection; TEMP::ksection ]</li>
<li>Set Field [ reference::filterFind; "main" &amp; &para; ]</li>
<li>#</li>
<li>#</li>
<li>If [ $menu = "k" ]</li>
<li>Set Field [ reference::kkeywordPrimary; $find ]</li>
<li>Else If [ $menu = "n" ]</li>
<li>Set Field [ reference::knodePrimary; $find ]</li>
<li>Else If [ $menu = "m" ]</li>
<li>Set Field [ reference::kmedium; $find ]</li>
<li>Else If [ $menu = "h" ]</li>
<li>Set Field [ reference::kHealth; $find ]</li>
<li>Else If [ $menu = "p" ]</li>
<li>Set Field [ reference::kfolderpath; $find ]</li>
<li>Else If [ $menu = "o" ]</li>
<li>Set Field [ reference::korgan; $find ]</li>
<li>Else If [ $menu = "c" ]</li>
<li>Set Field [ reference::kcopyist; $find ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>Extend Found Set [  ]</li>
<li>#</li>
<li>#If there is more than one item on the $$found</li>
<li>#list, then find the rest of records tagged with</li>
<li>#this items/tags.</li>
<li>Loop</li>
<li>#</li>
<li>#When the list is empty stop finding stuff.</li>
<li>Exit Loop If [ ValueCount ( $findList ) = 0 ]</li>
<li>#</li>
<li>#Get the menu item name so system will know</li>
<li>#what field to put the ID number into to find</li>
<li>#records tagged with this item.</li>
<li>Set Variable [ $menu; Value:Left ( ( GetValue ( $findList ; 1 ) ) ; 1 ) ]</li>
<li>#</li>
<li>#Get the ID number of the tag to be found.</li>
<li>Set Variable [ $find; Value:Middle ( ( GetValue ( $findList ; 1 ) ) ; 2 ; 42 ) ]</li>
<li>#</li>
<li>#Remove it from the list of tags to be found.</li>
<li>Set Variable [ $subtract; Value:$findList ]</li>
<li>Set Variable [ $findList; Value:Substitute ( $subtract ; $menu &amp; $find &amp; &para; ; "" ) ]</li>
<li>#</li>
<li>#Find main window records tagged with it.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::kcsection; TEMP::ksection ]</li>
<li>Set Field [ reference::filterFind; "main" &amp; &para; ]</li>
<li>#</li>
<li>#</li>
<li>If [ $menu = "k" ]</li>
<li>Set Field [ reference::kkeywordPrimary; $find ]</li>
<li>Else If [ $menu = "n" ]</li>
<li>Set Field [ reference::knodePrimary; $find ]</li>
<li>Else If [ $menu = "m" ]</li>
<li>Set Field [ reference::kmedium; $find ]</li>
<li>Else If [ $menu = "h" ]</li>
<li>Set Field [ reference::kHealth; $find ]</li>
<li>Else If [ $menu = "p" ]</li>
<li>Set Field [ reference::kfolderpath; $find ]</li>
<li>Else If [ $menu = "o" ]</li>
<li>Set Field [ reference::korgan; $find ]</li>
<li>Else If [ $menu = "c" ]</li>
<li>Set Field [ reference::kcopyist; $find ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>Extend Found Set [  ]</li>
<li>End Loop</li>
<li>End If</li>
<li>#</li>
<li>#Sort according to current sort in Main window.</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>#</li>
<li>#Go to first record and preform record load script.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Perform Script [ &ldquo;loadCitation&rdquo; ]</li>
<li>#</li>
<li>#Return focus to Tag Menus window.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>#</li>
<li>#If no records where found tell user why and</li>
<li>#remove tag ID from list of tags attached to records</li>
<li>#in the main window.</li>
<li>If [ $error = 401 ]</li>
<li>If [ $$firstFind = "" ]</li>
<li>Set Variable [ $$foundOther ]</li>
<li>Else If [ $$firstFind &ne; "" ]</li>
<li>Set Variable [ $$foundOther; Value:Substitute ( $found ; $menu &amp; $tag &amp; &para; ; "" ) ]</li>
<li>End If</li>
<li>Refresh Window</li>
<li>#</li>
<li>#</li>
<li>If [ $$citationMatch = "key" ]</li>
<li>Show Custom Dialog [ Message: "'" &amp; $name &amp; "'" &amp; " is not in use as an other keyword."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Else If [ $$citationMatch = "node" ]</li>
<li>Show Custom Dialog [ Message: "'" &amp; $name &amp; "'" &amp; " is not in use as an other node."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>reference</em>::kcsection</li>
<li>
<em>reference</em>::filterFind</li>
<li>
<em>reference</em>::kkeywordOther</li>
<li>
<em>reference</em>::knodeOther</li>
<li>
<em>reference</em>::kkeywordPrimary</li>
<li>
<em>reference</em>::knodePrimary</li>
<li>
<em>reference</em>::kmedium</li>
<li>
<em>reference</em>::kHealth</li>
<li>
<em>reference</em>::kfolderpath</li>
<li>
<em>reference</em>::korgan</li>
<li>
<em>reference</em>::kcopyist</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32984ScriptAnchor_">loadCitation</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33223ScriptAnchor_"></a><td class="script_navbar"><a href="#33120ScriptAnchor_"><span>Previous Script: [findKeyOtherRef]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33222ScriptAnchor_"><span>Next Script: [lock]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">CHUNKcheckForDragPasteChanges</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33224ScriptAnchor_">testNameToRevertNamField</a></li>
<li><a href="#33007ScriptAnchor_">changeSpellingOfTagCategory</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#Used by script changeSpellingOfKeywordOrNodeTag</li>
<li>#</li>
<li>If [ Get (LayoutTableName) = "tagMenus" ]</li>
<li>#</li>
<li>#Exit any fields so do not get can't modify error message</li>
<li>#because record is in use in another window.</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Speed up script by stopping record load script.</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>#</li>
<li>#New window so user's window is not changed.</li>
<li>New Window [ Height: 1; Width: 1; Top: -1000; Left: -1000 ]</li>
<li>#</li>
<li>#Loop thru all records and make sure their spelling</li>
<li>#has not been changed, and if it has change it back</li>
<li>#to the way it was, unless the change was made in the</li>
<li>#field the user was just working on. </li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>If [ ruleTagMenuGroups::name &ne; ruleTagMenuGroups::nameSpelling and 
$$Tag &ne; ruleTagMenuGroups::_Lgroup and 
Get (LayoutName)  &ne; "setupTestItem" and 
Length ( ruleTagMenuGroups::match )  &lt;  12 ]</li>
<li>Set Field [ ruleTagMenuGroups::name; ruleTagMenuGroups::nameSpelling ]</li>
<li>End If</li>
<li>If [ ruleTagMenuTestGroups::name &ne; ruleTagMenuTestGroups::defaultSectionInfo and 

$$Tag &ne; ruleTagMenuTestGroups::_Lgroup  and 

Get (LayoutName) = "setupTestItem" and 

ruleTagMenuTestGroups::nameSpelling = "testItemGroup" ]</li>
<li>Set Field [ ruleTagMenuTestGroups::name; ruleTagMenuTestGroups::defaultSectionInfo ]</li>
<li>End If</li>
<li>If [ tagMenus::tag &ne; tagMenus::tagSpelling and $$Tag &ne; tagMenus::_Ltag and tagMenus::match = "node" or 
tagMenus::tag &ne; tagMenus::tagSpelling and $$Tag &ne; tagMenus::_Ltag and tagMenus::match = "key" or 
tagMenus::tag &ne; tagMenus::tagSpelling and $$Tag &ne; tagMenus::_Ltag and tagMenus::match = "testItem" ]</li>
<li>Set Field [ tagMenus::tag; tagMenus::tagSpelling ]</li>
<li>End If</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Start up record load script and close the window.</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Close Window [ Current Window ]</li>
<li>Else If [ Get (LayoutTableName) = "test" ]</li>
<li>#</li>
<li>#Exit any fields so do not get can't modify error message</li>
<li>#because record is in use in another window.</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Speed up script by stopping record load script.</li>
<li>Set Variable [ $$ID; Value:"ignore" ]</li>
<li>#</li>
<li>#New window so user's window is not changed.</li>
<li>New Window [ Height: 1; Width: 1; Top: -1000; Left: -1000 ]</li>
<li>#</li>
<li>#Loop thru all records and make sure their spelling</li>
<li>#has not been changed, and if it has change it back</li>
<li>#to the way it was, unless the change was made in the</li>
<li>#field the user was just working on. </li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>If [ groupTest::name &ne; groupTest::nameSpelling and $$GroupTag &ne; groupTest::_Lgroup and 

groupTest::match = "testGroup" ]</li>
<li>Set Field [ groupTest::name; groupTest::nameSpelling ]</li>
<li>End If</li>
<li>If [ test::testName &ne; test::testNameRevert and $$Tag &ne; test::_Ltest ]</li>
<li>Set Field [ test::testName; test::testNameRevert ]</li>
<li>End If</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Start up record load script and close the window.</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>If [ $$tag  &ne;  "" ]</li>
<li>Set Variable [ $$ID; Value:$$tag ]</li>
<li>End If</li>
<li>Close Window [ Current Window ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>ruleTagMenuGroups</em>::name</li>
<li>
<em>ruleTagMenuGroups</em>::nameSpelling</li>
<li>
<em>ruleTagMenuGroups</em>::_Lgroup</li>
<li>
<em>ruleTagMenuGroups</em>::match</li>
<li>
<em>ruleTagMenuTestGroups</em>::name</li>
<li>
<em>ruleTagMenuTestGroups</em>::defaultSectionInfo</li>
<li>
<em>ruleTagMenuTestGroups</em>::_Lgroup</li>
<li>
<em>ruleTagMenuTestGroups</em>::nameSpelling</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>tagMenus</em>::tagSpelling</li>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>tagMenus</em>::match</li>
<li>
<em>groupTest</em>::name</li>
<li>
<em>groupTest</em>::nameSpelling</li>
<li>
<em>groupTest</em>::_Lgroup</li>
<li>
<em>groupTest</em>::match</li>
<li>
<em>test</em>::testName</li>
<li>
<em>test</em>::testNameRevert</li>
<li>
<em>test</em>::_Ltest</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33222ScriptAnchor_"></a><td class="script_navbar"><a href="#33223ScriptAnchor_"><span>Previous Script: [CHUNKcheckForDragPasteChanges]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33226ScriptAnchor_"><span>Next Script: [checkForDraggedPasteChangesIfLocked]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">lock</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ nodeLockTagGroup::orderOrLock = "lock" ]</li>
<li>Go to Field [  ]</li>
<li>Show Custom Dialog [ Message: "Type the following into the box below to unlock all content created by " &amp; nodeLockTagGroup::tag; Buttons: &ldquo;OK&rdquo;, &ldquo;Cancel&rdquo; ]</li>
<li>Halt Script</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>nodeLockTagGroup</em>::orderOrLock</li>
<li>
<em>nodeLockTagGroup</em>::tag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33226ScriptAnchor_"></a><td class="script_navbar"><a href="#33222ScriptAnchor_"><span>Previous Script: [lock]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33227ScriptAnchor_"><span>Next Script: [insureEqualityOfSpellFields]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">checkForDraggedPasteChangesIfLocked</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Used on test setup layouts to revert any locked fields</li>
<li>#back to the original text.</li>
<li>If [ //Test setup window
nodeLockTest::orderOrLock &ne; "" or nodeLockTestGroup::orderOrLock &ne; "" and Get ( ActiveFieldName ) = "name" ]</li>
<li>Set Variable [ $lockedGroupName; Value:1 ]</li>
<li>Perform Script [ &ldquo;insureEqualityOfSpellFields&rdquo; ]</li>
<li>If [ nodeLockTest::orderOrLock  &ne;  "" ]</li>
<li>Show Custom Dialog [ Message: "This record is locked.  Go the node that created it -- " &amp; nodeLockTest::tag &amp; " -- and enter the password to unlock it."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>If [ $lockedGroupName = 1 ]</li>
<li>Show Custom Dialog [ Message: "This group name is locked.  Go the node that created it -- " &amp; nodeLockTestGroup::tag &amp; " -- and enter the password to unlock it."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Go to Field [  ]</li>
<li>Else If [ //Tag menus window 
ruleTagMenuGroups::order &ne; "" and ruleTagMenuGroups::match = "health"
or
tagMenus::orderOrLock = "lock" ]</li>
<li>#</li>
<li>#If record is locked by system...</li>
<li>If [ ruleTagMenuGroups::order &ne; "" and ruleTagMenuGroups::match = "health" and Get ( ActiveFieldName ) = "name"
or
tagMenus::orderOrLock = "lock" ]</li>
<li>Show Custom Dialog [ Message: "Record is locked by the system.  So you can look and copy text but any changes will be undone by the system."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Else If [ //Tag menus window 
nodeLockTestTagGroup::orderOrLock &ne; "" and Get ( ActiveFieldName ) = "name" and $$citationMatch  &ne;  "path"
//or nodeLockTagMenus::orderOrLock &ne; "" and Get ( ActiveFieldName ) = "tag" and $$citationMatch = "health"
or nodeLockTagMenus::orderOrLock &ne; "" and Get ( ActiveFieldName ) = "tag" and $$citationMatch = "node"
or nodeLockTagMenus::orderOrLock &ne; "" and Get ( ActiveFieldName ) = "tag" and $$citationMatch = "copyist"
or nodeLockTagMenus::orderOrLock &ne; "" and Get ( ActiveFieldName ) = "tag" and $$citationMatch = "sample"
or nodeLockTagMenus::orderOrLock &ne; "" and Get ( ActiveFieldName ) = "tag" and $$citationMatch = "organ"
or nodeLockTagMenus::orderOrLock &ne; "" and Get ( ActiveFieldName ) = "tag" and $$citationMatch = "testItem"
or nodeLockTagMenus::orderOrLock &ne; "" and Get ( ActiveFieldName ) = "tag" and $$citationMatch = "key" ]</li>
<li>Set Variable [ $lockedGroupName; Value:1 ]</li>
<li>Perform Script [ &ldquo;insureEqualityOfSpellFields&rdquo; ]</li>
<li>If [ nodeLockTagMenus::orderOrLock  &ne;  "" ]</li>
<li>Show Custom Dialog [ Message: "This record is locked.  Go the node that created it -- " &amp; nodeLockTagMenus::tag &amp; " -- and enter the password to unlock it."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>If [ $lockedGroupName = 1 ]</li>
<li>Show Custom Dialog [ Message: "This group name is locked.  Go the node that created it -- " &amp; nodeLockTestTagGroup::tag &amp; " -- and enter the password to unlock it."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Go to Field [  ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>nodeLockTest</em>::orderOrLock</li>
<li>
<em>nodeLockTestGroup</em>::orderOrLock</li>
<li>
<em>nodeLockTest</em>::tag</li>
<li>
<em>nodeLockTestGroup</em>::tag</li>
<li>
<em>ruleTagMenuGroups</em>::order</li>
<li>
<em>ruleTagMenuGroups</em>::match</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>nodeLockTestTagGroup</em>::orderOrLock</li>
<li>
<em>nodeLockTagMenus</em>::orderOrLock</li>
<li>
<em>nodeLockTagMenus</em>::tag</li>
<li>
<em>nodeLockTestTagGroup</em>::tag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33227ScriptAnchor_">insureEqualityOfSpellFields</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33227ScriptAnchor_"></a><td class="script_navbar"><a href="#33226ScriptAnchor_"><span>Previous Script: [checkForDraggedPasteChangesIfLocked]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33235ScriptAnchor_"><span>Next Script: [lockNodesRecords]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">insureEqualityOfSpellFields</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32920ScriptAnchor_">editSectionFocuses</a></li>
<li><a href="#33117ScriptAnchor_">menuSample</a></li>
<li><a href="#32999ScriptAnchor_">changeSpellingOfKeywordOrNodeTag</a></li>
<li><a href="#33226ScriptAnchor_">checkForDraggedPasteChangesIfLocked</a></li>
<li><a href="#33017ScriptAnchor_">removeTextFormattingAndCommas</a></li>
<li><a href="#32985ScriptAnchor_">backToLearnOrDefaultSetup</a></li>
<li><a href="#33130ScriptAnchor_">backFromSetup</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#</li>
<li>If [ $$stopTest   =   1 
//or $$citationMatch = "key"
//or $$citationMatch = "node"
//or $$citationMatch = "health"
or $$citationMatch = "path" ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>If [ Get (LayoutTableName) = "tagMenus" ]</li>
<li>#</li>
<li>#Exit any fields so do not get can't modify error message</li>
<li>#because record is in use in another window.</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Speed up script by stopping record load script.</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>Set Variable [ $$stopTest; Value:1 ]</li>
<li>#</li>
<li>#New window so user's window is not changed.</li>
<li>New Window [ Height: 1; Width: 1; Top: -1000; Left: -1000 ]</li>
<li>//  New Window [ Top: 1; Left: 1 ]</li>
<li>#</li>
<li>#Loop thru all records and make sure their spelling</li>
<li>#has not been changed, and if it has then change it back</li>
<li>#to the way it was, unless the change was made in the</li>
<li>#field the user was just working on. </li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>#Test group name.</li>
<li>If [ ruleTagMenuGroups::name &ne; ruleTagMenuGroups::nameSpelling 

and 

Get (LayoutTableName)  = "test" 

and 

nodeLockTagMenus::orderOrLock &ne; "" and 

ruleTagMenuGroups::match = "testGroup" ]</li>
<li>Set Field [ ruleTagMenuGroups::name; ruleTagMenuGroups::nameSpelling ]</li>
<li>End If</li>
<li>#Test item group name.</li>
<li>If [ ruleTagMenuTestGroups::name &ne; ruleTagMenuTestGroups::defaultSectionInfo 

and 

Get (LayoutTableName) &ne;  "test" 

and 

nodeLockTestTagGroup::orderOrLock &ne; "" and 

ruleTagMenuTestGroups::nameSpelling = "testItemGroup" ]</li>
<li>Set Field [ ruleTagMenuTestGroups::name; ruleTagMenuTestGroups::defaultSectionInfo ]</li>
<li>End If</li>
<li>#Sample group name.</li>
<li>If [ ruleTagMenuGroups::name &ne; ruleTagMenuGroups::nameSpelling 

and 

nodeLockTagGroup::orderOrLock &ne; ""

and

ruleTagMenuGroups::match = "sample" ]</li>
<li>Set Field [ ruleTagMenuGroups::name; ruleTagMenuGroups::nameSpelling ]</li>
<li>End If</li>
<li>#Health locked group name.</li>
<li>If [ ruleTagMenuGroups::name &ne; ruleTagMenuGroups::nameSpelling 

and 

ruleTagMenuGroups::order &ne; ""

and

ruleTagMenuGroups::match = "health" ]</li>
<li>Set Field [ ruleTagMenuGroups::name; ruleTagMenuGroups::nameSpelling ]</li>
<li>End If</li>
<li>//  #Allow user to change name of group, just not tag for:</li>
<li>#Sample, health, node, key, copyist, organ, testItem locked group name.</li>
<li>If [ ruleTagMenuGroups::name &ne; ruleTagMenuGroups::nameSpelling and nodeLockTagGroup::orderOrLock &ne; "" and ruleTagMenuGroups::match = "node"
 or ruleTagMenuGroups::name &ne; ruleTagMenuGroups::nameSpelling and nodeLockTagGroup::orderOrLock &ne; "" and ruleTagMenuGroups::match = "key"
 or ruleTagMenuGroups::name &ne; ruleTagMenuGroups::nameSpelling and nodeLockTagGroup::orderOrLock &ne; "" and ruleTagMenuGroups::match = "sample"
 or ruleTagMenuGroups::name &ne; ruleTagMenuGroups::nameSpelling and nodeLockTagGroup::orderOrLock &ne; "" and ruleTagMenuGroups::match = "copyist"
 or ruleTagMenuGroups::name &ne; ruleTagMenuGroups::nameSpelling and nodeLockTagGroup::orderOrLock &ne; "" and ruleTagMenuGroups::match = "organ"
 or ruleTagMenuGroups::name &ne; ruleTagMenuGroups::nameSpelling and nodeLockTagGroup::orderOrLock &ne; "" and ruleTagMenuGroups::match = "testItem" ]</li>
<li>Set Field [ ruleTagMenuGroups::name; ruleTagMenuGroups::nameSpelling ]</li>
<li>End If</li>
<li>#Sample, health, node, key, copyist, organ, testItem tag names.</li>
<li>If [ tagMenus::tag &ne; tagMenus::tagSpelling and nodeLockTagMenus::orderOrLock &ne; "" and tagMenus::match = "testItem"
 or tagMenus::tag &ne; tagMenus::tagSpelling and nodeLockTagMenus::orderOrLock &ne; "" and tagMenus::match = "sample"
 or tagMenus::tag &ne; tagMenus::tagSpelling and nodeLockTagMenus::orderOrLock &ne; "" and tagMenus::match = "health" 
 or tagMenus::tag &ne; tagMenus::tagSpelling and nodeLockTagMenus::orderOrLock &ne; "" and tagMenus::match = "organ"
 or tagMenus::tag &ne; tagMenus::tagSpelling and nodeLockTagMenus::orderOrLock &ne; "" and tagMenus::match = "node"
 or tagMenus::tag &ne; tagMenus::tagSpelling and nodeLockTagMenus::orderOrLock &ne; "" and tagMenus::match = "copyist"
 or tagMenus::tag &ne; tagMenus::tagSpelling and nodeLockTagMenus::orderOrLock &ne; "" and tagMenus::match = "key" ]</li>
<li>Set Field [ tagMenus::tag; tagMenus::tagSpelling ]</li>
<li>End If</li>
<li>#Locked by system health tags.</li>
<li>If [ tagMenus::orderOrLock &ne; "" and tagMenus::match = "health" ]</li>
<li>Set Field [ tagMenus::tag; tagMenus::tagSpelling ]</li>
<li>End If</li>
<li>#</li>
<li>#But if node is not locked, then apply changes to field.</li>
<li>#Group name.</li>
<li>If [ ruleTagMenuGroups::name &ne; ruleTagMenuGroups::nameSpelling 

and 

Get (LayoutTableName)   =  "test" 

 and 

nodeLockTagMenus::orderOrLock = "" and 

ruleTagMenuGroups::match = "testGroup" ]</li>
<li>Set Field [ ruleTagMenuGroups::nameSpelling; ruleTagMenuGroups::name ]</li>
<li>End If</li>
<li>#Test item group name.</li>
<li>If [ ruleTagMenuTestGroups::name &ne; ruleTagMenuTestGroups::defaultSectionInfo and 


Get (LayoutTableName)  &ne;  "test" 

 and 

nodeLockTagMenus::orderOrLock = "" and 

ruleTagMenuTestGroups::nameSpelling = "testItemGroup" ]</li>
<li>Set Field [ ruleTagMenuTestGroups::defaultSectionInfo; ruleTagMenuTestGroups::name ]</li>
<li>End If</li>
<li>#Sample group name.</li>
<li>If [ ruleTagMenuGroups::name &ne; ruleTagMenuGroups::nameSpelling

and 

nodeLockTagGroup::orderOrLock = ""

and

ruleTagMenuGroups::match = "sample" ]</li>
<li>Set Field [ ruleTagMenuGroups::nameSpelling; ruleTagMenuGroups::name ]</li>
<li>End If</li>
<li>#Sample, health, node, copyist, organ, testItem, key, tag names.</li>
<li>If [ tagMenus::tag &ne; tagMenus::tagSpelling and nodeLockTagMenus::orderOrLock = "" and tagMenus::match = "testItem"
 or tagMenus::tag &ne; tagMenus::tagSpelling and nodeLockTagMenus::orderOrLock = "" and tagMenus::match = "sample"
 or tagMenus::tag &ne; tagMenus::tagSpelling and nodeLockTagMenus::orderOrLock = "" and tagMenus::match = "health"
 or tagMenus::tag &ne; tagMenus::tagSpelling and nodeLockTagMenus::orderOrLock = "" and tagMenus::match = "organ"
 or tagMenus::tag &ne; tagMenus::tagSpelling and nodeLockTagMenus::orderOrLock = "" and tagMenus::match = "copyist"
 or tagMenus::tag &ne; tagMenus::tagSpelling and nodeLockTagMenus::orderOrLock = "" and tagMenus::match = "node"
 or tagMenus::tag &ne; tagMenus::tagSpelling and nodeLockTagMenus::orderOrLock = "" and tagMenus::match = "key" ]</li>
<li>Set Field [ tagMenus::tagSpelling; tagMenus::tag ]</li>
<li>End If</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Start up record load script and close the window.</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Close Window [ Current Window ]</li>
<li>Else If [ Get (LayoutTableName) = "test" ]</li>
<li>#</li>
<li>#Exit any fields so do not get can't modify error message</li>
<li>#because record is in use in another window.</li>
<li>#But first set this stop variable, so if locked field is</li>
<li>#is a group name field its name will not be changed.</li>
<li>Set Variable [ $$stopChangeName; Value:1 ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Speed up script by stopping record load script.</li>
<li>Set Variable [ $$ID; Value:"ignore" ]</li>
<li>Set Variable [ $$stopTest; Value:1 ]</li>
<li>#</li>
<li>#New window so user's window is not changed.</li>
<li>New Window [ Height: 1; Width: 1; Top: -1000; Left: -1000 ]</li>
<li>#</li>
<li>#Loop thru all records and make sure their spelling</li>
<li>#has not been changed, and if it has change it back</li>
<li>#to the way it was, unless the change was made in the</li>
<li>#field the user was just working on. </li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>#Test group name.</li>
<li>If [ groupTest::name &ne; groupTest::nameSpelling and nodeLockTestGroup::orderOrLock &ne; "" and 

groupTest::match = "testGroup" ]</li>
<li>Set Field [ groupTest::name; groupTest::nameSpelling ]</li>
<li>End If</li>
<li>#Test name.</li>
<li>If [ test::testName &ne; test::testNameRevert and nodeLockTest::orderOrLock &ne; "" ]</li>
<li>Set Field [ test::testName; test::testNameRevert ]</li>
<li>End If</li>
<li>If [ test::testName &ne; test::testNameRevert and nodeLockTest::orderOrLock = "" ]</li>
<li>Set Field [ test::testNameRevert; test::testName ]</li>
<li>End If</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Start up record load script and close the window.</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Close Window [ Current Window ]</li>
<li>Else If [ Get (LayoutTableName) = "tagLocation" ]</li>
<li>#</li>
<li>#Exit any fields so do not get can't modify error message</li>
<li>#because record is in use in another window.</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Speed up script by stopping record load script.</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>Set Variable [ $$stopTest; Value:1 ]</li>
<li>#</li>
<li>#New window so user's window is not changed.</li>
<li>New Window [ Height: 1; Width: 1; Top: -1000; Left: -1000 ]</li>
<li>#</li>
<li>#Loop thru all records and make sure their spelling</li>
<li>#has not been changed, and if it has then change it back</li>
<li>#to the way it was, unless the change was made in the</li>
<li>#field the user was just working on. </li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>If [ tagLocation::tag &ne; tagLocation::tagSpelling and nodeLockTest::orderOrLock &ne; "" and tagLocation::match = "focus" ]</li>
<li>Set Field [ tagLocation::tag; tagLocation::tagSpelling ]</li>
<li>End If</li>
<li>#</li>
<li>#But if node is not locked, then apply changes to field.</li>
<li>If [ tagLocation::tag &ne; tagLocation::tagSpelling and nodeLockTest::orderOrLock = "" and tagLocation::match = "focus" ]</li>
<li>Set Field [ tagLocation::tagSpelling; tagLocation::tag ]</li>
<li>End If</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Start up record load script and close the window.</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Close Window [ Current Window ]</li>
<li>End If</li>
<li>Set Variable [ $$stopTest ]</li>
<li>Set Variable [ $$ID ]</li>
<li>Perform Script [ &ldquo;loadSetupTestRecord&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>ruleTagMenuGroups</em>::name</li>
<li>
<em>ruleTagMenuGroups</em>::nameSpelling</li>
<li>
<em>nodeLockTagMenus</em>::orderOrLock</li>
<li>
<em>ruleTagMenuGroups</em>::match</li>
<li>
<em>ruleTagMenuTestGroups</em>::name</li>
<li>
<em>ruleTagMenuTestGroups</em>::defaultSectionInfo</li>
<li>
<em>nodeLockTestTagGroup</em>::orderOrLock</li>
<li>
<em>ruleTagMenuTestGroups</em>::nameSpelling</li>
<li>
<em>nodeLockTagGroup</em>::orderOrLock</li>
<li>
<em>ruleTagMenuGroups</em>::order</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>tagMenus</em>::tagSpelling</li>
<li>
<em>tagMenus</em>::match</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>groupTest</em>::name</li>
<li>
<em>groupTest</em>::nameSpelling</li>
<li>
<em>nodeLockTestGroup</em>::orderOrLock</li>
<li>
<em>groupTest</em>::match</li>
<li>
<em>test</em>::testName</li>
<li>
<em>test</em>::testNameRevert</li>
<li>
<em>nodeLockTest</em>::orderOrLock</li>
<li>
<em>tagLocation</em>::tag</li>
<li>
<em>tagLocation</em>::tagSpelling</li>
<li>
<em>tagLocation</em>::match</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32930ScriptAnchor_">loadSetupTestRecord</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33235ScriptAnchor_"></a><td class="script_navbar"><a href="#33227ScriptAnchor_"><span>Previous Script: [insureEqualityOfSpellFields]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33238ScriptAnchor_"><span>Next Script: [sampleExit]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">lockNodesRecords</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Capture the password for comparrison and to return</li>
<li>#the password field back to if the user fails to get the</li>
<li>#password right.</li>
<li>Set Variable [ $password; Value:tagMenus::orderOrLock ]</li>
<li>Set Field [ TEMP::nodeLock; "" ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#If there is a password, ask user to enter it.</li>
<li>If [ tagMenus::orderOrLock &ne; "" ]</li>
<li>Loop</li>
<li>Show Custom Dialog [ Message: "Enter the password to unlock this nodes records."; Buttons: &ldquo;enter&rdquo;, &ldquo;cancel&rdquo;; Input #1: TEMP::nodeLock, Password ]</li>
<li>If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Set Field [ TEMP::nodeLock; "" ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>If [ $password = TEMP::nodeLock ]</li>
<li>Show Custom Dialog [ Message: "unlocked"; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Set Field [ tagMenus::orderOrLock; "" ]</li>
<li>Set Field [ TEMP::nodeLock; "" ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>End Loop</li>
<li>#</li>
<li>#If there is no password, ask user to create one.</li>
<li>Else If [ tagMenus::orderOrLock = "" ]</li>
<li>Set Field [ TEMP::nodeLock; "" ]</li>
<li>Show Custom Dialog [ Message: "Enter a password to lock this node's records.  WARNING: If you can't remember this password, your records will remain locked."; Buttons: &ldquo;enter&rdquo;, &ldquo;cancel&rdquo;; Input #1: tagMenus::orderOrLock, Password, "password"; Input #2: TEMP::nodeLock, Password, "confirm password" ]</li>
<li>If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Set Field [ tagMenus::orderOrLock; "" ]</li>
<li>End If</li>
<li>Loop</li>
<li>If [ tagMenus::orderOrLock &ne; TEMP::nodeLock ]</li>
<li>Show Custom Dialog [ Message: "Passwords did not match."; Buttons: &ldquo;enter&rdquo;, &ldquo;cancel&rdquo;; Input #1: tagMenus::orderOrLock, Password, "password"; Input #2: TEMP::nodeLock, Password, "confirm password" ]</li>
<li>If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Set Field [ tagMenus::orderOrLock; "" ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>End If</li>
<li>Exit Loop If [ tagMenus::orderOrLock = TEMP::nodeLock ]</li>
<li>End Loop</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>TEMP</em>::nodeLock</li>
<li>&lt;Missing Field&gt;</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33238ScriptAnchor_"></a><td class="script_navbar"><a href="#33235ScriptAnchor_"><span>Previous Script: [lockNodesRecords]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#32968ScriptAnchor_"><span>Next Script: [newTag]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">sampleExit</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ $$citationMatch = "sample"  and $$findMode = "" or 
$$citationmatch = "test" and $$findMode = "" ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32968ScriptAnchor_"></a><td class="script_navbar"><a href="#33238ScriptAnchor_"><span>Previous Script: [sampleExit]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33129ScriptAnchor_"><span>Next Script: [sortTLRecordsByOrderNumber]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">newTag</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Variable [ $library; Value:tagTable::ksection ]</li>
<li>Set Variable [ $rule; Value:tagTable::kGroupOrTest ]</li>
<li>New Record/Request</li>
<li>Set Field [ tagTable::ksection; $library ]</li>
<li>Set Field [ tagTable::kGroupOrTest; $rule ]</li>
<li>Go to Field [ tagTable::tag ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagTable</em>::ksection</li>
<li>
<em>tagTable</em>::kGroupOrTest</li>
<li>
<em>tagTable</em>::tag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33129ScriptAnchor_"></a><td class="script_navbar"><a href="#32968ScriptAnchor_"><span>Previous Script: [newTag]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"><a href="#33148ScriptAnchor_"><span>Next Script: [changeTLRecordsSort_Button]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">sortTLRecordsByOrderNumber</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33117ScriptAnchor_">menuSample</a></li>
<li><a href="#33127ScriptAnchor_">loadItemRecordForTestTagMenu</a></li>
<li><a href="#33219ScriptAnchor_">loadItemRecordForSampleTagMenu</a></li>
<li><a href="#32987ScriptAnchor_">addTagToMainRecord</a></li>
<li><a href="#33148ScriptAnchor_">changeTLRecordsSort_Button</a></li>
<li><a href="#33126ScriptAnchor_">loadItemRecordForLearnTagMenuDELETE!!!</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Perform script for sample and test tags only.</li>
<li>If [ $$citationMatch = "sample" or $$citationMatch = "test"
 or 
Left ( Get (LayoutName) ; 4 ) = "test" ]</li>
<li>#</li>
<li>#Make a key for the current record's lock so after</li>
<li>#this sort is complete the system can go back to</li>
<li>#this record.</li>
<li>Set Variable [ $recordKey; Value:testlearn::_Ltestlearn ]</li>
<li>#</li>
<li>#Turn off the loadcitation script to speed up the </li>
<li>#loop portion of the script.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>#</li>
<li>#Check if the user does or does not want sample</li>
<li>#test learn table records sorted by order number.</li>
<li>#If they do (the tlsamplesort is blank) then sort</li>
<li>#by order number.</li>
<li>If [ TEMP::TLSampleSort = "order" and $$citationMatch = "sample" ]</li>
<li>#</li>
<li>#Set the tlsamplesort field with a 1.  Now if user</li>
<li>#clicks the sort button it will be because they </li>
<li>#now want the records sorted by date.</li>
<li>Set Field [ TEMP::TLSampleSort; 1 ]</li>
<li>#</li>
<li>#To speed up the process, sort to the top the records</li>
<li>#that have ksample numbers.  Do not loop thru</li>
<li>#records whose ksample records are blank.</li>
<li>Sort Records [ Specified Sort Order: testlearn::kcsample; descending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#Go the first record.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>#Check the sample key fields if in sample mode.</li>
<li>If [ $$citationMatch = "sample" ]</li>
<li>Loop</li>
<li>#The first step is to blank or clear each record's</li>
<li>#order field, so only those records that are part</li>
<li>#of the current sample or test will have order numbers</li>
<li>#and be part of the sort coming right after this</li>
<li>#assignment of sort order numbers.</li>
<li>Set Field [ testlearn::orderTest; "" ]</li>
<li>Exit Loop If [ testlearn::kcsample = "" ]</li>
<li>#</li>
<li>#The order number is the left three digits of a</li>
<li>#sample or test record lock number.  ( Remember</li>
<li>#each record in the database has lock number or</li>
<li>#ID number.  To open the lock and see any record's</li>
<li>#contents requires a key number that fits the lock.</li>
<li>#So if a lock number is 123, then the key that will</li>
<li>#fit this lock is 123 too. )  Because the sample </li>
<li>#and test key fields (think of key chains) may </li>
<li>#have several keys, because any one learn record</li>
<li>#may be part of more than one sample or test. </li>
<li>#the system must check each learn record's keys</li>
<li>#one at a time to see if any fit the current sample</li>
<li>#or test's lock.  So beginning with number one</li>
<li>#the system checks each key.  The left most 3 numbers</li>
<li>#are order numbers so below you will note that </li>
<li>#they system starts the check on the 4th number</li>
<li>#from the left.</li>
<li>Set Variable [ $number; Value:1 ]</li>
<li>Go to Field [  ]</li>
<li>Loop</li>
<li>#</li>
<li>If [ Middle ( GetValue ( testlearn::kcsample ; $number ) ; 4 ; 42 )  &amp; "&para;"   = $$tagSample &amp; &para; ]</li>
<li>#</li>
<li>#When and if a key is found that fits the current</li>
<li>#sample or test record's lock, the order number</li>
<li>#( left most 3 digits ) is caputred and placed in </li>
<li>#in the order field.</li>
<li>Set Field [ testlearn::orderTest; Left ( GetValue ( testlearn::kcsample ; $number ) ; 3  ) ]</li>
<li>#</li>
<li>#The 'number' variable is made blank to trigger</li>
<li>#the exit from this loop, the order number having</li>
<li>#been assigned.</li>
<li>Set Variable [ $number ]</li>
<li>//  Else If [ Middle ( GetValue ( testlearn::kcsample ; $number ) ; 4 ; 42 )  &amp; "&para;"  &ne; $$tagSample &amp; &para; ]</li>
<li>//  Set Field [ testlearn::orderTest; "" ]</li>
<li>End If</li>
<li>Exit Loop If [ $number = "" ]</li>
<li>#</li>
<li>#Exit loop if the current record is not part</li>
<li>#of the selected sample or test after checking</li>
<li>#all of its keys.</li>
<li>Exit Loop If [ GetValue ( testlearn::kcsample ; $number )  = "" ]</li>
<li>#</li>
<li>#Add 1 to the 'number' varaible after each key</li>
<li>#in the key field is checked, to direct the system</li>
<li>#to check the next key.</li>
<li>Set Variable [ $add; Value:$number ]</li>
<li>Set Variable [ $number; Value:$add + 1 ]</li>
<li>End Loop</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>End If</li>
<li>#</li>
<li>#Sort the records by order field.</li>
<li>Sort Records [ Specified Sort Order: testlearn::orderTest; based on value list: &ldquo;order&rdquo;
testlearn::timestamp; descending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#Return focus to record user was focused on at</li>
<li>#the start of this script.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Loop</li>
<li>Exit Loop If [ $recordkey = testlearn::_Ltestlearn ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Turn loadcitation script back on and exit script.</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#Check if the user does or does not want test</li>
<li>#test learn table records sorted by order number.</li>
<li>#If they do (the tlsampletest is blank) then sort</li>
<li>#by order number.</li>
<li>If [ TEMP::TLTestSort = "order" and $$citationMatch = "test" ]</li>
<li>#</li>
<li>#To speed up the process, sort to the top the records</li>
<li>#that have ksample numbers.  Do not loop thru</li>
<li>#records whose ksample records are blank.</li>
<li>Sort Records [ Specified Sort Order: testlearn::kctest; descending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#Go the first record.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>#Check the test key fields if in sample mode.</li>
<li>If [ $$citationMatch = "test" ]</li>
<li>Loop</li>
<li>#</li>
<li>#The first step is to blank or clear each record's</li>
<li>#order field, so only those records that are part</li>
<li>#of the current sample or test will have order numbers</li>
<li>#and be part of the sort coming right after this</li>
<li>#assignment of sort order numbers.</li>
<li>Set Field [ testlearn::orderTest; "" ]</li>
<li>Exit Loop If [ testlearn::kctest = "" ]</li>
<li>#</li>
<li>#The order number is the left three digits of a</li>
<li>#sample or test record lock number.  ( Remember</li>
<li>#each record in the database has lock number or</li>
<li>#ID number.  To open the lock and see any record's</li>
<li>#contents requires a key number that fits the lock.</li>
<li>#So if a lock number is 123, then the key that will</li>
<li>#fit this lock is 123 too. )  Because the sample </li>
<li>#and test key fields (think of key chains) may </li>
<li>#have several keys, because any one learn record</li>
<li>#may be part of more than one sample or test. </li>
<li>#the system must check each learn record's keys</li>
<li>#one at a time to see if any fit the current sample</li>
<li>#or test's lock.  So beginning with number one</li>
<li>#the system checks each key.  The left most 3 numbers</li>
<li>#are order numbers so below you will note that </li>
<li>#they system starts the check on the 4th number</li>
<li>#from the left.</li>
<li>Set Variable [ $number; Value:1 ]</li>
<li>Go to Field [  ]</li>
<li>Loop</li>
<li>If [ Middle ( GetValue ( testlearn::kctest ; $number ) ; 4 ; 42 )  &amp; "&para;"   = $$tagtest &amp; &para; ]</li>
<li>#</li>
<li>#When and if a key is found that fits the current</li>
<li>#sample or test record's lock, the order number</li>
<li>#( left most 3 digits ) is caputred and placed in </li>
<li>#in the order field.</li>
<li>Set Field [ testlearn::orderTest; Left ( GetValue ( testlearn::kctest ; $number ) ; 3  ) ]</li>
<li>#</li>
<li>#The 'number' variable is made blank to trigger</li>
<li>#the exit from this loop, the order number having</li>
<li>#been assigned.</li>
<li>Set Variable [ $number ]</li>
<li>End If</li>
<li>Exit Loop If [ $number = "" ]</li>
<li>#</li>
<li>#Exit loop if the current record is not part</li>
<li>#of the selected sample or test after checking</li>
<li>#all of its keys.</li>
<li>Exit Loop If [ GetValue ( testlearn::kctest ; $number )  = "" ]</li>
<li>#</li>
<li>#Add 1 to the 'number' varaible after each key</li>
<li>#in the key field is checked, to direct the system</li>
<li>#to check the next key.</li>
<li>Set Variable [ $add; Value:$number ]</li>
<li>Set Variable [ $number; Value:$add + 1 ]</li>
<li>End Loop</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>End If</li>
<li>#</li>
<li>#Sort the records by order field.</li>
<li>Sort Records [ Specified Sort Order: testlearn::orderTest; based on value list: &ldquo;order&rdquo;
testlearn::timestamp; descending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#Return focus to record user was focused on at</li>
<li>#the start of this script.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Loop</li>
<li>Exit Loop If [ $recordkey = testlearn::_Ltestlearn ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Turn loadcitation script back on and exit script.</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearn</em>::_Ltestlearn</li>
<li>
<em>TEMP</em>::TLSampleSort</li>
<li>
<em>testlearn</em>::kcsample</li>
<li>
<em>testlearn</em>::orderTest</li>
<li>
<em>testlearn</em>::timestamp</li>
<li>
<em>TEMP</em>::TLTestSort</li>
<li>
<em>testlearn</em>::kctest</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33148ScriptAnchor_"></a><td class="script_navbar"><a href="#33129ScriptAnchor_"><span>Previous Script: [sortTLRecordsByOrderNumber]</span></a></td><td class="script_navbar"><a href="#33307ScriptAnchor_"><span>Parent Folder: [tagMenu]</span></a></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">changeTLRecordsSort_Button</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Perform script for sample and test tags only.</li>
<li>If [ $$citationMatch = "sample"  and $$findMode = "" or 
$$citationmatch = "test" and $$findMode = "" ]</li>
<li>#</li>
<li>#If current sort is by date, then sort records by</li>
<li>#order number.</li>
<li>If [ TEMP::TLTestSort = "" and $$citationMatch = "test" ]</li>
<li>Set Field [ TEMP::TLTestSort; "order" ]</li>
<li>Perform Script [ &ldquo;sortTLRecordsByOrderNumber&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ TEMP::TLSampleSort = "" and $$citationMatch = "sample" ]</li>
<li>Set Field [ TEMP::TLSampleSort; "order" ]</li>
<li>Perform Script [ &ldquo;sortTLRecordsByOrderNumber&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Set Field [ TEMP::TLTestSort; "" ]</li>
<li>#</li>
<li>#Sort the records by date field, if current sort is</li>
<li>#by order number.</li>
<li>Sort Records [ Specified Sort Order: testlearn::date; descending
testlearn::timestamp; descending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#Set the sort preference field to date.</li>
<li>If [ $$citationMatch = "sample" ]</li>
<li>Set Field [ TEMP::TLSampleSort; "" ]</li>
<li>Else If [ $$citationMatch = "test" ]</li>
<li>Set Field [ TEMP::TLTestSort; "" ]</li>
<li>End If</li>
<li>#</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::TLTestSort</li>
<li>
<em>TEMP</em>::TLSampleSort</li>
<li>
<em>testlearn</em>::date</li>
<li>
<em>testlearn</em>::timestamp</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33129ScriptAnchor_">sortTLRecordsByOrderNumber</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<p>
<span class="partheading"><a name="33329ScriptAnchor_"></a><a href="#33329ScriptAnchor_toc">probablyNotInUse</a></span>
</p>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33126ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"><a href="#33329ScriptAnchor_"><span>Parent Folder: [probablyNotInUse]</span></a></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">loadItemRecordForLearnTagMenuDELETE!!!</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33280ScriptAnchor_">loadCitation OLD</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#Capture recordID to conditionally format current record.</li>
<li>If [ $$stopLoadTagRecord &ne; 1 ]</li>
<li>If [ $$citationMatch = "sample" ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#The 'sample' variable may have more than one</li>
<li>#key in it.  So we need a variable with just this</li>
<li>#records keys in it to conditionally formatt all </li>
<li>#learn window records tagged with it.</li>
<li>Set Variable [ $$tagSample; Value:tagMenus::_Ltag ]</li>
<li>Set Variable [ $$SampleOrTestID; Value:Get (RecordID) ]</li>
<li>If [ $$add = 1 and $$citationMatch = $$addCitationMatch ]</li>
<li>Else If [ $$add = "" ]</li>
<li>End If</li>
<li>Refresh Window</li>
<li>#</li>
<li>#Just in case user was in nonTag field on this</li>
<li>#window when user clicked a menu button on </li>
<li>#the other window, exit all  fields.</li>
<li>If [ TEMP::TLSampleSort = "" ]</li>
<li>Set Variable [ $recordNumber; Value:Get (RecordNumber) ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Perform Script [ &ldquo;sortTLRecordsByOrderNumber&rdquo; ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Go to Record/Request/Page [ $recordNumber ]
[ No dialog ]</li>
<li>Set Variable [ $$tagSample; Value:tagMenus::_Ltag ]</li>
<li>Set Field [ TEMP::TLSampleSort; "" ]</li>
<li>End If</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>If [ TEMP::TLSampleSort = 1 ]</li>
<li>Set Field [ TEMP::TLSampleSort; "" ]</li>
<li>Perform Script [ &ldquo;sortTLRecordsByOrderNumber&rdquo; ]</li>
<li>End If</li>
<li>Go to Field [  ]</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>End If</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>TEMP</em>::TLSampleSort</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33129ScriptAnchor_">sortTLRecordsByOrderNumber</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<p>
<span class="partheading"><a name="33311ScriptAnchor_"></a><a href="#33311ScriptAnchor_toc">menuFind</a></span>
</p>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33118ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"><a href="#33311ScriptAnchor_"><span>Parent Folder: [menuFind]</span></a></td><td class="script_navbar"><a href="#33102ScriptAnchor_"><span>Next Script: [menuNodeFind]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">menuSampleFind</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Set citationMatch to color menu button with inUse color.</li>
<li>Set Variable [ $$citationMatch; Value:"sample" ]</li>
<li>#</li>
<li>#Goto correct layout.</li>
<li>If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>Go to Layout [ &ldquo;learnFindSample&rdquo; (tagMenus) ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;learnFindStuffSample&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "r" ]</li>
<li>Go to Layout [ &ldquo;learnFindSample&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>#</li>
<li>#Find medium tags.  Medium tags are available to all library sections.</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::match; $$citationMatch ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; "==" &amp; TEMP::ksection ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Sort according to current users wishes.  By default</li>
<li>#the sort will be by category which is set by editCitation script.</li>
<li>If [ TEMP::sortSample = "cat" or TEMP::sortSample = "" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ TEMP::sortSample = "abc" ]</li>
<li>Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::InventoryLibaryYN</li>
<li>
<em>tagMenus</em>::match</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>ruleTagMenuGroups</em>::ksection</li>
<li>
<em>TEMP</em>::sortSample</li>
<li>
<em>ruleTagMenuGroups</em>::order</li>
<li>
<em>ruleTagMenuGroups</em>::name</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>tagMenus</em>::tag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>learnFindSample</li>
<li>learnFindStuffSample</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33102ScriptAnchor_"></a><td class="script_navbar"><a href="#33118ScriptAnchor_"><span>Previous Script: [menuSampleFind]</span></a></td><td class="script_navbar"><a href="#33311ScriptAnchor_"><span>Parent Folder: [menuFind]</span></a></td><td class="script_navbar"><a href="#33103ScriptAnchor_"><span>Next Script: [menuKeyFind]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">menuNodeFind</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Set citationMatch to color menu button with inUse color.</li>
<li>Set Variable [ $$citationMatch; Value:"node" ]</li>
<li>#</li>
<li>#Do not load tag records until the end of script</li>
<li>#to prevent flashing of window and to speed up</li>
<li>#script.</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>#</li>
<li>#Goto correct layout.</li>
<li>If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>Go to Layout [ &ldquo;learnKeywordOrNodeFind&rdquo; (tagMenus) ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;learnKeywordOrNodeSFind&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "r" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenu2keywordOrNodeFind&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>#</li>
<li>#Find node tags. </li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::match; $$citationMatch ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; "==" &amp; TEMP::ksection ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Sort according to current users wishes.  By default</li>
<li>#the sort will be by category which is set by editCitation script.</li>
<li>If [ TEMP::sortNode = "cat" or TEMP::sortNode = "" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ TEMP::sortNode = "abc" ]</li>
<li>Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::InventoryLibaryYN</li>
<li>
<em>tagMenus</em>::match</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>ruleTagMenuGroups</em>::ksection</li>
<li>
<em>TEMP</em>::sortNode</li>
<li>
<em>ruleTagMenuGroups</em>::order</li>
<li>
<em>ruleTagMenuGroups</em>::name</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>tagMenus</em>::tag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>learnKeywordOrNodeFind</li>
<li>learnKeywordOrNodeSFind</li>
<li>ReferenceMenu2keywordOrNodeFind</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33103ScriptAnchor_"></a><td class="script_navbar"><a href="#33102ScriptAnchor_"><span>Previous Script: [menuNodeFind]</span></a></td><td class="script_navbar"><a href="#33311ScriptAnchor_"><span>Parent Folder: [menuFind]</span></a></td><td class="script_navbar"><a href="#33105ScriptAnchor_"><span>Next Script: [menuHealthFind]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">menuKeyFind</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Set citationMatch to color menu button with inUse color.</li>
<li>Set Variable [ $$citationMatch; Value:"key" ]</li>
<li>#</li>
<li>#Do not load tag records until the end of script</li>
<li>#to prevent flashing of window and to speed up</li>
<li>#script.</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>#</li>
<li>#Goto correct layout.</li>
<li>If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>Go to Layout [ &ldquo;learnKeywordOrNodeFind&rdquo; (tagMenus) ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;learnKeywordOrNodeSFind&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "r" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenu2keywordOrNodeFind&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>#</li>
<li>#Find key tags for library section.  </li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::match; $$citationMatch ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; "==" &amp; TEMP::ksection ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Sort according to current users wishes.  By default</li>
<li>#the sort will be by category which is set by editCitation script.</li>
<li>If [ TEMP::sortKey = "cat" or TEMP::sortKey = "" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ TEMP::sortKey = "abc" ]</li>
<li>Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::InventoryLibaryYN</li>
<li>
<em>tagMenus</em>::match</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>ruleTagMenuGroups</em>::ksection</li>
<li>
<em>TEMP</em>::sortKey</li>
<li>
<em>ruleTagMenuGroups</em>::order</li>
<li>
<em>ruleTagMenuGroups</em>::name</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>tagMenus</em>::tag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>learnKeywordOrNodeFind</li>
<li>learnKeywordOrNodeSFind</li>
<li>ReferenceMenu2keywordOrNodeFind</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33105ScriptAnchor_"></a><td class="script_navbar"><a href="#33103ScriptAnchor_"><span>Previous Script: [menuKeyFind]</span></a></td><td class="script_navbar"><a href="#33311ScriptAnchor_"><span>Parent Folder: [menuFind]</span></a></td><td class="script_navbar"><a href="#33107ScriptAnchor_"><span>Next Script: [menuTestFind]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">menuHealthFind</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Set citationMatch to color menu button with inUse color.</li>
<li>Set Variable [ $$citationMatch; Value:"health" ]</li>
<li>#</li>
<li>#Goto correct layout.</li>
<li>If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>Go to Layout [ &ldquo;learnFind&rdquo; (tagMenus) ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;learnSFind&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "r" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenuFind&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>#</li>
<li>#Find Permission tags.  Permission tags are available to all library sections.</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::match; $$citationMatch ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Sort according to current users wishes.  By default</li>
<li>#the sort will be by category which is set by editCitation script.</li>
<li>If [ TEMP::sortHealth = "cat" or TEMP::sortHealth = "" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ TEMP::sortHealth = "abc" ]</li>
<li>Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::InventoryLibaryYN</li>
<li>
<em>tagMenus</em>::match</li>
<li>
<em>TEMP</em>::sortHealth</li>
<li>
<em>ruleTagMenuGroups</em>::order</li>
<li>
<em>ruleTagMenuGroups</em>::name</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>tagMenus</em>::tag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>learnFind</li>
<li>learnSFind</li>
<li>ReferenceMenuFind</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33107ScriptAnchor_"></a><td class="script_navbar"><a href="#33105ScriptAnchor_"><span>Previous Script: [menuHealthFind]</span></a></td><td class="script_navbar"><a href="#33311ScriptAnchor_"><span>Parent Folder: [menuFind]</span></a></td><td class="script_navbar"><a href="#33106ScriptAnchor_"><span>Next Script: [menuMediumFind]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">menuTestFind</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Set citationMatch to color menu button with inUse color.</li>
<li>Set Variable [ $$citationMatch; Value:"test" ]</li>
<li>#</li>
<li>#Goto correct layout.</li>
<li>If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>Go to Layout [ &ldquo;learnFindTest&rdquo; (test) ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;learnFindSTest&rdquo; (test) ]</li>
<li>End If</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "r" ]</li>
<li>Go to Layout [ &ldquo;learnFindTest&rdquo; (test) ]</li>
<li>End If</li>
<li>#</li>
<li>#Find section tags.  Section tags are library </li>
<li>#sections and any brainstorm or evidence record</li>
<li>#can be tagged with any section item record SO</li>
<li>#find all library sections current record is </li>
<li>#assigned to.</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ test::ksection; TEMP::ksection ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: ruleSection::name; ascending
groupTest::name; ascending
test::testName; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>//  #If no records exist then create one.</li>
<li>//  If [ Get (FoundCount)=0 ]</li>
<li>//  Perform Script [ &ldquo;newCitationMenuGroup&rdquo; ]</li>
<li>//  End If</li>
<li>#</li>
<li>//  #Sort according to current users wishes.  By default</li>
<li>//  #the sort will be by category which is set by editCitation script.</li>
<li>//  If [ TEMP::sortMedium = "cat" ]</li>
<li>//  Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>//  Else If [ TEMP::sortMedium = "abc" ]</li>
<li>//  Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>//  End If</li>
<li>#</li>
<li>#Go to citation record's current selection or to first record.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$section =  test::_Ltest ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>If [ $$section &ne;  test::_Ltest ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Set Variable [ $$ID; Value:test::_Ltest ]</li>
<li>#</li>
<li>#Go to citation record's current selection or to first record.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$citationItem =  ruleSection::_Lgroup ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>If [ $$citationItem &ne;  test::_Ltest ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Inform user of items use on both screens.</li>
<li>Set Variable [ $$citationItem; Value:test::_Ltest ]</li>
<li>Refresh Window</li>
<li>#Just in case user was in nonTag field on this</li>
<li>#window when user clicked a menu button on </li>
<li>#the other window, exit all  fields.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>End If</li>
<li>Go to Field [  ]</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>#</li>
<li>#Set citationMatch to color menu button with inUse color.</li>
<li>Set Variable [ $$citationMatch; Value:"test" ]</li>
<li>#</li>
<li>#Goto correct layout.</li>
<li>If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>Go to Layout [ &ldquo;learnFindTest&rdquo; (test) ]</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "r" ]</li>
<li>Go to Layout [ &ldquo;learnFindTest&rdquo; (test) ]</li>
<li>End If</li>
<li>#</li>
<li>#Find section tags.  Test tags are section </li>
<li>#items. Any brainstorm or evidence record</li>
<li>#can be tagged with any section item record SO</li>
<li>#find all library sections current record is </li>
<li>#assigned to.</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ ruleSection::match; "section" ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: ruleSection::name; ascending
groupTest::name; ascending
test::testName; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::InventoryLibaryYN</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>test</em>::ksection</li>
<li>
<em>ruleSection</em>::name</li>
<li>
<em>groupTest</em>::name</li>
<li>
<em>test</em>::testName</li>
<li>
<em>TEMP</em>::sortMedium</li>
<li>
<em>ruleTagMenuGroups</em>::order</li>
<li>
<em>ruleTagMenuGroups</em>::name</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>test</em>::_Ltest</li>
<li>
<em>ruleSection</em>::_Lgroup</li>
<li>
<em>ruleSection</em>::match</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32980ScriptAnchor_">newCitationMenuGroup</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>learnFindTest</li>
<li>learnFindSTest</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33106ScriptAnchor_"></a><td class="script_navbar"><a href="#33107ScriptAnchor_"><span>Previous Script: [menuTestFind]</span></a></td><td class="script_navbar"><a href="#33311ScriptAnchor_"><span>Parent Folder: [menuFind]</span></a></td><td class="script_navbar"><a href="#33108ScriptAnchor_"><span>Next Script: [menuCitationFind]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">menuMediumFind</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Set citationMatch to color menu button with inUse color.</li>
<li>Set Variable [ $$citationMatch; Value:"medium" ]</li>
<li>#</li>
<li>#Do not load tag records until the end of script</li>
<li>#to prevent flashing of window and to speed up</li>
<li>#script.</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>#</li>
<li>#Goto correct layout.</li>
<li>If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>Go to Layout [ &ldquo;learnFind&rdquo; (tagMenus) ]</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "r" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenuFind&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>#</li>
<li>#Find medium tags.  Medium tags are available to all library sections.</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::match; $$citationMatch ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Sort according to current users wishes.  By default</li>
<li>#the sort will be by category which is set by editCitation script.</li>
<li>If [ TEMP::sortMedium = "cat" or TEMP::sortMedium = "" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ TEMP::sortMedium = "abc" ]</li>
<li>Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagMenus</em>::match</li>
<li>
<em>TEMP</em>::sortMedium</li>
<li>
<em>ruleTagMenuGroups</em>::order</li>
<li>
<em>ruleTagMenuGroups</em>::name</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>tagMenus</em>::tag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>learnFind</li>
<li>ReferenceMenuFind</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33108ScriptAnchor_"></a><td class="script_navbar"><a href="#33106ScriptAnchor_"><span>Previous Script: [menuMediumFind]</span></a></td><td class="script_navbar"><a href="#33311ScriptAnchor_"><span>Parent Folder: [menuFind]</span></a></td><td class="script_navbar"><a href="#33109ScriptAnchor_"><span>Next Script: [menuReferenceFind]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">menuCitationFind</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Set citationMatch to color menu button with inUse color.</li>
<li>Set Variable [ $$citationMatch; Value:"cite" ]</li>
<li>#</li>
<li>#Set testlearn internal reference  field conditional</li>
<li>#formatting to transparent.  </li>
<li>Set Variable [ $$internal ]</li>
<li>#</li>
<li>#Goto correct layout.</li>
<li>If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>Go to Layout [ &ldquo;learnFindCite&rdquo; (reference) ]</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "r" ]</li>
<li>Go to Layout [ &ldquo;learnFindCite&rdquo; (reference) ]</li>
<li>End If</li>
<li>#</li>
<li>#Find Citations for this library.  </li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::kcsection; TEMP::ksection ]</li>
<li>//  Set Field [ reference::filterFind; "main" ]</li>
<li>//  Set Field [ reference::ktest; TEMP::ktest ]</li>
<li>Perform Find [  ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: reference::knodePrimary: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>Extend Found Set [ Specified Find Requests: Find Records; Criteria: reference::referenceNodes: &ldquo;*&rdquo; ]
[ Restore ]</li>
<li>//  Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: reference::Title: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>Sort Records [ Specified Sort Order: tagKeywordPrimary::orderOrLock; ascending
tagKeywordPrimary::tag; ascending
reference::referenceShort; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#Sort according to current users wishes.  By default</li>
<li>#the sort will be by category which is set by editCitation script.</li>
<li>If [ TEMP::sortCite = "cat" or TEMP::sortCite = "" ]</li>
<li>Sort Records [ Specified Sort Order: tagKeywordPrimary::orderOrLock; ascending
tagKeywordPrimary::tag; ascending
reference::referenceShort; ascending ]
[ Restore; No dialog ]</li>
<li>//  Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ TEMP::sortCite = "abc" ]</li>
<li>Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>reference</em>::kcsection</li>
<li>
<em>reference</em>::filterFind</li>
<li>
<em>TEMP</em>::ktest</li>
<li>
<em>reference</em>::ktest</li>
<li>
<em>reference</em>::referenceNodes</li>
<li>
<em>tagKeywordPrimary</em>::orderOrLock</li>
<li>
<em>tagKeywordPrimary</em>::tag</li>
<li>
<em>reference</em>::referenceShort</li>
<li>
<em>TEMP</em>::sortCite</li>
<li>
<em>ruleTagMenuGroups</em>::order</li>
<li>
<em>ruleTagMenuGroups</em>::name</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>tagMenus</em>::tag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>learnFindCite</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33109ScriptAnchor_"></a><td class="script_navbar"><a href="#33108ScriptAnchor_"><span>Previous Script: [menuCitationFind]</span></a></td><td class="script_navbar"><a href="#33311ScriptAnchor_"><span>Parent Folder: [menuFind]</span></a></td><td class="script_navbar"><a href="#33110ScriptAnchor_"><span>Next Script: [menuCopyistFind]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">menuReferenceFind</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Set citationMatch to color menu button with inUse color.</li>
<li>Set Variable [ $$citationMatch; Value:"ref" ]</li>
<li>#</li>
<li>#Set testlearn internal reference  field conditional</li>
<li>#formatting to transparent.  </li>
<li>Set Variable [ $$internal ]</li>
<li>#</li>
<li>#Goto correct layout.</li>
<li>If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>Go to Layout [ &ldquo;learnFindCite&rdquo; (reference) ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;learnFindStuffCite&rdquo; (reference) ]</li>
<li>End If</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "r" ]</li>
<li>Go to Layout [ &ldquo;learnFindCite&rdquo; (reference) ]</li>
<li>End If</li>
<li>#</li>
<li>#Find References for this library.  </li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::kcsection; TEMP::ksection ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Set Field [ reference::filterFind; "main" ]</li>
<li>Set Field [ reference::show; "show in learn" ]</li>
<li>End If</li>
<li>//  Set Field [ reference::filterFind; "main" ]</li>
<li>//  Set Field [ reference::ktest; TEMP::ktest ]</li>
<li>Perform Find [  ]</li>
<li>If [ TEMP::InventoryLibaryYN = "" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: reference::knodePrimary: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>Extend Found Set [ Specified Find Requests: Find Records; Criteria: reference::referenceNodes: &ldquo;*&rdquo; ]
[ Restore ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: reference::Title: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>End If</li>
<li>Sort Records [ Specified Sort Order: tagKeywordPrimary::orderOrLock; ascending
tagKeywordPrimary::tag; ascending
reference::referenceShort; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#Sort according to current users wishes.  By default</li>
<li>#the sort will be by category which is set by editCitation script.</li>
<li>If [ TEMP::sortRef = "cat" or TEMP::sortRef = "" ]</li>
<li>Sort Records [ Specified Sort Order: tagKeywordPrimary::orderOrLock; ascending
tagKeywordPrimary::tag; ascending
reference::referenceShort; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ TEMP::sortRef = "abc" ]</li>
<li>Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::InventoryLibaryYN</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>reference</em>::kcsection</li>
<li>
<em>reference</em>::filterFind</li>
<li>
<em>reference</em>::show</li>
<li>
<em>TEMP</em>::ktest</li>
<li>
<em>reference</em>::ktest</li>
<li>
<em>reference</em>::referenceNodes</li>
<li>
<em>tagKeywordPrimary</em>::orderOrLock</li>
<li>
<em>tagKeywordPrimary</em>::tag</li>
<li>
<em>reference</em>::referenceShort</li>
<li>
<em>TEMP</em>::sortRef</li>
<li>
<em>tagMenus</em>::tag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>learnFindCite</li>
<li>learnFindStuffCite</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33110ScriptAnchor_"></a><td class="script_navbar"><a href="#33109ScriptAnchor_"><span>Previous Script: [menuReferenceFind]</span></a></td><td class="script_navbar"><a href="#33311ScriptAnchor_"><span>Parent Folder: [menuFind]</span></a></td><td class="script_navbar"><a href="#33111ScriptAnchor_"><span>Next Script: [menuPathFind]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">menuCopyistFind</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Set citationMatch to color menu button with inUse color.</li>
<li>Set Variable [ $$citationMatch; Value:"copyist" ]</li>
<li>#</li>
<li>#Goto correct layout.</li>
<li>Go to Layout [ &ldquo;ReferenceMenuFind&rdquo; (tagMenus) ]</li>
<li>#</li>
<li>#Find copyist tags.  Copyist tags are available to all library sections.</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::match; $$citationMatch ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Sort according to current users wishes.  By default</li>
<li>#the sort will be by category which is set by editCitation script.</li>
<li>If [ TEMP::sortCopyist = "cat" or TEMP::sortCopyist = "" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ TEMP::sortCopyist = "abc" ]</li>
<li>Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagMenus</em>::match</li>
<li>
<em>TEMP</em>::sortCopyist</li>
<li>
<em>ruleTagMenuGroups</em>::order</li>
<li>
<em>ruleTagMenuGroups</em>::name</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>tagMenus</em>::tag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>ReferenceMenuFind</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33111ScriptAnchor_"></a><td class="script_navbar"><a href="#33110ScriptAnchor_"><span>Previous Script: [menuCopyistFind]</span></a></td><td class="script_navbar"><a href="#33311ScriptAnchor_"><span>Parent Folder: [menuFind]</span></a></td><td class="script_navbar"><a href="#33112ScriptAnchor_"><span>Next Script: [menuOrganFind]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">menuPathFind</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Set citationMatch to color menu button with inUse color.</li>
<li>Set Variable [ $$citationMatch; Value:"path" ]</li>
<li>#</li>
<li>#Goto correct layout.</li>
<li>If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>Go to Layout [ &ldquo;learnFind&rdquo; (tagMenus) ]</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "r" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenuFind&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>#</li>
<li>#Find Path tags.  Path tags are available to all library sections.</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::match; "Path" ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Sort according to current users wishes.  By default</li>
<li>#the sort will be by category which is set by editCitation script.</li>
<li>If [ TEMP::sortPath = "cat" or TEMP::sortPath = "" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ TEMP::sortPath = "abc" ]</li>
<li>Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagMenus</em>::match</li>
<li>
<em>TEMP</em>::sortPath</li>
<li>
<em>ruleTagMenuGroups</em>::order</li>
<li>
<em>ruleTagMenuGroups</em>::name</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>tagMenus</em>::tag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>learnFind</li>
<li>ReferenceMenuFind</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33112ScriptAnchor_"></a><td class="script_navbar"><a href="#33111ScriptAnchor_"><span>Previous Script: [menuPathFind]</span></a></td><td class="script_navbar"><a href="#33311ScriptAnchor_"><span>Parent Folder: [menuFind]</span></a></td><td class="script_navbar"><a href="#33122ScriptAnchor_"><span>Next Script: [findReferernce]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">menuOrganFind</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Set citationMatch to color menu button with inUse color.</li>
<li>Set Variable [ $$citationMatch; Value:"organ" ]</li>
<li>#</li>
<li>#Goto correct layout.</li>
<li>Go to Layout [ &ldquo;ReferenceMenuFind&rdquo; (tagMenus) ]</li>
<li>#</li>
<li>#Find Organ tags.  Organ tags are available to all library sections.</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::match; "organ" ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Sort according to current users wishes.  By default</li>
<li>#the sort will be by category which is set by editCitation script.</li>
<li>If [ TEMP::sortOrgan = "cat" or TEMP::sortOrgan = "" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ TEMP::sortOrgan = "abc" ]</li>
<li>Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagMenus</em>::match</li>
<li>
<em>TEMP</em>::sortOrgan</li>
<li>
<em>ruleTagMenuGroups</em>::order</li>
<li>
<em>ruleTagMenuGroups</em>::name</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>tagMenus</em>::tag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>ReferenceMenuFind</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33122ScriptAnchor_"></a><td class="script_navbar"><a href="#33112ScriptAnchor_"><span>Previous Script: [menuOrganFind]</span></a></td><td class="script_navbar"><a href="#33311ScriptAnchor_"><span>Parent Folder: [menuFind]</span></a></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">findReferernce</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#(This script was attached to find button on tags menu</li>
<li>#in Learn mode.  I removed the button.)</li>
<li>#</li>
<li>#If user is in tag field and has changed spelling</li>
<li>#exit this tag record, otherwise current reference record</li>
<li>#will get deleted by the spelling check script.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Go to Field [  ]</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>If [ $$referenceSort = 2 ]</li>
<li>Sort Records [ Specified Sort Order: reference::modifyDate; descending
reference::referenceForReferenceSort; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ $$referenceSort = "" ]</li>
<li>Sort Records [ Specified Sort Order: tagKeywordPrimary::tag; ascending
reference::referenceForReferenceSort; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ $$referenceSort = 1 ]</li>
<li>Sort Records [ Specified Sort Order: reference::createDate; descending
reference::referenceForReferenceSort; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#As going to the other window will be involved</li>
<li>#stop the record load script on that window until</li>
<li>#this script is finished to speed things up and</li>
<li>#stop flashing effect.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>//  Set Variable [ $$findMode ]</li>
<li>Set Variable [ $$firstFind ]</li>
<li>Set Variable [ $$firstFindOther ]</li>
<li>Set Variable [ $$found ]</li>
<li>Set Variable [ $$foundOther ]</li>
<li>//  Set Variable [ $$foundLayout ]</li>
<li>#</li>
<li>#Find all Learn records in a section.  This would</li>
<li>#need to be done if the user was just in find mode</li>
<li>#on the tag screen and was showing only a few</li>
<li>#of a section's records using this mode.</li>
<li>If [ Get ( WindowName ) = "Learn" ]</li>
<li>If [ $$add = 1 ]</li>
<li>Show Custom Dialog [ Message: "Find learn, or
test discovery, or
both types of records?"; Buttons: &ldquo;learn&rdquo;, &ldquo;discovery&rdquo;, &ldquo;both&rdquo; ]</li>
<li>Enter Find Mode [  ]</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Set Field [ testlearn::kcsection; "*" ]</li>
<li>Else If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Set Field [ testlearn::kaudienceLocation; "*" ]</li>
<li>Else If [ Get ( LastMessageChoice ) = 3 ]</li>
<li>Set Field [ testlearn::filterFind; "main" &amp; &para; ]</li>
<li>End If</li>
<li>Show Custom Dialog [ Message: "limit find to just this section -- " &amp; TEMP::sectionName &amp; " -- or find for entire library?"; Buttons: &ldquo;section&rdquo;, &ldquo;library&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Set Field [ reference::kcsection; "==" &amp; TEMP::ksection ]</li>
<li>Else If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>End If</li>
<li>Else If [ $$add &ne; 1 ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection ]</li>
<li>//  Set Field [ testlearn::filterFind; "main" &amp; &para; ]</li>
<li>End If</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: testlearn::date; descending
testlearn::timestamp; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Perform Script [ &ldquo;loadCitation&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>If [ Get ( WindowName ) = "References" ]</li>
<li>#find on reference layout ...</li>
<li>If [ Left (Get (LayoutName) ; 1) = "r" and $$add &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "Find all reference records for the " &amp; TEMP::sectionName &amp; " section or show references for all sections in the library?"; Buttons: &ldquo;section&rdquo;, &ldquo;all&rdquo; ]</li>
<li>Enter Find Mode [  ]</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Set Field [ reference::kcsection; TEMP::ksection ]</li>
<li>Else If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Set Field [ reference::kcsection; "*" ]</li>
<li>End If</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "r" and $$add = "" ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::kcsection; TEMP::ksection ]</li>
<li>#</li>
<li>#find on learn layout ...</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection ]</li>
<li>//  Set Field [ testlearn::filterFind; "main" &amp; &para; ]</li>
<li>End If</li>
<li>Else If [ Get ( WindowName ) = "Tag Menus" ]</li>
<li>Show Custom Dialog [ Message: "Find all reference records for the " &amp; TEMP::sectionName &amp; " section or show references for all sections in the library?"; Buttons: &ldquo;section&rdquo;, &ldquo;all&rdquo; ]</li>
<li>Enter Find Mode [  ]</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Set Field [ reference::kcsection; "==" &amp; TEMP::ksection ]</li>
<li>Else If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Set Field [ reference::kcsection; "*" ]</li>
<li>End If</li>
<li>End If</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: testlearn::date; descending
testlearn::timestamp; descending ]
[ Restore; No dialog ]</li>
<li>Sort Records [ Specified Sort Order: tagKeywordPrimary::tag; ascending
reference::referenceForReferenceSort; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Perform Script [ &ldquo;loadCitation&rdquo; ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::modifyDate</li>
<li>
<em>reference</em>::referenceForReferenceSort</li>
<li>
<em>tagKeywordPrimary</em>::tag</li>
<li>
<em>reference</em>::createDate</li>
<li>
<em>testlearn</em>::kcsection</li>
<li>
<em>testlearn</em>::kaudienceLocation</li>
<li>
<em>testlearn</em>::filterFind</li>
<li>
<em>TEMP</em>::sectionName</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>reference</em>::kcsection</li>
<li>
<em>testlearn</em>::date</li>
<li>
<em>testlearn</em>::timestamp</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32984ScriptAnchor_">loadCitation</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<p>
<span class="partheading"><a name="33309ScriptAnchor_"></a><a href="#33309ScriptAnchor_toc">pictures</a></span>
</p>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32847ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"><a href="#33309ScriptAnchor_"><span>Parent Folder: [pictures]</span></a></td><td class="script_navbar"><a href="#33193ScriptAnchor_"><span>Next Script: [pictureDelete]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">pictureInsert</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>If [ reference::picture &ne; "" and reference::lock = "" ]</li>
<li>Show Custom Dialog [ Message: "Replace current picture?"; Buttons: &ldquo;Cancel&rdquo;, &ldquo;OK&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Go to Field [  ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Go to Field [ reference::picture ]</li>
<li>Insert Picture [  ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
<li>Else If [ testlearn::Picture &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "Replace current picture?"; Buttons: &ldquo;Cancel&rdquo;, &ldquo;OK&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Go to Field [  ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Go to Field [ testlearn::Picture ]</li>
<li>Insert Picture [  ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
<li>Else If [ testlearnReportTags::Picture &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "Replace current picture?"; Buttons: &ldquo;Cancel&rdquo;, &ldquo;OK&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Go to Field [  ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Go to Field [ testlearnReportTags::Picture ]</li>
<li>Insert Picture [  ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
<li>Else If [ testlearnReportTags::Picture = "" ]</li>
<li>Show Custom Dialog [ Message: "Select a picture to insert."; Buttons: &ldquo;Cancel&rdquo;, &ldquo;OK&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Go to Field [  ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Go to Field [ testlearnReportTags::Picture ]</li>
<li>Insert Picture [  ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
<li>Else If [ Get ( LayoutTableName ) = "test" ]</li>
<li>If [ groupTest::testReportPicture = "" ]</li>
<li>Go to Field [ groupTest::testReportPicture ]</li>
<li>Insert Picture [  ]</li>
<li>Go to Field [  ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Show Custom Dialog [ Message: "Replace current picture or delete it?"; Buttons: &ldquo;Cancel&rdquo;, &ldquo;replace&rdquo;, &ldquo;delete&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Go to Field [  ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Go to Field [ groupTest::testReportPicture ]</li>
<li>Insert Picture [  ]</li>
<li>Go to Field [  ]</li>
<li>Else If [ Get ( LastMessageChoice ) = 3 ]</li>
<li>Set Field [ groupTest::testReportPicture; "" ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::picture</li>
<li>
<em>reference</em>::lock</li>
<li>
<em>testlearn</em>::Picture</li>
<li>
<em>testlearnReportTags</em>::Picture</li>
<li>
<em>groupTest</em>::testReportPicture</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33193ScriptAnchor_"></a><td class="script_navbar"><a href="#32847ScriptAnchor_"><span>Previous Script: [pictureInsert]</span></a></td><td class="script_navbar"><a href="#33309ScriptAnchor_"><span>Parent Folder: [pictures]</span></a></td><td class="script_navbar"><a href="#33196ScriptAnchor_"><span>Next Script: [pictureExport]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">pictureDelete</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>If [ reference::picture &ne; "" and reference::lock = "" ]</li>
<li>Show Custom Dialog [ Message: "Delete current picture?"; Buttons: &ldquo;Cancel&rdquo;, &ldquo;OK&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Go to Field [  ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Set Field [ reference::picture; "" ]</li>
<li>//  Close Window [ Current Window ]</li>
<li>//  Exit Script [  ]</li>
<li>//  Halt Script</li>
<li>End If</li>
<li>Else If [ testlearn::Picture &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "Delete current picture?"; Buttons: &ldquo;Cancel&rdquo;, &ldquo;OK&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Go to Field [  ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Set Field [ testlearn::Picture; "" ]</li>
<li>//  Close Window [ Current Window ]</li>
<li>//  Exit Script [  ]</li>
<li>//  Halt Script</li>
<li>End If</li>
<li>Else If [ testlearnReportTags::Picture &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "Delete current picture?"; Buttons: &ldquo;Cancel&rdquo;, &ldquo;OK&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Go to Field [  ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Set Field [ testlearnReportTags::Picture; "" ]</li>
<li>//  Close Window [ Current Window ]</li>
<li>//  Exit Script [  ]</li>
<li>//  Halt Script</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::picture</li>
<li>
<em>reference</em>::lock</li>
<li>
<em>testlearn</em>::Picture</li>
<li>
<em>testlearnReportTags</em>::Picture</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33196ScriptAnchor_"></a><td class="script_navbar"><a href="#33193ScriptAnchor_"><span>Previous Script: [pictureDelete]</span></a></td><td class="script_navbar"><a href="#33309ScriptAnchor_"><span>Parent Folder: [pictures]</span></a></td><td class="script_navbar"><a href="#33144ScriptAnchor_"><span>Next Script: [clearpicture1]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">pictureExport</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>If [ reference::picture &ne; "" ]</li>
<li>Export Field Contents [ reference::picture ]</li>
<li>Else If [ testlearn::Picture &ne; "" ]</li>
<li>Export Field Contents [ testlearn::Picture ]</li>
<li>Else If [ testlearnReportTags::Picture &ne; "" ]</li>
<li>Export Field Contents [ testlearnReportTags::Picture ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::picture</li>
<li>
<em>testlearn</em>::Picture</li>
<li>
<em>testlearnReportTags</em>::Picture</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33144ScriptAnchor_"></a><td class="script_navbar"><a href="#33196ScriptAnchor_"><span>Previous Script: [pictureExport]</span></a></td><td class="script_navbar"><a href="#33309ScriptAnchor_"><span>Parent Folder: [pictures]</span></a></td><td class="script_navbar"><a href="#32951ScriptAnchor_"><span>Next Script: [inUsePart2picture1]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">clearpicture1</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#</li>
<li>#</li>
<li>Go to Field [ report::_kfPhoto ]</li>
<li>Perform Script [ &ldquo;reportClearDiscoveryLink&rdquo; ]</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>report</em>::_kfPhoto</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33143ScriptAnchor_">reportClearDiscoveryLink</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32951ScriptAnchor_"></a><td class="script_navbar"><a href="#33144ScriptAnchor_"><span>Previous Script: [clearpicture1]</span></a></td><td class="script_navbar"><a href="#33309ScriptAnchor_"><span>Parent Folder: [pictures]</span></a></td><td class="script_navbar"><a href="#32952ScriptAnchor_"><span>Next Script: [inUsePart2picture2]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">inUsePart2picture1</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#</li>
<li>#</li>
<li>Go to Field [ report::_kfPhoto ]</li>
<li>Perform Script [ &ldquo;inUsePart3&rdquo; ]</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>report</em>::_kfPhoto</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32803ScriptAnchor_">inUsePart3</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32952ScriptAnchor_"></a><td class="script_navbar"><a href="#32951ScriptAnchor_"><span>Previous Script: [inUsePart2picture1]</span></a></td><td class="script_navbar"><a href="#33309ScriptAnchor_"><span>Parent Folder: [pictures]</span></a></td><td class="script_navbar"><a href="#33145ScriptAnchor_"><span>Next Script: [clearpicture2]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">inUsePart2picture2</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#</li>
<li>#</li>
<li>Go to Field [ report::_kfPhoto2 ]</li>
<li>Perform Script [ &ldquo;inUsePart3&rdquo; ]</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>report</em>::_kfPhoto2</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32803ScriptAnchor_">inUsePart3</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33145ScriptAnchor_"></a><td class="script_navbar"><a href="#32952ScriptAnchor_"><span>Previous Script: [inUsePart2picture2]</span></a></td><td class="script_navbar"><a href="#33309ScriptAnchor_"><span>Parent Folder: [pictures]</span></a></td><td class="script_navbar"><a href="#33149ScriptAnchor_"><span>Next Script: [clearpicture3]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">clearpicture2</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#</li>
<li>#</li>
<li>Go to Field [ report::_kfPhoto2 ]</li>
<li>Perform Script [ &ldquo;reportClearDiscoveryLink&rdquo; ]</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>report</em>::_kfPhoto2</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33143ScriptAnchor_">reportClearDiscoveryLink</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33149ScriptAnchor_"></a><td class="script_navbar"><a href="#33145ScriptAnchor_"><span>Previous Script: [clearpicture2]</span></a></td><td class="script_navbar"><a href="#33309ScriptAnchor_"><span>Parent Folder: [pictures]</span></a></td><td class="script_navbar"><a href="#33150ScriptAnchor_"><span>Next Script: [clearpicture4]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">clearpicture3</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#</li>
<li>#</li>
<li>Go to Field [ report::_kfPhoto3 ]</li>
<li>Perform Script [ &ldquo;reportClearDiscoveryLink&rdquo; ]</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>report</em>::_kfPhoto3</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33143ScriptAnchor_">reportClearDiscoveryLink</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33150ScriptAnchor_"></a><td class="script_navbar"><a href="#33149ScriptAnchor_"><span>Previous Script: [clearpicture3]</span></a></td><td class="script_navbar"><a href="#33309ScriptAnchor_"><span>Parent Folder: [pictures]</span></a></td><td class="script_navbar"><a href="#32953ScriptAnchor_"><span>Next Script: [inUsePart2picture3]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">clearpicture4</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#</li>
<li>#</li>
<li>Go to Field [ report::_kfPhoto4 ]</li>
<li>Perform Script [ &ldquo;reportClearDiscoveryLink&rdquo; ]</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>report</em>::_kfPhoto4</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33143ScriptAnchor_">reportClearDiscoveryLink</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32953ScriptAnchor_"></a><td class="script_navbar"><a href="#33150ScriptAnchor_"><span>Previous Script: [clearpicture4]</span></a></td><td class="script_navbar"><a href="#33309ScriptAnchor_"><span>Parent Folder: [pictures]</span></a></td><td class="script_navbar"><a href="#32954ScriptAnchor_"><span>Next Script: [inUsePart2picture4]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">inUsePart2picture3</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#</li>
<li>#</li>
<li>Go to Field [ report::_kfPhoto3 ]</li>
<li>Perform Script [ &ldquo;inUsePart3&rdquo; ]</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>report</em>::_kfPhoto3</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32803ScriptAnchor_">inUsePart3</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32954ScriptAnchor_"></a><td class="script_navbar"><a href="#32953ScriptAnchor_"><span>Previous Script: [inUsePart2picture3]</span></a></td><td class="script_navbar"><a href="#33309ScriptAnchor_"><span>Parent Folder: [pictures]</span></a></td><td class="script_navbar"><a href="#33020ScriptAnchor_"><span>Next Script: [addLinksPicturesToTagsMode]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">inUsePart2picture4</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#</li>
<li>#</li>
<li>Go to Field [ report::_kfPhoto4 ]</li>
<li>Set Variable [ $$photo ]</li>
<li>Perform Script [ &ldquo;inUsePart3&rdquo; ]</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>report</em>::_kfPhoto4</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32803ScriptAnchor_">inUsePart3</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33020ScriptAnchor_"></a><td class="script_navbar"><a href="#32954ScriptAnchor_"><span>Previous Script: [inUsePart2picture4]</span></a></td><td class="script_navbar"><a href="#33309ScriptAnchor_"><span>Parent Folder: [pictures]</span></a></td><td class="script_navbar"><a href="#33022ScriptAnchor_"><span>Next Script: [CHUNKaddPictureToTag]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">addLinksPicturesToTagsMode</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32988ScriptAnchor_">menuNode</a></li>
<li><a href="#32993ScriptAnchor_">menuKey</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>#</li>
<li>#If node is currenlty locked then stop script, inform user.</li>
<li>If [ nodeLockTagMenus::orderOrLock  &ne;  "" ]</li>
<li>Go to Field [  ]</li>
<li>Show Custom Dialog [ Message: "This record is locked.  Go the node that created it -- " &amp; nodeLockTagMenus::tag &amp; " -- and enter the password to unlock it and then you will be able to add pictures and links to it."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>If [ nodeLockTagMenus::orderOrLock &ne; "" and tagMenus::match = "sample" or 
nodeLockTagMenus::orderOrLock &ne; "" and tagMenus::match = "health" or 
nodeLockTagMenus::orderOrLock &ne; "" and tagMenus::match = "health" or 
nodeLockTagMenus::orderOrLock &ne; "" and tagMenus::match = "health" or 
nodeLockTagMenus::orderOrLock &ne; "" and tagMenus::match = "health" or 
nodeLockTagMenus::orderOrLock &ne; "" and tagMenus::match = "test" ]</li>
<li>Show Custom Dialog [ Message: "This record is currently locked.  Select the node that created it and enter the password to unlock it, then you will able to start the delete process."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ tagMenus::orderOrLock &ne; "" and tagMenus::match = "health" ]</li>
<li>Show Custom Dialog [ Message: "This record is locked by the system."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#This script allows users to add pictures and </li>
<li>#file links to tags from citation records.</li>
<li>#</li>
<li>#If on the test setup layout, then stop the script</li>
<li>#if the user has not created any tags to add pictures</li>
<li>#and links to</li>
<li>If [ TEMP::ktest  &ne; "" and Get (RecordNumber) = 0 ]</li>
<li>Show Custom Dialog [ Message: "Create a tag record then click the add button."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If user is not in add mode (indicated green highlight</li>
<li>#on 'add' button) then enter add mode.</li>
<li>#Go to layout where user can see all</li>
<li>#possible places an item can be added: </li>
<li>#3 picture places and 3 link places.</li>
<li>If [ $$add = "" ]</li>
<li>#</li>
<li>#if user was on the keyword or nod tag layout ...</li>
<li>If [ $$citationMatch  = "key" or 
$$citationMatch  = "node" ]</li>
<li>#</li>
<li>#Remember layout user was on.</li>
<li>Set Variable [ $$tagLayout; Value:Get (LayoutName) ]</li>
<li>Go to Layout [ &ldquo;addMenuNodeKeyword&rdquo; (tagMenus) ]</li>
<li>#</li>
<li>#if user was on the testItem tag layout ...</li>
<li>Else If [ $$citationMatch = "testItem" ]</li>
<li>#</li>
<li>#Remember layout user was on.</li>
<li>Set Variable [ $$tagLayout; Value:Get (LayoutName) ]</li>
<li>Go to Layout [ &ldquo;addMenuTestItem&rdquo; (tagMenus) ]</li>
<li>#</li>
<li>#if user was any of the other tag layouts ...</li>
<li>Else If [ 1 = 1 ]</li>
<li>#</li>
<li>#Remember layout user was on.</li>
<li>Set Variable [ $$tagLayout; Value:Get (LayoutName) ]</li>
<li>Go to Layout [ &ldquo;addMenu1&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>#</li>
<li>#Conditionally format add button.</li>
<li>Set Variable [ $$add; Value:1 ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#Capture main window layout.</li>
<li>#Capture record user is on.</li>
<li>#Stop record load script to speed things up.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>#</li>
<li>#If setup ...</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>Set Variable [ $$returnWIndow; Value:Get (LayoutName) ]</li>
<li>Set Variable [ $$returnRecord; Value:test::_Ltest ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>#</li>
<li>#If learn ...</li>
<li>Set Variable [ $$returnWIndow; Value:"Learn" ]</li>
<li>Set Variable [ $$returnLayout; Value:Get (LayoutName) ]</li>
<li>Set Variable [ $$returnRecord; Value:testlearn::_Ltestlearn ]</li>
<li>End If</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>#</li>
<li>#If references ...</li>
<li>Set Variable [ $$returnWIndow; Value:"References" ]</li>
<li>Set Variable [ $$returnRecord; Value:reference::_Lreference ]</li>
<li>End If</li>
<li>#</li>
<li>#Re-title main window.</li>
<li>Set Window Title [ Current Window; New Title: "References" ]</li>
<li>#</li>
<li>#Goto the referenceTag layout.</li>
<li>Go to Layout [ &ldquo;ReferenceAddToTag&rdquo; (reference) ]</li>
<li>#</li>
<li>//  #Find all citations for current tag set.</li>
<li>//  #( the user can always click the 'all' button to</li>
<li>//  #   to see all the records they can add to the tag</li>
<li>//  #   but I figured most of the time the user is creating</li>
<li>//  #   creating records during the add process to</li>
<li>//  #   to add to tag, and so keep the records to just</li>
<li>//  #   those created for a type of tag would be easier</li>
<li>//  #   on the user. )</li>
<li>//  Set Error Capture [ On ]</li>
<li>//  Allow User Abort [ Off ]</li>
<li>//  Enter Find Mode [  ]</li>
<li>//  Set Field [ reference::kcsection; TEMP::ksection ]</li>
<li>//  #</li>
<li>//  #If the citationMatch equal "key" then substitute</li>
<li>//  #"keyword" for "key" as on the layout it makes </li>
<li>//  #more sense to have the user check a keyword</li>
<li>//  #checkbox item than a key item as key is short</li>
<li>//  #for keyword in this case.</li>
<li>//  #(  You can see these checkboxes at the bottom</li>
<li>//  #   of every Reference record )</li>
<li>//  If [ $$citationMatch = "key" ]</li>
<li>//  Set Field [ reference::filterFind; "*" &amp; "keyword" ]</li>
<li>//  #</li>
<li>//  #If the citationMatch equals any other tag type ...</li>
<li>//  Else If [ $$citationMatch &ne; "key" ]</li>
<li>//  Set Field [ reference::filterFind; "*" &amp; Quote ( $$citationMatch ) ]</li>
<li>//  End If</li>
<li>//  #</li>
<li>//  Perform Find [  ]</li>
<li>#</li>
<li>#Clear the stop load record variable and load </li>
<li>#the current record's info.</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Perform Script [ &ldquo;loadCitation&rdquo; ]</li>
<li>#</li>
<li>#Go to tag menu window.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>#END start add mode</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN stop add mode</li>
<li>#</li>
<li>#If in add mode then clear the add variable to conditionally</li>
<li>#format the 'add' button to indicate that add mode</li>
<li>#has been turned off.</li>
<li>Else If [ $$add = 1 ]</li>
<li>Set Variable [ $$add ]</li>
<li>#</li>
<li>#If the user was in test mode prior to add mode ...</li>
<li>If [ $$citationMatch = "testItem" ]</li>
<li>#</li>
<li>#This may be lazy, but instead of doing an if</li>
<li>#test to figure out what window a user is in,</li>
<li>#it seems that telling the system to select both</li>
<li>#possible windows the user could be</li>
<li>#in works just fine.  The system always </li>
<li>#selects the one the user is in.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>#</li>
<li>#Now loop to the record the user was on, </li>
<li>#and turn off the load record script to speed things</li>
<li>#up.  ( This record set does not need to be found</li>
<li>#   first because during add mode test records </li>
<li>#   are not touched. )</li>
<li>Set Variable [ $$ID; Value:"ignore" ]</li>
<li>Go to Layout [ &ldquo;testSetup&rdquo; (test) ]</li>
<li>Loop</li>
<li>Exit Loop If [ test::_Ltest = $$returnRecord ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Set the window title to Setup and turn back on</li>
<li>#the load record script, but do not load the record</li>
<li>#as this record's variables are already loaded.</li>
<li>Set Window Title [ Current Window; New Title: "Setup" ]</li>
<li>Set Variable [ $$ID; Value:test::_Ltest ]</li>
<li>#</li>
<li>#Go to the tag menu and perform the TestItem</li>
<li>#menu script to reset the conditional formatting.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Go to Layout [ &ldquo;setupTestItem&rdquo; (tagMenus) ]</li>
<li>Perform Script [ &ldquo;menuTestItem&rdquo; ]</li>
<li>#</li>
<li>#Clear all add mode variables and exit script.</li>
<li>Set Variable [ $$returnWindow ]</li>
<li>Set Variable [ $$returnLayout ]</li>
<li>Set Variable [ $$returnRecord ]</li>
<li>Set Variable [ $$tagLayout ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>#If the user was in default mode prior to add mode ...</li>
<li>Else If [ $$returnWindow = "defaultSetup" ]</li>
<li>#</li>
<li>#This may be lazy, but instead of doing an if</li>
<li>#test to figure out what window a user is in,</li>
<li>#it seems that telling the system to select both</li>
<li>#possible windows the user could be</li>
<li>#in works just fine.  The system always </li>
<li>#selects the one the user is in.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>#</li>
<li>#There is always only one default record, so </li>
<li>#finding and looping to record is not necessary.</li>
<li>Go to Layout [ &ldquo;defaultSetup&rdquo; (tempSetup) ]</li>
<li>Set Window Title [ Current Window; New Title: "Setup" ]</li>
<li>#</li>
<li>#Go to the tag menu and perform the Node</li>
<li>#menu script to reset the conditional formatting.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Go to Layout [ &ldquo;defaultNode1&rdquo; (tagMenus) ]</li>
<li>Perform Script [ &ldquo;defaultNodeMenu&rdquo; ]</li>
<li>#</li>
<li>#Clear all add mode variables and exit script.</li>
<li>Set Variable [ $$returnWindow ]</li>
<li>Set Variable [ $$returnLayout ]</li>
<li>Set Variable [ $$returnRecord ]</li>
<li>Set Variable [ $$tagLayout ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If going back to a Learn or Reference layout,</li>
<li>#then first turn off the record load variable.</li>
<li>#I decided to do it here rather than include it</li>
<li>#each time before it is needed. </li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>#</li>
<li>#If the user was in learn mode prior to add mode ...</li>
<li>If [ $$returnWindow = "Learn" ]</li>
<li>#</li>
<li>#Go to tag layout user was on before entering</li>
<li>#add mode.  ( This may not be useful as user</li>
<li>#    could also predict that tag window will stay</li>
<li>#    on the tag it is on in add mode.  User might</li>
<li>#    not remember what tag they where on when</li>
<li>#    they started add mode.  Have to see if this</li>
<li>#    is useful or not. )</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>#</li>
<li>If [ $$citationMatch = "node" or 
$$citationMatch = "key" or 
$$citationMatch = "testItem" ]</li>
<li>Go to Layout [ $$tagLayout ]</li>
<li>#</li>
<li>Else If [ $$citationMatch = "medium" or 
$$citationMatch = "health" or 
$$citationMatch = "organ" or 
$$citationMatch = "copyist" or 
//$$citationMatch = "sample" or 
$$citationMatch = "path" ]</li>
<li>Go to Layout [ $$tagLayout ]</li>
<li>End If</li>
<li>#</li>
<li>#This may be lazy, but instead of doing an if</li>
<li>#test to figure out what window a user is in,</li>
<li>#it seems that telling the system to select both</li>
<li>#possible windows the user could be</li>
<li>#in works just fine.  The system always </li>
<li>#selects the one the user is in.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Set Window Title [ Current Window; New Title: "Learn" ]</li>
<li>Go to Layout [ $$returnLayout ]</li>
<li>#</li>
<li>#Find main learn records.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection ]</li>
<li>//  Set Field [ testlearn::filterFind; "main" &amp; &para; ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Go to record user was on before add mode.</li>
<li>Sort Records [ Specified Sort Order: testlearn::date; descending
testlearn::timestamp; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Loop</li>
<li>Exit Loop If [ testlearn::_Ltestlearn = $$returnRecord ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Clear all add mode variables and exit script.</li>
<li>Set Variable [ $$returnWindow ]</li>
<li>Set Variable [ $$returnLayout ]</li>
<li>Set Variable [ $$returnRecord ]</li>
<li>Set Variable [ $$tagLayout ]</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Perform Script [ &ldquo;loadCitation&rdquo; ]</li>
<li>#</li>
<li>#If the user was in reference mode prior to add mode ...</li>
<li>Else If [ $$returnWIndow = "References" ]</li>
<li>#</li>
<li>#Go to tag layout user was on before entering</li>
<li>#add mode.  ( This may not be useful as user</li>
<li>#    could also predict that tag window will stay</li>
<li>#    on the tag it is on in add mode.  User might</li>
<li>#    not remember what tag they where on when</li>
<li>#    they started add mode.  Have to see if this</li>
<li>#    is useful or not. )</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>#</li>
<li>#Get the record number.</li>
<li>Set Variable [ $recordNumber; Value:Get (RecordNumber) ]</li>
<li>#</li>
<li>If [ $$citationMatch = "node" or 
$$citationMatch = "key" or 
$$citationMatch = "testItem" ]</li>
<li>Go to Layout [ Middle ( TEMP::layoutRtagK ; 5 ; 42 ) ]</li>
<li>#</li>
<li>Else If [ $$citationMatch = "medium" or 
$$citationMatch = "organ" or 
$$citationMatch = "copyist" or 
$$citationMatch = "path" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenu1&rdquo; (tagMenus) ]</li>
<li>#</li>
<li>Else If [ $$citationMatch = "health" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenu1&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>#</li>
<li>#This may be lazy, but instead of doing an if</li>
<li>#test to figure out what window a user is in,</li>
<li>#it seems that telling the system to select both</li>
<li>#possible windows the user could be</li>
<li>#in works just fine.  The system always </li>
<li>#selects the one the user is in.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Set Window Title [ Current Window; New Title: "References" ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;ReferenceStuff&rdquo; (reference) ]</li>
<li>Else</li>
<li>Go to Layout [ &ldquo;Reference&rdquo; (reference) ]</li>
<li>End If</li>
<li>#</li>
<li>#Find main reference records.</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::kcsection; TEMP::ksection ]</li>
<li>//  Set Field [ reference::filterFind; "main" ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Go to record user was on before add mode.</li>
<li>Sort Records [ Specified Sort Order: tagKeywordPrimary::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Loop</li>
<li>Exit Loop If [ reference::_Lreference = $$returnRecord ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Clear all add mode variables and exit script.</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Set Variable [ $$returnLayout ]</li>
<li>Set Variable [ $$returnRecord ]</li>
<li>Set Variable [ $$returnWindow ]</li>
<li>Perform Script [ &ldquo;loadCitation&rdquo; ]</li>
<li>#</li>
<li>#Go to record user was on before add mode.</li>
<li>Scroll Window
[ Home ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Go to Record/Request/Page [ $recordNumber ]
[ No dialog ]</li>
<li>#</li>
<li>#</li>
<li>End If</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>nodeLockTagMenus</em>::orderOrLock</li>
<li>
<em>nodeLockTagMenus</em>::tag</li>
<li>
<em>tagMenus</em>::match</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>TEMP</em>::ktest</li>
<li>
<em>test</em>::_Ltest</li>
<li>
<em>testlearn</em>::_Ltestlearn</li>
<li>
<em>reference</em>::_Lreference</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>reference</em>::kcsection</li>
<li>
<em>reference</em>::filterFind</li>
<li>
<em>testlearn</em>::kcsection</li>
<li>
<em>testlearn</em>::filterFind</li>
<li>
<em>testlearn</em>::date</li>
<li>
<em>testlearn</em>::timestamp</li>
<li>
<em>TEMP</em>::layoutRtagK</li>
<li>
<em>TEMP</em>::InventoryLibaryYN</li>
<li>
<em>tagKeywordPrimary</em>::tag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32984ScriptAnchor_">loadCitation</a></li>
<li><a href="#33071ScriptAnchor_">menuTestItem</a></li>
<li><a href="#33088ScriptAnchor_">defaultNodeMenu</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>addMenuNodeKeyword</li>
<li>addMenuTestItem</li>
<li>addMenu1</li>
<li>ReferenceAddToTag</li>
<li>testSetup</li>
<li>setupTestItem</li>
<li>defaultSetup</li>
<li>defaultNode1</li>
<li>&lt;Missing Layout&gt;</li>
<li>ReferenceMenu1</li>
<li>ReferenceStuff</li>
<li>Reference</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33022ScriptAnchor_"></a><td class="script_navbar"><a href="#33020ScriptAnchor_"><span>Previous Script: [addLinksPicturesToTagsMode]</span></a></td><td class="script_navbar"><a href="#33309ScriptAnchor_"><span>Parent Folder: [pictures]</span></a></td><td class="script_navbar"><a href="#33023ScriptAnchor_"><span>Next Script: [addPicture1ToTag]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">CHUNKaddPictureToTag</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33023ScriptAnchor_">addPicture1ToTag</a></li>
<li><a href="#33024ScriptAnchor_">addPicture2ToTag</a></li>
<li><a href="#33025ScriptAnchor_">addPicture3ToTag</a></li>
<li><a href="#33187ScriptAnchor_">addPicture2ToTag Copy</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Get key for tag that is to be added to record.</li>
<li>If [ Get ( LayoutTableName ) = "reference" ]</li>
<li>Set Variable [ $tag; Value:reference::_Lreference ]</li>
<li>Set Variable [ $number; Value:$$number ]</li>
<li>Set Variable [ $$number ]</li>
<li>Set Variable [ $name; Value:$$name ]</li>
<li>Set Variable [ $$name ]</li>
<li>Set Variable [ $window; Value:Get (WindowName) ]</li>
<li>Else If [ Get ( LayoutTableName ) = "testlearn" ]</li>
<li>Set Variable [ $tag; Value:testlearn::_Ltestlearn ]</li>
<li>Set Variable [ $number; Value:$$number ]</li>
<li>Set Variable [ $$number ]</li>
<li>Set Variable [ $name; Value:$$name ]</li>
<li>Set Variable [ $$name ]</li>
<li>Set Variable [ $window; Value:Get (WindowName) ]</li>
<li>End If</li>
<li>#</li>
<li>#Add all tag's section keys to reference or learn record.</li>
<li>Perform Script [ &ldquo;addTagSectionKeysToMainRecordKeychain&rdquo; ]</li>
<li>#</li>
<li>#Now add all the added record&rsquo;s node and keyword </li>
<li>#tags to any newly added sections.  </li>
<li>Perform Script [ &ldquo;CHUNKaddReferenceNodesAndKeywords&rdquo; ]</li>
<li>#</li>
<li>#Complete process of adding picture to tag.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>#</li>
<li>#Remove focus from field so can see </li>
<li>#conditional formatting.</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Remove key from other slots in may be in, to</li>
<li>#prevent duplicates showing up.</li>
<li>If [ tagMenus::Kpicture1 = $tag and $number &ne; 1 ]</li>
<li>Set Field [ tagMenus::Kpicture1; "" ]</li>
<li>Else If [ tagMenus::Kpicture2 = $tag and $number &ne; 2 ]</li>
<li>Set Field [ tagMenus::Kpicture2; "" ]</li>
<li>Else If [ tagMenus::Kpicture3= $tag and $number &ne; 3 ]</li>
<li>Set Field [ tagMenus::Kpicture3; "" ]</li>
<li>End If</li>
<li>#</li>
<li>#Place key in selected slot.</li>
<li>If [ $name = "picture" ]</li>
<li>#</li>
<li>If [ tagMenus::Kpicture1  &ne; $tag and $number  =  1 ]</li>
<li>Set Field [ tagMenus::Kpicture1; $tag ]</li>
<li>Select Window [ Name: $window; Current file ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ tagMenus::Kpicture2  &ne; $tag and $number  =  2 ]</li>
<li>Set Field [ tagMenus::Kpicture2; $tag ]</li>
<li>Select Window [ Name: $window; Current file ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ tagMenus::Kpicture3 &ne; $tag and $number  =  3 ]</li>
<li>Set Field [ tagMenus::Kpicture3; $tag ]</li>
<li>Select Window [ Name: $window; Current file ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Remove it key if it is already in use.</li>
<li>If [ $name = "picture" ]</li>
<li>If [ tagMenus::Kpicture1 = $tag and $number = 1 ]</li>
<li>Set Field [ tagMenus::Kpicture1; "" ]</li>
<li>Else If [ tagMenus::Kpicture2 = $tag and $number = 2 ]</li>
<li>Set Field [ tagMenus::Kpicture2; "" ]</li>
<li>Else If [ tagMenus::Kpicture3 = $tag and $number = 3 ]</li>
<li>Set Field [ tagMenus::Kpicture3; "" ]</li>
<li>End If</li>
<li>Select Window [ Name: $window; Current file ]</li>
<li>#</li>
<li>End If</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::_Lreference</li>
<li>
<em>testlearn</em>::_Ltestlearn</li>
<li>
<em>tagMenus</em>::Kpicture1</li>
<li>
<em>tagMenus</em>::Kpicture2</li>
<li>
<em>tagMenus</em>::Kpicture3</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33209ScriptAnchor_">addTagSectionKeysToMainRecordKeychain</a></li>
<li><a href="#33207ScriptAnchor_">CHUNKaddReferenceNodesAndKeywords</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33023ScriptAnchor_"></a><td class="script_navbar"><a href="#33022ScriptAnchor_"><span>Previous Script: [CHUNKaddPictureToTag]</span></a></td><td class="script_navbar"><a href="#33309ScriptAnchor_"><span>Parent Folder: [pictures]</span></a></td><td class="script_navbar"><a href="#33024ScriptAnchor_"><span>Next Script: [addPicture2ToTag]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">addPicture1ToTag</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Do not allow learn records to be added to tags as</li>
<li>#that would require insuring all that Learn record's</li>
<li>#reference records tagged onto it were also</li>
<li>#brought into the new section along with all </li>
<li>#their tags, and their tags' tags.  THUS only allow</li>
<li>#Learn records to be added to tags that have a picture</li>
<li>#or link (thus provide value) and have none of the</li>
<li>#above mentioned tags: reference, cite.</li>
<li>#AND once such a tag is added no reference,</li>
<li>#or cite tags can be added to it.  </li>
<li>If [ testlearn::kcitation &ne; "" or testlearn::kcreference &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "Learn records with references or a citation cannot be added to tags.  Doing so would require adding all these reference and cite records' references and cite records, and then all of theirs, and so on.  "; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Note which button has been clicked ( 1, 2 or 3)</li>
<li>#and if there is a picture to show then link it</li>
<li>#to tag user is currently wanting to link it to.</li>
<li>If [ reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "jpg"  
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "gif"  
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "eps"  
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "jp2" 
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "psd"  
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "png"  
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "pct"  
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "pcs"  
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = ".qt"  
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "sgi"  
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "tga"  
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "tif"  
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "bmp"  
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "wmf"  
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "emf"  
or Right ( reference::URL ; 3 )  = "jpg"  
or Right ( reference::URL ; 3 )  = "gif"  
or Right ( reference::URL ; 3 )  = "eps"  
or Right ( reference::URL ; 3 )  = "jp2" 
or Right ( reference::URL ; 3 )  = "psd"  
or Right ( reference::URL ; 3 )  = "png"  
or Right ( reference::URL ; 3 )  = "pct"  
or Right ( reference::URL ; 3 )  = "pcs"  
or Right ( reference::URL ; 3 )  = ".qt"  
or Right ( reference::URL ; 3 )  = "sgi"  
or Right ( reference::URL ; 3 )  = "tga"  
or Right ( reference::URL ; 3 )  = "tif"  
or Right ( reference::URL ; 3 )  = "bmp"  
or Right ( reference::URL ; 3 )  = "wmf"  
or Right ( reference::URL ; 3 )  = "emf" 
or 
reference::picture &ne; "" ]</li>
<li>Set Variable [ $$name; Value:"picture" ]</li>
<li>Set Variable [ $$number; Value:1 ]</li>
<li>#</li>
<li>#If the filterFind checkbox is not checked for the</li>
<li>#the current $$CitationMatch variable, then</li>
<li>#these next scripts will identify that problem,</li>
<li>#fix it, and inform the user of what it did.</li>
<li>If [ Get ( LayoutTableName ) = "testlearn" ]</li>
<li>If [ $$citationMatch = "key" ]</li>
<li>If [ "keyword" &amp; &para; &ne; FilterValues ( testlearn::filterFind ; "keyword" &amp; &para; ) ]</li>
<li>Set Variable [ $filterFind; Value:testlearn::filterFind ]</li>
<li>Set Field [ testlearn::filterFind; "keyword" &amp; &para; &amp; $filterFind ]</li>
<li>//  Show Custom Dialog [ Message: "The system has added this learn record to the " &amp;
If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp;

 " citation record set.  You will not have to click the 'all' button anymore to find it for " &amp; If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."

//Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " &amp;
//If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>Else If [ $$citationMatch &amp; &para; &ne; FilterValues ( testlearn::filterFind ; $$citationMatch &amp; &para; ) ]</li>
<li>Set Variable [ $filterFind; Value:testlearn::filterFind ]</li>
<li>Set Field [ testlearn::filterFind; $$citationMatch &amp; &para; &amp; $filterFind ]</li>
<li>//  Show Custom Dialog [ Message: "The system has added this learn record to the " &amp;
If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp;

 " citation record set.  You will not have to click the 'all' button anymore to find it for " &amp; If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."

//Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " &amp;
//If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>Else If [ Get ( LayoutTableName ) = "reference" ]</li>
<li>If [ $$citationMatch = "key" ]</li>
<li>If [ "keyword" &amp; &para; &ne; FilterValues ( reference::filterFind ; "keyword" &amp; &para;) ]</li>
<li>Set Variable [ $filterFind; Value:reference::filterFind ]</li>
<li>Set Field [ reference::filterFind; "keyword" &amp; &para; &amp; $filterFind ]</li>
<li>//  Show Custom Dialog [ Message: "The system has added this reference record to the " &amp;
If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp;

 " citation record set.  You will not have to click the 'all' button anymore to find it for " &amp; If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."

//Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " &amp;
//If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>Else If [ $$citationMatch &amp; &para; &ne; FilterValues ( reference::filterFind ; $$citationMatch &amp; &para;) ]</li>
<li>Set Variable [ $filterFind; Value:reference::filterFind ]</li>
<li>Set Field [ reference::filterFind; $$citationMatch &amp; &para; &amp; $filterFind ]</li>
<li>//  Show Custom Dialog [ Message: "The system has added this reference record to the " &amp;
If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp;

 " citation record set.  You will not have to click the 'all' button anymore to find it for " &amp; If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."

//Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " &amp;
//If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Now perform the script that adds the tag.</li>
<li>Perform Script [ &ldquo;CHUNKaddPictureToTag&rdquo; ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearn</em>::kcitation</li>
<li>
<em>testlearn</em>::kcreference</li>
<li>
<em>reference</em>::kfileLocation</li>
<li>
<em>reference</em>::fileName</li>
<li>
<em>reference</em>::URL</li>
<li>
<em>reference</em>::picture</li>
<li>
<em>testlearn</em>::filterFind</li>
<li>
<em>reference</em>::filterFind</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33022ScriptAnchor_">CHUNKaddPictureToTag</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33024ScriptAnchor_"></a><td class="script_navbar"><a href="#33023ScriptAnchor_"><span>Previous Script: [addPicture1ToTag]</span></a></td><td class="script_navbar"><a href="#33309ScriptAnchor_"><span>Parent Folder: [pictures]</span></a></td><td class="script_navbar"><a href="#33025ScriptAnchor_"><span>Next Script: [addPicture3ToTag]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">addPicture2ToTag</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Do not allow learn records to be added to tags as</li>
<li>#that would require insuring all that Learn record's</li>
<li>#reference records tagged onto it were also</li>
<li>#brought into the new section along with all </li>
<li>#their tags, and their tags' tags.  THUS only allow</li>
<li>#Learn records to be added to tags that have a picture</li>
<li>#or link (thus provide value) and have none of the</li>
<li>#above mentioned tags: reference, cite.</li>
<li>#AND once such a tag is added no reference,</li>
<li>#or cite tags can be added to it.  </li>
<li>If [ testlearn::kcitation &ne; "" or testlearn::kcreference &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "Learn records with references or a citation cannot be added to tags.  Doing so would require adding all these reference and cite records' references and cite records, and then all of theirs, and so on.  "; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Note which button has been clicked ( 1, 2 or 3)</li>
<li>#and if there is a picture to show then link it</li>
<li>#to tag user is currently wanting to link it to.</li>
<li>If [ reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "jpg"  
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "gif"  
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "eps"  
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "jp2" 
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "psd"  
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "png"  
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "pct"  
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "pcs"  
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = ".qt"  
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "sgi"  
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "tga"  
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "tif"  
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "bmp"  
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "wmf"  
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "emf"  
or Right ( reference::URL ; 3 )  = "jpg"  
or Right ( reference::URL ; 3 )  = "gif"  
or Right ( reference::URL ; 3 )  = "eps"  
or Right ( reference::URL ; 3 )  = "jp2" 
or Right ( reference::URL ; 3 )  = "psd"  
or Right ( reference::URL ; 3 )  = "png"  
or Right ( reference::URL ; 3 )  = "pct"  
or Right ( reference::URL ; 3 )  = "pcs"  
or Right ( reference::URL ; 3 )  = ".qt"  
or Right ( reference::URL ; 3 )  = "sgi"  
or Right ( reference::URL ; 3 )  = "tga"  
or Right ( reference::URL ; 3 )  = "tif"  
or Right ( reference::URL ; 3 )  = "bmp"  
or Right ( reference::URL ; 3 )  = "wmf"  
or Right ( reference::URL ; 3 )  = "emf" 
or 
reference::picture &ne; "" ]</li>
<li>Set Variable [ $$name; Value:"picture" ]</li>
<li>Set Variable [ $$number; Value:2 ]</li>
<li>#</li>
<li>#If the filterFind checkbox is not checked for the</li>
<li>#the current $$CitationMatch variable, then</li>
<li>#these next scripts will identify that problem,</li>
<li>#fix it, and inform the user of what it did.</li>
<li>If [ Get ( LayoutTableName ) = "testlearn" ]</li>
<li>If [ $$citationMatch = "key" ]</li>
<li>If [ "keyword" &amp; &para; &ne; FilterValues ( testlearn::filterFind ; "keyword" &amp; &para; ) ]</li>
<li>Set Variable [ $filterFind; Value:testlearn::filterFind ]</li>
<li>Set Field [ testlearn::filterFind; "keyword" &amp; &para; &amp; $filterFind ]</li>
<li>//  Show Custom Dialog [ Message: "The system has added this learn record to the " &amp;
If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp;

 " citation record set.  You will not have to click the 'all' button anymore to find it for " &amp; If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."

//Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " &amp;
//If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>Else If [ $$citationMatch &amp; &para; &ne; FilterValues ( testlearn::filterFind ; $$citationMatch &amp; &para; ) ]</li>
<li>Set Variable [ $filterFind; Value:testlearn::filterFind ]</li>
<li>Set Field [ testlearn::filterFind; $$citationMatch &amp; &para; &amp; $filterFind ]</li>
<li>//  Show Custom Dialog [ Message: "The system has added this learn record to the " &amp;
If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp;

 " citation record set.  You will not have to click the 'all' button anymore to find it for " &amp; If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."

//Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " &amp;
//If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>Else If [ Get ( LayoutTableName ) = "reference" ]</li>
<li>If [ $$citationMatch = "key" ]</li>
<li>If [ "keyword" &ne; GetValue ( FilterValues ( reference::filterFind ; "keyword" ) ; 1 ) ]</li>
<li>Set Variable [ $filterFind; Value:reference::filterFind ]</li>
<li>Set Field [ reference::filterFind; "keyword" &amp; &para; &amp; $filterFind ]</li>
<li>//  Show Custom Dialog [ Message: "The system has added this reference record to the " &amp;
If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp;

 " citation record set.  You will not have to click the 'all' button anymore to find it for " &amp; If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."

//Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " &amp;
//If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>Else If [ $$citationMatch &amp; &para; &ne; FilterValues ( reference::filterFind ; $$citationMatch &amp; &para;) ]</li>
<li>Set Variable [ $filterFind; Value:reference::filterFind ]</li>
<li>Set Field [ reference::filterFind; $$citationMatch &amp; &para; &amp; $filterFind ]</li>
<li>//  Show Custom Dialog [ Message: "The system has added this reference record to the " &amp;
If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp;

 " citation record set.  You will not have to click the 'all' button anymore to find it for " &amp; If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."

//Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " &amp;
//If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Now perform the script that adds the tag.</li>
<li>Perform Script [ &ldquo;CHUNKaddPictureToTag&rdquo; ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearn</em>::kcitation</li>
<li>
<em>testlearn</em>::kcreference</li>
<li>
<em>reference</em>::kfileLocation</li>
<li>
<em>reference</em>::fileName</li>
<li>
<em>reference</em>::URL</li>
<li>
<em>reference</em>::picture</li>
<li>
<em>testlearn</em>::filterFind</li>
<li>
<em>reference</em>::filterFind</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33022ScriptAnchor_">CHUNKaddPictureToTag</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33025ScriptAnchor_"></a><td class="script_navbar"><a href="#33024ScriptAnchor_"><span>Previous Script: [addPicture2ToTag]</span></a></td><td class="script_navbar"><a href="#33309ScriptAnchor_"><span>Parent Folder: [pictures]</span></a></td><td class="script_navbar"><a href="#33026ScriptAnchor_"><span>Next Script: [showCitationPicture1inNewWindow]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">addPicture3ToTag</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Do not allow learn records to be added to tags as</li>
<li>#that would require insuring all that Learn record's</li>
<li>#reference records tagged onto it were also</li>
<li>#brought into the new section along with all </li>
<li>#their tags, and their tags' tags.  THUS only allow</li>
<li>#Learn records to be added to tags that have a picture</li>
<li>#or link (thus provide value) and have none of the</li>
<li>#above mentioned tags: reference, cite.</li>
<li>#AND once such a tag is added no reference,</li>
<li>#or cite tags can be added to it.  </li>
<li>If [ testlearn::kcitation &ne; "" or testlearn::kcreference &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "Learn records with references or a citation cannot be added to tags.  Doing so would require adding all these reference and cite records' references and cite records, and then all of theirs, and so on.  "; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Note which button has been clicked ( 1, 2 or 3)</li>
<li>#and if there is a picture to show then link it</li>
<li>#to tag user is currently wanting to link it to.</li>
<li>If [ reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "jpg"  
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "gif"  
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "eps"  
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "jp2" 
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "psd"  
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "png"  
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "pct"  
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "pcs"  
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = ".qt"  
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "sgi"  
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "tga"  
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "tif"  
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "bmp"  
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "wmf"  
or reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and Right ( reference::fileName ; 3 )  = "emf"  
or Right ( reference::URL ; 3 )  = "jpg"  
or Right ( reference::URL ; 3 )  = "gif"  
or Right ( reference::URL ; 3 )  = "eps"  
or Right ( reference::URL ; 3 )  = "jp2" 
or Right ( reference::URL ; 3 )  = "psd"  
or Right ( reference::URL ; 3 )  = "png"  
or Right ( reference::URL ; 3 )  = "pct"  
or Right ( reference::URL ; 3 )  = "pcs"  
or Right ( reference::URL ; 3 )  = ".qt"  
or Right ( reference::URL ; 3 )  = "sgi"  
or Right ( reference::URL ; 3 )  = "tga"  
or Right ( reference::URL ; 3 )  = "tif"  
or Right ( reference::URL ; 3 )  = "bmp"  
or Right ( reference::URL ; 3 )  = "wmf"  
or Right ( reference::URL ; 3 )  = "emf" 
or 
reference::picture &ne; "" ]</li>
<li>Set Variable [ $$name; Value:"picture" ]</li>
<li>Set Variable [ $$number; Value:3 ]</li>
<li>#</li>
<li>#If the filterFind checkbox is not checked for the</li>
<li>#the current $$CitationMatch variable, then</li>
<li>#these next scripts will identify that problem,</li>
<li>#fix it, and inform the user of what it did.</li>
<li>If [ Get ( LayoutTableName ) = "testlearn" ]</li>
<li>If [ $$citationMatch = "key" ]</li>
<li>If [ "keyword" &amp; &para; &ne; FilterValues ( testlearn::filterFind ; "keyword" &amp; &para; ) ]</li>
<li>Set Variable [ $filterFind; Value:testlearn::filterFind ]</li>
<li>Set Field [ testlearn::filterFind; "keyword" &amp; &para; &amp; $filterFind ]</li>
<li>//  Show Custom Dialog [ Message: "The system has added this learn record to the " &amp;
If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp;

 " citation record set.  You will not have to click the 'all' button anymore to find it for " &amp; If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."

//Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " &amp;
//If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>Else If [ $$citationMatch &amp; &para; &ne; FilterValues ( testlearn::filterFind ; $$citationMatch &amp; &para; ) ]</li>
<li>Set Variable [ $filterFind; Value:testlearn::filterFind ]</li>
<li>Set Field [ testlearn::filterFind; $$citationMatch &amp; &para; &amp; $filterFind ]</li>
<li>//  Show Custom Dialog [ Message: "The system has added this learn record to the " &amp;
If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp;

 " citation record set.  You will not have to click the 'all' button anymore to find it for " &amp; If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."

//Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " &amp;
//If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>Else If [ Get ( LayoutTableName ) = "reference" ]</li>
<li>If [ $$citationMatch = "key" ]</li>
<li>If [ "keyword" &amp; &para; &ne; FilterValues ( reference::filterFind ; "keyword" &amp; &para;) ]</li>
<li>Set Variable [ $filterFind; Value:reference::filterFind ]</li>
<li>Set Field [ reference::filterFind; "keyword" &amp; &para; &amp; $filterFind ]</li>
<li>//  Show Custom Dialog [ Message: "The system has added this reference record to the " &amp;
If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp;

 " citation record set.  You will not have to click the 'all' button anymore to find it for " &amp; If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."

//Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " &amp;
//If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>Else If [ $$citationMatch &amp; &para; &ne; FilterValues ( reference::filterFind ; $$citationMatch &amp; &para;) ]</li>
<li>Set Variable [ $filterFind; Value:reference::filterFind ]</li>
<li>Set Field [ reference::filterFind; $$citationMatch &amp; &para; &amp; $filterFind ]</li>
<li>//  Show Custom Dialog [ Message: "The system has added this reference record to the " &amp;
If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp;

 " citation record set.  You will not have to click the 'all' button anymore to find it for " &amp; If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."

//Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " &amp;
//If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Now perform the script that adds the tag.</li>
<li>Perform Script [ &ldquo;CHUNKaddPictureToTag&rdquo; ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearn</em>::kcitation</li>
<li>
<em>testlearn</em>::kcreference</li>
<li>
<em>reference</em>::kfileLocation</li>
<li>
<em>reference</em>::fileName</li>
<li>
<em>reference</em>::URL</li>
<li>
<em>reference</em>::picture</li>
<li>
<em>testlearn</em>::filterFind</li>
<li>
<em>reference</em>::filterFind</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33022ScriptAnchor_">CHUNKaddPictureToTag</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33026ScriptAnchor_"></a><td class="script_navbar"><a href="#33025ScriptAnchor_"><span>Previous Script: [addPicture3ToTag]</span></a></td><td class="script_navbar"><a href="#33309ScriptAnchor_"><span>Parent Folder: [pictures]</span></a></td><td class="script_navbar"><a href="#33056ScriptAnchor_"><span>Next Script: [showCitationPicture2inNewWindow]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">showCitationPicture1inNewWindow</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>#</li>
<li>#Not sure why I decided lock this, but it seems user</li>
<li>#can't do anything to data by viewing pictures so I</li>
<li>#disabled the lock steps below.</li>
<li>//  #If node is currenlty locked then stop script, inform user.</li>
<li>//  If [ tagTLNodePrimary::orderOrLock &ne; "" ]</li>
<li>//  Show Custom Dialog [ Message: "The default node selected is locked.  Select this node in the setup window and enter the password to unlock it, then you will able to add pictures to records assigned to this node."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>//  Exit Script [  ]</li>
<li>//  End If</li>
<li>#</li>
<li>#Determine where picture or movie is located</li>
<li>If [ PatternCount ( Get ( ApplicationVersion ) ; "GO" ) ]</li>
<li>Set Variable [ $$stopLoadCitation; Value:1 ]</li>
<li>New Window [ Height: Get (ScreenHeight); Width: Get (ScreenWidth); Top: 0; Left: 0 ]</li>
<li>If [ Get (LayoutTableName) = "reference" ]</li>
<li>Go to Layout [ &ldquo;ReferencePictureWindow&rdquo; (reference) ]</li>
<li>Else If [ Get (LayoutTableName) = "testlearn" or Get (LayoutTableName) = "testlearnReportTags" ]</li>
<li>Go to Layout [ &ldquo;LearnPictureWindow&rdquo; (testlearn) ]</li>
<li>End If</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Determine where picture or movie is located</li>
<li>#on the reference window and then open it.</li>
<li>If [ Get ( LayoutTableName ) = "test" ]</li>
<li>#To speed up script, stop this script from working.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>//  Go to Field [ reference::picture ]</li>
<li>//  Go to Field [  ]</li>
<li>//  #</li>
<li>//  New Window [ Name: reference::picture; Height: Get (ScreenHeight)/2; Width: Get (ScreenWidth)/2; Top: Get (ScreenHeight)/4; Left: Get (ScreenWidth)/4 ]</li>
<li>//  Go to Layout [ &ldquo;ReferencePictureWindow&rdquo; (reference) ]</li>
<li>Insert Picture [  ]</li>
<li>#</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Pause/Resume Script [ Indefinitely ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Determine where picture or movie is located</li>
<li>#on the reference window and then open it.</li>
<li>If [ reference::picture &ne; ""
or reference::kfileLocation &ne; ""
or reference::URL &ne; "" and Get (LayoutName) &ne; "ReferenceEDIT" ]</li>
<li>If [ reference::picture &ne; "" ]</li>
<li>#To speed up script, stop this script from working.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>Go to Field [ reference::picture ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>New Window [ Name: reference::picture; Height: Get (ScreenHeight)/2; Width: Get (ScreenWidth)/2; Top: Get (ScreenHeight)/4; Left: Get (ScreenWidth)/4 ]</li>
<li>Go to Layout [ &ldquo;ReferencePictureWindow&rdquo; (reference) ]</li>
<li>#</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Pause/Resume Script [ Indefinitely ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( reference::kfileLocation ; "8162011225532313" ) = "8162011225532313" &amp; &para; ]</li>
<li>Open URL [  Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/" &amp; reference::fileName ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Open URL [  Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/" &amp; reference::fileName ; " " ; " " ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( reference::kfileLocation ; "8162011225558314" ) = "8162011225558314" &amp; &para; ]</li>
<li>Open URL [  Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; reference::fileName ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Open URL [  Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; reference::fileName ; " " ; " " ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( reference::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para; ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:/" ; "file:///" ) &amp; tagRefFolderPath::tag ; " " ; "%20" ) &amp;

Case ( Left ( reference::fileName ; 1 ) =  "/" ; Substitute ( reference::fileName ; " " ; "%20" ) ;

 "/" &amp; Substitute ( reference::fileName ; " " ; "%20" ) ) ]
[ No dialog ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:/" ; "file:///" ) &amp; tagRefFolderPath::tag ; " " ; " " ) &amp;

Case ( Left ( reference::fileName ; 1 ) =  "/" ; Substitute ( reference::fileName ; " " ; " " ) ;

 "/" &amp; Substitute ( reference::fileName ; " " ; " " ) ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ reference::URL &ne; "" ]</li>
<li>Open URL [ reference::URL ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Determine where reference picture or movie is located</li>
<li>#on the tag menus window and then open it.</li>
<li>If [ citationPicture1::picture &ne; ""
or citationPicture1::kfileLocation &ne; ""
or citationPicture1::URL &ne; "" ]</li>
<li>If [ citationPicture1::picture &ne; "" ]</li>
<li>#To speed up script, stop this script from working.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>Set Variable [ $picture; Value:tagMenus::Kpicture1 ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>New Window [ Name: citationPicture1::picture; Height: Get (ScreenHeight)/2; Width: Get (ScreenWidth)/2; Top: Get (ScreenHeight)/4; Left: Get (ScreenWidth)/4 ]</li>
<li>Go to Layout [ &ldquo;ReferencePictureWindow&rdquo; (reference) ]</li>
<li>#</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::_Lreference; $picture ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Pause/Resume Script [ Indefinitely ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( citationPicture1::kfileLocation ; "8162011225532313" ) = "8162011225532313" &amp; &para; ]</li>
<li>Open URL [  Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/" &amp; citationPicture1::fileName ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Open URL [  Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/" &amp; citationPicture1::fileName ; " " ; " " ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( citationPicture1::kfileLocation ; "8162011225558314" ) = "8162011225558314" &amp; &para; ]</li>
<li>Open URL [  Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; citationPicture1::fileName ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Open URL [  Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; citationPicture1::fileName ; " " ; " " ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( citationPicture1::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para; ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:/" ; "file:///" ) &amp; tagPathPicture1_button::tag ; " " ; "%20" ) &amp;

Case ( Left ( citationPicture1::fileName ; 1 ) =  "/" ; Substitute ( citationPicture1::fileName ; " " ; "%20" ) ;

 "/" &amp; Substitute ( citationPicture1::fileName ; " " ; "%20" ) ) ]
[ No dialog ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:/" ; "file:///" ) &amp; tagPathPicture1_button::tag ; " " ; " " ) &amp;

Case ( Left ( citationPicture1::fileName ; 1 ) =  "/" ; Substitute ( citationPicture1::fileName ; " " ; " " ) ;

 "/" &amp; Substitute ( citationPicture1::fileName ; " " ; " " ) ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ citationPicture1::URL &ne; "" ]</li>
<li>Open URL [ Substitute ( citationPicture1::URL ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Determine where testlearn picture or movie is located</li>
<li>#on the tag menus window and then open it.</li>
<li>If [ TLPicture1::Picture &ne; ""
or TLPicture1::kfileLocation &ne; ""
or TLPicture1::URL &ne; "" ]</li>
<li>If [ TLPicture1::Picture &ne; "" ]</li>
<li>#To speed up script, stop this script from working.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>Set Variable [ $picture; Value:tagMenus::Kpicture1 ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>New Window [ Name: TLPicture1::Picture; Height: Get (ScreenHeight)/2; Width: Get (ScreenWidth)/2; Top: Get (ScreenHeight)/4; Left: Get (ScreenWidth)/4 ]</li>
<li>Go to Layout [ &ldquo;LearnPictureWindow&rdquo; (testlearn) ]</li>
<li>#</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::_Ltestlearn; $picture ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Pause/Resume Script [ Indefinitely ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( TLPicture1::kfileLocation ; "8162011225532313" ) = "8162011225532313" &amp; &para; ]</li>
<li>Open URL [  Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/" &amp; TLPicture1::filename ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Open URL [  Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/" &amp; TLPicture1::filename ; " " ; " " ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( TLPicture1::kfileLocation ; "8162011225558314" ) = "8162011225558314" &amp; &para; ]</li>
<li>Open URL [  Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; TLPicture1::filename ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Open URL [  Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; TLPicture1::filename ; " " ; " " ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( TLPicture1::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para; ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:/" ; "file:///" ) &amp; tagTLPathPicture1_button::tag ; " " ; "%20" ) &amp;

Case ( Left ( TLPicture1::filename ; 1 ) =  "/" ; Substitute ( TLPicture1::filename ; " " ; "%20" ) ;

 "/" &amp; Substitute ( TLPicture1::filename ; " " ; "%20" ) ) ]
[ No dialog ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:/" ; "file:///" ) &amp; tagTLPathPicture1_button::tag ; " " ; " " ) &amp;

Case ( Left ( TLPicture1::filename ; 1 ) =  "/" ; Substitute ( TLPicture1::filename ; " " ; " " ) ;

 "/" &amp; Substitute ( TLPicture1::filename ; " " ; " " ) ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ TLPicture1::URL &ne; "" ]</li>
<li>Open URL [ Substitute ( TLPicture1::URL ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Determine where testlearn picture or movie is located</li>
<li>#on testlearn Layout and then open it.</li>
<li>If [ testlearn::Picture &ne; ""
or testlearn::kfileLocation &ne; ""
or testlearn::URL &ne; "" ]</li>
<li>If [ testlearn::Picture &ne; "" ]</li>
<li>#To speed up script, stop this script from working.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>New Window [ Name: testlearn::Picture; Height: Get (ScreenHeight)/2; Width: Get (ScreenWidth)/2; Top: Get (ScreenHeight)/4; Left: Get (ScreenWidth)/4 ]</li>
<li>Go to Layout [ &ldquo;LearnPictureWindow&rdquo; (testlearn) ]</li>
<li>Go to Field [ testlearn::Picture ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Pause/Resume Script [ Indefinitely ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>Else If [ FilterValues ( testlearn::kfileLocation ; "8162011225532313" ) = "8162011225532313" &amp; &para; ]</li>
<li>Open URL [  Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/" &amp; testlearn::filename ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Open URL [  Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/" &amp; testlearn::filename ; " " ; " " ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( testlearn::kfileLocation ; "8162011225558314" ) = "8162011225558314" &amp; &para; ]</li>
<li>Open URL [  Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; testlearn::filename ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Open URL [  Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; testlearn::filename ; " " ; " " ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( testlearn::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para; ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:/" ; "file:///" ) &amp; tagTLFolderPath::tag ; " " ; "%20" ) &amp;

Case ( Left ( testlearn::filename ; 1 ) =  "/" ; Substitute ( testlearn::filename ; " " ; "%20" ) ;

 "/" &amp; Substitute ( testlearn::filename ; " " ; "%20" ) ) ]
[ No dialog ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:/" ; "file:///" ) &amp; tagTLFolderPath::tag ; " " ; " " ) &amp;

Case ( Left ( testlearn::filename ; 1 ) =  "/" ; Substitute ( testlearn::filename ; " " ; " " ) ;

 "/" &amp; Substitute ( testlearn::filename ; " " ; " " ) ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ testlearn::URL &ne; "" ]</li>
<li>Open URL [ Substitute ( testlearn::URL ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Determine where testlearn picture or movie is located</li>
<li>#on testlearnDiscoveryTag Layout and then open it.</li>
<li>If [ testlearnReportTags::Picture &ne; ""
//or testlearnReportTags::kfileLocation &ne; ""
//or testlearnReportTags::URL &ne; "" ]</li>
<li>If [ testlearnReportTags::Picture &ne; "" ]</li>
<li>#To speed up script, stop this script from working.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>Close Window [ Name: "Discovery Picture"; Current file ]</li>
<li>New Window [ Name: "Discovery Picture"; Height: Get (ScreenHeight)/2; Width: Get (ScreenWidth)/2; Top: Get (ScreenHeight)/4; Left: Get (ScreenWidth)/4 ]</li>
<li>Go to Layout [ &ldquo;reportPictureWindow&rdquo; (testlearnReportTags) ]</li>
<li>Go to Field [ testlearnReportTags::Picture ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Pause/Resume Script [ Indefinitely ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>//  Else If [ FilterValues ( testlearn::kfileLocation ; "8162011225532313" ) = "8162011225532313" &amp; &para; ]</li>
<li>//  Open URL [  Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/" &amp; testlearn::filename ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>//  Open URL [  Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/" &amp; testlearn::filename ; " " ; " " ) ]
[ No dialog ]</li>
<li>//  Exit Script [  ]</li>
<li>//  Else If [ FilterValues ( testlearn::kfileLocation ; "8162011225558314" ) = "8162011225558314" &amp; &para; ]</li>
<li>//  Open URL [  Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; testlearn::filename ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>//  Open URL [  Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; testlearn::filename ; " " ; " " ) ]
[ No dialog ]</li>
<li>//  Exit Script [  ]</li>
<li>//  Else If [ FilterValues ( testlearn::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para; ]</li>
<li>//  Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:/" ; "file:///" ) &amp; tagTLFolderPath::tag ; " " ; "%20" ) &amp;

Case ( Left ( testlearn::filename ; 1 ) =  "/" ; Substitute ( testlearn::filename ; " " ; "%20" ) ;

 "/" &amp; Substitute ( testlearn::filename ; " " ; "%20" ) ) ]
[ No dialog ]</li>
<li>//  Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:/" ; "file:///" ) &amp; tagTLFolderPath::tag ; " " ; " " ) &amp;

Case ( Left ( testlearn::filename ; 1 ) =  "/" ; Substitute ( testlearn::filename ; " " ; " " ) ;

 "/" &amp; Substitute ( testlearn::filename ; " " ; " " ) ) ]
[ No dialog ]</li>
<li>//  Exit Script [  ]</li>
<li>//  Else If [ testlearn::URL &ne; "" ]</li>
<li>//  Open URL [ Substitute ( testlearn::URL ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>//  Exit Script [  ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Determine where default picture or movie is located</li>
<li>#on default setup Layout and then open it.</li>
<li>If [ defaultPictureRef::picture &ne; ""
or defaultPictureRef::kfileLocation &ne; ""
or defaultPictureRef::URL &ne; "" ]</li>
<li>If [ defaultPictureRef::picture &ne; "" ]</li>
<li>#To speed up script, stop this script from working.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>Set Variable [ $picture; Value:defaultPictureRef::_Lreference ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>New Window [ Name: defaultPictureRef::picture; Height: Get (ScreenHeight)/2; Width: Get (ScreenWidth)/2; Top: Get (ScreenHeight)/4; Left: Get (ScreenWidth)/4 ]</li>
<li>Go to Layout [ &ldquo;ReferencePictureWindow&rdquo; (reference) ]</li>
<li>#</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::_Lreference; $picture ]</li>
<li>Pause/Resume Script [ Indefinitely ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( defaultPictureRef::kfileLocation ; "8162011225532313" ) = "8162011225532313" &amp; &para; ]</li>
<li>Open URL [  Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/" &amp; defaultPictureRef::fileName ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Open URL [  Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/" &amp; defaultPictureRef::fileName ; " " ; " " ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( defaultPictureRef::kfileLocation ; "8162011225558314" ) = "8162011225558314" &amp; &para; ]</li>
<li>Open URL [  Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; defaultPictureRef::fileName ; " " ; " " ) ]
[ No dialog ]</li>
<li>Open URL [  Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; defaultPictureRef::fileName ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( defaultPictureRef::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para; ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:/" ; "file:///" ) &amp; tagDefaultFolderPathRef::tag ; " " ; "%20" ) &amp;

Case ( Left ( defaultPictureRef::fileName ; 1 ) =  "/" ; Substitute ( defaultPictureRef::fileName ; " " ; "%20" ) ;

 "/" &amp; Substitute ( defaultPictureRef::fileName ; " " ; "%20" ) ) ]
[ No dialog ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:/" ; "file:///" ) &amp; tagDefaultFolderPathRef::tag ; " " ; " " ) &amp;

Case ( Left ( defaultPictureRef::fileName ; 1 ) =  "/" ; Substitute ( defaultPictureRef::fileName ; " " ; " " ) ;

 "/" &amp; Substitute ( defaultPictureRef::fileName ; " " ; " " ) ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ defaultPictureRef::URL &ne; "" ]</li>
<li>Open URL [ Substitute ( defaultPictureRef::URL ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Else If [ defaultPictureTL::Picture &ne; ""
or defaultPictureTL::kfileLocation &ne; ""
or defaultPictureTL::URL &ne; "" ]</li>
<li>If [ defaultPictureTL::Picture &ne; "" ]</li>
<li>#To speed up script, stop this script from working.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>Set Variable [ $picture; Value:defaultPictureTL::_Ltestlearn ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>New Window [ Name: defaultPictureTL::Picture; Height: Get (ScreenHeight)/2; Width: Get (ScreenWidth)/2; Top: Get (ScreenHeight)/4; Left: Get (ScreenWidth)/4 ]</li>
<li>Go to Layout [ &ldquo;LearnPictureWindow&rdquo; (testlearn) ]</li>
<li>#</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::_Ltestlearn; $picture ]</li>
<li>Pause/Resume Script [ Indefinitely ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( defaultPictureTL::kfileLocation ; "8162011225532313" ) = "8162011225532313" &amp; &para; ]</li>
<li>Open URL [  Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/" &amp; defaultPictureTL::filename ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Open URL [  Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/" &amp; defaultPictureTL::filename ; " " ; " " ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( defaultPictureTL::kfileLocation ; "8162011225558314" ) = "8162011225558314" &amp; &para; ]</li>
<li>Open URL [  Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; defaultPictureTL::filename ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Open URL [  Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; defaultPictureTL::filename ; " " ; " " ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( defaultPictureTL::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para; ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:/" ; "file:///" ) &amp; tagDefaultFolderPathTL::tag ; " " ; "%20" ) &amp;

Case ( Left ( defaultPictureTL::filename ; 1 ) =  "/" ; Substitute ( defaultPictureTL::filename ; " " ; "%20" ) ;

 "/" &amp; Substitute ( defaultPictureTL::filename ; " " ; "%20" ) ) ]
[ No dialog ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:/" ; "file:///" ) &amp; tagDefaultFolderPathTL::tag ; " " ; " " ) &amp;

Case ( Left ( defaultPictureTL::filename ; 1 ) =  "/" ; Substitute ( defaultPictureTL::filename ; " " ; " " ) ;

 "/" &amp; Substitute ( defaultPictureTL::filename ; " " ; " " ) ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ defaultPictureTL::URL &ne; "" ]</li>
<li>Open URL [ Substitute ( defaultPictureTL::URL ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#If there is no file found then ask user what picture</li>
<li>#to insert.</li>
<li>If [ Get (LayoutTableName) = "reference" and Get ( WindowName ) &ne; "Tag Menus" ]</li>
<li>Go to Field [ reference::picture ]</li>
<li>Show Custom Dialog [ Message: "Select a picture to insert.  "; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Insert Picture [  ]</li>
<li>Go to Field [  ]</li>
<li>Else If [ Get (LayoutTableName) = "testlearn" and Get ( WindowName ) &ne; "Tag Menus" ]</li>
<li>Go to Field [ testlearn::Picture ]</li>
<li>Show Custom Dialog [ Message: "Select a picture to insert.  "; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Insert Picture [  ]</li>
<li>Go to Field [  ]</li>
<li>Else If [ Get (LayoutTableName) = "testlearnReportTags" ]</li>
<li>Close Window [ Name: "Discovery Picture"; Current file ]</li>
<li>New Window [ Name: "Discovery Picture"; Height: Get (ScreenHeight)/2; Width: Get (ScreenWidth)/2; Top: Get (ScreenHeight)/4; Left: Get (ScreenWidth)/4 ]</li>
<li>Go to Layout [ &ldquo;reportPictureWindow&rdquo; (testlearnReportTags) ]</li>
<li>Go to Field [ testlearnReportTags::Picture ]</li>
<li>Show Custom Dialog [ Message: "Select a picture to insert. "; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Insert Picture [  ]</li>
<li>Go to Field [  ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagTLNodePrimary</em>::orderOrLock</li>
<li>
<em>reference</em>::picture</li>
<li>
<em>reference</em>::kfileLocation</li>
<li>
<em>reference</em>::URL</li>
<li>
<em>reference</em>::fileName</li>
<li>
<em>tagRefFolderPath</em>::tag</li>
<li>
<em>citationPicture1</em>::picture</li>
<li>
<em>citationPicture1</em>::kfileLocation</li>
<li>
<em>citationPicture1</em>::URL</li>
<li>
<em>tagMenus</em>::Kpicture1</li>
<li>
<em>reference</em>::_Lreference</li>
<li>
<em>citationPicture1</em>::fileName</li>
<li>
<em>tagPathPicture1_button</em>::tag</li>
<li>
<em>TLPicture1</em>::Picture</li>
<li>
<em>TLPicture1</em>::kfileLocation</li>
<li>
<em>TLPicture1</em>::URL</li>
<li>
<em>testlearn</em>::_Ltestlearn</li>
<li>
<em>TLPicture1</em>::filename</li>
<li>
<em>tagTLPathPicture1_button</em>::tag</li>
<li>
<em>testlearn</em>::Picture</li>
<li>
<em>testlearn</em>::kfileLocation</li>
<li>
<em>testlearn</em>::URL</li>
<li>
<em>testlearn</em>::filename</li>
<li>
<em>tagTLFolderPath</em>::tag</li>
<li>
<em>testlearnReportTags</em>::Picture</li>
<li>
<em>defaultPictureRef</em>::picture</li>
<li>
<em>defaultPictureRef</em>::kfileLocation</li>
<li>
<em>defaultPictureRef</em>::URL</li>
<li>
<em>defaultPictureRef</em>::_Lreference</li>
<li>
<em>defaultPictureRef</em>::fileName</li>
<li>
<em>tagDefaultFolderPathRef</em>::tag</li>
<li>
<em>defaultPictureTL</em>::Picture</li>
<li>
<em>defaultPictureTL</em>::kfileLocation</li>
<li>
<em>defaultPictureTL</em>::URL</li>
<li>
<em>defaultPictureTL</em>::_Ltestlearn</li>
<li>
<em>defaultPictureTL</em>::filename</li>
<li>
<em>tagDefaultFolderPathTL</em>::tag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>ReferencePictureWindow</li>
<li>LearnPictureWindow</li>
<li>reportPictureWindow</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33056ScriptAnchor_"></a><td class="script_navbar"><a href="#33026ScriptAnchor_"><span>Previous Script: [showCitationPicture1inNewWindow]</span></a></td><td class="script_navbar"><a href="#33309ScriptAnchor_"><span>Parent Folder: [pictures]</span></a></td><td class="script_navbar"><a href="#33057ScriptAnchor_"><span>Next Script: [showCitationPicture3inNewWindow]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">showCitationPicture2inNewWindow</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Determine where reference picture or movie is located</li>
<li>#on the tag menus window and then open it.</li>
<li>If [ citationPicture2::picture &ne; ""
or citationPicture2::kfileLocation &ne; ""
or citationPicture2::URL &ne; "" ]</li>
<li>If [ citationPicture2::picture &ne; "" ]</li>
<li>#To speed up script, stop this script from working.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>Set Variable [ $picture; Value:tagMenus::Kpicture2 ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>New Window [ Name: citationPicture2::picture; Height: Get (ScreenHeight)/2; Width: Get (ScreenWidth)/2; Top: Get (ScreenHeight)/4; Left: Get (ScreenWidth)/4 ]</li>
<li>Go to Layout [ &ldquo;ReferencePictureWindow&rdquo; (reference) ]</li>
<li>#</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::_Lreference; $picture ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Pause/Resume Script [ Indefinitely ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( citationPicture2::kfileLocation ; "8162011225532313" ) = "8162011225532313" &amp; &para; ]</li>
<li>Open URL [  Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/" &amp; citationPicture2::fileName ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( citationPicture2::kfileLocation ; "8162011225558314" ) = "8162011225558314" &amp; &para; ]</li>
<li>Open URL [  Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; citationPicture2::fileName ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( citationPicture2::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para; ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:/" ; "file:///" ) &amp; tagPathPicture2_button::tag ; " " ; "%20" ) &amp;

Case ( Left ( citationPicture2::fileName ; 1 ) =  "/" ; Substitute ( citationPicture2::fileName ; " " ; "%20" ) ;

 "/" &amp; Substitute ( citationPicture2::fileName ; " " ; "%20" ) ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ citationPicture2::URL &ne; "" ]</li>
<li>Open URL [ Substitute ( citationPicture2::URL ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Determine where testlearn picture or movie is located</li>
<li>#on the tag menus window and then open it.</li>
<li>If [ TLPicture2::Picture &ne; ""
or TLPicture2::kfileLocation &ne; ""
or TLPicture2::URL &ne; "" ]</li>
<li>If [ TLPicture2::Picture &ne; "" ]</li>
<li>#To speed up script, stop this script from working.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>Set Variable [ $picture; Value:tagMenus::Kpicture2 ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>New Window [ Name: TLPicture2::Picture; Height: Get (ScreenHeight)/2; Width: Get (ScreenWidth)/2; Top: Get (ScreenHeight)/4; Left: Get (ScreenWidth)/4 ]</li>
<li>Go to Layout [ &ldquo;LearnPictureWindow&rdquo; (testlearn) ]</li>
<li>#</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::_Ltestlearn; $picture ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Pause/Resume Script [ Indefinitely ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( TLPicture2::kfileLocation ; "8162011225532313" ) = "8162011225532313" &amp; &para; ]</li>
<li>Open URL [  Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/" &amp; TLPicture2::filename ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( TLPicture2::kfileLocation ; "8162011225558314" ) = "8162011225558314" &amp; &para; ]</li>
<li>Open URL [  Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; TLPicture2::filename ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( TLPicture2::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para; ]</li>
<li>Open URL [ Substitute ( tagTLPathPicture2_button::tag &amp; TLPicture2::filename ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ TLPicture2::URL &ne; "" ]</li>
<li>Open URL [ Substitute ( TLPicture2::URL ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>citationPicture2</em>::picture</li>
<li>
<em>citationPicture2</em>::kfileLocation</li>
<li>
<em>citationPicture2</em>::URL</li>
<li>
<em>tagMenus</em>::Kpicture2</li>
<li>
<em>reference</em>::_Lreference</li>
<li>
<em>citationPicture2</em>::fileName</li>
<li>
<em>tagPathPicture2_button</em>::tag</li>
<li>
<em>TLPicture2</em>::Picture</li>
<li>
<em>TLPicture2</em>::kfileLocation</li>
<li>
<em>TLPicture2</em>::URL</li>
<li>
<em>testlearn</em>::_Ltestlearn</li>
<li>
<em>TLPicture2</em>::filename</li>
<li>
<em>tagTLPathPicture2_button</em>::tag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>ReferencePictureWindow</li>
<li>LearnPictureWindow</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33057ScriptAnchor_"></a><td class="script_navbar"><a href="#33056ScriptAnchor_"><span>Previous Script: [showCitationPicture2inNewWindow]</span></a></td><td class="script_navbar"><a href="#33309ScriptAnchor_"><span>Parent Folder: [pictures]</span></a></td><td class="script_navbar"><a href="#33053ScriptAnchor_"><span>Next Script: [showReferencePicture1]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">showCitationPicture3inNewWindow</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Determine where reference picture or movie is located</li>
<li>#on the tag menus window and then open it.</li>
<li>If [ citationPicture3::picture &ne; ""
or citationPicture3::kfileLocation &ne; ""
or citationPicture3::URL &ne; "" ]</li>
<li>If [ citationPicture3::picture &ne; "" ]</li>
<li>#To speed up script, stop this script from working.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>Set Variable [ $picture; Value:tagMenus::Kpicture3 ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>New Window [ Name: citationPicture3::picture; Height: Get (ScreenHeight)/2; Width: Get (ScreenWidth)/2; Top: Get (ScreenHeight)/4; Left: Get (ScreenWidth)/4 ]</li>
<li>Go to Layout [ &ldquo;ReferencePictureWindow&rdquo; (reference) ]</li>
<li>#</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::_Lreference; $picture ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Pause/Resume Script [ Indefinitely ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( citationPicture3::kfileLocation ; "8162011225532313" ) = "8162011225532313" &amp; &para; ]</li>
<li>Open URL [  Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/" &amp; citationPicture3::fileName ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( citationPicture3::kfileLocation ; "8162011225558314" ) = "8162011225558314" &amp; &para; ]</li>
<li>Open URL [  Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; citationPicture3::fileName ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( citationPicture3::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para; ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:/" ; "file:///" ) &amp; tagPathPicture3_button::tag ; " " ; "%20" ) &amp;

Case ( Left ( citationPicture3::fileName ; 1 ) =  "/" ; Substitute ( citationPicture3::fileName ; " " ; "%20" ) ;

 "/" &amp; Substitute ( citationPicture3::fileName ; " " ; "%20" ) ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ citationPicture3::URL &ne; "" ]</li>
<li>Open URL [ Substitute ( citationPicture3::URL ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Determine where testlearn picture or movie is located</li>
<li>#on the tag menus window and then open it.</li>
<li>If [ TLPicture3::Picture &ne; ""
or TLPicture3::kfileLocation &ne; ""
or TLPicture3::URL &ne; "" ]</li>
<li>If [ TLPicture3::Picture &ne; "" ]</li>
<li>#To speed up script, stop this script from working.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>Set Variable [ $picture; Value:tagMenus::Kpicture3 ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>New Window [ Name: TLPicture3::Picture; Height: Get (ScreenHeight)/2; Width: Get (ScreenWidth)/2; Top: Get (ScreenHeight)/4; Left: Get (ScreenWidth)/4 ]</li>
<li>Go to Layout [ &ldquo;LearnPictureWindow&rdquo; (testlearn) ]</li>
<li>#</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::_Ltestlearn; $picture ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Pause/Resume Script [ Indefinitely ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( TLPicture3::kfileLocation ; "8162011225532313" ) = "8162011225532313" &amp; &para; ]</li>
<li>Open URL [  Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/" &amp; TLPicture3::filename ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( TLPicture3::kfileLocation ; "8162011225558314" ) = "8162011225558314" &amp; &para; ]</li>
<li>Open URL [  Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; TLPicture3::filename ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( TLPicture3::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para; ]</li>
<li>Open URL [ Substitute ( tagTLPathPicture3_button::tag &amp; TLPicture3::filename ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ TLPicture3::URL &ne; "" ]</li>
<li>Open URL [ Substitute ( TLPicture3::URL ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>citationPicture3</em>::picture</li>
<li>
<em>citationPicture3</em>::kfileLocation</li>
<li>
<em>citationPicture3</em>::URL</li>
<li>
<em>tagMenus</em>::Kpicture3</li>
<li>
<em>reference</em>::_Lreference</li>
<li>
<em>citationPicture3</em>::fileName</li>
<li>
<em>tagPathPicture3_button</em>::tag</li>
<li>
<em>TLPicture3</em>::Picture</li>
<li>
<em>TLPicture3</em>::kfileLocation</li>
<li>
<em>TLPicture3</em>::URL</li>
<li>
<em>testlearn</em>::_Ltestlearn</li>
<li>
<em>TLPicture3</em>::filename</li>
<li>
<em>tagTLPathPicture3_button</em>::tag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>ReferencePictureWindow</li>
<li>LearnPictureWindow</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33053ScriptAnchor_"></a><td class="script_navbar"><a href="#33057ScriptAnchor_"><span>Previous Script: [showCitationPicture3inNewWindow]</span></a></td><td class="script_navbar"><a href="#33309ScriptAnchor_"><span>Parent Folder: [pictures]</span></a></td><td class="script_navbar"><a href="#33054ScriptAnchor_"><span>Next Script: [showReferencePicture2]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">showReferencePicture1</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If user is not in add mode then inform user they</li>
<li>#must be before the database will show them reference</li>
<li>#data.  The reason for this is because the layout</li>
<li>#in the reference or learn window changes to the</li>
<li>#add tag from these windows to the Tag Menu</li>
<li>#item selected.  So instead of having the system</li>
<li>#automatically go into add mode, the user must</li>
<li>#decide they want to do this and thus be expecting</li>
<li>#a change in the layouts.  Otherwise this change</li>
<li>#could confuse a user.  So at the cost of minor </li>
<li>#inconvience I have choose not to have the system</li>
<li>#guess the user wants to go into add mode and is </li>
<li>#expecting the system to do that when they click</li>
<li>#one of these numbered buttons on the showEvenMore</li>
<li>#layouts.</li>
<li>If [ $$add = "" ]</li>
<li>Show Custom Dialog [ Message: "Click the 'add' button above and then click this button to see citation for this item. "; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If the field is blank then stop the script.</li>
<li>#No poin in looking for a record where there isn't one.</li>
<li>If [ tagMenus::Kpicture1 = "" ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Capture the key to unlock the record it belongs to.</li>
<li>Set Variable [ $key; Value:tagMenus::Kpicture1 ]</li>
<li>#</li>
<li>#Determine if the key comes from the testlearn</li>
<li>#table, and if so perform these script steps.</li>
<li>If [ TLPicture1::_Ltestlearn &ne; "" ]</li>
<li>#</li>
<li>#Select the correct window and then change its</li>
<li>#name if neccessary to match the table the </li>
<li>#records are coming from.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>End If</li>
<li>Set Window Title [ Current Window; New Title: "Learn" ]</li>
<li>Go to Layout [ &lt;unknown&gt; ]</li>
<li>#</li>
<li>#Prevent record loading script during loops to</li>
<li>#find wanted record, which would slow down system.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>#</li>
<li>#Now loop thru all the records until the record</li>
<li>#that fits the key is found.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ testlearn::_Ltestlearn = $key ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Allow the record load script to run and run it.</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Perform Script [ &ldquo;loadCitation&rdquo; ]</li>
<li>#</li>
<li>#Put focus back on Tag Menus window and conditionally</li>
<li>#format any items that may be linked to record</li>
<li>#in the other window.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#Determine if the key comes from the reference</li>
<li>#table, and if so perform these script steps.</li>
<li>Else If [ citationPicture1::_Lreference &ne; "" ]</li>
<li>#</li>
<li>#Select the correct window and then change its</li>
<li>#name if neccessary to match the table the </li>
<li>#records are coming from.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>End If</li>
<li>Set Window Title [ Current Window; New Title: "References" ]</li>
<li>Go to Layout [ &ldquo;ReferenceAddToTag&rdquo; (reference) ]</li>
<li>#</li>
<li>#Prevent record loading script during loops to</li>
<li>#find wanted record, which would slow down system.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>#</li>
<li>#Now loop thru all the records until the record</li>
<li>#that fits the key is found.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ reference::_Lreference = $key ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Allow the record load script to run and run it.</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Perform Script [ &ldquo;loadCitation&rdquo; ]</li>
<li>#</li>
<li>#Put focus back on Tag Menus window and conditionally</li>
<li>#format any items that may be linked to record</li>
<li>#in the other window.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagMenus</em>::Kpicture1</li>
<li>
<em>TLPicture1</em>::_Ltestlearn</li>
<li>
<em>testlearn</em>::_Ltestlearn</li>
<li>
<em>citationPicture1</em>::_Lreference</li>
<li>
<em>reference</em>::_Lreference</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32984ScriptAnchor_">loadCitation</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>&lt;Missing Layout&gt;</li>
<li>ReferenceAddToTag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33054ScriptAnchor_"></a><td class="script_navbar"><a href="#33053ScriptAnchor_"><span>Previous Script: [showReferencePicture1]</span></a></td><td class="script_navbar"><a href="#33309ScriptAnchor_"><span>Parent Folder: [pictures]</span></a></td><td class="script_navbar"><a href="#33055ScriptAnchor_"><span>Next Script: [showReferencePicture3]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">showReferencePicture2</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If user is not in add mode then inform user they</li>
<li>#must be before the database will show them reference</li>
<li>#data.  The reason for this is because the layout</li>
<li>#in the reference or learn window changes to the</li>
<li>#add tag from these windows to the Tag Menu</li>
<li>#item selected.  So instead of having the system</li>
<li>#automatically go into add mode, the user must</li>
<li>#decide they want to do this and thus be expecting</li>
<li>#a change in the layouts.  Otherwise this change</li>
<li>#could confuse a user.  So at the cost of minor </li>
<li>#inconvience I have choose not to have the system</li>
<li>#guess the user wants to go into add mode and is </li>
<li>#expecting the system to do that when they click</li>
<li>#one of these numbered buttons on the showEvenMore</li>
<li>#layouts.</li>
<li>If [ $$add = "" ]</li>
<li>Show Custom Dialog [ Message: "Click the 'add' button above and then click this button to see citation for this item. "; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If the field is blank then stop the script.</li>
<li>#No poin in looking for a record where there isn't one.</li>
<li>If [ tagMenus::Kpicture2 = "" ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Capture the key to unlock the record it belongs to.</li>
<li>Set Variable [ $key; Value:tagMenus::Kpicture2 ]</li>
<li>#</li>
<li>#Determine if the key comes from the testlearn</li>
<li>#table, and if so perform these script steps.</li>
<li>If [ TLPicture2::_Ltestlearn &ne; "" ]</li>
<li>#</li>
<li>#Select the correct window and then change its</li>
<li>#name if neccessary to match the table the </li>
<li>#records are coming from.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>End If</li>
<li>Set Window Title [ Current Window; New Title: "Learn" ]</li>
<li>Go to Layout [ &lt;unknown&gt; ]</li>
<li>#</li>
<li>#Prevent record loading script during loops to</li>
<li>#find wanted record, which would slow down system.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>#</li>
<li>#Now loop thru all the records until the record</li>
<li>#that fits the key is found.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ testlearn::_Ltestlearn = $key ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Allow the record load script to run and run it.</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Perform Script [ &ldquo;loadCitation&rdquo; ]</li>
<li>#</li>
<li>#Put focus back on Tag Menus window and conditionally</li>
<li>#format any items that may be linked to record</li>
<li>#in the other window.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#Determine if the key comes from the reference</li>
<li>#table, and if so perform these script steps.</li>
<li>Else If [ citationPicture2::_Lreference &ne; "" ]</li>
<li>#</li>
<li>#Select the correct window and then change its</li>
<li>#name if neccessary to match the table the </li>
<li>#records are coming from.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>End If</li>
<li>Set Window Title [ Current Window; New Title: "References" ]</li>
<li>Go to Layout [ &ldquo;ReferenceAddToTag&rdquo; (reference) ]</li>
<li>#</li>
<li>#Prevent record loading script during loops to</li>
<li>#find wanted record, which would slow down system.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>#</li>
<li>#Now loop thru all the records until the record</li>
<li>#that fits the key is found.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ reference::_Lreference = $key ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#If key is not found in this section's set of records</li>
<li>#then look for it in the other sections.</li>
<li>If [ reference::_Lreference &ne; $key ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::_Lreference; $key ]</li>
<li>Extend Found Set [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Allow the record load script to run and run it.</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Perform Script [ &ldquo;loadCitation&rdquo; ]</li>
<li>#</li>
<li>#Put focus back on Tag Menus window and conditionally</li>
<li>#format any items that may be linked to record</li>
<li>#in the other window.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagMenus</em>::Kpicture2</li>
<li>
<em>TLPicture2</em>::_Ltestlearn</li>
<li>
<em>testlearn</em>::_Ltestlearn</li>
<li>
<em>citationPicture2</em>::_Lreference</li>
<li>
<em>reference</em>::_Lreference</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32984ScriptAnchor_">loadCitation</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>&lt;Missing Layout&gt;</li>
<li>ReferenceAddToTag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33055ScriptAnchor_"></a><td class="script_navbar"><a href="#33054ScriptAnchor_"><span>Previous Script: [showReferencePicture2]</span></a></td><td class="script_navbar"><a href="#33309ScriptAnchor_"><span>Parent Folder: [pictures]</span></a></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">showReferencePicture3</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If user is not in add mode then inform user they</li>
<li>#must be before the database will show them reference</li>
<li>#data.  The reason for this is because the layout</li>
<li>#in the reference or learn window changes to the</li>
<li>#add tag from these windows to the Tag Menu</li>
<li>#item selected.  So instead of having the system</li>
<li>#automatically go into add mode, the user must</li>
<li>#decide they want to do this and thus be expecting</li>
<li>#a change in the layouts.  Otherwise this change</li>
<li>#could confuse a user.  So at the cost of minor </li>
<li>#inconvience I have choose not to have the system</li>
<li>#guess the user wants to go into add mode and is </li>
<li>#expecting the system to do that when they click</li>
<li>#one of these numbered buttons on the showEvenMore</li>
<li>#layouts.</li>
<li>If [ $$add = "" ]</li>
<li>Show Custom Dialog [ Message: "Click the 'add' button above and then click this button to see citation for this item. "; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If the field is blank then stop the script.</li>
<li>#No poin in looking for a record where there isn't one.</li>
<li>If [ tagMenus::Kpicture3 = "" ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Capture the key to unlock the record it belongs to.</li>
<li>Set Variable [ $key; Value:tagMenus::Kpicture3 ]</li>
<li>#</li>
<li>#Determine if the key comes from the testlearn</li>
<li>#table, and if so perform these script steps.</li>
<li>If [ TLPicture3::_Ltestlearn &ne; "" ]</li>
<li>#</li>
<li>#Select the correct window and then change its</li>
<li>#name if neccessary to match the table the </li>
<li>#records are coming from.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>End If</li>
<li>Set Window Title [ Current Window; New Title: "Learn" ]</li>
<li>Go to Layout [ &lt;unknown&gt; ]</li>
<li>#</li>
<li>#Prevent record loading script during loops to</li>
<li>#find wanted record, which would slow down system.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>#</li>
<li>#Now loop thru all the records until the record</li>
<li>#that fits the key is found.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ testlearn::_Ltestlearn = $key ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Allow the record load script to run and run it.</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Perform Script [ &ldquo;loadCitation&rdquo; ]</li>
<li>#</li>
<li>#Put focus back on Tag Menus window and conditionally</li>
<li>#format any items that may be linked to record</li>
<li>#in the other window.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#Determine if the key comes from the reference</li>
<li>#table, and if so perform these script steps.</li>
<li>Else If [ citationPicture3::_Lreference &ne; "" ]</li>
<li>#</li>
<li>#Select the correct window and then change its</li>
<li>#name if neccessary to match the table the </li>
<li>#records are coming from.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>End If</li>
<li>Set Window Title [ Current Window; New Title: "References" ]</li>
<li>Go to Layout [ &ldquo;ReferenceAddToTag&rdquo; (reference) ]</li>
<li>#</li>
<li>#Prevent record loading script during loops to</li>
<li>#find wanted record, which would slow down system.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>#</li>
<li>#Now loop thru all the records until the record</li>
<li>#that fits the key is found.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ reference::_Lreference = $key ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Allow the record load script to run and run it.</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Perform Script [ &ldquo;loadCitation&rdquo; ]</li>
<li>#</li>
<li>#Put focus back on Tag Menus window and conditionally</li>
<li>#format any items that may be linked to record</li>
<li>#in the other window.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagMenus</em>::Kpicture3</li>
<li>
<em>TLPicture3</em>::_Ltestlearn</li>
<li>
<em>testlearn</em>::_Ltestlearn</li>
<li>
<em>citationPicture3</em>::_Lreference</li>
<li>
<em>reference</em>::_Lreference</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32984ScriptAnchor_">loadCitation</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>&lt;Missing Layout&gt;</li>
<li>ReferenceAddToTag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<p>
<span class="partheading"><a name="33331ScriptAnchor_"></a><a href="#33331ScriptAnchor_toc">probablyNotInUse</a></span>
</p>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33146ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"><a href="#33331ScriptAnchor_"><span>Parent Folder: [probablyNotInUse]</span></a></td><td class="script_navbar"><a href="#33147ScriptAnchor_"><span>Next Script: [inUsePart2picture4 Copy]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">inUsePart2picture3 Copy</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#</li>
<li>#</li>
<li>Go to Field [ report::_kfPhoto3 ]</li>
<li>Perform Script [ &ldquo;inUsePart3&rdquo; ]</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>report</em>::_kfPhoto3</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32803ScriptAnchor_">inUsePart3</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33147ScriptAnchor_"></a><td class="script_navbar"><a href="#33146ScriptAnchor_"><span>Previous Script: [inUsePart2picture3 Copy]</span></a></td><td class="script_navbar"><a href="#33331ScriptAnchor_"><span>Parent Folder: [probablyNotInUse]</span></a></td><td class="script_navbar"><a href="#33187ScriptAnchor_"><span>Next Script: [addPicture2ToTag Copy]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">inUsePart2picture4 Copy</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#</li>
<li>#</li>
<li>Go to Field [ report::_kfPhoto4 ]</li>
<li>Perform Script [ &ldquo;inUsePart3&rdquo; ]</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>report</em>::_kfPhoto4</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32803ScriptAnchor_">inUsePart3</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33187ScriptAnchor_"></a><td class="script_navbar"><a href="#33147ScriptAnchor_"><span>Previous Script: [inUsePart2picture4 Copy]</span></a></td><td class="script_navbar"><a href="#33331ScriptAnchor_"><span>Parent Folder: [probablyNotInUse]</span></a></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">addPicture2ToTag Copy</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Do not allow learn records to be added to tags as</li>
<li>#that would require insuring all that Learn record's</li>
<li>#reference records tagged onto it were also</li>
<li>#brought into the new section along with all </li>
<li>#their tags, and their tags' tags.  THUS only allow</li>
<li>#Learn records to be added to tags that have a picture</li>
<li>#or link (thus provide value) and have none of the</li>
<li>#above mentioned tags: reference, cite.</li>
<li>#AND once such a tag is added no reference,</li>
<li>#or cite tags can be added to it.  </li>
<li>If [ testlearn::kcitation &ne; "" or testlearn::kcreference &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "Learn records with references or a citation cannot be added to tags.  Doing so would require adding all these reference and cite records' references and cite records, and then all of theirs, and so on.  "; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Note which button has been clicked ( 1, 2 or 3)</li>
<li>#and if there is a picture to show then link it</li>
<li>#to tag user is currently wanting to link it to.</li>
<li>If [ reference::kfileLocation &ne; ""  and reference::fileName &ne; "" and  ruleCitationCategoryMedium::name = "picture"
 or 
ruleCitationCategoryMedium::name = "picture" and reference::URL &ne; ""
 or 
testlearn::kfileLocation &ne; ""  and testlearn::filename &ne; "" and  ruleTLCategoryMedium::name = "picture"
 or 
ruleTLCategoryMedium::name = "picture" and testlearn::URL &ne; "" ]</li>
<li>Set Variable [ $$name; Value:"picture" ]</li>
<li>Set Variable [ $$number; Value:2 ]</li>
<li>#</li>
<li>#If the filterFind checkbox is not checked for the</li>
<li>#the current $$CitationMatch variable, then</li>
<li>#these next scripts will identify that problem,</li>
<li>#fix it, and inform the user of what it did.</li>
<li>If [ Get ( LayoutTableName ) = "testlearn" ]</li>
<li>If [ $$citationMatch = "key" and "keyword" &amp; &para; &ne; FilterValues ( testlearn::filterFind ; "keyword" ) ]</li>
<li>Set Variable [ $filterFind; Value:testlearn::filterFind ]</li>
<li>Set Field [ testlearn::filterFind; "keyword" &amp; &para; &amp; $filterFind ]</li>
<li>Show Custom Dialog [ Message: "The system has added this learn record to the " &amp;
If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp;

 " citation record set.  You will not have to click the 'all' button anymore to find it for " &amp; If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."

//Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " &amp;
//If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Else If [ $$citationMatch &amp; &para; &ne; FilterValues ( testlearn::filterFind ; $$citationMatch ) ]</li>
<li>Set Variable [ $filterFind; Value:testlearn::filterFind ]</li>
<li>Set Field [ testlearn::filterFind; $$citationMatch &amp; &para; &amp; $filterFind ]</li>
<li>Show Custom Dialog [ Message: "The system has added this learn record to the " &amp;
If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp;

 " citation record set.  You will not have to click the 'all' button anymore to find it for " &amp; If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."

//Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " &amp;
//If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>Else If [ Get ( LayoutTableName ) = "reference" ]</li>
<li>If [ $$citationMatch = "key" and "keyword" &amp; &para; &ne; FilterValues ( reference::filterFind ; "keyword" ) ]</li>
<li>Set Variable [ $filterFind; Value:reference::filterFind ]</li>
<li>Set Field [ reference::filterFind; "keyword" &amp; &para; &amp; $filterFind ]</li>
<li>Show Custom Dialog [ Message: "The system has added this reference record to the " &amp;
If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp;

 " citation record set.  You will not have to click the 'all' button anymore to find it for " &amp; If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."

//Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " &amp;
//If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Else If [ $$citationMatch &amp; &para; &ne; FilterValues ( reference::filterFind ; $$citationMatch ) ]</li>
<li>Set Variable [ $filterFind; Value:reference::filterFind ]</li>
<li>Set Field [ reference::filterFind; $$citationMatch &amp; &para; &amp; $filterFind ]</li>
<li>Show Custom Dialog [ Message: "The system has added this reference record to the " &amp;
If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp;

 " citation record set.  You will not have to click the 'all' button anymore to find it for " &amp; If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."

//Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " &amp;
//If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Now perform the script that adds the tag.</li>
<li>Perform Script [ &ldquo;CHUNKaddPictureToTag&rdquo; ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearn</em>::kcitation</li>
<li>
<em>testlearn</em>::kcreference</li>
<li>
<em>reference</em>::kfileLocation</li>
<li>
<em>reference</em>::fileName</li>
<li>
<em>ruleCitationCategoryMedium</em>::name</li>
<li>
<em>reference</em>::URL</li>
<li>
<em>testlearn</em>::kfileLocation</li>
<li>
<em>testlearn</em>::filename</li>
<li>
<em>ruleTLCategoryMedium</em>::name</li>
<li>
<em>testlearn</em>::URL</li>
<li>
<em>testlearn</em>::filterFind</li>
<li>
<em>reference</em>::filterFind</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33022ScriptAnchor_">CHUNKaddPictureToTag</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<p>
<span class="partheading"><a name="33319ScriptAnchor_"></a><a href="#33319ScriptAnchor_toc">learn</a></span>
</p>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33091ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"><a href="#33319ScriptAnchor_"><span>Parent Folder: [learn]</span></a></td><td class="script_navbar"><a href="#33125ScriptAnchor_"><span>Next Script: [deleteLearnMainRecord]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">showFileInTagandLearnWindows</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Show reference file.</li>
<li>If [ FilterValues ( reference::kfileLocation ; "8162011225532313" ) = "8162011225532313" &amp; &para; ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/"  &amp; reference::fileName ; " " ; " " ) ]
[ No dialog ]</li>
<li>If [ Get ( LastError ) &ne; 0 ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/"  &amp; reference::fileName ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>End If</li>
<li>If [ Get (LastError) = 5 ]</li>
<li>Show Custom Dialog [ Message: "The file has been deleted, moved from, or never downloaded/moved into this library's x folder, OR its name has been changed from " &amp; reference::fileName &amp; "."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>Else If [ FilterValues ( reference::kfileLocation ; "8162011225558314" ) = "8162011225558314" &amp; &para; ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9)  &amp; reference::fileName ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>If [ Get ( LastError ) &ne; 0 ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9)  &amp; reference::fileName ; " " ; " " ) ]
[ No dialog ]</li>
<li>End If</li>
<li>If [ Get (LastError) = 5 ]</li>
<li>Show Custom Dialog [ Message: "The file has been deleted, moved from, or never downloaded/moved into this library's main folder, OR its name has been changed from " &amp; reference::fileName &amp; "."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( reference::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para; ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:/" ; "file:///" ) &amp; tagRefFolderPath::tag ; " " ; "%20" ) &amp;

Case ( Left ( reference::fileName ; 1 ) =  "/" ; Substitute ( reference::fileName ; " " ; "%20" ) ;

 "/" &amp; Substitute ( reference::fileName ; " " ; "%20" ) ) ]
[ No dialog ]</li>
<li>If [ Get ( LastError ) &ne; 0 ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:/" ; "file:///" ) &amp; tagRefFolderPath::tag ; " " ; " " ) &amp;

Case ( Left ( reference::fileName ; 1 ) =  "/" ; Substitute ( reference::fileName ; " " ; " " ) ;

 "/" &amp; Substitute ( reference::fileName ; " " ; " " ) ) ]
[ No dialog ]</li>
<li>End If</li>
<li>If [ Get (LastError) = 5 ]</li>
<li>Show Custom Dialog [ Message: "The file has been deleted, moved from, or never downloaded/moved into " &amp; tagRefFolderPath::tag &amp;  "," &amp; " or the external drive it is on is not plugged in, or it's name was changed from " &amp; reference::fileName &amp; "."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Show cite file from testlearn window.</li>
<li>If [ FilterValues ( citeCite::kfileLocation ; "8162011225532313" ) = "8162011225532313" &amp; &para; ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/"  &amp; citeCite::fileName ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>If [ Get ( LastError ) &ne; 0 ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/"  &amp; citeCite::fileName ; " " ; " " ) ]
[ No dialog ]</li>
<li>End If</li>
<li>If [ Get (LastError) = 5 ]</li>
<li>Show Custom Dialog [ Message: "The file has been deleted, moved from, or never downloaded/moved into this library's x folder, OR its name has been changed from " &amp; reference::fileName &amp; "."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>Else If [ FilterValues ( citeCite::kfileLocation ; "8162011225558314" ) = "8162011225558314" &amp; &para; ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9)  &amp; citeCite::fileName ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>If [ Get ( LastError ) &ne; 0 ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9)  &amp; citeCite::fileName ; " " ; " " ) ]
[ No dialog ]</li>
<li>End If</li>
<li>If [ Get (LastError) = 5 ]</li>
<li>Show Custom Dialog [ Message: "The file has been deleted, moved from, or never downloaded/moved into this library's main folder, OR its name has been changed from " &amp; reference::fileName &amp; "."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( citeCite::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para; ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:/" ; "file:///" ) &amp; TLciteFolderPath::tag ; " " ; "%20" ) &amp;

Case ( Left ( citeCite::fileName ; 1 ) =  "/" ; Substitute ( citeCite::fileName ; " " ; "%20" ) ;

 "/" &amp; Substitute ( citeCite::fileName ; " " ; "%20" ) ) ]
[ No dialog ]</li>
<li>If [ Get ( LastError ) &ne; 0 ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:/" ; "file:///" ) &amp; TLciteFolderPath::tag ; " " ; " " ) &amp;

Case ( Left ( citeCite::fileName ; 1 ) =  "/" ; Substitute ( citeCite::fileName ; " " ; " " ) ;

 "/" &amp; Substitute ( citeCite::fileName ; " " ; " " ) ) ]
[ No dialog ]</li>
<li>End If</li>
<li>If [ Get (LastError) = 5 ]</li>
<li>Show Custom Dialog [ Message: "The file has been deleted, moved from, or never downloaded/moved into " &amp; tagRefFolderPath::tag &amp;  "," &amp; " or the external drive it is on is not plugged in, or it's name was changed from " &amp; reference::fileName &amp; "."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Show 1st ref file from testlearn window.</li>
<li>If [ FilterValues ( refReference::kfileLocation ; "8162011225532313" ) = "8162011225532313" &amp; &para; ]</li>
<li>If [ ValueCount ( testlearn::kcreference ) &gt; 1 ]</li>
<li>Show Custom Dialog [ Message: "This is the first reference attached to this record.  To see all references, click the 'QV' button in the Learn window or the 'references' button in the Tag Menus window."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/"  &amp; refReference::fileName ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>If [ Get ( LastError ) &ne; 0 ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/"  &amp; refReference::fileName ; " " ; " " ) ]
[ No dialog ]</li>
<li>End If</li>
<li>If [ Get (LastError) = 5 ]</li>
<li>Show Custom Dialog [ Message: "The file has been deleted, moved from, or never downloaded/moved into this library's x folder, OR its name has been changed from " &amp; reference::fileName &amp; "."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>Else If [ FilterValues ( refReference::kfileLocation ; "8162011225558314" ) = "8162011225558314" &amp; &para; ]</li>
<li>If [ ValueCount ( testlearn::kcreference ) &gt; 1 ]</li>
<li>Show Custom Dialog [ Message: "This is the first reference attached to this record.  To see all references, click the 'QV' button in the Learn window or the 'references' button in the Tag Menus window."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9)  &amp; refReference::fileName ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>If [ Get ( LastError ) &ne; 0 ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9)  &amp; refReference::fileName ; " " ; " " ) ]
[ No dialog ]</li>
<li>End If</li>
<li>If [ Get (LastError) = 5 ]</li>
<li>Show Custom Dialog [ Message: "The file has been deleted, moved from, or never downloaded/moved into this library's main folder, OR its name has been changed from " &amp; reference::fileName &amp; "."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( refReference::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para; ]</li>
<li>If [ ValueCount ( testlearn::kcreference ) &gt; 1 ]</li>
<li>Show Custom Dialog [ Message: "This is the first reference attached to this record.  To see all references, click the 'QV' button in the Learn window or the 'references' button in the Tag Menus window."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:/" ; "file:///" ) &amp; TLrefFolderPath::tag ; " " ; "%20" ) &amp;

Case ( Left ( refReference::fileName ; 1 ) =  "/" ; Substitute ( refReference::fileName ; " " ; "%20" ) ;

 "/" &amp; Substitute ( refReference::fileName ; " " ; "%20" ) ) ]
[ No dialog ]</li>
<li>If [ Get ( LastError ) &ne; 0 ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:/" ; "file:///" ) &amp; TLrefFolderPath::tag ; " " ; " " ) &amp;

Case ( Left ( refReference::fileName ; 1 ) =  "/" ; Substitute ( refReference::fileName ; " " ; " " ) ;

 "/" &amp; Substitute ( refReference::fileName ; " " ; " " ) ) ]
[ No dialog ]</li>
<li>End If</li>
<li>If [ Get (LastError) = 5 ]</li>
<li>Show Custom Dialog [ Message: "The file has been deleted, moved from, or never downloaded/moved into " &amp; tagRefFolderPath::tag &amp;  "," &amp; " or the external drive it is on is not plugged in, or it's name was changed from " &amp; reference::fileName &amp; "."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Show cite file from test info window.</li>
<li>If [ FilterValues ( citeTest::kfileLocation ; "8162011225532313" ) = "8162011225532313" &amp; &para; ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/"  &amp; citeTest::fileName ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>If [ Get ( LastError ) &ne; 0 ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/"  &amp; citeTest::fileName ; " " ; " " ) ]
[ No dialog ]</li>
<li>End If</li>
<li>If [ Get (LastError) = 5 ]</li>
<li>Show Custom Dialog [ Message: "The file has been deleted, moved from, or never downloaded/moved into this library's x folder, OR its name has been changed from " &amp; reference::fileName &amp; "."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>Else If [ FilterValues ( citeTest::kfileLocation ; "8162011225558314" ) = "8162011225558314" &amp; &para; ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9)  &amp; citeTest::fileName ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>If [ Get ( LastError ) &ne; 0 ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9)  &amp; citeTest::fileName ; " " ; " " ) ]
[ No dialog ]</li>
<li>End If</li>
<li>If [ Get (LastError) = 5 ]</li>
<li>Show Custom Dialog [ Message: "The file has been deleted, moved from, or never downloaded/moved into this library's main folder, OR its name has been changed from " &amp; reference::fileName &amp; "."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( citeTest::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para; ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:/" ; "file:///" ) &amp; citeTestFolderPath::tag ; " " ; "%20" ) &amp;

Case ( Left ( citeTest::fileName ; 1 ) =  "/" ; Substitute ( citeTest::fileName ; " " ; "%20" ) ;

 "/" &amp; Substitute ( citeTest::fileName ; " " ; "%20" ) ) ]
[ No dialog ]</li>
<li>If [ Get ( LastError ) &ne; 0 ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:/" ; "file:///" ) &amp; citeTestFolderPath::tag ; " " ; " " ) &amp;

Case ( Left ( citeTest::fileName ; 1 ) =  "/" ; Substitute ( citeTest::fileName ; " " ; " " ) ;

 "/" &amp; Substitute ( citeTest::fileName ; " " ; " " ) ) ]
[ No dialog ]</li>
<li>End If</li>
<li>If [ Get (LastError) = 5 ]</li>
<li>Show Custom Dialog [ Message: "The file has been deleted, moved from, or never downloaded/moved into " &amp; tagRefFolderPath::tag &amp;  "," &amp; " or the external drive it is on is not plugged in, or it's name was changed from " &amp; reference::fileName &amp; "."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Show 1st reference file from test info window.</li>
<li>If [ FilterValues ( refTest::kfileLocation ; "8162011225532313" ) = "8162011225532313" &amp; &para; ]</li>
<li>If [ ValueCount ( testlearnReportTags::kcreference ) &gt; 1 ]</li>
<li>Show Custom Dialog [ Message: "This is the first reference attached to this record.  To see all references, click the 'edit/new' button in the main list view window, and once you are in the Learn module, click the 'QV' button in the Learn window or the 'references' button in the Learn Tag Menus window."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/"  &amp; refTest::fileName ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>If [ Get ( LastError ) &ne; 0 ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/"  &amp; refTest::fileName ; " " ; " " ) ]
[ No dialog ]</li>
<li>End If</li>
<li>If [ Get (LastError) = 5 ]</li>
<li>Show Custom Dialog [ Message: "The file has been deleted, moved from, or never downloaded/moved into this library's x folder, OR its name has been changed from " &amp; reference::fileName &amp; "."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>Else If [ FilterValues ( refTest::kfileLocation ; "8162011225558314" ) = "8162011225558314" &amp; &para; ]</li>
<li>If [ ValueCount ( testlearnReportTags::kcreference ) &gt; 1 ]</li>
<li>Show Custom Dialog [ Message: "This is the first reference attached to this record.  To see all references, click the 'edit/new' button in the main list view window, and once you are in the Learn module, click the 'QV' button in the Learn window or the 'references' button in the Learn Tag Menus window."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9)  &amp; refTest::fileName ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>If [ Get ( LastError ) &ne; 0 ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9)  &amp; refTest::fileName ; " " ; " " ) ]
[ No dialog ]</li>
<li>End If</li>
<li>If [ Get (LastError) = 5 ]</li>
<li>Show Custom Dialog [ Message: "The file has been deleted, moved from, or never downloaded/moved into this library's main folder, OR its name has been changed from " &amp; reference::fileName &amp; "."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( refTest::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para; ]</li>
<li>If [ ValueCount ( testlearnReportTags::kcreference ) &gt; 1 ]</li>
<li>Show Custom Dialog [ Message: "This is the first reference attached to this record.  To see all references, click the 'edit/new' button in the main list view window, and once you are in the Learn module, click the 'QV' button in the Learn window or the 'references' button in the Learn Tag Menus window."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:/" ; "file:///" ) &amp; refTestFolderPath::tag ; " " ; "%20" ) &amp;

Case ( Left ( refTest::fileName ; 1 ) =  "/" ; Substitute ( refTest::fileName ; " " ; "%20" ) ;

 "/" &amp; Substitute ( refTest::fileName ; " " ; "%20" ) ) ]
[ No dialog ]</li>
<li>If [ Get ( LastError ) &ne; 0 ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:/" ; "file:///" ) &amp; refTestFolderPath::tag ; " " ; " " ) &amp;

Case ( Left ( refTest::fileName ; 1 ) =  "/" ; Substitute ( refTest::fileName ; " " ; " " ) ;

 "/" &amp; Substitute ( refTest::fileName ; " " ; " " ) ) ]
[ No dialog ]</li>
<li>End If</li>
<li>If [ Get (LastError) = 5 ]</li>
<li>Show Custom Dialog [ Message: "The file has been deleted, moved from, or never downloaded/moved into " &amp; tagRefFolderPath::tag &amp;  "," &amp; " or the external drive it is on is not plugged in, or it's name was changed from " &amp; reference::fileName &amp; "."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>//  #Show TestLearn file.</li>
<li>//  If [ FilterValues ( testlearn::kfileLocation ; "8162011225532313" ) = "8162011225532313" &amp; &para; ]</li>
<li>//  Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/"  &amp; testlearn::filename ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>//  Else If [ FilterValues ( testlearn::kfileLocation ; "8162011225558314" ) = "8162011225558314" &amp; &para; ]</li>
<li>//  Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9)  &amp; testlearn::filename ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>//  Exit Script [  ]</li>
<li>//  Else If [ FilterValues ( testlearn::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para; ]</li>
<li>//  Open URL [ Substitute ( tagRefFolderPath::tag ; " " ; "%20" ) &amp; Substitute ( testlearn::filename ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>//  Else If [ testlearn::URL &ne; "" ]</li>
<li>//  Open URL [ testlearn::URL ]
[ No dialog ]</li>
<li>//  End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::kfileLocation</li>
<li>
<em>reference</em>::fileName</li>
<li>
<em>tagRefFolderPath</em>::tag</li>
<li>
<em>citeCite</em>::kfileLocation</li>
<li>
<em>citeCite</em>::fileName</li>
<li>
<em>TLciteFolderPath</em>::tag</li>
<li>
<em>refReference</em>::kfileLocation</li>
<li>
<em>testlearn</em>::kcreference</li>
<li>
<em>refReference</em>::fileName</li>
<li>
<em>TLrefFolderPath</em>::tag</li>
<li>
<em>citeTest</em>::kfileLocation</li>
<li>
<em>citeTest</em>::fileName</li>
<li>
<em>citeTestFolderPath</em>::tag</li>
<li>
<em>refTest</em>::kfileLocation</li>
<li>
<em>testlearnReportTags</em>::kcreference</li>
<li>
<em>refTest</em>::fileName</li>
<li>
<em>refTestFolderPath</em>::tag</li>
<li>
<em>testlearn</em>::kfileLocation</li>
<li>
<em>testlearn</em>::filename</li>
<li>
<em>testlearn</em>::URL</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33125ScriptAnchor_"></a><td class="script_navbar"><a href="#33091ScriptAnchor_"><span>Previous Script: [showFileInTagandLearnWindows]</span></a></td><td class="script_navbar"><a href="#33319ScriptAnchor_"><span>Parent Folder: [learn]</span></a></td><td class="script_navbar"><a href="#33152ScriptAnchor_"><span>Next Script: [editLearn]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">deleteLearnMainRecord</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If node is currenlty locked then stop script, inform user.</li>
<li>If [ tagTLNodePrimary::orderOrLock &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "The default node selected is locked.  Select this node in the setup window and enter the password to unlock it, then you will able to delete records assigned to this node."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If in find mode, exit script.</li>
<li>If [ $$findMode &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "Exit find mode, then click this button."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Exit field so user can see red delete </li>
<li>#formatting later on.</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Prevent all record load scripts (they slow down</li>
<li>#this script and are uneccessary).</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>#</li>
<li>#If either the sample or test fields are filled show</li>
<li>#message below.</li>
<li>If [ testlearn::kcsample &ne; "" and testlearn::kctest &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "In use by Theory and Test records.  Must be removed before deleting. Click the 'theorize' button and scroll to highlighted items.  Click the square buttons next them.  Click the 'test' button and repeat delinking process."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ testlearn::kcsample &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "In use by Theory records.  Must be removed before deleting. Click the 'theorize' button and scroll to highlighted items.  Click the square buttons next them."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ testlearn::kctest &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "In use by Test records.  Must be removed before deleting. Click the 'test' button and scroll to highlighted items.  Click the square buttons next them."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Set variables to conditionally format section to</li>
<li>#be deleted, and its record number so if the</li>
<li>#user cancels the delete, the system can return</li>
<li>#to this record.</li>
<li>Set Variable [ $delete; Value:testlearn::_Ltestlearn ]</li>
<li>Set Variable [ $deleteName; Value:testlearn::_Number ]</li>
<li>Set Variable [ $recordNumber; Value:Get (RecordNumber) ]</li>
<li>Set Variable [ $section; Value:TEMP::ksection ]</li>
<li>#</li>
<li>#Because there may be no records found, stop</li>
<li>#the system from informing the user of this.</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>#</li>
<li>#Open a new window and look for record being</li>
<li>#cited or used as a reference by another record.</li>
<li>New Window [  ]</li>
<li>#</li>
<li>Loop</li>
<li>#</li>
<li>#Clear the inUse variable before each run thru</li>
<li>#the loop.  If not cleared, then last time thru</li>
<li>#if this variable had a value in it, that value will</li>
<li>#stay in it even if no finds are made, which then</li>
<li>#tells the system that a no-find reference, has finds.</li>
<li>#So the system must clear this variable before each</li>
<li>#run thru the loop.</li>
<li>Set Variable [ $inUse ]</li>
<li>#</li>
<li>#See if learn record is used by any learn records as a</li>
<li>#citation.</li>
<li>Go to Layout [ &ldquo;tableTestLearn&rdquo; (testlearn) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kcitation; $delete ]</li>
<li>Set Field [ testlearn::kcsection; $section ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>If [ Get (LastError) &ne; 401 ]</li>
<li>Set Variable [ $inUse; Value:Get (FoundCount) &amp; " learn citation" ]</li>
<li>End If</li>
<li>#</li>
<li>#See if learn record is used by any learn records as a</li>
<li>#reference.</li>
<li>Go to Layout [ &ldquo;tableTestLearn&rdquo; (testlearn) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kcreference; $delete ]</li>
<li>Set Field [ testlearn::kcsection; $section ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>If [ Get (LastError) &ne; 401 ]</li>
<li>If [ $inUse &ne; "" ]</li>
<li>Set Variable [ $addToInUse; Value:$inUse ]</li>
<li>Set Variable [ $inUse; Value:$addToInUse &amp; ", " &amp; Get (FoundCount)  &amp; " learn reference" ]</li>
<li>Else If [ $inUse = "" ]</li>
<li>Set Variable [ $inUse; Value:Get (FoundCount) &amp; " learn reference" ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#See if reference record is used by any tag records as a</li>
<li>#picture.</li>
<li>Go to Layout [ &ldquo;tableTag&rdquo; (tagTable) ]</li>
<li>#picture1</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTable::Kpicture1; $delete ]</li>
<li>Set Field [ ruleLibrary 2::ksection; $section ]</li>
<li>Perform Find [  ]</li>
<li>Set Variable [ $tagFound1; Value:Get (FoundCount) ]</li>
<li>If [ Get (FoundCount) &gt; 0 ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Variable [ $tagNameADD; Value:$tagName ]</li>
<li>Set Variable [ $tagName; Value:Case (
$tagNameAdd = "" ; 
tagTable::tag ;
$tagNameAdd &amp; "; " &amp; tagTable::tag ) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>End If</li>
<li>#picture2</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTable::Kpicture2; $delete ]</li>
<li>Set Field [ ruleLibrary 2::ksection; $section ]</li>
<li>Perform Find [  ]</li>
<li>Set Variable [ $tagFound2; Value:Get (FoundCount) ]</li>
<li>If [ Get (FoundCount) &gt; 0 ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Variable [ $tagNameADD; Value:$tagName ]</li>
<li>Set Variable [ $tagName; Value:Case (
$tagNameAdd = "" ; 
tagTable::tag ;
$tagNameAdd &amp; "; " &amp; tagTable::tag ) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>End If</li>
<li>#picture3</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTable::Kpicture3; $delete ]</li>
<li>Set Field [ ruleLibrary 2::ksection; $section ]</li>
<li>Perform Find [  ]</li>
<li>Set Variable [ $tagFound3; Value:Get (FoundCount) ]</li>
<li>If [ Get (FoundCount) &gt; 0 ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Variable [ $tagNameADD; Value:$tagName ]</li>
<li>Set Variable [ $tagName; Value:Case (
$tagNameAdd = "" ; 
tagTable::tag ;
$tagNameAdd &amp; "; " &amp; tagTable::tag ) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>End If</li>
<li>#</li>
<li>If [ $tagFound1 + $tagFound2 + $tagFound3  &ne;  0 ]</li>
<li>If [ $inUse &ne; "" ]</li>
<li>Set Variable [ $addToInUse; Value:$inUse ]</li>
<li>Set Variable [ $inUse; Value:$addToInUse &amp; ", " &amp; ($tagFound1 + $tagFound2 + $tagFound3) &amp; " tag menu picture(s) (" &amp; $tagName &amp; ")" ]</li>
<li>Else If [ $inUse = "" ]</li>
<li>Set Variable [ $inUse; Value:($tagFound1 + $tagFound2 + $tagFound3) &amp; " tag menu picture(s) (" &amp; $tagName &amp; ")" ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>Set Variable [ $tagFound1 ]</li>
<li>Set Variable [ $tagFound2 ]</li>
<li>Set Variable [ $tagFound3 ]</li>
<li>Set Variable [ $tagNameADD ]</li>
<li>Set Variable [ $tagName ]</li>
<li>#</li>
<li>#See if reference record is used by any tag records </li>
<li>#as a web link.</li>
<li>Go to Layout [ &ldquo;tableTag&rdquo; (tagTable) ]</li>
<li>#link1</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTable::Ktitle1; $delete ]</li>
<li>Set Field [ ruleLibrary 2::ksection; $section ]</li>
<li>Perform Find [  ]</li>
<li>Set Variable [ $tagFound1; Value:Get (FoundCount) ]</li>
<li>If [ Get (FoundCount) &gt; 0 ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Variable [ $tagNameADD; Value:$tagName ]</li>
<li>Set Variable [ $tagName; Value:Case (
$tagNameAdd = "" ; 
tagTable::tag ;
$tagNameAdd &amp; "; " &amp; tagTable::tag ) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>End If</li>
<li>#link2</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTable::Ktitle2; $delete ]</li>
<li>Set Field [ ruleLibrary 2::ksection; $section ]</li>
<li>Perform Find [  ]</li>
<li>Set Variable [ $tagFound2; Value:Get (FoundCount) ]</li>
<li>If [ Get (FoundCount) &gt; 0 ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Variable [ $tagNameADD; Value:$tagName ]</li>
<li>Set Variable [ $tagName; Value:Case (
$tagNameAdd = "" ; 
tagTable::tag ;
$tagNameAdd &amp; "; " &amp; tagTable::tag ) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>End If</li>
<li>#link3</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTable::Ktitle3; $delete ]</li>
<li>Set Field [ ruleLibrary 2::ksection; $section ]</li>
<li>Perform Find [  ]</li>
<li>Set Variable [ $tagFound3; Value:Get (FoundCount) ]</li>
<li>If [ Get (FoundCount) &gt; 0 ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Variable [ $tagNameADD; Value:$tagName ]</li>
<li>Set Variable [ $tagName; Value:Case (
$tagNameAdd = "" ; 
tagTable::tag ;
$tagNameAdd &amp; "; " &amp; tagTable::tag ) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>End If</li>
<li>#</li>
<li>If [ $tagFound1 + $tagFound2 + $tagFound3  &ne;  0 ]</li>
<li>If [ $inUse &ne; "" ]</li>
<li>Set Variable [ $addToInUse; Value:$inUse ]</li>
<li>Set Variable [ $inUse; Value:$addToInUse &amp; ", " &amp; ($tagFound1 + $tagFound2 + $tagFound3) &amp; " tag menu link(s) (" &amp; $tagName &amp; ")" ]</li>
<li>Else If [ $inUse = "" ]</li>
<li>Set Variable [ $inUse; Value:($tagFound1 + $tagFound2 + $tagFound3) &amp; " tag menu link(s) (" &amp; $tagName &amp; ")" ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>Set Variable [ $tagFound1 ]</li>
<li>Set Variable [ $tagFound2 ]</li>
<li>Set Variable [ $tagFound3 ]</li>
<li>Set Variable [ $tagNameADD ]</li>
<li>Set Variable [ $tagName ]</li>
<li>#</li>
<li>#If the current record is in use in the section of</li>
<li>#the database from which the delete was requested,</li>
<li>#inform the user of this, and skip the next </li>
<li>#steps of this loop and the next loop, which.</li>
<li>#is for checking if record is in use in other sections.</li>
<li>If [ $section = TEMP::ksection and $inUse &ne; "" ]</li>
<li>#</li>
<li>#If the record was in use in the current section</li>
<li>#then do not look for it in other sections.</li>
<li>Set Variable [ $checkSection; Value:$section ]</li>
<li>Set Variable [ $section ]</li>
<li>Exit Loop If [ $checkSection = TEMP::ksection and $inUse &ne; "" ]</li>
<li>End If</li>
<li>#</li>
<li>#If the current record is not in use in the section</li>
<li>#of the database from which this delete was started,</li>
<li>#capture this information.</li>
<li>If [ $section = TEMP::ksection and $inUse = "" ]</li>
<li>Set Variable [ $deleteNotInUse; Value:"not in use" ]</li>
<li>End If</li>
<li>#</li>
<li>#Exit the loop if there is only 1 section key for this record</li>
<li>#or if the system just checked for the record</li>
<li>#in all sections of the database, which</li>
<li>#is why the section variable would be blank.</li>
<li>#In the latter case, the loop would be coming round</li>
<li>#after checking all sections in the database.</li>
<li>#At first the loop is confined to looking at all records</li>
<li>#in this section.  Once it has done that, a script</li>
<li>#step below exits the loop only to enter a loop</li>
<li>#that clears the section variable and causes the</li>
<li>#system to re-enter this loop, only with a blank</li>
<li>#section variable so it will look in all sections of the</li>
<li>#database.  When it reaches this step, that blank</li>
<li>#section variable will force it out of this loop and</li>
<li>#a similar script step in the outer loop will do the</li>
<li>#same thereby allowing the system to follow the</li>
<li>#remainder of this script to report on the findings</li>
<li>#made during these discovery loops.</li>
<li>Exit Loop If [ ValueCount ( testlearn::kcsection )  =  1 or $section = "" ]</li>
<li>#</li>
<li>#If the current record is not in use in the section</li>
<li>#of the database where the delete was started,</li>
<li>#make sure it is not in use in any other section.</li>
<li>Set Variable [ $section ]</li>
<li>#</li>
<li>End Loop</li>
<li>#</li>
<li>Close Window [ Current Window ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#Report on findings and if none delete record.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#If the record in question was not found in the</li>
<li>#section the user is deleting it from...</li>
<li>If [ $deleteNotInUse &ne; "" ]</li>
<li>#</li>
<li>#But this record is in use in other sections...</li>
<li>If [ $inUse &ne; "" ]</li>
<li>#</li>
<li>Refresh Window</li>
<li>Show Custom Dialog [ Message: "This record cannot be deleted as it in use in other sections of the database.  You can remove it from this section though as it is not being used in this section."; Buttons: &ldquo;cancel&rdquo;, &ldquo;remove&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>#</li>
<li>#If the user chooses not to remove the record</li>
<li>#everything goes back to the way it was.</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $delete ]</li>
<li>Set Variable [ $$addTagToCitation ]</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Refresh Window</li>
<li>Exit Script [  ]</li>
<li>Else If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>#</li>
<li>Set Variable [ $delete ]</li>
<li>Set Variable [ $$addTagToCitation ]</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>#</li>
<li>#If the user choses to proceed with the removal,</li>
<li>#the section key is removed from the record's</li>
<li>#key chain.  ( paragraph mark is added to section in </li>
<li>#     case the key has no paragraph mark after it and so</li>
<li>#     would not be found. )</li>
<li>Set Field [ testlearn::kcsection; Substitute ( testlearn::kcsection &amp; &para; ; TEMP::ksection &amp; &para; ; "" ) ]</li>
<li>#</li>
<li>#Omit the record as it no longer is part of this section.</li>
<li>Omit Record</li>
<li>#</li>
<li>End If</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#If record was found in current section tell user.</li>
<li>If [ $inUse &ne; "" ]</li>
<li>Set Variable [ $delete ]</li>
<li>Refresh Window</li>
<li>//  Show Custom Dialog [ Message: "This record cannot be deleted as it in use x number of times as a citation or reference in the following windows of this section: "  &amp; $inUse &amp; "."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Show Custom Dialog [ Message: "Record cannot be deleted as it in use in these windows: "  &amp; $inUse &amp; "."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Set Variable [ $$addTagToCitation ]</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#If record is not in use in any section, but has more</li>
<li>#than one section key, give user option to remove it</li>
<li>#from just this section.</li>
<li>If [ ValueCount ( testlearn::kcsection )   &gt; 1 ]</li>
<li>Refresh Window</li>
<li>Show Custom Dialog [ Message: "This record is in other sections of the library.  Do you want to remove it from just this section or delete it from all sections?"; Buttons: &ldquo;cancel&rdquo;, &ldquo;remove&rdquo;, &ldquo;delete&rdquo; ]</li>
<li>#</li>
<li>#If the user cancels, stop the delete.</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $delete ]</li>
<li>Set Variable [ $group ]</li>
<li>Refresh Window</li>
<li>Set Variable [ $$addTagToCitation ]</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>#If the clicks remove, then remove the record.</li>
<li>Else If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>#</li>
<li>Set Variable [ $delete ]</li>
<li>Set Variable [ $$addTagToCitation ]</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>#</li>
<li>#If the user choses to proceed with the removal,</li>
<li>#the section key is removed from the record's</li>
<li>#key chain.  ( paragraph mark is added to section in </li>
<li>#     case the key has no paragraph mark after it and so</li>
<li>#     would not be found. )</li>
<li>Set Field [ testlearn::kcsection; Substitute ( testlearn::kcsection &amp; &para; ; TEMP::ksection &amp; &para; ; "" ) ]</li>
<li>#</li>
<li>#Omit the record as it no longer is part of this section.</li>
<li>Omit Record</li>
<li>#</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#If the record being deleted was not found in</li>
<li>#use in any sections of the database then before</li>
<li>#deleting it make sure the user really wants it deleted.</li>
<li>Set Variable [ $group ]</li>
<li>Refresh Window</li>
<li>Show Custom Dialog [ Message: "Delete current record?"; Buttons: &ldquo;cancel&rdquo;, &ldquo;delete&rdquo; ]</li>
<li>Set Variable [ $group; Value:tagMenus::kGroupOrTest ]</li>
<li>Set Variable [ $deleteGroup; Value:ruleTagMenuGroups::name ]</li>
<li>#</li>
<li>#If the user cancels, stop the delete.</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $delete ]</li>
<li>Set Variable [ $group ]</li>
<li>Refresh Window</li>
<li>Refresh Window</li>
<li>Set Variable [ $$addTagToCitation ]</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>#If the user says yes, then delete the record.</li>
<li>Else If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>#</li>
<li>End If</li>
<li>Set Variable [ $delete ]</li>
<li>Set Variable [ $group ]</li>
<li>Refresh Window</li>
<li>Set Variable [ $$addTagToCitation ]</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>#</li>
<li>Perform Script [ &ldquo;loadCitation&rdquo; ]</li>
<li>#</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagTLNodePrimary</em>::orderOrLock</li>
<li>
<em>testlearn</em>::kcsample</li>
<li>
<em>testlearn</em>::kctest</li>
<li>
<em>testlearn</em>::_Ltestlearn</li>
<li>
<em>testlearn</em>::_Number</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>testlearn</em>::kcitation</li>
<li>
<em>testlearn</em>::kcsection</li>
<li>
<em>testlearn</em>::kcreference</li>
<li>
<em>tagTable</em>::Kpicture1</li>
<li>
<em>ruleLibrary 2</em>::ksection</li>
<li>
<em>tagTable</em>::tag</li>
<li>
<em>tagTable</em>::Kpicture2</li>
<li>
<em>tagTable</em>::Kpicture3</li>
<li>
<em>tagTable</em>::Ktitle1</li>
<li>
<em>tagTable</em>::Ktitle2</li>
<li>
<em>tagTable</em>::Ktitle3</li>
<li>
<em>tagMenus</em>::kGroupOrTest</li>
<li>
<em>ruleTagMenuGroups</em>::name</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32984ScriptAnchor_">loadCitation</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>tableTestLearn</li>
<li>tableTag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33152ScriptAnchor_"></a><td class="script_navbar"><a href="#33125ScriptAnchor_"><span>Previous Script: [deleteLearnMainRecord]</span></a></td><td class="script_navbar"><a href="#33319ScriptAnchor_"><span>Parent Folder: [learn]</span></a></td><td class="script_navbar"><a href="#33232ScriptAnchor_"><span>Next Script: [editTestLearn]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">editLearn</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#In report mode do the following ...</li>
<li>If [ Left ( Get ( LayoutName ) ; 1 ) = "r" ]</li>
<li>#</li>
<li>#Set return variable for tag.</li>
<li>If [ Get (FoundCount) &ge; 1 ]</li>
<li>Set Variable [ $$learnRecord; Value:testlearnReportTags::_Ltestlearn ]</li>
<li>Else</li>
<li>Set Variable [ $$learnRecord; Value:1 ]</li>
<li>End If</li>
<li>#</li>
<li>#Set return variable for Report item.</li>
<li>Set Variable [ $$returnItem; Value:TEMP::ktest ]</li>
<li>Set Variable [ $$returnItemName; Value:TEMP::testName ]</li>
<li>#</li>
<li>#Go to the Report window and change it to Learn.</li>
<li>Select Window [ Name: "Report"; Current file ]</li>
<li>Set Window Title [ Current Window; New Title: "Learn" ]</li>
<li>#</li>
<li>#Find, sort, the loop to record user was on in</li>
<li>#Tag Menus window for info items (testLearn records).</li>
<li>Set Variable [ $$stopLoadCitation; Value:1 ]</li>
<li>If [ tempSetup::layoutLmain = "" ]</li>
<li>Go to Layout [ &ldquo;learn1&rdquo; (testlearn) ]</li>
<li>Set Field [ TEMP::layoutLmain; "more" &amp; Get (LayoutName) ]</li>
<li>Else If [ tempSetup::layoutLmain &ne; "" ]</li>
<li>Go to Layout [ Middle ( tempSetup::layoutLmain ; 5 ; 42 ) ]</li>
<li>End If</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection ]</li>
<li>Set Field [ testlearn::filterFind; "main" &amp; &para; ]</li>
<li>Perform Find [  ]</li>
<li>Set Variable [ $$stopLoadCitation; Value:1 ]</li>
<li>Sort Records [ Specified Sort Order: testlearn::date; descending
testlearn::timestamp; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>#</li>
<li>#Go to selected learn record.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ testlearn::_Ltestlearn = $$learnRecord ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>#</li>
<li>#Go to test menu in Tag Menus window.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Go to Layout [ &ldquo;ltagNK2&rdquo; (tagMenus) ]</li>
<li>Perform Script [ &ldquo;menuTest&rdquo; ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Perform Script [ &ldquo;loadCitation&rdquo; ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>Else If [ Left ( Get ( LayoutName ) ; 1 ) = "t" ]</li>
<li>#</li>
<li>#Set return variable for tag.</li>
<li>Set Variable [ $$testTagRecord; Value:testlearnReportTags::_Ltestlearn ]</li>
<li>#</li>
<li>#Set return variable for Test item.</li>
<li>Set Variable [ $$returnItem; Value:TEMP::ktest ]</li>
<li>Set Variable [ $$returnItemName; Value:TEMP::testName ]</li>
<li>#</li>
<li>#Go to the Test window and change it to Learn.</li>
<li>Select Window [ Name: "Test"; Current file ]</li>
<li>Set Window Title [ Current Window; New Title: "Learn" ]</li>
<li>#</li>
<li>#Set return variable for main Test record.</li>
<li>Set Variable [ $$testLearnRecord; Value:testlearn::_Ltestlearn ]</li>
<li>#</li>
<li>#Find, sort, the loop to record user was on in</li>
<li>#Tag Menus window for info items (testLearn records).</li>
<li>Set Variable [ $$stopLoadCitation; Value:1 ]</li>
<li>If [ tempSetup::layoutLmain = "" ]</li>
<li>Go to Layout [ &ldquo;learn1&rdquo; (testlearn) ]</li>
<li>Set Field [ TEMP::layoutLmain; "more" &amp; Get (LayoutName) ]</li>
<li>Else If [ tempSetup::layoutLmain &ne; "" ]</li>
<li>Go to Layout [ Middle ( tempSetup::layoutLmain ; 5 ; 42 ) ]</li>
<li>End If</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection ]</li>
<li>Set Field [ testlearn::filterFind; "main" &amp; &para; ]</li>
<li>Perform Find [  ]</li>
<li>Set Variable [ $$stopLoadCitation; Value:1 ]</li>
<li>Sort Records [ Specified Sort Order: testlearn::date; descending
testlearn::timestamp; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>#</li>
<li>#Go to selected learn record.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ testlearn::_Ltestlearn = $$testTagRecord ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>#</li>
<li>#Go to keyword menu in Tag Menus window.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Go to Layout [ &ldquo;ltagNK2&rdquo; (tagMenus) ]</li>
<li>If [ $$returnItem &ne; "" ]</li>
<li>Perform Script [ &ldquo;menuTest&rdquo; ]</li>
<li>Else If [  ]</li>
<li>Perform Script [ &ldquo;menuKey&rdquo; ]</li>
<li>End If</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Perform Script [ &ldquo;loadCitation&rdquo; ]</li>
<li>#</li>
<li>End If</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearnReportTags</em>::_Ltestlearn</li>
<li>
<em>TEMP</em>::ktest</li>
<li>
<em>TEMP</em>::testName</li>
<li>
<em>tempSetup</em>::layoutLmain</li>
<li>
<em>TEMP</em>::layoutLmain</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>testlearn</em>::kcsection</li>
<li>
<em>testlearn</em>::filterFind</li>
<li>
<em>testlearn</em>::date</li>
<li>
<em>testlearn</em>::timestamp</li>
<li>
<em>testlearn</em>::_Ltestlearn</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33068ScriptAnchor_">menuTest</a></li>
<li><a href="#32984ScriptAnchor_">loadCitation</a></li>
<li><a href="#32993ScriptAnchor_">menuKey</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>learn1</li>
<li>&lt;Missing Layout&gt;</li>
<li>ltagNK2</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33232ScriptAnchor_"></a><td class="script_navbar"><a href="#33152ScriptAnchor_"><span>Previous Script: [editLearn]</span></a></td><td class="script_navbar"><a href="#33319ScriptAnchor_"><span>Parent Folder: [learn]</span></a></td><td class="script_navbar"><a href="#33233ScriptAnchor_"><span>Next Script: [finishTestLearnEdit]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">editTestLearn</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If node is currenlty locked then stop script, inform user.</li>
<li>If [ tagTLNodePrimary::orderOrLock &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "The default node selected is locked.  Select this node in the setup window and enter the password to unlock it, then you will able to edit records assigned to this node."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If in find mode, exit script.</li>
<li>If [ $$findMode &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "Exit find mode, then click this button."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>#</li>
<li>#If in find mode, exit find mode.</li>
<li>If [ $$findMode= 1 ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Set Variable [ $$findMode ]</li>
<li>Set Variable [ $$firstFind ]</li>
<li>Set Variable [ $$firstFindOther ]</li>
<li>Set Variable [ $$found ]</li>
<li>Set Variable [ $$foundOther ]</li>
<li>Go to Layout [ $$findLayout ]</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>End If</li>
<li>#</li>
<li>#Capture layout name.</li>
<li>Set Variable [ $$testLearnLayoutName; Value:Get (LayoutName) ]</li>
<li>#</li>
<li>#Go to edit layout for this record.</li>
<li>Go to Layout [ &ldquo;learn4EDIT&rdquo; (testlearn) ]</li>
<li>#</li>
<li>#Prevent add mode.</li>
<li>Set Variable [ $$stopAdd; Value:1 ]</li>
<li>Set Variable [ $$stoploadCitation ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagTLNodePrimary</em>::orderOrLock</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>&lt;Missing Layout&gt;</li>
<li>learn4EDIT</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33233ScriptAnchor_"></a><td class="script_navbar"><a href="#33232ScriptAnchor_"><span>Previous Script: [editTestLearn]</span></a></td><td class="script_navbar"><a href="#33319ScriptAnchor_"><span>Parent Folder: [learn]</span></a></td><td class="script_navbar"><a href="#33188ScriptAnchor_"><span>Next Script: [duplicateLearnRecord]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">finishTestLearnEdit</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Go to reference record layout.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>Go to Layout [ $$testLearnLayoutName ]</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>#</li>
<li>#Allow add mode.</li>
<li>Set Variable [ $$stopAdd ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33188ScriptAnchor_"></a><td class="script_navbar"><a href="#33233ScriptAnchor_"><span>Previous Script: [finishTestLearnEdit]</span></a></td><td class="script_navbar"><a href="#33319ScriptAnchor_"><span>Parent Folder: [learn]</span></a></td><td class="script_navbar"><a href="#33199ScriptAnchor_"><span>Next Script: [learnOpenTextNewWindow]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">duplicateLearnRecord</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If node is currenlty locked then stop script, inform user.</li>
<li>If [ TEMP::nodeLock &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "The default node selected is locked.  Select this node in the setup window and enter the password to unlock it, then you will able to create new records assigned to this node."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If in find mode, exit script.</li>
<li>If [ $$findMode &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "Exit find mode, then click this button."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $caption; Value:testlearn::Caption ]</li>
<li>Set Variable [ $P; Value:testlearn::kKeywordPrimary ]</li>
<li>Set Variable [ $O; Value:testlearn::kcKeywordOther ]</li>
<li>Set Variable [ $Owords; Value:testlearn::OtherKeyWords ]</li>
<li>Set Field [ TEMP::duplicateOtherKeywords; testlearn::kcKeywordOther ]</li>
<li>Set Variable [ $citation; Value:testlearn::kcitation ]</li>
<li>Set Variable [ $reference; Value:testlearn::kcreference ]</li>
<li>#The 'L' is added to all Tag Menu to conditional format</li>
<li>#the Learn menu button.</li>
<li>Set Variable [ $referenceOriginal; Value:testlearn::_Ltestlearn &amp; "L" ]</li>
<li>New Record/Request</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection ]</li>
<li>Set Field [ testlearn::kNodePrimary; TEMP::kdefaultNodePrimary ]</li>
<li>Set Field [ testlearn::kRecordCreatorNode; TEMP::kdefaultNodePrimary ]</li>
<li>Set Field [ testlearn::RecordModifyDate; Get ( CurrentTimeStamp ) ]</li>
<li>Set Field [ testlearn::kNodeOther; TEMP::kdefaultNodeOther ]</li>
<li>Set Field [ testlearn::NodeOthers; TEMP::DEFAULTNodeOtherNames ]</li>
<li>Set Field [ testlearn::kHealth; TEMP::kdefaultHealth ]</li>
<li>Set Field [ testlearn::incomplete; "incomplete" &amp; &para; ]</li>
<li>Set Field [ testlearn::filterFind; "main" &amp; &para; ]</li>
<li>Set Field [ testlearn::kKeywordPrimary; $P ]</li>
<li>Set Field [ testlearn::OtherKeyWords; $Owords ]</li>
<li>Set Field [ testlearn::kcitation; $citation ]</li>
<li>Set Field [ testlearn::Caption; $O ]</li>
<li>#</li>
<li>#Filemaker has a bug that is stripping out the paragraphs</li>
<li>#if the script puts the O variable keys directly into the</li>
<li>#other word field.  But put them into caption and then</li>
<li>#from caption into the otherword key field and everything</li>
<li>#is fine.</li>
<li>Set Field [ testlearn::kcKeywordOther; testlearn::Caption ]</li>
<li>Set Field [ testlearn::Caption; $caption ]</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>If [ testlearn::kcitation = "" ]</li>
<li>Show Custom Dialog [ Message: "Reference the duplicated record (the one with the green bar)? If yes, adds the dupliated record to the referene section of its duplicate (the record below the one with green bar)."; Buttons: &ldquo;no&rdquo;, &ldquo;yes&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Set Field [ testlearn::kcreference; $referenceOriginal  &amp; &para; &amp; $reference ]</li>
<li>Else</li>
<li>Set Field [ testlearn::kcreference; $reference ]</li>
<li>End If</li>
<li>Else</li>
<li>Set Field [ testlearn::kcreference; $reference ]</li>
<li>End If</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Set Variable [ $record; Value:Get (RecordNumber) ]</li>
<li>Go to Record/Request/Page [ $record ]
[ No dialog ]</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Perform Script [ &ldquo;loadCitation&rdquo; ]</li>
<li>Set Variable [ $$stopOpenNewTextWindow ]</li>
<li>Perform Script [ &ldquo;learnOpenTextNewWindow&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::nodeLock</li>
<li>
<em>testlearn</em>::Caption</li>
<li>
<em>testlearn</em>::kKeywordPrimary</li>
<li>
<em>testlearn</em>::kcKeywordOther</li>
<li>
<em>testlearn</em>::OtherKeyWords</li>
<li>
<em>TEMP</em>::duplicateOtherKeywords</li>
<li>
<em>testlearn</em>::kcitation</li>
<li>
<em>testlearn</em>::kcreference</li>
<li>
<em>testlearn</em>::_Ltestlearn</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>testlearn</em>::kcsection</li>
<li>
<em>TEMP</em>::kdefaultNodePrimary</li>
<li>
<em>testlearn</em>::kNodePrimary</li>
<li>
<em>testlearn</em>::kRecordCreatorNode</li>
<li>
<em>testlearn</em>::RecordModifyDate</li>
<li>
<em>TEMP</em>::kdefaultNodeOther</li>
<li>
<em>testlearn</em>::kNodeOther</li>
<li>
<em>TEMP</em>::DEFAULTNodeOtherNames</li>
<li>
<em>testlearn</em>::NodeOthers</li>
<li>
<em>TEMP</em>::kdefaultHealth</li>
<li>
<em>testlearn</em>::kHealth</li>
<li>
<em>testlearn</em>::incomplete</li>
<li>
<em>testlearn</em>::filterFind</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32984ScriptAnchor_">loadCitation</a></li>
<li><a href="#33199ScriptAnchor_">learnOpenTextNewWindow</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33199ScriptAnchor_"></a><td class="script_navbar"><a href="#33188ScriptAnchor_"><span>Previous Script: [duplicateLearnRecord]</span></a></td><td class="script_navbar"><a href="#33319ScriptAnchor_"><span>Parent Folder: [learn]</span></a></td><td class="script_navbar"><a href="#33240ScriptAnchor_"><span>Next Script: [gotoLearnWebsite]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">learnOpenTextNewWindow</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33188ScriptAnchor_">duplicateLearnRecord</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ Get ( WindowMode ) = 1 ]</li>
<li>Go to Field [ testlearn::Caption ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>If [ $$stopOpenNewTextWindow = 1 ]</li>
<li>Set Variable [ $$stopOpenNewTextWindow ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $record; Value:testlearn::_Ltestlearn ]</li>
<li>Set Variable [ $$stopLoadCitation; Value:1 ]</li>
<li>New Window [ Name: "Learn: Edit Note" ]</li>
<li>If [ tagTLNodePrimary::orderOrLock = "" ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;LearnTextWindowStuff&rdquo; (testlearn) ]</li>
<li>Else</li>
<li>Go to Layout [ &ldquo;LearnTextWindow&rdquo; (testlearn) ]</li>
<li>End If</li>
<li>Go to Field [ testlearn::Caption ]</li>
<li>Else If [ tagTLNodePrimary::orderOrLock &ne; "" ]</li>
<li>Go to Layout [ &ldquo;LearnTextWindowLocked&rdquo; (testlearn) ]</li>
<li>End If</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::_Ltestlearn; $record ]</li>
<li>Perform Find [  ]</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Pause/Resume Script [ Indefinitely ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearn</em>::Caption</li>
<li>
<em>testlearn</em>::_Ltestlearn</li>
<li>
<em>tagTLNodePrimary</em>::orderOrLock</li>
<li>
<em>TEMP</em>::InventoryLibaryYN</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>LearnTextWindowStuff</li>
<li>LearnTextWindow</li>
<li>LearnTextWindowLocked</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33240ScriptAnchor_"></a><td class="script_navbar"><a href="#33199ScriptAnchor_"><span>Previous Script: [learnOpenTextNewWindow]</span></a></td><td class="script_navbar"><a href="#33319ScriptAnchor_"><span>Parent Folder: [learn]</span></a></td><td class="script_navbar"><a href="#33250ScriptAnchor_"><span>Next Script: [findLearnRecord]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">gotoLearnWebsite</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Open URL [ learnSampleWebsite::URL ]
[ No dialog ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>learnSampleWebsite</em>::URL</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33250ScriptAnchor_"></a><td class="script_navbar"><a href="#33240ScriptAnchor_"><span>Previous Script: [gotoLearnWebsite]</span></a></td><td class="script_navbar"><a href="#33319ScriptAnchor_"><span>Parent Folder: [learn]</span></a></td><td class="script_navbar"><a href="#33252ScriptAnchor_"><span>Next Script: [cancelLearnFind]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">findLearnRecord</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#Capture errors and tell user about them in custom </li>
<li>#dialogue box.</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>#</li>
<li>#If the user clicks the find button and the system is already</li>
<li>#in find mode, capture the user's current find request</li>
<li>#and then perform the requested find.</li>
<li>#This capture is done in case nothing is found and the</li>
<li>#user is asked if they want to modify their request.</li>
<li>#The system puts in the captured request so that the </li>
<li>#user can see the failed request.</li>
<li>If [ Get (WindowMode) = 1 ]</li>
<li>Set Variable [ $caption; Value:testlearn::Caption ]</li>
<li>Set Variable [ $timestamp; Value:testlearn::timestamp ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#If the system is not in find mode when the user</li>
<li>#clicks the find button do the following.</li>
<li>Else</li>
<li>#</li>
<li>#Check if the current Learn record references other</li>
<li>#Learn records.</li>
<li>If [ Filter ( testlearn::kcreference ; "L" ) &ne; "" ]</li>
<li>#</li>
<li>#If it does reference other Learn records, ask the user</li>
<li>#if they would like to find just those records, or </li>
<li>#continue to the find screen.</li>
<li>Show Custom Dialog [ Message: "Find all related (highlighted) LEARN records?" &amp; &para;  &amp; "OR"  &amp; &para; &amp;  "Enter your own FIND request?"; Buttons: &ldquo;find&rdquo;, &ldquo;learn&rdquo;, &ldquo;cancel&rdquo; ]</li>
<li>#</li>
<li>#Cancel selection, cancels the script.</li>
<li>If [ Get ( LastMessageChoice ) = 3 ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>#If the users selects the "learn" button, then find just</li>
<li>#the referenced Learn records (in addition to the</li>
<li>#current Learn record).</li>
<li>Else If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>#</li>
<li>Set Variable [ $$findLearnLayout; Value:Get (LayoutName) ]</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>#</li>
<li>#Look thru the referenced records to create a value</li>
<li>#list of their keys.</li>
<li>Go to Layout [ &ldquo;learn4EDIT&rdquo; (testlearn) ]</li>
<li>Set Variable [ $findLinkedLearnRecords; Value:testlearn::_Ltestlearn ]</li>
<li>Loop</li>
<li>Go to Object [ Object Name: "ref2" ]</li>
<li>Exit Loop If [ Get (LastError)  = 101 ]</li>
<li>Set Variable [ $findLinkedLearnRecords; Value:refTestLearn::_Ltestlearn &amp; &para; &amp; $findLinkedLearnRecords ]</li>
<li>Go to Portal Row
[ Select; Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Determine how many keys there are.</li>
<li>Set Variable [ $numberOfKeys; Value:ValueCount ($findLinkedLearnRecords ) ]</li>
<li>#</li>
<li>#Find 1st record.</li>
<li>Go to Layout [ $$findLearnLayout ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::_Ltestlearn; GetValue ( $findLinkedLearnRecords ; $numberOfKeys ) ]</li>
<li>Perform Find [  ]</li>
<li>Set Variable [ $numberOfKeys; Value:$numberOfKeys - 1 ]</li>
<li>#</li>
<li>If [ $numberOfKeys &ne; 0 ]</li>
<li>#</li>
<li>#Loop thru each key to find next record in list until</li>
<li>#all linked records have been found.</li>
<li>Loop</li>
<li>#</li>
<li>#Exit the loop when there are no more keys to check.</li>
<li>Exit Loop If [ $numberOfKeys = 0 ]</li>
<li>#</li>
<li>#Find record.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::_Ltestlearn; GetValue ( $findLinkedLearnRecords ; $numberOfKeys ) ]</li>
<li>Extend Found Set [  ]</li>
<li>#</li>
<li>#Go the next key up from the bottom of the list</li>
<li>#of keys on this section's keychain.</li>
<li>Set Variable [ $numberOfKeys; Value:$numberOfKeys - 1 ]</li>
<li>End Loop</li>
<li>#</li>
<li>Sort Records [ Specified Sort Order: testlearn::date; descending
testlearn::timestamp; descending ]
[ Restore; No dialog ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>End If</li>
<li>#</li>
<li>#Stop the script.</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Set Variable [ $$findLearnLayout ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#If the system is not in find mode and the find button</li>
<li>#is clicked then capture the current layout name </li>
<li>#(to return user to it after find), enter find mode,  </li>
<li>#go to the find layout, and await the user's find request. </li>
<li>Set Variable [ $$findLearnLayout; Value:Get (LayoutName) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Go to Layout [ &ldquo;learnFIND&rdquo; (testlearn) ]</li>
<li>Show/Hide Status Area
[ Hide ]</li>
<li>Show/Hide Text Ruler
[ Hide ]</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection ]</li>
<li>Go to Field [ testlearn::Caption ]</li>
<li>Pause/Resume Script [ Indefinitely ]</li>
<li>Set Variable [ $caption; Value:testlearn::Caption ]</li>
<li>Set Variable [ $timestamp; Value:testlearn::timestamp ]</li>
<li>Perform Find [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If the find fails tell the user it failed and give them</li>
<li>#option to modify their request or cancel the find.</li>
<li>Loop</li>
<li>If [ Get (LastError) = 401 ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection ]</li>
<li>Set Field [ testlearn::Caption; $caption ]</li>
<li>Set Field [ testlearn::timestamp; $timestamp ]</li>
<li>Go to Field [ testlearn::Caption ]</li>
<li>Show Custom Dialog [ Message: "No records match this request."; Buttons: &ldquo;cancel&rdquo;, &ldquo;modify find&rdquo; ]</li>
<li>#</li>
<li>#If the user decides to modify their request then stay</li>
<li>#in find mode and await the users new request.</li>
<li>If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Pause/Resume Script [ Indefinitely ]</li>
<li>Set Variable [ $caption; Value:testlearn::Caption ]</li>
<li>Set Variable [ $timestamp; Value:testlearn::timestamp ]</li>
<li>#</li>
<li>#If the user decides to cancel their the find, then return</li>
<li>#to the main record window and show all records.</li>
<li>Else If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Go to Layout [ $$findLearnLayout ]</li>
<li>Show/Hide Status Area
[ Hide ]</li>
<li>Show/Hide Text Ruler
[ Hide ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Variable [ $$findLearnLayout ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Perform Find [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If the find is successful then show the user the found</li>
<li>#records on the main records layout.</li>
<li>Exit Loop If [ Get (LastError) = 0 ]</li>
<li>End Loop</li>
<li>Go to Layout [ $$findLearnLayout ]</li>
<li>Set Variable [ $$findLearnLayout ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearn</em>::Caption</li>
<li>
<em>testlearn</em>::timestamp</li>
<li>
<em>testlearn</em>::kcreference</li>
<li>
<em>testlearn</em>::_Ltestlearn</li>
<li>
<em>refTestLearn</em>::_Ltestlearn</li>
<li>
<em>testlearn</em>::date</li>
<li>
<em>TEMP</em>::ksection</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>learn4EDIT</li>
<li>&lt;Missing Layout&gt;</li>
<li>learnFIND</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33252ScriptAnchor_"></a><td class="script_navbar"><a href="#33250ScriptAnchor_"><span>Previous Script: [findLearnRecord]</span></a></td><td class="script_navbar"><a href="#33319ScriptAnchor_"><span>Parent Folder: [learn]</span></a></td><td class="script_navbar"><a href="#33094ScriptAnchor_"><span>Next Script: [newLearn]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">cancelLearnFind</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If the user decides to cancel their the find, then return</li>
<li>#to the main record window and show all records.</li>
<li>If [ Get ( LayoutTableName ) = "reference" ]</li>
<li>Go to Layout [ $$findReferenceLayout ]</li>
<li>Set Variable [ $$findReferenceLayout ]</li>
<li>Else</li>
<li>Go to Layout [ $$findLearnLayout ]</li>
<li>Set Variable [ $$findLearnLayout ]</li>
<li>End If</li>
<li>Show/Hide Status Area
[ Hide ]</li>
<li>Show/Hide Text Ruler
[ Hide ]</li>
<li>Enter Find Mode [  ]</li>
<li>If [ Get ( LayoutTableName ) = "reference" ]</li>
<li>Set Field [ reference::kcsection; TEMP::ksection ]</li>
<li>Else</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection ]</li>
<li>End If</li>
<li>Perform Find [  ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>reference</em>::kcsection</li>
<li>
<em>testlearn</em>::kcsection</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>&lt;Missing Layout&gt;</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33094ScriptAnchor_"></a><td class="script_navbar"><a href="#33252ScriptAnchor_"><span>Previous Script: [cancelLearnFind]</span></a></td><td class="script_navbar"><a href="#33319ScriptAnchor_"><span>Parent Folder: [learn]</span></a></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">newLearn</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If node is currenlty locked then stop script, inform user.</li>
<li>If [ TEMP::nodeLock &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "The default node selected is locked.  Select this node in the setup window and enter the password to unlock it, then you will able to create new records assigned to this node."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If in find mode, exit script.</li>
<li>If [ $$findMode &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "Exit find mode, then click this button."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>Go to Field [  ]</li>
<li>Freeze Window</li>
<li>New Record/Request</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection ]</li>
<li>Set Field [ testlearn::kNodePrimary; TEMP::kdefaultNodePrimary ]</li>
<li>Set Field [ testlearn::kRecordCreatorNode; TEMP::kdefaultNodePrimary ]</li>
<li>Set Field [ testlearn::RecordModifyDate; Get ( CurrentTimeStamp ) ]</li>
<li>Set Field [ testlearn::kNodeOther; TEMP::kdefaultNodeOther ]</li>
<li>Set Field [ testlearn::NodeOthers; TEMP::DEFAULTNodeOtherNames ]</li>
<li>Set Field [ testlearn::kHealth; TEMP::kdefaultHealth ]</li>
<li>Set Field [ testlearn::incomplete; "incomplete" &amp; &para; ]</li>
<li>Set Field [ testlearn::filterFind; "main" &amp; &para; ]</li>
<li>If [ Right ( Get ( LayoutName ) ; 4 ) = "EDIT" ]</li>
<li>Set Field [ testlearn::filterFind; "main" &amp; &para; ]</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>#</li>
<li>#Note that citation is for either the node or keyword depending on the citation match.</li>
<li>Else If [ Right ( Get ( LayoutName ) ; 3 ) = "TAG" ]</li>
<li>Set Field [ testlearn::filterFind; "main" &amp; &para; ]</li>
<li>End If</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Set Variable [ $record; Value:Get (RecordNumber) ]</li>
<li>Go to Record/Request/Page [ $record ]
[ No dialog ]</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>//  Perform Script [ &ldquo;loadCitation&rdquo; ]</li>
<li>Set Variable [ $$citation; Value:testlearn::_Ltestlearn ]</li>
<li>#</li>
<li>#capture keys of related tag menu items to</li>
<li>#to allow the citationMenu scripts to loop to the</li>
<li>#primary record of interest when the user navigates</li>
<li>#to a item on the Tag Menu window</li>
<li>#whose list of tags like node, keyword, medium, etc.</li>
<li>#might contain an item related to the current</li>
<li>#citation record, but which one, which is why all</li>
<li>#the keys have to be readied.  Mmm... now that </li>
<li>#I write this out, I'm thinking I could have the </li>
<li>#citationMenu scripts select the citation window</li>
<li>#to grab the key if any in the current current</li>
<li>#record that applies to the menu item.</li>
<li>Set Variable [ $$citationRecord; Value:testlearn::_Ltestlearn ]</li>
<li>Set Variable [ $$node; Value:testlearn::kNodeOther ]</li>
<li>Set Variable [ $$primaryNode; Value:testlearn::kNodePrimary ]</li>
<li>Set Variable [ $$medium; Value:testlearn::kmedium ]</li>
<li>Set Variable [ $$health; Value:testlearn::kHealth ]</li>
<li>Set Variable [ $$Path; Value:testlearn::kfolderPath ]</li>
<li>Set Variable [ $$cite; Value:testlearn::kcitation ]</li>
<li>Set Variable [ $$ref; Value:testlearn::kcreference ]</li>
<li>Set Variable [ $$PrimaryKey; Value:testlearn::kKeywordPrimary ]</li>
<li>Set Variable [ $$Key; Value:testlearn::kcKeywordOther ]</li>
<li>Set Variable [ $$OtherKey; Value:testlearn::kcKeywordOther ]</li>
<li>Set Variable [ $$Section; Value:testlearn::kcsection ]</li>
<li>Set Variable [ $$test; Value:testlearn::kctest ]</li>
<li>Set Variable [ $$sample; Value:testlearn::kcsample ]</li>
<li>Set Variable [ $$RecordID; Value:Get (RecordID) ]</li>
<li>Set Variable [ $$stopOpenNewTextWindow ]</li>
<li>Set Variable [ $$stopLoadCitation; Value:1 ]</li>
<li>Set Variable [ $$citationItem ]</li>
<li>If [ $$citationMatch = "node" ]</li>
<li>Set Variable [ $$citationItem; Value:TEMP::kdefaultNodePrimary ]</li>
<li>End If</li>
<li>#</li>
<li>#Clear conditional formatting in Tag Menus window.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>#</li>
<li>#Open new window to edit new record in.</li>
<li>New Window [  ]</li>
<li>Go to Layout [ &ldquo;LearnTextWindow&rdquo; (testlearn) ]</li>
<li>Go to Field [ testlearn::Caption ]</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Pause/Resume Script [ Indefinitely ]</li>
<li>//  Go to Object [ Object Name: "text" ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::nodeLock</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>testlearn</em>::kcsection</li>
<li>
<em>TEMP</em>::kdefaultNodePrimary</li>
<li>
<em>testlearn</em>::kNodePrimary</li>
<li>
<em>testlearn</em>::kRecordCreatorNode</li>
<li>
<em>testlearn</em>::RecordModifyDate</li>
<li>
<em>TEMP</em>::kdefaultNodeOther</li>
<li>
<em>testlearn</em>::kNodeOther</li>
<li>
<em>TEMP</em>::DEFAULTNodeOtherNames</li>
<li>
<em>testlearn</em>::NodeOthers</li>
<li>
<em>TEMP</em>::kdefaultHealth</li>
<li>
<em>testlearn</em>::kHealth</li>
<li>
<em>testlearn</em>::incomplete</li>
<li>
<em>testlearn</em>::filterFind</li>
<li>
<em>testlearn</em>::_Ltestlearn</li>
<li>
<em>testlearn</em>::kmedium</li>
<li>
<em>testlearn</em>::kfolderPath</li>
<li>
<em>testlearn</em>::kcitation</li>
<li>
<em>testlearn</em>::kcreference</li>
<li>
<em>testlearn</em>::kKeywordPrimary</li>
<li>
<em>testlearn</em>::kcKeywordOther</li>
<li>
<em>testlearn</em>::kctest</li>
<li>
<em>testlearn</em>::kcsample</li>
<li>
<em>testlearn</em>::Caption</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32984ScriptAnchor_">loadCitation</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>LearnTextWindow</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<p>
<span class="partheading"><a name="33333ScriptAnchor_"></a><a href="#33333ScriptAnchor_toc">probablyNotInUse</a></span>
</p>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33284ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"><a href="#33333ScriptAnchor_"><span>Parent Folder: [probablyNotInUse]</span></a></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">findLearnRecord Copy</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ Get (WindowMode) = 1 ]</li>
<li>Set Variable [ $$stopFindScript ]</li>
<li>End If</li>
<li>If [ Get (WindowMode) = 1 ]</li>
<li>//  Perform Find [  ]</li>
<li>Enter Browse Mode</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Set Variable [ $$findLearnLayout; Value:Get (LayoutName) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Go to Layout [ &ldquo;learnFIND&rdquo; (testlearn) ]</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection ]</li>
<li>Show/Hide Status Area
[ Hide ]</li>
<li>Go to Field [ testlearn::Caption ]</li>
<li>Pause/Resume Script [ Indefinitely ]</li>
<li>//  Perform Find [  ]</li>
<li>Enter Browse Mode</li>
<li>Go to Field [  ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>//  Sort Records [  ]
[ No dialog ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>testlearn</em>::kcsection</li>
<li>
<em>testlearn</em>::Caption</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>learnFIND</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<p>
<span class="partheading"><a name="33315ScriptAnchor_"></a><a href="#33315ScriptAnchor_toc">reference(citation)</a></span>
</p>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32976ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#33229ScriptAnchor_"><span>Next Script: [editReference]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">newReference</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If node is currenlty locked then stop script, inform user.</li>
<li>If [ TEMP::nodeLock &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "The default node selected is locked.  Select this node in the setup window and enter the password to unlock it, then you will able to create new records assigned to this node."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If in find mode, exit script.</li>
<li>If [ $$findMode &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "Cancel find mode, then click this button."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If in find mode, exit find mode.</li>
<li>If [ $$findMode= 1 ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Set Variable [ $$findMode ]</li>
<li>Set Variable [ $$firstFind ]</li>
<li>Set Variable [ $$firstFindOther ]</li>
<li>Set Variable [ $$found ]</li>
<li>Set Variable [ $$foundOther ]</li>
<li>Go to Layout [ $$findLayout ]</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>End If</li>
<li>#</li>
<li>#If user is in tag field and has changed spelling</li>
<li>#exit this tag record, otherwise current reference record</li>
<li>#will get deleted by the spelling check script.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Go to Field [  ]</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ $$referenceSort = 2 ]</li>
<li>Sort Records [ Specified Sort Order: reference::modifyDate; descending
reference::referenceForReferenceSort; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ $$referenceSort = "" ]</li>
<li>Sort Records [ Specified Sort Order: tagKeywordPrimary::tag; ascending
reference::referenceForReferenceSort; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ $$referenceSort = 1 ]</li>
<li>Sort Records [ Specified Sort Order: reference::createDate; descending
reference::referenceForReferenceSort; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>Go to Field [  ]</li>
<li>New Record/Request</li>
<li>Set Field [ reference::kcsection; TEMP::ksection ]</li>
<li>Set Field [ reference::ktest; TEMP::ktest ]</li>
<li>Set Field [ reference::incomplete; "incomplete" &amp; &para; ]</li>
<li>If [ Get ( LayoutName ) = "Reference" or Get ( LayoutName ) = "ReferenceStuff" ]</li>
<li>Set Field [ reference::filterFind; "main" &amp; &para; ]</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>#</li>
<li>#Note that citation is for either the node or keyword depending on the citation match.</li>
<li>Else If [ Right ( Get ( LayoutName ) ; 3 ) = "TAG" ]</li>
<li>Set Field [ reference::filterFind; $$addToTag &amp; &para; ]</li>
<li>End If</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Set Variable [ $record; Value:Get (RecordNumber) ]</li>
<li>Go to Record/Request/Page [ $record ]
[ No dialog ]</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Perform Script [ &ldquo;loadCitation&rdquo; ]</li>
<li>#</li>
<li>#Go to edit layout for this record.</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;ReferenceEDITstuff&rdquo; (reference) ]</li>
<li>Else</li>
<li>Go to Layout [ &ldquo;ReferenceEDIT&rdquo; (reference) ]</li>
<li>End If</li>
<li>#</li>
<li>#Prevent add mode.</li>
<li>Set Variable [ $$stopAdd; Value:1 ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::nodeLock</li>
<li>
<em>reference</em>::modifyDate</li>
<li>
<em>reference</em>::referenceForReferenceSort</li>
<li>
<em>tagKeywordPrimary</em>::tag</li>
<li>
<em>reference</em>::createDate</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>reference</em>::kcsection</li>
<li>
<em>TEMP</em>::ktest</li>
<li>
<em>reference</em>::ktest</li>
<li>
<em>reference</em>::incomplete</li>
<li>
<em>reference</em>::filterFind</li>
<li>
<em>TEMP</em>::InventoryLibaryYN</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32984ScriptAnchor_">loadCitation</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>&lt;Missing Layout&gt;</li>
<li>ReferenceEDITstuff</li>
<li>ReferenceEDIT</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33229ScriptAnchor_"></a><td class="script_navbar"><a href="#32976ScriptAnchor_"><span>Previous Script: [newReference]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#33207ScriptAnchor_"><span>Next Script: [CHUNKaddReferenceNodesAndKeywords]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">editReference</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If node is currenlty locked then stop script, inform user.</li>
<li>If [ tagNodeCreator::orderOrLock &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "The default node selected is locked.  Select this node in the setup window and enter the password to unlock it, then you will able to edit records assigned to this node."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If in find mode, exit script.</li>
<li>If [ $$findMode &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "Cancel find mode, then click this button."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If in find mode, exit find mode.</li>
<li>If [ $$findMode= 1 ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Set Variable [ $$findMode ]</li>
<li>Set Variable [ $$firstFind ]</li>
<li>Set Variable [ $$firstFindOther ]</li>
<li>Set Variable [ $$found ]</li>
<li>Set Variable [ $$foundOther ]</li>
<li>Go to Layout [ $$findLayout ]</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>End If</li>
<li>#</li>
<li>#If user is in tag field and has changed spelling</li>
<li>#exit this tag record, otherwise current reference record</li>
<li>#will get deleted by the spelling check script.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Go to Field [  ]</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ $$referenceSort = 2 ]</li>
<li>Sort Records [ Specified Sort Order: reference::modifyDate; descending
reference::referenceForReferenceSort; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ $$referenceSort = "" ]</li>
<li>Sort Records [ Specified Sort Order: tagKeywordPrimary::tag; ascending
reference::referenceForReferenceSort; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ $$referenceSort = 1 ]</li>
<li>Sort Records [ Specified Sort Order: reference::createDate; descending
reference::referenceForReferenceSort; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#Go to edit layout for this record.</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;ReferenceEDITstuff&rdquo; (reference) ]</li>
<li>Else</li>
<li>Go to Layout [ &ldquo;ReferenceEDIT&rdquo; (reference) ]</li>
<li>End If</li>
<li>#</li>
<li>#Get rid of spaces in bookChapter field, if any.</li>
<li>Set Field [ reference::bookChapter; Trim ( reference::bookChapter ) ]</li>
<li>#</li>
<li>#Prevent add mode.</li>
<li>Set Variable [ $$stopAdd; Value:1 ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagNodeCreator</em>::orderOrLock</li>
<li>
<em>reference</em>::modifyDate</li>
<li>
<em>reference</em>::referenceForReferenceSort</li>
<li>
<em>tagKeywordPrimary</em>::tag</li>
<li>
<em>reference</em>::createDate</li>
<li>
<em>TEMP</em>::InventoryLibaryYN</li>
<li>
<em>reference</em>::bookChapter</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>&lt;Missing Layout&gt;</li>
<li>ReferenceEDITstuff</li>
<li>ReferenceEDIT</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33207ScriptAnchor_"></a><td class="script_navbar"><a href="#33229ScriptAnchor_"><span>Previous Script: [editReference]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#33065ScriptAnchor_"><span>Next Script: [addORremoveCitationOrReferenceRefTag]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">CHUNKaddReferenceNodesAndKeywords</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32987ScriptAnchor_">addTagToMainRecord</a></li>
<li><a href="#33027ScriptAnchor_">CHUNKaddLinkToTag</a></li>
<li><a href="#33022ScriptAnchor_">CHUNKaddPictureToTag</a></li>
<li><a href="#33065ScriptAnchor_">addORremoveCitationOrReferenceRefTag</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>#</li>
<li>#Add current section key to reference record's </li>
<li>#section keychain if it is not on it already.</li>
<li>If [ TEMP::ksection &amp; "&para;" &ne; FilterValues ( reference::kcsection ; TEMP::ksection &amp; "&para;" ) and Get ( LayoutTableName ) = "reference" ]</li>
<li>Set Variable [ $sectionKeychain; Value:reference::kcsection ]</li>
<li>Set Field [ reference::kcsection; TEMP::ksection &amp; &para; &amp; $sectionKeychain ]</li>
<li>End If</li>
<li>#</li>
<li>#Add current section key to learn record's </li>
<li>#section keychain if it is not on it already.</li>
<li>If [ TEMP::ksection &amp; "&para;" &ne; FilterValues ( testlearn::kcsection ; TEMP::ksection &amp; "&para;" ) and Get ( LayoutTableName ) = "testlearn" ]</li>
<li>Set Variable [ $sectionKeychain; Value:testlearn::kcsection ]</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection &amp; &para; &amp; $sectionKeychain ]</li>
<li>End If</li>
<li>#</li>
<li>//  #Check main checkbox if record is not already</li>
<li>//  #a main record.  This is because when going to</li>
<li>//  #edit cite or reference records, only main records</li>
<li>//  #are shown by default.</li>
<li>//  If [ "main" &ne; FilterValues ( reference::filterFind ; "main" ) and 
Get ( LayoutTableName ) = "reference" and 
$$add &ne; 1 ]</li>
<li>//  Set Variable [ $filterFind; Value:reference::filterFind ]</li>
<li>//  Set Field [ reference::filterFind; "main" &amp; &para; &amp; $filterFind ]</li>
<li>//  #</li>
<li>//  Else If [ $$citationMatch &ne; FilterValues ( reference::filterFind ; $$citationMatch ) and 
Get ( LayoutTableName ) = "reference" and 
$$add = 1 ]</li>
<li>//  Set Variable [ $filterFind; Value:reference::filterFind ]</li>
<li>//  #</li>
<li>//  If [ $$citationMatch &ne; "key" ]</li>
<li>//  Set Field [ reference::filterFind; $$citationMatch &amp; &para; &amp; $filterFind ]</li>
<li>//  #</li>
<li>//  Else If [ $$citationMatch = "key" ]</li>
<li>//  Set Field [ reference::filterFind; "keyword" &amp; &para; &amp; $filterFind ]</li>
<li>//  End If</li>
<li>//  #</li>
<li>//  Else If [ "main" &ne; FilterValues ( testlearn::filterFind ; "main" ) and Get ( LayoutTableName ) = "testlearn" ]</li>
<li>//  Set Variable [ $filterFind; Value:testlearn::filterFind ]</li>
<li>//  Set Field [ testlearn::filterFind; "main" &amp; &para; &amp; $filterFind ]</li>
<li>//  End If</li>
<li>#</li>
<li>#Stop load tag record script to speed up this script.</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>Set Variable [ $$stopLoadCitation; Value:1 ]</li>
<li>#</li>
<li>#Remove focus from field so can see </li>
<li>#conditional formatting.</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Get node and keyword tags linked to this </li>
<li>#main record.</li>
<li>If [ Get ( LayoutTableName ) = "reference" ]</li>
<li>Set Variable [ $nodePrimary; Value:reference::knodePrimary ]</li>
<li>Set Variable [ $nodeOther; Value:reference::knodeOther ]</li>
<li>Set Variable [ $keywordPrimary; Value:reference::kkeywordPrimary ]</li>
<li>Set Variable [ $keywordOther; Value:reference::kkeywordOther ]</li>
<li>Set Variable [ $$mainKeychain; Value:reference::kcsection ]</li>
<li>Else If [ Get ( LayoutTableName ) = "testlearn" ]</li>
<li>Set Variable [ $nodePrimary; Value:testlearn::kNodePrimary ]</li>
<li>Set Variable [ $nodeOther; Value:testlearn::kNodeOther ]</li>
<li>Set Variable [ $keywordPrimary; Value:testlearn::kKeywordPrimary ]</li>
<li>Set Variable [ $keywordOther; Value:testlearn::kcKeywordOther ]</li>
<li>Set Variable [ $$mainKeychain; Value:testlearn::kcsection ]</li>
<li>Else If [ Get ( LayoutTableName ) = "tagMenus" ]</li>
<li>Set Variable [ $nodePrimary; Value:TEMP::kdefaultNodePrimary ]</li>
<li>Set Variable [ $nodeOther; Value:TEMP::kdefaultNodeOther ]</li>
<li>Else If [ Get ( LayoutTableName ) = "tempSetup" ]</li>
<li>Set Variable [ $nodePrimary; Value:tempSetup::kdefaultNodePrimary ]</li>
<li>Set Variable [ $nodeOther; Value:tempSetup::kdefaultNodeOther ]</li>
<li>Set Variable [ $$mainKeychain; Value:tempSetup::ksection ]</li>
<li>#Left this section in for setup, althought script never</li>
<li>#goes to setup section, so this is here just to note</li>
<li>#that I did think of this, but after testing determined</li>
<li>#the setup section is not neccessary.</li>
<li>End If</li>
<li>#</li>
<li>#Perform the rest of the script in a new window so</li>
<li>#users place is not lost in current window.</li>
<li>New Window [  ]</li>
<li>Go to Layout [ &ldquo;ltagNK1&rdquo; (tagMenus) ]</li>
<li>#</li>
<li>#PRIMARY NODE</li>
<li>#Find primary node if there is one.</li>
<li>If [ $nodePrimary &ne; "" ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::_Ltag; $nodePrimary ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Add any section keys just added to the main record</li>
<li>#that are not in this tag's section group keychain.</li>
<li>If [ $nodePrimary = tagMenus::_Ltag ]</li>
<li>Perform Script [ &ldquo;CHUNKaddMainSectionKeysToTagRecordKeychain_addMode&rdquo; ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#OTHER NODES</li>
<li>#Find other nodes if there are any.</li>
<li>If [ $nodeOther &ne; "" ]</li>
<li>#</li>
<li>#Determine how many keys there are to find for</li>
<li>#on the other nodes' keychain.</li>
<li>Set Variable [ $numberOfNodes; Value:ValueCount ( $nodeOther ) ]</li>
<li>#</li>
<li>#Loop thru each node record, with every key </li>
<li>#in the keychain.</li>
<li>Loop</li>
<li>#</li>
<li>#Exit the loop when there are no more keys to check.</li>
<li>Exit Loop If [ $numberOfNodes = 0 ]</li>
<li>#</li>
<li>#Find node.</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Go to Layout [ &ldquo;ltagNK1&rdquo; (tagMenus) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::_Ltag; GetValue ( $nodeOther ; $numberOfNodes ) ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Add any section keys just added to the main record</li>
<li>#that are not in this tag's section group keychain.</li>
<li>If [ GetValue ( $nodeOther ; $numberOfNodes ) = tagMenus::_Ltag ]</li>
<li>Perform Script [ &ldquo;CHUNKaddMainSectionKeysToTagRecordKeychain_addMode&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>#Go the next key up from the bottom of the list</li>
<li>#of keys on this section's keychain.</li>
<li>Set Variable [ $numberOfNodes; Value:$numberOfNodes - 1 ]</li>
<li>End Loop</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#Find all keywords assigned if there are any.</li>
<li>If [ $keywordPrimary &ne; "" ]</li>
<li>#Find in a new window so user's place is not lost</li>
<li>#on Tag Menus window.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::_Ltag; $keywordPrimary ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#PRIMARY KEYWORD</li>
<li>#</li>
<li>#Add any section keys just added to the main record</li>
<li>#that are not in this tag's section group keychain.</li>
<li>If [ $keywordPrimary = tagMenus::_Ltag ]</li>
<li>Perform Script [ &ldquo;CHUNKaddMainSectionKeysToTagRecordKeychain_addMode&rdquo; ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#OTHER KEYWORDS</li>
<li>#Find all keywords assigned if there are any.</li>
<li>If [ $keywordOther &ne; "" ]</li>
<li>#</li>
<li>#Determine how many keys there are to find for</li>
<li>#on the other keywords' keychain.</li>
<li>Set Variable [ $numberOfKeywords; Value:ValueCount ( $keywordOther ) ]</li>
<li>#</li>
<li>#Loop thru each keyword record, with every key </li>
<li>#in the keychain.</li>
<li>Loop</li>
<li>#Exit the loop when there are no more keys to check.</li>
<li>Exit Loop If [ $numberOfKeywords = 0 ]</li>
<li>#</li>
<li>#Find keyword.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::_Ltag; GetValue ( $keywordOther ; $numberOfKeywords ) ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Add any section keys just added to the main record</li>
<li>#that are not in this tag's section group keychain.</li>
<li>If [ GetValue ( $keywordOther ; $numberOfKeywords ) = tagMenus::_Ltag ]</li>
<li>Perform Script [ &ldquo;CHUNKaddMainSectionKeysToTagRecordKeychain_addMode&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>#Go the next key up from the bottom of the list</li>
<li>#of keys on this section's keychain.</li>
<li>Set Variable [ $numberOfKeywords; Value:$numberOfKeywords - 1 ]</li>
<li>End Loop</li>
<li>End If</li>
<li>#</li>
<li>#Turn top load tag record script back on.</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>#</li>
<li>Set Variable [ $$mainKeychain ]</li>
<li>Close Window [ Current Window ]</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>reference</em>::kcsection</li>
<li>
<em>testlearn</em>::kcsection</li>
<li>
<em>reference</em>::filterFind</li>
<li>
<em>testlearn</em>::filterFind</li>
<li>
<em>reference</em>::knodePrimary</li>
<li>
<em>reference</em>::knodeOther</li>
<li>
<em>reference</em>::kkeywordPrimary</li>
<li>
<em>reference</em>::kkeywordOther</li>
<li>
<em>testlearn</em>::kNodePrimary</li>
<li>
<em>testlearn</em>::kNodeOther</li>
<li>
<em>testlearn</em>::kKeywordPrimary</li>
<li>
<em>testlearn</em>::kcKeywordOther</li>
<li>
<em>TEMP</em>::kdefaultNodePrimary</li>
<li>
<em>TEMP</em>::kdefaultNodeOther</li>
<li>
<em>tempSetup</em>::kdefaultNodePrimary</li>
<li>
<em>tempSetup</em>::kdefaultNodeOther</li>
<li>
<em>tempSetup</em>::ksection</li>
<li>
<em>tagMenus</em>::_Ltag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33208ScriptAnchor_">CHUNKaddMainSectionKeysToTagRecordKeychain_addMode</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>ltagNK1</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33065ScriptAnchor_"></a><td class="script_navbar"><a href="#33207ScriptAnchor_"><span>Previous Script: [CHUNKaddReferenceNodesAndKeywords]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#33216ScriptAnchor_"><span>Next Script: [deleteReference]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">addORremoveCitationOrReferenceRefTag</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33066ScriptAnchor_">addORremoveRefTagStep1</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Get current record IDs in reference or </li>
<li>#observation window.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>If [ testlearn::kcitation &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "References can be added after the citation is removed. (Cite the source of an unchanged copy, clip, quote, etc. from one source. Reference the sources of your rewording/remixing of one or more texts, movies, etc.)"; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Set Variable [ $$ref; Value:testlearn::kcreference ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Variable [ $$ref; Value:reference::lock ]</li>
<li>End If</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>#</li>
<li>#If tag user clicked has not yet been selected, then add it.</li>
<li>If [ reference::_Lreference &amp; "&para;"  &ne;  FilterValues ( $$ref ; reference::_Lreference &amp; "&para;" ) ]</li>
<li>Freeze Window</li>
<li>Perform Script [ &ldquo;CHUNKaddMainRecordSectionKeysToCiteOrRefSectionKeychain&rdquo; ]</li>
<li>//  #</li>
<li>//  #Stop script if user trying to add reference or learn record</li>
<li>//  #that has references or citations added to it.</li>
<li>//  #In the future this will be possible, but for now I need</li>
<li>//  #to focus on other things to get the beta released.</li>
<li>//  If [ testlearn::kcitation &ne; "" or testlearn::kcreference &ne; "" or reference::kcitation &ne; "" ]</li>
<li>//  Show Custom Dialog [ Message: "For now, you cannot use a record that has its own citation or references added to it as a citation or reference for another record.  This is a known issue, and in a future release it will be resolved.   "; Buttons: &ldquo;OK&rdquo; ]</li>
<li>//  Exit Script [  ]</li>
<li>//  End If</li>
<li>#</li>
<li>Set Variable [ $newRef; Value:reference::_Lreference ]</li>
<li>#</li>
<li>#Set record number so can return user to it when done.</li>
<li>Set Variable [ $recordNumber; Value:Get (RecordNumber) ]</li>
<li>#</li>
<li>#Add reference in reference or observation window.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Set Field [ testlearn::kcreference; $newRef &amp; "&para;" &amp; $$ref ]</li>
<li>Set Variable [ $$ref; Value:testlearn::kcreference ]</li>
<li>Go to Field [  ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Field [ reference::lock; $newRef &amp; "&para;" &amp; $$ref ]</li>
<li>Set Variable [ $$ref; Value:reference::lock ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>//  #Sort records according to users wishes.</li>
<li>//  If [ TEMP::sortKey = "cat" ]</li>
<li>//  Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>//  Else If [ TEMP::sortKey = "abc" ]</li>
<li>//  Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>//  End If</li>
<li>//  Set Variable [ $$stopLoadTagRecord ]</li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  Scroll Window
[ Home ]</li>
<li>Freeze Window</li>
<li>Go to Record/Request/Page [ $recordNumber ]
[ No dialog ]</li>
<li>#</li>
<li>#Check main checkbox if record is not already</li>
<li>#a main record.  This is because when going to</li>
<li>#edit cite or reference records, only main records</li>
<li>#are shown by default.</li>
<li>If [ "main" &amp; &para; &ne; FilterValues ( reference::filterFind ; "main" &amp; &para; ) and Get ( LayoutTableName ) = "reference" ]</li>
<li>Set Variable [ $filterFind; Value:reference::filterFind ]</li>
<li>Set Field [ reference::filterFind; "main" &amp; &para; &amp; $filterFind ]</li>
<li>End If</li>
<li>#</li>
<li>#If reference or learn record that tag was added</li>
<li>#to belongs to more than one section, then </li>
<li>#add these other sections to the tag's group </li>
<li>#keychain so when this tag record is viewed in </li>
<li>#those sections, the reference or learn record </li>
<li>#just added to it will show up as well.</li>
<li>Perform Script [ &ldquo;CHUNKaddReferenceNodesAndKeywords&rdquo; ]</li>
<li>#Sort records according to users wishes.</li>
<li>Freeze Window</li>
<li>If [ TEMP::sortRef = "cat" ]</li>
<li>Sort Records [ Specified Sort Order: tagKeywordPrimary::orderOrLock; ascending
tagKeywordPrimary::tag; ascending
reference::referenceShort; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ TEMP::sortRef = "abc" ]</li>
<li>Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>#</li>
<li>#Go to citation record's current selection or to first record.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Loop</li>
<li>Exit Loop If [ FilterValues ( $$ref ; reference::_Lreference )  =   reference::_Lreference &amp; &para; ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>If [ FilterValues ( $$ref ; reference::_Lreference )  &ne;  reference::_Lreference &amp; &para; ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>End If</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If tag has been selected, then remove it.</li>
<li>Set Variable [ $removeRef; Value:reference::_Lreference ]</li>
<li>#</li>
<li>#Set record number so can return user to it when done.</li>
<li>Set Variable [ $recordNumber; Value:Get (RecordNumber) ]</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Set Field [ testlearn::kcreference; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used

If ( ValueCount ( $$ref) &ne; ValueCount ( Substitute ( $$ref ; $removeRef &amp; "&para;"  ; "" ) ) ; 

Substitute ( $$ref ; $removeRef &amp; "&para;"  ; "" ) ; 

Substitute ( $$ref ; $removeRef; "" ) 

) ]</li>
<li>Set Variable [ $$ref; Value:testlearn::kcreference ]</li>
<li>Go to Field [  ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Field [ reference::lock; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used

If ( ValueCount ( $$ref ) &ne; ValueCount ( Substitute ( $$ref ; $removeRef&amp; "&para;"  ; "" ) ) ; 

Substitute ( $$ref ; $removeRef &amp; "&para;"  ; "" ) ; 

Substitute ( $$ref ; $removeRef ; "" ) 

) ]</li>
<li>Set Variable [ $$ref; Value:reference::lock ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
<li>#</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>#Sort records according to users wishes.</li>
<li>If [ TEMP::sortRef = "cat" ]</li>
<li>Sort Records [ Specified Sort Order: tagKeywordPrimary::orderOrLock; ascending
tagKeywordPrimary::tag; ascending
reference::referenceShort; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ TEMP::sortRef = "abc" ]</li>
<li>Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $recordNumber ]
[ No dialog ]</li>
<li>Set Variable [ $$skipFirstPartOfScript ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearn</em>::kcitation</li>
<li>
<em>testlearn</em>::kcreference</li>
<li>
<em>reference</em>::lock</li>
<li>
<em>reference</em>::_Lreference</li>
<li>
<em>reference</em>::kcitation</li>
<li>
<em>TEMP</em>::sortKey</li>
<li>
<em>ruleTagMenuGroups</em>::order</li>
<li>
<em>ruleTagMenuGroups</em>::name</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>reference</em>::filterFind</li>
<li>
<em>TEMP</em>::sortRef</li>
<li>
<em>tagKeywordPrimary</em>::orderOrLock</li>
<li>
<em>tagKeywordPrimary</em>::tag</li>
<li>
<em>reference</em>::referenceShort</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33212ScriptAnchor_">CHUNKaddMainRecordSectionKeysToCiteOrRefSectionKeychain</a></li>
<li><a href="#33207ScriptAnchor_">CHUNKaddReferenceNodesAndKeywords</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33216ScriptAnchor_"></a><td class="script_navbar"><a href="#33065ScriptAnchor_"><span>Previous Script: [addORremoveCitationOrReferenceRefTag]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#33031ScriptAnchor_"><span>Next Script: [showFileInReferenceWindow]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">deleteReference</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If node is currenlty locked then stop script, inform user.</li>
<li>If [ tagNodeCreator::orderOrLock &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "The default node selected is locked.  Select this node in the setup window and enter the password to unlock it, then you will able to delete records assigned to this node."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If in find mode, exit script.</li>
<li>If [ $$findMode &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "Cancel find mode, then click this button."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If user is in tag field and has changed spelling</li>
<li>#exit this tag record, otherwise current reference record</li>
<li>#will get deleted by the spelling check script.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Go to Field [  ]</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ $$referenceSort = 2 ]</li>
<li>Sort Records [ Specified Sort Order: reference::modifyDate; descending
reference::referenceForReferenceSort; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ $$referenceSort = "" ]</li>
<li>Sort Records [ Specified Sort Order: tagKeywordPrimary::tag; ascending
reference::referenceForReferenceSort; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ $$referenceSort = 1 ]</li>
<li>Sort Records [ Specified Sort Order: reference::createDate; descending
reference::referenceForReferenceSort; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#Exit field so user can see red delete </li>
<li>#formatting later on.</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Prevent all record load scripts (they slow down</li>
<li>#this script and are uneccessary).</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>#</li>
<li>#Set variables to conditionally format section to</li>
<li>#be deleted, and its record number so if the</li>
<li>#user cancels the delete, the system can return</li>
<li>#to this record.</li>
<li>Set Variable [ $delete; Value:reference::_Lreference ]</li>
<li>Set Variable [ $deleteName; Value:reference::_Number ]</li>
<li>Set Variable [ $recordNumber; Value:Get (RecordNumber) ]</li>
<li>Set Variable [ $section; Value:TEMP::ksection ]</li>
<li>#</li>
<li>#Because there may be no records found, stop</li>
<li>#the system from informing the user of this.</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>#</li>
<li>#Open a new window and look for record being</li>
<li>#cited or used as a reference by another record.</li>
<li>New Window [  ]</li>
<li>#</li>
<li>Loop</li>
<li>#</li>
<li>#Clear the inUse variable before each run thru</li>
<li>#the loop.  If not cleared, then last time thru</li>
<li>#if this variable had a value in it, that value will</li>
<li>#stay in it even if no finds are made, which then</li>
<li>#tells the system that a no-find reference, has finds.</li>
<li>#So the system must clear this variable before each</li>
<li>#run thru the loop.</li>
<li>Set Variable [ $inUse ]</li>
<li>#</li>
<li>#See if reference is used by any learn records as a</li>
<li>#citation.</li>
<li>Go to Layout [ &ldquo;tableTestLearn&rdquo; (testlearn) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kcitation; $delete ]</li>
<li>Set Field [ testlearn::kcsection; $section ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>If [ Get (LastError) &ne; 401 ]</li>
<li>Set Variable [ $inUse; Value:Get (FoundCount) &amp; " learn (cite tag)" ]</li>
<li>End If</li>
<li>#</li>
<li>#See if reference is used by any learn records as a</li>
<li>#reference.</li>
<li>Go to Layout [ &ldquo;tableTestLearn&rdquo; (testlearn) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kcreference; $delete ]</li>
<li>Set Field [ testlearn::kcsection; $section ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>If [ Get (LastError) &ne; 401 ]</li>
<li>If [ $inUse &ne; "" ]</li>
<li>Set Variable [ $addToInUse; Value:$inUse ]</li>
<li>Set Variable [ $inUse; Value:$addToInUse &amp; ", " &amp; Get (FoundCount)  &amp; " learn (reference tag)" ]</li>
<li>Else If [ $inUse = "" ]</li>
<li>Set Variable [ $inUse; Value:Get (FoundCount) &amp; " learn (reference tag)" ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#See if reference is used by any reference records as a</li>
<li>#citation.</li>
<li>Go to Layout [ &ldquo;Reference&rdquo; (reference) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::kcitation; $delete ]</li>
<li>Set Field [ reference::kcsection; "==" &amp; $section ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>If [ Get (LastError) &ne; 401 ]</li>
<li>If [ $inUse &ne; "" ]</li>
<li>Set Variable [ $addToInUse; Value:$inUse ]</li>
<li>Set Variable [ $inUse; Value:$addToInUse &amp; ", " &amp; Get (FoundCount)  &amp; " reference (cite tag)" ]</li>
<li>Else If [ $inUse = "" ]</li>
<li>Set Variable [ $inUse; Value:Get (FoundCount) &amp; " reference (cite tag)" ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#See if reference record is used by any tag records as a</li>
<li>#picture.</li>
<li>Go to Layout [ &ldquo;tableTag&rdquo; (tagTable) ]</li>
<li>#picture1</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTable::Kpicture1; $delete ]</li>
<li>Set Field [ ruleLibrary 2::ksection; $section ]</li>
<li>Perform Find [  ]</li>
<li>Set Variable [ $tagFound1; Value:Get (FoundCount) ]</li>
<li>If [ Get (FoundCount) &gt; 0 ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Variable [ $tagNameADD; Value:$tagName ]</li>
<li>Set Variable [ $tagName; Value:Case (
$tagNameAdd = "" ; 
tagTable::tag ;
$tagNameAdd &amp; "; " &amp; tagTable::tag ) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>End If</li>
<li>#picture2</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTable::Kpicture2; $delete ]</li>
<li>Set Field [ ruleLibrary 2::ksection; $section ]</li>
<li>Perform Find [  ]</li>
<li>Set Variable [ $tagFound2; Value:Get (FoundCount) ]</li>
<li>If [ Get (FoundCount) &gt; 0 ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Variable [ $tagNameADD; Value:$tagName ]</li>
<li>Set Variable [ $tagName; Value:Case (
$tagNameAdd = "" ; 
tagTable::tag ;
$tagNameAdd &amp; "; " &amp; tagTable::tag ) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>End If</li>
<li>#picture3</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTable::Kpicture3; $delete ]</li>
<li>Set Field [ ruleLibrary 2::ksection; $section ]</li>
<li>Perform Find [  ]</li>
<li>Set Variable [ $tagFound3; Value:Get (FoundCount) ]</li>
<li>If [ Get (FoundCount) &gt; 0 ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Variable [ $tagNameADD; Value:$tagName ]</li>
<li>Set Variable [ $tagName; Value:Case (
$tagNameAdd = "" ; 
tagTable::tag ;
$tagNameAdd &amp; "; " &amp; tagTable::tag ) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>End If</li>
<li>#</li>
<li>If [ $tagFound1 + $tagFound2 + $tagFound3  &ne;  0 ]</li>
<li>If [ $inUse &ne; "" ]</li>
<li>Set Variable [ $addToInUse; Value:$inUse ]</li>
<li>Set Variable [ $inUse; Value:$addToInUse &amp; ", " &amp; ($tagFound1 + $tagFound2 + $tagFound3) &amp; " tag menu picture(s) (" &amp; $tagName &amp; ")" ]</li>
<li>Else If [ $inUse = "" ]</li>
<li>Set Variable [ $inUse; Value:($tagFound1 + $tagFound2 + $tagFound3) &amp; " tag menu picture(s) (" &amp; $tagName &amp; ")" ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>Set Variable [ $tagFound1 ]</li>
<li>Set Variable [ $tagFound2 ]</li>
<li>Set Variable [ $tagFound3 ]</li>
<li>Set Variable [ $tagNameADD ]</li>
<li>Set Variable [ $tagName ]</li>
<li>#</li>
<li>#See if reference record is used by any tag records </li>
<li>#as a web link.</li>
<li>Go to Layout [ &ldquo;tableTag&rdquo; (tagTable) ]</li>
<li>#link1</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTable::Ktitle1; $delete ]</li>
<li>Set Field [ ruleLibrary 2::ksection; $section ]</li>
<li>Perform Find [  ]</li>
<li>Set Variable [ $tagFound1; Value:Get (FoundCount) ]</li>
<li>If [ Get (FoundCount) &gt; 0 ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Variable [ $tagNameADD; Value:$tagName ]</li>
<li>Set Variable [ $tagName; Value:Case (
$tagNameAdd = "" ; 
tagTable::tag ;
$tagNameAdd &amp; "; " &amp; tagTable::tag ) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>End If</li>
<li>#link2</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTable::Ktitle2; $delete ]</li>
<li>Set Field [ ruleLibrary 2::ksection; $section ]</li>
<li>Perform Find [  ]</li>
<li>Set Variable [ $tagFound2; Value:Get (FoundCount) ]</li>
<li>If [ Get (FoundCount) &gt; 0 ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Variable [ $tagNameADD; Value:$tagName ]</li>
<li>Set Variable [ $tagName; Value:Case (
$tagNameAdd = "" ; 
tagTable::tag ;
$tagNameAdd &amp; "; " &amp; tagTable::tag ) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>End If</li>
<li>#link3</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagTable::Ktitle3; $delete ]</li>
<li>Set Field [ ruleLibrary 2::ksection; $section ]</li>
<li>Perform Find [  ]</li>
<li>Set Variable [ $tagFound3; Value:Get (FoundCount) ]</li>
<li>If [ Get (FoundCount) &gt; 0 ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Variable [ $tagNameADD; Value:$tagName ]</li>
<li>Set Variable [ $tagName; Value:Case (
$tagNameAdd = "" ; 
tagTable::tag ;
$tagNameAdd &amp; "; " &amp; tagTable::tag ) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>End If</li>
<li>#</li>
<li>If [ $tagFound1 + $tagFound2 + $tagFound3  &ne;  0 ]</li>
<li>If [ $inUse &ne; "" ]</li>
<li>Set Variable [ $addToInUse; Value:$inUse ]</li>
<li>Set Variable [ $inUse; Value:$addToInUse &amp; ", " &amp; ($tagFound1 + $tagFound2 + $tagFound3) &amp; " tag menu link(s) (" &amp; $tagName &amp; ")" ]</li>
<li>Else If [ $inUse = "" ]</li>
<li>Set Variable [ $inUse; Value:($tagFound1 + $tagFound2 + $tagFound3) &amp; " tag menu link(s) (" &amp; $tagName &amp; ")" ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>Set Variable [ $tagFound1 ]</li>
<li>Set Variable [ $tagFound2 ]</li>
<li>Set Variable [ $tagFound3 ]</li>
<li>Set Variable [ $tagNameADD ]</li>
<li>Set Variable [ $tagName ]</li>
<li>#</li>
<li>#If the current record is in use in the section of</li>
<li>#the database from which the delete was requested,</li>
<li>#inform the user of this, and skip the next </li>
<li>#steps of this loop and the next loop, which.</li>
<li>#is for checking if record is in use in other sections.</li>
<li>If [ $section = TEMP::ksection and $inUse &ne; "" ]</li>
<li>#</li>
<li>#If the record was in use in the current section</li>
<li>#then do not look for it in other sections.</li>
<li>Set Variable [ $checkSection; Value:$section ]</li>
<li>Set Variable [ $section ]</li>
<li>Exit Loop If [ $checkSection = TEMP::ksection and $inUse &ne; "" ]</li>
<li>End If</li>
<li>#</li>
<li>#If the current record is not in use in the section</li>
<li>#of the database from which this delete was started,</li>
<li>#capture this information.</li>
<li>If [ $section = TEMP::ksection and $inUse = "" ]</li>
<li>Set Variable [ $deleteNotInUse; Value:"not in use" ]</li>
<li>End If</li>
<li>#</li>
<li>#Exit the loop if there is only 1 section key for this record</li>
<li>#or if the system just checked for the record</li>
<li>#in all sections of the database, which</li>
<li>#is why the section variable would be blank.</li>
<li>#In the latter case, the loop would be coming round</li>
<li>#after checking all sections in the database.</li>
<li>#At first the loop is confined to looking at all records</li>
<li>#in this section.  Once it has done that, a script</li>
<li>#step below exits the loop only to enter a loop</li>
<li>#that clears the section variable and causes the</li>
<li>#system to re-enter this loop, only with a blank</li>
<li>#section variable so it will look in all sections of the</li>
<li>#database.  When it reaches this step, that blank</li>
<li>#section variable will force it out of this loop and</li>
<li>#a similar script step in the outer loop will do the</li>
<li>#same thereby allowing the system to follow the</li>
<li>#remainder of this script to report on the findings</li>
<li>#made during these discovery loops.</li>
<li>Exit Loop If [ ValueCount ( reference::kcsection )  =  1 or $section = "" ]</li>
<li>#</li>
<li>#If the current record is not in use in the section</li>
<li>#of the database where the delete was started,</li>
<li>#make sure it is not in use in any other section.</li>
<li>Set Variable [ $section ]</li>
<li>#</li>
<li>End Loop</li>
<li>#</li>
<li>Close Window [ Current Window ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#Report on findings and if none delete record.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#If the record in question was not found in the</li>
<li>#section the user is deleting it from...</li>
<li>If [ $deleteNotInUse &ne; "" ]</li>
<li>#</li>
<li>#But this record is in use in other sections...</li>
<li>If [ $inUse &ne; "" ]</li>
<li>#</li>
<li>Refresh Window</li>
<li>Show Custom Dialog [ Message: "This record cannot be deleted as it in use in other sections of the database.  You can remove it from this section though as it is not being used in this section."; Buttons: &ldquo;cancel&rdquo;, &ldquo;remove&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>#</li>
<li>#If the user chooses not to remove the record</li>
<li>#everything goes back to the way it was.</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $delete ]</li>
<li>Set Variable [ $$addTagToCitation ]</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Refresh Window</li>
<li>Exit Script [  ]</li>
<li>Else If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>#</li>
<li>Set Variable [ $delete ]</li>
<li>Set Variable [ $$addTagToCitation ]</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>#</li>
<li>#If the user choses to proceed with the removal,</li>
<li>#the section key is removed from the record's</li>
<li>#key chain.  ( paragraph mark is added to section in </li>
<li>#     case the key has no paragraph mark after it and so</li>
<li>#     would not be found. )</li>
<li>Set Field [ reference::kcsection; Substitute ( reference::kcsection &amp; &para; ; TEMP::ksection &amp; &para; ; "" ) ]</li>
<li>#</li>
<li>#Omit the record as it no longer is part of this section.</li>
<li>Omit Record</li>
<li>#</li>
<li>End If</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#If record was found in current section tell user.</li>
<li>If [ $inUse &ne; "" ]</li>
<li>Set Variable [ $delete ]</li>
<li>Refresh Window</li>
<li>Show Custom Dialog [ Message: "Record cannot be deleted as it in use in these windows: "  &amp; $inUse &amp; "."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Set Variable [ $$addTagToCitation ]</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#If the record being deleted was not found in</li>
<li>#use in any sections of the database then before</li>
<li>#deleting it make sure the user really wants it deleted.</li>
<li>Set Variable [ $group ]</li>
<li>Refresh Window</li>
<li>Show Custom Dialog [ Message: "Delete current record?"; Buttons: &ldquo;cancel&rdquo;, &ldquo;delete&rdquo; ]</li>
<li>Set Variable [ $group; Value:tagMenus::kGroupOrTest ]</li>
<li>Set Variable [ $deleteGroup; Value:ruleTagMenuGroups::name ]</li>
<li>#</li>
<li>#If the user cancels, stop the delete.</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $delete ]</li>
<li>Set Variable [ $group ]</li>
<li>Refresh Window</li>
<li>Refresh Window</li>
<li>Set Variable [ $$addTagToCitation ]</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>#If the user says yes, then delete the record.</li>
<li>Else If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>#</li>
<li>End If</li>
<li>Set Variable [ $delete ]</li>
<li>Set Variable [ $group ]</li>
<li>Refresh Window</li>
<li>Set Variable [ $$addTagToCitation ]</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Perform Script [ &ldquo;loadCitation&rdquo; ]</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagNodeCreator</em>::orderOrLock</li>
<li>
<em>reference</em>::modifyDate</li>
<li>
<em>reference</em>::referenceForReferenceSort</li>
<li>
<em>tagKeywordPrimary</em>::tag</li>
<li>
<em>reference</em>::createDate</li>
<li>
<em>reference</em>::_Lreference</li>
<li>
<em>reference</em>::_Number</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>testlearn</em>::kcitation</li>
<li>
<em>testlearn</em>::kcsection</li>
<li>
<em>testlearn</em>::kcreference</li>
<li>
<em>reference</em>::kcitation</li>
<li>
<em>reference</em>::kcsection</li>
<li>
<em>tagTable</em>::Kpicture1</li>
<li>
<em>ruleLibrary 2</em>::ksection</li>
<li>
<em>tagTable</em>::tag</li>
<li>
<em>tagTable</em>::Kpicture2</li>
<li>
<em>tagTable</em>::Kpicture3</li>
<li>
<em>tagTable</em>::Ktitle1</li>
<li>
<em>tagTable</em>::Ktitle2</li>
<li>
<em>tagTable</em>::Ktitle3</li>
<li>
<em>tagMenus</em>::kGroupOrTest</li>
<li>
<em>ruleTagMenuGroups</em>::name</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32984ScriptAnchor_">loadCitation</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>tableTestLearn</li>
<li>Reference</li>
<li>tableTag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33031ScriptAnchor_"></a><td class="script_navbar"><a href="#33216ScriptAnchor_"><span>Previous Script: [deleteReference]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#33049ScriptAnchor_"><span>Next Script: [showReference1]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">showFileInReferenceWindow</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Show reference file.</li>
<li>If [ FilterValues ( citationTitle1::kfileLocation ; "8162011225532313" ) = "8162011225532313" &amp; &para; ]</li>
<li>Open URL [ Substitute (Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/" &amp; citationTitle1::fileName ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Else If [ FilterValues ( citationTitle1::kfileLocation ; "8162011225558314" ) = "8162011225558314" &amp; &para; ]</li>
<li>Open URL [  Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; citationTitle1::fileName ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( citationTitle1::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para; ]</li>
<li>If [ Right (citationTitle1::fileName ; 3) = "mp4"
 or Right (citationTitle1::fileName ; 3) = "mov" ]</li>
<li>Open URL [ Substitute ( tagFolderPathForFile::tag &amp; citationTitle1::fileName ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Else</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:/" ; "file:///" ) &amp; tagFolderPathForFile::tag ; " " ; "%20" ) &amp;

Case ( Left ( citationTitle1::fileName ; 1 ) =  "/" ; Substitute ( citationTitle1::fileName ; " " ; "%20" ) ;

 "/" &amp; Substitute ( citationTitle1::fileName ; " " ; "%20" ) ) ]
[ No dialog ]</li>
<li>End If</li>
<li>Else If [ citationTitle1::URL &ne; "" ]</li>
<li>Open URL [ citationTitle1::URL ]
[ No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#Show testlearn file.</li>
<li>If [ FilterValues ( TLTitle1::kfileLocation ; "8162011225532313" ) = "8162011225532313" &amp; &para; ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/" &amp; TLTitle1::filename ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Else If [ FilterValues ( TLTitle1::kfileLocation ; "8162011225558314" ) = "8162011225558314" &amp; &para; ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; TLTitle1::filename ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( TLTitle1::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para; ]</li>
<li>Open URL [ Substitute ( tagTLFolderPathForFile1::tag &amp; TLTitle1::filename ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Else If [ TLTitle1::URL &ne; "" ]</li>
<li>Open URL [ TLTitle1::URL ]
[ No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#Show path folder.</li>
<li>If [ tagMenus::tag &ne; "" and $$citationMatch = "path" ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:/" ; "file:///" ) &amp; tagMenus::tag ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>citationTitle1</em>::kfileLocation</li>
<li>
<em>citationTitle1</em>::fileName</li>
<li>
<em>tagFolderPathForFile</em>::tag</li>
<li>
<em>citationTitle1</em>::URL</li>
<li>
<em>TLTitle1</em>::kfileLocation</li>
<li>
<em>TLTitle1</em>::filename</li>
<li>
<em>tagTLFolderPathForFile1</em>::tag</li>
<li>
<em>TLTitle1</em>::URL</li>
<li>
<em>tagMenus</em>::tag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33049ScriptAnchor_"></a><td class="script_navbar"><a href="#33031ScriptAnchor_"><span>Previous Script: [showFileInReferenceWindow]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#33051ScriptAnchor_"><span>Next Script: [showReference2]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">showReference1</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If user is not in add mode then inform user they</li>
<li>#must be before the database will show them reference</li>
<li>#data.  The reason for this is because the layout</li>
<li>#in the reference or learn window changes to the</li>
<li>#add tag from these windows to the Tag Menu</li>
<li>#item selected.  So instead of having the system</li>
<li>#automatically go into add mode, the user must</li>
<li>#decide they want to do this and thus be expecting</li>
<li>#a change in the layouts.  Otherwise this change</li>
<li>#could confuse a user.  So at the cost of minor </li>
<li>#inconvience I have choose not to have the system</li>
<li>#guess the user wants to go into add mode and is </li>
<li>#expecting the system to do that when they click</li>
<li>#one of these numbered buttons on the showEvenMore</li>
<li>#layouts.</li>
<li>If [ $$add = "" ]</li>
<li>Show Custom Dialog [ Message: "Click the 'add' button above and then click this button to see citation for this item. "; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If the field is blank then stop the script.</li>
<li>#No poin in looking for a record where there isn't one.</li>
<li>If [ tagMenus::Ktitle1 = "" ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Capture the key to unlock the record it belongs to.</li>
<li>Set Variable [ $key; Value:tagMenus::Ktitle1 ]</li>
<li>#</li>
<li>#Determine if the key comes from the testlearn</li>
<li>#table, and if so perform these script steps.</li>
<li>If [ TLTitle1::_Ltestlearn &ne; "" ]</li>
<li>#</li>
<li>#Select the correct window and then change its</li>
<li>#name if neccessary to match the table the </li>
<li>#records are coming from.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>End If</li>
<li>Set Window Title [ Current Window; New Title: "Learn" ]</li>
<li>Go to Layout [ &lt;unknown&gt; ]</li>
<li>#</li>
<li>#Prevent record loading script during loops to</li>
<li>#find wanted record, which would slow down system.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>#</li>
<li>#Now loop thru all the records until the record</li>
<li>#that fits the key is found.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ testlearn::_Ltestlearn = $key ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Allow the record load script to run and run it.</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Perform Script [ &ldquo;loadCitation&rdquo; ]</li>
<li>#</li>
<li>#Put focus back on Tag Menus window and conditionally</li>
<li>#format any items that may be linked to record</li>
<li>#in the other window.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#Determine if the key comes from the reference</li>
<li>#table, and if so perform these script steps.</li>
<li>Else If [ citationTitle1::_Lreference &ne; "" ]</li>
<li>#</li>
<li>#Select the correct window and then change its</li>
<li>#name if neccessary to match the table the </li>
<li>#records are coming from.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>End If</li>
<li>Set Window Title [ Current Window; New Title: "References" ]</li>
<li>Go to Layout [ &ldquo;ReferenceAddToTag&rdquo; (reference) ]</li>
<li>#</li>
<li>#Prevent record loading script during loops to</li>
<li>#find wanted record, which would slow down system.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>#</li>
<li>#Now loop thru all the records until the record</li>
<li>#that fits the key is found.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ reference::_Lreference = $key ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Allow the record load script to run and run it.</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Perform Script [ &ldquo;loadCitation&rdquo; ]</li>
<li>#</li>
<li>#Put focus back on Tag Menus window and conditionally</li>
<li>#format any items that may be linked to record</li>
<li>#in the other window.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagMenus</em>::Ktitle1</li>
<li>
<em>TLTitle1</em>::_Ltestlearn</li>
<li>
<em>testlearn</em>::_Ltestlearn</li>
<li>
<em>citationTitle1</em>::_Lreference</li>
<li>
<em>reference</em>::_Lreference</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32984ScriptAnchor_">loadCitation</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>&lt;Missing Layout&gt;</li>
<li>ReferenceAddToTag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33051ScriptAnchor_"></a><td class="script_navbar"><a href="#33049ScriptAnchor_"><span>Previous Script: [showReference1]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#33052ScriptAnchor_"><span>Next Script: [showReference3]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">showReference2</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If user is not in add mode then inform user they</li>
<li>#must be before the database will show them reference</li>
<li>#data.  The reason for this is because the layout</li>
<li>#in the reference or learn window changes to the</li>
<li>#add tag from these windows to the Tag Menu</li>
<li>#item selected.  So instead of having the system</li>
<li>#automatically go into add mode, the user must</li>
<li>#decide they want to do this and thus be expecting</li>
<li>#a change in the layouts.  Otherwise this change</li>
<li>#could confuse a user.  So at the cost of minor </li>
<li>#inconvience I have choose not to have the system</li>
<li>#guess the user wants to go into add mode and is </li>
<li>#expecting the system to do that when they click</li>
<li>#one of these numbered buttons on the showEvenMore</li>
<li>#layouts.</li>
<li>If [ $$add = "" ]</li>
<li>Show Custom Dialog [ Message: "Click the 'add' button above and then click this button to see citation for this item. "; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If the field is blank then stop the script.</li>
<li>#No poin in looking for a record where there isn't one.</li>
<li>If [ tagMenus::Ktitle2 = "" ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Capture the key to unlock the record it belongs to.</li>
<li>Set Variable [ $key; Value:tagMenus::Ktitle2 ]</li>
<li>#</li>
<li>#Determine if the key comes from the testlearn</li>
<li>#table, and if so perform these script steps.</li>
<li>If [ TLTitle2::_Ltestlearn &ne; "" ]</li>
<li>#</li>
<li>#Select the correct window and then change its</li>
<li>#name if neccessary to match the table the </li>
<li>#records are coming from.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>End If</li>
<li>Set Window Title [ Current Window; New Title: "Learn" ]</li>
<li>Go to Layout [ &lt;unknown&gt; ]</li>
<li>#</li>
<li>#Prevent record loading script during loops to</li>
<li>#find wanted record, which would slow down system.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>#</li>
<li>#Now loop thru all the records until the record</li>
<li>#that fits the key is found.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ testlearn::_Ltestlearn = $key ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Allow the record load script to run and run it.</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Perform Script [ &ldquo;loadCitation&rdquo; ]</li>
<li>#</li>
<li>#Put focus back on Tag Menus window and conditionally</li>
<li>#format any items that may be linked to record</li>
<li>#in the other window.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#Determine if the key comes from the reference</li>
<li>#table, and if so perform these script steps.</li>
<li>Else If [ citationTitle2::_Lreference &ne; "" ]</li>
<li>#</li>
<li>#Select the correct window and then change its</li>
<li>#name if neccessary to match the table the </li>
<li>#records are coming from.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>End If</li>
<li>Set Window Title [ Current Window; New Title: "References" ]</li>
<li>Go to Layout [ &ldquo;ReferenceAddToTag&rdquo; (reference) ]</li>
<li>#</li>
<li>#Prevent record loading script during loops to</li>
<li>#find wanted record, which would slow down system.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>#</li>
<li>#Now loop thru all the records until the record</li>
<li>#that fits the key is found.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ reference::_Lreference = $key ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Allow the record load script to run and run it.</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Perform Script [ &ldquo;loadCitation&rdquo; ]</li>
<li>#</li>
<li>#Put focus back on Tag Menus window and conditionally</li>
<li>#format any items that may be linked to record</li>
<li>#in the other window.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagMenus</em>::Ktitle2</li>
<li>
<em>TLTitle2</em>::_Ltestlearn</li>
<li>
<em>testlearn</em>::_Ltestlearn</li>
<li>
<em>citationTitle2</em>::_Lreference</li>
<li>
<em>reference</em>::_Lreference</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32984ScriptAnchor_">loadCitation</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>&lt;Missing Layout&gt;</li>
<li>ReferenceAddToTag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33052ScriptAnchor_"></a><td class="script_navbar"><a href="#33051ScriptAnchor_"><span>Previous Script: [showReference2]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#33084ScriptAnchor_"><span>Next Script: [internalReferences]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">showReference3</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If user is not in add mode then inform user they</li>
<li>#must be before the database will show them reference</li>
<li>#data.  The reason for this is because the layout</li>
<li>#in the reference or learn window changes to the</li>
<li>#add tag from these windows to the Tag Menu</li>
<li>#item selected.  So instead of having the system</li>
<li>#automatically go into add mode, the user must</li>
<li>#decide they want to do this and thus be expecting</li>
<li>#a change in the layouts.  Otherwise this change</li>
<li>#could confuse a user.  So at the cost of minor </li>
<li>#inconvience I have choose not to have the system</li>
<li>#guess the user wants to go into add mode and is </li>
<li>#expecting the system to do that when they click</li>
<li>#one of these numbered buttons on the showEvenMore</li>
<li>#layouts.</li>
<li>If [ $$add = "" ]</li>
<li>Show Custom Dialog [ Message: "Click the 'add' button above and then click this button to see citation for this item. "; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If the field is blank then stop the script.</li>
<li>#No poin in looking for a record where there isn't one.</li>
<li>If [ tagMenus::Ktitle3 = "" ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Capture the key to unlock the record it belongs to.</li>
<li>Set Variable [ $key; Value:tagMenus::Ktitle3 ]</li>
<li>#</li>
<li>#Determine if the key comes from the testlearn</li>
<li>#table, and if so perform these script steps.</li>
<li>If [ TLTitle3::_Ltestlearn &ne; "" ]</li>
<li>#</li>
<li>#Select the correct window and then change its</li>
<li>#name if neccessary to match the table the </li>
<li>#records are coming from.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>End If</li>
<li>Set Window Title [ Current Window; New Title: "Learn" ]</li>
<li>Go to Layout [ &lt;unknown&gt; ]</li>
<li>#</li>
<li>#Prevent record loading script during loops to</li>
<li>#find wanted record, which would slow down system.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>#</li>
<li>#Now loop thru all the records until the record</li>
<li>#that fits the key is found.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ testlearn::_Ltestlearn = $key ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Allow the record load script to run and run it.</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Perform Script [ &ldquo;loadCitation&rdquo; ]</li>
<li>#</li>
<li>#Put focus back on Tag Menus window and conditionally</li>
<li>#format any items that may be linked to record</li>
<li>#in the other window.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#Determine if the key comes from the reference</li>
<li>#table, and if so perform these script steps.</li>
<li>Else If [ citationTitle3::_Lreference &ne; "" ]</li>
<li>#</li>
<li>#Select the correct window and then change its</li>
<li>#name if neccessary to match the table the </li>
<li>#records are coming from.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>End If</li>
<li>Set Window Title [ Current Window; New Title: "References" ]</li>
<li>Go to Layout [ &ldquo;ReferenceAddToTag&rdquo; (reference) ]</li>
<li>#</li>
<li>#Prevent record loading script during loops to</li>
<li>#find wanted record, which would slow down system.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>#</li>
<li>#Now loop thru all the records until the record</li>
<li>#that fits the key is found.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ reference::_Lreference = $key ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Allow the record load script to run and run it.</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Perform Script [ &ldquo;loadCitation&rdquo; ]</li>
<li>#</li>
<li>#Put focus back on Tag Menus window and conditionally</li>
<li>#format any items that may be linked to record</li>
<li>#in the other window.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagMenus</em>::Ktitle3</li>
<li>
<em>TLTitle3</em>::_Ltestlearn</li>
<li>
<em>testlearn</em>::_Ltestlearn</li>
<li>
<em>citationTitle3</em>::_Lreference</li>
<li>
<em>reference</em>::_Lreference</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32984ScriptAnchor_">loadCitation</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>&lt;Missing Layout&gt;</li>
<li>ReferenceAddToTag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33084ScriptAnchor_"></a><td class="script_navbar"><a href="#33052ScriptAnchor_"><span>Previous Script: [showReference3]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#33085ScriptAnchor_"><span>Next Script: [externalReferences]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">internalReferences</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>If [ $$findmode &ne; 1 ]</li>
<li>#Set testlearn internal reference field conditional</li>
<li>#formatting to green if there are any.  </li>
<li>Set Variable [ $$internal; Value:1 ]</li>
<li>#</li>
<li>#Show all internal reference possibilities.</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;learnMenu4STUFFRefCite&rdquo; (testlearn) ]</li>
<li>Else</li>
<li>Go to Layout [ &ldquo;learnMenu4RefCite&rdquo; (testlearn) ]</li>
<li>End If</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Set Field [ testlearn::sampleCasePoint; "1" ]</li>
<li>End If</li>
<li>Set Field [ testlearn::filterFind; "main" ]</li>
<li>Perform Find [  ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Sort Records [ Specified Sort Order: testlearn::Caption; ascending
testlearn::date; descending
testlearn::timestamp; descending ]
[ Restore; No dialog ]</li>
<li>Else</li>
<li>Sort Records [ Specified Sort Order: testlearn::date; descending
testlearn::timestamp; descending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#If the user has yet to create any Learn or internal records</li>
<li>#let them know, and return user to outside reference records.</li>
<li>If [ Get (LastError) = 401 ]</li>
<li>Perform Script [ &ldquo;externalReferences&rdquo; ]</li>
<li>Show Custom Dialog [ Message: "No inside (Learn) records have been created."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>#Continue with show all internal reference possibilities...</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Loop</li>
<li>Exit Loop If [ testlearn::_Ltestlearn  = $$cite  and $$citationMatch = "cite" or 

testlearn::_Ltestlearn &amp; "&para;"  = FilterValues ( $$ref ; testlearn::_Ltestlearn &amp; "&para;" )  and $$citationMatch = "ref" ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Decided below was too much help.  User can look</li>
<li>#on main screen to see where cite or reference is located.</li>
<li>//  #Capture information about location of ref and cite records.</li>
<li>//  #Because it can be in four possible locations, conditonal</li>
<li>//  #formatting is essential to help user remember.</li>
<li>//  If [ testlearn::_Ltestlearn  = $$citationitem  and $$citationMatch = "cite" ]</li>
<li>//  #</li>
<li>//  #Turn on cite location variable that conditionally</li>
<li>//  #formatts buttons to tell user where reference is located.</li>
<li>//  Set Variable [ $$citeIsLearnRecord; Value:1 ]</li>
<li>//  #</li>
<li>//  Else If [ testlearn::_Ltestlearn &amp; "&para;"  = FilterValues ( $$ref ; testlearn::_Ltestlearn &amp; "&para;" )  and $$citationMatch = "ref" ]</li>
<li>//  #</li>
<li>//  #Turn on reference location variable that conditionally</li>
<li>//  #formatts buttons to tell user where reference is located.</li>
<li>//  Set Variable [ $$refIsLearnRecord; Value:1 ]</li>
<li>//  End If</li>
<li>#</li>
<li>#If no records are used as a cite or ref, go to first record.</li>
<li>If [ Get (LastError) = 101 ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>#</li>
<li>//  #Turn on reference location variable that conditionally</li>
<li>//  #formatts buttons to tell user where reference is located.</li>
<li>//  Set Variable [ $$refIsLearnRecord ]</li>
<li>End If</li>
<li>#</li>
<li>#Update conditional formatting in main window.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Go to Field [  ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>#</li>
<li>#If in find mode ...</li>
<li>Else If [ $$findmode = 1 ]</li>
<li>#Set testlearn internal reference field conditional</li>
<li>#formatting to green if there are any.  </li>
<li>Set Variable [ $$internal; Value:1 ]</li>
<li>#</li>
<li>#Show all internal reference possibilities.</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;learnMenu4RefStuffCiteFindTL&rdquo; (testlearn) ]</li>
<li>Else</li>
<li>Go to Layout [ &ldquo;learnMenu4RefCiteFindTL&rdquo; (testlearn) ]</li>
<li>End If</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Set Field [ testlearn::sampleCasePoint; "1" ]</li>
<li>End If</li>
<li>Perform Find [  ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Sort Records [ Specified Sort Order: testlearn::Caption; ascending
testlearn::date; descending
testlearn::timestamp; descending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::InventoryLibaryYN</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>testlearn</em>::kcsection</li>
<li>
<em>testlearn</em>::sampleCasePoint</li>
<li>
<em>testlearn</em>::filterFind</li>
<li>
<em>testlearn</em>::Caption</li>
<li>
<em>testlearn</em>::date</li>
<li>
<em>testlearn</em>::timestamp</li>
<li>
<em>testlearn</em>::_Ltestlearn</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33085ScriptAnchor_">externalReferences</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>learnMenu4STUFFRefCite</li>
<li>learnMenu4RefCite</li>
<li>learnMenu4RefStuffCiteFindTL</li>
<li>learnMenu4RefCiteFindTL</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33085ScriptAnchor_"></a><td class="script_navbar"><a href="#33084ScriptAnchor_"><span>Previous Script: [internalReferences]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#33184ScriptAnchor_"><span>Next Script: [changeSpellingOfReferenceNodes]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">externalReferences</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33064ScriptAnchor_">menuReference</a></li>
<li><a href="#32983ScriptAnchor_">TgotoCitationMenu</a></li>
<li><a href="#33084ScriptAnchor_">internalReferences</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#Use this bit of code to make the default reference
</li>
<li>#point to the internal (Learn) records instead of</li>
<li>#the external references.  Other scripts with code</li>
<li>#that needs to be turned on: menuReference, </li>
<li>//  #If library is for inventory then go to container menu.</li>
<li>//  If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>//  Perform Script [ &ldquo;menuReference&rdquo; ]</li>
<li>//  Exit Script [  ]</li>
<li>//  End If</li>
<li>#</li>
<li>#If current mode is citation then use cite menu scirpt.</li>
<li>If [ $$citationMatch = "cite" ]</li>
<li>Perform Script [ &ldquo;menuRefAddKeyWords&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>If [ $$findmode &ne; 1 ]</li>
<li>#Set testlearn internal reference field conditional</li>
<li>#formatting to transparent.  </li>
<li>Set Variable [ $$internal ]</li>
<li>#</li>
<li>#Show all internal reference possibilities.</li>
<li>#</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;learnMenuRefStuff&rdquo; (reference) ]</li>
<li>Else</li>
<li>Go to Layout [ &ldquo;learnMenu3Cite&rdquo; (reference) ]</li>
<li>End If</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>#</li>
<li>#Go to citation record's current selection or to first record.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Loop</li>
<li>Exit Loop If [ FilterValues ( $$ref ; reference::_Lreference )  =   reference::_Lreference &amp; &para; ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>If [ FilterValues ( $$ref ; reference::_Lreference )  &ne;  reference::_Lreference &amp; &para; ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>End If</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>#</li>
<li>#Update conditional formatting in main window.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Go to Field [  ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Else If [ $$findmode = 1 ]</li>
<li>#Set testlearn internal reference field conditional</li>
<li>#formatting to transparent.  </li>
<li>Set Variable [ $$internal ]</li>
<li>#</li>
<li>#Show all internal reference possibilities.</li>
<li>Go to Layout [ &ldquo;learnFindCite&rdquo; (reference) ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::InventoryLibaryYN</li>
<li>
<em>reference</em>::_Lreference</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33064ScriptAnchor_">menuReference</a></li>
<li><a href="#33042ScriptAnchor_">menuRefAddKeyWords</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>learnMenuRefStuff</li>
<li>learnMenu3Cite</li>
<li>learnFindCite</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33184ScriptAnchor_"></a><td class="script_navbar"><a href="#33085ScriptAnchor_"><span>Previous Script: [externalReferences]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#33189ScriptAnchor_"><span>Next Script: [duplicateReferenceRecord]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">changeSpellingOfReferenceNodes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Variable [ $key; Value:reference::referenceNodes ]</li>
<li>Set Variable [ $keyOLD; Value:reference::referenceNodesOLD ]</li>
<li>Set Variable [ $keyChain; Value:reference::kcopyrightHolder ]</li>
<li>#</li>
<li>#</li>
<li>If [ $keyOLD &amp; "&para;"  = FilterValues ( $keychain ; $keyOLD &amp; "&para;" ) and $key = "" ]</li>
<li>Set Field [ reference::kcopyrightHolder; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used

//If ( ValueCount ( $keyChain ) &ne; ValueCount ( Substitute ( $keyChain ; $key &amp; "&para;"  ; "" ) ) ; 

Substitute ( $keyChain ; $keyOLD &amp; "&para;"  ; "" )   //; 

//Substitute ( $keyChain ; $key ; "" ) 

//) ]</li>
<li>Else If [ $keyOLD &amp; "&para;"  = FilterValues ( $keychain ; $keyOLD &amp; "&para;" ) ]</li>
<li>Set Field [ reference::kcopyrightHolder; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used

//If ( ValueCount ( $keyChain ) &ne; ValueCount ( Substitute ( $keyChain ; $key &amp; "&para;"  ; "" ) ) ; 

Substitute ( $keyChain ; $keyOLD &amp; "&para;"  ; $key &amp; "&para;" )   //; 

//Substitute ( $keyChain ; $key ; "" ) 

//) ]</li>
<li>End If</li>
<li>Set Field [ reference::referenceNodesOLD; $key ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::referenceNodes</li>
<li>
<em>reference</em>::referenceNodesOLD</li>
<li>
<em>reference</em>::kcopyrightHolder</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33189ScriptAnchor_"></a><td class="script_navbar"><a href="#33184ScriptAnchor_"><span>Previous Script: [changeSpellingOfReferenceNodes]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#33190ScriptAnchor_"><span>Next Script: [addModeReferenceLearnToggle]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">duplicateReferenceRecord</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If node is currenlty locked then stop script, inform user.</li>
<li>If [ TEMP::nodeLock &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "The default node selected is locked.  Select this node in the setup window and enter the password to unlock it, then you will able to create new records assigned to this node."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If in find mode, exit script.</li>
<li>If [ $$findMode &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "Cancel find mode, then click this button."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If in find mode, exit find mode.</li>
<li>If [ $$findMode= 1 ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Set Variable [ $$findMode ]</li>
<li>Set Variable [ $$firstFind ]</li>
<li>Set Variable [ $$firstFindOther ]</li>
<li>Set Variable [ $$found ]</li>
<li>Set Variable [ $$foundOther ]</li>
<li>Go to Layout [ $$findLayout ]</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>End If</li>
<li>#</li>
<li>#If user is in tag field and has changed spelling</li>
<li>#exit this tag record, otherwise current reference record</li>
<li>#will get deleted by the spelling check script.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Go to Field [  ]</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ $$referenceSort = 2 ]</li>
<li>Sort Records [ Specified Sort Order: reference::modifyDate; descending
reference::referenceForReferenceSort; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ $$referenceSort = "" ]</li>
<li>Sort Records [ Specified Sort Order: tagKeywordPrimary::tag; ascending
reference::referenceForReferenceSort; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ $$referenceSort = 1 ]</li>
<li>Sort Records [ Specified Sort Order: reference::createDate; descending
reference::referenceForReferenceSort; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>#</li>
<li>Set Variable [ $type; Value:reference::kmediaType ]</li>
<li>Set Variable [ $media; Value:reference::kmedia ]</li>
<li>Set Variable [ $typeOther; Value:reference::TypeOfMediumOther ]</li>
<li>#</li>
<li>Set Variable [ $P; Value:reference::kkeywordPrimary ]</li>
<li>Set Variable [ $O; Value:reference::kkeywordOther ]</li>
<li>Set Variable [ $Owords; Value:reference::OtherKeyWords ]</li>
<li>#$$nodeprimary is already known by the system.</li>
<li>Set Variable [ $NodeOthers; Value:reference::NodeOthers ]</li>
<li>Set Variable [ $authorList; Value:reference::referenceNodes ]</li>
<li>Set Variable [ $authorListOLD; Value:reference::referenceNodesOLD ]</li>
<li>Set Variable [ $title; Value:reference::Title ]</li>
<li>#</li>
<li>Set Variable [ $picture; Value:reference::picture ]</li>
<li>#</li>
<li>Set Variable [ $chapter; Value:reference::bookChapter ]</li>
<li>Set Variable [ $dissertation; Value:reference::dissertationThesisUniversity ]</li>
<li>Set Variable [ $govt; Value:reference::governmentAuthor ]</li>
<li>Set Variable [ $govtDoc; Value:reference::GovernmentDocInfo ]</li>
<li>Set Variable [ $letter; Value:reference::letterDate ]</li>
<li>Set Variable [ $email; Value:reference::emailRecipient ]</li>
<li>Set Variable [ $ctitle; Value:reference::compilationTitle ]</li>
<li>Set Variable [ $ceditor; Value:reference::compilationEditors ]</li>
<li>Set Variable [ $cnumber; Value:reference::compilationNumberOfEditors ]</li>
<li>Set Variable [ $cAbbr; Value:reference::compilationAbbr ]</li>
<li>Set Variable [ $conIntro; Value:reference::conferenceIntroWords ]</li>
<li>Set Variable [ $conTitle; Value:reference::conferenceTitle ]</li>
<li>Set Variable [ $conSubTitle; Value:reference::conferenceSubTitle ]</li>
<li>Set Variable [ $conGname; Value:reference::conferenceGroupName ]</li>
<li>Set Variable [ $conLocation; Value:reference::conferenceLocation ]</li>
<li>Set Variable [ $conDate; Value:reference::conferenceDate ]</li>
<li>#</li>
<li>Set Variable [ $volumeNumber; Value:reference::volumeNumber ]</li>
<li>Set Variable [ $issueNumber; Value:reference::issueNumber ]</li>
<li>Set Variable [ $pageNumberRange; Value:reference::pageNumberRange ]</li>
<li>#</li>
<li>Set Variable [ $noPP; Value:reference::pageNumberOther ]</li>
<li>#</li>
<li>Set Variable [ $TimeRange; Value:reference::TimeRange ]</li>
<li>Set Variable [ $copyrightHolder; Value:reference::kcopyrightHolder ]</li>
<li>#</li>
<li>Set Variable [ $notPub; Value:reference::publisherTypeAlternative ]</li>
<li>Set Variable [ $notPubOther; Value:reference::publisherTypeOther ]</li>
<li>Set Variable [ $pubLocation; Value:reference::publisherLocation ]</li>
<li>#</li>
<li>Set Variable [ $pubYear; Value:reference::pubYear ]</li>
<li>#</li>
<li>Set Variable [ $pubDate; Value:reference::PubDate ]</li>
<li>Set Variable [ $pubDateOther; Value:reference::pubDateOther ]</li>
<li>#</li>
<li>Set Variable [ $copyrightYear; Value:reference::CopyrightYear ]</li>
<li>#</li>
<li>Set Variable [ $copyrightOtherHolder; Value:reference::copyrightOtherHolder ]</li>
<li>#</li>
<li>Set Variable [ $URL; Value:reference::URL ]</li>
<li>Set Variable [ $URLdate; Value:reference::URLdate ]</li>
<li>#</li>
<li>Set Variable [ $library; Value:reference::library only ]</li>
<li>Set Variable [ $isbn; Value:reference::ISBN ]</li>
<li>Set Variable [ $doi; Value:reference::URLdoi ]</li>
<li>Set Variable [ $issn; Value:reference::ISSN ]</li>
<li>#</li>
<li>Set Variable [ $fileName; Value:reference::fileName ]</li>
<li>Set Variable [ $InFolder; Value:reference::kfileLocation ]</li>
<li>Set Variable [ $citation; Value:reference::kcitation ]</li>
<li>Set Variable [ $notes; Value:reference::thoughtsNotesEtc ]</li>
<li>Set Variable [ $refDump; Value:reference::referenceDump ]</li>
<li>#</li>
<li>Set Variable [ $rights; Value:reference::rights ]</li>
<li>Go to Field [  ]</li>
<li>New Record/Request</li>
<li>#</li>
<li>#</li>
<li>Set Field [ reference::kmediaType; $type ]</li>
<li>Set Field [ reference::kmedia; $media ]</li>
<li>Set Field [ reference::TypeOfMediumOther; $typeOther ]</li>
<li>#</li>
<li>Set Field [ reference::kkeywordPrimary; $P ]</li>
<li>Set Field [ reference::kkeywordOther; $O ]</li>
<li>Set Field [ reference::OtherKeyWords; $Owords ]</li>
<li>Set Field [ reference::knodePrimary; $$primaryNode ]</li>
<li>Set Field [ reference::knodeOther; $$node ]</li>
<li>Set Field [ reference::NodeOthers; $NodeOthers ]</li>
<li>Set Field [ reference::referenceNodes; $authorList ]</li>
<li>Set Field [ reference::referenceNodesOLD; $authorListOLD ]</li>
<li>Set Field [ reference::Title; $title ]</li>
<li>#</li>
<li>Set Field [ reference::picture; $picture ]</li>
<li>#</li>
<li>Set Field [ reference::bookChapter; $chapter ]</li>
<li>Set Field [ reference::dissertationThesisUniversity; $dissertation ]</li>
<li>Set Field [ reference::governmentAuthor; $govt ]</li>
<li>Set Field [ reference::GovernmentDocInfo; $govtDoc ]</li>
<li>Set Field [ reference::letterDate; $letter ]</li>
<li>Set Field [ reference::emailRecipient; $email ]</li>
<li>Set Field [ reference::compilationTitle; $ctitle ]</li>
<li>Set Field [ reference::compilationEditors; $ceditor ]</li>
<li>Set Field [ reference::compilationNumberOfEditors; $cnumber ]</li>
<li>Set Field [ reference::compilationAbbr; $cAbbr ]</li>
<li>Set Field [ reference::conferenceIntroWords; $conIntro ]</li>
<li>Set Field [ reference::conferenceTitle; $conTitle ]</li>
<li>Set Field [ reference::conferenceSubTitle; $conSubTitle ]</li>
<li>Set Field [ reference::conferenceGroupName; $conGname ]</li>
<li>Set Field [ reference::conferenceLocation; $conLocation ]</li>
<li>Set Field [ reference::conferenceDate; $conDate ]</li>
<li>#</li>
<li>Set Field [ reference::korgan; $$organ ]</li>
<li>Set Field [ reference::volumeNumber; $volumeNumber ]</li>
<li>Set Field [ reference::issueNumber; $issueNumber ]</li>
<li>Set Field [ reference::pageNumberRange; $pageNumberRange ]</li>
<li>#</li>
<li>Set Field [ reference::pageNumberOther; $noPP ]</li>
<li>#</li>
<li>Set Field [ reference::kcopyrightHolder; $copyrightHolder ]</li>
<li>Set Field [ reference::TimeRange; $TimeRange ]</li>
<li>#</li>
<li>Set Field [ reference::kcopyist; $$copyist ]</li>
<li>#</li>
<li>Set Field [ reference::publisherTypeAlternative; $notPub ]</li>
<li>Set Field [ reference::publisherTypeOther; $notPubOther ]</li>
<li>Set Field [ reference::publisherLocation; $pubLocation ]</li>
<li>#</li>
<li>Set Field [ reference::pubYear; $pubYear ]</li>
<li>#</li>
<li>Set Field [ reference::PubDate; $pubDate ]</li>
<li>Set Field [ reference::pubDateOther; $pubDateOther ]</li>
<li>#</li>
<li>Set Field [ reference::kHealth; $$health ]</li>
<li>Set Field [ reference::CopyrightYear; $copyrightYear ]</li>
<li>#</li>
<li>Set Field [ reference::copyrightOtherHolder; $copyrightOtherHolder ]</li>
<li>#</li>
<li>Set Field [ reference::URL; $URL ]</li>
<li>Set Field [ reference::URLdate; $URLdate ]</li>
<li>#</li>
<li>Set Field [ reference::library only; $library ]</li>
<li>Set Field [ reference::ISBN; $isbn ]</li>
<li>Set Field [ reference::URLdoi; $doi ]</li>
<li>Set Field [ reference::ISSN; $issn ]</li>
<li>#</li>
<li>Set Field [ reference::fileName; $fileName ]</li>
<li>Set Field [ reference::kfileLocation; $InFolder ]</li>
<li>Set Field [ reference::kfolderpath; $$Path ]</li>
<li>Set Field [ reference::kcitation; $citation ]</li>
<li>Set Field [ reference::thoughtsNotesEtc; $notes ]</li>
<li>Set Field [ reference::referenceDump; $refDump ]</li>
<li>#</li>
<li>Set Field [ reference::rights; $rights ]</li>
<li>Set Field [ reference::kcsection; TEMP::ksection ]</li>
<li>Set Field [ reference::ktest; TEMP::ktest ]</li>
<li>Set Field [ reference::incomplete; "incomplete" &amp; &para; ]</li>
<li>#</li>
<li>Set Field [ reference::kcopyrightType; $$copyrightType ]</li>
<li>Set Field [ reference::lock; $$Ref ]</li>
<li>If [ Get ( LayoutName ) = "Reference" or Get ( LayoutName ) = "ReferenceStuff" ]</li>
<li>Set Field [ reference::filterFind; "main" &amp; &para; ]</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>#</li>
<li>#Note that citation is for either the node or keyword depending on the citation match.</li>
<li>Else If [ Right ( Get ( LayoutName ) ; 3 ) = "TAG" ]</li>
<li>Set Field [ reference::filterFind; $$addToTag &amp; &para; ]</li>
<li>End If</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Set Variable [ $record; Value:Get (RecordNumber) ]</li>
<li>Go to Record/Request/Page [ $record ]
[ No dialog ]</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Perform Script [ &ldquo;loadCitation&rdquo; ]</li>
<li>#</li>
<li>#Go to edit layout for this record.</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;ReferenceEDITstuff&rdquo; (reference) ]</li>
<li>Else</li>
<li>Go to Layout [ &ldquo;ReferenceEDIT&rdquo; (reference) ]</li>
<li>End If</li>
<li>#</li>
<li>#Prevent add mode.</li>
<li>Set Variable [ $$stopAdd; Value:1 ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::nodeLock</li>
<li>
<em>reference</em>::modifyDate</li>
<li>
<em>reference</em>::referenceForReferenceSort</li>
<li>
<em>tagKeywordPrimary</em>::tag</li>
<li>
<em>reference</em>::createDate</li>
<li>
<em>reference</em>::kmediaType</li>
<li>
<em>reference</em>::kmedia</li>
<li>
<em>reference</em>::TypeOfMediumOther</li>
<li>
<em>reference</em>::kkeywordPrimary</li>
<li>
<em>reference</em>::kkeywordOther</li>
<li>
<em>reference</em>::OtherKeyWords</li>
<li>
<em>reference</em>::NodeOthers</li>
<li>
<em>reference</em>::referenceNodes</li>
<li>
<em>reference</em>::referenceNodesOLD</li>
<li>
<em>reference</em>::Title</li>
<li>
<em>reference</em>::picture</li>
<li>
<em>reference</em>::bookChapter</li>
<li>
<em>reference</em>::dissertationThesisUniversity</li>
<li>
<em>reference</em>::governmentAuthor</li>
<li>
<em>reference</em>::GovernmentDocInfo</li>
<li>
<em>reference</em>::letterDate</li>
<li>
<em>reference</em>::emailRecipient</li>
<li>
<em>reference</em>::compilationTitle</li>
<li>
<em>reference</em>::compilationEditors</li>
<li>
<em>reference</em>::compilationNumberOfEditors</li>
<li>
<em>reference</em>::compilationAbbr</li>
<li>
<em>reference</em>::conferenceIntroWords</li>
<li>
<em>reference</em>::conferenceTitle</li>
<li>
<em>reference</em>::conferenceSubTitle</li>
<li>
<em>reference</em>::conferenceGroupName</li>
<li>
<em>reference</em>::conferenceLocation</li>
<li>
<em>reference</em>::conferenceDate</li>
<li>
<em>reference</em>::volumeNumber</li>
<li>
<em>reference</em>::issueNumber</li>
<li>
<em>reference</em>::pageNumberRange</li>
<li>
<em>reference</em>::pageNumberOther</li>
<li>
<em>reference</em>::TimeRange</li>
<li>
<em>reference</em>::kcopyrightHolder</li>
<li>
<em>reference</em>::publisherTypeAlternative</li>
<li>
<em>reference</em>::publisherTypeOther</li>
<li>
<em>reference</em>::publisherLocation</li>
<li>
<em>reference</em>::pubYear</li>
<li>
<em>reference</em>::PubDate</li>
<li>
<em>reference</em>::pubDateOther</li>
<li>
<em>reference</em>::CopyrightYear</li>
<li>
<em>reference</em>::copyrightOtherHolder</li>
<li>
<em>reference</em>::URL</li>
<li>
<em>reference</em>::URLdate</li>
<li>
<em>reference</em>::library only</li>
<li>
<em>reference</em>::ISBN</li>
<li>
<em>reference</em>::URLdoi</li>
<li>
<em>reference</em>::ISSN</li>
<li>
<em>reference</em>::fileName</li>
<li>
<em>reference</em>::kfileLocation</li>
<li>
<em>reference</em>::kcitation</li>
<li>
<em>reference</em>::thoughtsNotesEtc</li>
<li>
<em>reference</em>::referenceDump</li>
<li>
<em>reference</em>::rights</li>
<li>
<em>reference</em>::knodePrimary</li>
<li>
<em>reference</em>::knodeOther</li>
<li>
<em>reference</em>::korgan</li>
<li>
<em>reference</em>::kcopyist</li>
<li>
<em>reference</em>::kHealth</li>
<li>
<em>reference</em>::kfolderpath</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>reference</em>::kcsection</li>
<li>
<em>TEMP</em>::ktest</li>
<li>
<em>reference</em>::ktest</li>
<li>
<em>reference</em>::incomplete</li>
<li>
<em>reference</em>::kcopyrightType</li>
<li>
<em>reference</em>::lock</li>
<li>
<em>reference</em>::filterFind</li>
<li>
<em>TEMP</em>::InventoryLibaryYN</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32984ScriptAnchor_">loadCitation</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>&lt;Missing Layout&gt;</li>
<li>ReferenceEDITstuff</li>
<li>ReferenceEDIT</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33190ScriptAnchor_"></a><td class="script_navbar"><a href="#33189ScriptAnchor_"><span>Previous Script: [duplicateReferenceRecord]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#33251ScriptAnchor_"><span>Next Script: [findReferenceRecord]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">addModeReferenceLearnToggle</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ Get (WindowName) = "References" ]</li>
<li>Go to Layout [ &lt;unknown&gt; ]</li>
<li>Set Window Title [ Current Window; New Title: "Learn" ]</li>
<li>Else If [ Get (WindowName) = "Learn" ]</li>
<li>Go to Layout [ &ldquo;ReferenceAddToTag&rdquo; (reference) ]</li>
<li>Set Window Title [ Current Window; New Title: "References" ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>&lt;Missing Layout&gt;</li>
<li>ReferenceAddToTag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33251ScriptAnchor_"></a><td class="script_navbar"><a href="#33190ScriptAnchor_"><span>Previous Script: [addModeReferenceLearnToggle]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#33255ScriptAnchor_"><span>Next Script: [sortReferences]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">findReferenceRecord</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>If [ $$findMode &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "Cancel find in Tag Menus window then click this button."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If user is in tag field and has changed spelling</li>
<li>#exit this tag record, otherwise current reference record</li>
<li>#will get deleted by the spelling check script.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Go to Field [  ]</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ $$referenceSort = 2 ]</li>
<li>Sort Records [ Specified Sort Order: reference::modifyDate; descending
reference::referenceForReferenceSort; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ $$referenceSort = "" ]</li>
<li>Sort Records [ Specified Sort Order: tagKeywordPrimary::tag; ascending
reference::referenceForReferenceSort; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ $$referenceSort = 1 ]</li>
<li>Sort Records [ Specified Sort Order: reference::createDate; descending
reference::referenceForReferenceSort; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#Capture errors and tell user about them in custom </li>
<li>#dialogue box.</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>#</li>
<li>#If the user clicks the find button and the system is already</li>
<li>#in find mode, capture the user's current find request</li>
<li>#and then perform the requested find.</li>
<li>#This capture is done in case nothing is found and the</li>
<li>#user is asked if they want to modify their request.</li>
<li>#The system puts in the captured request so that the </li>
<li>#user can see the failed request.</li>
<li>If [ Get (WindowMode) = 1 ]</li>
<li>Set Variable [ $r0; Value:reference::createDate ]</li>
<li>Set Variable [ $r1; Value:reference::modifyDate ]</li>
<li>Set Variable [ $r2; Value:reference::show ]</li>
<li>Set Variable [ $r3; Value:reference::incomplete ]</li>
<li>Set Variable [ $r4; Value:reference::referenceForReferenceWindow ]</li>
<li>Set Variable [ $r5; Value:reference::kmediaType ]</li>
<li>Set Variable [ $r6; Value:reference::kmedia ]</li>
<li>Set Variable [ $r7; Value:reference::TypeOfMediumOther ]</li>
<li>Set Variable [ $r8; Value:reference::referenceNodes ]</li>
<li>Set Variable [ $r9; Value:reference::Title ]</li>
<li>Set Variable [ $r10; Value:reference::bookChapter ]</li>
<li>Set Variable [ $r11; Value:reference::governmentAuthor ]</li>
<li>Set Variable [ $r12; Value:reference::GovernmentDocInfo ]</li>
<li>Set Variable [ $r13; Value:reference::letterDate ]</li>
<li>Set Variable [ $r14; Value:reference::emailRecipient ]</li>
<li>Set Variable [ $r15; Value:reference::compilationTitle ]</li>
<li>Set Variable [ $r16; Value:reference::compilationEditors ]</li>
<li>Set Variable [ $r17; Value:reference::compilationNumberOfEditors ]</li>
<li>Set Variable [ $r18; Value:reference::conferenceIntroWords ]</li>
<li>Set Variable [ $r19; Value:reference::conferenceTitle ]</li>
<li>Set Variable [ $r20; Value:reference::conferenceSubTitle ]</li>
<li>Set Variable [ $r21; Value:reference::conferenceGroupName ]</li>
<li>Set Variable [ $r22; Value:reference::conferenceLocation ]</li>
<li>Set Variable [ $r23; Value:reference::conferenceDate ]</li>
<li>Set Variable [ $r24; Value:reference::volumeNumber ]</li>
<li>Set Variable [ $r25; Value:reference::issueNumber ]</li>
<li>Set Variable [ $r26; Value:reference::pageNumberRange ]</li>
<li>Set Variable [ $r27; Value:reference::TimeRange ]</li>
<li>Set Variable [ $r28; Value:reference::publisherTypeAlternative ]</li>
<li>Set Variable [ $r29; Value:reference::publisherLocation ]</li>
<li>Set Variable [ $r30; Value:reference::pubYear ]</li>
<li>Set Variable [ $r31; Value:reference::PubDate ]</li>
<li>Set Variable [ $r32; Value:reference::pubDateOther ]</li>
<li>Set Variable [ $r33; Value:reference::CopyrightYear ]</li>
<li>Set Variable [ $r34; Value:reference::copyrightOtherHolder ]</li>
<li>Set Variable [ $r35; Value:reference::URL ]</li>
<li>Set Variable [ $r36; Value:reference::URLdate ]</li>
<li>Set Variable [ $r37; Value:reference::library only ]</li>
<li>Set Variable [ $r38; Value:reference::ISBN ]</li>
<li>Set Variable [ $r39; Value:reference::URLdoi ]</li>
<li>Set Variable [ $r40; Value:reference::ISSN ]</li>
<li>Set Variable [ $r41; Value:reference::fileName ]</li>
<li>Set Variable [ $r42; Value:reference::kfileLocation ]</li>
<li>Set Variable [ $r43; Value:reference::thoughtsNotesEtc ]</li>
<li>Set Variable [ $r44; Value:reference::referenceDump ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#If the system is not in find mode and the find button</li>
<li>#is clicked then capture the current layout name </li>
<li>#(to return user to it after find), enter find mode,  </li>
<li>#go to the find layout, and await the user's find request. </li>
<li>Else</li>
<li>Set Variable [ $$findReferenceLayout; Value:Get (LayoutName) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Go to Layout [ &ldquo;ReferenceFIND&rdquo; (reference) ]</li>
<li>Show/Hide Status Area
[ Hide ]</li>
<li>Show/Hide Text Ruler
[ Hide ]</li>
<li>Set Field [ reference::kcsection; TEMP::ksection ]</li>
<li>Go to Field [ reference::referenceForReferenceWindow ]</li>
<li>Pause/Resume Script [ Indefinitely ]</li>
<li>Set Variable [ $r0; Value:reference::createDate ]</li>
<li>Set Variable [ $r1; Value:reference::modifyDate ]</li>
<li>Set Variable [ $r2; Value:reference::show ]</li>
<li>Set Variable [ $r3; Value:reference::incomplete ]</li>
<li>Set Variable [ $r4; Value:reference::referenceForReferenceWindow ]</li>
<li>Set Variable [ $r5; Value:reference::kmediaType ]</li>
<li>Set Variable [ $r6; Value:reference::kmedia ]</li>
<li>Set Variable [ $r7; Value:reference::TypeOfMediumOther ]</li>
<li>Set Variable [ $r8; Value:reference::referenceNodes ]</li>
<li>Set Variable [ $r9; Value:reference::Title ]</li>
<li>Set Variable [ $r10; Value:reference::bookChapter ]</li>
<li>Set Variable [ $r11; Value:reference::governmentAuthor ]</li>
<li>Set Variable [ $r12; Value:reference::GovernmentDocInfo ]</li>
<li>Set Variable [ $r13; Value:reference::letterDate ]</li>
<li>Set Variable [ $r14; Value:reference::emailRecipient ]</li>
<li>Set Variable [ $r15; Value:reference::compilationTitle ]</li>
<li>Set Variable [ $r16; Value:reference::compilationEditors ]</li>
<li>Set Variable [ $r17; Value:reference::compilationNumberOfEditors ]</li>
<li>Set Variable [ $r18; Value:reference::conferenceIntroWords ]</li>
<li>Set Variable [ $r19; Value:reference::conferenceTitle ]</li>
<li>Set Variable [ $r20; Value:reference::conferenceSubTitle ]</li>
<li>Set Variable [ $r21; Value:reference::conferenceGroupName ]</li>
<li>Set Variable [ $r22; Value:reference::conferenceLocation ]</li>
<li>Set Variable [ $r23; Value:reference::conferenceDate ]</li>
<li>Set Variable [ $r24; Value:reference::volumeNumber ]</li>
<li>Set Variable [ $r25; Value:reference::issueNumber ]</li>
<li>Set Variable [ $r26; Value:reference::pageNumberRange ]</li>
<li>Set Variable [ $r27; Value:reference::TimeRange ]</li>
<li>Set Variable [ $r28; Value:reference::publisherTypeAlternative ]</li>
<li>Set Variable [ $r29; Value:reference::publisherLocation ]</li>
<li>Set Variable [ $r30; Value:reference::pubYear ]</li>
<li>Set Variable [ $r31; Value:reference::PubDate ]</li>
<li>Set Variable [ $r32; Value:reference::pubDateOther ]</li>
<li>Set Variable [ $r33; Value:reference::CopyrightYear ]</li>
<li>Set Variable [ $r34; Value:reference::copyrightOtherHolder ]</li>
<li>Set Variable [ $r35; Value:reference::URL ]</li>
<li>Set Variable [ $r36; Value:reference::URLdate ]</li>
<li>Set Variable [ $r37; Value:reference::library only ]</li>
<li>Set Variable [ $r38; Value:reference::ISBN ]</li>
<li>Set Variable [ $r39; Value:reference::URLdoi ]</li>
<li>Set Variable [ $r40; Value:reference::ISSN ]</li>
<li>Set Variable [ $r41; Value:reference::fileName ]</li>
<li>Set Variable [ $r42; Value:reference::kfileLocation ]</li>
<li>Set Variable [ $r43; Value:reference::thoughtsNotesEtc ]</li>
<li>Set Variable [ $r44; Value:reference::referenceDump ]</li>
<li>Perform Find [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If the find fails tell the user it failed and give them</li>
<li>#option to modify their request or cancel the find.</li>
<li>Loop</li>
<li>If [ Get (LastError) = 401 ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::kcsection; TEMP::ksection ]</li>
<li>Set Field [ reference::createDate; $r0 ]</li>
<li>Set Field [ reference::modifyDate; $r1 ]</li>
<li>Set Field [ reference::show; $r2 ]</li>
<li>Set Field [ reference::incomplete; $r3 ]</li>
<li>Set Field [ reference::referenceForReferenceWindow; $r4 ]</li>
<li>Set Field [ reference::kmediaType; $r5 ]</li>
<li>Set Field [ reference::kmedia; $r6 ]</li>
<li>Set Field [ reference::TypeOfMediumOther; $r7 ]</li>
<li>Set Field [ reference::referenceNodes; $r8 ]</li>
<li>Set Field [ reference::Title; $r9 ]</li>
<li>Set Field [ reference::bookChapter; $r10 ]</li>
<li>Set Field [ reference::governmentAuthor; $r11 ]</li>
<li>Set Field [ reference::GovernmentDocInfo; $r12 ]</li>
<li>Set Field [ reference::letterDate; $r13 ]</li>
<li>Set Field [ reference::emailRecipient; $r14 ]</li>
<li>Set Field [ reference::compilationTitle; $r15 ]</li>
<li>Set Field [ reference::compilationEditors; $r16 ]</li>
<li>Set Field [ reference::compilationNumberOfEditors; $r17 ]</li>
<li>Set Field [ reference::conferenceIntroWords; $r18 ]</li>
<li>Set Field [ reference::conferenceTitle; $r19 ]</li>
<li>Set Field [ reference::conferenceSubTitle; $r20 ]</li>
<li>Set Field [ reference::conferenceGroupName; $r21 ]</li>
<li>Set Field [ reference::conferenceLocation; $r22 ]</li>
<li>Set Field [ reference::conferenceDate; $r23 ]</li>
<li>Set Field [ reference::volumeNumber; $r24 ]</li>
<li>Set Field [ reference::issueNumber; $r25 ]</li>
<li>Set Field [ reference::pageNumberRange; $r26 ]</li>
<li>Set Field [ reference::TimeRange; $r27 ]</li>
<li>Set Field [ reference::publisherTypeAlternative; $r28 ]</li>
<li>Set Field [ reference::publisherLocation; $r29 ]</li>
<li>Set Field [ reference::pubYear; $r30 ]</li>
<li>Set Field [ reference::PubDate; $r31 ]</li>
<li>Set Field [ reference::pubDateOther; $r32 ]</li>
<li>Set Field [ reference::CopyrightYear; $r33 ]</li>
<li>Set Field [ reference::copyrightOtherHolder; $r34 ]</li>
<li>Set Field [ reference::URL; $r35 ]</li>
<li>Set Field [ reference::URLdate; $r36 ]</li>
<li>Set Field [ reference::library only; $r37 ]</li>
<li>Set Field [ reference::ISBN; $r38 ]</li>
<li>Set Field [ reference::URLdoi; $r39 ]</li>
<li>Set Field [ reference::ISSN; $r40 ]</li>
<li>Set Field [ reference::fileName; $r41 ]</li>
<li>Set Field [ reference::kfileLocation; $r42 ]</li>
<li>Set Field [ reference::thoughtsNotesEtc; $r43 ]</li>
<li>Set Field [ reference::referenceDump; $r44 ]</li>
<li>#</li>
<li>Go to Field [ reference::referenceForReferenceWindow ]</li>
<li>Show Custom Dialog [ Message: "No records match this request."; Buttons: &ldquo;cancel&rdquo;, &ldquo;modify find&rdquo; ]</li>
<li>#</li>
<li>#If the user decides to modify their request then stay</li>
<li>#in find mode and await the users new request.</li>
<li>If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Pause/Resume Script [ Indefinitely ]</li>
<li>Set Variable [ $r0; Value:reference::createDate ]</li>
<li>Set Variable [ $r1; Value:reference::modifyDate ]</li>
<li>Set Variable [ $r2; Value:reference::show ]</li>
<li>Set Variable [ $r3; Value:reference::incomplete ]</li>
<li>Set Variable [ $r4; Value:reference::referenceForReferenceWindow ]</li>
<li>Set Variable [ $r5; Value:reference::kmediaType ]</li>
<li>Set Variable [ $r6; Value:reference::kmedia ]</li>
<li>Set Variable [ $r7; Value:reference::TypeOfMediumOther ]</li>
<li>Set Variable [ $r8; Value:reference::referenceNodes ]</li>
<li>Set Variable [ $r9; Value:reference::Title ]</li>
<li>Set Variable [ $r10; Value:reference::bookChapter ]</li>
<li>Set Variable [ $r11; Value:reference::governmentAuthor ]</li>
<li>Set Variable [ $r12; Value:reference::GovernmentDocInfo ]</li>
<li>Set Variable [ $r13; Value:reference::letterDate ]</li>
<li>Set Variable [ $r14; Value:reference::emailRecipient ]</li>
<li>Set Variable [ $r15; Value:reference::compilationTitle ]</li>
<li>Set Variable [ $r16; Value:reference::compilationEditors ]</li>
<li>Set Variable [ $r17; Value:reference::compilationNumberOfEditors ]</li>
<li>Set Variable [ $r18; Value:reference::conferenceIntroWords ]</li>
<li>Set Variable [ $r19; Value:reference::conferenceTitle ]</li>
<li>Set Variable [ $r20; Value:reference::conferenceSubTitle ]</li>
<li>Set Variable [ $r21; Value:reference::conferenceGroupName ]</li>
<li>Set Variable [ $r22; Value:reference::conferenceLocation ]</li>
<li>Set Variable [ $r23; Value:reference::conferenceDate ]</li>
<li>Set Variable [ $r24; Value:reference::volumeNumber ]</li>
<li>Set Variable [ $r25; Value:reference::issueNumber ]</li>
<li>Set Variable [ $r26; Value:reference::pageNumberRange ]</li>
<li>Set Variable [ $r27; Value:reference::TimeRange ]</li>
<li>Set Variable [ $r28; Value:reference::publisherTypeAlternative ]</li>
<li>Set Variable [ $r29; Value:reference::publisherLocation ]</li>
<li>Set Variable [ $r30; Value:reference::pubYear ]</li>
<li>Set Variable [ $r31; Value:reference::PubDate ]</li>
<li>Set Variable [ $r32; Value:reference::pubDateOther ]</li>
<li>Set Variable [ $r33; Value:reference::CopyrightYear ]</li>
<li>Set Variable [ $r34; Value:reference::copyrightOtherHolder ]</li>
<li>Set Variable [ $r35; Value:reference::URL ]</li>
<li>Set Variable [ $r36; Value:reference::URLdate ]</li>
<li>Set Variable [ $r37; Value:reference::library only ]</li>
<li>Set Variable [ $r38; Value:reference::ISBN ]</li>
<li>Set Variable [ $r39; Value:reference::URLdoi ]</li>
<li>Set Variable [ $r40; Value:reference::ISSN ]</li>
<li>Set Variable [ $r41; Value:reference::fileName ]</li>
<li>Set Variable [ $r42; Value:reference::kfileLocation ]</li>
<li>Set Variable [ $r43; Value:reference::thoughtsNotesEtc ]</li>
<li>Set Variable [ $r44; Value:reference::referenceDump ]</li>
<li>#</li>
<li>#If the user decides to cancel their the find, then return</li>
<li>#to the main record window and show all records.</li>
<li>Else If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Go to Layout [ $$findReferenceLayout ]</li>
<li>Show/Hide Status Area
[ Hide ]</li>
<li>Show/Hide Text Ruler
[ Hide ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::kcsection; TEMP::ksection ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Variable [ $$findReferenceLayout ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Perform Find [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If the find is successful then show the user the found</li>
<li>#records on the main records layout.</li>
<li>Exit Loop If [ Get (LastError) = 0 ]</li>
<li>End Loop</li>
<li>Go to Layout [ $$findReferenceLayout ]</li>
<li>Go to Layout [ $$findLearnLayout ]</li>
<li>Set Variable [ $$findReferenceLayout ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::modifyDate</li>
<li>
<em>reference</em>::referenceForReferenceSort</li>
<li>
<em>tagKeywordPrimary</em>::tag</li>
<li>
<em>reference</em>::createDate</li>
<li>
<em>reference</em>::show</li>
<li>
<em>reference</em>::incomplete</li>
<li>
<em>reference</em>::referenceForReferenceWindow</li>
<li>
<em>reference</em>::kmediaType</li>
<li>
<em>reference</em>::kmedia</li>
<li>
<em>reference</em>::TypeOfMediumOther</li>
<li>
<em>reference</em>::referenceNodes</li>
<li>
<em>reference</em>::Title</li>
<li>
<em>reference</em>::bookChapter</li>
<li>
<em>reference</em>::governmentAuthor</li>
<li>
<em>reference</em>::GovernmentDocInfo</li>
<li>
<em>reference</em>::letterDate</li>
<li>
<em>reference</em>::emailRecipient</li>
<li>
<em>reference</em>::compilationTitle</li>
<li>
<em>reference</em>::compilationEditors</li>
<li>
<em>reference</em>::compilationNumberOfEditors</li>
<li>
<em>reference</em>::conferenceIntroWords</li>
<li>
<em>reference</em>::conferenceTitle</li>
<li>
<em>reference</em>::conferenceSubTitle</li>
<li>
<em>reference</em>::conferenceGroupName</li>
<li>
<em>reference</em>::conferenceLocation</li>
<li>
<em>reference</em>::conferenceDate</li>
<li>
<em>reference</em>::volumeNumber</li>
<li>
<em>reference</em>::issueNumber</li>
<li>
<em>reference</em>::pageNumberRange</li>
<li>
<em>reference</em>::TimeRange</li>
<li>
<em>reference</em>::publisherTypeAlternative</li>
<li>
<em>reference</em>::publisherLocation</li>
<li>
<em>reference</em>::pubYear</li>
<li>
<em>reference</em>::PubDate</li>
<li>
<em>reference</em>::pubDateOther</li>
<li>
<em>reference</em>::CopyrightYear</li>
<li>
<em>reference</em>::copyrightOtherHolder</li>
<li>
<em>reference</em>::URL</li>
<li>
<em>reference</em>::URLdate</li>
<li>
<em>reference</em>::library only</li>
<li>
<em>reference</em>::ISBN</li>
<li>
<em>reference</em>::URLdoi</li>
<li>
<em>reference</em>::ISSN</li>
<li>
<em>reference</em>::fileName</li>
<li>
<em>reference</em>::kfileLocation</li>
<li>
<em>reference</em>::thoughtsNotesEtc</li>
<li>
<em>reference</em>::referenceDump</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>reference</em>::kcsection</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>ReferenceFIND</li>
<li>&lt;Missing Layout&gt;</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33255ScriptAnchor_"></a><td class="script_navbar"><a href="#33251ScriptAnchor_"><span>Previous Script: [findReferenceRecord]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#33257ScriptAnchor_"><span>Next Script: [extractCreateDateFromReferenceRecords]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">sortReferences</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ $$referenceSort = 2 ]</li>
<li>Sort Records [ Specified Sort Order: tagKeywordPrimary::tag; ascending
reference::referenceForReferenceSort; ascending ]
[ Restore; No dialog ]</li>
<li>Set Variable [ $$referenceSort ]</li>
<li>Else If [ $$referenceSort = "" ]</li>
<li>Sort Records [ Specified Sort Order: reference::createDate; descending
reference::referenceForReferenceSort; ascending ]
[ Restore; No dialog ]</li>
<li>Set Variable [ $$referenceSort; Value:1 ]</li>
<li>Else If [ $$referenceSort = 1 ]</li>
<li>Sort Records [ Specified Sort Order: reference::modifyDate; descending
reference::referenceForReferenceSort; ascending ]
[ Restore; No dialog ]</li>
<li>Set Variable [ $$referenceSort; Value:2 ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagKeywordPrimary</em>::tag</li>
<li>
<em>reference</em>::referenceForReferenceSort</li>
<li>
<em>reference</em>::createDate</li>
<li>
<em>reference</em>::modifyDate</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33257ScriptAnchor_"></a><td class="script_navbar"><a href="#33255ScriptAnchor_"><span>Previous Script: [sortReferences]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#33277ScriptAnchor_"><span>Next Script: [REFERENCE LOOP]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">extractCreateDateFromReferenceRecords</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Loop</li>
<li>Set Variable [ $number; Value:reference::_Lreference ]</li>
<li>If [ Middle ( $number ; 5 ; 2 ) &ne; 20 ]</li>
<li>Set Variable [ $number; Value:0 &amp; reference::_Lreference ]</li>
<li>End If</li>
<li>Set Field [ reference::createDate; Left ( $number ; 2 ) &amp; "/" &amp; Middle ( $number ; 3 ; 2 ) &amp; "/" &amp; Middle ( $number ; 5 ; 4 )  &amp; " " &amp; Middle ( $number ; 9 ; 2 ) &amp; ":" &amp; Middle ( $number ; 11 ; 2 ) &amp; ":"  &amp; Middle ( $number ; 13 ; 2 ) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::_Lreference</li>
<li>
<em>reference</em>::createDate</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33277ScriptAnchor_"></a><td class="script_navbar"><a href="#33257ScriptAnchor_"><span>Previous Script: [extractCreateDateFromReferenceRecords]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#33230ScriptAnchor_"><span>Next Script: [finishReferenceEdit]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">REFERENCE LOOP</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Use this script to change some information in all</li>
<li>#records currently found.  Useful for when you make</li>
<li>#an error covering many records to correct the error.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>//  Set Field [ reference::kkeywordOther; 6152012170316227 &amp; &para; &amp; 
426201211190634 &amp; &para; &amp; 
6202012153813240 &amp; &para; &amp; 
6202012165313251 &amp; &para; &amp; 
10212011022440584 &amp; &para; &amp; 
6092012194220193 &amp; &para; &amp; 
8312012200828513 &amp; &para; &amp; 
8112011135327306 &amp; &para; &amp; 
5262013013530620 &amp; &para; &amp; 
120420111059441036 &amp; &para; &amp; 
9132011003103394 &amp; &para; ]</li>
<li>//  Set Field [ reference::kkeywordPrimary; 10142013154511774 ]</li>
<li>//  Set Field [ reference::OtherKeyWords; "brain and military, brain and the law, causes and conditions, cognitive control, epidemics, evolution, illusion (rational), mental illness, neuropsychiatry, suicide, volition" ]</li>
<li>//  Set Field [ reference::kfileLocation; 8162011225605315 ]</li>
<li>//  Set Field [ reference::kfolderpath; 5312012152200119 ]</li>
<li>//  Set Field [ reference::kmediaType; 420201300192711 ]</li>
<li>//  Set Field [ reference::kmedia; 424201321462777 ]</li>
<li>//  Set Field [ reference::kcopyrightHolder; 6022012160448133 ]</li>
<li>//  Set Field [ reference::referenceNodes; "Cold Spring Harbor Laboratory" ]</li>
<li>//  Set Field [ reference::korgan; "" ]</li>
<li>//  Set Field [ reference::kcopyist; 5102013023502585 ]</li>
<li>//  Set Field [ reference::GovernmentDocInfo; "Series speakers are from the UCSF Center for Obesity Assessment, Study and Treatment" ]</li>
<li>//  Set Field [ reference::korgan; 6032012182212144 ]</li>
<li>//  Set Field [ reference::CopyrightYear; "" ]</li>
<li>//  Set Field [ reference::pubYear; "" ]</li>
<li>//  Set Field [ reference::incomplete; "" ]</li>
<li>//  Set Field [ testlearn::kcitation; "" ]</li>
<li>Set Field [ reference::kHealth; "8102011220941282" ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Set Variable [ $$stoploadCitation ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::kkeywordOther</li>
<li>
<em>reference</em>::kkeywordPrimary</li>
<li>
<em>reference</em>::OtherKeyWords</li>
<li>
<em>reference</em>::kfileLocation</li>
<li>
<em>reference</em>::kfolderpath</li>
<li>
<em>reference</em>::kmediaType</li>
<li>
<em>reference</em>::kmedia</li>
<li>
<em>reference</em>::kcopyrightHolder</li>
<li>
<em>reference</em>::referenceNodes</li>
<li>
<em>reference</em>::korgan</li>
<li>
<em>reference</em>::kcopyist</li>
<li>
<em>reference</em>::GovernmentDocInfo</li>
<li>
<em>reference</em>::CopyrightYear</li>
<li>
<em>reference</em>::pubYear</li>
<li>
<em>reference</em>::incomplete</li>
<li>
<em>testlearn</em>::kcitation</li>
<li>
<em>reference</em>::kHealth</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33230ScriptAnchor_"></a><td class="script_navbar"><a href="#33277ScriptAnchor_"><span>Previous Script: [REFERENCE LOOP]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#32981ScriptAnchor_"><span>Next Script: [editCitation]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">finishReferenceEdit</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If user is in tag field and has changed spelling</li>
<li>#exit this tag record, otherwise current reference record</li>
<li>#will get deleted by the spelling check script.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Go to Field [  ]</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>#</li>
<li>#If the media and media type have not been selected then tell user these fields are required before exiting the reference record.</li>
<li>If [ reference::kmedia = ""  and TEMP::InventoryLibaryYN = ""

or 

reference::kmediaType = "" and TEMP::InventoryLibaryYN = "" ]</li>
<li>Show Custom Dialog [ Message: "REQUIRED: media (book, journal article, etc.) and media type (web, CD, paper, etc.) identification."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Continue with going back to reference layout.</li>
<li>If [ $$referenceSort = 2 ]</li>
<li>Sort Records [ Specified Sort Order: reference::modifyDate; descending
reference::referenceForReferenceSort; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ $$referenceSort = "" ]</li>
<li>Sort Records [ Specified Sort Order: tagKeywordPrimary::tag; ascending
reference::referenceForReferenceSort; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ $$referenceSort = 1 ]</li>
<li>Sort Records [ Specified Sort Order: reference::createDate; descending
reference::referenceForReferenceSort; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#Go to reference record layout.</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;ReferenceStuff&rdquo; (reference) ]</li>
<li>Else</li>
<li>Go to Layout [ &ldquo;Reference&rdquo; (reference) ]</li>
<li>End If</li>
<li>#</li>
<li>#Allow add mode.</li>
<li>Set Variable [ $$stopAdd ]</li>
<li>#</li>
<li>#Close reference help window if open.</li>
<li>Close Window [ Name: "Reference Field Help"; Current file ]</li>
<li>Set Variable [ $$turnOffThisScript ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::kmedia</li>
<li>
<em>TEMP</em>::InventoryLibaryYN</li>
<li>
<em>reference</em>::kmediaType</li>
<li>
<em>reference</em>::modifyDate</li>
<li>
<em>reference</em>::referenceForReferenceSort</li>
<li>
<em>tagKeywordPrimary</em>::tag</li>
<li>
<em>reference</em>::createDate</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>ReferenceStuff</li>
<li>Reference</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32981ScriptAnchor_"></a><td class="script_navbar"><a href="#33230ScriptAnchor_"><span>Previous Script: [finishReferenceEdit]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#33018ScriptAnchor_"><span>Next Script: [showLongCitation]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">editCitation</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>#</li>
<li>If [ TEMP::ksection = "" ]</li>
<li>Show Custom Dialog [ Message: "Select a section from the Tag Menus window for records that you create to be placed into."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Halt Script</li>
<li>Else If [ tempSetup::kdefaultHealth = "" ]</li>
<li>Show Custom Dialog [ Message: "Select the default copyright for any new records that you create by clicking the copyright button (you can always change your mind)."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Halt Script</li>
<li>Else If [ tempSetup::kdefaultNodePrimary = "" ]</li>
<li>Show Custom Dialog [ Message: "Select yourself (the node responsible for creating new records) by clicking the node button."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#Make sure creator node's group is part of section group.</li>
<li>Perform Script [ &ldquo;addBackSectionCreatorNode&rdquo; ]</li>
<li>#</li>
<li>#Determine if user wants to edit an external citation.</li>
<li>If [ Get (LayoutTableName) = "reference" ]</li>
<li>#</li>
<li>#Capture record ID so system can return user </li>
<li>#after editing is complete.</li>
<li>Set Variable [ $$tagEdit; Value:reference::_Lreference ]</li>
<li>Set Variable [ $$learnTagLayout; Value:Get (LayoutName) ]</li>
<li>Set Variable [ $$citeORref; Value:$$citationMatch ]</li>
<li>#</li>
<li>#Go to reference tag menu so load citation script </li>
<li>#below will work properly.</li>
<li>Set Variable [ $$stoploadTagRecord; Value:1 ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenu2keywordOrNode1&rdquo; (tagMenus) ]</li>
<li>Set Variable [ $$stoploadTagRecord ]</li>
<li>#</li>
<li>#Capture record ID so system can return user </li>
<li>#after editing is complete.</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Set Variable [ $$LearnEdit; Value:testlearn::_Ltestlearn ]</li>
<li>#</li>
<li>#Take user to citation edit layout.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;ReferenceStuff&rdquo; (reference) ]</li>
<li>Else</li>
<li>Go to Layout [ &ldquo;Reference&rdquo; (reference) ]</li>
<li>End If</li>
<li>Set Window Title [ Current Window; New Title: "References" ]</li>
<li>#</li>
<li>#Find main records.</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::kcsection; TEMP::ksection ]</li>
<li>//  Set Field [ reference::filterFind; "main" ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: tagKeywordPrimary::tag; ascending
reference::referenceForReferenceWindow; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#Loop to record to be edited.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$tagEdit  = reference::_Lreference ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Perform Script [ &ldquo;menuKey&rdquo; ]</li>
<li>Perform Script [ &ldquo;loadCitation&rdquo; ]</li>
<li>Sort Records [ Specified Sort Order: tagKeywordPrimary::tag; ascending
reference::referenceForReferenceSort; ascending ]
[ Restore; No dialog ]</li>
<li>Set Variable [ $refRecordNumber; Value:Get ( RecordNumber ) ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page
[ Last ]</li>
<li>Go to Record/Request/Page [ $refRecordNumber ]
[ No dialog ]</li>
<li>#</li>
<li>Else If [ Left ( Get (LayoutName) ; 1 ) = "d" ]</li>
<li>#</li>
<li>#</li>
<li>#Capture record ID so system can return user </li>
<li>#after editing is complete.</li>
<li>Set Variable [ $$defaultRecordNumber; Value:Get (RecordNumber) ]</li>
<li>Set Variable [ $$defaultTagLayout; Value:Get (LayoutName) ]</li>
<li>#</li>
<li>#Go to reference tag menu so load citation script </li>
<li>#below will work properly.</li>
<li>Set Variable [ $$stoploadTagRecord; Value:1 ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenu2keywordOrNode1&rdquo; (tagMenus) ]</li>
<li>Set Variable [ $$stoploadTagRecord ]</li>
<li>#</li>
<li>#Capture record ID so system can return user </li>
<li>#after editing is complete.</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>#</li>
<li>#Take user to citation edit layout.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>If [ TEMP::InventoryLibaryYN &ne; "" ]</li>
<li>Go to Layout [ &ldquo;ReferenceStuff&rdquo; (reference) ]</li>
<li>Else</li>
<li>Go to Layout [ &ldquo;Reference&rdquo; (reference) ]</li>
<li>End If</li>
<li>Set Window Title [ Current Window; New Title: "References" ]</li>
<li>#</li>
<li>#Find main records.</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ reference::kcsection; TEMP::ksection ]</li>
<li>//  Set Field [ reference::filterFind; "main" ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: tagKeywordPrimary::tag; ascending
reference::referenceForReferenceSort; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#Loop to record to be edited.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Go to Field [ reference::knodePrimary ]</li>
<li>Perform Script [ &ldquo;menuKey&rdquo; ]</li>
<li>Perform Script [ &ldquo;loadCitation&rdquo; ]</li>
<li>Sort Records [ Specified Sort Order: tagKeywordPrimary::tag; ascending
reference::referenceForReferenceSort; ascending ]
[ Restore; No dialog ]</li>
<li>Scroll Window
[ Home ]</li>
<li>#</li>
<li>#</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>tempSetup</em>::kdefaultHealth</li>
<li>
<em>tempSetup</em>::kdefaultNodePrimary</li>
<li>
<em>reference</em>::_Lreference</li>
<li>
<em>testlearn</em>::_Ltestlearn</li>
<li>
<em>TEMP</em>::InventoryLibaryYN</li>
<li>
<em>reference</em>::kcsection</li>
<li>
<em>reference</em>::filterFind</li>
<li>
<em>tagKeywordPrimary</em>::tag</li>
<li>
<em>reference</em>::referenceForReferenceWindow</li>
<li>
<em>reference</em>::referenceForReferenceSort</li>
<li>
<em>reference</em>::knodePrimary</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33245ScriptAnchor_">addBackSectionCreatorNode</a></li>
<li><a href="#32993ScriptAnchor_">menuKey</a></li>
<li><a href="#32984ScriptAnchor_">loadCitation</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>ReferenceMenu2keywordOrNode1</li>
<li>ReferenceStuff</li>
<li>Reference</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33018ScriptAnchor_"></a><td class="script_navbar"><a href="#32981ScriptAnchor_"><span>Previous Script: [editCitation]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#33082ScriptAnchor_"><span>Next Script: [showCitation]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">showLongCitation</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>New Window [ Name: "Citation Note" ]</li>
<li>Go to Layout [ &ldquo;longReferenceView&rdquo; (reference) ]</li>
<li>Pause/Resume Script [ Indefinitely ]</li>
<li>Close Window [ Current Window ]</li>
<li>Exit Script [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>longReferenceView</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33082ScriptAnchor_"></a><td class="script_navbar"><a href="#33018ScriptAnchor_"><span>Previous Script: [showLongCitation]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#32984ScriptAnchor_"><span>Next Script: [loadCitation]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">showCitation</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Capture the key to unlock the record it belongs to.</li>
<li>Set Variable [ $key; Value:reference::_Lreference ]</li>
<li>#</li>
<li>#Select the correct window and then change its</li>
<li>#name if neccessary to match the table the </li>
<li>#records are coming from.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>End If</li>
<li>Set Variable [ $$cited; Value:reference::_Lreference ]</li>
<li>Set Variable [ $$citeLayout; Value:Get (LayoutName) ]</li>
<li>Set Window Title [ Current Window; New Title: "References" ]</li>
<li>Go to Layout [ &ldquo;Reference&rdquo; (reference) ]</li>
<li>#</li>
<li>#Prevent record loading script during loops to</li>
<li>#find wanted record, which would slow down system.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>#</li>
<li>#Now loop thru all the records until the record</li>
<li>#that fits the key is found.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ reference::_Lreference = $key ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Allow the record load script to run and run it.</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Perform Script [ &ldquo;loadCitation&rdquo; ]</li>
<li>#</li>
<li>#Put focus back on Tag Menus window and conditionally</li>
<li>#format any items that may be linked to record</li>
<li>#in the other window.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::_Lreference</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32984ScriptAnchor_">loadCitation</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>Reference</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32984ScriptAnchor_"></a><td class="script_navbar"><a href="#33082ScriptAnchor_"><span>Previous Script: [showCitation]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#33014ScriptAnchor_"><span>Next Script: [clearCitationMatch]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">loadCitation</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33083ScriptAnchor_">showCited</a></li>
<li><a href="#33100ScriptAnchor_">findPrimaryTL</a></li>
<li><a href="#33101ScriptAnchor_">findKeyOtherTL</a></li>
<li><a href="#33119ScriptAnchor_">findPrimaryRef</a></li>
<li><a href="#33120ScriptAnchor_">findKeyOtherRef</a></li>
<li><a href="#33122ScriptAnchor_">findReferernce</a></li>
<li><a href="#33020ScriptAnchor_">addLinksPicturesToTagsMode</a></li>
<li><a href="#33053ScriptAnchor_">showReferencePicture1</a></li>
<li><a href="#33054ScriptAnchor_">showReferencePicture2</a></li>
<li><a href="#33055ScriptAnchor_">showReferencePicture3</a></li>
<li><a href="#33125ScriptAnchor_">deleteLearnMainRecord</a></li>
<li><a href="#33152ScriptAnchor_">editLearn</a></li>
<li><a href="#33188ScriptAnchor_">duplicateLearnRecord</a></li>
<li><a href="#33094ScriptAnchor_">newLearn</a></li>
<li><a href="#32976ScriptAnchor_">newReference</a></li>
<li><a href="#33216ScriptAnchor_">deleteReference</a></li>
<li><a href="#33049ScriptAnchor_">showReference1</a></li>
<li><a href="#33051ScriptAnchor_">showReference2</a></li>
<li><a href="#33052ScriptAnchor_">showReference3</a></li>
<li><a href="#33189ScriptAnchor_">duplicateReferenceRecord</a></li>
<li><a href="#32981ScriptAnchor_">editCitation</a></li>
<li><a href="#33082ScriptAnchor_">showCitation</a></li>
<li><a href="#32985ScriptAnchor_">backToLearnOrDefaultSetup</a></li>
<li><a href="#33070ScriptAnchor_">learn</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#This first section is key to stopping this script</li>
<li>#when another script for example loops thru</li>
<li>#many records each of which would trigger this</li>
<li>#script and really slow down the program and</li>
<li>#create strobe effect that is really irritating to</li>
<li>#look at.</li>
<li>If [ $$stoploadCitation = 1 ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#These steps effect the button action where when the</li>
<li>#use clicks on the actual text box of a learn record</li>
<li>#a new window opens just displaying the text.  This </li>
<li>#stops this when the user was clicking on it to select</li>
<li>#this record instead of adding text to it.</li>
<li>If [ Get (LayoutName) = "learn1" or 
Get (LayoutName) = "learn2" or 
Get (LayoutName) = "learn3" or 
Get (LayoutName) = "learn4" ]</li>
<li>Set Variable [ $$stopOpenNewTextWindow; Value:1 ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#SEE WHAT WAS REMOVED IN OLD VERSION.</li>
<li>#THE CODE REMOVED WAS DISABLED IN OLD VERSION.</li>
<li>#</li>
<li>#This key effects the conditional formatting </li>
<li>#of any records in the Tag Menus window</li>
<li>#that are related to the citation record that triggered</li>
<li>#this script (by the user click on it, of course).</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Set Variable [ $$citation; Value:testlearn::_Ltestlearn ]</li>
<li>If [ $$citationMatch = "node" ]</li>
<li>Set Variable [ $$citationItem; Value:testlearn::kNodePrimary ]</li>
<li>Set Variable [ $$tagTest ]</li>
<li>Set Variable [ $$tagSample ]</li>
<li>Else If [ $$citationMatch = "medium" ]</li>
<li>Set Variable [ $$citationItem; Value:testlearn::kmedium ]</li>
<li>Else If [ $$citationMatch = "Path" ]</li>
<li>Set Variable [ $$citationItem; Value:testlearn::kfolderPath ]</li>
<li>Set Variable [ $$tagTest ]</li>
<li>Set Variable [ $$tagSample ]</li>
<li>Else If [ $$citationMatch = "key" ]</li>
<li>Set Variable [ $$citationItem; Value:testlearn::kKeywordPrimary ]</li>
<li>Else If [ $$citationMatch = "health" ]</li>
<li>Set Variable [ $$tagTest ]</li>
<li>Set Variable [ $$tagSample ]</li>
<li>Set Variable [ $$citationItem; Value:testlearn::kHealth ]</li>
<li>Else If [ $$citationMatch = "cite" ]</li>
<li>Set Variable [ $$citationItem; Value:testlearn::kcitation ]</li>
<li>Set Variable [ $$tagTest ]</li>
<li>Set Variable [ $$tagSample ]</li>
<li>Else If [ $$citationMatch = "ref" ]</li>
<li>Set Variable [ $$citationItem; Value:testlearn::kcreference ]</li>
<li>Set Variable [ $$tagTest ]</li>
<li>Set Variable [ $$tagSample ]</li>
<li>Else If [ $$citationMatch = "test" ]</li>
<li>Set Variable [ $$citationItem; Value:testlearn::kctest ]</li>
<li>Else If [ $$citationMatch = "sample" ]</li>
<li>Set Variable [ $$citationItem; Value:testlearn::kcsample ]</li>
<li>End If</li>
<li>#</li>
<li>#capture keys of related tag menu items to</li>
<li>#to allow the citationMenu scripts to loop to the</li>
<li>#primary record of interest when the user navigates</li>
<li>#to a item on the Tag Menu window</li>
<li>#whose list of tags like node, keyword, medium, etc.</li>
<li>#might contain an item related to the current</li>
<li>#citation record, but which one, which is why all</li>
<li>#the keys have to be readied.  Mmm... now that </li>
<li>#I write this out, I'm thinking I could have the </li>
<li>#citationMenu scripts select the citation window</li>
<li>#to grab the key if any in the current current</li>
<li>#record that applies the the menu item.</li>
<li>Set Variable [ $$citationRecord; Value:testlearn::_Ltestlearn ]</li>
<li>Set Variable [ $$node; Value:testlearn::kNodeOther ]</li>
<li>Set Variable [ $$primaryNode; Value:testlearn::kNodePrimary ]</li>
<li>Set Variable [ $$medium; Value:testlearn::kmedium ]</li>
<li>Set Variable [ $$health; Value:testlearn::kHealth ]</li>
<li>Set Variable [ $$Path; Value:testlearn::kfolderPath ]</li>
<li>Set Variable [ $$cite; Value:testlearn::kcitation ]</li>
<li>Set Variable [ $$ref; Value:testlearn::kcreference ]</li>
<li>Set Variable [ $$PrimaryKey; Value:testlearn::kKeywordPrimary ]</li>
<li>Set Variable [ $$Key; Value:testlearn::kcKeywordOther ]</li>
<li>Set Variable [ $$OtherKey; Value:testlearn::kcKeywordOther ]</li>
<li>Set Variable [ $$Section; Value:testlearn::kcsection ]</li>
<li>Set Variable [ $$test; Value:testlearn::kctest ]</li>
<li>Set Variable [ $$sample; Value:testlearn::kcsample ]</li>
<li>Set Variable [ $$RecordID; Value:Get (RecordID) ]</li>
<li>Set Variable [ $windowName; Value:Get (WindowName) ]</li>
<li>Commit Records/Requests</li>
<li>#</li>
<li>If [ $$add = "" ]</li>
<li>#Match any records in tag window and go to</li>
<li>#primary tag record or to first record if none.</li>
<li>#And don't run LoadTagRecord until matching is</li>
<li>#done to prevent flashing and slowing down script.</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Go to Field [  ]</li>
<li>If [ Get (LastError)  = 112 ]</li>
<li>Perform Script [ &ldquo;TgotoCitationMenu&rdquo; ]</li>
<li>End If</li>
<li>Refresh Window</li>
<li>//  If [ $$citationMatch = "sample" ]</li>
<li>//  #SEE WHAT WAS REMOVED IN OLD VERSION.</li>
<li>//  #THE CODE REMOVED WAS DISABLED IN OLD VERSION.</li>
<li>//  Else If [ $$citationMatch  = "test" ]</li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  Loop</li>
<li>//  Set Variable [ $number; Value:1 ]</li>
<li>//  Go to Field [  ]</li>
<li>//  Loop</li>
<li>//  Exit Loop If [ Middle ( GetValue ( $$test ; $number ) ; 4 ; 42 )  &amp; "&para;"   = test::_Ltest &amp; &para; ]</li>
<li>//  Exit Loop If [ Middle ( GetValue ( $$test ; $number ) ; 4 ; 42 )  = "" ]</li>
<li>//  Set Variable [ $add; Value:$number ]</li>
<li>//  Set Variable [ $number; Value:$add + 1 ]</li>
<li>//  End Loop</li>
<li>//  Exit Loop If [ Middle ( GetValue ( $$test ; $number ) ; 4 ; 42 )  &amp; "&para;"   = test::_Ltest &amp; &para; ]</li>
<li>//  Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>//  End Loop</li>
<li>//  If [ Middle ( GetValue ( $$test ; $number ) ; 4 ; 42 )  &amp; "&para;" &ne; test::_Ltest &amp; &para; ]</li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  End If</li>
<li>//  Else If [ $$citationMatch &ne; "sample" or $$citationMatch &ne; "test" ]</li>
<li>//  Freeze Window</li>
<li>//  Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  Scroll Window
[ Home ]</li>
<li>//  Loop</li>
<li>//  Exit Loop If [ tagMenus::_Ltag = $$citationItem or FilterValues ( $$sample ; tagMenus::_Ltag &amp; "&para;" ) = tagMenus::_Ltag &amp; &para; or 
FilterValues ( $$test ; test::_Ltest &amp; "&para;" ) = test::_Ltest &amp; &para;
 or 
reference::_Lreference  = $$citationitem  and $$citationMatch = "cite" or

reference::_Lreference &amp; "&para;"  = FilterValues ( $$ref ; reference::_Lreference &amp; "&para;" )  and $$citationMatch = "ref"
 or 
testlearn::_Ltestlearn  = $$citationitem  and $$citationMatch = "cite"or 

testlearn::_Ltestlearn &amp; "&para;"  = FilterValues ( $$ref ; testlearn::_Ltestlearn &amp; "&para;" )  and $$citationMatch = "ref"
 or 
tagMenus::_Ltag  = $$citationitem  and $$citationMatch = "node"  

or 

tagMenus::_Ltag  = $$citationitem  and $$citationMatch = "key" ]</li>
<li>//  Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>//  End Loop</li>
<li>//  If [ Get (LastError) = 101 ]</li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  Scroll Window
[ Home ]</li>
<li>//  End If</li>
<li>//  End If</li>
<li>//  #</li>
<li>//  Set Variable [ $$stopLoadTagRecord ]</li>
<li>//  If [ Right (Get (LayoutName) ; 1 ) = "r" ]</li>
<li>//  Perform Script [ &ldquo;loadTagRecord&rdquo; ]</li>
<li>//  Else If [ $$citationMatch = "sample" ]</li>
<li>//  #SEE WHAT WAS REMOVED IN OLD VERSION.</li>
<li>//  #THE CODE REMOVED WAS DISABLED IN OLD VERSION.</li>
<li>//  Else If [ $$citationMatch = "test" ]</li>
<li>//  If [ testlearn::kctest &ne; "" ]</li>
<li>//  Perform Script [ &ldquo;loadItemRecordForTestTagMenu&rdquo; ]</li>
<li>//  End If</li>
<li>//  End If</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Variable [ $$citation; Value:reference::_Lreference ]</li>
<li>If [ $$citationMatch = "node" ]</li>
<li>Set Variable [ $$citationItem; Value:reference::knodePrimary ]</li>
<li>Else If [ $$citationMatch = "medium" ]</li>
<li>Set Variable [ $$citationItem; Value:reference::kmedium ]</li>
<li>Else If [ $$citationMatch = "Path" ]</li>
<li>Set Variable [ $$citationItem; Value:reference::kfolderpath ]</li>
<li>Else If [ $$citationMatch = "key" ]</li>
<li>Set Variable [ $$citationItem; Value:reference::kkeywordPrimary ]</li>
<li>Else If [ $$citationMatch = "organ" ]</li>
<li>Set Variable [ $$citationItem; Value:reference::korgan ]</li>
<li>Else If [ $$citationMatch = "copyist" ]</li>
<li>Set Variable [ $$citationItem; Value:reference::kcopyist ]</li>
<li>Else If [ $$citationMatch = "health" ]</li>
<li>Set Variable [ $$citationItem; Value:reference::kHealth ]</li>
<li>Else If [ $$citationMatch = "cite" ]</li>
<li>Set Variable [ $$citationItem; Value:reference::kcitation ]</li>
<li>Else If [ $$citationMatch = "ref" ]</li>
<li>Set Variable [ $$citationItem; Value:testlearn::kcreference ]</li>
<li>End If</li>
<li>#</li>
<li>#capture keys of related tag menu items to</li>
<li>#to allow the citationMenu scripts to loop to the</li>
<li>#primary record of interest when the user navigates</li>
<li>#to a item on the Tag Menu window</li>
<li>#whose list of tags like node, keyword, medium, etc.</li>
<li>#might contain an item related to the current</li>
<li>#citation record, but which one, which is why all</li>
<li>#the keys have to be readied.  Mmm... now that </li>
<li>#I write this out, I'm thinking I could have the </li>
<li>#citationMenu scripts select the citation window</li>
<li>#to grab the key if any in the current current</li>
<li>#record that applies the the menu item.</li>
<li>Set Variable [ $$citationRecord; Value:reference::_Lreference ]</li>
<li>Set Variable [ $$node; Value:reference::knodeOther ]</li>
<li>Set Variable [ $$primaryNode; Value:reference::knodePrimary ]</li>
<li>Set Variable [ $$organ; Value:reference::korgan ]</li>
<li>Set Variable [ $$copyist; Value:reference::kcopyist ]</li>
<li>Set Variable [ $$medium; Value:reference::kmedium ]</li>
<li>Set Variable [ $$health; Value:reference::kHealth ]</li>
<li>Set Variable [ $$CopyrightType; Value:reference::kcopyrightType ]</li>
<li>Set Variable [ $$Path; Value:reference::kfolderpath ]</li>
<li>Set Variable [ $$cite; Value:reference::kcitation ]</li>
<li>Set Variable [ $$ref; Value:reference::lock ]</li>
<li>Set Variable [ $$PrimaryKey; Value:reference::kkeywordPrimary ]</li>
<li>Set Variable [ $$Key; Value:reference::kkeywordOther ]</li>
<li>Set Variable [ $$OtherKey; Value:reference::kkeywordOther ]</li>
<li>Set Variable [ $$RecordID; Value:Get (RecordID) ]</li>
<li>Set Variable [ $windowName; Value:Get (WindowName) ]</li>
<li>Commit Records/Requests</li>
<li>#</li>
<li>If [ $$add = "" ]</li>
<li>#Match any records in tag window and go to</li>
<li>#primary tag record or to first record if none.</li>
<li>#And don't run LoadTagRecord until matching is</li>
<li>#done to prevent flashing and slowing down script.</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>If [ Get (LastError)  = 112 ]</li>
<li>Perform Script [ &ldquo;TgotoCitationMenu&rdquo; ]</li>
<li>End If</li>
<li>Refresh Window</li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  #SEE WHAT WAS REMOVED IN OLD VERSION.</li>
<li>//  #THE CODE REMOVED WAS DISABLED IN OLD VERSION.</li>
<li>//  Loop</li>
<li>//  Exit Loop If [ tagMenus::_Ltag = $$citationItem or FilterValues ( $$sample ; tagMenus::_Ltag &amp; "&para;" ) = tagMenus::_Ltag &amp; &para; or 
FilterValues ( $$test ; test::_Ltest &amp; "&para;" ) = test::_Ltest &amp; &para;
 or 
tagMenus::_Ltag  = $$citationitem  and $$citationMatch = "node"  

or 

tagMenus::_Ltag  = $$citationitem  and $$citationMatch = "key" ]</li>
<li>//  Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>//  End Loop</li>
<li>//  If [ Get (LastError) = 101 ]</li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  End If</li>
<li>//  Set Variable [ $$stopLoadTagRecord ]</li>
<li>//  Perform Script [ &ldquo;loadTagRecord&rdquo; ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Return to observation or reference window.</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Select Window [ Name: $windowName; Current file ]</li>
<li>Refresh Window</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearn</em>::_Ltestlearn</li>
<li>
<em>testlearn</em>::kNodePrimary</li>
<li>
<em>testlearn</em>::kmedium</li>
<li>
<em>testlearn</em>::kfolderPath</li>
<li>
<em>testlearn</em>::kKeywordPrimary</li>
<li>
<em>testlearn</em>::kHealth</li>
<li>
<em>testlearn</em>::kcitation</li>
<li>
<em>testlearn</em>::kcreference</li>
<li>
<em>testlearn</em>::kctest</li>
<li>
<em>testlearn</em>::kcsample</li>
<li>
<em>testlearn</em>::kNodeOther</li>
<li>
<em>testlearn</em>::kcKeywordOther</li>
<li>
<em>testlearn</em>::kcsection</li>
<li>
<em>test</em>::_Ltest</li>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>reference</em>::_Lreference</li>
<li>
<em>reference</em>::knodePrimary</li>
<li>
<em>reference</em>::kmedium</li>
<li>
<em>reference</em>::kfolderpath</li>
<li>
<em>reference</em>::kkeywordPrimary</li>
<li>
<em>reference</em>::korgan</li>
<li>
<em>reference</em>::kcopyist</li>
<li>
<em>reference</em>::kHealth</li>
<li>
<em>reference</em>::kcitation</li>
<li>
<em>reference</em>::knodeOther</li>
<li>
<em>reference</em>::kcopyrightType</li>
<li>
<em>reference</em>::lock</li>
<li>
<em>reference</em>::kkeywordOther</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32983ScriptAnchor_">TgotoCitationMenu</a></li>
<li><a href="#33038ScriptAnchor_">loadTagRecord</a></li>
<li><a href="#33127ScriptAnchor_">loadItemRecordForTestTagMenu</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33014ScriptAnchor_"></a><td class="script_navbar"><a href="#32984ScriptAnchor_"><span>Previous Script: [loadCitation]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#33009ScriptAnchor_"><span>Next Script: [copyrightHolder]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">clearCitationMatch</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33182ScriptAnchor_">menuReferenceNodesOrEditors</a></li>
<li><a href="#33287ScriptAnchor_">insertTimeInRefTimeField</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If node is currenlty locked then stop script, inform user.</li>
<li>If [ tagNodeCreator::orderOrLock &ne; "" ]</li>
<li>Go to Field [  ]</li>
<li>Show Custom Dialog [ Message: "The default node selected is locked.  Select this node in the setup window and enter the password to unlock it, then you will able to edit records assigned to this node."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#In order to reset the conditional formatting</li>
<li>#it is neccessary at  the end of this script to go</li>
<li>#and refresh the other window, which makes</li>
<li>#the popout calendar go away, so to make it</li>
<li>#come back the system goes to the next field</li>
<li>#and back to the current field which triggers</li>
<li>#this script and why this next step is neccessary</li>
<li>#to prevent an infinite logic loop.</li>
<li>If [ $$turnOffThisScript = 1 ]</li>
<li>Set Variable [ $$turnOffThisScript ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ $$turnOffThisScript = 2 ]</li>
<li>Set Variable [ $$turnOffThisScript ]</li>
<li>Go to Field [  ]</li>
<li>//  Exit Script [  ]</li>
<li>//  Halt Script</li>
<li>End If</li>
<li>Set Variable [ $$turnOffThisScript; Value:1 ]</li>
<li>If [ $$add = 1 ]</li>
<li>Go to Field [  ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Clear any conditional formatting tied to the</li>
<li>#citation match variable in both windows.</li>
<li>Set Variable [ $$citationMatch ]</li>
<li>Set Variable [ $$stopFileNameCheck; Value:1 ]</li>
<li>Set Variable [ $table; Value:Get ( LayoutTableName ) ]</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>If [ Get (LastError)  = 112 ]</li>
<li>New Window [ Name: "Tag Menus"; Height: Get (ScreenHeight); Width: Get (ScreenWidth) / 2; Top: 0; Left: Get (ScreenWidth) / 2 ]</li>
<li>End If</li>
<li>If [ $table = "reference" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenuNoTags&rdquo; (tagMenus) ]</li>
<li>Else</li>
<li>Go to Layout [ &ldquo;learnTagWindowNoTags&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>#</li>
<li>#Return user to field user clicked into to start this script.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Go to Next Field</li>
<li>Set Variable [ $$turnOffThisScript; Value:1 ]</li>
<li>Go to Previous Field</li>
<li>Set Variable [ $$turnOffThisScript; Value:1 ]</li>
<li>Set Variable [ $$stopFileNameCheck ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagNodeCreator</em>::orderOrLock</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>ReferenceMenuNoTags</li>
<li>learnTagWindowNoTags</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33009ScriptAnchor_"></a><td class="script_navbar"><a href="#33014ScriptAnchor_"><span>Previous Script: [clearCitationMatch]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#33281ScriptAnchor_"><span>Next Script: [copyrightHolderDeleteEditor]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">copyrightHolder</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If user is on copyright holder field perform script.</li>
<li>If [ $$citationMatch  =  "node" or 
$$citationMatch  =  "copyist" or 
$$citationMatch  =  "organ" or 
$$citationMatch  =  "referenceNodes" or 
$$citationMatch  =  "editors" or 
$$citationMatch  =  "governmentAuthor" ]</li>
<li>#</li>
<li>#Get the keys currently unlocking who is a </li>
<li>#copyright holder.</li>
<li>Set Variable [ $keyChain; Value:reference::kcopyrightHolder ]</li>
<li>#</li>
<li>#Figure out what field the user wants to designate</li>
<li>#as a copyright holder for this citation.</li>
<li>If [ $$citationMatch = "node" ]</li>
<li>Set Variable [ $key; Value:"node738fds8ef" ]</li>
<li>#</li>
<li>#If the field is blank exit the script.</li>
<li>If [ reference::knodePrimary = "" and reference::knodeOther = "" ]</li>
<li>Show Custom Dialog [ Message: "Select a node first and then click on this button.  A yellow line will appear above the copyright holder's name."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>Else If [ $$citationMatch = "copyist" ]</li>
<li>Set Variable [ $key; Value:reference::kcopyist ]</li>
<li>#</li>
<li>#If the field is blank exit the script.</li>
<li>If [ reference::kcopyist = "" ]</li>
<li>Show Custom Dialog [ Message: "Select a copyist first and then click on this button.  A yellow line will appear above the copyright holder's name."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>Else If [ $$citationMatch = "organ" ]</li>
<li>Set Variable [ $key; Value:reference::korgan ]</li>
<li>#</li>
<li>#If the field is blank exit the script.</li>
<li>If [ reference::korgan = "" ]</li>
<li>Show Custom Dialog [ Message: "Select an organ first and then click on this button.  A yellow line will appear above the copyright holder's name."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>Else If [ $$citationMatch = "editors" ]</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $key; Value:"editors857398f839" ]</li>
<li>#</li>
<li>#If the field is blank exit the script.</li>
<li>If [ reference::compilationEditors = "" ]</li>
<li>Show Custom Dialog [ Message: "Type in one or more editors' names first and then click on this button.  A yellow line will appear above the copyright holders' names."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>Else If [ $$citationMatch = "governmentAuthor" ]</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $key; Value:"governmentAuthor6767767676" ]</li>
<li>#</li>
<li>#If the field is blank exit the script.</li>
<li>If [ reference::governmentAuthor = "" ]</li>
<li>Show Custom Dialog [ Message: "Type in gov't or corp. author name first and then click on this button.  A yellow line will appear above the copyright holders' names."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>Else If [ $$citationMatch = "referenceNodes" ]</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $key; Value:reference::referenceNodes ]</li>
<li>#</li>
<li>#If the field is blank exit the script.</li>
<li>If [ reference::referenceNodes = "" ]</li>
<li>Show Custom Dialog [ Message: "Type in one or more nodes first and then click on this button.  A yellow line will appear above the copyright holder's name."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If reference nodes are already designated as copyright</li>
<li>#holders, and user clicks in this field and changes</li>
<li>#the spelling and then clicks the copyright holder</li>
<li>#button to indicate that the user does not want these</li>
<li>#to be copyright holders, remove them</li>
<li>#from the copyright holder keychain.  In this case</li>
<li>#the text of their names is the key.</li>
<li>Set Variable [ $keyOLD; Value:reference::referenceNodesOLD ]</li>
<li>If [ $keyOLD &amp; "&para;"  = FilterValues ( $keychain ; $keyOLD &amp; "&para;" ) ]</li>
<li>Set Field [ reference::kcopyrightHolder; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used

//If ( ValueCount ( $keyChain ) &ne; ValueCount ( Substitute ( $keyChain ; $key &amp; "&para;"  ; "" ) ) ; 

Substitute ( $keyChain ; $keyOLD &amp; "&para;"  ; "" )   //; 

//Substitute ( $keyChain ; $key ; "" ) 

//) ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Because citation nodes use the text in the field</li>
<li>#as the key, the user needs to be exited from that</li>
<li>#text box so they can see the highlight appear</li>
<li>#when the copyright owner button is clicked.</li>
<li>Go to Field [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Remove key from keychain if it is on </li>
<li>#the copyright holder keychain.</li>
<li>If [ $key &amp; "&para;"  = FilterValues ( $keychain ; $key &amp; "&para;" ) ]</li>
<li>Set Field [ reference::kcopyrightHolder; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used

//If ( ValueCount ( $keyChain ) &ne; ValueCount ( Substitute ( $keyChain ; $key &amp; "&para;"  ; "" ) ) ; 

Substitute ( $keyChain ; $key &amp; "&para;"  ; "" )   //; 

//Substitute ( $keyChain ; $key ; "" ) 

//) ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Add key to keychain if it is currenlty not on the</li>
<li>#the copyright holder keychain.</li>
<li>Set Field [ reference::kcopyrightHolder; $key &amp; "&para;" &amp; $keyChain ]</li>
<li>#</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If no copyright holder field is selected ...</li>
<li>Show Custom Dialog [ Message: "Click into the field with the copyright holder's name and then click on this button.  A yellow line will appear above the copyright holder's name."; Buttons: &ldquo;OK&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::kcopyrightHolder</li>
<li>
<em>reference</em>::knodePrimary</li>
<li>
<em>reference</em>::knodeOther</li>
<li>
<em>reference</em>::kcopyist</li>
<li>
<em>reference</em>::korgan</li>
<li>
<em>reference</em>::compilationEditors</li>
<li>
<em>reference</em>::governmentAuthor</li>
<li>
<em>reference</em>::referenceNodes</li>
<li>
<em>reference</em>::referenceNodesOLD</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33281ScriptAnchor_"></a><td class="script_navbar"><a href="#33009ScriptAnchor_"><span>Previous Script: [copyrightHolder]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#33292ScriptAnchor_"><span>Next Script: [URLcheck]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">copyrightHolderDeleteEditor</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Get the keys currently unlocking who is a </li>
<li>#copyright holder.</li>
<li>Set Variable [ $keyChain; Value:reference::kcopyrightHolder ]</li>
<li>#</li>
<li>#If user has deleted all editors then start process</li>
<li>#of removing editor copyright key if it is on the keychain.</li>
<li>Go to Field [  ]</li>
<li>If [ $$citationMatch = "editors" and reference::compilationEditors = "" ]</li>
<li>Set Variable [ $key; Value:"editors857398f839" ]</li>
<li>End If</li>
<li>#</li>
<li>#If user has deleted all government authors then start process</li>
<li>#of removing governmentAuthor copyright key if it is on the keychain.</li>
<li>Go to Field [  ]</li>
<li>If [ $$citationMatch = "governmentAuthor" and reference::governmentAuthor = "" ]</li>
<li>Set Variable [ $key; Value:"governmentAuthor6767767676" ]</li>
<li>End If</li>
<li>#</li>
<li>#Remove key from keychain</li>
<li>If [ $key &amp; "&para;"  = FilterValues ( $keychain ; $key &amp; "&para;" ) ]</li>
<li>Set Field [ reference::kcopyrightHolder; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used

//If ( ValueCount ( $keyChain ) &ne; ValueCount ( Substitute ( $keyChain ; $key &amp; "&para;"  ; "" ) ) ; 

Substitute ( $keyChain ; $key &amp; "&para;"  ; "" )   //; 

//Substitute ( $keyChain ; $key ; "" ) 

//) ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::kcopyrightHolder</li>
<li>
<em>reference</em>::compilationEditors</li>
<li>
<em>reference</em>::governmentAuthor</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33292ScriptAnchor_"></a><td class="script_navbar"><a href="#33281ScriptAnchor_"><span>Previous Script: [copyrightHolderDeleteEditor]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#33015ScriptAnchor_"><span>Next Script: [removeTextFormatting]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">URLcheck</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ $$stopFileNameCheck = 1 ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>If [ Filter ( reference::fileName ; "?" ) = "?" or 
Filter ( reference::fileName ; "#" ) = "#" or 
Filter ( reference::fileName ; ";" ) = ";" or 
Filter ( reference::fileName ; "/" ) = "/" or 
Filter ( reference::fileName ; ":" ) = ":" ]</li>
<li>Show Custom Dialog [ Message: "These special characters  ?  #  /  ;  :  prevent the system from opening files.  Remove them from your filename and then test the 'file' button above to insure it opens your file."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Go to Field [ reference::fileName ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::fileName</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33015ScriptAnchor_"></a><td class="script_navbar"><a href="#33292ScriptAnchor_"><span>Previous Script: [URLcheck]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#33017ScriptAnchor_"><span>Next Script: [removeTextFormattingAndCommas]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">removeTextFormatting</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Field [ TextFontRemove ( (Get ( ActiveFieldContents ))  ) ]</li>
<li>Set Field [ TextFormatRemove ( (Get ( ActiveFieldContents ))  ) ]</li>
<li>Set Field [ TextSizeRemove ( (Get ( ActiveFieldContents ))  ) ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33017ScriptAnchor_"></a><td class="script_navbar"><a href="#33015ScriptAnchor_"><span>Previous Script: [removeTextFormatting]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#33016ScriptAnchor_"><span>Next Script: [formatTitle]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">removeTextFormattingAndCommas</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32999ScriptAnchor_">changeSpellingOfKeywordOrNodeTag</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Commit Records/Requests</li>
<li>Set Field [ tagMenus::tag; TextFontRemove ( tagMenus::tag ) ]</li>
<li>Set Field [ tagMenus::tag; TextFormatRemove ( tagMenus::tag ) ]</li>
<li>Set Field [ tagMenus::tag; TextSizeRemove ( tagMenus::tag ) ]</li>
<li>Set Variable [ $tag; Value:tagMenus::tag ]</li>
<li>If [ Filter ( tagMenus::tag ; "," ) = ","  and  $$citationMatch = "key" ]</li>
<li>Show Custom Dialog [ Message: "commas prevent system from keeping track of this item and have been removed"; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Set Field [ tagMenus::tag; Substitute ( $tag ; "," ; "" ) ]</li>
<li>Else If [ Filter ( tagMenus::tag ; ";" ) = ";"  and $$citationMatch = "node" ]</li>
<li>Show Custom Dialog [ Message: "semicolons prevent system from keeping track of this item and have been removed"; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Set Field [ tagMenus::tag; Substitute ( $tag ; ";" ; "" ) ]</li>
<li>End If</li>
<li>Set Field [ tagMenus::tag; Trim ( tagMenus::tag ) ]</li>
<li>If [ $$citationmatch = "health"
 or 
$$citationmatch = "sample" ]</li>
<li>Perform Script [ &ldquo;insureEqualityOfSpellFields&rdquo; ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagMenus</em>::tag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33227ScriptAnchor_">insureEqualityOfSpellFields</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33016ScriptAnchor_"></a><td class="script_navbar"><a href="#33017ScriptAnchor_"><span>Previous Script: [removeTextFormattingAndCommas]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#33035ScriptAnchor_"><span>Next Script: [showFile2]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">formatTitle</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Field [ TextFontRemove ( (Get ( ActiveFieldContents ))  ) ]</li>
<li>Set Field [ TextFormatRemove ( (Get ( ActiveFieldContents ))  ) ]</li>
<li>Set Field [ TextSizeRemove ( (Get ( ActiveFieldContents ))  ) ]</li>
<li>Set Field [ TextStyleAdd ( Get ( ActiveFieldContents ) ; Titlecase ) ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33035ScriptAnchor_"></a><td class="script_navbar"><a href="#33016ScriptAnchor_"><span>Previous Script: [formatTitle]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#33036ScriptAnchor_"><span>Next Script: [showFile3]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">showFile2</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Show reference file.</li>
<li>If [ FilterValues ( citationTitle2::kfileLocation ; "8162011225532313" ) = "8162011225532313" &amp; &para; ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/" &amp; citationTitle2::fileName ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Else If [ FilterValues ( citationTitle2::kfileLocation ; "8162011225558314" ) = "8162011225558314" &amp; &para; ]</li>
<li>Open URL [  Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; citationTitle2::fileName ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( citationTitle2::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para; ]</li>
<li>Open URL [ Substitute ( tagFolderPathForFile::tag &amp; citationTitle2::fileName ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Else If [ citationTitle2::URL &ne; "" ]</li>
<li>Open URL [ citationTitle2::URL ]
[ No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#Show testlearn file.</li>
<li>If [ FilterValues ( TLTitle2::kfileLocation ; "8162011225532313" ) = "8162011225532313" &amp; &para; ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/" &amp; TLTitle2::filename ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Else If [ FilterValues ( TLTitle2::kfileLocation ; "8162011225558314" ) = "8162011225558314" &amp; &para; ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; TLTitle2::filename ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( TLTitle2::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para; ]</li>
<li>Open URL [ Substitute ( tagTLFolderPathForFile2::tag &amp; TLTitle2::filename ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Else If [ TLTitle2::URL &ne; "" ]</li>
<li>Open URL [ TLTitle2::URL ]
[ No dialog ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>citationTitle2</em>::kfileLocation</li>
<li>
<em>citationTitle2</em>::fileName</li>
<li>
<em>tagFolderPathForFile</em>::tag</li>
<li>
<em>citationTitle2</em>::URL</li>
<li>
<em>TLTitle2</em>::kfileLocation</li>
<li>
<em>TLTitle2</em>::filename</li>
<li>
<em>tagTLFolderPathForFile2</em>::tag</li>
<li>
<em>TLTitle2</em>::URL</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33036ScriptAnchor_"></a><td class="script_navbar"><a href="#33035ScriptAnchor_"><span>Previous Script: [showFile2]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#33028ScriptAnchor_"><span>Next Script: [addFileLink4ToTag]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">showFile3</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Show reference file.</li>
<li>If [ FilterValues ( citationTitle3::kfileLocation ; "8162011225532313" ) = "8162011225532313" &amp; &para; ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/" &amp; citationTitle3::fileName ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Else If [ FilterValues ( citationTitle3::kfileLocation ; "8162011225558314" ) = "8162011225558314" &amp; &para; ]</li>
<li>Open URL [  Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; citationTitle3::fileName ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( citationTitle3::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para; ]</li>
<li>Open URL [ Substitute ( tagFolderPathForFile3::tag &amp; citationTitle3::fileName ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Else If [ citationTitle3::URL &ne; "" ]</li>
<li>Open URL [ citationTitle3::URL ]
[ No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#Show testlearn file.</li>
<li>If [ FilterValues ( TLTitle3::kfileLocation ; "8162011225532313" ) = "8162011225532313" &amp; &para; ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/" &amp; TLTitle3::filename ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Else If [ FilterValues ( TLTitle3::kfileLocation ; "8162011225558314" ) = "8162011225558314" &amp; &para; ]</li>
<li>Open URL [ Substitute (Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; TLTitle3::filename ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( TLTitle3::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para; ]</li>
<li>Open URL [ Substitute ( tagTLFolderPathForFile3::tag &amp; TLTitle3::filename ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Else If [ TLTitle3::URL &ne; "" ]</li>
<li>Open URL [ TLTitle3::URL ]
[ No dialog ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>citationTitle3</em>::kfileLocation</li>
<li>
<em>citationTitle3</em>::fileName</li>
<li>
<em>tagFolderPathForFile3</em>::tag</li>
<li>
<em>citationTitle3</em>::URL</li>
<li>
<em>TLTitle3</em>::kfileLocation</li>
<li>
<em>TLTitle3</em>::filename</li>
<li>
<em>tagTLFolderPathForFile3</em>::tag</li>
<li>
<em>TLTitle3</em>::URL</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33028ScriptAnchor_"></a><td class="script_navbar"><a href="#33036ScriptAnchor_"><span>Previous Script: [showFile3]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#33029ScriptAnchor_"><span>Next Script: [addFileLink5ToTag]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">addFileLink4ToTag</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Do not allow learn records to be added to tags as</li>
<li>#that would require insuring all that Learn record's</li>
<li>#reference records tagged onto it were also</li>
<li>#brought into the new section along with all </li>
<li>#their tags, and their tags' tags.  THUS only allow</li>
<li>#Learn records to be added to tags that have a picture</li>
<li>#or link (thus provide value) and have none of the</li>
<li>#above mentioned tags: reference, cite.</li>
<li>#AND once such a tag is added no reference,</li>
<li>#or cite tags can be added to it.  </li>
<li>If [ testlearn::kcitation &ne; "" or testlearn::kcreference &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "Learn records with references or a citation cannot be added to tags.  Doing so would require adding all these reference and cite records' references and cite records, and then all of theirs, and so on.  "; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Clear fields and then determine if there something</li>
<li>#to link.</li>
<li>Go to Field [  ]</li>
<li>If [ reference::Title &ne; ""  and 
FilterValues ( reference::kfileLocation ; "8162011225532313" ) = "8162011225532313" &amp; &para;  and 
reference::fileName &ne; ""
 or 
reference::Title &ne; ""  and 
FilterValues ( reference::kfileLocation ; "8162011225558314" ) = "8162011225558314" &amp; &para;  and 
reference::fileName &ne; ""
 or
reference::Title &ne; ""  and 
FilterValues ( reference::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para;  and 
tagRefFolderPath::tag &ne; "" and  
reference::fileName &ne; ""

 or 

FilterValues ( testlearn::kfileLocation ; "8162011225532313" ) = "8162011225532313" &amp; &para;  and 
testlearn::filename &ne; ""
 or 
FilterValues ( testlearn::kfileLocation ; "8162011225558314" ) = "8162011225558314" &amp; &para;  and 
testlearn::filename &ne; ""
 or
FilterValues ( testlearn::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para;  and 
tagTLFolderPath::tag &ne; "" and  
testlearn::filename &ne; ""

 or 

testlearn::URL &ne; ""

 or 

reference::URL &ne; "" ]</li>
<li>#</li>
<li>#Set variables to passed on to linking script.</li>
<li>Set Variable [ $$name; Value:"title" ]</li>
<li>Set Variable [ $$number; Value:1 ]</li>
<li>#</li>
<li>#If the filterFind checkbox is not checked for the</li>
<li>#the current $$CitationMatch variable, then</li>
<li>#these next scripts will identify that problem,</li>
<li>#fix it, and inform the user of what it did.</li>
<li>If [ Get ( LayoutTableName ) = "testlearn" ]</li>
<li>If [ $$citationMatch = "key" and "keyword" &amp; &para; &ne; FilterValues ( testlearn::filterFind ; "keyword" ) ]</li>
<li>Set Variable [ $filterFind; Value:testlearn::filterFind ]</li>
<li>Set Field [ testlearn::filterFind; "keyword" &amp; &para; &amp; $filterFind ]</li>
<li>//  Show Custom Dialog [ Message: "The system has added this learn record to the " &amp;
If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp;

 " citation record set.  You will not have to click the 'all' button anymore to find it for " &amp; If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."

//Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " &amp;
//If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Else If [ $$citationMatch &amp; &para; &ne; FilterValues ( testlearn::filterFind ; $$citationMatch ) ]</li>
<li>Set Variable [ $filterFind; Value:testlearn::filterFind ]</li>
<li>Set Field [ testlearn::filterFind; $$citationMatch &amp; &para; &amp; $filterFind ]</li>
<li>//  Show Custom Dialog [ Message: "The system has added this learn record to the " &amp;
If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp;

 " citation record set.  You will not have to click the 'all' button anymore to find it for " &amp; If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."

//Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " &amp;
//If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>Else If [ Get ( LayoutTableName ) = "reference" ]</li>
<li>If [ $$citationMatch = "key" and "keyword" &amp; &para; &ne; FilterValues ( reference::filterFind ; "keyword" ) ]</li>
<li>Set Variable [ $filterFind; Value:reference::filterFind ]</li>
<li>Set Field [ reference::filterFind; "keyword" &amp; &para; &amp; $filterFind ]</li>
<li>//  Show Custom Dialog [ Message: "The system has added this reference record to the " &amp;
If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp;

 " citation record set.  You will not have to click the 'all' button anymore to find it for " &amp; If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."

//Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " &amp;
//If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Else If [ $$citationMatch &amp; &para; &ne; FilterValues ( reference::filterFind ; $$citationMatch ) ]</li>
<li>Set Variable [ $filterFind; Value:reference::filterFind ]</li>
<li>Set Field [ reference::filterFind; $$citationMatch &amp; &para; &amp; $filterFind ]</li>
<li>//  Show Custom Dialog [ Message: "The system has added this reference record to the " &amp;
If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp;

 " citation record set.  You will not have to click the 'all' button anymore to find it for " &amp; If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."

//Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " &amp;
//If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Now perform the script that adds the tag.</li>
<li>Perform Script [ &ldquo;CHUNKaddLinkToTag&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If the conditions for adding the tag are not met</li>
<li>#tell the user which ones needs to be met before</li>
<li>#the tag can be added.</li>
<li>If [ reference::fileName = "" and Get ( LayoutTableName ) = "reference" or testlearn::filename = "" and Get ( LayoutTableName ) = "testlearn" ]</li>
<li>Show Custom Dialog [ Message: "A file name is required including the file's extension: .jpg , .gif , .pdf , .mov , etc. OR a URL is required to add a link."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Else If [ reference::kfileLocation = "" and reference::fileName &ne; "" and Get ( LayoutTableName ) = "reference" or testlearn::kfileLocation = "" and testlearn::filename &ne; "" and Get ( LayoutTableName ) = "testlearn" ]</li>
<li>Show Custom Dialog [ Message: "Check the box next the location of your file: main, other, or x."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Else If [ FilterValues ( reference::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para;  and 
tagRefFolderPath::tag = "" or 

FilterValues ( testlearn::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para;  and 
testlearn::kfolderPath = "" ]</li>
<li>Show Custom Dialog [ Message: "Select a file path from the Tag Menus window.  If there are none then add one by opening the file with a browser (Firefox, Explore, etc.) and dragging/pasting the address into a new tag's text box."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Perform Script [ &ldquo;menuPath&rdquo; ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearn</em>::kcitation</li>
<li>
<em>testlearn</em>::kcreference</li>
<li>
<em>reference</em>::Title</li>
<li>
<em>reference</em>::kfileLocation</li>
<li>
<em>reference</em>::fileName</li>
<li>
<em>tagRefFolderPath</em>::tag</li>
<li>
<em>testlearn</em>::kfileLocation</li>
<li>
<em>testlearn</em>::filename</li>
<li>
<em>tagTLFolderPath</em>::tag</li>
<li>
<em>testlearn</em>::URL</li>
<li>
<em>reference</em>::URL</li>
<li>
<em>testlearn</em>::filterFind</li>
<li>
<em>reference</em>::filterFind</li>
<li>
<em>testlearn</em>::kfolderPath</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33027ScriptAnchor_">CHUNKaddLinkToTag</a></li>
<li><a href="#32991ScriptAnchor_">menuPath</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33029ScriptAnchor_"></a><td class="script_navbar"><a href="#33028ScriptAnchor_"><span>Previous Script: [addFileLink4ToTag]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#33030ScriptAnchor_"><span>Next Script: [addFileLink6ToTag]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">addFileLink5ToTag</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Do not allow learn records to be added to tags as</li>
<li>#that would require insuring all that Learn record's</li>
<li>#reference records tagged onto it were also</li>
<li>#brought into the new section along with all </li>
<li>#their tags, and their tags' tags.  THUS only allow</li>
<li>#Learn records to be added to tags that have a picture</li>
<li>#or link (thus provide value) and have none of the</li>
<li>#above mentioned tags: reference, cite.</li>
<li>#AND once such a tag is added no reference,</li>
<li>#or cite tags can be added to it.  </li>
<li>If [ testlearn::kcitation &ne; "" or testlearn::kcreference &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "Learn records with references or a citation cannot be added to tags.  Doing so would require adding all these reference and cite records' references and cite records, and then all of theirs, and so on.  "; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Clear fields and then determine if there something</li>
<li>#to link.</li>
<li>Go to Field [  ]</li>
<li>If [ reference::Title &ne; ""  and 
FilterValues ( reference::kfileLocation ; "8162011225532313" ) = "8162011225532313" &amp; &para;  and 
reference::fileName &ne; ""
 or 
reference::Title &ne; ""  and 
FilterValues ( reference::kfileLocation ; "8162011225558314" ) = "8162011225558314" &amp; &para;  and 
reference::fileName &ne; ""
 or
reference::Title &ne; ""  and 
FilterValues ( reference::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para;  and 
tagRefFolderPath::tag &ne; "" and  
reference::fileName &ne; ""

 or 

FilterValues ( testlearn::kfileLocation ; "8162011225532313" ) = "8162011225532313" &amp; &para;  and 
testlearn::filename &ne; ""
 or 
FilterValues ( testlearn::kfileLocation ; "8162011225558314" ) = "8162011225558314" &amp; &para;  and 
testlearn::filename &ne; ""
 or
FilterValues ( testlearn::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para;  and 
tagTLFolderPath::tag &ne; "" and  
testlearn::filename &ne; ""

 or 

testlearn::URL &ne; ""

 or 

reference::URL &ne; "" ]</li>
<li>#</li>
<li>#Set variables to passed on to linking script.</li>
<li>Set Variable [ $$name; Value:"title" ]</li>
<li>Set Variable [ $$number; Value:2 ]</li>
<li>#</li>
<li>#If the filterFind checkbox is not checked for the</li>
<li>#the current $$CitationMatch variable, then</li>
<li>#these next scripts will identify that problem,</li>
<li>#fix it, and inform the user of what it did.</li>
<li>If [ Get ( LayoutTableName ) = "testlearn" ]</li>
<li>If [ $$citationMatch = "key" and "keyword" &amp; &para; &ne; FilterValues ( testlearn::filterFind ; "keyword" ) ]</li>
<li>Set Variable [ $filterFind; Value:testlearn::filterFind ]</li>
<li>Set Field [ testlearn::filterFind; "keyword" &amp; &para; &amp; $filterFind ]</li>
<li>//  Show Custom Dialog [ Message: "The system has added this learn record to the " &amp;
If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp;

 " citation record set.  You will not have to click the 'all' button anymore to find it for " &amp; If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."

//Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " &amp;
//If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Else If [ $$citationMatch &amp; &para; &ne; FilterValues ( testlearn::filterFind ; $$citationMatch ) ]</li>
<li>Set Variable [ $filterFind; Value:testlearn::filterFind ]</li>
<li>Set Field [ testlearn::filterFind; $$citationMatch &amp; &para; &amp; $filterFind ]</li>
<li>//  Show Custom Dialog [ Message: "The system has added this learn record to the " &amp;
If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp;

 " citation record set.  You will not have to click the 'all' button anymore to find it for " &amp; If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."

//Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " &amp;
//If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>Else If [ Get ( LayoutTableName ) = "reference" ]</li>
<li>If [ $$citationMatch = "key" and "keyword" &amp; &para; &ne; FilterValues ( reference::filterFind ; "keyword" ) ]</li>
<li>Set Variable [ $filterFind; Value:reference::filterFind ]</li>
<li>Set Field [ reference::filterFind; "keyword" &amp; &para; &amp; $filterFind ]</li>
<li>//  Show Custom Dialog [ Message: "The system has added this reference record to the " &amp;
If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp;

 " citation record set.  You will not have to click the 'all' button anymore to find it for " &amp; If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."

//Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " &amp;
//If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Else If [ $$citationMatch &amp; &para; &ne; FilterValues ( reference::filterFind ; $$citationMatch ) ]</li>
<li>Set Variable [ $filterFind; Value:reference::filterFind ]</li>
<li>Set Field [ reference::filterFind; $$citationMatch &amp; &para; &amp; $filterFind ]</li>
<li>//  Show Custom Dialog [ Message: "The system has added this reference record to the " &amp;
If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp;

 " citation record set.  You will not have to click the 'all' button anymore to find it for " &amp; If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."

//Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " &amp;
//If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Now perform the script that adds the tag.</li>
<li>Perform Script [ &ldquo;CHUNKaddLinkToTag&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If the conditions for adding the tag are not met</li>
<li>#tell the user which ones needs to be met before</li>
<li>#the tag can be added.</li>
<li>If [ reference::fileName = "" and Get ( LayoutTableName ) = "reference" or testlearn::filename = "" and Get ( LayoutTableName ) = "testlearn" ]</li>
<li>Show Custom Dialog [ Message: "A file name is required including the file's extension: .jpg , .gif , .pdf , .mov , etc. OR a URL is required to add a link."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Else If [ reference::kfileLocation = "" and reference::fileName &ne; "" and Get ( LayoutTableName ) = "reference" or testlearn::kfileLocation = "" and testlearn::filename &ne; "" and Get ( LayoutTableName ) = "testlearn" ]</li>
<li>Show Custom Dialog [ Message: "Check the box next the location of your file: main, other, or x."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Else If [ FilterValues ( reference::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para;  and 
tagRefFolderPath::tag = "" or 

FilterValues ( testlearn::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para;  and 
testlearn::kfolderPath = "" ]</li>
<li>Show Custom Dialog [ Message: "Select a file path from the Tag Menus window.  If there are none then add one by opening the file with a browser (Firefox, Explore, etc.) and dragging/pasting the address into a new tag's text box."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Perform Script [ &ldquo;menuPath&rdquo; ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearn</em>::kcitation</li>
<li>
<em>testlearn</em>::kcreference</li>
<li>
<em>reference</em>::Title</li>
<li>
<em>reference</em>::kfileLocation</li>
<li>
<em>reference</em>::fileName</li>
<li>
<em>tagRefFolderPath</em>::tag</li>
<li>
<em>testlearn</em>::kfileLocation</li>
<li>
<em>testlearn</em>::filename</li>
<li>
<em>tagTLFolderPath</em>::tag</li>
<li>
<em>testlearn</em>::URL</li>
<li>
<em>reference</em>::URL</li>
<li>
<em>testlearn</em>::filterFind</li>
<li>
<em>reference</em>::filterFind</li>
<li>
<em>testlearn</em>::kfolderPath</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33027ScriptAnchor_">CHUNKaddLinkToTag</a></li>
<li><a href="#32991ScriptAnchor_">menuPath</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33030ScriptAnchor_"></a><td class="script_navbar"><a href="#33029ScriptAnchor_"><span>Previous Script: [addFileLink5ToTag]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#33032ScriptAnchor_"><span>Next Script: [showFolder]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">addFileLink6ToTag</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Do not allow learn records to be added to tags as</li>
<li>#that would require insuring all that Learn record's</li>
<li>#reference records tagged onto it were also</li>
<li>#brought into the new section along with all </li>
<li>#their tags, and their tags' tags.  THUS only allow</li>
<li>#Learn records to be added to tags that have a picture</li>
<li>#or link (thus provide value) and have none of the</li>
<li>#above mentioned tags: reference, cite.</li>
<li>#AND once such a tag is added no reference,</li>
<li>#or cite tags can be added to it.  </li>
<li>If [ testlearn::kcitation &ne; "" or testlearn::kcreference &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "Learn records with references or a citation cannot be added to tags.  Doing so would require adding all these reference and cite records' references and cite records, and then all of theirs, and so on.  "; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Add file link to Tag Menu item.</li>
<li>Go to Field [  ]</li>
<li>If [ reference::Title &ne; ""  and 
FilterValues ( reference::kfileLocation ; "8162011225532313" ) = "8162011225532313" &amp; &para;  and 
reference::fileName &ne; ""
 or 
reference::Title &ne; ""  and 
FilterValues ( reference::kfileLocation ; "8162011225558314" ) = "8162011225558314" &amp; &para;  and 
reference::fileName &ne; ""
 or
reference::Title &ne; ""  and 
FilterValues ( reference::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para;  and 
tagRefFolderPath::tag &ne; "" and  
reference::fileName &ne; ""

 or 

FilterValues ( testlearn::kfileLocation ; "8162011225532313" ) = "8162011225532313" &amp; &para;  and 
testlearn::filename &ne; ""
 or 
FilterValues ( testlearn::kfileLocation ; "8162011225558314" ) = "8162011225558314" &amp; &para;  and 
testlearn::filename &ne; ""
 or
FilterValues ( testlearn::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para;  and 
tagTLFolderPath::tag &ne; "" and  
testlearn::filename &ne; ""

 or 

testlearn::URL &ne; ""

 or 

reference::URL &ne; "" ]</li>
<li>Set Variable [ $$name; Value:"title" ]</li>
<li>Set Variable [ $$number; Value:3 ]</li>
<li>#</li>
<li>#If the filterFind checkbox is not checked for the</li>
<li>#the current $$CitationMatch variable, then</li>
<li>#these next scripts will identify that problem,</li>
<li>#fix it, and inform the user of what it did.</li>
<li>If [ Get ( LayoutTableName ) = "testlearn" ]</li>
<li>If [ $$citationMatch = "key" and "keyword" &amp; &para; &ne; FilterValues ( testlearn::filterFind ; "keyword" ) ]</li>
<li>Set Variable [ $filterFind; Value:testlearn::filterFind ]</li>
<li>Set Field [ testlearn::filterFind; "keyword" &amp; &para; &amp; $filterFind ]</li>
<li>//  Show Custom Dialog [ Message: "The system has added this learn record to the " &amp;
If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp;

 " citation record set.  You will not have to click the 'all' button anymore to find it for " &amp; If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."

//Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " &amp;
//If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Else If [ $$citationMatch &amp; &para; &ne; FilterValues ( testlearn::filterFind ; $$citationMatch ) ]</li>
<li>Set Variable [ $filterFind; Value:testlearn::filterFind ]</li>
<li>Set Field [ testlearn::filterFind; $$citationMatch &amp; &para; &amp; $filterFind ]</li>
<li>//  Show Custom Dialog [ Message: "The system has added this learn record to the " &amp;
If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp;

 " citation record set.  You will not have to click the 'all' button anymore to find it for " &amp; If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."

//Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " &amp;
//If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>Else If [ Get ( LayoutTableName ) = "reference" ]</li>
<li>If [ $$citationMatch = "key" and "keyword" &amp; &para; &ne; FilterValues ( reference::filterFind ; "keyword" ) ]</li>
<li>Set Variable [ $filterFind; Value:reference::filterFind ]</li>
<li>Set Field [ reference::filterFind; "keyword" &amp; &para; &amp; $filterFind ]</li>
<li>//  Show Custom Dialog [ Message: "The system has added this reference record to the " &amp;
If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp;

 " citation record set.  You will not have to click the 'all' button anymore to find it for " &amp; If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."

//Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " &amp;
//If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Else If [ $$citationMatch &amp; &para; &ne; FilterValues ( reference::filterFind ; $$citationMatch ) ]</li>
<li>Set Variable [ $filterFind; Value:reference::filterFind ]</li>
<li>Set Field [ reference::filterFind; $$citationMatch &amp; &para; &amp; $filterFind ]</li>
<li>//  Show Custom Dialog [ Message: "The system has added this reference record to the " &amp;
If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp;

 " citation record set.  You will not have to click the 'all' button anymore to find it for " &amp; If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."

//Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " &amp;
//If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) &amp; " tags."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Now perform the script that adds the tag.</li>
<li>Perform Script [ &ldquo;CHUNKaddLinkToTag&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>If [ reference::fileName = "" and Get ( LayoutTableName ) = "reference" or testlearn::filename = "" and Get ( LayoutTableName ) = "testlearn" ]</li>
<li>Show Custom Dialog [ Message: "A file name is required including the file's extension: .jpg , .gif , .pdf , .mov , etc. OR a URL is required to add a link."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Else If [ reference::kfileLocation = "" and reference::fileName &ne; "" and Get ( LayoutTableName ) = "reference" or testlearn::kfileLocation = "" and testlearn::filename &ne; "" and Get ( LayoutTableName ) = "testlearn" ]</li>
<li>Show Custom Dialog [ Message: "Check the box next the location of your file: main, other, or x."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Else If [ FilterValues ( reference::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para;  and 
tagRefFolderPath::tag = "" or 

FilterValues ( testlearn::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para;  and 
testlearn::kfolderPath = "" ]</li>
<li>Show Custom Dialog [ Message: "Select a file path from the Tag Menus window.  If there are none then add one by opening the file with a browser (Firefox, Explore, etc.) and dragging/pasting the address into a new tag's text box."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Perform Script [ &ldquo;menuPath&rdquo; ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearn</em>::kcitation</li>
<li>
<em>testlearn</em>::kcreference</li>
<li>
<em>reference</em>::Title</li>
<li>
<em>reference</em>::kfileLocation</li>
<li>
<em>reference</em>::fileName</li>
<li>
<em>tagRefFolderPath</em>::tag</li>
<li>
<em>testlearn</em>::kfileLocation</li>
<li>
<em>testlearn</em>::filename</li>
<li>
<em>tagTLFolderPath</em>::tag</li>
<li>
<em>testlearn</em>::URL</li>
<li>
<em>reference</em>::URL</li>
<li>
<em>testlearn</em>::filterFind</li>
<li>
<em>reference</em>::filterFind</li>
<li>
<em>testlearn</em>::kfolderPath</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33027ScriptAnchor_">CHUNKaddLinkToTag</a></li>
<li><a href="#32991ScriptAnchor_">menuPath</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33032ScriptAnchor_"></a><td class="script_navbar"><a href="#33030ScriptAnchor_"><span>Previous Script: [addFileLink6ToTag]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#33242ScriptAnchor_"><span>Next Script: [openCitationURL]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">showFolder</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Show  folder file is in Reference.</li>
<li>If [ FilterValues ( reference::kfileLocation ; "8162011225532313" ) = "8162011225532313" &amp; &para; ]</li>
<li>Show Custom Dialog [ Message: reference::fileName; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/" ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( reference::kfileLocation ; "8162011225558314" ) = "8162011225558314" &amp; &para; ]</li>
<li>Show Custom Dialog [ Message: reference::fileName; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( reference::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para; ]</li>
<li>Show Custom Dialog [ Message: reference::fileName; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:/" ; "file:///" ) &amp; tagRefFolderPath::tag ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>If [ Get (LastError) = 5 ]</li>
<li>Show Custom Dialog [ Message: "The folder has been moved, deleted, or the external drive this folder is on is not plugged in.  The folder path on file is " &amp; tagRefFolderPath::tag; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Show folder for cite file in Learn.</li>
<li>If [ FilterValues ( citeCite::kfileLocation ; "8162011225532313" ) = "8162011225532313" &amp; &para; ]</li>
<li>Show Custom Dialog [ Message: citeCite::fileName; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/" ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( citeCite::kfileLocation ; "8162011225558314" ) = "8162011225558314" &amp; &para; ]</li>
<li>Show Custom Dialog [ Message: citeCite::fileName; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( citeCite::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para; ]</li>
<li>Show Custom Dialog [ Message: citeCite::fileName; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:/" ; "file:///" ) &amp; TLciteFolderPath::tag ; " " ; "%20" ) &amp;

Case ( Left ( citeCite::fileName ; 1 ) =  "/" ; Substitute ( citeCite::fileName ; " " ; "%20" ) ) ]
[ No dialog ]</li>
<li>If [ Get (LastError) = 5 ]</li>
<li>Show Custom Dialog [ Message: "The folder has been moved, deleted, or the external drive this folder is on is not plugged in.  The folder path on file is " &amp; TLciteFolderPath::tag; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Show folder for 1st ref file in Learn.</li>
<li>If [ FilterValues ( refTest::kfileLocation ; "8162011225532313" ) = "8162011225532313" &amp; &para; ]</li>
<li>If [ ValueCount ( testlearnReportTags::kcreference ) &gt; 1 ]</li>
<li>Show Custom Dialog [ Message: "This is the first reference attached to this record.  To see all references, click the 'edit/new' button in the main list view window, and once you are in the Learn module, click the 'QV' button in the Learn window or the 'references' button in the Learn Tag Menus window."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>Show Custom Dialog [ Message: refTest::fileName; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/" ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( refTest::kfileLocation ; "8162011225558314" ) = "8162011225558314" &amp; &para; ]</li>
<li>If [ ValueCount ( testlearnReportTags::kcreference ) &gt; 1 ]</li>
<li>Show Custom Dialog [ Message: "This is the first reference attached to this record.  To see all references, click the 'edit/new' button in the main list view window, and once you are in the Learn module, click the 'QV' button in the Learn window or the 'references' button in the Learn Tag Menus window."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>Show Custom Dialog [ Message: refTest::fileName; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( refTest::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para; ]</li>
<li>If [ ValueCount ( testlearnReportTags::kcreference ) &gt; 1 ]</li>
<li>Show Custom Dialog [ Message: "This is the first reference attached to this record.  To see all references, click the 'edit/new' button in the main list view window, and once you are in the Learn module, click the 'QV' button in the Learn window or the 'references' button in the Learn Tag Menus window."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>Show Custom Dialog [ Message: refTest::fileName; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:/" ; "file:///" ) &amp; refTestFolderPath::tag ; " " ; "%20" ) &amp;

Case ( Left ( refTest::fileName ; 1 ) =  "/" ; Substitute ( refTest::fileName ; " " ; "%20" ) ) ]
[ No dialog ]</li>
<li>If [ Get (LastError) = 5 ]</li>
<li>Show Custom Dialog [ Message: "The folder has been moved, deleted, or the external drive this folder is on is not plugged in.  The folder path on file is " &amp; refTestFolderPath::tag; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Show folder cite file is in Test.</li>
<li>If [ FilterValues ( citeTest::kfileLocation ; "8162011225532313" ) = "8162011225532313" &amp; &para; ]</li>
<li>Show Custom Dialog [ Message: citeTest::fileName; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/" ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( citeTest::kfileLocation ; "8162011225558314" ) = "8162011225558314" &amp; &para; ]</li>
<li>Show Custom Dialog [ Message: citeTest::fileName; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ FilterValues ( citeTest::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para; ]</li>
<li>Show Custom Dialog [ Message: citeTest::fileName; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:/" ; "file:///" ) &amp; citeTestFolderPath::tag ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>If [ Get (LastError) = 5 ]</li>
<li>Show Custom Dialog [ Message: "The folder has been moved, deleted, or the external drive this folder is on is not plugged in.  The folder path on file is " &amp; citeTestFolderPath::tag; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>//  #</li>
<li>//  #Show folder file is in.</li>
<li>//  If [ FilterValues ( testlearn::kfileLocation ; "8162011225532313" ) = "8162011225532313" &amp; &para; ]</li>
<li>//  Show Custom Dialog [ Message: testlearn::filename; Buttons: &ldquo;OK&rdquo; ]</li>
<li>//  Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) &amp; "x/" ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>//  Exit Script [  ]</li>
<li>//  Else If [ FilterValues ( testlearn::kfileLocation ; "8162011225558314" ) = "8162011225558314" &amp; &para; ]</li>
<li>//  Show Custom Dialog [ Message: testlearn::filename; Buttons: &ldquo;OK&rdquo; ]</li>
<li>//  Open URL [ Substitute ( Case ( Get ( SystemPlatform ) =  - 2 ; "file:" ; "file:/" ) &amp; Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 9) ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>//  Exit Script [  ]</li>
<li>//  Else If [ FilterValues ( testlearn::kfileLocation ; "8162011225605315" ) = "8162011225605315" &amp; &para; ]</li>
<li>//  Show Custom Dialog [ Message: testlearn::filename; Buttons: &ldquo;OK&rdquo; ]</li>
<li>//  Open URL [ Substitute ( tagTLFolderPath::tag ; " " ; "%20" ) ]
[ No dialog ]</li>
<li>//  End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::kfileLocation</li>
<li>
<em>reference</em>::fileName</li>
<li>
<em>tagRefFolderPath</em>::tag</li>
<li>
<em>citeCite</em>::kfileLocation</li>
<li>
<em>citeCite</em>::fileName</li>
<li>
<em>TLciteFolderPath</em>::tag</li>
<li>
<em>refTest</em>::kfileLocation</li>
<li>
<em>testlearnReportTags</em>::kcreference</li>
<li>
<em>refTest</em>::fileName</li>
<li>
<em>refTestFolderPath</em>::tag</li>
<li>
<em>citeTest</em>::kfileLocation</li>
<li>
<em>citeTest</em>::fileName</li>
<li>
<em>citeTestFolderPath</em>::tag</li>
<li>
<em>testlearn</em>::kfileLocation</li>
<li>
<em>testlearn</em>::filename</li>
<li>
<em>tagTLFolderPath</em>::tag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33242ScriptAnchor_"></a><td class="script_navbar"><a href="#33032ScriptAnchor_"><span>Previous Script: [showFolder]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#33181ScriptAnchor_"><span>Next Script: [setCitationMatchForAuthors]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">openCitationURL</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Show folder file is in.</li>
<li>If [ refReference::URL &ne; "" or 
refReference::ISBN &ne; ""  or 
refReference::ISSN &ne; ""  or 
refReference::URLdoi &ne; "" ]</li>
<li>If [ ValueCount ( testlearn::kcreference ) &gt; 1 ]</li>
<li>Show Custom Dialog [ Message: "This is the first reference attached to this record.  To see all references, click the 'QV' button in the Learn window or the 'references' button in the Tag Menus window."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>Show Custom Dialog [ Message: "Reference's Title: " &amp; refReference::Title; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Open URL [ Case ( refReference::URL &ne; "" ; refReference::URL ;
refReference::ISBN &ne; "" ; "http://www.worldcat.org/search?q=bn%3A" &amp; refReference::ISBN ;
refReference::ISSN &ne; "" ; "http://www.worldcat.org/ISSN/" &amp; refReference::ISSN ;
refReference::URLdoi &ne; "" ; "http://dx.doi.org/"  &amp; refReference::URLdoi ;
"") ]
[ No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#Show folder file is in.</li>
<li>If [ citeCite::URL &ne; "" or 
citeCite::ISBN &ne; ""  or 
citeCite::ISSN &ne; ""  or 
citeCite::URLdoi &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "Reference's Title: " &amp; citeCite::Title; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Open URL [ Case ( citeCite::URL &ne; "" ; citeCite::URL ;
citeCite::ISBN &ne; "" ; "http://www.worldcat.org/search?q=bn%3A" &amp; citeCite::ISBN ;
citeCite::ISSN &ne; "" ; "http://www.worldcat.org/ISSN/" &amp; citeCite::ISSN ;
citeCite::URLdoi &ne; "" ; "http://dx.doi.org/"  &amp; citeCite::URLdoi ;
"") ]
[ No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#Show folder file is in.</li>
<li>If [ citeTest::URL &ne; "" or 
citeTest::ISBN &ne; ""  or 
citeTest::ISSN &ne; ""  or 
citeTest::URLdoi &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "Reference's Title: " &amp; citeTest::Title; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Open URL [ Case ( citeTest::URL &ne; "" ; citeTest::URL ;
citeTest::ISBN &ne; "" ; "http://www.worldcat.org/search?q=bn%3A" &amp; citeTest::ISBN ;
citeTest::ISSN &ne; "" ; "http://www.worldcat.org/ISSN/" &amp; citeTest::ISSN ;
citeTest::URLdoi &ne; "" ; "http://dx.doi.org/"  &amp; citeTest::URLdoi ;
"") ]
[ No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#Show folder file is in.</li>
<li>If [ refTest::URL &ne; "" or 
refTest::ISBN &ne; ""  or 
refTest::ISSN &ne; ""  or 
refTest::URLdoi &ne; "" ]</li>
<li>If [ ValueCount ( testlearnReportTags::kcreference ) &gt; 1 ]</li>
<li>Show Custom Dialog [ Message: "This is the first reference attached to this record.  To see all references, click the 'edit/new' button in the main list view window, and once you are in the Learn module, click the 'QV' button in the Learn window or the 'references' button in the Learn Tag Menus window."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>Show Custom Dialog [ Message: "Reference's Title: " &amp; refTest::Title; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Open URL [ Case ( refTest::URL &ne; "" ; refTest::URL ;
refTest::ISBN &ne; "" ; "http://www.worldcat.org/search?q=bn%3A" &amp; refTest::ISBN ;
refTest::ISSN &ne; "" ; "http://www.worldcat.org/ISSN/" &amp; refTest::ISSN ;
refTest::URLdoi &ne; "" ; "http://dx.doi.org/"  &amp; refTest::URLdoi ;
"") ]
[ No dialog ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>refReference</em>::URL</li>
<li>
<em>refReference</em>::ISBN</li>
<li>
<em>refReference</em>::ISSN</li>
<li>
<em>refReference</em>::URLdoi</li>
<li>
<em>testlearn</em>::kcreference</li>
<li>
<em>refReference</em>::Title</li>
<li>
<em>citeCite</em>::URL</li>
<li>
<em>citeCite</em>::ISBN</li>
<li>
<em>citeCite</em>::ISSN</li>
<li>
<em>citeCite</em>::URLdoi</li>
<li>
<em>citeCite</em>::Title</li>
<li>
<em>citeTest</em>::URL</li>
<li>
<em>citeTest</em>::ISBN</li>
<li>
<em>citeTest</em>::ISSN</li>
<li>
<em>citeTest</em>::URLdoi</li>
<li>
<em>citeTest</em>::Title</li>
<li>
<em>refTest</em>::URL</li>
<li>
<em>refTest</em>::ISBN</li>
<li>
<em>refTest</em>::ISSN</li>
<li>
<em>refTest</em>::URLdoi</li>
<li>
<em>testlearnReportTags</em>::kcreference</li>
<li>
<em>refTest</em>::Title</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33181ScriptAnchor_"></a><td class="script_navbar"><a href="#33242ScriptAnchor_"><span>Previous Script: [openCitationURL]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#33282ScriptAnchor_"><span>Next Script: [publisherCheckboxRadioButtonActionPart1]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">setCitationMatchForAuthors</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Variable [ $$citationMatch; Value:reference::referenceNodes ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::referenceNodes</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33282ScriptAnchor_"></a><td class="script_navbar"><a href="#33181ScriptAnchor_"><span>Previous Script: [setCitationMatchForAuthors]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#33287ScriptAnchor_"><span>Next Script: [insertTimeInRefTimeField]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">publisherCheckboxRadioButtonActionPart1</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ ValueCount ( reference::publisherTypeAlternative ) = 2 ]</li>
<li>Set Field [ reference::publisherTypeAlternative; Substitute ( reference::publisherTypeAlternative ; GetValue (reference::publisherTypeAlternative;1 ) &amp; "&para;"  ; "" ) ]</li>
<li>End If</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::publisherTypeAlternative</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33287ScriptAnchor_"></a><td class="script_navbar"><a href="#33282ScriptAnchor_"><span>Previous Script: [publisherCheckboxRadioButtonActionPart1]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#33288ScriptAnchor_"><span>Next Script: [goToRefRecord]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">insertTimeInRefTimeField</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ reference::TimeRange = "" ]</li>
<li>Set Field [ reference::TimeRange; "0:00:00" ]</li>
<li>End If</li>
<li>Perform Script [ &ldquo;clearCitationMatch&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::TimeRange</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33014ScriptAnchor_">clearCitationMatch</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33288ScriptAnchor_"></a><td class="script_navbar"><a href="#33287ScriptAnchor_"><span>Previous Script: [insertTimeInRefTimeField]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"><a href="#33290ScriptAnchor_"><span>Next Script: [helpReferenceFields]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">goToRefRecord</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Variable [ $refRecordNumber; Value:Get ( RecordNumber ) ]</li>
<li>Go to Record/Request/Page
[ Last ]</li>
<li>Go to Record/Request/Page [ $refRecordNumber ]
[ No dialog ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33290ScriptAnchor_"></a><td class="script_navbar"><a href="#33288ScriptAnchor_"><span>Previous Script: [goToRefRecord]</span></a></td><td class="script_navbar"><a href="#33315ScriptAnchor_"><span>Parent Folder: [reference(citation)]</span></a></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">helpReferenceFields</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Variable [ $objectName; Value:Middle ( Get ( ActiveLayoutObjectName ) ; 2 ; 2 ) ]</li>
<li>Set Field [ TEMP::Help; TEMP::Help [$objectName] ]</li>
<li>Go to Field [  ]</li>
<li>Select Window [ Name: "Reference Field Help"; Current file ]</li>
<li>If [ Get ( LastError ) &ne; 0 ]</li>
<li>New Window [ Name: "Reference Field Help"; Left: Get ( WindowWidth ) ]</li>
<li>End If</li>
<li>Go to Layout [ &ldquo;ReferenceHelp&rdquo; (reference) ]</li>
<li>Select Window [ Name: "Reference Field Help"; Current file ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::Help</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>ReferenceHelp</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<p>
<span class="partheading"><a name="33335ScriptAnchor_"></a><a href="#33335ScriptAnchor_toc">probablyNotInUse</a></span>
</p>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33210ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"><a href="#33335ScriptAnchor_"><span>Parent Folder: [probablyNotInUse]</span></a></td><td class="script_navbar"><a href="#32986ScriptAnchor_"><span>Next Script: [DELETE???loadRecordIDcitationlistlalyout]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">addReferenceNodesAndKeywords Copy</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>#</li>
<li>#Add current section key to reference record's </li>
<li>#section keychain if it is not on it already.</li>
<li>If [ TEMP::ksection &amp; "&para;" &ne; FilterValues ( reference::kcsection ; TEMP::ksection &amp; "&para;" ) and Get ( LayoutTableName ) = "reference" ]</li>
<li>Set Variable [ $sectionKeychain; Value:reference::kcsection ]</li>
<li>Set Field [ reference::kcsection; TEMP::ksection &amp; &para; &amp; $sectionKeychain ]</li>
<li>End If</li>
<li>#</li>
<li>#Add current section key to learn record's </li>
<li>#section keychain if it is not on it already.</li>
<li>If [ TEMP::ksection &amp; "&para;" &ne; FilterValues ( testlearn::kcsection ; TEMP::ksection &amp; "&para;" ) and Get ( LayoutTableName ) = "testlearn" ]</li>
<li>Set Variable [ $sectionKeychain; Value:testlearn::kcsection ]</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection &amp; &para; &amp; $sectionKeychain ]</li>
<li>End If</li>
<li>#</li>
<li>#Check main checkbox if record is not already</li>
<li>#a main record.  This is because when going to</li>
<li>#edit cite or reference records, only main records</li>
<li>#are shown by default.</li>
<li>If [ "main" &amp; "&para;" &ne; FilterValues ( reference::filterFind ; "main" &amp; "&para;" ) and 
Get ( LayoutTableName ) = "reference" and 
$$add &ne; 1 ]</li>
<li>Set Variable [ $filterFind; Value:reference::filterFind ]</li>
<li>Set Field [ reference::filterFind; "main" &amp; &para; &amp; $filterFind ]</li>
<li>#</li>
<li>Else If [ $$citationMatch &amp; "&para;" &ne; FilterValues ( reference::filterFind ; $$citationMatch &amp; "&para;" ) and 
Get ( LayoutTableName ) = "reference" and 
$$add = 1 ]</li>
<li>Set Variable [ $filterFind; Value:reference::filterFind ]</li>
<li>#</li>
<li>If [ $$citationMatch &ne; "key" ]</li>
<li>Set Field [ reference::filterFind; $$citationMatch &amp; &para; &amp; $filterFind ]</li>
<li>#</li>
<li>Else If [ $$citationMatch = "key" ]</li>
<li>Set Field [ reference::filterFind; "keyword" &amp; &para; &amp; $filterFind ]</li>
<li>End If</li>
<li>#</li>
<li>Else If [ "main" &amp; "&para;" &ne; FilterValues ( testlearn::filterFind ; "main" &amp; "&para;" ) and Get ( LayoutTableName ) = "testlearn" ]</li>
<li>Set Variable [ $filterFind; Value:testlearn::filterFind ]</li>
<li>Set Field [ testlearn::filterFind; "main" &amp; &para; &amp; $filterFind ]</li>
<li>End If</li>
<li>#</li>
<li>#Stop load tag record script to speed up this script.</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>Set Variable [ $$stopLoadCitation; Value:1 ]</li>
<li>#</li>
<li>#Remove focus from field so can see </li>
<li>#conditional formatting.</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Check if nodes and keywords linked to this </li>
<li>#reference record are in the current section</li>
<li>#or if the node is being used as a default.</li>
<li>If [ Get ( LayoutTableName ) = "reference" ]</li>
<li>Set Variable [ $nodePrimary; Value:reference::knodePrimary ]</li>
<li>Set Variable [ $nodeOther; Value:reference::knodeOther ]</li>
<li>Set Variable [ $keywordPrimary; Value:reference::kkeywordPrimary ]</li>
<li>Set Variable [ $keywordOther; Value:reference::kkeywordOther ]</li>
<li>Else If [ Get ( LayoutTableName ) = "testlearn" ]</li>
<li>Set Variable [ $nodePrimary; Value:testlearn::kNodePrimary ]</li>
<li>Set Variable [ $nodeOther; Value:testlearn::kNodeOther ]</li>
<li>Set Variable [ $keywordPrimary; Value:testlearn::kKeywordPrimary ]</li>
<li>Set Variable [ $keywordOther; Value:testlearn::kcKeywordOther ]</li>
<li>Else If [ Get ( LayoutTableName ) = "tagMenus" ]</li>
<li>Set Variable [ $nodePrimary; Value:TEMP::kdefaultNodePrimary ]</li>
<li>Set Variable [ $nodeOther; Value:TEMP::kdefaultNodeOther ]</li>
<li>End If</li>
<li>#</li>
<li>#Find all nodes assigned to this section.</li>
<li>#Find in a new window so user's place is not lost</li>
<li>#on Tag Menus window.</li>
<li>New Window [  ]</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>Go to Layout [ &ldquo;ltagNK1&rdquo; (tagMenus) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::match; "node" ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; "==" &amp; TEMP::ksection ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#PRIMARY NODE</li>
<li>#Loop thru records to find primary node.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>Loop</li>
<li>#</li>
<li>#If the key matches a lock or no locks exit the loop.</li>
<li>Exit Loop If [ $nodePrimary = tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#If the record the loop ended up on does not accept</li>
<li>#the primary key being tested, then add its</li>
<li>#group to the current section. ( Node groups are</li>
<li>#    are assigned to sections, not individual nodes. </li>
<li>#    So if the user wants one node to be assigned</li>
<li>#    to a new section, its group and all nodes in</li>
<li>#    its group must be assigned to the new section.</li>
<li>#    The reason for this is because the display of</li>
<li>#    nodes by catergory requires that each group</li>
<li>#    have a unique name and that each node belong</li>
<li>#    to a group.  For the node to be the same node</li>
<li>#    The group key it holds has to be the same as</li>
<li>#    well, which means the group has to appear</li>
<li>#    with the node, and with the group comes</li>
<li>#    all the nodes assigned to it. )</li>
<li>If [ $nodePrimary &ne; tagMenus::_Ltag ]</li>
<li>#</li>
<li>#Find the node to be added.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::_Ltag; $nodePrimary ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Next, add the current section key to this node's</li>
<li>#group's keychain.</li>
<li>Set Variable [ $groupSectionKeychain; Value:ruleTagMenuGroups::ksection ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; TEMP::ksection &amp; &para; &amp; $groupSectionKeychain ]</li>
<li>#</li>
<li>#Finally, refind all nodes, which now includes the</li>
<li>#node just added.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::match; "node" ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; "==" &amp; TEMP::ksection ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>End If</li>
<li>#</li>
<li>#OTHER NODES</li>
<li>#Determine how many keys there are to find for</li>
<li>#on the other nodes' keychain.</li>
<li>Set Variable [ $numberOfNodes; Value:ValueCount ( $nodeOther ) ]</li>
<li>#</li>
<li>#Loop thru each node record, with every key </li>
<li>#in the keychain.</li>
<li>Loop</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>#Exit the loop when there are no more keys to check.</li>
<li>Exit Loop If [ $numberOfNodes = 0 ]</li>
<li>Loop</li>
<li>#</li>
<li>#If the key matches a lock or no locks exit the loop.</li>
<li>#(  The get value calculation works by going to the</li>
<li>#    key in the list specified by the numberOfNodes</li>
<li>#    variable, set before entering the loops.</li>
<li>#    The system starts with the last key and with each</li>
<li>#    loop moves to the next key up, until there are</li>
<li>#    no more keys to check. )</li>
<li>Exit Loop If [ GetValue ( $nodeOther ; $numberOfNodes ) = tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#If the record the loop ended up on does not accept</li>
<li>#the other node key being tested, then add its</li>
<li>#group to the current section. ( Node groups are</li>
<li>#    are assigned to sections, not individual nodes. </li>
<li>#    So if the user wants one node to be assigned</li>
<li>#    to a new section, its group and all nodes in</li>
<li>#    its group must be assigned to the new section.</li>
<li>#    The reason for this is because the display of</li>
<li>#    nodes by catergory requires that each group</li>
<li>#    have a unique name and that each node belong</li>
<li>#    to a group.  For the node to be the same node</li>
<li>#    The group key it holds has to be the same as</li>
<li>#    well, which means the group has to appear</li>
<li>#    with the node, and with the group comes</li>
<li>#    all the nodes assigned to it. )</li>
<li>If [ GetValue ( $nodeOther ; $numberOfNodes ) &ne; tagMenus::_Ltag ]</li>
<li>#</li>
<li>#Find the node to be added.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::_Ltag; GetValue ( $nodeOther ; $numberOfNodes ) ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Next, add the current section key to this node's</li>
<li>#group's keychain.</li>
<li>Set Variable [ $groupSectionKeychain; Value:ruleTagMenuGroups::ksection ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; TEMP::ksection &amp; &para; &amp; $groupSectionKeychain ]</li>
<li>#</li>
<li>#Finally, refind all nodes, which now includes the</li>
<li>#node just added.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::match; "node" ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; "==" &amp; TEMP::ksection ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>End If</li>
<li>#</li>
<li>#Go the next key up from the bottom of the list</li>
<li>#of keys on this section's keychain.</li>
<li>Set Variable [ $numberOfNodes; Value:$numberOfNodes - 1 ]</li>
<li>End Loop</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#Find all keywords assigned to this section.</li>
<li>#Find in a new window so user's place is not lost</li>
<li>#on Tag Menus window.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::match; "key" ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; "==" &amp; TEMP::ksection ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#PRIMARY KEYWORD</li>
<li>#Loop thru records to find primary keyword.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>Loop</li>
<li>#</li>
<li>#If the key matches a lock or no locks exit the loop.</li>
<li>Exit Loop If [ $keywordPrimary = tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#If the record the loop ended up on does not accept</li>
<li>#the primary keyword being tested, then add its</li>
<li>#group to the current section. ( Keyword groups are</li>
<li>#    are assigned to sections, not individual keywords. </li>
<li>#    So if the user wants one keyword to be assigned</li>
<li>#    to a new section, its group and all keywords in</li>
<li>#    its group must be assigned to the new section.</li>
<li>#    The reason for this is because the display of</li>
<li>#    keywords by group requires that each group</li>
<li>#    have a unique name and that each keyword belong</li>
<li>#    to a group.  For the keyword to be the same</li>
<li>#    keyword, the group key it holds has to be </li>
<li>#    the same as well, which means the group </li>
<li>#    has to appear with the keyword, and with </li>
<li>#    the group comes all the keywords assigned to it. )</li>
<li>If [ $keywordPrimary &ne; tagMenus::_Ltag ]</li>
<li>#</li>
<li>#Find the keyword to be added.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::_Ltag; $keywordPrimary ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Next, add the current section key to this node's</li>
<li>#group's keychain.</li>
<li>Set Variable [ $groupSectionKeychain; Value:ruleTagMenuGroups::ksection ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; TEMP::ksection &amp; &para; &amp; $groupSectionKeychain ]</li>
<li>#</li>
<li>#Finally, refind all keywords, which now includes the</li>
<li>#keyword just added.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::match; "key" ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; "==" &amp; TEMP::ksection ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>End If</li>
<li>#</li>
<li>#OTHER KEYWORDS</li>
<li>#Determine how many keys there are to find for</li>
<li>#on the other keywords' keychain.</li>
<li>Set Variable [ $numberOfKeywords; Value:ValueCount ( $keywordOther ) ]</li>
<li>#</li>
<li>#Loop thru each keyword record, with every key </li>
<li>#in the keychain.</li>
<li>Loop</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>#Exit the loop when there are no more keys to check.</li>
<li>Exit Loop If [ $numberOfKeywords = 0 ]</li>
<li>Loop</li>
<li>#</li>
<li>#If the key matches a lock or no locks exit the loop.</li>
<li>#(  The get value calculation works by going to the</li>
<li>#    key in the list specified by the numberOfKeywords</li>
<li>#    variable, set before entering the loops.</li>
<li>#    The system starts with the last key and with each</li>
<li>#    loop moves to the next key up, until there are</li>
<li>#    no more keys to check. )</li>
<li>Exit Loop If [ GetValue ( $keywordOther ; $numberOfKeywords ) = tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#If the record the loop ended up on does not accept</li>
<li>#the primary keyword being tested, then add its</li>
<li>#group to the current section. ( Keyword groups are</li>
<li>#    are assigned to sections, not individual keywords. </li>
<li>#    So if the user wants one keyword to be assigned</li>
<li>#    to a new section, its group and all keywords in</li>
<li>#    its group must be assigned to the new section.</li>
<li>#    The reason for this is because the display of</li>
<li>#    keywords by group requires that each group</li>
<li>#    have a unique name and that each keyword belong</li>
<li>#    to a group.  For the keyword to be the same</li>
<li>#    keyword, the group key it holds has to be </li>
<li>#    the same as well, which means the group </li>
<li>#    has to appear with the keyword, and with </li>
<li>#    the group comes all the keywords assigned to it. )</li>
<li>If [ GetValue ( $keywordOther ; $numberOfKeywords ) &ne; tagMenus::_Ltag ]</li>
<li>#</li>
<li>#Find the keyword to be added.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::_Ltag; GetValue ( $keywordOther ; $numberOfKeywords ) ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Next, add the current section key to this keyword's</li>
<li>#group's keychain.</li>
<li>Set Variable [ $groupSectionKeychain; Value:ruleTagMenuGroups::ksection ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; TEMP::ksection &amp; &para; &amp; $groupSectionKeychain ]</li>
<li>#</li>
<li>#Finally, refind all keywords, which now includes the</li>
<li>#keyword just added.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::match; "key" ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; "==" &amp; TEMP::ksection ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>End If</li>
<li>#</li>
<li>#Go the next key up from the bottom of the list</li>
<li>#of keys on this section's keychain.</li>
<li>Set Variable [ $numberOfKeywords; Value:$numberOfKeywords - 1 ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Turn top load tag record script back on.</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>#</li>
<li>Close Window [ Current Window ]</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>reference</em>::kcsection</li>
<li>
<em>testlearn</em>::kcsection</li>
<li>
<em>reference</em>::filterFind</li>
<li>
<em>testlearn</em>::filterFind</li>
<li>
<em>reference</em>::knodePrimary</li>
<li>
<em>reference</em>::knodeOther</li>
<li>
<em>reference</em>::kkeywordPrimary</li>
<li>
<em>reference</em>::kkeywordOther</li>
<li>
<em>testlearn</em>::kNodePrimary</li>
<li>
<em>testlearn</em>::kNodeOther</li>
<li>
<em>testlearn</em>::kKeywordPrimary</li>
<li>
<em>testlearn</em>::kcKeywordOther</li>
<li>
<em>TEMP</em>::kdefaultNodePrimary</li>
<li>
<em>TEMP</em>::kdefaultNodeOther</li>
<li>
<em>tagMenus</em>::match</li>
<li>
<em>ruleTagMenuGroups</em>::ksection</li>
<li>
<em>tagMenus</em>::_Ltag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>ltagNK1</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32986ScriptAnchor_"></a><td class="script_navbar"><a href="#33210ScriptAnchor_"><span>Previous Script: [addReferenceNodesAndKeywords Copy]</span></a></td><td class="script_navbar"><a href="#33335ScriptAnchor_"><span>Parent Folder: [probablyNotInUse]</span></a></td><td class="script_navbar"><a href="#33280ScriptAnchor_"><span>Next Script: [loadCitation OLD]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">DELETE???loadRecordIDcitationlistlalyout</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#REMOVED it from use after it kept resetting ID number and messing up text formatting on main TL window.   It does not seem to be needed for an calc, but not sure entirely so have not deleted it yet.</li>
<li>#This first section is key to stopping this script</li>
<li>#when another script for example loops thru</li>
<li>#many records each of which would trigger this</li>
<li>#script and really slow down the program and</li>
<li>#create strobe effect that is really irritating to</li>
<li>#look at.</li>
<li>If [ $$stoploadCitation = 1 ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Set Variable [ $$recordID; Value:Get (RecordID) ]</li>
<li>Refresh Window</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33280ScriptAnchor_"></a><td class="script_navbar"><a href="#32986ScriptAnchor_"><span>Previous Script: [DELETE???loadRecordIDcitationlistlalyout]</span></a></td><td class="script_navbar"><a href="#33335ScriptAnchor_"><span>Parent Folder: [probablyNotInUse]</span></a></td><td class="script_navbar"><a href="#33285ScriptAnchor_"><span>Next Script: [findReferenceRecord Copy]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">loadCitation OLD</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#THIS OLD VERSION SCROLLS THE TAG MENU WINDOW</li>
<li>#TO THE TAG LISTED IN THE LEARN WINDOW IF ANY.</li>
<li>#</li>
<li>#This first section is key to stopping this script</li>
<li>#when another script for example loops thru</li>
<li>#many records each of which would trigger this</li>
<li>#script and really slow down the program and</li>
<li>#create strobe effect that is really irritating to</li>
<li>#look at.</li>
<li>If [ $$stoploadCitation = 1 ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#These steps effect the button action where when the</li>
<li>#use clicks on the actual text box of a learn record</li>
<li>#a new window opens just displaying the text.  This </li>
<li>#stops this when the user was clicking on it to select</li>
<li>#this record instead of adding text to it.</li>
<li>If [ Get (LayoutName) = "learn1" or 
Get (LayoutName) = "learn2" or 
Get (LayoutName) = "learn3" or 
Get (LayoutName) = "learn4" ]</li>
<li>Set Variable [ $$stopOpenNewTextWindow; Value:1 ]</li>
<li>End If</li>
<li>#</li>
<li>//  #Because I keep forgetting to press find mode, this</li>
<li>//  #bit of script is to confirm that the user really wants</li>
<li>//  #to add or change the tag of the first record instead of</li>
<li>//  #finding records with selected tag in the reference section.</li>
<li>//  Select Window [ Name: "References"; Current file ]</li>
<li>//  If [ Get (LayoutName) = "reference" and Get (RecordNumber) = 1 ]</li>
<li>//  Set Variable [ $$referenceRecordOne; Value:1 ]</li>
<li>//  Else</li>
<li>//  Set Variable [ $$referenceRecordOne ]</li>
<li>//  End If</li>
<li>#</li>
<li>#</li>
<li>#This key effects the conditional formatting </li>
<li>#of any records in the Tag Menus window</li>
<li>#that are related to the citation record that triggered</li>
<li>#this script (by the user click on it, of course).</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Set Variable [ $$citation; Value:testlearn::_Ltestlearn ]</li>
<li>If [ $$citationMatch = "node" ]</li>
<li>Set Variable [ $$tagTest ]</li>
<li>Set Variable [ $$tagSample ]</li>
<li>Else If [ $$citationMatch = "medium" ]</li>
<li>Set Variable [ $$citationItem; Value:testlearn::kmedium ]</li>
<li>Else If [ $$citationMatch = "Path" ]</li>
<li>Set Variable [ $$citationItem; Value:testlearn::kfolderPath ]</li>
<li>Set Variable [ $$tagTest ]</li>
<li>Set Variable [ $$tagSample ]</li>
<li>Else If [ $$citationMatch = "key" ]</li>
<li>Set Variable [ $$citationItem; Value:testlearn::kKeywordPrimary ]</li>
<li>Else If [ $$citationMatch = "health" ]</li>
<li>Set Variable [ $$tagTest ]</li>
<li>Set Variable [ $$tagSample ]</li>
<li>Set Variable [ $$citationItem; Value:testlearn::kHealth ]</li>
<li>Else If [ $$citationMatch = "cite" ]</li>
<li>Set Variable [ $$citationItem; Value:testlearn::kcitation ]</li>
<li>Set Variable [ $$tagTest ]</li>
<li>Set Variable [ $$tagSample ]</li>
<li>Else If [ $$citationMatch = "ref" ]</li>
<li>Set Variable [ $$citationItem; Value:testlearn::kcreference ]</li>
<li>Set Variable [ $$tagTest ]</li>
<li>Set Variable [ $$tagSample ]</li>
<li>Else If [ $$citationMatch = "test" ]</li>
<li>Set Variable [ $$citationItem; Value:testlearn::kctest ]</li>
<li>Else If [ $$citationMatch = "sample" ]</li>
<li>Set Variable [ $$citationItem; Value:testlearn::kcsample ]</li>
<li>End If</li>
<li>#</li>
<li>#capture keys of related tag menu items to</li>
<li>#to allow the citationMenu scripts to loop to the</li>
<li>#primary record of interest when the user navigates</li>
<li>#to a item on the Tag Menu window</li>
<li>#whose list of tags like node, keyword, medium, etc.</li>
<li>#might contain an item related to the current</li>
<li>#citation record, but which one, which is why all</li>
<li>#the keys have to be readied.  Mmm... now that </li>
<li>#I write this out, I'm thinking I could have the </li>
<li>#citationMenu scripts select the citation window</li>
<li>#to grab the key if any in the current current</li>
<li>#record that applies the the menu item.</li>
<li>Set Variable [ $$citationRecord; Value:testlearn::_Ltestlearn ]</li>
<li>Set Variable [ $$node; Value:testlearn::kNodeOther ]</li>
<li>Set Variable [ $$primaryNode; Value:testlearn::kNodePrimary ]</li>
<li>Set Variable [ $$medium; Value:testlearn::kmedium ]</li>
<li>Set Variable [ $$health; Value:testlearn::kHealth ]</li>
<li>Set Variable [ $$Path; Value:testlearn::kfolderPath ]</li>
<li>Set Variable [ $$cite; Value:testlearn::kcitation ]</li>
<li>Set Variable [ $$ref; Value:testlearn::kcreference ]</li>
<li>Set Variable [ $$PrimaryKey; Value:testlearn::kKeywordPrimary ]</li>
<li>Set Variable [ $$Key; Value:testlearn::kcKeywordOther ]</li>
<li>Set Variable [ $$OtherKey; Value:testlearn::kcKeywordOther ]</li>
<li>Set Variable [ $$Section; Value:testlearn::kcsection ]</li>
<li>Set Variable [ $$test; Value:testlearn::kctest ]</li>
<li>Set Variable [ $$sample; Value:testlearn::kcsample ]</li>
<li>Set Variable [ $$RecordID; Value:Get (RecordID) ]</li>
<li>Set Variable [ $windowName; Value:Get (WindowName) ]</li>
<li>Commit Records/Requests</li>
<li>#</li>
<li>If [ $$add = "" ]</li>
<li>#Match any records in tag window and go to</li>
<li>#primary tag record or to first record if none.</li>
<li>#And don't run LoadTagRecord until matching is</li>
<li>#done to prevent flashing and slowing down script.</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Go to Field [  ]</li>
<li>If [ Get (LastError)  = 112 ]</li>
<li>Perform Script [ &ldquo;TgotoCitationMenu&rdquo; ]</li>
<li>End If</li>
<li>Refresh Window</li>
<li>If [ $$citationMatch = "sample" ]</li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  Loop</li>
<li>//  Set Variable [ $number; Value:1 ]</li>
<li>//  Go to Field [  ]</li>
<li>//  Loop</li>
<li>//  Exit Loop If [ Middle ( GetValue ( $$sample ; $number ) ; 4 ; 42 )  &amp; "&para;"   = tagMenus::_Ltag &amp; &para; ]</li>
<li>//  Exit Loop If [ Middle ( GetValue ( $$sample ; $number ) ; 4 ; 42 )  = "" ]</li>
<li>//  Set Variable [ $add; Value:$number ]</li>
<li>//  Set Variable [ $number; Value:$add + 1 ]</li>
<li>//  End Loop</li>
<li>//  Exit Loop If [ Middle ( GetValue ( $$sample ; $number ) ; 4 ; 42 )  &amp; "&para;"   = tagMenus::_Ltag &amp; &para; ]</li>
<li>//  Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>//  End Loop</li>
<li>//  If [ Middle ( GetValue ( $$sample ; $number ) ; 4 ; 42 )  &amp; "&para;" &ne; tagMenus::_Ltag &amp; &para; ]</li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  End If</li>
<li>Else If [ $$citationMatch  = "test" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Variable [ $number; Value:1 ]</li>
<li>Go to Field [  ]</li>
<li>Loop</li>
<li>Exit Loop If [ Middle ( GetValue ( $$test ; $number ) ; 4 ; 42 )  &amp; "&para;"   = test::_Ltest &amp; &para; ]</li>
<li>Exit Loop If [ Middle ( GetValue ( $$test ; $number ) ; 4 ; 42 )  = "" ]</li>
<li>Set Variable [ $add; Value:$number ]</li>
<li>Set Variable [ $number; Value:$add + 1 ]</li>
<li>End Loop</li>
<li>Exit Loop If [ Middle ( GetValue ( $$test ; $number ) ; 4 ; 42 )  &amp; "&para;"   = test::_Ltest &amp; &para; ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>If [ Middle ( GetValue ( $$test ; $number ) ; 4 ; 42 )  &amp; "&para;" &ne; test::_Ltest &amp; &para; ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>End If</li>
<li>Else If [ $$citationMatch &ne; "sample" or $$citationMatch &ne; "test" ]</li>
<li>Freeze Window</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Loop</li>
<li>Exit Loop If [ tagMenus::_Ltag = $$citationItem or FilterValues ( $$sample ; tagMenus::_Ltag &amp; "&para;" ) = tagMenus::_Ltag &amp; &para; or 
FilterValues ( $$test ; test::_Ltest &amp; "&para;" ) = test::_Ltest &amp; &para;
 or 
reference::_Lreference  = $$citationitem  and $$citationMatch = "cite" or

reference::_Lreference &amp; "&para;"  = FilterValues ( $$ref ; reference::_Lreference &amp; "&para;" )  and $$citationMatch = "ref"
 or 
testlearn::_Ltestlearn  = $$citationitem  and $$citationMatch = "cite"or 

testlearn::_Ltestlearn &amp; "&para;"  = FilterValues ( $$ref ; testlearn::_Ltestlearn &amp; "&para;" )  and $$citationMatch = "ref"
 or 
tagMenus::_Ltag  = $$citationitem  and $$citationMatch = "node"  

or 

tagMenus::_Ltag  = $$citationitem  and $$citationMatch = "key" ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>If [ Get (LastError) = 101 ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>If [ Right (Get (LayoutName) ; 1 ) = "r" ]</li>
<li>Perform Script [ &ldquo;loadTagRecord&rdquo; ]</li>
<li>Else If [ $$citationMatch = "sample" ]</li>
<li>//  Perform Script [ &ldquo;loadItemRecordForLearnTagMenuDELETE!!!&rdquo; ]</li>
<li>Else If [ $$citationMatch = "test" ]</li>
<li>If [ testlearn::kctest &ne; "" ]</li>
<li>Perform Script [ &ldquo;loadItemRecordForTestTagMenu&rdquo; ]</li>
<li>End If</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Set Variable [ $$citation; Value:reference::_Lreference ]</li>
<li>If [ $$citationMatch = "node" ]</li>
<li>Set Variable [ $$citationItem; Value:reference::knodePrimary ]</li>
<li>Else If [ $$citationMatch = "medium" ]</li>
<li>Set Variable [ $$citationItem; Value:reference::kmedium ]</li>
<li>Else If [ $$citationMatch = "Path" ]</li>
<li>Set Variable [ $$citationItem; Value:reference::kfolderpath ]</li>
<li>Else If [ $$citationMatch = "key" ]</li>
<li>Set Variable [ $$citationItem; Value:reference::kkeywordPrimary ]</li>
<li>Else If [ $$citationMatch = "organ" ]</li>
<li>Set Variable [ $$citationItem; Value:reference::korgan ]</li>
<li>Else If [ $$citationMatch = "copyist" ]</li>
<li>Set Variable [ $$citationItem; Value:reference::kcopyist ]</li>
<li>Else If [ $$citationMatch = "health" ]</li>
<li>Set Variable [ $$citationItem; Value:reference::kHealth ]</li>
<li>Else If [ $$citationMatch = "cite" ]</li>
<li>Set Variable [ $$citationItem; Value:reference::kcitation ]</li>
<li>Else If [ $$citationMatch = "ref" ]</li>
<li>Set Variable [ $$citationItem; Value:testlearn::kcreference ]</li>
<li>End If</li>
<li>#</li>
<li>#capture keys of related tag menu items to</li>
<li>#to allow the citationMenu scripts to loop to the</li>
<li>#primary record of interest when the user navigates</li>
<li>#to a item on the Tag Menu window</li>
<li>#whose list of tags like node, keyword, medium, etc.</li>
<li>#might contain an item related to the current</li>
<li>#citation record, but which one, which is why all</li>
<li>#the keys have to be readied.  Mmm... now that </li>
<li>#I write this out, I'm thinking I could have the </li>
<li>#citationMenu scripts select the citation window</li>
<li>#to grab the key if any in the current current</li>
<li>#record that applies the the menu item.</li>
<li>Set Variable [ $$citationRecord; Value:reference::_Lreference ]</li>
<li>Set Variable [ $$node; Value:reference::knodeOther ]</li>
<li>Set Variable [ $$primaryNode; Value:reference::knodePrimary ]</li>
<li>Set Variable [ $$organ; Value:reference::korgan ]</li>
<li>Set Variable [ $$copyist; Value:reference::kcopyist ]</li>
<li>Set Variable [ $$medium; Value:reference::kmedium ]</li>
<li>Set Variable [ $$health; Value:reference::kHealth ]</li>
<li>Set Variable [ $$CopyrightType; Value:reference::kcopyrightType ]</li>
<li>Set Variable [ $$Path; Value:reference::kfolderpath ]</li>
<li>Set Variable [ $$cite; Value:reference::kcitation ]</li>
<li>Set Variable [ $$ref; Value:reference::lock ]</li>
<li>Set Variable [ $$PrimaryKey; Value:reference::kkeywordPrimary ]</li>
<li>Set Variable [ $$Key; Value:reference::kkeywordOther ]</li>
<li>Set Variable [ $$OtherKey; Value:reference::kkeywordOther ]</li>
<li>Set Variable [ $$RecordID; Value:Get (RecordID) ]</li>
<li>Set Variable [ $windowName; Value:Get (WindowName) ]</li>
<li>Commit Records/Requests</li>
<li>#</li>
<li>If [ $$add = "" ]</li>
<li>#Match any records in tag window and go to</li>
<li>#primary tag record or to first record if none.</li>
<li>#And don't run LoadTagRecord until matching is</li>
<li>#done to prevent flashing and slowing down script.</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>If [ Get (LastError)  = 112 ]</li>
<li>Perform Script [ &ldquo;TgotoCitationMenu&rdquo; ]</li>
<li>End If</li>
<li>Refresh Window</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>//  Loop</li>
<li>//  If [ Right ( Get (LayoutName) ; 5 ) = "menu1" ]</li>
<li>//  Exit Loop If [ $$citationItem = tagMenus::_Ltag ]</li>
<li>//  Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>//  End If</li>
<li>//  End Loop</li>
<li>//  If [ Right ( Get (LayoutName) ; 4 ) = "cite" ]</li>
<li>//  Exit Loop If [ $$citationItem = reference::_Lreference ]</li>
<li>//  Perform Script [ &ldquo;menuRefAddKeyWords&rdquo; ]</li>
<li>//  End If</li>
<li>//  #</li>
<li>//  If [ Right ( Get (LayoutName) ; 4 )  &ne;  "cite" and $$citationItem  &ne;  tagMenus::_Ltag ]</li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  Else If [ Right ( Get (LayoutName) ; 4 ) = "cite" and $$citationItem  &ne;  reference::_Lreference ]</li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  End If</li>
<li>Loop</li>
<li>Exit Loop If [ tagMenus::_Ltag = $$citationItem or FilterValues ( $$sample ; tagMenus::_Ltag &amp; "&para;" ) = tagMenus::_Ltag &amp; &para; or 
FilterValues ( $$test ; test::_Ltest &amp; "&para;" ) = test::_Ltest &amp; &para;
 or 
tagMenus::_Ltag  = $$citationitem  and $$citationMatch = "node"  

or 

tagMenus::_Ltag  = $$citationitem  and $$citationMatch = "key" ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>If [ Get (LastError) = 101 ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>End If</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Perform Script [ &ldquo;loadTagRecord&rdquo; ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Return to observation or reference window.</li>
<li>Select Window [ Name: $windowName; Current file ]</li>
<li>Refresh Window</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>testlearn</em>::_Ltestlearn</li>
<li>
<em>testlearn</em>::kmedium</li>
<li>
<em>testlearn</em>::kfolderPath</li>
<li>
<em>testlearn</em>::kKeywordPrimary</li>
<li>
<em>testlearn</em>::kHealth</li>
<li>
<em>testlearn</em>::kcitation</li>
<li>
<em>testlearn</em>::kcreference</li>
<li>
<em>testlearn</em>::kctest</li>
<li>
<em>testlearn</em>::kcsample</li>
<li>
<em>testlearn</em>::kNodeOther</li>
<li>
<em>testlearn</em>::kNodePrimary</li>
<li>
<em>testlearn</em>::kcKeywordOther</li>
<li>
<em>testlearn</em>::kcsection</li>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>test</em>::_Ltest</li>
<li>
<em>reference</em>::_Lreference</li>
<li>
<em>reference</em>::knodePrimary</li>
<li>
<em>reference</em>::kmedium</li>
<li>
<em>reference</em>::kfolderpath</li>
<li>
<em>reference</em>::kkeywordPrimary</li>
<li>
<em>reference</em>::korgan</li>
<li>
<em>reference</em>::kcopyist</li>
<li>
<em>reference</em>::kHealth</li>
<li>
<em>reference</em>::kcitation</li>
<li>
<em>reference</em>::knodeOther</li>
<li>
<em>reference</em>::kcopyrightType</li>
<li>
<em>reference</em>::lock</li>
<li>
<em>reference</em>::kkeywordOther</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32983ScriptAnchor_">TgotoCitationMenu</a></li>
<li><a href="#33038ScriptAnchor_">loadTagRecord</a></li>
<li><a href="#33126ScriptAnchor_">loadItemRecordForLearnTagMenuDELETE!!!</a></li>
<li><a href="#33127ScriptAnchor_">loadItemRecordForTestTagMenu</a></li>
<li><a href="#33042ScriptAnchor_">menuRefAddKeyWords</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33285ScriptAnchor_"></a><td class="script_navbar"><a href="#33280ScriptAnchor_"><span>Previous Script: [loadCitation OLD]</span></a></td><td class="script_navbar"><a href="#33335ScriptAnchor_"><span>Parent Folder: [probablyNotInUse]</span></a></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">findReferenceRecord Copy</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>If [ $$findMode &ne; "" ]</li>
<li>Show Custom Dialog [ Message: "Cancel find in Tag Menus window then click this button."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If user is in tag field and has changed spelling</li>
<li>#exit this tag record, otherwise current reference record</li>
<li>#will get deleted by the spelling check script.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Go to Field [  ]</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ $$referenceSort = 2 ]</li>
<li>Sort Records [ Specified Sort Order: reference::modifyDate; descending
reference::referenceForReferenceSort; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ $$referenceSort = "" ]</li>
<li>Sort Records [ Specified Sort Order: tagKeywordPrimary::tag; ascending
reference::referenceForReferenceSort; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ $$referenceSort = 1 ]</li>
<li>Sort Records [ Specified Sort Order: reference::createDate; descending
reference::referenceForReferenceSort; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>If [ Get (WindowMode) = 1 ]</li>
<li>Perform Find [  ]</li>
<li>Else</li>
<li>//  Close Window [ Name: "Find References"; Current file ]</li>
<li>//  Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>//  New Window [ Name: "Find References" ]</li>
<li>Set Variable [ $$findReferenceLayout; Value:Get (LayoutName) ]</li>
<li>Show/Hide Status Area
[ Hide ]</li>
<li>Enter Find Mode [  ]</li>
<li>Go to Layout [ &ldquo;ReferenceFIND&rdquo; (reference) ]</li>
<li>//  Set Variable [ $$stoploadCitation ]</li>
<li>Go to Field [ reference::referenceForReferenceSort ]</li>
<li>Pause/Resume Script [ Indefinitely ]</li>
<li>Perform Find [  ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Sort Records [  ]
[ No dialog ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::modifyDate</li>
<li>
<em>reference</em>::referenceForReferenceSort</li>
<li>
<em>tagKeywordPrimary</em>::tag</li>
<li>
<em>reference</em>::createDate</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>ReferenceFIND</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<p>
<span class="partheading"><a name="33321ScriptAnchor_"></a><a href="#33321ScriptAnchor_toc">sharedMainLayoutScripts</a></span>
</p>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33341ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"><a href="#33321ScriptAnchor_"><span>Parent Folder: [sharedMainLayoutScripts]</span></a></td><td class="script_navbar"><a href="#32985ScriptAnchor_"><span>Next Script: [backToLearnOrDefaultSetup]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">copyAndpastTags</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#</li>
<li>#This is a script I'm developing and is not on any</li>
<li>#layout yet.  Its purpose is to copy tags from a</li>
<li>#learn or reference record and then paste them</li>
<li>#in a different record.</li>
<li>If [ $$copyAndpastTagsPrimaryID = "" ]</li>
<li>Set Variable [ $$copyAndpastTagsPrimaryID; Value:reference::kkeywordPrimary ]</li>
<li>Set Variable [ $$copyAndpastTagsOtherID; Value:reference::kkeywordOther ]</li>
<li>Set Variable [ $$copyAndpastTagsOther; Value:reference::OtherKeyWords ]</li>
<li>Else</li>
<li>Set Field [ reference::kkeywordPrimary; $$copyAndpastTagsPrimaryID ]</li>
<li>Set Field [ reference::kkeywordOther; $$copyAndpastTagsOtherID ]</li>
<li>Set Field [ reference::OtherKeyWords; $$copyAndpastTagsOther ]</li>
<li>Set Variable [ $$copyAndpastTagsPrimaryID ]</li>
<li>Set Variable [ $$copyAndpastTagsOtherID ]</li>
<li>Set Variable [ $$copyAndpastTagsOther ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::kkeywordPrimary</li>
<li>
<em>reference</em>::kkeywordOther</li>
<li>
<em>reference</em>::OtherKeyWords</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32985ScriptAnchor_"></a><td class="script_navbar"><a href="#33341ScriptAnchor_"><span>Previous Script: [copyAndpastTags]</span></a></td><td class="script_navbar"><a href="#33321ScriptAnchor_"><span>Parent Folder: [sharedMainLayoutScripts]</span></a></td><td class="script_navbar"><a href="#33130ScriptAnchor_"><span>Next Script: [backFromSetup]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">backToLearnOrDefaultSetup</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33130ScriptAnchor_">backFromSetup</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>Set Variable [ $$referenceRecordOne ]</li>
<li>Set Variable [ $$referenceSort ]</li>
<li>Set Variable [ $$findMode ]</li>
<li>If [ Left ( $$defaultTagLayout ; 1 ) = "d" ]</li>
<li>#</li>
<li>#Go to testlearn layout and loop back to record.</li>
<li>Set Window Title [ Current Window; New Title: "Setup" ]</li>
<li>Go to Layout [ &ldquo;defaultSetup&rdquo; (tempSetup) ]</li>
<li>Show All Records</li>
<li>Delete All Records
[ No dialog ]</li>
<li>New Record/Request</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Check for any dragged changes to tag spellings.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>#organ</li>
<li>Perform Find [ Specified Find Requests: Find Records; Criteria: tagMenus::match: &ldquo;organ&rdquo; ]
[ Restore ]</li>
<li>#copyist</li>
<li>Extend Found Set [ Specified Find Requests: Find Records; Criteria: tagMenus::match: &ldquo;copyist&rdquo; ]
[ Restore ]</li>
<li>#heatlh</li>
<li>Extend Found Set [ Specified Find Requests: Find Records; Criteria: tagMenus::match: &ldquo;health&rdquo; ]
[ Restore ]</li>
<li>#node</li>
<li>Extend Found Set [ Specified Find Requests: Find Records; Criteria: tagMenus::match: &ldquo;node&rdquo; ]
[ Restore ]</li>
<li>Perform Script [ &ldquo;insureEqualityOfSpellFields&rdquo; ]</li>
<li>#</li>
<li>#Go to Learn tag menu layout and loop back to record.</li>
<li>Set Variable [ $$stopAddTagToCitation; Value:1 ]</li>
<li>Go to Layout [ &ldquo;defaultSections&rdquo; (ruleSection) ]</li>
<li>Go to Record/Request/Page [ $$defaultRecordNumber ]
[ No dialog ]</li>
<li>Set Variable [ $$stopAddTagToCitation ]</li>
<li>Set Variable [ $$defaultRecordNumber ]</li>
<li>Set Variable [ $$defaultTagLayout ]</li>
<li>Set Variable [ $$citationMatch; Value:"section" ]</li>
<li>Perform Script [ &ldquo;defaultSectionMenu&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Go to testlearn layout and loop back to record.</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>Set Window Title [ Current Window; New Title: "Learn" ]</li>
<li>If [ tempSetup::layoutLmain = "" ]</li>
<li>Go to Layout [ &ldquo;learn1&rdquo; (testlearn) ]</li>
<li>Set Field [ TEMP::layoutLmain; "more" &amp; Get (LayoutName) ]</li>
<li>Else If [ tempSetup::layoutLmain &ne; "" ]</li>
<li>Go to Layout [ Middle ( tempSetup::layoutLmain ; 5 ; 42 ) ]</li>
<li>End If</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: testlearn::date; descending
testlearn::timestamp; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$LearnEdit  = testlearn::_Ltestlearn ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>#</li>
<li>#Go to Learn tag menu layout and loop back to record.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>#</li>
<li>Go to Layout [ $$learnTagLayout ]</li>
<li>Set Variable [ $$learnTagLayout ]</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>If [ $$citeORref = "ref" ]</li>
<li>Perform Script [ &ldquo;menuReference&rdquo; ]</li>
<li>Else</li>
<li>Perform Script [ &ldquo;menuRefAddKeyWords&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>If [ $$citeORref = "cite" ]</li>
<li>Set Variable [ $$citationMatch; Value:"cite" ]</li>
<li>Else If [ $$citeORref = "ref" ]</li>
<li>Set Variable [ $$citationMatch; Value:"ref" ]</li>
<li>End If</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>#</li>
<li>#Perform Load Citation script to restore conditional</li>
<li>#formatting.</li>
<li>Perform Script [ &ldquo;loadCitation&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tagMenus</em>::match</li>
<li>
<em>tempSetup</em>::layoutLmain</li>
<li>
<em>TEMP</em>::layoutLmain</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>testlearn</em>::kcsection</li>
<li>
<em>testlearn</em>::date</li>
<li>
<em>testlearn</em>::timestamp</li>
<li>
<em>testlearn</em>::_Ltestlearn</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33227ScriptAnchor_">insureEqualityOfSpellFields</a></li>
<li><a href="#33090ScriptAnchor_">defaultSectionMenu</a></li>
<li><a href="#33064ScriptAnchor_">menuReference</a></li>
<li><a href="#33042ScriptAnchor_">menuRefAddKeyWords</a></li>
<li><a href="#32984ScriptAnchor_">loadCitation</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>defaultSetup</li>
<li>defaultSections</li>
<li>learn1</li>
<li>&lt;Missing Layout&gt;</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33130ScriptAnchor_"></a><td class="script_navbar"><a href="#32985ScriptAnchor_"><span>Previous Script: [backToLearnOrDefaultSetup]</span></a></td><td class="script_navbar"><a href="#33321ScriptAnchor_"><span>Parent Folder: [sharedMainLayoutScripts]</span></a></td><td class="script_navbar"><a href="#33096ScriptAnchor_"><span>Next Script: [toggleMainWindowView]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">backFromSetup</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>#</li>
<li>#Insure that all locked fields are revereted back if changed.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Perform Script [ &ldquo;insureEqualityOfSpellFields&rdquo; ]</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>Perform Script [ &ldquo;insureEqualityOfSpellFields&rdquo; ]</li>
<li>#</li>
<li>#Return to default setup module from...</li>
<li>If [ Left ( $$module ; 1 ) = "l" ]</li>
<li>Perform Script [ &ldquo;backToLearnOrDefaultSetup&rdquo; ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Go to Layout [ &ldquo;learnMenu1&rdquo; (tagMenus) ]</li>
<li>Perform Script [ &ldquo;menuTest&rdquo; ]</li>
<li>Set Variable [ $$module ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ Left ( $$module ; 1 ) = "d" ]</li>
<li>#</li>
<li>#For returning from the test setup module, find</li>
<li>#and delete all temp records that may have been</li>
<li>#created while setuping up or deleting tests and</li>
<li>#then create one new temp record to show the user</li>
<li>#the default selections from the global fields whose</li>
<li>#contents cannot be deleted even when all records</li>
<li>#containing them are deleted.  With a new record</li>
<li>#any info in their global fields will go into a</li>
<li>#newly created record.</li>
<li>Go to Layout [ &ldquo;defaultSetup&rdquo; (tempSetup) ]</li>
<li>Show All Records</li>
<li>Delete All Records
[ No dialog ]</li>
<li>New Record/Request</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Return to test setup layout on the Tag Menus</li>
<li>#window, and clear the global fields needed for</li>
<li>#creating and deleting tests in the test setup module.</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Go to Layout [ &ldquo;defaultTest&rdquo; (tagTestSubjectLocation) ]</li>
<li>Set Field [ TEMP::ktest; "" ]</li>
<li>Set Field [ TEMP::ktestItemList; "" ]</li>
<li>Set Field [ TEMP::ktestItemListOLD; "" ]</li>
<li>Set Field [ TEMP::ktestListtTestName; "" ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Perform Script [ &ldquo;returnToSetup&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::ktest</li>
<li>
<em>TEMP</em>::ktestItemList</li>
<li>
<em>TEMP</em>::ktestItemListOLD</li>
<li>
<em>TEMP</em>::ktestListtTestName</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33227ScriptAnchor_">insureEqualityOfSpellFields</a></li>
<li><a href="#32985ScriptAnchor_">backToLearnOrDefaultSetup</a></li>
<li><a href="#33068ScriptAnchor_">menuTest</a></li>
<li><a href="#32891ScriptAnchor_">returnToSetup</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>learnMenu1</li>
<li>defaultSetup</li>
<li>defaultTest</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33096ScriptAnchor_"></a><td class="script_navbar"><a href="#33130ScriptAnchor_"><span>Previous Script: [backFromSetup]</span></a></td><td class="script_navbar"><a href="#33321ScriptAnchor_"><span>Parent Folder: [sharedMainLayoutScripts]</span></a></td><td class="script_navbar"><a href="#33081ScriptAnchor_"><span>Next Script: [returnToAddRecordPUTONHOLD!!!!]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">toggleMainWindowView</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Reveal more or fewer pictures and links for tag.</li>
<li>#First toggle from current view to next view.</li>
<li>#Turn off loadRecord script to speed up process.</li>
<li>Set Variable [ $$stopLoadCitation; Value:1 ]</li>
<li>#</li>
<li>#from 1 to 2</li>
<li>If [ Right ( Get (LayoutName)  ; 1) = 1
and 
Left ( TEMP::layoutLmain ; 4 ) = "more" ]</li>
<li>Go to Layout [ &ldquo;learn2&rdquo; (testlearn) ]</li>
<li>#from 2 to 3</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 2
and 
Left ( TEMP::layoutLmain ; 4 ) = "more" ]</li>
<li>Go to Layout [ &ldquo;learn3&rdquo; (testlearn) ]</li>
<li>#from 3 to 4</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 3
and 
Left ( TEMP::layoutLmain ; 4 ) = "more" ]</li>
<li>Go to Layout [ &ldquo;learn4&rdquo; (testlearn) ]</li>
<li>#from 4 to 3</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 4
and 
Left ( TEMP::layoutLmain ; 4 ) = "less" ]</li>
<li>Go to Layout [ &ldquo;learn3&rdquo; (testlearn) ]</li>
<li>#from 3 to 2</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 3
and 
Left ( TEMP::layoutLmain ; 4 ) = "less" ]</li>
<li>Go to Layout [ &ldquo;learn2&rdquo; (testlearn) ]</li>
<li>#from 2 to 1</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 2
and 
Left ( TEMP::layoutLmain ; 4 ) = "less" ]</li>
<li>Go to Layout [ &ldquo;learn1&rdquo; (testlearn) ]</li>
<li>End If</li>
<li>#</li>
<li>#Remember layout user is on so they can be</li>
<li>#returned to correct view.</li>
<li>#Turn on loadRecord script needed for other scripts.</li>
<li>Set Variable [ $$stopLoadCitation ]</li>
<li>#</li>
<li>#from 1 to 2</li>
<li>If [ Right ( Get (LayoutName)  ; 1) = 2
and 
Left ( TEMP::layoutLmain ; 4 ) = "more" ]</li>
<li>Set Field [ TEMP::layoutLmain; "more" &amp; Get (LayoutName) ]</li>
<li>#from 2 to 3</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 3
and 
Left ( TEMP::layoutLmain ; 4 ) = "more" ]</li>
<li>Set Field [ TEMP::layoutLmain; "more" &amp; Get (LayoutName) ]</li>
<li>#from 3 to 4</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 4
and 
Left ( TEMP::layoutLmain ; 4 ) = "more" ]</li>
<li>Set Field [ TEMP::layoutLmain; "less" &amp; Get (LayoutName) ]</li>
<li>#from 4 to 3</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 3
and 
Left ( TEMP::layoutLmain ; 4 ) = "less" ]</li>
<li>Set Field [ TEMP::layoutLmain; "less" &amp; Get (LayoutName) ]</li>
<li>#from 3 to 2</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 2
and 
Left ( TEMP::layoutLmain ; 4 ) = "less" ]</li>
<li>Set Field [ TEMP::layoutLmain; "less" &amp; Get (LayoutName) ]</li>
<li>#from 2 to 1</li>
<li>Else If [ Right ( Get (LayoutName)  ; 1) = 1
and 
Left ( TEMP::layoutLmain ; 4 ) = "less" ]</li>
<li>Set Field [ TEMP::layoutLmain; "more" &amp; Get (LayoutName) ]</li>
<li>End If</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::layoutLmain</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>learn2</li>
<li>learn3</li>
<li>learn4</li>
<li>learn1</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33081ScriptAnchor_"></a><td class="script_navbar"><a href="#33096ScriptAnchor_"><span>Previous Script: [toggleMainWindowView]</span></a></td><td class="script_navbar"><a href="#33321ScriptAnchor_"><span>Parent Folder: [sharedMainLayoutScripts]</span></a></td><td class="script_navbar"><a href="#33093ScriptAnchor_"><span>Next Script: [gotoTimeLogMainWindow]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">returnToAddRecordPUTONHOLD!!!!</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#I've decided to not continue finishing this script.</li>
<li>#The idea was if the user navigated away from</li>
<li>#the record they came into add mode to add to</li>
<li>#this script would  focus back on that record.</li>
<li>#Part of the reason for this was that in add mode</li>
<li>#The database was set to just keyword or node</li>
<li>#in terms of noting the FilterFind field.  But that</li>
<li>#has now been made by dynamic by tying this noting</li>
<li>#to the citation match field.  If later on this seems</li>
<li>#useful this script can be polished for use.  Right</li>
<li>#now it just seems like giving the user too much</li>
<li>#help, which looks like to many buttons on the layout!</li>
<li>#</li>
<li>If [ $$addCitationMatch = "node" and $$addCitationMatch &ne; $$CitationMatch ]</li>
<li>#</li>
<li>#</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>#</li>
<li>#Set citationMatch to color menu button with inUse color.</li>
<li>Set Variable [ $$citationMatch; Value:"node" ]</li>
<li>#</li>
<li>#Do not load tag records until the end of script</li>
<li>#to prevent flashing of window and to speed up</li>
<li>#script.</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>#</li>
<li>#Goto correct layout.</li>
<li>If [ TEMP::layoutRtagN = "" or TEMP::layoutLtagN = "" ]</li>
<li>If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>Go to Layout [ &ldquo;ltagNK2&rdquo; (tagMenus) ]</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "r" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenu2keywordOrNode1&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>#</li>
<li>Else If [ TEMP::layoutRtagN &ne; "" or TEMP::layoutLtagN &ne; "" ]</li>
<li>If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>Go to Layout [ TEMP::layoutLtagN ]</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "r" ]</li>
<li>Go to Layout [ TEMP::layoutRtagN ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Find node tags. </li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::match; $$citationMatch ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; "==" &amp; TEMP::ksection ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#If no records exist then create one.</li>
<li>If [ Get (FoundCount)=0 ]</li>
<li>Perform Script [ &ldquo;newCitationMenuGroup&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>#Sort according to current users wishes.  By default</li>
<li>#the sort will be by category which is set by editCitation script.</li>
<li>If [ TEMP::sortNode = "cat" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ TEMP::sortNode = "abc" ]</li>
<li>Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$addRecord = tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Inform user of items use on both screens.</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Perform Script [ &ldquo;loadTagRecord&rdquo; ]</li>
<li>#</li>
<li>#Just in case user was in nonTag field on this</li>
<li>#window when user clicked a menu button on </li>
<li>#the other window, exit all  fields.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $$citationItem; Value:testlearn::kNodePrimary ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $$citationItem; Value:reference::knodePrimary ]</li>
<li>End If</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>Else If [ $$addCitationMatch = "key" and $$addCitationMatch &ne; $$CitationMatch ]</li>
<li>#</li>
<li>#Set citationMatch to color menu button with inUse color.</li>
<li>Set Variable [ $$citationMatch; Value:"key" ]</li>
<li>#</li>
<li>#Do not load tag records until the end of script</li>
<li>#to prevent flashing of window and to speed up</li>
<li>#script.</li>
<li>Set Variable [ $$stopLoadTagRecord; Value:1 ]</li>
<li>#</li>
<li>#Goto correct layout.</li>
<li>If [ TEMP::layoutRtagK = "" or TEMP::layoutLtagK = "" ]</li>
<li>If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>Go to Layout [ &ldquo;ltagNK2&rdquo; (tagMenus) ]</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "r" ]</li>
<li>Go to Layout [ &ldquo;ReferenceMenu2keywordOrNode1&rdquo; (tagMenus) ]</li>
<li>End If</li>
<li>#</li>
<li>Else If [ TEMP::layoutRtagK &ne; "" or TEMP::layoutLtagK &ne; "" ]</li>
<li>If [ Left (Get (LayoutName) ; 1) = "l" ]</li>
<li>Go to Layout [ TEMP::layoutLtagK ]</li>
<li>Else If [ Left (Get (LayoutName) ; 1) = "r" ]</li>
<li>Go to Layout [ TEMP::layoutRtagK ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Find key tags for library section.  </li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::match; $$citationMatch ]</li>
<li>Set Field [ ruleTagMenuGroups::ksection; "==" &amp; TEMP::ksection ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#If no records exist then create one.</li>
<li>If [ Get (FoundCount)=0 ]</li>
<li>Perform Script [ &ldquo;newCitationMenuGroup&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>#Sort according to current users wishes.  By default</li>
<li>#the sort will be by category which is set by editCitation script.</li>
<li>If [ TEMP::sortKey = "cat" ]</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>Else If [ TEMP::sortKey = "abc" ]</li>
<li>Sort Records [ Specified Sort Order: tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$addRecord = tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Inform user of items use on both screens.</li>
<li>Set Variable [ $$stopLoadTagRecord ]</li>
<li>Perform Script [ &ldquo;loadTagRecord&rdquo; ]</li>
<li>#</li>
<li>#Just in case user was in nonTag field on this</li>
<li>#window when user clicked a menu button on </li>
<li>#the other window, exit all  fields.</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $$citationItem; Value:testlearn::kKeywordPrimary ]</li>
<li>Else If [ Get (LastError) &ne; 112 ]</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $$citationItem; Value:reference::kkeywordPrimary ]</li>
<li>End If</li>
<li>Refresh Window</li>
<li>#</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Refresh Window</li>
<li>Else If [ $$addCitationMatch = "testItem" and $$addCitationMatch &ne; $$CitationMatch ]</li>
<li>#</li>
<li>#Goto correct layout.</li>
<li>If [ TEMP::DetailmoreORLessLayout = "" ]</li>
<li>Go to Layout [ &ldquo;setupTestItem&rdquo; (tagMenus) ]</li>
<li>Else If [ TEMP::DetailmoreORLessLayout &ne; "" ]</li>
<li>Go to Layout [ TEMP::DetailmoreORLessLayout ]</li>
<li>End If</li>
<li>Set Variable [ $$citationMatch; Value:"testItem" ]</li>
<li>#</li>
<li>#Find detail tags for library section.  </li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ tagMenus::kGroupOrTest; TEMP::ktestItemList ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#If no records exist then create one.</li>
<li>If [ Get (FoundCount)=0 ]</li>
<li>Perform Script [ &ldquo;newCitationMenuGroup&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>Sort Records [ Specified Sort Order: ruleTagMenuTestGroups::order; based on value list: &ldquo;order&rdquo;
ruleTagMenuTestGroups::name; ascending
tagMenus::orderOrLock; based on value list: &ldquo;order&rdquo;
tagMenus::tag; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$addRecord = tagMenus::_Ltag ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::layoutRtagN</li>
<li>
<em>TEMP</em>::layoutLtagN</li>
<li>
<em>tagMenus</em>::match</li>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>ruleTagMenuGroups</em>::ksection</li>
<li>
<em>TEMP</em>::sortNode</li>
<li>
<em>ruleTagMenuGroups</em>::order</li>
<li>
<em>ruleTagMenuGroups</em>::name</li>
<li>
<em>tagMenus</em>::orderOrLock</li>
<li>
<em>tagMenus</em>::tag</li>
<li>
<em>tagMenus</em>::_Ltag</li>
<li>
<em>testlearn</em>::kNodePrimary</li>
<li>
<em>reference</em>::knodePrimary</li>
<li>
<em>TEMP</em>::layoutRtagK</li>
<li>
<em>TEMP</em>::layoutLtagK</li>
<li>
<em>TEMP</em>::sortKey</li>
<li>
<em>testlearn</em>::kKeywordPrimary</li>
<li>
<em>reference</em>::kkeywordPrimary</li>
<li>
<em>TEMP</em>::DetailmoreORLessLayout</li>
<li>
<em>TEMP</em>::ktestItemList</li>
<li>
<em>tagMenus</em>::kGroupOrTest</li>
<li>
<em>ruleTagMenuTestGroups</em>::order</li>
<li>
<em>ruleTagMenuTestGroups</em>::name</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32980ScriptAnchor_">newCitationMenuGroup</a></li>
<li><a href="#33038ScriptAnchor_">loadTagRecord</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>ltagNK2</li>
<li>ReferenceMenu2keywordOrNode1</li>
<li>&lt;Missing Layout&gt;</li>
<li>setupTestItem</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33093ScriptAnchor_"></a><td class="script_navbar"><a href="#33081ScriptAnchor_"><span>Previous Script: [returnToAddRecordPUTONHOLD!!!!]</span></a></td><td class="script_navbar"><a href="#33321ScriptAnchor_"><span>Parent Folder: [sharedMainLayoutScripts]</span></a></td><td class="script_navbar"><a href="#33116ScriptAnchor_"><span>Next Script: [gotoTimeLogLogWindow]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">gotoTimeLogMainWindow</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Field [ MemorySwitch::currentLibraryMainWIndow; Get ( WindowName ) ]</li>
<li>Set Field [ MemorySwitch::currentLibraryPath; Get ( FilePath ) ]</li>
<li>Select Window [ Name: "Tag" ]</li>
<li>Select Window [ Name: "Day" ]</li>
<li>Select Window [ Name: "Specific Action" ]</li>
<li>Select Window [ Name: "Timer" ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Set Variable [ $timer; Value:Get (LastError) ]</li>
<li>End If</li>
<li>Select Window [ Name: "HelpGiveThanks Apps" ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Set Variable [ $app; Value:Get (LastError) ]</li>
<li>End If</li>
<li>If [ $timer  +  $app = 224 ]</li>
<li>Open URL [ Substitute ( MemorySwitch::helpPath ; "help" ; "actionLog82" ) ]
[ No dialog ]</li>
<li>Open URL [ Substitute ( MemorySwitch::helpPath ; "help" ; "actionLog" ) ]
[ No dialog ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>MemorySwitch</em>::currentLibraryMainWIndow</li>
<li>
<em>MemorySwitch</em>::currentLibraryPath</li>
<li>
<em>MemorySwitch</em>::helpPath</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33116ScriptAnchor_"></a><td class="script_navbar"><a href="#33093ScriptAnchor_"><span>Previous Script: [gotoTimeLogMainWindow]</span></a></td><td class="script_navbar"><a href="#33321ScriptAnchor_"><span>Parent Folder: [sharedMainLayoutScripts]</span></a></td><td class="script_navbar"><a href="#33186ScriptAnchor_"><span>Next Script: [stopScriptOniPhone]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">gotoTimeLogLogWindow</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Select Window [ Name: "Issues Log" ]</li>
<li>Select Window [ Name: "Activity Log" ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33186ScriptAnchor_"></a><td class="script_navbar"><a href="#33116ScriptAnchor_"><span>Previous Script: [gotoTimeLogLogWindow]</span></a></td><td class="script_navbar"><a href="#33321ScriptAnchor_"><span>Parent Folder: [sharedMainLayoutScripts]</span></a></td><td class="script_navbar"><a href="#33195ScriptAnchor_"><span>Next Script: [closeWindow]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">stopScriptOniPhone</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ PatternCount ( Get ( ApplicationVersion ) ; "GO" ) ]</li>
<li>Go to Layout [ &ldquo;defaultSetup Copy&rdquo; (tempSetup) ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>defaultSetup Copy</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33195ScriptAnchor_"></a><td class="script_navbar"><a href="#33186ScriptAnchor_"><span>Previous Script: [stopScriptOniPhone]</span></a></td><td class="script_navbar"><a href="#33321ScriptAnchor_"><span>Parent Folder: [sharedMainLayoutScripts]</span></a></td><td class="script_navbar"><a href="#33338ScriptAnchor_"><span>Next Script: [closeWindowHaltScript]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">closeWindow</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Go to Field [  ]</li>
<li>Show/Hide Text Ruler
[ Hide ]</li>
<li>Close Window [ Current Window ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33338ScriptAnchor_"></a><td class="script_navbar"><a href="#33195ScriptAnchor_"><span>Previous Script: [closeWindow]</span></a></td><td class="script_navbar"><a href="#33321ScriptAnchor_"><span>Parent Folder: [sharedMainLayoutScripts]</span></a></td><td class="script_navbar"><a href="#32932ScriptAnchor_"><span>Next Script: [backtoSetup]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">closeWindowHaltScript</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Close Window [ Current Window ]</li>
<li>Halt Script</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32932ScriptAnchor_"></a><td class="script_navbar"><a href="#33338ScriptAnchor_"><span>Previous Script: [closeWindowHaltScript]</span></a></td><td class="script_navbar"><a href="#33321ScriptAnchor_"><span>Parent Folder: [sharedMainLayoutScripts]</span></a></td><td class="script_navbar"><a href="#33070ScriptAnchor_"><span>Next Script: [learn]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">backtoSetup</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Go to Layout [ &ldquo;testSetup&rdquo; (test) ]</li>
<li>Set Variable [ $$first ]</li>
<li>Set Variable [ $$last ]</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>testSetup</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33070ScriptAnchor_"></a><td class="script_navbar"><a href="#32932ScriptAnchor_"><span>Previous Script: [backtoSetup]</span></a></td><td class="script_navbar"><a href="#33321ScriptAnchor_"><span>Parent Folder: [sharedMainLayoutScripts]</span></a></td><td class="script_navbar"><a href="#32811ScriptAnchor_"><span>Next Script: [Exit]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">learn</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>#</li>
<li>If [ TEMP::ksection = "" ]</li>
<li>Show Custom Dialog [ Message: "Select a section from the Tag Menus window for records that you create to be placed into."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Halt Script</li>
<li>Else If [ tempSetup::kdefaultHealth = "" ]</li>
<li>Show Custom Dialog [ Message: "Select the default copyright for any new records that you create by clicking the copyright button (you can always change your mind)."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Halt Script</li>
<li>Else If [ tempSetup::kdefaultNodePrimary = "" ]</li>
<li>Show Custom Dialog [ Message: "Select yourself (the node responsible for creating new records) by clicking the node button."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#Make sure creator node's group is part of section group.</li>
<li>Perform Script [ &ldquo;addBackSectionCreatorNode&rdquo; ]</li>
<li>#</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>Set Window Title [ Current Window; New Title: "Learn" ]</li>
<li>Set Variable [ $$stoploadCitation; Value:1 ]</li>
<li>If [ tempSetup::layoutLmain = "" ]</li>
<li>Go to Layout [ &ldquo;learn1&rdquo; (testlearn) ]</li>
<li>Set Field [ TEMP::layoutLmain; "more" &amp; Get (LayoutName) ]</li>
<li>Else If [ tempSetup::layoutLmain &ne; "" ]</li>
<li>Go to Layout [ Middle ( tempSetup::layoutLmain ; 5 ; 42 ) ]</li>
<li>End If</li>
<li>Enter Find Mode [  ]</li>
<li>#</li>
<li>#now find and show all canned inspection items associated with this generic canned location</li>
<li>Set Field [ testlearn::kcsection; TEMP::ksection ]</li>
<li>Set Field [ testlearn::filterFind; "main" &amp; &para; ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: testlearn::date; descending
testlearn::timestamp; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Select Window [ Name: "Tag Menus"; Current file ]</li>
<li>Go to Layout [ &ldquo;ltagNK2&rdquo; (tagMenus) ]</li>
<li>Perform Script [ &ldquo;menuKey&rdquo; ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Set Variable [ $$stoploadCitation ]</li>
<li>Perform Script [ &ldquo;loadCitation&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>TEMP</em>::ksection</li>
<li>
<em>tempSetup</em>::kdefaultHealth</li>
<li>
<em>tempSetup</em>::kdefaultNodePrimary</li>
<li>
<em>tempSetup</em>::layoutLmain</li>
<li>
<em>TEMP</em>::layoutLmain</li>
<li>
<em>testlearn</em>::kcsection</li>
<li>
<em>testlearn</em>::filterFind</li>
<li>
<em>testlearn</em>::date</li>
<li>
<em>testlearn</em>::timestamp</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33245ScriptAnchor_">addBackSectionCreatorNode</a></li>
<li><a href="#32993ScriptAnchor_">menuKey</a></li>
<li><a href="#32984ScriptAnchor_">loadCitation</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>learn1</li>
<li>&lt;Missing Layout&gt;</li>
<li>ltagNK2</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32811ScriptAnchor_"></a><td class="script_navbar"><a href="#33070ScriptAnchor_"><span>Previous Script: [learn]</span></a></td><td class="script_navbar"><a href="#33321ScriptAnchor_"><span>Parent Folder: [sharedMainLayoutScripts]</span></a></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">Exit</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<p>
<span class="partheading"><a name="33266ScriptAnchor_"></a><a href="#33266ScriptAnchor_toc">help</a></span>
</p>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33271ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"><a href="#33266ScriptAnchor_"><span>Parent Folder: [help]</span></a></td><td class="script_navbar"><a href="#33248ScriptAnchor_"><span>Next Script: [help]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">helpBack</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#This script functions like a browsers back button </li>
<li>#script, taking users back thru help windows bread </li>
<li>#crumb style.</li>
<li>If [ ValueCount ( tempSetup::helpName ) = 1 ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Set Variable [ $value1; Value:GetValue ( tempSetup::helpName ; ValueCount ( tempSetup::helpName ) ) ]</li>
<li>Set Field [ tempSetup::helpName; Substitute ( $value1 ; tempSetup::helpName ; "" &amp;&para; ) ]</li>
<li>Set Variable [ $value1; Value:GetValue ( tempSetup::helpName ; 1 ) ]</li>
<li>Go to Layout [ $value1 ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>tempSetup</em>::helpName</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33248ScriptAnchor_"></a><td class="script_navbar"><a href="#33271ScriptAnchor_"><span>Previous Script: [helpBack]</span></a></td><td class="script_navbar"><a href="#33266ScriptAnchor_"><span>Parent Folder: [help]</span></a></td><td class="script_navbar"><a href="#33268ScriptAnchor_"><span>Next Script: [libraryHelp]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">help</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33268ScriptAnchor_">libraryHelp</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#</li>
<li>//  Close Window [ Name: "Help" ]</li>
<li>#</li>
<li>#Set back path from help to this solution.</li>
<li>Set Field [ MemorySwitch::backToSolution; "Library" ]</li>
<li>#</li>
<li>#</li>
<li>#Set tag menu variable to 1 if user is on tag menu, and </li>
<li>#then select the main window to determin the module.</li>
<li>If [ Get (WindowName) = "Tag Menus" ]</li>
<li>If [ $$findMode = 1 ]</li>
<li>Set Field [ MemorySwitch::helpObjectName; "find" ]</li>
<li>Else</li>
<li>If [ $$citationMatch = "copyist" or $$citationMatch = "path" or $$citationMatch = "organ" ]</li>
<li>Set Field [ MemorySwitch::helpObjectName; "key" ]</li>
<li>Else</li>
<li>Set Field [ MemorySwitch::helpObjectName; $$citationMatch ]</li>
<li>End If</li>
<li>#</li>
<li>If [ Get (LayoutName) = "testMenuTestItem" ]</li>
<li>Set Field [ MemorySwitch::helpObjectName; "test item" ]</li>
<li>Else If [ Get (LayoutName) = "testInfo" ]</li>
<li>Set Field [ MemorySwitch::helpObjectName; "test info" ]</li>
<li>Else If [ Get (LayoutName) = "reportTagDiscovery" ]</li>
<li>Set Field [ MemorySwitch::helpObjectName; "result" ]</li>
<li>Else If [ Get (LayoutName) = "reportTagItem" ]</li>
<li>Set Field [ MemorySwitch::helpObjectName; "item" ]</li>
<li>Else If [ Get (LayoutName) = "reportTagInfo" ]</li>
<li>Set Field [ MemorySwitch::helpObjectName; "info" ]</li>
<li>Else If [ Get (LayoutName) = "setupTestFocus" ]</li>
<li>Set Field [ MemorySwitch::helpObjectName; "section" ]</li>
<li>End If</li>
<li>#</li>
<li>End If</li>
<li>Set Variable [ $tagWindow; Value:1 ]</li>
<li>Select Window [ Name: "Setup"; Current file ]</li>
<li>Select Window [ Name: "Learn"; Current file ]</li>
<li>Select Window [ Name: "Print/Copy"; Current file ]</li>
<li>Select Window [ Name: "References"; Current file ]</li>
<li>Select Window [ Name: "Test"; Current file ]</li>
<li>Select Window [ Name: "Report"; Current file ]</li>
<li>End If</li>
<li>#</li>
<li>#Determin the module.</li>
<li>If [ Get ( LayoutTableName ) = "tempSetup" ]</li>
<li>Set Field [ MemorySwitch::helpLayoutName; "Setup" ]</li>
<li>Else If [ Get ( LayoutTableName ) = "testLearn" and Get (LayoutName) &ne; "step4_InspectionFinding" ]</li>
<li>Set Field [ MemorySwitch::helpLayoutName; "Learn" ]</li>
<li>Else If [ Get ( LayoutTableName ) = "reference" ]</li>
<li>Set Field [ MemorySwitch::helpLayoutName; "Reference" ]</li>
<li>Else If [ Get ( LayoutTableName ) = "test" ]</li>
<li>Set Field [ MemorySwitch::helpLayoutName; "Test" ]</li>
<li>Else If [ Get ( LayoutTableName ) = "inspectItems" ]</li>
<li>Set Field [ MemorySwitch::helpLayoutName; "Test" ]</li>
<li>Else If [ Get ( LayoutTableName ) = "testLearn" and Get (LayoutName) = "step4_InspectionFinding" ]</li>
<li>Set Field [ MemorySwitch::helpLayoutName; "Test" ]</li>
<li>Else If [ Get ( LayoutTableName ) = "report" ]</li>
<li>Set Field [ MemorySwitch::helpLayoutName; "Test" ]</li>
<li>End If</li>
<li>#</li>
<li>If [ $tagWindow &ne; 1 ]</li>
<li>#Help for library setup module main window.</li>
<li>If [ Get (LayoutName) = "defaultSetup" ]</li>
<li>Set Field [ MemorySwitch::helpObjectName; "library" ]</li>
<li>End If</li>
<li>#</li>
<li>#Help for test setup module main window.</li>
<li>If [ Get (LayoutName) = "testSetup" ]</li>
<li>Set Field [ MemorySwitch::helpObjectName; "setup" ]</li>
<li>End If</li>
<li>#</li>
<li>#Help for test select main window.</li>
<li>If [ Get (LayoutName) = "step3_InspectionItems" ]</li>
<li>Set Field [ MemorySwitch::helpObjectName; "test select" ]</li>
<li>End If</li>
<li>#</li>
<li>#Help for test select main window.</li>
<li>If [ Get (LayoutName) = "step4_InspectionFinding" ]</li>
<li>Set Field [ MemorySwitch::helpObjectName; "test finding" ]</li>
<li>End If</li>
<li>#</li>
<li>#Help for report main window.</li>
<li>If [ Get (LayoutName) = "PrintReportEdit" ]</li>
<li>Set Field [ MemorySwitch::helpObjectName; "report" ]</li>
<li>End If</li>
<li>#</li>
<li>#Help for learn module main window.</li>
<li>If [ Get (LayoutName) = "learn1" or Get (LayoutName) = "learn2" or Get (LayoutName) = "learn3" or Get (LayoutName) = "learn4" ]</li>
<li>Set Field [ MemorySwitch::helpObjectName; "learn" ]</li>
<li>Else If [ Get (LayoutName) = "LearnTextWindow" ]</li>
<li>Set Field [ MemorySwitch::helpObjectName; "edit" ]</li>
<li>Show Custom Dialog [ Message: "This edit-note window will be closed while you view help for this window.  Your work will be saved!  When you are finished viewing help, click on your text to re-open this window and continue editing."; Buttons: &ldquo;cancel&rdquo;, &ldquo;OK&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Pause/Resume Script [ Indefinitely ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Close Window [ Current Window ]</li>
<li>End If</li>
<li>Else If [ Get (LayoutName) = "Learn4EDIT" ]</li>
<li>Set Field [ MemorySwitch::helpObjectName; "qv" ]</li>
<li>Else If [ Get (LayoutName) = "learnFind" ]</li>
<li>Set Field [ MemorySwitch::helpObjectName; "learnFind" ]</li>
<li>Else If [ Get (LayoutName) = "learnPreviewLayout" ]</li>
<li>Set Field [ MemorySwitch::helpObjectName; "print" ]</li>
<li>#</li>
<li>#Help for reference module main window.</li>
<li>Else If [ Get (LayoutName) = "reference" ]</li>
<li>Set Field [ MemorySwitch::helpObjectName; "ref" ]</li>
<li>Else If [ Get (LayoutName) = "referenceEdit" ]</li>
<li>Set Field [ MemorySwitch::helpObjectName; "ref edit" ]</li>
<li>Else If [ Get (LayoutName) = "referenceFind" ]</li>
<li>Set Field [ MemorySwitch::helpObjectName; "ref find" ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>Pause/Resume Script [ Duration (seconds): .1 ]</li>
<li>#</li>
<li>Open URL [ MemorySwitch::helpPath ]
[ No dialog ]</li>
<li>Open URL [ Substitute ( MemorySwitch::helpPath ; "file://" ; "file:///Volumes/" ) ]
[ No dialog ]</li>
<li>#</li>
<li>Select Window [ Name: "Help" ]</li>
<li>Select Window [ Name: "Tutorial" ]</li>
<li>#</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>MemorySwitch</em>::backToSolution</li>
<li>
<em>MemorySwitch</em>::helpObjectName</li>
<li>
<em>MemorySwitch</em>::helpLayoutName</li>
<li>
<em>MemorySwitch</em>::helpPath</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33268ScriptAnchor_"></a><td class="script_navbar"><a href="#33248ScriptAnchor_"><span>Previous Script: [help]</span></a></td><td class="script_navbar"><a href="#33266ScriptAnchor_"><span>Parent Folder: [help]</span></a></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">libraryHelp</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">No</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#So there are two help button scripts because I changed</li>
<li>#mind and used an external help module forgetting</li>
<li>#I already had a help button script.  So some help buttons</li>
<li>#are attached to one script and some to this one and </li>
<li>#rather than figure this out, I just made this script</li>
<li>#reference other one.  As you can see by its name this</li>
<li>#used to take users to an internal library help system.</li>
<li>Perform Script [ &ldquo;help&rdquo; ]</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33248ScriptAnchor_">help</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>


</body>
</html>
