Use this file to copy just the script section of the current FileMaker Database Design Report.  Commit it.  Then paste in the script section from your updated database design report to see all changes between current and updated versions.  This a large file and you will be see the changes only in the GitHub desktop tool; not on the GitHub website.  Do this comparison  to basically insure everything is documented in an updated version.


Script Hierarchy
dataCleanUpScripts

nextLayout
referenceLoop
ResizeToFit
subsectionLoop
tagGroupLoop
tagLoop
help

help
helpAllApps
helpBack
helpReferenceAddToTag
learn

helpLearnEdit
helpLearnFind
helpLearnMain
helpLearnQV
helpLearnShare
helpLearnTag
helpLearnTagFindLearnRecord
helpLearnTagFindTag
libraryHelp
reference

helpReferenceEdit
helpReferenceFind
helpReferenceMain
helpReferenceTag
helpReferenceTagFindReferenceRecord
helpReferenceTagFindTag
setup

helpSetupMain
helpSetupTagAllDefault
helpSetupTagCopyright
helpSetupTagCopyrightReview
helpSetupTagNode
helpSetupTest
helpSetupTestEdit
test

helpSetupTest
helpTest
helpTestReportMain
helpTestReportTagInfo
helpTestReportTagItem
helpTestReportTagResult
learn

cancelLearnAndRefFind
catchFindLearnErrorMessages
catchFindLearnErrorMessagesBrainstormCasePointFieldBUTTON
catchFindLearnErrorMessagesTextFieldBUTTON
catchFindLearnErrorMessagesTimestampFieldBUTTON
closeLearnQV
deleteLearnMainRecord
duplicateLearnRecord
editLearn
exitFindLearnFieldAndReEnterIt
findLearnRecord
gotoLearn
gotoLearnQV
gotoLearnWebsite
haltShareScript
holderCheckBox
learnInsertReferenceIntoNote
learnOpenTextNewWindow
newLearn
probablyNotInUse

shareLearnRecords
shareWindowCopyTextButton
showReferencedFileFolder
libraryNewOrImport

importDataFromABranchIntoThisMainLibrary
Interactivate
newLibraryStep1_CreateACopyOfThisLibraryFile
newLibraryStep2_EraseRecordsInCopyOfLibrary
newLibraryStep3A_makeEmptiedLibraryANewLibrary
newLibraryStep3B_importLibraryIntoEmptiedLibrary
librarySetup

allAppsMenu
changeLibraryName
gotoBudgetPlanner
gotoHeartWhisperer
gotoHelpGiveThanksWebsite
gotoIQLogs
gotoOtherLibrary
libraryMainOrBranchRepition1
libraryMainOrBranchRepition2
libraryTypeCheckBoxRepition1
libraryTypeCheckBoxRepition2
moreInfo
probablyNotInUse

copyPrimaryNodeID
setupReference_Delete
setupReference_GoToPortalReferenceRevieworWebsite
setupReference_GoToReviewOrEditWindow
setupReference_GoToWebsite
setupReference_Lock
setupReference_New
pictures

addLinksPicturesToTagsMode
addPicture1ToTag
addPicture2ToTag
addPicture3ToTag
CHUNK_addPictureToTag
CHUNK_insertPictureOrMovie
clearpicture1
clearpicture2
clearpicture3
clearpicture4
exitIfNotiPhone
pictureDelete
pictureExport
pictureReplaceButton
pictureViewButton
probablyNotInUse

showPrimaryNodePicture
reportCopyPastPart2Tag1
reportCopyPastPart2Tag2
reportCopyPastPart2Tag3
reportCopyPastPart2Tag4
selectLearnRecordsTaggedReferenceRecord
showCitationPicture1inNewWindow
showCitationPicture2inNewWindow
showCitationPicture3inNewWindow
showRefHarddriveMedia
showRefWebMedia
showTagsReferenceForPicture1
showTagsReferenceForPicture2
showTagsReferenceForPicture3
showTestSubjectCopyrightPicture
reference

addFileLink4ToTag
addFileLink6ToTag
addFileLink5ToTag
addModeReferenceLearnToggle
catchFindReferenceErrorMessages_BUTTONCreateDateField
catchFindReferenceErrorMessages_BUTTONModifyDateField
catchFindReferenceErrorMessages_BUTTONReference
catchFindReferenceErrorMessages
changeFileLocationFolder
CHUNK_checkIfReferencePicIsInUse
CHUNK_findReferenceRecordUserFindRequests
deleteReference
duplicateReferenceRecord
editReference
enterShortOrLongTagField
exitAndStopClearCitationMatch
exitLockedStuffRef
extractCreateDateFromReferenceRecords
findALL_LearnOrRefRecords
findReferenceRecord
finishReferenceEdit
formatTitle
gotoReference
goToRefRecord
helpReferenceFields
insertTimeInRefTimeField
isONpulldownMenu
isWHATpulldownMenu
loadLearnOrRefMainRecord
LocationEditFieldsHIDE
menuLearn
newLocationRecord
newReference
openReferenceWebsite
probablyNotInUse

publisherCheckboxRadioButtonActionPart1
removeCopyrightType
removeTextFormatting
removeTextFormattingAndCommas
seeIfFilenameIsValid
SeeIfFileNameIsValidAndCanBeDisplayed
setCitationMatchForAuthors
showCitation
showTagLink1
showTagLink2
showTagLink3
showTagsReferenceForLink1
showTagsReferenceForLink2
showTagsReferenceForLink3
sortEditedStuffModeReference
sortRefByAuthor
sortRefByDate
sortRefByPub
sortRefBySubject
sortRefByTitle
viewReference
sharedLayoutScripts

backFromTemplateEditor
backToLearnOrDefaultSetup
backtoSetup
closeWindow
closeWindowResumePause
closeWindowHaltScript
copyAndpastTags
exit
exitOnly
findInactiveButtonMessage
gotoAllAppsMenuORActionLogApp
gotoTimeLogLogWindow
returnToAddRecordPUTONHOLD!!!!
stopLockedNodesRecordsBeingDeleted
stopLockedRecordsFromBeingDeleted
stopNewRecordsBeingCreatedByLockedNode
toggleMainWindowView
startclose

CHUNK_checkCreatorNodeAndPrimaryNode
CHUNK_CopyrightLockedFields
New Script
closeLibrary
startDatabase
tagMenu

addInitialDateTimeToTextField
addORremoveOtherTagStep1
addORremoveOtherTagStep2_keyword
addORremoveOtherTagStep2_node
addORremovePrimaryTag
addORremoveRefTagStep1
addORremoveRefTagStep2_forRefRecord
addORremoveRefTagStep2_forLearnRecord
addRefsKeywordsToMainRecord
archiveChecklist
backFromTagMenus
brainstormExit
checkActiveFieldForChangesAndTellUserIfItIsLocked
checkIfLockedOnLearnTagMenus
checkKeyANDNodeTagNames
checkORaddTestItem
checkSpellingOfCPPPTags
checkTagGroupNamesEXCEPTtestItemGroups
checkTestItemGroupNames
checkTestSectionSubsectionAndItemRecordSpellings
CHUNK_addLinkToTag
CHUNK_addReferenceNodeAndKeywordTagIDs
CHUNK_checkForDraggedPasteChanges
createFormOutOf_FT_TestItems
defaultCopyrightMenu
defaultLibraryButton
defaultNodeMenu
defaultsAll
deleteCPPPBtags
deleteKeywordTag
deleteNodeTag
duplicateBrainstorm
findKeyOtherRef
findKeyOtherTL
findMode
findModeCancel
findPrimaryRef
findPrimaryTL
gotoLessDetailLayout
gotoLessLayoutsTag
gotoLessLayoutsTL
gotoMainFromTestTagMenus
gotoMoreDetailLayout
gotoSetupReport
hideFormTextTestItemsFTs
insertGenericNumberOrTimeReference
insertGenericTimeReference
insertRefenceToRefenceAndPageNumber
insertRefenceToRefenceAndTime
insertReferenceToReference
loadBrainstormTags
loadLearnTagRecord
loadRefCiteTag
loadReferenceForInsertIntoText
loadReportTestResultRecord
loadTagRecord
loadTestTagMenu
loadTestTags
lock
lockNodesRecords
menuBrainstorm
menuCitation
menuCopyright
menuFind

menuBrainstormFind
menuCitationFind
menuCopyrightFind
menuKeyFind
menuLearnFind
menuMediumFind
menuNodeFind
menuPathFind
menuPublicationFind
menuPublisherFind
menuReferenceFind
menuTestFind
cancelFind
menuKey
menuMedium
menuNode
menuPath
menuPublication
menuPublisher
menuReference
menuTest
menuTestItem
menuTestSection
moveTagToNewGroup
newTagMenuTag
newTagMenuTagGroup
noCommasAllowed
probablyNotInUse

newTag
returnToSetup
reviewCopyright
reviewPrimaryNodeCopyright
selectTestSection
selectTestSubject
showCited
sortButtonLearnLayouts
sortOrderNumberPulldownLearnLayouts
sortTags
sortTestOrBrainstormTaggedLearnRecords
templateTestSectionMenu
testItemCheckButton
testItemTextButton
testTemplatesItemButton
testTemplatesSectionButton
testTemplatesTestButton
TgotoCitationMenu
toggleTagMenuWindowView
unzoomSetup
zoomSetup
test

report

CHUNK_gotoTestSubsectionViaPulldown
deleteRowOfPhotosFromReport
deleteSetupItems
deleteTestSectionTemplate
gotoDefaultsOrReport
gotoReport
insertCaption1
insertCaption2
insertCaption3
insertCaption4
newRowOfPhotos
nextPage
openDetailWindow !!! FINISH LATER !!!
pagePulldown
previewReport
previousPage
print

CHUNK_insertPageNumbers
CHUNK_insertPageNumbersBackOnePage
CHUNK_insertPageNumbersForwardOnePage
CHUNK_pageNumberItem
CHUNK_pageNumberTheme
printThingReport
TOC
probablyNotInUse

newAttribute
removeTestResultOrInfoRecordFromReport
reportCopyPastPart1
reportCopyPastPart3
reportExitOnRecordLoad
reportPreviewClose
reportTagInfo
reportTestResult
showPicture1
showPicture2
showPicture3
showPicture4
sortReport
unzoomReport
zoomReport
setup

deleteSubsection
deleteSubsectionFromUserTest
deleteTestItem
duplicateSectionFromTemplate
gotoSetupTest_Template
gotoSetupTest_TestSubjectTest
gotoTechView
gotoTestSubject_CreationDateField
gotoTestSubject_SectionField
linkOrUnlinkTestItemGroupToTestItemList
loadSetupTestSection
loadSetupTestSubsection
loadTestSubjectTestSection
moveSubsectionToOtherGroup
newSection
newSectionFromTemplate
newSubsection
newSubsectionGroup
newTestItem
newTestItemGroup
newTestSectionTemplatePulldownCheck
probablyNotInUse

moveTestItemToNewTestGroupStep1
showSubsectionsInThisSection
test

CHUNK_countTestResults
CHUNK_findLearnRecordsReferences
deleteReportTestResult
deleteTestResult
done
exitAndOrderTestResults
gotoTestResults
gotoTestSubsections
identifyTestsThatHaveResults
informUserHowToEditLockedLayoutText
inspectAddProblemToFinding
inspectNextRecord
inspectPreviousRecord
linkOrUnlinkTestSection
loadSubsection
loadTestInfo
loadTestResultRecord
newTestResult
probablyNotInUse

switchTestList
reportNewTestResult
returnToInspectionItems
returnToSubsections
returnToTestSetup
testInfoOpenTextNewWindow
testItemCheckOrTextOrForm
testItemCheckTemplateButton
testItemStyles
testItemTextOrFormTemplateButton
testSubsectionNA
toggleTestWindowView
testResultInformationPulldown
useSubsectionAndCurrentTimeStamp

dataCleanUpScripts
	Parent Folder: [dataCleanUpScripts]	Next Script: [referenceLoop]
Script Name	nextLayout
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #Use this script to go the next layout to test if
    #it is in list view or table view.
    Set Variable [ $$stoploadCitation; Value:1 ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    #
    If [ $$nextLayout = "" ]
    Set Variable [ $$nextLayout; Value:1 ]
    End If
    #
    Go to Layout [ $$nextLayout ]
    #
    Set Variable [ $$nextLayout; Value:$$nextLayout + 1 ]
    Show/Hide Toolbars [ Show ]
    Install Menu Set [ “[Standard FileMaker Menus]” ]

Fields used in this script

Scripts used in this script

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script

    [Standard FileMaker Menus]


Previous Script: [nextLayout]	Parent Folder: [dataCleanUpScripts]	Next Script: [ResizeToFit]
Script Name	referenceLoop
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #Use this script to change some information in all
    #records currently found. Useful for when you make
    #an error covering many records to correct the error.
    Set Variable [ $$stoploadCitation; Value:1 ]
    Go to Record/Request/Page [ First ]
    Loop
    // Set Field [ reference::kkeywordOther; 6152012170316227 & ¶ & 426201211190634 & ¶ & 6202012153813240 & ¶ & 6202012165313251 & ¶ & 10212011022440584 & ¶ & 6092012194220193 & ¶ & 8312012200828513 & ¶ & 8112011135327306 & ¶ & 5262013013530620 & ¶ & 120420111059441036 & ¶ & 9132011003103394 & ¶ ]
    // Set Field [ reference::kkeywordPrimary; 10142013154511774 ]
    // Set Field [ reference::OtherKeyWords; "brain and military, brain and the law, causes and conditions, cognitive control, epidemics, evolution, illusion (rational), mental illness, neuropsychiatry, suicide, volition" ]
    // Set Field [ reference::kfileLocation; 8162011225605315 ]
    // Set Field [ reference::kfolderpath; 5312012152200119 ]
    // Set Variable [ $isON; Value:reference::kisON ]
    // Set Variable [ $isWHAT; Value:reference::kisWhat ]
    Set Field [ reference::kisON; 420201300192711 ]
    Set Field [ reference::kisWhat; 505201316131590 ]
    // Set Field [ reference::kcopyrightHolder; 6022012160448133 ]
    // Set Field [ reference::referenceNodes; "Cold Spring Harbor Laboratory" ]
    // Set Field [ reference::kpublication; "" ]
    // Set Field [ reference::kpublisher; 5102013023502585 ]
    // Set Field [ reference::GovernmentDocInfo; "Series speakers are from the UCSF Center for Obesity Assessment, Study and Treatment" ]
    // Set Field [ reference::kpublication; 6032012182212144 ]
    // Set Field [ reference::CopyrightYear; "" ]
    // Set Field [ reference::publicationYearOrStuffOrderNumber; "" ]
    // Set Field [ reference::incomplete; "" ]
    // Set Field [ reference::kCopyright; "8102011220941282" ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    Set Variable [ $$stoploadCitation ]

Fields used in this script

    reference::kkeywordOther
    reference::kkeywordPrimary
    reference::OtherKeyWords
    reference::kfileLocation
    reference::kfolderpath
    reference::kisON
    reference::kisWhat
    reference::kcopyrightHolder
    reference::referenceNodes
    reference::kpublication
    reference::kpublisher
    reference::GovernmentDocInfo
    reference::CopyrightYear
    reference::publicationYearOrStuffOrderNumber
    reference::incomplete
    reference::kCopyright

Scripts used in this script

Layouts used in this script

Tables used in this script

    reference

Table occurrences used by this script

    reference

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [referenceLoop]	Parent Folder: [dataCleanUpScripts]	Next Script: [subsectionLoop]
Script Name	ResizeToFit
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    Adjust Window [ Resize to Fit ]

Fields used in this script

Scripts used in this script

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [ResizeToFit]	Parent Folder: [dataCleanUpScripts]	Next Script: [tagGroupLoop]
Script Name	subsectionLoop
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #Use this script to change some information in all
    #records currently found. Useful for when you make
    #an error covering many records to correct the error.
    Go to Layout [ “tableTestSubsectionTemplates” (testSubsectionTemplate) ]
    Show All Records
    Go to Record/Request/Page [ First ]
    Loop
    #
    Set Field [ testSubsectionTemplate::order[2]; testSubsectionTemplate::order[1] ]
    #
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    Go to Layout [ “tableTagGroup” (testSubsectionGroup) ]
    Perform Find [ Specified Find Requests: Find Records; Criteria: testSubsectionGroup::nameSpellingEXCEPTForTestItemGroup: “"testItemGroup"” ] [ Restore ]
    Go to Record/Request/Page [ First ]
    Loop
    #
    Set Field [ testSubsectionGroup::orderOrLibraryType[2]; testSubsectionGroup::orderOrLibraryType[1] ]
    #
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    Perform Find [ Specified Find Requests: Find Records; Criteria: testSubsectionGroup::match: “"testSubsection"” ] [ Restore ]
    Go to Record/Request/Page [ First ]
    Loop
    #
    Set Field [ testSubsectionGroup::orderOrLibraryType[2]; testSubsectionGroup::orderOrLibraryType[1] ]
    #
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    Go to Layout [ “tableTag” (tagTable) ]
    Perform Find [ Specified Find Requests: Find Records Find Records; Criteria: tagTable::match: “"testItem"” ] [ Restore ]
    Go to Record/Request/Page [ First ]
    Loop
    #
    Set Field [ tagTable::orderOrLock[2]; tagTable::orderOrLock[1] ]
    #
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop

Fields used in this script

    testSubsectionTemplate::order
    testSubsectionGroup::nameSpellingEXCEPTForTestItemGroup
    testSubsectionGroup::orderOrLibraryType
    testSubsectionGroup::match
    tagTable::match
    tagTable::orderOrLock

Scripts used in this script

Layouts used in this script

    tableTestSubsectionTemplates
    tableTagGroup
    tableTag

Tables used in this script

    tag
    tagGroup
    testSubsectionTemplate

Table occurrences used by this script

    tagTable
    testSubsectionGroup
    testSubsectionTemplate

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [subsectionLoop]	Parent Folder: [dataCleanUpScripts]	Next Script: [tagLoop]
Script Name	tagGroupLoop
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #Use this script to change some information in all
    #records currently found. Useful for when you make
    #an error covering many records to correct the error.
    Set Variable [ $$stoploadCitation; Value:1 ]
    Go to Layout [ “tableTagGroup” (testSubsectionGroup) ]
    Show All Records
    Go to Record/Request/Page [ First ]
    Loop
    #
    If [ testSubsectionGroup::match = "health" ]
    Set Field [ testSubsectionGroup::match; "copyright" ]
    End If
    #
    If [ testSubsectionGroup::match = "section" ]
    Set Field [ testSubsectionGroup::match; "library" ]
    End If
    #
    If [ testSubsectionGroup::match = "organ" ]
    Set Field [ testSubsectionGroup::match; "publication" ]
    End If
    #
    If [ testSubsectionGroup::match = "copyist" ]
    Set Field [ testSubsectionGroup::match; "publisher" ]
    End If
    #
    If [ testSubsectionGroup::match = "sample" ]
    Set Field [ testSubsectionGroup::match; "brainstorm" ]
    End If
    #
    If [ testSubsectionGroup::match = "focus" ]
    Set Field [ testSubsectionGroup::match; "testSection" ]
    End If
    #
    If [ testSubsectionGroup::match = "testGroup" ]
    Set Field [ testSubsectionGroup::match; "testSubsection" ]
    End If
    #
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    Set Variable [ $$stoploadCitation ]

Fields used in this script

    testSubsectionGroup::match

Scripts used in this script

Layouts used in this script

    tableTagGroup

Tables used in this script

    tagGroup

Table occurrences used by this script

    testSubsectionGroup

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [tagGroupLoop]	Parent Folder: [dataCleanUpScripts]
Script Name	tagLoop
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #Use this script to change some information in all
    #records currently found. Useful for when you make
    #an error covering many records to correct the error.
    Set Variable [ $$stoploadCitation; Value:1 ]
    Go to Layout [ “tableTag” (tagTable) ]
    Show All Records
    Go to Record/Request/Page [ First ]
    Loop
    #
    If [ tagTable::match = "health" ]
    Set Field [ tagTable::match; "copyright" ]
    End If
    #
    If [ tagTable::match = "organ" ]
    Set Field [ tagTable::match; "publication" ]
    End If
    #
    If [ tagTable::match = "copyist" ]
    Set Field [ tagTable::match; "publisher" ]
    End If
    #
    If [ tagTable::match = "sample" ]
    Set Field [ tagTable::match; "brainstorm" ]
    End If
    #
    If [ tagTable::match = "focus" ]
    Set Field [ tagTable::match; "testSection" ]
    End If
    #
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    Set Variable [ $$stoploadCitation ]

Fields used in this script

    tagTable::match

Scripts used in this script

Layouts used in this script

    tableTag

Tables used in this script

    tag

Table occurrences used by this script

    tagTable

Custom Functions used by this script

Custom menu set used by this script


help
	Parent Folder: [help]	Next Script: [helpAllApps]
Script Name	help
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferenceStuff
    ReferenceFINDallfields
    ReferenceMenuNoTags
    ReferenceMenu2SkeywordOrNode1
    ReferenceMenu2SkeywordOrNode2
    ReferenceMenu2SkeywordOrNode3
    ReferenceMenu2SkeywordOrNode4
    ReferenceMenu2SkeywordOrNode5
    ReferenceMenu2SkeywordOrNodeFind
    learnPreviewLayout
    learnMenu4STUFFRefCite
    learnTagWindowNoTags
    learnSTest
    learnSFind
    learnFindSTest
    learnMenu4RefStuffCiteFindTL
    learnMenuFINDstuffRefLearn
    testSetupTechView
    setupTestItemTechView

Scripts that use this script

    helpAllApps
    helpReferenceAddToTag
    helpLearnEdit
    helpLearnFind
    helpLearnMain
    helpLearnQV
    helpLearnShare
    helpLearnTag
    helpLearnTagFindLearnRecord
    helpLearnTagFindTag
    libraryHelp
    helpReferenceEdit
    helpReferenceFind
    helpReferenceMain
    helpReferenceTag
    helpReferenceTagFindReferenceRecord
    helpReferenceTagFindTag
    helpSetupMain
    helpSetupTagAllDefault
    helpSetupTagCopyright
    helpSetupTagCopyrightReview
    helpSetupTagNode
    helpSetupTest
    helpSetupTestEdit
    helpSetupTest
    helpTest
    helpTestReportMain
    helpTestReportTagInfo
    helpTestReportTagItem
    helpTestReportTagResult

Script Definition
Script Steps

    #
    #
    #BEGIN Help interface and column message
    #
    #If the help app is open figure out if it is
    #focused on help for the interface the user
    #is currently looking at.
    If [ MemorySwitch::helpAppIsRunning ≠ "" ]
    #
    #If not focused on the help layout or column for
    #the current interface then ask the user if they
    #would like to go to help for this interface, or
    #return the help for the interface currently showing.
    If [ MemorySwitch::helpLayoutName ≠ $$helpLayoutName or MemorySwitch::helpLayoutColumnName ≠ $$helpColumnName ]
    If [ $$helpLayoutName = "Test" ]
    If [ $$helpColumnName = "B" ]
    Show Custom Dialog [ Message: "Go to help for this interface (Test Templates" & ": Column — " & $$helpColumnName & "), or return to the interface help being viewed?"; Default Button: “return”, Commit: “Yes”; Button 2: “go”, Commit: “No”; Button 3: “cancel”, Commit: “No” ]
    Else If [ $$helpColumnName = "C" ]
    Show Custom Dialog [ Message: "Go to help for this interface (Test" & ": Column — " & $$helpColumnName & "), or return to the interface help being viewed?"; Default Button: “return”, Commit: “Yes”; Button 2: “go”, Commit: “No”; Button 3: “cancel”, Commit: “No” ]
    Else
    Show Custom Dialog [ Message: "Go to help for this interface (Report" & ": Column — " & $$helpColumnName & "), or return to the interface help being viewed?"; Default Button: “return”, Commit: “Yes”; Button 2: “go”, Commit: “No”; Button 3: “cancel”, Commit: “No” ]
    End If
    Else
    #
    #If the $$gotoHelpObject variable is blank,
    #meaning the user has already been asked if
    #they want to go help for an interface that has
    #to close to do so, ask if they want to go to help.
    If [ $$gotoHelpObject = "" ]
    Show Custom Dialog [ Message: "Go to help for this interface (" & $$helpLayoutName & ": Column — " & $$helpColumnName & "), or return to the interface help being viewed?"; Default Button: “return”, Commit: “Yes”; Button 2: “go”, Commit: “No”; Button 3: “cancel”, Commit: “No” ]
    End If
    End If
    #
    #
    #
    If [ Get (LastMessageChoice) = 2 or $$gotoHelpObject ≠ "" ]
    Set Field [ MemorySwitch::helpLayoutName; $$helpLayoutName ]
    Set Field [ MemorySwitch::helpLayoutColumnName; $$helpColumnName ]
    Set Field [ MemorySwitch::helpLayoutObjectName; $$helpColumnName ]
    Set Variable [ $messageChoice; Value:2 ]
    End If
    #
    If [ Get (LastMessageChoice) = 3 ]
    Exit Script [ ]
    End If
    #
    #
    #If focused on the help layout and column for
    #the current interface then just go to it.
    Else
    If [ Get ( SystemPlatform ) ≠ 3 ]
    Select Window [ Name: "Help" ]
    Else
    Open URL [ "fmp://%7e/Help" ] [ No dialog ]
    End If
    Exit Script [ ]
    End If
    #
    #If the help app is not open, then tell the user
    #what interface and column they are going
    #to be taken to when it is opened.
    Else
    Set Field [ MemorySwitch::helpLayoutName; $$helpLayoutName ]
    Set Field [ MemorySwitch::helpLayoutColumnName; $$helpColumnName ]
    Set Field [ MemorySwitch::helpLayoutObjectName; $$helpColumnName ]
    If [ $$helpLayoutName = "Test" ]
    If [ $$helpColumnName = "B" ]
    Show Custom Dialog [ Message: "Now going to help for this interface (Test Templates" & ": Column — " & $$helpColumnName & ")."; Default Button: “OK”, Commit: “Yes”; Button 2: “cancel”, Commit: “No” ]
    Else If [ $$helpColumnName = "C" ]
    Show Custom Dialog [ Message: "Now going to help for this interface (Test" & ": Column — " & $$helpColumnName & ")."; Default Button: “OK”, Commit: “Yes”; Button 2: “cancel”, Commit: “No” ]
    Else
    Show Custom Dialog [ Message: "Now going to help for this interface (Report" & ": Column — " & $$helpColumnName & ")."; Default Button: “OK”, Commit: “Yes”; Button 2: “cancel”, Commit: “No” ]
    End If
    Else
    Show Custom Dialog [ Message: "Now going to help for this interface (" & $$helpLayoutName & ": Column — " & $$helpColumnName & ")."; Default Button: “OK”, Commit: “Yes”; Button 2: “cancel”, Commit: “No” ]
    End If
    #
    If [ Get (LastMessageChoice) = 2 ]
    Exit Script [ ]
    End If
    End If
    #
    #
    #END Help interface and column message
    #
    #
    #
    #
    #
    #BEGIN Find and record all open windows
    #
    #
    #Get the name of the window that the user
    #clicked the help button on.
    Set Variable [ $windowHelpWasClickedOn; Value:Get (WindowName) ]
    #
    #Update the current app being used info.
    Set Field [ MemorySwitch::backToSolution; "Library" ]
    #
    #
    #Now figure out what other windows are open.
    #There can be up to three windows open.
    #LEARN
    #Is this window open and not alread recorded?
    Select Window [ Name: "Learn"; Current file ]
    If [ Get (LastError) ≠ 112 //window is missing = 112 and $windowHelpWasClickedOn ≠ Get ( WindowName ) ]
    #Is the second open window accounted for?
    If [ $windowAlsoOpen2 = "" ]
    Set Variable [ $windowAlsoOpen2; Value:Get (WindowName) ]
    Else
    Set Variable [ $windowAlsoOpen3; Value:Get (WindowName) ]
    End If
    End If
    #REFERENCE (NOTE: Change this window
    #name to references when time permits.)
    #Is this window open and not alread recorded?
    Select Window [ Name: "Reference"; Current file ]
    If [ Get (LastError) ≠ 112 //window is missing = 112 and $windowHelpWasClickedOn ≠ Get ( WindowName ) ]
    #Is the second open window accounted for?
    If [ $windowAlsoOpen2 = "" ]
    Set Variable [ $windowAlsoOpen2; Value:Get (WindowName) ]
    Else
    Set Variable [ $windowAlsoOpen3; Value:Get (WindowName) ]
    End If
    End If
    #REFERENCES
    #Is this window open and not alread recorded?
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) ≠ 112 //window is missing = 112 and $windowHelpWasClickedOn ≠ Get ( WindowName ) ]
    #Is the second open window accounted for?
    If [ $windowAlsoOpen2 = "" ]
    Set Variable [ $windowAlsoOpen2; Value:Get (WindowName) ]
    Else
    Set Variable [ $windowAlsoOpen3; Value:Get (WindowName) ]
    End If
    End If
    #REPORT
    #Is this window open and not alread recorded?
    Select Window [ Name: "Report"; Current file ]
    If [ Get (LastError) ≠ 112 //window is missing = 112 and $windowHelpWasClickedOn ≠ Get ( WindowName ) ]
    #Is the second open window accounted for?
    If [ $windowAlsoOpen2 = "" ]
    Set Variable [ $windowAlsoOpen2; Value:Get (WindowName) ]
    Else
    Set Variable [ $windowAlsoOpen3; Value:Get (WindowName) ]
    End If
    End If
    #SETUP
    #Is this window open and not alread recorded?
    Select Window [ Name: "Setup"; Current file ]
    If [ Get (LastError) ≠ 112 //window is missing = 112 and $windowHelpWasClickedOn ≠ Get ( WindowName ) ]
    #Is the second open window accounted for?
    If [ $windowAlsoOpen2 = "" ]
    Set Variable [ $windowAlsoOpen2; Value:Get (WindowName) ]
    Else
    Set Variable [ $windowAlsoOpen3; Value:Get (WindowName) ]
    End If
    End If
    #SHARE
    #Is this window open and not alread recorded?
    Select Window [ Name: "Share"; Current file ]
    If [ Get (LastError) ≠ 112 //window is missing = 112 and $windowHelpWasClickedOn ≠ Get ( WindowName ) ]
    #Is the second open window accounted for?
    If [ $windowAlsoOpen2 = "" ]
    Set Variable [ $windowAlsoOpen2; Value:Get (WindowName) ]
    Else
    Set Variable [ $windowAlsoOpen3; Value:Get (WindowName) ]
    End If
    End If
    #TAG MENUS
    #Is this window open and not alread recorded?
    Select Window [ Name: "Tag Menus"; Current file ]
    If [ Get (LastError) ≠ 112 //window is missing = 112 and $windowHelpWasClickedOn ≠ Get ( WindowName ) ]
    #Is the second open window accounted for?
    If [ $windowAlsoOpen2 = "" ]
    Set Variable [ $windowAlsoOpen2; Value:Get (WindowName) ]
    Else
    Set Variable [ $windowAlsoOpen3; Value:Get (WindowName) ]
    End If
    End If
    #TEST
    #Is this window open and not alread recorded?
    Select Window [ Name: "Test"; Current file ]
    If [ Get (LastError) ≠ 112 //window is missing = 112 and $windowHelpWasClickedOn ≠ Get ( WindowName ) ]
    #Is the second open window accounted for?
    If [ $windowAlsoOpen2 = "" ]
    Set Variable [ $windowAlsoOpen2; Value:Get (WindowName) ]
    Else
    Set Variable [ $windowAlsoOpen3; Value:Get (WindowName) ]
    End If
    End If
    #TEST TEMPLATES
    #Is this window open and not alread recorded?
    Select Window [ Name: "Test Templates"; Current file ]
    If [ Get (LastError) ≠ 112 //window is missing = 112 and $windowHelpWasClickedOn ≠ Get ( WindowName ) ]
    #Is the second open window accounted for?
    If [ $windowAlsoOpen2 = "" ]
    Set Variable [ $windowAlsoOpen2; Value:Get (WindowName) ]
    Else
    Set Variable [ $windowAlsoOpen3; Value:Get (WindowName) ]
    End If
    End If
    #
    Set Field [ MemorySwitch::helpAppWindowName; $windowHelpWasClickedOn ]
    Set Field [ MemorySwitch::helpAppWindowName[2]; $windowAlsoOpen2 ]
    Set Field [ MemorySwitch::helpAppWindowName[3]; $windowAlsoOpen3 ]
    #
    #
    #END Find and record all open windows
    #
    #
    #
    #
    #Go to the help windows if the app is open.
    If [ Get ( SystemPlatform ) ≠ 3 ]
    Select Window [ Name: "Tutorial" ]
    Select Window [ Name: "Menu" ]
    Select Window [ Name: "Help" ]
    Else
    Open URL [ "fmp://%7e/Help" ] [ No dialog ]
    End If
    #
    #
    #If open, then run the script that forces help
    #to go the user's selected help location.
    If [ Get (LastError) ≠ 112 //window is missing = 112 ]
    If [ $messageChoice = 2 ]
    Perform Script [ “TRIGGERED_SCRIPTByOtherApp (new)” from file: “Help” ]
    Else
    Perform Script [ “fixForLearnLayoutBug (new)” from file: “Help” ]
    End If
    #
    Else
    #
    #If help is not open, then open it.
    If [ Get ( SystemPlatform ) ≠ 3 ]
    Open URL [ MemorySwitch::helpPath ] [ No dialog ]
    Open URL [ Substitute ( MemorySwitch::helpPath ; "file://" ; "file:///Volumes/" ) ] [ No dialog ]
    Else
    Open URL [ "fmp://%7e/Help" ]
    End If
    End If
    #
    #

Fields used in this script

    MemorySwitch::helpAppIsRunning
    MemorySwitch::helpLayoutName
    MemorySwitch::helpLayoutColumnName
    MemorySwitch::helpLayoutObjectName
    MemorySwitch::backToSolution
    MemorySwitch::helpAppWindowName
    MemorySwitch::helpPath

Scripts used in this script

    TRIGGERED_SCRIPTByOtherApp (new)
    fixForLearnLayoutBug (new)

Layouts used in this script

Tables used in this script

    MemorySwitch

Table occurrences used by this script

    MemorySwitch

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [help]	Parent Folder: [help]	Next Script: [helpBack]
Script Name	helpAllApps
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    allApps

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Send general layout name and help column
    #number to the help script so it can take the
    #user to help for this layout and column.
    Set Variable [ $$helpLayoutName; Value:"All Apps" ]
    Set Variable [ $$helpColumnName; Value:"A" ]
    #
    #Inform user they must cancel the find before
    #they will be able to go to the help window as
    #in find mode the focus is locked on it until
    #the find is complete.
    Show Custom Dialog [ Message: "If you are OK with exiting this interface to navigate to its help column — " & $$helpColumnName & " — click OK. The system is locked while its focused on this interface, which is why exiting it is requried."; Default Button: “OK”, Commit: “Yes”; Button 2: “cancel”, Commit: “No” ]
    If [ Get (LastMessageChoice) = 1 ]
    #
    #This next variable prevents the user getting
    #asked redunant questions by the help script.
    Set Variable [ $$gotoHelpObject; Value:1 ]
    Close Window [ Current Window ]
    Perform Script [ “help” ]
    Set Variable [ $$gotoHelpObject ]
    #
    #Tell user how to get the help for this interface
    #if they choose to remain focused on it.
    Else
    Show Custom Dialog [ Message: "To view help for this interface once you are done with it 1) click any ? button. 2) Click the return button if given that option. 3) Click the Help App's menu button. 3) Click — " & $$helpLayoutName & "."; Default Button: “OK”, Commit: “Yes” ]
    Pause/Resume Script [ Indefinitely ]
    End If
    #
    #

Fields used in this script

Scripts used in this script

    help

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [helpAllApps]	Parent Folder: [help]	Next Script: [helpReferenceAddToTag]
Script Name	helpBack
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #This script functions like a browsers back button
    #script, taking users back thru help windows bread
    #crumb style.
    If [ ValueCount ( tempSetup::helpName ) = 1 ]
    Exit Script [ ]
    Else
    Set Variable [ $value1; Value:GetValue ( tempSetup::helpName ; ValueCount ( tempSetup::helpName ) ) ]
    Set Field [ tempSetup::helpName; Substitute ( $value1 ; tempSetup::helpName ; "" &¶ ) ]
    Set Variable [ $value1; Value:GetValue ( tempSetup::helpName ; 1 ) ]
    Go to Layout [ $value1 ]
    End If

Fields used in this script

    tempSetup::helpName

Scripts used in this script

Layouts used in this script

Tables used in this script

    TEMP

Table occurrences used by this script

    tempSetup

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [helpBack]	Parent Folder: [help]	Next Script: [libraryHelp]
Script Name	helpReferenceAddToTag
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    addMenu1
    addMenuNodeKeyword
    addMenu2
    addMenuTestItem
    ReferenceAddToTag
    ReferenceAddToCopyright

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Send general layout name and help column
    #number to the help script so it can take the
    #user to help for this layout and column.
    Set Variable [ $$helpLayoutName; Value:"Reference" ]
    #
    #Send user to help column.
    Set Variable [ $$helpColumnName; Value:"A" ]
    Perform Script [ “help” ]
    #
    #

Fields used in this script

Scripts used in this script

    help

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [helpReferenceAddToTag]	Parent Folder: [help]
Script Name	libraryHelp
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #So there are two help button scripts because I changed
    #mind and used an external help module forgetting
    #I already had a help button script. So some help buttons
    #are attached to one script and some to this one and
    #rather than figure this out, I just made this script
    #reference other one. As you can see by its name this
    #used to take users to an internal library help system.
    Perform Script [ “help” ]
    #

Fields used in this script

Scripts used in this script

    help

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


learn
	Parent Folder: [learn]	Next Script: [helpLearnFind]
Script Name	helpLearnEdit
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    LearnTextWindow
    LearnTextWindow_iDevice
    LearnTextWindowStuff
    LearnTextWindowStuff_iDevice
    LearnTextWindowLocked
    LearnTextWindowLocked_iDevice

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Send general layout name and help column
    #number to the help script so it can take the
    #user to help for this layout and column.
    Set Variable [ $$helpLayoutName; Value:"Learn" ]
    Set Variable [ $$helpColumnName; Value:"B" ]
    Perform Script [ “help” ]
    #
    #

Fields used in this script

Scripts used in this script

    help

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [helpLearnEdit]	Parent Folder: [learn]	Next Script: [helpLearnMain]
Script Name	helpLearnFind
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    learnFIND

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Send general layout name and help column
    #number to the help script so it can take the
    #user to help for this layout and column.
    Set Variable [ $$helpLayoutName; Value:"Learn" ]
    Set Variable [ $$helpColumnName; Value:"C" ]
    #
    #
    #Inform user they must cancel the find before
    #they will be able to go to the help window as
    #in find mode the focus is locked on it until
    #the find is complete.
    Show Custom Dialog [ Message: "If you are OK with exiting this interface to navigate to its help column — " & $$helpColumnName & " — click OK. The system is locked while its focused on this interface, which is why exiting it is requried."; Default Button: “OK”, Commit: “Yes”; Button 2: “cancel”, Commit: “No” ]
    If [ Get (LastMessageChoice) = 1 ]
    #This next variable prevents the user getting
    #asked redunant questions by the help script.
    Set Variable [ $$gotoHelpObject; Value:1 ]
    Set Variable [ $$doNotHaltOtherScripts; Value:1 ]
    Perform Script [ “cancelLearnAndRefFind” ]
    Set Variable [ $$doNotHaltOtherScripts ]
    Perform Script [ “help” ]
    Set Variable [ $$gotoHelpObject ]
    Select Window [ Name: "Help" ]
    Select Window [ Name: "Tutorial" ]
    Halt Script
    #
    #Tell user how to get the help for this interface
    #if they choose to remain focused on it.
    Else
    Show Custom Dialog [ Message: "To view help when done 1) click any ? button. 2) Click the return button, if given that option. 3) Click the Help App's menu button. 3) Click — " & $$helpLayoutName & " 3) Scroll to column — " & $$helpColumnName & "."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #

Fields used in this script

Scripts used in this script

    cancelLearnAndRefFind
    help

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [helpLearnFind]	Parent Folder: [learn]	Next Script: [helpLearnQV]
Script Name	helpLearnMain
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    learn0
    learnStuff0
    learn1
    learnStuff1
    learn2
    learnStuff2
    learn3
    learnStuff3
    learn4
    learnStuff4
    learn5
    learnStuff5

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Send general layout name and help column
    #number to the help script so it can take the
    #user to help for this layout and column.
    Set Variable [ $$helpLayoutName; Value:"Learn" ]
    Set Variable [ $$helpColumnName; Value:"A" ]
    Perform Script [ “help” ]
    #
    #

Fields used in this script

Scripts used in this script

    help

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [helpLearnMain]	Parent Folder: [learn]	Next Script: [helpLearnShare]
Script Name	helpLearnQV
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    learn4EDIT
    learn4EDITLocked
    learn4EDITstuff
    learn4EDITstuffLocked

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Send general layout name and help column
    #number to the help script so it can take the
    #user to help for this layout and column.
    Set Variable [ $$helpLayoutName; Value:"Learn" ]
    Set Variable [ $$helpColumnName; Value:"A14" ]
    Perform Script [ “help” ]
    #
    #

Fields used in this script

Scripts used in this script

    help

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [helpLearnQV]	Parent Folder: [learn]	Next Script: [helpLearnTag]
Script Name	helpLearnShare
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    learnPreviewLayoutView

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Send general layout name and help column
    #number to the help script so it can take the
    #user to help for this layout and column.
    Set Variable [ $$helpLayoutName; Value:"Learn" ]
    Set Variable [ $$helpColumnName; Value:"D" ]
    Perform Script [ “help” ]
    #
    #

Fields used in this script

Scripts used in this script

    help

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [helpLearnShare]	Parent Folder: [learn]	Next Script: [helpLearnTagFindLearnRecord]
Script Name	helpLearnTag
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ltagNK1
    ltagNKs1
    ltagNK2
    ltagNKs2
    ltagNK3
    ltagNKs3
    ltagNK4
    ltagNKs4
    ltagNK5
    ltagNKs5
    learnMenu3Cite
    learnMenu3CiteS
    learnMenuRefStuff
    learnMenu4RefCite
    learnMenu4noPicRefCite
    learnMenuBrainstorm
    learnMenuStuffBrainstorm
    learnTest

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Send general layout name and help column
    #number to the help script so it can take the
    #user to help for this layout and column.
    Set Variable [ $$helpLayoutName; Value:"Learn" ]
    #
    #Send user to idea or inventory help column.
    If [ TEMP::InventoryLibraryYN = "" ]
    Set Variable [ $$helpColumnName; Value:"E" ]
    Else
    Set Variable [ $$helpColumnName; Value:"F" ]
    End If
    Perform Script [ “help” ]
    #
    #

Fields used in this script

    TEMP::InventoryLibraryYN

Scripts used in this script

    help

Layouts used in this script

Tables used in this script

    TEMP

Table occurrences used by this script

    TEMP

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [helpLearnTag]	Parent Folder: [learn]	Next Script: [helpLearnTagFindTag]
Script Name	helpLearnTagFindLearnRecord
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    learnFind
    learnKeywordOrNodeFind
    learnKeywordOrNodeSFind
    learnFindTest
    learnFindBrainstorm
    learnFindStuffBrainstorm
    learnFindCite
    learnFindCiteS
    learnFindStuffCite
    learnMenu4NoPicRefCiteFindTL
    learnMenu4RefCiteFindTL

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Send general layout name and help column
    #number to the help script so it can take the
    #user to help for this layout and column.
    Set Variable [ $$helpLayoutName; Value:"Learn" ]
    #
    #Send user to idea or inventory help column.
    If [ TEMP::InventoryLibraryYN = "" ]
    Set Variable [ $$helpColumnName; Value:"G" ]
    Else
    Set Variable [ $$helpColumnName; Value:"H" ]
    End If
    Perform Script [ “help” ]
    #
    #

Fields used in this script

    TEMP::InventoryLibraryYN

Scripts used in this script

    help

Layouts used in this script

Tables used in this script

    TEMP

Table occurrences used by this script

    TEMP

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [helpLearnTagFindLearnRecord]	Parent Folder: [learn]
Script Name	helpLearnTagFindTag
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    learnMenuFINDref
    learnMenuFINDrefLearn
    learnMenuFINDstuffRef
    ltagFINDNK
    ltagFINDstuffNK

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Send general layout name and help column
    #number to the help script so it can take the
    #user to help for this layout and column.
    #Send user to idea or inventory help column.
    Set Variable [ $$helpLayoutName; Value:"Learn" ]
    #
    If [ TEMP::InventoryLibraryYN = "" ]
    Set Variable [ $$helpColumnName; Value:"I" ]
    Else
    Set Variable [ $$helpColumnName; Value:"J" ]
    End If
    #
    #
    #Inform user they must cancel the find before
    #they will be able to go to the help window as
    #in find mode the focus is locked on it until
    #the find is complete.
    Show Custom Dialog [ Message: "If you are OK with exiting this interface to navigate to its help column — " & $$helpColumnName & " — click OK. The system is locked while its focused on this interface, which is why exiting it is requried."; Default Button: “OK”, Commit: “Yes”; Button 2: “cancel”, Commit: “No” ]
    If [ Get (LastMessageChoice) = 1 ]
    #This next variable prevents the user getting
    #asked redunant questions by the help script.
    Set Variable [ $$gotoHelpObject; Value:1 ]
    Set Variable [ $$doNotHaltOtherScripts; Value:1 ]
    Enter Browse Mode
    Perform Script [ “help” ]
    Set Variable [ $$doNotHaltOtherScripts ]
    Select Window [ Name: "Help" ]
    Set Variable [ $$gotoHelpObject ]
    Select Window [ Name: "Tutorial" ]
    Halt Script
    #
    #Tell user how to get the help for this interface
    #if they choose to remain focused on it.
    Else
    Show Custom Dialog [ Message: "To view help when done 1) click any ? button. 2) Click the return button, if given that option. 3) Click the Help App's menu button. 3) Click — " & $$helpLayoutName & " 3) Scroll to column — " & $$helpColumnName & "."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #

Fields used in this script

    TEMP::InventoryLibraryYN

Scripts used in this script

    help

Layouts used in this script

Tables used in this script

    TEMP

Table occurrences used by this script

    TEMP

Custom Functions used by this script

Custom menu set used by this script


reference
	Parent Folder: [reference]	Next Script: [helpReferenceFind]
Script Name	helpReferenceEdit
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferenceEDIT
    ReferenceFilePathEDIT

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Send general layout name and help column
    #number to the help script so it can take the
    #user to help for this layout and column.
    Set Variable [ $$helpLayoutName; Value:"Reference" ]
    Set Variable [ $$helpColumnName; Value:"B" ]
    Perform Script [ “help” ]
    #
    #

Fields used in this script

Scripts used in this script

    help

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [helpReferenceEdit]	Parent Folder: [reference]	Next Script: [helpReferenceMain]
Script Name	helpReferenceFind
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferenceFIND
    ReferenceFINDstuff

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Send general layout name and help column
    #number to the help script so it can take the
    #user to help for this layout and column.
    Set Variable [ $$helpLayoutName; Value:"Reference" ]
    Set Variable [ $$helpColumnName; Value:"C" ]
    #
    #
    #Inform user they must cancel the find before
    #they will be able to go to the help window as
    #in find mode the focus is locked on it until
    #the find is complete.
    Show Custom Dialog [ Message: "If you are OK with exiting this interface to navigate to its help column — " & $$helpColumnName & " — click OK. The system is locked while its focused on this interface, which is why exiting it is requried."; Default Button: “OK”, Commit: “Yes”; Button 2: “cancel”, Commit: “No” ]
    If [ Get (LastMessageChoice) = 1 ]
    #This next variable prevents the user getting
    #asked redunant questions by the help script.
    Set Variable [ $$gotoHelpObject; Value:1 ]
    Set Variable [ $$doNotHaltOtherScripts; Value:1 ]
    Perform Script [ “cancelLearnAndRefFind” ]
    Set Variable [ $$doNotHaltOtherScripts ]
    Perform Script [ “help” ]
    Set Variable [ $$gotoHelpObject ]
    Select Window [ Name: "Help" ]
    Select Window [ Name: "Tutorial" ]
    Halt Script
    #
    #Tell user how to get the help for this interface
    #if they choose to remain focused on it.
    Else
    Show Custom Dialog [ Message: "To view help when done 1) click any ? button. 2) Click the return button, if given that option. 3) Click the Help App's menu button. 3) Click — " & $$helpLayoutName & " 3) Scroll to column — " & $$helpColumnName & "."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #

Fields used in this script

Scripts used in this script

    cancelLearnAndRefFind
    help

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [helpReferenceFind]	Parent Folder: [reference]	Next Script: [helpReferenceTag]
Script Name	helpReferenceMain
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    Reference

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Send general layout name and help column
    #number to the help script so it can take the
    #user to help for this layout and column.
    Set Variable [ $$helpLayoutName; Value:"Reference" ]
    Set Variable [ $$helpColumnName; Value:"A" ]
    Perform Script [ “help” ]
    #
    #

Fields used in this script

Scripts used in this script

    help

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [helpReferenceMain]	Parent Folder: [reference]	Next Script: [helpReferenceTagFindReferenceRecord]
Script Name	helpReferenceTag
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferenceMenu1
    ReferenceMenuCopyright
    ReferenceMenu3Cite
    ReferenceMenu3CiteNoPicture
    ReferenceMenu2keywordOrNode1
    ReferenceMenu2keywordOrNode2
    ReferenceMenu2keywordOrNode3
    ReferenceMenu2keywordOrNode4
    ReferenceMenu2keywordOrNode5

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Send general layout name and help column
    #number to the help script so it can take the
    #user to help for this layout and column.
    Set Variable [ $$helpLayoutName; Value:"Reference" ]
    #
    #Send user to help column.
    If [ $$citationMatch = "node" ]
    Set Variable [ $$helpColumnName; Value:"D" ]
    Else If [ $$citationMatch = "copyright" ]
    Set Variable [ $$helpColumnName; Value:"E" ]
    Else If [ $$citationMatch = "cite" ]
    Set Variable [ $$helpColumnName; Value:"G" ]
    Else
    Set Variable [ $$helpColumnName; Value:"F" ]
    End If
    Perform Script [ “help” ]
    #
    #

Fields used in this script

Scripts used in this script

    help

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [helpReferenceTag]	Parent Folder: [reference]	Next Script: [helpReferenceTagFindTag]
Script Name	helpReferenceTagFindReferenceRecord
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferenceMenuFind
    ReferenceMenu3CiteFind
    ReferenceMenu3CiteFindS
    ReferenceMenu2keywordOrNodeFind

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Send general layout name and help column
    #number to the help script so it can take the
    #user to help for this layout and column.
    Set Variable [ $$helpLayoutName; Value:"Reference" ]
    #
    #Send user to help column.
    Set Variable [ $$helpColumnName; Value:"H" ]
    Perform Script [ “help” ]
    #
    #

Fields used in this script

Scripts used in this script

    help

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [helpReferenceTagFindReferenceRecord]	Parent Folder: [reference]
Script Name	helpReferenceTagFindTag
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    referenceMenuFINDref
    referenceFINDNK
    referenceSFINDNK

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Send general layout name and help column
    #number to the help script so it can take the
    #user to help for this layout and column.
    #Send user to idea or inventory help column.
    Set Variable [ $$helpLayoutName; Value:"Learn" ]
    #
    Set Variable [ $$helpColumnName; Value:"H" ]
    #
    #
    #Inform user they must cancel the find before
    #they will be able to go to the help window as
    #in find mode the focus is locked on it until
    #the find is complete.
    Show Custom Dialog [ Message: "If you are OK with exiting this interface to navigate to its help column — " & $$helpColumnName & " — click OK. The system is locked while its focused on this interface, which is why exiting it is requried."; Default Button: “OK”, Commit: “Yes”; Button 2: “cancel”, Commit: “No” ]
    If [ Get (LastMessageChoice) = 1 ]
    #This next variable prevents the user getting
    #asked redunant questions by the help script.
    Set Variable [ $$gotoHelpObject; Value:1 ]
    Set Variable [ $$doNotHaltOtherScripts; Value:1 ]
    Enter Browse Mode
    Perform Script [ “help” ]
    Set Variable [ $$doNotHaltOtherScripts ]
    Select Window [ Name: "Help" ]
    Set Variable [ $$gotoHelpObject ]
    Select Window [ Name: "Tutorial" ]
    Halt Script
    #
    #Tell user how to get the help for this interface
    #if they choose to remain focused on it.
    Else
    Show Custom Dialog [ Message: "To view help when done 1) click any ? button. 2) Click the return button, if given that option. 3) Click the Help App's menu button. 3) Click — " & $$helpLayoutName & " 3) Scroll to column — " & $$helpColumnName & "."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #

Fields used in this script

Scripts used in this script

    help

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


setup
	Parent Folder: [setup]	Next Script: [helpSetupTagAllDefault]
Script Name	helpSetupMain
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultSetup

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Send general layout name and help column
    #number to the help script so it can take the
    #user to help for this layout and column.
    Set Variable [ $$helpLayoutName; Value:"Setup" ]
    Set Variable [ $$helpColumnName; Value:"A" ]
    Perform Script [ “help” ]
    #
    #

Fields used in this script

Scripts used in this script

    help

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [helpSetupMain]	Parent Folder: [setup]	Next Script: [helpSetupTagCopyright]
Script Name	helpSetupTagAllDefault
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultsAll

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Send general layout name and help column
    #number to the help script so it can take the
    #user to help for this layout and column.
    Set Variable [ $$helpLayoutName; Value:"Setup" ]
    #
    #Send user to help column.
    Set Variable [ $$helpColumnName; Value:"E" ]
    Perform Script [ “help” ]
    #
    #

Fields used in this script

Scripts used in this script

    help

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [helpSetupTagAllDefault]	Parent Folder: [setup]	Next Script: [helpSetupTagCopyrightReview]
Script Name	helpSetupTagCopyright
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultCopyright

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Send general layout name and help column
    #number to the help script so it can take the
    #user to help for this layout and column.
    Set Variable [ $$helpLayoutName; Value:"Setup" ]
    #
    #Send user to help column.
    Set Variable [ $$helpColumnName; Value:"G" ]
    Perform Script [ “help” ]
    #
    #

Fields used in this script

Scripts used in this script

    help

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [helpSetupTagCopyright]	Parent Folder: [setup]	Next Script: [helpSetupTagNode]
Script Name	helpSetupTagCopyrightReview
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    CopyrightVIEW
    CopyrightEDIT

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Send general layout name and help column
    #number to the help script so it can take the
    #user to help for this layout and column.
    Set Variable [ $$helpLayoutName; Value:"Setup" ]
    Set Variable [ $$helpColumnName; Value:"H" ]
    #
    #Inform user they must cancel the find before
    #they will be able to go to the help window as
    #in find mode the focus is locked on it until
    #the find is complete.
    Show Custom Dialog [ Message: "If you are OK with exiting this interface to navigate to its help column — " & $$helpColumnName & " — click OK. The system is locked while its focused on this interface, which is why exiting it is requried."; Default Button: “OK”, Commit: “Yes”; Button 2: “cancel”, Commit: “No” ]
    If [ Get (LastMessageChoice) = 1 ]
    #
    #This next variable prevents the user getting
    #asked redunant questions by the help script.
    Set Variable [ $$gotoHelpObject; Value:1 ]
    Close Window [ Current Window ]
    Perform Script [ “help” ]
    Set Variable [ $$gotoHelpObject ]
    #
    #Tell user how to get the help for this interface
    #if they choose to remain focused on it.
    Else
    Show Custom Dialog [ Message: "To view help for this interface once you are done with it 1) click any ? button. 2) Click the return button if given that option. 3) Click the Help App's menu button. 3) Click — " & $$helpLayoutName & "."; Default Button: “OK”, Commit: “Yes” ]
    Pause/Resume Script [ Indefinitely ]
    End If
    #

Fields used in this script

Scripts used in this script

    help

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [helpSetupTagCopyrightReview]	Parent Folder: [setup]	Next Script: [helpSetupTest]
Script Name	helpSetupTagNode
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultNode1
    defaultNode2
    defaultNodeS2
    defaultNode3
    defaultNodeS3
    defaultNodeS4
    defaultNode4

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Send general layout name and help column
    #number to the help script so it can take the
    #user to help for this layout and column.
    Set Variable [ $$helpLayoutName; Value:"Setup" ]
    #
    #Send user to help column.
    Set Variable [ $$helpColumnName; Value:"F" ]
    Perform Script [ “help” ]
    #
    #

Fields used in this script

Scripts used in this script

    help

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [helpSetupTagNode]	Parent Folder: [setup]	Next Script: [helpSetupTestEdit]
Script Name	helpSetupTest
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultTest

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Send general layout name and help column
    #number to the help script so it can take the
    #user to help for this layout and column.
    Set Variable [ $$helpLayoutName; Value:"Setup" ]
    Set Variable [ $$helpColumnName; Value:"C" ]
    Perform Script [ “help” ]
    #
    #

Fields used in this script

Scripts used in this script

    help

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [helpSetupTest]	Parent Folder: [setup]
Script Name	helpSetupTestEdit
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultTestNewSection

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Send general layout name and help column
    #number to the help script so it can take the
    #user to help for this layout and column.
    Set Variable [ $$helpLayoutName; Value:"Setup" ]
    Set Variable [ $$helpColumnName; Value:"D" ]
    Perform Script [ “help” ]
    #
    #

Fields used in this script

Scripts used in this script

    help

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


test
	Parent Folder: [test]	Next Script: [helpTest]
Script Name	helpSetupTest
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    setupTestSection
    setupTestSubsection
    setupTestItem
    setupTestItemLOCKED

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Send general layout name and help column
    #number to the help script so it can take the
    #user to help for this layout and column.
    Set Variable [ $$helpLayoutName; Value:"Test" ]
    Set Variable [ $$helpColumnName; Value:"B" ]
    Perform Script [ “help” ]
    #
    #

Fields used in this script

Scripts used in this script

    help

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [helpSetupTest]	Parent Folder: [test]	Next Script: [helpTestReportMain]
Script Name	helpTest
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    testingSubsectionMenu
    testResult0
    testResultLOCKED0
    testResult1
    testResultLOCKED1
    testResult2
    testResultLOCKED2
    testResult3
    testResultLOCKED3
    testResult4
    testResultLOCKED4
    testResult5
    testResultLOCKED5
    testInfo
    testMenuTestItem

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Send general layout name and help column
    #number to the help script so it can take the
    #user to help for this layout and column.
    Set Variable [ $$helpLayoutName; Value:"Test" ]
    Set Variable [ $$helpColumnName; Value:"C" ]
    Perform Script [ “help” ]
    #
    #

Fields used in this script

Scripts used in this script

    help

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [helpTest]	Parent Folder: [test]	Next Script: [helpTestReportTagInfo]
Script Name	helpTestReportMain
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    PrintReportEdit
    PrintReportLock

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Send general layout name and help column
    #number to the help script so it can take the
    #user to help for this layout and column.
    Set Variable [ $$helpLayoutName; Value:"Test" ]
    Set Variable [ $$helpColumnName; Value:"D" ]
    Perform Script [ “help” ]
    #
    #

Fields used in this script

Scripts used in this script

    help

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [helpTestReportMain]	Parent Folder: [test]	Next Script: [helpTestReportTagItem]
Script Name	helpTestReportTagInfo
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    TestInfoReference
    reportTagInfo

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Send general layout name and help column
    #number to the help script so it can take the
    #user to help for this layout and column.
    Set Variable [ $$helpLayoutName; Value:"Test" ]
    Set Variable [ $$helpColumnName; Value:"G" ]
    Perform Script [ “help” ]
    #
    #

Fields used in this script

Scripts used in this script

    help

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [helpTestReportTagInfo]	Parent Folder: [test]	Next Script: [helpTestReportTagResult]
Script Name	helpTestReportTagItem
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    reportTagItem

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Send general layout name and help column
    #number to the help script so it can take the
    #user to help for this layout and column.
    Set Variable [ $$helpLayoutName; Value:"Test" ]
    Set Variable [ $$helpColumnName; Value:"F" ]
    Perform Script [ “help” ]
    #
    #

Fields used in this script

Scripts used in this script

    help

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [helpTestReportTagItem]	Parent Folder: [test]
Script Name	helpTestReportTagResult
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    reportTestResult
    reportTestResultLocked

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Send general layout name and help column
    #number to the help script so it can take the
    #user to help for this layout and column.
    Set Variable [ $$helpLayoutName; Value:"Test" ]
    Set Variable [ $$helpColumnName; Value:"E" ]
    Perform Script [ “help” ]
    #
    #

Fields used in this script

Scripts used in this script

    help

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


learn
	Parent Folder: [learn]	Next Script: [catchFindLearnErrorMessages]
Script Name	cancelLearnAndRefFind
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferenceFIND
    ReferenceFINDallfields
    ReferenceFINDstuff
    learnFIND

Scripts that use this script

    helpLearnFind
    helpReferenceFind
    findLearnRecord
    findReferenceRecord

Script Definition
Script Steps

    #
    #This script is used by the findLearnRecord
    #and findReferenceRecord scripts.
    #
    #
    #!!! IMPORTANT !!! SAY WHAT !!! HERE YE, HERE YE !!!
    #
    #The cancel logic of this script is identical
    #to the logic in the ActionLog's cancelFindSpecificAction
    #script. Any changes made to this logic needs
    #to also be made to that script to keep
    #them identical.
    #
    #!!! IMPORTANT !!! SAY WHAT !!! HERE YE, HERE YE !!!
    #
    #
    #BEGIN identical catch error logic
    #
    #
    #Admin tasks.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #Clear out any invalid find requests,
    #otherwise script will fail to go back
    # to the main layout.
    Set Field [ testlearn::note; "" ]
    Set Field [ testlearn::timestamp; "" ]
    Set Field [ testlearn::brainstormCasePoint; "" ]
    #
    Set Variable [ $$clearUserFindRequests; Value:1 ]
    Perform Script [ “CHUNK_findReferenceRecordUserFindRequests” ]
    Set Variable [ $$clearUserFindRequests ]
    #
    #Then return to the main layout.
    If [ Get ( LayoutTableName ) = "reference" ]
    #
    If [ $$findReferenceLayout = "" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “ReferenceStuff” (reference) ]
    Else
    Go to Layout [ “Reference” (reference) ]
    End If
    #
    Else
    Go to Layout [ $$findReferenceLayout ]
    Set Variable [ $$findReferenceLayout ]
    End If
    Else
    If [ $$findLearnLayout = "" ]
    #
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “learnStuff3” (testlearn) ]
    Else
    Go to Layout [ “learn3” (testlearn) ]
    End If
    #
    Else
    Go to Layout [ $$findLearnLayout ]
    Set Variable [ $$findLearnLayout ]
    End If
    End If
    #
    #Exit find mode.
    Enter Browse Mode
    #
    #Only find all records if there are no records to
    #show (the records the user was looking at
    #before clicking find).
    If [ Get (FoundCount) = 0 ]
    Perform Script [ “findALL_LearnOrRefRecords” ]
    End If
    #
    #Clear user find request variables.
    Set Variable [ $$note ]
    Set Variable [ $$timestamp ]
    Set Variable [ $$brainstormCasePoint ]
    #
    #Clear out all the pause script requests,
    #unless this script was started by the help
    #script, in which case it will halt all scripts
    #after it is finished.
    If [ $$doNotHaltOtherScripts = "" ]
    Halt Script
    End If
    #
    #
    #END identical cancel error logic
    #
    #

Fields used in this script

    testlearn::note
    testlearn::timestamp
    testlearn::brainstormCasePoint
    TEMP::InventoryLibraryYN

Scripts used in this script

    CHUNK_findReferenceRecordUserFindRequests
    findALL_LearnOrRefRecords

Layouts used in this script

    ReferenceStuff
    Reference
    learnStuff3
    learn3
    <Missing Layout>

Tables used in this script

    TEMP
    testlearn

Table occurrences used by this script

    TEMP
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [cancelLearnAndRefFind]	Parent Folder: [learn]	Next Script: [catchFindLearnErrorMessagesBrainstormCasePointFieldBUTTON]
Script Name	catchFindLearnErrorMessages
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    learnFIND

Scripts that use this script

    catchFindLearnErrorMessagesBrainstormCasePointFieldBUTTON
    catchFindLearnErrorMessagesTextFieldBUTTON
    catchFindLearnErrorMessagesTimestampFieldBUTTON
    findLearnRecord

Script Definition
Script Steps

    #
    #This script is used by the findLearnRecord script.
    #
    #!!! IMPORTANT !!! SAY WHAT !!! HERE YE, HERE YE !!!
    #
    #The error check logic of this script is identical
    #to the logic in the ActionLog's catch error
    #message script and the catchFindReferenceErrorMessage
    #script. Any changes made to this logic needs
    #to also be made to those scripts to keep
    #them all identical.
    #
    #!!! IMPORTANT !!! SAY WHAT !!! HERE YE, HERE YE !!!
    #
    #
    #BEGIN identical catch error logic
    #
    #
    #Admin tasks.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #
    #Copy the user's current find request.
    Set Variable [ $$note; Value:testlearn::note ]
    Set Variable [ $$timestamp; Value:testlearn::timestamp ]
    Set Variable [ $$brainstormCasePoint; Value:testlearn::brainstormCasePoint ]
    #
    #
    #Enter the text field and exit it to see if a "user
    #cancelled action" = 1 error is generated or the
    #508 = "invalid find request" variable is generated.
    If [ $$note ≠ "" ]
    Set Field [ testlearn::note; $$note ]
    #
    #BUG: The 1 error is a bug because the script,
    #not the user, is generating the error. If the user
    #actually click's into another field causing the
    #error that this script will now look for, FileMaker
    #fails to pass along this error code. The only
    #way to know if it is happening is to have a
    #script generate this "user" caused 1 error.
    # Now in the test of a text field, FileMaker
    #will not allow an invalid find request to be
    #entered by the script, generating a 508 error
    #when the attempt is made. In contrast, an
    #invalid find request is allowed to be put into
    #a date field by FileMaker = 500 error,
    #however, FileMaker will not allow the script to
    #leave the bad date in the field and generates
    #the "user cancelled action" = 1 error when
    #the script moves on.
    #
    #If an error is produced...
    If [ Get (LastError) = 1 or Get (LastError) = 508 ]
    #
    #Check the text field to see if an error is being
    #caused by question marks.
    If [ Left ( Filter ( $$note ; "?" ) ; 1 ) = "?" and Left ( $$note ; 2 ) ≠ "*\"" and Right ( $$note ; 1 ) ≠ "\"" or Left ( Filter ( $$note ; "?" ) ; 1 ) = "?" and Left ( $$note ; 1 ) ≠ "\"" and Right ( $$note ; 1 ) ≠ "\"" ]
    #
    #Make find request valid.
    Set Field [ testlearn::note; "*" & Quote ( $$note ) ]
    #
    #Explain problem with question marks in the
    #find request.
    Show Custom Dialog [ Message: "Find requests that include a question mark with a space between it and another character, or find requests with two or more question marks in a row \"like this ???\" must be put in quotes."; Default Button: “OK”, Commit: “No” ]
    Show Custom Dialog [ Message: "This is now done. The astrix before the first quote is to find what you've typed starting from anywhere including the beginning of phase, or the middle of a word."; Default Button: “OK”, Commit: “No” ]
    #
    #Return to the text field and allow the user to
    #edit their find request.
    Go to Field [ testlearn::note ]
    Pause/Resume Script [ Indefinitely ]
    #
    #If this script was activated by the user, which
    #would turn on the GoToField variable...
    If [ $$GoToField ≠ "" ]
    #
    #Reset this go to field variable for future use.
    Set Variable [ $$GoToField ]
    Exit Script [ ]
    #
    #If this script was activated by find script...
    Else If [ $$GoToField = "" ]
    #
    #Start this script over.
    # NOTE: The user can leave a text box with
    #an invalid find, and if they do by hitting the
    #return key on a desktop computer, or the go
    #key on an iDevice keyboard, this script will
    #exit, which is bad. This relaunch of
    #this script below is exactly what happens
    #when the user clicks the 'find' button on the
    #layout.
    # A copy of this script needs to be running
    #during a find request session to catch any
    #textbox invalid find requests, and inform the
    #user about how to deal with them.
    # The result being that many copies of the
    #script will be running if the user makes many
    #invalid find requests in a row. No problem.
    # Once the user finally makes a valid find
    #request, or cancels their find session, this
    #script or the cancel find script will halt all
    #copies of the script launched during the
    #sesion.
    Perform Script [ “findLearnRecord” ]
    Exit Script [ ]
    End If
    End If
    End If
    End If
    #
    #
    #Check the timestamp field to see if it is
    #improperly formatted.
    If [ $$timestamp ≠ "" ]
    #
    #Enter the timestamp field and exit it to see if
    #a "user cancelled action" = 1 error is generated.
    #SEE ABOVE BUG.
    Set Field [ testlearn::timestamp; $$timestamp ]
    Go to Field [ testlearn::timestamp ]
    Go to Field [ ]
    #
    #If an error is produced...
    If [ Get (LastError) = 1 ]
    Set Field [ testlearn::timestamp; $$timestamp ]
    #
    #Explain problems with enter date and time
    #and how this problem can be addressed.
    Show Custom Dialog [ Message: "Date searches must include both date and time entered like this" & ¶ & "1/5/2018 12:25:30."; Default Button: “OK”, Commit: “No” ]
    Show Custom Dialog [ Message: "You can replace the M/D/2018 H:M:S numbers with asterisks to, for example, search by year = */*/2018 *:*:*"; Default Button: “OK”, Commit: “No” ]
    Show Custom Dialog [ Message: "Click the 'less than' (or search before this date), 'more than' (or search after this date), or between dates search strategy buttons, and a properly formatted date search will be inserted for you to edit."; Default Button: “OK”, Commit: “No” ]
    #
    #Return to the timestamp field and allow the
    #user to edit their find request.
    Go to Field [ testlearn::timestamp ]
    Pause/Resume Script [ Indefinitely ]
    #
    #If this script was activated by the user, which
    #would turn on the GoToField variable...
    If [ $$GoToField ≠ "" ]
    #
    #Reset this go to field variable for future use.
    Set Variable [ $$GoToField ]
    Exit Script [ ]
    #
    #If this script was activated by find script...
    Else If [ $$GoToField = "" ]
    #
    #Start this script over. SEE ABOVE NOTE.
    Perform Script [ “findLearnRecord” ]
    Exit Script [ ]
    End If
    End If
    End If
    #
    #
    #Peform one last invalid find error check just to
    #catch any that do not involve the quesion mark.
    If [ $$caption ≠ "" ]
    Set Field [ testlearn::note; $$note ]
    #
    #If an error is produced...
    If [ Get (LastError) = 1 or Get (LastError) = 508 ]
    #
    #Make find request valid.
    Set Field [ testlearn::note; "*" & Quote ( $$note ) ]
    #
    #Explain unknown invalid find request error
    #and its remedy.
    Show Custom Dialog [ Message: "Find request is producing an \"invalid find request\" error. Putting it in quotes should make FileMaker happy."; Default Button: “OK”, Commit: “No” ]
    Show Custom Dialog [ Message: "This is now done. The astrix before the first quote is to find what you've typed starting from anywhere including the beginning of phase, or the middle of a word."; Default Button: “OK”, Commit: “No” ]
    Show Custom Dialog [ Message: "If you continue to get this error message, you'll need to change your find request."; Default Button: “OK”, Commit: “No” ]
    #
    #Return to the text field and allow the user to
    #edit their find request.
    Go to Field [ testlearn::note ]
    Pause/Resume Script [ Indefinitely ]
    #
    #
    #If this script was activated by the user, which
    #would turn on the GoToField variable...
    If [ $$GoToField ≠ "" ]
    #
    #Reset this go to field variable for future use.
    Set Variable [ $$GoToField ]
    Exit Script [ ]
    #
    #If this script was activated by find script...
    Else If [ $$GoToField = "" ]
    #
    #Start this script over. SEE ABOVE NOTE.
    Perform Script [ “findLearnRecord” ]
    Exit Script [ ]
    End If
    End If
    End If
    #
    #
    #In order to generate an invalid find request
    #custom error message, I had to turn the
    #layouts fields into buttons, which run scripts
    #that all turn on this script and generate the
    #error 1. If no error is actually found, these
    #next steps actually enter the field the user
    #wanted to enter. End result for the user is
    #looks like they are entering a field instead of
    #pressing a button. OH IF ONLY FileMaker
    #would pass along the invalid find request
    #variable!!! Well, until it does, this work around
    #does the job (except when the user just hits
    #the return key on a desktop computer).
    If [ $$GoToField = "note" ]
    Go to Field [ testlearn::note ]
    #
    Else If [ $$GoToField = "Timestamp" ]
    Go to Field [ testlearn::timestamp ]
    #
    Else If [ $$GoToField = "brainstormCasePoint" ]
    #
    If [ testlearn::brainstormCasePoint = "" ]
    Set Field [ testlearn::brainstormCasePoint; 1 ]
    Go to Field [ ]
    Else
    Set Field [ testlearn::brainstormCasePoint; "" ]
    Go to Field [ ]
    End If
    #
    End If
    #
    #Reset this go to field variable for future use.
    Set Variable [ $$GoToField ]
    #
    #
    #END identical catch error logic
    #
    #

Fields used in this script

    testlearn::note
    testlearn::timestamp
    testlearn::brainstormCasePoint

Scripts used in this script

    findLearnRecord

Layouts used in this script

Tables used in this script

    testlearn

Table occurrences used by this script

    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [catchFindLearnErrorMessages]	Parent Folder: [learn]	Next Script: [catchFindLearnErrorMessagesTextFieldBUTTON]
Script Name	catchFindLearnErrorMessagesBrainstormCasePointFieldBUTTON
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    learnFIND

Scripts that use this script

Script Definition
Script Steps

    #
    Set Variable [ $$GoToField; Value:"brainstormCasePoint" ]
    #
    Perform Script [ “catchFindLearnErrorMessages” ]
    #

Fields used in this script

Scripts used in this script

    catchFindLearnErrorMessages

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [catchFindLearnErrorMessagesBrainstormCasePointFieldBUTTON]	Parent Folder: [learn]	Next Script: [catchFindLearnErrorMessagesTimestampFieldBUTTON]
Script Name	catchFindLearnErrorMessagesTextFieldBUTTON
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferenceFINDallfields
    learnFIND

Scripts that use this script

Script Definition
Script Steps

    #
    Set Variable [ $$GoToField; Value:"note" ]
    #
    Perform Script [ “catchFindLearnErrorMessages” ]
    #

Fields used in this script

Scripts used in this script

    catchFindLearnErrorMessages

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [catchFindLearnErrorMessagesTextFieldBUTTON]	Parent Folder: [learn]	Next Script: [closeLearnQV]
Script Name	catchFindLearnErrorMessagesTimestampFieldBUTTON
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferenceFINDallfields
    learnFIND

Scripts that use this script

Script Definition
Script Steps

    #
    Set Variable [ $$GoToField; Value:"Timestamp" ]
    #
    Perform Script [ “catchFindLearnErrorMessages” ]
    #

Fields used in this script

Scripts used in this script

    catchFindLearnErrorMessages

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [catchFindLearnErrorMessagesTimestampFieldBUTTON]	Parent Folder: [learn]	Next Script: [deleteLearnMainRecord]
Script Name	closeLearnQV
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    learn4EDIT
    learn4EDITLocked
    learn4EDITstuff
    learn4EDITstuffLocked

Scripts that use this script

Script Definition
Script Steps

    #
    #Go to reference record layout.
    Set Variable [ $$stoploadCitation; Value:1 ]
    Go to Layout [ $$testLearnLayoutName ]
    Set Variable [ $$testLearnLayoutName ]
    Set Variable [ $$stoploadCitation ]
    #
    #Allow add mode.
    Set Variable [ $$stopAdd ]
    #
    #Capture note and timestamp. If these are
    #changed while on the Qv layout it will effect
    #the record's sort location and require a resort
    #for the user to see the record they went to the
    #QV window to look at.
    If [ $$QvNote ≠ testlearn::note or $$QvLocation ≠ testlearn::orderInventoryGroupNumber or $$QvTimestamp ≠ testlearn::timestamp ]
    Set Variable [ $$QvNote ]
    Set Variable [ $$QvLocation ]
    Set Variable [ $$QvTimestamp ]
    Sort Records [ ] [ No dialog ]
    End If

Fields used in this script

    testlearn::note
    testlearn::orderInventoryGroupNumber
    testlearn::timestamp

Scripts used in this script

Layouts used in this script

Tables used in this script

    testlearn

Table occurrences used by this script

    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [closeLearnQV]	Parent Folder: [learn]	Next Script: [duplicateLearnRecord]
Script Name	deleteLearnMainRecord
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    learn0
    learnStuff0
    learn1
    learnStuff1
    learn2
    learnStuff2
    learn3
    learnStuff3
    learn4
    learnStuff4
    learn5
    learnStuff5

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #If node that created this record as its primary
    #creator is currenlty locked then stop script,
    #inform user.
    If [ tagTLNodePrimary::orderOrLock ≠ "" ]
    Show Custom Dialog [ Message: "The node that created this record, " & tagTLNodePrimary::tag & ", is locked, so all this node's records are locked too. Go back to Setup to unlock it."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #If in find mode, exit script.
    If [ $$findMode ≠ "" ]
    Show Custom Dialog [ Message: "Currently in find mode. Click done in the tag menus window to exit find mode, and then click this button."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #Exit field so user can see red delete
    #formatting later on.
    Go to Field [ ]
    #
    #If either the brainstorm or test fields are filled show
    #message below.
    If [ testlearn::kcbrainstorm ≠ "" and testlearn::kctestSubsectionInfo ≠ "" ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Show Custom Dialog [ Message: "Tagged by brainstorm and test tags. Remove these tags to delete. 1) Click the 'brainstorm' button. 2) Scroll to the highlighted tags. 3) Click the square buttons next to each. 4) Click the 'test' button and repeat steps 2 and 3."; Default Button: “OK”, Commit: “Yes” ]
    Else
    Show Custom Dialog [ Message: "Tagged by inventory list and test tags. Remove these tags to delete. 1) Click the 'inventory list' button. 2) Scroll to the highlighted tags. 3) Click the square buttons next to each. 4) Click the 'test' button and repeat steps 2 and 3."; Default Button: “OK”, Commit: “Yes” ]
    End If
    Exit Script [ ]
    Else If [ //The following tests insures that paragraph returns with no numbes in them will not prevent delete. So field can be full of paragraph returns, but have no ID numers, and so can be deleted. testlearn::kcbrainstorm ≠ "" and Length ( testlearn::kcbrainstorm ) ≠ ValueCount ( testlearn::kcbrainstorm ) ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Show Custom Dialog [ Message: "Tagged by brainstorm tags. Remove these tags to delete. 1) Click the 'brainstorm' button. 2) Scroll to the highlighted tags. 3) Click the square buttons next to each."; Default Button: “OK”, Commit: “Yes” ]
    Else
    Show Custom Dialog [ Message: "Tagged by inventory list tags. Remove these tags to delete. 1) Click the 'inventory list' button. 2) Scroll to the highlighted tags. 3) Click the square buttons next to each."; Default Button: “OK”, Commit: “Yes” ]
    End If
    Exit Script [ ]
    Else If [ testlearn::kctestSubsectionInfo ≠ "" ]
    Show Custom Dialog [ Message: "Tagged by test tags. Remove these tags to delete. 1) Click the 'test' button. 2) Scroll to the highlighted tags. 3) Click the square buttons next to each."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #Prevent all record load scripts (they slow down
    #this script and are uneccessary).
    Set Variable [ $$stoploadCitation; Value:1 ]
    #
    #Set variables to conditionally format section to
    #be deleted, and its record number so if the
    #user cancels the delete, the system can return
    #to this record.
    Set Variable [ $delete; Value:testlearn::_Ltestlearn ]
    Set Variable [ $deleteName; Value:testlearn::_Number ]
    Set Variable [ $recordNumber; Value:Get (RecordNumber) ]
    #
    #Because there may be no records found, stop
    #the system from informing the user of this.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #Open a new window and look for record being
    #cited or used as a reference by another record.
    New Window [ Height: 1; Width: 1; Top: 10000; Left: 10000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    #
    #See if learn record is used by any learn
    #records as a reference.
    Go to Layout [ “tableTestLearn” (testlearn) ]
    Enter Find Mode [ ]
    Set Field [ testlearn::kcreference; $delete ]
    Perform Find [ ]
    #
    If [ Get (LastError) ≠ 401 ]
    If [ $inUse ≠ "" ]
    Set Variable [ $addToInUse; Value:$inUse ]
    Set Variable [ $inUse; Value:$addToInUse & ", " & Get (FoundCount) & " Learn" ]
    Else If [ $inUse = "" ]
    Set Variable [ $inUse; Value:Get (FoundCount) & " Learn" ]
    End If
    End If
    #
    #See if learn record is used by any tag records
    #as a picture. NOTE: The ability to add learn
    #record pictures is no longer possible since
    #version 3.
    Go to Layout [ “tableTag” (tagTable) ]
    #picture1
    Enter Find Mode [ ]
    Set Field [ tagTable::Kpicture1; $delete ]
    Perform Find [ ]
    Set Variable [ $tagFound1; Value:Get (FoundCount) ]
    If [ Get (FoundCount) > 0 ]
    Go to Record/Request/Page [ First ]
    Loop
    Set Variable [ $tagNameADD; Value:$tagName ]
    Set Variable [ $tagName; Value:Case ( $tagNameAdd = "" ; tagTable::tag ; $tagNameAdd & "; " & tagTable::tag ) ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    End If
    #picture2
    Enter Find Mode [ ]
    Set Field [ tagTable::Kpicture2; $delete ]
    Perform Find [ ]
    Set Variable [ $tagFound2; Value:Get (FoundCount) ]
    If [ Get (FoundCount) > 0 ]
    Go to Record/Request/Page [ First ]
    Loop
    Set Variable [ $tagNameADD; Value:$tagName ]
    Set Variable [ $tagName; Value:Case ( $tagNameAdd = "" ; tagTable::tag ; $tagNameAdd & "; " & tagTable::tag ) ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    End If
    #picture3
    Enter Find Mode [ ]
    Set Field [ tagTable::Kpicture3; $delete ]
    Perform Find [ ]
    Set Variable [ $tagFound3; Value:Get (FoundCount) ]
    If [ Get (FoundCount) > 0 ]
    Go to Record/Request/Page [ First ]
    Loop
    Set Variable [ $tagNameADD; Value:$tagName ]
    Set Variable [ $tagName; Value:Case ( $tagNameAdd = "" ; tagTable::tag ; $tagNameAdd & "; " & tagTable::tag ) ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    End If
    #
    If [ $tagFound1 + $tagFound2 + $tagFound3 ≠ 0 ]
    If [ $inUse ≠ "" ]
    Set Variable [ $addToInUse; Value:$inUse ]
    Set Variable [ $inUse; Value:$addToInUse & ", " & ($tagFound1 + $tagFound2 + $tagFound3) & " tag menu picture(s) (" & $tagName & ")" ]
    Else If [ $inUse = "" ]
    Set Variable [ $inUse; Value:($tagFound1 + $tagFound2 + $tagFound3) & " tag menu picture(s) (" & $tagName & ")" ]
    End If
    End If
    #
    Set Variable [ $tagFound1 ]
    Set Variable [ $tagFound2 ]
    Set Variable [ $tagFound3 ]
    Set Variable [ $tagNameADD ]
    Set Variable [ $tagName ]
    #
    #See if learn record is used by any tag records
    #as a web link. NOTE: Since version 3 this
    #function is no longer available.
    Go to Layout [ “tableTag” (tagTable) ]
    #link1
    Enter Find Mode [ ]
    Set Field [ tagTable::Ktitle1; $delete ]
    Perform Find [ ]
    Set Variable [ $tagFound1; Value:Get (FoundCount) ]
    If [ Get (FoundCount) > 0 ]
    Go to Record/Request/Page [ First ]
    Loop
    Set Variable [ $tagNameADD; Value:$tagName ]
    Set Variable [ $tagName; Value:Case ( $tagNameAdd = "" ; tagTable::tag ; $tagNameAdd & "; " & tagTable::tag ) ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    End If
    #link2
    Enter Find Mode [ ]
    Set Field [ tagTable::Ktitle2; $delete ]
    Perform Find [ ]
    Set Variable [ $tagFound2; Value:Get (FoundCount) ]
    If [ Get (FoundCount) > 0 ]
    Go to Record/Request/Page [ First ]
    Loop
    Set Variable [ $tagNameADD; Value:$tagName ]
    Set Variable [ $tagName; Value:Case ( $tagNameAdd = "" ; tagTable::tag ; $tagNameAdd & "; " & tagTable::tag ) ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    End If
    #link3
    Enter Find Mode [ ]
    Set Field [ tagTable::Ktitle3; $delete ]
    Perform Find [ ]
    Set Variable [ $tagFound3; Value:Get (FoundCount) ]
    If [ Get (FoundCount) > 0 ]
    Go to Record/Request/Page [ First ]
    Loop
    Set Variable [ $tagNameADD; Value:$tagName ]
    Set Variable [ $tagName; Value:Case ( $tagNameAdd = "" ; tagTable::tag ; $tagNameAdd & "; " & tagTable::tag ) ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    End If
    #
    If [ $tagFound1 + $tagFound2 + $tagFound3 ≠ 0 ]
    If [ $inUse ≠ "" ]
    Set Variable [ $addToInUse; Value:$inUse ]
    Set Variable [ $inUse; Value:$addToInUse & ", " & ($tagFound1 + $tagFound2 + $tagFound3) & " tag menu link(s) (" & $tagName & ")" ]
    Else If [ $inUse = "" ]
    Set Variable [ $inUse; Value:($tagFound1 + $tagFound2 + $tagFound3) & " tag menu link(s) (" & $tagName & ")" ]
    End If
    End If
    #
    Set Variable [ $tagFound1 ]
    Set Variable [ $tagFound2 ]
    Set Variable [ $tagFound3 ]
    Set Variable [ $tagNameADD ]
    Set Variable [ $tagName ]
    #
    #
    Close Window [ Current Window ]
    #
    #
    #
    #
    #Report on findings and if none found
    #delete record.
    #
    #If record was found tell user.
    If [ $inUse ≠ "" ]
    Set Variable [ $delete ]
    Refresh Window
    If [ $$LinkedLearnRecords ≠ "" ]
    Show Custom Dialog [ Message: "Record cannot be deleted as it in use in these windows: " & $inUse & ". To see them 1) Click 'find' (above). 2) Click 'linked' in the popup window."; Default Button: “OK”, Commit: “Yes” ]
    Else
    Show Custom Dialog [ Message: "Record cannot be deleted as it in use in these windows: " & $inUse & "."; Default Button: “OK”, Commit: “Yes” ]
    End If
    Set Variable [ $$addTagToCitation ]
    Set Variable [ $$stopLoadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    Exit Script [ ]
    End If
    #
    #If the record being deleted was not found in
    #use make sure the user really wants it deleted.
    Set Variable [ $group ]
    Refresh Window
    If [ Filter ( testlearn::kcreference ; "L" ) ≠ "" and TEMP::InventoryLibraryYN = "" or $$LinkedLearnRecords ≠ "" and TEMP::InventoryLibraryYN = "" ]
    Show Custom Dialog [ Message: "NOTE: This record has links to other learn records. Are you sure you want to delete it? To see them 1) click 'cancel'. 2) Click 'find' (above). 3) Click 'linked' in the popup window."; Default Button: “cancel”, Commit: “Yes”; Button 2: “delete”, Commit: “No” ]
    Else
    Show Custom Dialog [ Message: "Delete current record?"; Default Button: “cancel”, Commit: “No”; Button 2: “delete”, Commit: “No” ]
    End If
    Set Variable [ $group; Value:tagMenus::kGroupOrTest ]
    Set Variable [ $deleteGroup; Value:tagMenuGroup::name ]
    #
    #If the user cancels, stop the delete.
    If [ Get ( LastMessageChoice ) = 1 ]
    Go to Field [ ]
    Set Variable [ $delete ]
    Set Variable [ $group ]
    Refresh Window
    Refresh Window
    Set Variable [ $$addTagToCitation ]
    Set Variable [ $$stopLoadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    Exit Script [ ]
    #
    #If the user says yes, then delete the record.
    Else If [ Get ( LastMessageChoice ) = 2 ]
    Delete Record/Request [ No dialog ]
    #
    End If
    Set Variable [ $delete ]
    Set Variable [ $group ]
    Refresh Window
    Set Variable [ $$addTagToCitation ]
    Set Variable [ $$stopLoadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    #
    Perform Script [ “loadLearnOrRefMainRecord” ]
    #

Fields used in this script

    tagTLNodePrimary::orderOrLock
    tagTLNodePrimary::tag
    testlearn::kcbrainstorm
    testlearn::kctestSubsectionInfo
    TEMP::InventoryLibraryYN
    testlearn::_Ltestlearn
    testlearn::_Number
    testlearn::kcreference
    tagTable::Kpicture1
    tagTable::tag
    tagTable::Kpicture2
    tagTable::Kpicture3
    tagTable::Ktitle1
    tagTable::Ktitle2
    tagTable::Ktitle3
    tagMenus::kGroupOrTest
    tagMenuGroup::name

Scripts used in this script

    loadLearnOrRefMainRecord

Layouts used in this script

    tableTestLearn
    tableTag

Tables used in this script

    TEMP
    tag
    tag
    tag
    tagGroup
    testlearn

Table occurrences used by this script

    TEMP
    tagMenuGroup
    tagMenus
    tagTLNodePrimary
    tagTable
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [deleteLearnMainRecord]	Parent Folder: [learn]	Next Script: [editLearn]
Script Name	duplicateLearnRecord
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    learn0
    learnStuff0
    learn1
    learnStuff1
    learn2
    learnStuff2
    learn3
    learnStuff3
    learn4
    learnStuff4
    learn5
    learnStuff5
    LearnTextWindow
    LearnTextWindow_iDevice

Scripts that use this script

Script Definition
Script Steps

    #
    #If in find mode, exit script.
    If [ $$findMode ≠ "" ]
    Show Custom Dialog [ Message: "Currently in find mode. Click done in the tag menus window to exit find mode, and then click this button."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #If node is currenlty locked then stop script,
    #and inform the user.
    Perform Script [ “stopNewRecordsBeingCreatedByLockedNode” ]
    #
    #Give user duplicate record options.
    If [ TEMP::InventoryLibraryYN = "" ]
    Show Custom Dialog [ Message: "Duplicate and reference current record? Click 'yes' if the duplicate is for capturing ideas, thoughts, etc. that link to the current record."; Default Button: “yes”, Commit: “Yes”; Button 2: “no”, Commit: “No”; Button 3: “cancel”, Commit: “No” ]
    #
    #If user wants to reference current record, note
    #this and then ask if the want to also duplicate
    #previous record's reference tags.
    If [ Get ( LastMessageChoice ) = 1 ]
    Set Variable [ $referenceCurrentRecord; Value:1 ]
    #
    #Mmm... Save this for another version.
    // Show Custom Dialog [ Message: "Duplicate current record's references (reference tags) too? Click 'yes' if in this follow-on note you will reference the same references."; Default Button: “yes”, Commit: “Yes”; Button 2: “no”, Commit: “No”; Button 3: “cancel”, Commit: “No” ]
    // #
    // #If user wants to reference current record, note
    // #this and then ask if the want to also duplicate
    // #previous record's reference tags.
    // If [ Get ( LastMessageChoice ) = 1 ]
    // Set Variable [ $referenceReferences; Value:1 ]
    // End If
    End If
    #
    #If user cancels, then exit script.
    If [ Get ( LastMessageChoice ) = 3 ]
    Exit Script [ ]
    End If
    End If
    #
    #Close edit window if user clicked "d" button
    #from this window.
    If [ Get (WindowName) = "Edit" ]
    Go to Field [ ]
    Show/Hide Text Ruler [ Hide ]
    Close Window [ Current Window ]
    Set Variable [ $$DuplicateDontGoToTagMenuWindow; Value:1 ]
    Set Variable [ $$PictureOnReportLayout ]
    End If
    #
    #If in find mode, exit script.
    If [ $$findMode ≠ "" ]
    Show Custom Dialog [ Message: "Exit find mode, then click this button."; Default Button: “OK”, Commit: “No” ]
    Exit Script [ ]
    End If
    #
    #If user selects option 1 or 2 gather orignal record's info.
    Set Variable [ $$stoploadCitation; Value:1 ]
    Set Variable [ $getRecordNumberInCaseUserCancles; Value:Get ( RecordNumber ) ]
    Go to Field [ ]
    Set Variable [ $note; Value:testlearn::note ]
    Set Variable [ $point; Value:testlearn::brainstormCasePoint ]
    Set Variable [ $P; Value:testlearn::kKeywordPrimary ]
    Set Variable [ $O; Value:testlearn::kcKeywordOther ]
    Set Variable [ $Owords; Value:testlearn::OtherKeyWords ]
    Set Field [ TEMP::duplicateOtherKeywords; testlearn::kcKeywordOther ]
    Set Variable [ $reference; Value:testlearn::kcreference ]
    Set Variable [ $showReferencedMedia; Value:testlearn::kshowReferencedMedia ]
    Set Variable [ $picture; Value:testlearn::picture ]
    #The 'L' is added to all Tag Menu to conditional format
    #the Learn menu button.
    Set Variable [ $referenceOriginal; Value:testlearn::_Ltestlearn & "L" ]
    New Record/Request
    Set Field [ testlearn::kNodePrimary; TEMP::kdefaultNodePrimary ]
    Set Field [ testlearn::kRecordCreatorNode; TEMP::kdefaultNodePrimary ]
    Set Field [ testlearn::dateModify; Get ( CurrentTimeStamp ) ]
    Set Field [ testlearn::kNodeOther; TEMP::kdefaultNodeOther ]
    Set Field [ testlearn::NodeOthers; TEMP::DEFAULTNodeOtherNames ]
    Set Field [ testlearn::kcopyright; TEMP::kdefaultCopyright ]
    Set Field [ testlearn::incomplete; "incomplete" & ¶ ]
    Set Field [ testlearn::filterFind; "main" & ¶ ]
    Set Field [ testlearn::kKeywordPrimary; $P ]
    Set Field [ testlearn::OtherKeyWords; $Owords ]
    Set Field [ testlearn::picture; $picture ]
    #
    #Filemaker has a bug that is stripping out the paragraphs
    #if the script puts the Other variable keys directly into the
    #other word field. But put them into the note field and then
    #from note into the otherword key field and everything
    #is fine.
    Set Field [ testlearn::note; $O ]
    Set Field [ testlearn::kcKeywordOther; testlearn::note ]
    Set Field [ testlearn::note; $note ]
    Set Field [ testlearn::brainstormCasePoint; $point ]
    Set Variable [ $$stoploadCitation ]
    #
    #If user selects to reference current record in
    #the duplicate record, then add its key to
    #list (if any) of other referenced Learn record keys
    #that are referenced by the current record.
    If [ $referenceCurrentRecord = 1 ]
    Set Field [ testlearn::kcreference; $referenceOriginal & ¶ & $reference ]
    Set Field [ testlearn::kshowReferencedMedia; $showReferencedMedia ]
    #
    #If the user does not want to reference the orginal
    #record, then do not add its key to any referenced
    #Learn record keys (referenced by the orginal record).
    Else If [ Get ( LastMessageChoice ) = 2 or TEMP::InventoryLibraryYN ≠ "" ]
    Set Field [ testlearn::kcreference; $reference ]
    Set Field [ testlearn::kshowReferencedMedia; $showReferencedMedia ]
    End If
    #
    #
    #Save this removal of reference tags for
    #another version. The code as written doesn't
    #do the job, and was copied from another
    #do the job, and was copied from another
    // If [ ]
    // Set Variable [ $referenceNumber; Value:1 ]
    // Loop
    // If [ Filter ( GetValue ( testlearn::kcreference ; 1 ) ; "L" ) = "L" ]
    // Set Field [ testlearn::kcreference; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used If ( ValueCount ( $$ref) ≠ ValueCount ( Substitute ( $$ref ; $removeRef & "¶" ; "" ) ) ; Substitute ( $$ref ; $removeRef & "¶" ; "" ) ; Substitute ( $$ref ; $removeRef; "" ) ) ]
    // Set Variable [ $$ref; Value:testlearn::kcreference ]
    // #
    // #Make sure the reference being removed also
    // #gets its picture removed from this learn
    // #record if it is being used.
    // If [ $removeRef = testlearn::kshowReferencedMedia ]
    // Set Field [ testlearn::kshowReferencedMedia; "" ]
    // End If
    // End If
    // End Loop
    // End If
    #
    #
    #Sort the new record to the top of window, and
    #go to this new record, run the loadCition script,
    #and open up the text edit window for the new record.
    Sort Records [ ] [ No dialog ]
    Set Variable [ $record; Value:Get (RecordNumber) ]
    Go to Record/Request/Page [ $record ] [ No dialog ]
    Set Variable [ $$stoploadCitation ]
    Perform Script [ “loadLearnOrRefMainRecord” ]
    Set Variable [ $$stopOpenNewTextWindow ]
    #
    #Note that the new record is a duplicate so its
    #text area should be highlighted when opened
    #in the follow on script, which makes it easy
    #for the user to replace the deleted text while
    #keeping all the duplcated tags.
    Set Variable [ $$duplicateRecord; Value:1 ]
    #
    #Open duplicate record in text window so
    #user can now edit it.
    Perform Script [ “learnOpenTextNewWindow” ]
    #

Fields used in this script

    TEMP::InventoryLibraryYN
    testlearn::note
    testlearn::brainstormCasePoint
    testlearn::kKeywordPrimary
    testlearn::kcKeywordOther
    testlearn::OtherKeyWords
    TEMP::duplicateOtherKeywords
    testlearn::kcreference
    testlearn::kshowReferencedMedia
    testlearn::picture
    testlearn::_Ltestlearn
    TEMP::kdefaultNodePrimary
    testlearn::kNodePrimary
    testlearn::kRecordCreatorNode
    testlearn::dateModify
    TEMP::kdefaultNodeOther
    testlearn::kNodeOther
    TEMP::DEFAULTNodeOtherNames
    testlearn::NodeOthers
    TEMP::kdefaultCopyright
    testlearn::kcopyright
    testlearn::incomplete
    testlearn::filterFind

Scripts used in this script

    stopNewRecordsBeingCreatedByLockedNode
    loadLearnOrRefMainRecord
    learnOpenTextNewWindow

Layouts used in this script

Tables used in this script

    TEMP
    testlearn

Table occurrences used by this script

    TEMP
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [duplicateLearnRecord]	Parent Folder: [learn]	Next Script: [exitFindLearnFieldAndReEnterIt]
Script Name	editLearn
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    testInfo
    reportTagInfo

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #This script is activated on Test Info layouts,
    #and functions to take user to the learn
    #module where they can edit info records
    #assigned to the test subsection they are
    #viewing.
    #
    #
    #
    #
    #
    #BEGIN: Stop this script if any of the following are true:
    #
    #Test subject is locked.
    #
    #NOTE: Although changing associated learn
    #and test item records cannot affect a test
    #subjects test result or report records, further
    #testing and so time is required to insure no
    #problems occur as a result of allowing users to
    #edit learn and test subsection records when
    #navigating from locked Test Section item and
    #info Tag Menus layouts.
    If [ $$testSubjectIsLocked ≠ "" and Get ( LayoutName ) ≠ "defaultTest" and Get ( LayoutName ) ≠ "learnTest" ]
    Show Custom Dialog [ Message: "The test subject — " & $$testSubjectIsLocked & " — is locked. To unlock, A) go back to the setup node tag menu. B) Select this test subject. C) Click 'lock' and enter the password."; Default Button: “OK”, Commit: “No” ]
    Set Variable [ $exit; Value:1 ]
    End If
    #
    #Primary node is locked.
    If [ TEMP::primaryNodeIsLocked ≠ "" ]
    If [ $exit = "" ]
    Show Custom Dialog [ Message: "The default primary node — " & TEMP::DEFAULTNodePrimaryName & " — is locked. Go to the Default Node Tag Menu and A) click 'lock' to unlock it, B) select an unlocked node for the primary node, or C) create a new primary node."; Default Button: “OK”, Commit: “No” ]
    Else
    Show Custom Dialog [ Message: "ALSO, the default primary node — " & TEMP::DEFAULTNodePrimaryName & " — is locked. Go to the Default Node Tag Menu and A) click 'lock' to unlock it, B) select an unlocked node for the primary node, or C) create a new primary node."; Default Button: “OK”, Commit: “No” ]
    End If
    Set Variable [ $exit; Value:1 ]
    End If
    #
    #Subsection is locked by its creator node.
    If [ $$testSubsectionIsLocked ≠ "" and Get ( LayoutName ) ≠ "defaultTest" or testSectionCreatorLock::orderOrLock ≠ "" and Get ( LayoutName ) ≠ "defaultTest" ]
    #
    If [ $exit = "" ]
    If [ Left (Get (LayoutName) ; 5 ) = "learn" ]
    Show Custom Dialog [ Message: "This test subsection's creator node — " & testSectionCreatorLock::tag & " — is locked. Go to the Default Node Tag Menu and click 'lock' to unlock it."; Default Button: “OK”, Commit: “Yes” ]
    Else
    Show Custom Dialog [ Message: "You cannot add or subtract any info records as this subsection is locked by its creator — " & $$testSubsectionIsLocked & ". If you know this node's password, you can unlock it on the Setup section's node menu."; Default Button: “OK”, Commit: “Yes” ]
    End If
    Set Variable [ $exit; Value:1 ]
    End If
    #
    End If
    #
    #If any of the above are true, then
    #exit this script.
    If [ $exit = 1 ]
    Exit Script [ ]
    End If
    #
    #
    #END: Stop this script if any of the following are true:
    #
    #
    #
    #
    #
    #Go the Learn module be first closing the
    #Reference window and resizing the two
    #remaining windows.
    Close Window [ Name: "Reference"; Current file ]
    Move/Resize Window [ Name: "Test"; Current file; Width: Get ( ScreenWidth ) / 2; Left: 0 ]
    Move/Resize Window [ Name: "Tag Menus"; Current file; Width: Get ( ScreenWidth ) / 2; Left: Get ( ScreenWidth ) / 2 ]
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    #Because of the complexity of going to learn
    #module from the test module, this variable
    #needs to be set to stop a reference window
    #from being opened. Probably there is a better
    #way to accomplish this, but more testing is
    #required to figure the more efficient path.
    Set Variable [ $$doNotOpenReferenceWindow; Value:1 ]
    #
    #In report mode do the following ...
    If [ Left ( Get ( LayoutName ) ; 1 ) = "r" ]
    #
    #Set return variable for tag.
    If [ Get (FoundCount) ≥ 1 ]
    Set Variable [ $$learnRecord; Value:testlearnReportTags::_Ltestlearn ]
    Else
    Set Variable [ $$learnRecord; Value:1 ]
    End If
    #
    #Set return variable for Report item.
    Set Variable [ $$returnItem; Value:TEMP::ktestSubsection ]
    Set Variable [ $$returnItemName; Value:TEMP::testSubsectionName ]
    #
    #Go to the Report window and change it to Learn.
    Select Window [ Name: "Report"; Current file ]
    Set Window Title [ Current Window; New Title: "Learn" ]
    #
    #Find, sort, the loop to record user was on in
    #Tag Menus window for info items (testLearn records).
    Set Variable [ $$stopLoadCitation; Value:1 ]
    If [ tempSetup::layoutLmain = "" ]
    Go to Layout [ “learn2” (testlearn) ]
    Set Field [ TEMP::layoutLmain; "more" & Get (LayoutName) ]
    Else If [ tempSetup::layoutLmain ≠ "" ]
    Go to Layout [ Middle ( tempSetup::layoutLmain ; 5 ; 42 ) ]
    End If
    Enter Find Mode [ ]
    Set Field [ testlearn::filterFind; "main" & ¶ ]
    Perform Find [ ]
    Set Variable [ $$stopLoadCitation; Value:1 ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::date; descending testlearn::timestamp; descending ] [ Restore; No dialog ]
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    #
    #Go to selected learn record if there is one.
    If [ $$thereIsInfoForThisSubsection = 1 ]
    If [ $$learnRecord ≠ "" ]
    Loop
    Exit Loop If [ testlearn::_Ltestlearn = $$learnRecord ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    End If
    End If
    Set Variable [ $$stopLoadCitation ]
    #
    #Go to test menu in Tag Menus window.
    Select Window [ Name: "Tag Menus"; Current file ]
    Set Variable [ $$editTestInfo; Value:1 ]
    Perform Script [ “menuTest” ]
    #
    #
    #
    #
    #
    #In test mode do the following ...
    Else If [ Left ( Get ( LayoutName ) ; 1 ) = "t" ]
    #
    #Set return variable for tag.
    Set Variable [ $$testTagRecord; Value:testlearnReportTags::_Ltestlearn ]
    If [ $$testTagRecord = "" ]
    Set Variable [ $$testTagRecord; Value:"blank" ]
    End If
    #
    #Set return variable for Test item.
    Set Variable [ $$returnItem; Value:TEMP::ktestSubsection ]
    Set Variable [ $$returnItemName; Value:TEMP::testSubsectionName ]
    #
    #Go to the Test window and change it to Learn.
    Select Window [ Name: "Test"; Current file ]
    Set Window Title [ Current Window; New Title: "Learn" ]
    #
    #Set return variable for main Test record.
    Set Variable [ $$testLearnRecord; Value:testlearn::_Ltestlearn ]
    #
    #Find, sort, the loop to record user was on in
    #Tag Menus window for info items (testLearn records).
    Set Variable [ $$stopLoadCitation; Value:1 ]
    If [ tempSetup::layoutLmain = "" ]
    Go to Layout [ “learn2” (testlearn) ]
    Set Field [ TEMP::layoutLmain; "more" & Get (LayoutName) ]
    Else If [ tempSetup::layoutLmain ≠ "" ]
    Go to Layout [ Middle ( tempSetup::layoutLmain ; 5 ; 42 ) ]
    End If
    Enter Find Mode [ ]
    Set Field [ testlearn::filterFind; "main" & ¶ ]
    Perform Find [ ]
    Set Variable [ $$stopLoadCitation; Value:1 ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::date; descending testlearn::timestamp; descending ] [ Restore; No dialog ]
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    #
    #Go to selected learn record, if there is one.
    If [ $$thereIsInfoForThisSubsection = 1 ]
    Loop
    Exit Loop If [ testlearn::_Ltestlearn = $$testTagRecord or $$testTagRecord = "blank" ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    End If
    Set Variable [ $$stopLoadCitation ]
    #
    #Go to test menu in Tag Menus window.
    Select Window [ Name: "Tag Menus"; Current file ]
    Set Variable [ $$editTestInfo; Value:1 ]
    Perform Script [ “menuTest” ]
    End If
    #

Fields used in this script

    TEMP::primaryNodeIsLocked
    TEMP::DEFAULTNodePrimaryName
    testSectionCreatorLock::orderOrLock
    testSectionCreatorLock::tag
    testlearnReportTags::_Ltestlearn
    TEMP::ktestSubsection
    TEMP::testSubsectionName
    tempSetup::layoutLmain
    TEMP::layoutLmain
    testlearn::filterFind
    testlearn::date
    testlearn::timestamp
    testlearn::_Ltestlearn

Scripts used in this script

    menuTest

Layouts used in this script

    learn2
    <Missing Layout>

Tables used in this script

    TEMP
    TEMP
    tag
    testlearn
    testlearn

Table occurrences used by this script

    TEMP
    tempSetup
    testSectionCreatorLock
    testlearn
    testlearnReportTags

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [editLearn]	Parent Folder: [learn]	Next Script: [findLearnRecord]
Script Name	exitFindLearnFieldAndReEnterIt
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    // If [ $$stopLogicLoop = 1 ]
    // Set Variable [ $$stopLogicLoop ]
    // Halt Script
    // End If
    #
    Go to Field [ ]
    Go to Field [ testlearn::note ]
    #

Fields used in this script

    testlearn::note

Scripts used in this script

Layouts used in this script

Tables used in this script

    testlearn

Table occurrences used by this script

    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [exitFindLearnFieldAndReEnterIt]	Parent Folder: [learn]	Next Script: [gotoLearn]
Script Name	findLearnRecord
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    learn0
    learnStuff0
    learn1
    learnStuff1
    learn2
    learnStuff2
    learn3
    learnStuff3
    learn4
    learnStuff4
    learn5
    learnStuff5
    learnFIND

Scripts that use this script

    catchFindLearnErrorMessages
    findLearnRecord

Script Definition
Script Steps

    #
    #
    #!!! IMPORTANT !!! SAY WHAT !!! HERE YE, HERE YE !!!
    #
    #The find logic of this script is identical to the
    #find logic in the findReferenceRecord and the
    #ActionLog's findSpecificAction script, as are
    #their layouts where text and date field are
    #concerned. Any changes made to this logic
    #needs to also be made to those scripts to
    #keep them identical.
    #
    #!!! IMPORTANT !!! SAY WHAT !!! HERE YE, HERE YE !!!
    #
    #
    #If in find mode in the Tag Window, exit script.
    If [ $$findMode ≠ "" ]
    Show Custom Dialog [ Message: "Exit find mode in the Tag Menus window, then click this button."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #If user is in tag field and has changed spelling
    #exit this tag record, otherwise current
    #learn record will get deleted by the spelling
    #check script.
    Select Window [ Name: "Tag Menus"; Current file ]
    If [ Get ( ActiveFieldName ) ≠ "" ]
    Show Custom Dialog [ Message: "You'll be able to perform a find once you exit the field you're in on the tag window."; Default Button: “OK”, Commit: “No” ]
    Select Window [ Name: "Learn"; Current file ]
    Exit Script [ ]
    End If
    Select Window [ Name: "Learn"; Current file ]
    #
    #Admin tasks.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #If the user has just clicked 'find' to perform
    #a find and thus is not yet in find mode ...
    If [ Get (WindowMode) ≠ 1 ]
    #
    #
    #First, see if the learn record is linked to other
    #learn records, and find out if the user just
    #wants to find these linked records.
    #
    #
    #Check if the current Learn record
    #references other Learn records or is
    #referenced by other Learn records.
    If [ Filter ( testlearn::kcreference ; "L" ) ≠ "" or $$LinkedLearnRecords ≠ "" ]
    #
    #If it does reference other Learn records, ask
    #the user if they would like to find just those
    #records, or continue to the find screen.
    If [ TEMP::InventoryLibraryYN = "" ]
    Show Custom Dialog [ Message: "Find notes linked to this note?" & ¶ & "OR" & ¶ & "Find other notes?"; Default Button: “other”, Commit: “No”; Button 2: “linked”, Commit: “No”; Button 3: “cancel”, Commit: “No” ]
    Else
    If [ testlearn::brainstormCasePoint = "" ]
    Show Custom Dialog [ Message: "Find inventory with the same in/on tag as this item?" & ¶ & "OR" & ¶ & "Find other inventory items?"; Default Button: “other”, Commit: “No”; Button 2: “tagged”, Commit: “No”; Button 3: “cancel”, Commit: “No” ]
    Else
    Show Custom Dialog [ Message: "Find inventory tagged with this in/on tag?" & ¶ & "OR" & ¶ & "Find other inventory items?"; Default Button: “other”, Commit: “No”; Button 2: “tagged”, Commit: “No”; Button 3: “cancel”, Commit: “No” ]
    End If
    End If
    #
    #Exit script if user clicks cancel.
    If [ Get ( LastMessageChoice ) = 3 ]
    Exit Script [ ]
    End If
    #
    If [ Get ( LastMessageChoice ) = 2 ]
    #If the user wants to find just linked/
    #referenced learn records...
    #
    #
    #Determine if there are A) records it is linked to/
    #referencing, and B) if other learn records link
    #to it/referencing it.
    If [ Filter ( testlearn::kcreference ; "L" ) ≠ "" and $$LinkedLearnRecords ≠ "" ]
    #
    #If both are found ask user if they want to see
    #just the A records, or both A and B records.
    If [ TEMP::InventoryLibraryYN = "" ]
    #
    #This feature works! BUT, it is hard to
    #understand, so for now I'm disabling it. The
    #effect is that if the user chooses to see linked
    #records, it will find all linked records.
    // Show Custom Dialog [ Message: "This record 1) references and is 2) referenced by other Learn records. Show 1 = Refs or 1 and 2 = Refs+?"; Default Button: “Ref+”, Commit: “Yes”; Button 2: “Ref”, Commit: “No”; Button 3: “cancel”, Commit: “No” ]
    Set Variable [ $showReferencesReferencingMe; Value:1 ]
    Else
    Show Custom Dialog [ Message: "OPPS! A holder cannot be tagged with another holder tag. Return to idea-library mode, where holder tags are labled as reference tags, and untag this record."; Default Button: “OK”, Commit: “Yes” ]
    Show Custom Dialog [ Message: "1) Remember the records that will now be found. 2) Click the 'back' button. 3) Uncheck the 'inventory library' checkbox. 4) Click the 'Learn' button. 5) Go to the reference tags menu, and 6) untag these records."; Default Button: “OK”, Commit: “Yes” ]
    End If
    If [ Get (LastMessageChoice) = 1 ]
    Set Variable [ $showReferencesReferencingMe; Value:1 ]
    End If
    #
    #If choice 2 is made go to the next section.
    #
    #Exit script if user clicks cancel (button 3).
    If [ Get ( LastMessageChoice ) = 3 ]
    Exit Script [ ]
    End If
    #
    #
    Else If [ $$LinkedLearnRecords ≠ "" ]
    #If there are only records referencing this
    #record, then find these records.
    #
    #Find original record first.
    Set Variable [ $$stoploadCitation; Value:1 ]
    Enter Find Mode [ ]
    Set Field [ testlearn::_Ltestlearn; $$main ]
    Perform Find [ ]
    #
    #Now find records referencing it.
    Enter Find Mode [ ]
    Set Field [ testlearn::kcreference; $$main ]
    Extend Found Set [ ]
    #
    If [ TEMP::InventoryLibraryYN = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::date; descending testlearn::timestamp; descending ] [ Restore; No dialog ]
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::orderInventoryGroupNumber; ascending testlearn::note; ascending ] [ Restore; No dialog ]
    End If
    Go to Record/Request/Page [ First ]
    #
    #Go to orignal record.
    Loop
    Exit Loop If [ testlearn::_Ltestlearn = $$main ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Stop the script.
    Set Variable [ $$stoploadCitation ]
    Set Variable [ $$findLearnLayout ]
    Exit Script [ ]
    #
    #
    Else If [ Filter ( testlearn::kcreference ; "L" ) ≠ "" ]
    #If there are only records referenced by this record,
    #then find these records in this next section.
    #
    #
    End If
    #
    #
    #Capture the current layout name to return
    #user to it after find.
    Set Variable [ $$findLearnLayout; Value:Get (LayoutName) ]
    Set Variable [ $$stoploadCitation; Value:1 ]
    #
    #Now find the record that the user was on
    #when they clicked the 'find' button, and find
    #the records that it references if there are any
    #to find.
    #
    #Look thru the referenced learn records to
    #create a value list of their keys. NOTE: This
    #list will be used to find the final set of linked
    #learn records including the original, so also
    #caputre its key plus all the keys found in the
    #portal of linked learn records.
    Go to Layout [ “learn4EDIT” (testlearn) ]
    Set Variable [ $findLinkedLearnRecords; Value:testlearn::_Ltestlearn ]
    Loop
    Go to Object [ Object Name: "ref2" ]
    Exit Loop If [ Get (LastError) = 101 ]
    Set Variable [ $findLinkedLearnRecords; Value:refTestLearn::_Ltestlearn & ¶ & $findLinkedLearnRecords ]
    Go to Portal Row [ Select; Next; Exit after last ]
    End Loop
    #
    #Determine how many keys there are.
    Set Variable [ $numberOfKeys; Value:ValueCount ($findLinkedLearnRecords ) ]
    #
    #Find 1st record.
    Go to Layout [ $$findLearnLayout ]
    Enter Find Mode [ ]
    Set Field [ testlearn::_Ltestlearn; GetValue ( $findLinkedLearnRecords ; $numberOfKeys ) ]
    Perform Find [ ]
    Set Variable [ $numberOfKeys; Value:$numberOfKeys - 1 ]
    #
    If [ $numberOfKeys ≠ 0 ]
    #
    #Loop thru each key to find next record in list until
    #all linked records have been found.
    Loop
    #
    #Exit the loop when there are no more keys to check.
    Exit Loop If [ $numberOfKeys = 0 ]
    #
    #Find record.
    Enter Find Mode [ ]
    Set Field [ testlearn::_Ltestlearn; GetValue ( $findLinkedLearnRecords ; $numberOfKeys ) ]
    Extend Found Set [ ]
    #
    #Go the next key up from the bottom of the list
    #of keys on this section's keychain.
    Set Variable [ $numberOfKeys; Value:$numberOfKeys - 1 ]
    End Loop
    #
    #Now find records referencing the original record
    #if the user selected that option (button 1).
    If [ $showReferencesReferencingMe ≠ "" ]
    Enter Find Mode [ ]
    Set Field [ testlearn::kcreference; $$main ]
    Extend Found Set [ ]
    End If
    #
    If [ TEMP::InventoryLibraryYN = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::date; descending testlearn::timestamp; descending ] [ Restore; No dialog ]
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::orderInventoryGroupNumber; ascending testlearn::note; ascending ] [ Restore; No dialog ]
    End If
    Go to Record/Request/Page [ First ]
    #
    #Go to orignal record.
    Loop
    Exit Loop If [ testlearn::_Ltestlearn = $$main ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    End If
    #
    #Stop the script.
    Set Variable [ $$stoploadCitation ]
    Set Variable [ $$findLearnLayout ]
    Exit Script [ ]
    End If
    #
    End If
    End If
    #
    #
    #
    #!!! IMPORTANT !!! SAY WHAT !!! HERE YE, HERE YE !!!
    #
    #BEGIN identical find logic
    #
    #
    #Admin tasks.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #If the user has just clicked 'find' to perform
    #a find and thus is not yet in find mode ...
    If [ Get (WindowMode) ≠ 1 ]
    #
    #Capture the current layout name (to return user
    #to it after find), enter find mode, go to the find
    #layout, and await the user's find request.
    Set Variable [ $$findLearnLayout; Value:Get (LayoutName) ]
    Enter Find Mode [ ]
    Go to Layout [ “learnFIND” (testlearn) ]
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Pause/Resume Script [ Indefinitely ]
    #
    End If
    #
    #
    #
    #If alread in find mode on the find layout ...
    #
    #FIRST check for find request errors,
    #and copy current find request in case
    #there are no errors but the find fails
    #and the current find request needs
    #to be re-entered by this script to
    #allow the user to edit it for success.
    If [ Get (WindowMode) = 1 ]
    Perform Script [ “catchFindLearnErrorMessages” ]
    End If
    #
    #
    #
    #SECOND If there are no invalid find requests
    #then perform the find.
    If [ Get (WindowMode) = 1 ]
    #
    #Make sure to find only Learn records. Test
    #discovery records are in the same table of
    #records, but only Learn records have 'main'
    #added to their FilterFind field when created.
    Set Field [ testlearn::filterFind; "main" & ¶ ]
    #
    #Try to find the requested records.
    Perform Find [ ]
    #
    #Get the error generated, which if successful
    #will be zero.
    Set Variable [ $error; Value:Get (LastError) ]
    #
    End If
    #
    #
    #
    #If the find was not successful...
    #
    #If the find attempt fails and generates a
    #508 = invalid find request error or a 1 = user
    #canceled action error.
    If [ $error = 508 or $error = 1 ]
    #
    #Re-enter find mode to trigger the error capture
    #portion of this script when it is restarted, which
    #will tell the user what went wrong and how to
    #fix it.
    Enter Find Mode [ ]
    #
    #Start this script over.
    Perform Script [ “findLearnRecord” ]
    #
    End If
    #
    #
    #If the find fails tell the user it failed and give them
    #option to modify their request or cancel the find.
    If [ $error = 401 or $error ≠ 0 and $error ≠ "" ]
    #
    #If currently not in find mode, then enter
    #find mode.
    If [ Get (WindowMode) ≠ 1 ]
    Enter Find Mode [ ]
    End If
    #
    #Replace user's last find requests so the can
    #modify if they want to.
    Set Field [ testlearn::note; $$note ]
    Set Field [ testlearn::timestamp; $$timestamp ]
    Set Field [ testlearn::brainstormCasePoint; $$brainstormCasePoint ]
    #
    #Inform the user that their find request found
    #zero records.
    Show Custom Dialog [ Message: "No records match this request."; Default Button: “cancel”, Commit: “No”; Button 2: “modify find”, Commit: “No” ]
    #
    #
    #If the user decides to modify their request
    #then stay in find mode and await the user's
    #new request.
    If [ Get ( LastMessageChoice ) = 2 ]
    Pause/Resume Script [ Indefinitely ]
    #
    #These next script steps only come into use
    #if the user clicks the 'return' key on desktop
    #computer's keyboard or the 'go' button on an
    #iDevice. If instead, the user clicks the 'find'
    #button again on the find layout, a duplicate
    #copy of this script is started from the top to
    #perform the find request.
    #
    #Start this script over. SEE NOTE ABOVE.
    Perform Script [ “findLearnRecord” ]
    #
    #
    #If they cancel the find ...
    Else If [ Get ( LastMessageChoice ) = 1 ]
    #
    #Return to main layout and
    #enter browse mode.
    Perform Script [ “cancelLearnAndRefFind” ]
    #
    End If
    #
    #
    End If
    #
    #
    #
    #If the find is successful ...
    #
    #After a succesful find show the user
    #the found records on the main layout.
    If [ $$findLearnLayout = "" ]
    #
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “learnStuff3” (testlearn) ]
    Else
    Go to Layout [ “learn3” (testlearn) ]
    End If
    #
    Else
    Go to Layout [ $$findLearnLayout ]
    Set Variable [ $$findLearnLayout ]
    End If
    If [ TEMP::InventoryLibraryYN = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::date; descending testlearn::timestamp; descending ] [ Restore; No dialog ]
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::orderInventoryGroupNumber; ascending testlearn::note; ascending ] [ Restore; No dialog ]
    End If
    Scroll Window [ Home ]
    Go to Record/Request/Page [ First ]
    #
    #Clear user find request variables.
    Set Variable [ $$note ]
    Set Variable [ $$timestamp ]
    Set Variable [ $$brainstormCasePoint ]
    #
    #Clear out all paused find scripts.
    Halt Script
    #
    #
    #!!! IMPORTANT !!! SAY WHAT !!! HERE YE, HERE YE !!!
    #
    #END identical find logic
    #

Fields used in this script

    testlearn::kcreference
    TEMP::InventoryLibraryYN
    testlearn::brainstormCasePoint
    testlearn::_Ltestlearn
    testlearn::date
    testlearn::timestamp
    testlearn::orderInventoryGroupNumber
    testlearn::note
    refTestLearn::_Ltestlearn
    testlearn::filterFind

Scripts used in this script

    catchFindLearnErrorMessages
    findLearnRecord
    cancelLearnAndRefFind

Layouts used in this script

    learn4EDIT
    <Missing Layout>
    learnFIND
    learnStuff3
    learn3

Tables used in this script

    TEMP
    testlearn

Table occurrences used by this script

    TEMP
    refTestLearn
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [findLearnRecord]	Parent Folder: [learn]	Next Script: [gotoLearnQV]
Script Name	gotoLearn
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultSetup
    defaultTest
    defaultTestNewSection

Scripts that use this script

Script Definition
Script Steps

    #
    #Basic administration tasks.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    #
    #Clear sort so when user click's button it will
    #resort records by order number.
    Set Field [ TEMP::TLTestSort; "" ]
    #
    If [ tempSetup::kdefaultCopyright = "" ]
    Show Custom Dialog [ Message: "Select the default copyright for any new records that you create by clicking the copyright button (you can always change your mind)."; Default Button: “OK”, Commit: “Yes” ]
    Halt Script
    Else If [ tempSetup::kdefaultNodePrimary = "" ]
    Show Custom Dialog [ Message: "Select yourself (the node responsible for creating new records) by clicking the node button."; Default Button: “OK”, Commit: “No” ]
    Halt Script
    End If
    #
    Select Window [ Name: "Setup"; Current file ]
    Set Window Title [ Current Window; New Title: "Learn" ]
    Set Variable [ $$stoploadCitation; Value:1 ]
    Set Variable [ $$doNotHaltOtherScripts; Value:1 ]
    #
    #Select the correct layout.
    If [ tempSetup::layoutLmain = "" ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Go to Layout [ “learn2” (testlearn) ]
    Else
    Go to Layout [ “learnStuff2” (testlearn) ]
    End If
    Set Field [ TEMP::layoutLmain; "more" & Get (LayoutName) ]
    Else If [ tempSetup::layoutLmain ≠ "" ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Go to Layout [ "Learn" & Right ( tempSetup::layoutLmain ; 1 ) ]
    Else
    Go to Layout [ "LearnStuff" & Right ( tempSetup::layoutLmain ; 1 ) ]
    End If
    End If
    #
    #Now find and show all main learn records
    #(exclude test result records which are
    #also in the testlearn table).
    Enter Find Mode [ ]
    Set Field [ testlearn::filterFind; "main" & ¶ ]
    Perform Find [ ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::date; descending testlearn::timestamp; descending ] [ Restore; No dialog ]
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::orderInventoryGroupNumber; ascending testlearn::note; ascending ] [ Restore; No dialog ]
    End If
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    #
    #Capture keys of related tag menu items to
    #to allow the citationMenu scripts to loop to the
    #primary record of interest when the user navigates
    #to a item on the Tag Menu window
    #whose list of tags like node, keyword, test, etc.
    #might contain an item related to the current
    #learn record, but which one, which is why all
    #the keys have to be readied. Mmm... now that
    #I write this out, I'm thinking I could have the
    #citationMenu scripts select the citation window
    #to grab the key if any in the current current
    #record that applies the the menu item.
    Set Variable [ $$RecordID; Value:Get (RecordID) ]
    Set Variable [ $$main; Value:testlearn::_Ltestlearn ]
    Set Variable [ $$ref; Value:testlearn::kcreference ]
    Set Variable [ $$node; Value:testlearn::kNodeOther ]
    Set Variable [ $$copyright; Value:testlearn::kcopyright ]
    Set Variable [ $$Key; Value:testlearn::kcKeywordOther ]
    Set Variable [ $$brainstorm; Value:testlearn::kcbrainstorm ]
    Set Variable [ $$test; Value:testlearn::kctestSubsectionInfo ]
    Set Variable [ $$citationRecord; Value:testlearn::_Ltestlearn ]
    Set Variable [ $$OtherKey; Value:testlearn::kcKeywordOther ]
    Set Variable [ $$primaryNode; Value:testlearn::kNodePrimary ]
    Set Variable [ $$PrimaryKey; Value:testlearn::kKeywordPrimary ]
    #
    #Clear module variable so test Tag Menus
    #back button does not show up.
    Set Variable [ $$learnRecord ]
    Set Variable [ $$testTagRecord ]
    #
    #Note if record is locked to protect its tags.
    If [ tagTLNodePrimary::orderOrLock ≠ "" ]
    Set Variable [ $$lockedMainLearnRecord; Value:tagTLNodePrimary::tag ]
    Else
    Set Variable [ $$lockedMainLearnRecord ]
    End If
    #
    #Load keyword menu.
    Set Variable [ $$stoploadCitation ]
    Select Window [ Name: "Tag Menus"; Current file ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Go to Layout [ “ltagNK1” (tagMenus) ]
    Perform Script [ “menuKey” ]
    Else
    Go to Layout [ “learnMenu3CiteS” (reference) ]
    Perform Script [ “menuReference” ]
    End If
    #
    #Return to Learn window.
    Select Window [ Name: "Learn"; Current file ]
    Set Variable [ $$doNotHaltOtherScripts ]
    #

Fields used in this script

    TEMP::TLTestSort
    tempSetup::kdefaultCopyright
    tempSetup::kdefaultNodePrimary
    tempSetup::layoutLmain
    TEMP::InventoryLibraryYN
    TEMP::layoutLmain
    testlearn::filterFind
    testlearn::date
    testlearn::timestamp
    testlearn::orderInventoryGroupNumber
    testlearn::note
    testlearn::_Ltestlearn
    testlearn::kcreference
    testlearn::kNodeOther
    testlearn::kcopyright
    testlearn::kcKeywordOther
    testlearn::kcbrainstorm
    testlearn::kctestSubsectionInfo
    testlearn::kNodePrimary
    testlearn::kKeywordPrimary
    tagTLNodePrimary::orderOrLock
    tagTLNodePrimary::tag

Scripts used in this script

    menuKey
    menuReference

Layouts used in this script

    learn2
    learnStuff2
    ltagNK1
    learnMenu3CiteS

Tables used in this script

    TEMP
    TEMP
    tag
    testlearn

Table occurrences used by this script

    TEMP
    tagTLNodePrimary
    tempSetup
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [gotoLearn]	Parent Folder: [learn]	Next Script: [gotoLearnWebsite]
Script Name	gotoLearnQV
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    learn0
    learnStuff0
    learn1
    learnStuff1
    learn2
    learnStuff2
    learn3
    learnStuff3
    learn4
    learnStuff4
    learn5
    learnStuff5

Scripts that use this script

Script Definition
Script Steps

    #
    #If in find mode, exit script.
    If [ $$findMode ≠ "" ]
    Show Custom Dialog [ Message: "Currently in find mode. Click done in the tag menus window to exit find mode, and then click this button."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #Check if there are an references from the
    #reference setion of the library (not learn
    #references). And if there are then ask if the
    #user would like to find them or go the QV
    #interface for this record.
    If [ ( testlearn::kcreference = "" or ValueCount ( testlearn::kcreference ) - Length ( Filter ( testlearn::kcreference ; "L" ) ) = 0 ) = 0 ]
    Show Custom Dialog [ Message: "Go to the QV interface for this record?" & ¶ & " OR " & ¶ & "Find all its references?"; Default Button: “go”, Commit: “Yes”; Button 2: “find”, Commit: “No”; Button 3: “cancel”, Commit: “No” ]
    If [ Get ( LastMessageChoice ) = 1 ]
    #Continue with this script.
    End If
    If [ Get ( LastMessageChoice ) = 2 ]
    #Find this record's references and display them
    #in the Tag Menus window.
    Perform Script [ “CHUNK_findLearnRecordsReferences” ]
    Exit Script [ ]
    End If
    If [ Get ( LastMessageChoice ) = 3 ]
    #Cancel.
    Exit Script [ ]
    End If
    End If
    #
    #Prevent the unnecessary loading of records.
    Set Variable [ $$stoploadCitation; Value:1 ]
    #
    #If in find mode, exit find mode.
    If [ $$findMode= 1 ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Set Variable [ $$findMode ]
    Set Variable [ $$firstFind ]
    Set Variable [ $$firstFindOther ]
    Set Variable [ $$found ]
    Set Variable [ $$foundOther ]
    Go to Layout [ $$findLayout ]
    Set Variable [ $$stoploadCitation ]
    Select Window [ Name: "Learn"; Current file ]
    End If
    #
    #Capture layout name.
    Set Variable [ $$testLearnLayoutName; Value:Get (LayoutName) ]
    #
    #Capture note and timestamp. If these are
    #changed while on the Qv layout it will effect
    #the record's sort location and require a resort
    #for the user to see the record they went to the
    #QV window to look at.
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Set Variable [ $$QvNote; Value:testlearn::note ]
    Set Variable [ $$QvLocation; Value:testlearn::orderInventoryGroupNumber ]
    Else
    Set Variable [ $$QvTimestamp; Value:testlearn::timestamp ]
    End If
    #
    #Go to edit layout for this record.
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    If [ tagTLNodePrimary::orderOrLock = "" ]
    Go to Layout [ “learn4EDITstuff” (testlearn) ]
    Else
    Go to Layout [ “learn4EDITstuffLocked” (testlearn) ]
    End If
    Else
    If [ tagTLNodePrimary::orderOrLock = "" ]
    Go to Layout [ “learn4EDIT” (testlearn) ]
    Else
    Go to Layout [ “learn4EDITLocked” (testlearn) ]
    End If
    End If
    #
    #Prevent add mode.
    Set Variable [ $$stopAdd; Value:1 ]
    Set Variable [ $$stoploadCitation ]
    #
    #

Fields used in this script

    testlearn::kcreference
    TEMP::InventoryLibraryYN
    testlearn::note
    testlearn::orderInventoryGroupNumber
    testlearn::timestamp
    tagTLNodePrimary::orderOrLock

Scripts used in this script

    CHUNK_findLearnRecordsReferences

Layouts used in this script

    <Missing Layout>
    learn4EDITstuff
    learn4EDITstuffLocked
    learn4EDIT
    learn4EDITLocked

Tables used in this script

    TEMP
    tag
    testlearn

Table occurrences used by this script

    TEMP
    tagTLNodePrimary
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [gotoLearnQV]	Parent Folder: [learn]	Next Script: [haltShareScript]
Script Name	gotoLearnWebsite
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    learnMenuStuffBrainstormLocations

Scripts that use this script

Script Definition
Script Steps

    Open URL [ learnBrainstormWebsite::URL ] [ No dialog ]

Fields used in this script

    learnBrainstormWebsite::URL

Scripts used in this script

Layouts used in this script

Tables used in this script

    setupReference

Table occurrences used by this script

    learnBrainstormWebsite

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [gotoLearnWebsite]	Parent Folder: [learn]	Next Script: [holderCheckBox]
Script Name	haltShareScript
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #Stop share script.
    Set Variable [ $$stopLoadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    Close Window [ Name: "Share"; Current file ]
    Install Menu Set [ “HGT” ]
    Halt Script

Fields used in this script

Scripts used in this script

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script

    HGT


Previous Script: [haltShareScript]	Parent Folder: [learn]	Next Script: [learnInsertReferenceIntoNote]
Script Name	holderCheckBox
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #Prevent user from tagging holder records
    #with other holder tags. I.E., No holder
    #inside of holder relationships allowed.
    If [ TEMP::InventoryLibraryYN = "" ]
    Exit Script [ ]
    End If
    #
    If [ Filter (testlearn::kcreference ; "L") ≠ "" ]
    Set Field [ testlearn::brainstormCasePoint; "" ]
    Show Custom Dialog [ Message: "This item is in/on a holder (box, shelf, etc.). To make it a location tag, 1) click 'tag', 2) click 'it's here', 3) click 'holder', and 4) remove it from its current holder."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #

Fields used in this script

    TEMP::InventoryLibraryYN
    testlearn::kcreference
    testlearn::brainstormCasePoint

Scripts used in this script

Layouts used in this script

Tables used in this script

    TEMP
    testlearn

Table occurrences used by this script

    TEMP
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [holderCheckBox]	Parent Folder: [learn]	Next Script: [learnOpenTextNewWindow]
Script Name	learnInsertReferenceIntoNote
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    LearnTextWindow
    LearnTextWindow_iDevice

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Admin tasks.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #If the record has no references, then insert a
    #generic reference template and let user know
    #the benefits of tag references and then
    #clicking the insertRef button.
    If [ testlearn::kcreference = "" or ValueCount ( testlearn::kcreference ) - Length ( Filter ( testlearn::kcreference ; "L" ) ) = 0 ]
    Show Custom Dialog [ Message: "If you add references to a record like this one, this button will give you a list of pre-formatted references to insert including the author's name and date of publication."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #Make sure the cursor is in active field and if
    #not tell them to click in one.
    If [ Get ( ActiveFieldName ) = "" or Get ( ActiveFieldName ) ≠ "note" ]
    Show Custom Dialog [ Message: "Click into the text field, and then click exactly where you want — " & Trim ($tag) & " — inserted."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #Make sure the user has not selected any text.
    If [ Get ( ActiveFieldName ) = "" or Get ( ActiveFieldName ) ≠ "note" ]
    Show Custom Dialog [ Message: "Click into the text field, and then click exactly where you want — " & Trim ($tag) & " — inserted."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #Remind the user that the inserted reference
    #is going to go where they have placed
    #their cursor.
    Show Custom Dialog [ Message: "Is your cursor where you want to insert a reference? WARNING: Selected text will be erased during insert." & "" & ¶ & "(You can also click 'yes' just to see this note's references.)"; Default Button: “yes”, Commit: “Yes”; Button 2: “cancel”, Commit: “No” ]
    If [ Get (LastMessageChoice) = 2 ]
    Exit Script [ ]
    End If
    #
    #Hide controls so user knows to close the
    #Insert Reference window before they can
    #continue editing their note.
    Set Variable [ $$hideEditNoteControls; Value:1 ]
    Refresh Window
    #
    #Capture the keys of the references load.
    Set Variable [ $references; Value:testlearn::kcreference ]
    #
    #Determine how many references there are.
    Set Variable [ $numberOfReferences; Value:ValueCount ( testlearn::kcreference ) ]
    #
    #Prevent loading up records.
    Set Variable [ $$STOPloadReferenceForInsertIntoText; Value:1 ]
    #
    #In the test section, go the Reference window
    #or open one up if neccessary.
    If [ Get ( SystemPlatform ) = - 2 ]
    New Window [ Name: "Insert Reference"; Height: Get (WindowDesktopHeight) - 21; Width: Get (ScreenWidth) / 2; Top: 0; Left: Get (ScreenWidth) / 2; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Else
    New Window [ Name: "Insert Reference"; Height: Get (ScreenHeight); Width: Get (ScreenWidth) / 2; Top: 0; Left: Get (ScreenWidth) / 2; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    End If
    #
    #Go the insert references layout.
    Go to Layout [ “learnMenu3CitePickAReference” (reference) ]
    #
    #Find the first reference. NOTE: It may be this
    #first reference is a learn reference, and so no
    #records will be found, but this is OK. This first
    #find clears out any records that may have
    #been found previously, and replaces them with
    #the outcome of this first find, which if none is,
    #again, OK. Then next find step expands on
    #this find, so to speed things up, it will not look
    #for learn references, BUT if this step did not
    #look for learn records, the script would in
    #effect skip this first find and so leave in place
    #the records found previously. Very Bad!
    #NOTE: I've had a lot of caffeine.
    Enter Find Mode [ ]
    Set Field [ reference::_Lreference; GetValue ( $references ; $numberOfReferences ) ]
    Perform Find [ ]
    #
    #If there is more than one reference, then load
    #find them one-at-time until all have been found.
    Loop
    Set Variable [ $numberOfReferences; Value:$numberOfReferences - 1 ]
    #
    #Exit find loop once all references have
    #been found.
    Exit Loop If [ $numberOfReferences = 0 ]
    #
    #Only find references from the Reference section.
    If [ Right ( GetValue ( $references ; $numberOfReferences ) ; 1 ) ≠ "L" ]
    Enter Find Mode [ ]
    Set Field [ reference::_Lreference; GetValue ( $references ; $numberOfReferences ) ]
    Extend Found Set [ ]
    End If
    #
    End Loop
    #
    #Sort according the user's preference.
    If [ TEMP::sortInsertRef = "cat" or TEMP::sortInsertRef = "" ]
    Set Field [ TEMP::sortInsertRef; "abc" ]
    Else If [ TEMP::sortInsertRef = "abc" ]
    Set Field [ TEMP::sortInsertRef; "cat" ]
    End If
    Perform Script [ “sortTags” ]
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    #
    #Resize the window.
    Move/Resize Window [ Name: "Test"; Current file; Width: Get ( ScreenWidth ) / 3; Left: 0 ]
    #
    #Turn back on info record record's load script.
    Set Variable [ $$STOPloadReferenceForInsertIntoText ]
    Perform Script [ “loadReferenceForInsertIntoText” ]
    #
    #Pause the script so the user cannot do
    #anything until they either insert a reference
    #or close this window.
    Pause/Resume Script [ Indefinitely ]
    #
    #

Fields used in this script

    testlearn::kcreference
    reference::_Lreference
    TEMP::sortInsertRef

Scripts used in this script

    sortTags
    loadReferenceForInsertIntoText

Layouts used in this script

    learnMenu3CitePickAReference

Tables used in this script

    TEMP
    reference
    testlearn

Table occurrences used by this script

    TEMP
    reference
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [learnInsertReferenceIntoNote]	Parent Folder: [learn]	Next Script: [newLearn]
Script Name	learnOpenTextNewWindow
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    learn0
    learnStuff0
    learn1
    learnStuff1
    learn2
    learnStuff2
    learn3
    learnStuff3
    learn4
    learnStuff4
    learn5
    learnStuff5
    learn4EDIT
    learn4EDITLocked
    learn4EDITstuff
    learn4EDITstuffLocked

Scripts that use this script

    duplicateLearnRecord
    newLearn

Script Definition
Script Steps

    If [ Get ( WindowMode ) = 1 ]
    Go to Field [ testlearn::note ]
    Exit Script [ ]
    End If
    #
    #Stop script if user clicked in the note field to
    #navigate to this record, not to open the text
    #edit window.
    If [ $$stopOpenNewTextWindow = 1 ]
    Set Variable [ $$stopOpenNewTextWindow ]
    Exit Script [ ]
    End If
    Go to Field [ ]
    #
    #Set variable so when user closes this edit
    #window a test can be performed to see if
    #record was changed and so Learn window
    #needs to be resorted for inventory tags only.
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Set Variable [ $$copyNoteForSortCheck; Value:testlearn::note ]
    End If
    #
    Set Variable [ $record; Value:testlearn::_Ltestlearn ]
    Set Variable [ $$stopLoadCitation; Value:1 ]
    Close Window [ Name: "Edit"; Current file ]
    New Window [ Name: "Edit"; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    If [ tagTLNodePrimary::orderOrLock = "" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    #
    #If the user in on an iDevice...
    If [ Get ( SystemPlatform ) = 3 ]
    Go to Layout [ “LearnTextWindowStuff_iDevice” (testlearn) ]
    Else
    Go to Layout [ “LearnTextWindowStuff” (testlearn) ]
    End If
    Else
    #
    #If the user in on an iDevice...
    If [ Get ( SystemPlatform ) = 3 ]
    Go to Layout [ “LearnTextWindow_iDevice” (testlearn) ]
    Else
    Go to Layout [ “LearnTextWindow” (testlearn) ]
    End If
    End If
    Go to Field [ testlearn::note ]
    Else If [ tagTLNodePrimary::orderOrLock ≠ "" ]
    #
    #If the user in on an iDevice...
    If [ Get ( SystemPlatform ) = 3 ]
    Go to Layout [ “LearnTextWindowLocked_iDevice” (testlearn) ]
    Else
    Go to Layout [ “LearnTextWindowLocked” (testlearn) ]
    End If
    End If
    Enter Find Mode [ ]
    Set Field [ testlearn::_Ltestlearn; $record ]
    Perform Find [ ]
    Set Variable [ $$stopLoadCitation ]
    If [ $$duplicateRecord = 1 ]
    Set Variable [ $$duplicateRecord ]
    Go to Field [ testlearn::note ] [ Select/perform ]
    Else
    Go to Field [ testlearn::note ]
    End If
    #
    #If the user in on an iDevice...
    If [ Get ( SystemPlatform ) = 3 ]
    Show Custom Dialog [ Message: "Use two-finger pinch-and-zoom gesture to make text easier to see and edit."; Default Button: “OK”, Commit: “Yes” ]
    End If
    Pause/Resume Script [ Indefinitely ]
    #
    #

Fields used in this script

    testlearn::note
    TEMP::InventoryLibraryYN
    testlearn::_Ltestlearn
    tagTLNodePrimary::orderOrLock

Scripts used in this script

Layouts used in this script

    LearnTextWindowStuff_iDevice
    LearnTextWindowStuff
    LearnTextWindow_iDevice
    LearnTextWindow
    LearnTextWindowLocked_iDevice
    LearnTextWindowLocked

Tables used in this script

    TEMP
    tag
    testlearn

Table occurrences used by this script

    TEMP
    tagTLNodePrimary
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [learnOpenTextNewWindow]	Parent Folder: [learn]	Next Script: [shareLearnRecords]
Script Name	newLearn
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    learn0
    learnStuff0
    learn1
    learnStuff1
    learn2
    learnStuff2
    learn3
    learnStuff3
    learn4
    learnStuff4
    learn5
    learnStuff5

Scripts that use this script

Script Definition
Script Steps

    #
    #If node is currenlty locked then stop script,
    #and inform the user.
    Perform Script [ “stopNewRecordsBeingCreatedByLockedNode” ]
    #
    #If in find mode, exit script.
    If [ $$findMode ≠ "" ]
    Show Custom Dialog [ Message: "Currently in find mode. Click done in the tag menus window to exit find mode, and then click this button."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    Set Variable [ $$stoploadCitation; Value:1 ]
    #
    #If in inventory mode, add the primary location
    #tag of the group the user was in when they
    #clicked the new button.
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Set Variable [ $locationTag; Value:Case ( refContainerLocation::_Lreference ≠ "" ; refContainerLocation::_Lreference ; refLearn 2::_Lreference ) ]
    End If
    #
    Go to Field [ ]
    Freeze Window
    New Record/Request
    Set Field [ testlearn::kNodePrimary; TEMP::kdefaultNodePrimary ]
    Set Field [ testlearn::kRecordCreatorNode; TEMP::kdefaultNodePrimary ]
    Set Field [ testlearn::dateModify; Get ( CurrentTimeStamp ) ]
    Set Field [ testlearn::kNodeOther; TEMP::kdefaultNodeOther ]
    Set Field [ testlearn::NodeOthers; TEMP::DEFAULTNodeOtherNames ]
    Set Field [ testlearn::kcopyright; TEMP::kdefaultCopyright ]
    #If in inventory mode, add the primary location
    #tag of the group the user was in when they
    #clicked the new button.
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Set Field [ testlearn::kcreference; $locationTag ]
    End If
    Set Field [ testlearn::incomplete; "incomplete" & ¶ ]
    Set Field [ testlearn::filterFind; "main" & ¶ ]
    If [ Right ( Get ( LayoutName ) ; 4 ) = "EDIT" ]
    Set Field [ testlearn::filterFind; "main" & ¶ ]
    Set Variable [ $$stoploadCitation ]
    #
    #Note that citation is for either the node or keyword depending on the citation match.
    Else If [ Right ( Get ( LayoutName ) ; 3 ) = "TAG" ]
    Set Field [ testlearn::filterFind; "main" & ¶ ]
    End If
    Sort Records [ ] [ No dialog ]
    Set Variable [ $record; Value:Get (RecordNumber) ]
    Go to Record/Request/Page [ $record ] [ No dialog ]
    Set Variable [ $$stoploadCitation ]
    // Perform Script [ “loadLearnOrRefMainRecord” ]
    Set Variable [ $$main; Value:testlearn::_Ltestlearn ]
    #
    #capture keys of related tag menu items to
    #to allow the citationMenu scripts to loop to the
    #primary record of interest when the user navigates
    #to a item on the Tag Menu window
    #whose list of tags like node, keyword, medium, etc.
    #might contain an item related to the current
    #citation record, but which one, which is why all
    #the keys have to be readied. Mmm... now that
    #I write this out, I'm thinking I could have the
    #citationMenu scripts select the citation window
    #to grab the key if any in the current current
    #record that applies to the menu item.
    Set Variable [ $$citationRecord; Value:testlearn::_Ltestlearn ]
    Set Variable [ $$node; Value:testlearn::kNodeOther ]
    Set Variable [ $$primaryNode; Value:testlearn::kNodePrimary ]
    Set Variable [ $$copyright; Value:testlearn::kcopyright ]
    Set Variable [ $$ref; Value:testlearn::kcreference ]
    Set Variable [ $$PrimaryKey; Value:testlearn::kKeywordPrimary ]
    Set Variable [ $$Key; Value:testlearn::kcKeywordOther ]
    Set Variable [ $$OtherKey; Value:testlearn::kcKeywordOther ]
    Set Variable [ $$test; Value:testlearn::kctestSubsectionInfo ]
    Set Variable [ $$brainstorm; Value:testlearn::kcbrainstorm ]
    Set Variable [ $$RecordID; Value:Get (RecordID) ]
    Set Variable [ $$stopOpenNewTextWindow ]
    Set Variable [ $$stopLoadCitation; Value:1 ]
    Set Variable [ $$citationItem ]
    If [ $$citationMatch = "node" ]
    Set Variable [ $$citationItem; Value:TEMP::kdefaultNodePrimary ]
    End If
    #
    #Clear conditional formatting in Tag Menus window.
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    Select Window [ Name: "Learn"; Current file ]
    Set Variable [ $$stopLoadCitation ]
    #
    #Open new record in text window so
    #user can now edit it.
    Perform Script [ “learnOpenTextNewWindow” ]
    #

Fields used in this script

    TEMP::InventoryLibraryYN
    refContainerLocation::_Lreference
    refLearn 2::_Lreference
    TEMP::kdefaultNodePrimary
    testlearn::kNodePrimary
    testlearn::kRecordCreatorNode
    testlearn::dateModify
    TEMP::kdefaultNodeOther
    testlearn::kNodeOther
    TEMP::DEFAULTNodeOtherNames
    testlearn::NodeOthers
    TEMP::kdefaultCopyright
    testlearn::kcopyright
    testlearn::kcreference
    testlearn::incomplete
    testlearn::filterFind
    testlearn::_Ltestlearn
    testlearn::kKeywordPrimary
    testlearn::kcKeywordOther
    testlearn::kctestSubsectionInfo
    testlearn::kcbrainstorm

Scripts used in this script

    stopNewRecordsBeingCreatedByLockedNode
    loadLearnOrRefMainRecord
    learnOpenTextNewWindow

Layouts used in this script

Tables used in this script

    TEMP
    reference
    testlearn

Table occurrences used by this script

    TEMP
    refContainerLocation
    refLearn 2
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [newLearn]	Parent Folder: [learn]	Next Script: [shareWindowCopyTextButton]
Script Name	shareLearnRecords
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    learn0
    learnStuff0
    learn1
    learnStuff1
    learn2
    learnStuff2
    learn3
    learnStuff3
    learn4
    learnStuff4
    learn5
    learnStuff5

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #
    #If in find mode, exit script.
    If [ $$findMode ≠ "" ]
    Show Custom Dialog [ Message: "Currently in find mode. Click done in the tag menus window to exit find mode, and then click this button."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #
    #
    #BEGIN: SHARE DOCUMENT CREATION
    # PART 1 >> Admin
    # PART 2 >> Find Records
    # PART 3 >> What about references?
    # PART 4 >> Build shared document
    # PART 5 >> Display share document
    # PART 6 >> Report any issues
    #
    #
    #
    #
    #
    #PART 1 >> Admin ————————————
    #
    #
    #
    #
    #
    #Admin tasks.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #Close Share and Sbare windows, as they may
    #be open from the last time the user clicked the
    #share button.
    Close Window [ Name: "Share"; Current file ]
    #Yup, the window is named "Sbare."
    Close Window [ Name: "Sbare"; Current file ]
    #See explenation below.
    #
    Set Variable [ $$stopLoadCitation; Value:1 ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    #
    #
    #Open a new window to find learn records in.
    #(For testing, enable the window that is
    #not out of sight.)
    // New Window [ Name: "Share"; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    New Window [ Name: "Share"; Height: 1; Width: 1; Top: 10000; Left: 10000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “learnPreviewLayout” (testlearn) ]
    #
    #
    #
    #
    #
    #PART 2 >> Find Records ——————————
    #
    #
    #
    #
    #
    #BEGIN Find brainstorm or test tagged records
    #
    #If the Tag Menus window is showing the brainstorm
    #or inventory menu when the use clicked 'share'
    #then find the records tagged with the currently
    #selected brainstorm tag = $$brainstorm variable.
    If [ $$citationMatch = "brainstorm" or $$citationMatch = "test" ]
    #
    #Find all brainstorm or inventory list records.
    Enter Find Mode [ ]
    #
    #This keychain contain the item's three-digit
    #order number followed by the key of the
    #brainstorm or inventory list tag record.
    If [ $$citationMatch = "brainstorm" ]
    Set Field [ testlearn::kcbrainstorm; "***" & $$tagBrainstorm ]
    Else If [ $$citationMatch = "test" ]
    Set Field [ testlearn::kctestSubsectionInfo; "***" & $$tagTest ]
    End If
    Perform Find [ ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::orderTestInformation; based on value list: “testPulldownListANDsortOrderList” testlearn::timestamp; descending ] [ Restore; No dialog ]
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::orderInventoryGroupNumber; ascending testlearn::orderTestInformation; based on value list: “testPulldownListANDsortOrderList” testlearn::note; ascending ] [ Restore; No dialog ]
    End If
    #
    #Stop the script if no records are found and
    #tell the user why.
    If [ Get (FoundCount) = 0 ]
    Close Window [ Current Window ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Set Variable [ $tagName; Value:tagMenus::tag ]
    Select Window [ Name: "Learn"; Current file ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Show Custom Dialog [ Message: "There are no Learn records tagged with — " & $tagName & " — in the Tag Menus window. Only brainstorm tagged records can be shared when the brainstorm tag menu is active."; Default Button: “OK”, Commit: “Yes” ]
    Else
    Show Custom Dialog [ Message: "When an inventory list tag is active in the Tag Menus window, clicking the share button will show only records tagged with it. Zero records are tagged with " & $tagName & "."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    Set Variable [ $$stopLoadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    #
    Exit Script [ ]
    End If
    End If
    #
    #END Find brainstorm or test tagged records
    #
    #
    #
    #
    #
    #BEGIN Find and order non-brainstorm/test
    #tagged records
    #
    #
    #Select the Learn window as the background
    #for the coming set of questions the user needs
    #to answer. It is confusing if the user sees the
    #title of learn window changed to 'share' when
    #asked these questions.
    Select Window [ Name: "Learn"; Current file ]
    #
    #BEGIN Find out which records to share?
    #
    If [ $$citationMatch ≠ "brainstorm" and $$citationMatch ≠ "test" ]
    #
    #Used for message below to let user know how
    #many records are currently showing that they
    #could share.
    Set Variable [ $numberOfRecordsBeingViewed; Value:Get (FoundCount) ]
    #
    #If the current Learn record is linked to other
    #Learn note records, do this.
    If [ TEMP::InventoryLibraryYN = "" and Filter ( testlearn::kcreference ; "L" ) ≠ "" or TEMP::InventoryLibraryYN = "" and $$LinkedLearnRecords ≠ "" ]
    #
    #Ask user if they want to share just the linked
    #records or share all records being viewed.
    If [ TEMP::InventoryLibraryYN = "" ]
    Show Custom Dialog [ Message: "Share only this note + " & Length ( Filter ( testlearn::kcreference ; "L" ) ) & Case ( Length ( Filter ( testlearn::kcreference ; "L" ) ) = 1 ; " note" ; " notes" ) & " linked to it?" & ¶ & "OR" & ¶ & "Share all notes being viewed? Now viewing " & Get (FoundCount) & ".", Default Button: "note+" & Length ( Filter ( testlearn::kcreference ; "L" ) ), Commit: “Yes”; Button 2: “all”, Commit: “No”; Button 3: “cancel”, Commit: “No” ]
    End If
    #
    #Save the user's selection.
    If [ Get (LastMessageChoice) = 1 ]
    Set Variable [ $show; Value:"self and linked" ]
    Else If [ Get (LastMessageChoice) = 2 ]
    Set Variable [ $show; Value:"all" ]
    End If
    #
    #Exit script if user clicks cancel.
    If [ Get ( LastMessageChoice ) = 3 ]
    Set Variable [ $$stopLoadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    Close Window [ Name: "Share"; Current file ]
    Exit Script [ ]
    End If
    #
    #
    Else
    #If the current Learn record is NOT linked to
    #other Learn records, or if this is an inventory
    #record do this.
    #
    #
    #Ask user if they want to share the selected
    #record, or share all records being viewed.
    If [ Get (FoundCount) ≠ 1 ]
    If [ TEMP::InventoryLibraryYN = "" ]
    #Note record is for an idea.
    Show Custom Dialog [ Message: "Share all notes or just this one? " & ¶ & "Now viewing " & Get (FoundCount) & "."; Default Button: “all”, Commit: “Yes”; Button 2: “one”, Commit: “No”; Button 3: “cancel”, Commit: “No” ]
    Else
    #Inventory record is for an item.
    Show Custom Dialog [ Message: "Share all inventory records being viewed or just this one? " & ¶ & "Now viewing " & Get (FoundCount) & "."; Default Button: “all”, Commit: “Yes”; Button 2: “one”, Commit: “No”; Button 3: “cancel”, Commit: “No” ]
    End If
    #
    #Save the user's selection.
    If [ Get (LastMessageChoice) = 1 ]
    Set Variable [ $show; Value:"all" ]
    Else If [ Get (LastMessageChoice) = 2 ]
    Set Variable [ $show; Value:"self" ]
    End If
    #
    #Exit script if user clicks cancel.
    If [ Get ( LastMessageChoice ) = 3 ]
    Set Variable [ $$stopLoadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    Close Window [ Name: "Share"; Current file ]
    Exit Script [ ]
    End If
    End If
    End If
    #
    #END Find out which records to share?
    #
    #
    #
    #BEGIN Ask how to order records being shared
    #
    If [ TEMP::InventoryLibraryYN = "" and $show ≠ "self" ]
    Show Custom Dialog [ Message: "Order notes as seen in the Learn window (newest 1st), or order them in chronoligcal order (oldest 1st)?"; Default Button: “newest 1st”, Commit: “Yes”; Button 2: “oldest 1st”, Commit: “No”; Button 3: “cancel”, Commit: “No” ]
    End If
    #
    If [ Get ( LastMessageChoice ) = 2 ]
    Set Variable [ $chronologicalSortOrder; Value:1 ]
    End If
    #
    If [ Get ( LastMessageChoice ) = 3 ]
    Set Variable [ $$stopLoadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    Close Window [ Name: "Share"; Current file ]
    Exit Script [ ]
    End If
    #
    #END Ask how to order notes being shared
    #
    #
    #
    #BEGIN Help user stop share if it takes to long
    #
    #I commonly click the share button when I do not mean
    #click it, so these next two question help the user
    #stop this process if it was not intential. They also
    #help the user understand that if they proceed how long
    #it is likely to take, so they don't become frustrated.
    If [ $show = "all" and Get ( FoundCount ) > 500 ]
    If [ Get ( FoundCount ) > 999 ]
    Show Custom Dialog [ Message: "FYI: It may take a minute or more to process this many records depending on each record's references and your computer's speed. An old MacBook Pro takes just under 10 minutes to process about 4,000 records."; Default Button: “OK”, Commit: “Yes”; Button 2: “cancel”, Commit: “No” ]
    #
    Else If [ Get ( FoundCount ) > 500 ]
    Show Custom Dialog [ Message: "FYI: It may take more than a minute to process this many records."; Default Button: “OK”, Commit: “Yes”; Button 2: “cancel”, Commit: “No” ]
    End If
    #
    If [ Get ( LastMessageChoice ) = 2 ]
    Set Variable [ $$stopLoadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    Close Window [ Name: "Share"; Current file ]
    Exit Script [ ]
    End If
    #
    Install Menu Set [ “HGT Stop Share” ]
    Show Custom Dialog [ Message: "If you get tired of waiting, just click on the 'Help' menu above and select 'Stop Share' to stop the processing of your records."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #END Help user stop share if it takes to long
    #
    #
    #
    #BEGIN Find records user wants to share
    #
    #Return to the share window.
    Select Window [ Name: "Share"; Current file ]
    #
    #If user elected to show only selected record,
    #then only find this record.
    If [ $show = "self" ]
    Enter Find Mode [ ]
    Set Field [ testlearn::_Ltestlearn; $$main ]
    Perform Find [ ]
    End If
    #
    #If user elected to show the selected record
    #and linked records, then find just these
    #records and show them.
    If [ $show = "self and linked" ]
    #
    #Find original record first.
    Enter Find Mode [ ]
    Set Field [ testlearn::_Ltestlearn; $$main ]
    Perform Find [ ]
    #
    #Get the selected record's linked record IDs.
    Set Variable [ $findLinkedLearnRecords; Value:testlearn::_Ltestlearn ]
    Loop
    Go to Object [ Object Name: "ref2" ]
    Exit Loop If [ Get (LastError) = 101 ]
    Set Variable [ $findLinkedLearnRecords; Value:refTestLearn::_Ltestlearn & ¶ & $findLinkedLearnRecords ]
    Go to Portal Row [ Select; Next; Exit after last ]
    End Loop
    #
    #Determine how many IDs there are.
    Set Variable [ $numberOfKeys; Value:ValueCount ($findLinkedLearnRecords ) ]
    #
    #Find the 1st ID'ed record.
    Enter Find Mode [ ]
    Set Field [ testlearn::_Ltestlearn; GetValue ( $findLinkedLearnRecords ; $numberOfKeys ) ]
    Extend Found Set [ ]
    Set Variable [ $numberOfKeys; Value:$numberOfKeys - 1 ]
    #
    #Loop thru set of IDs to until all linked records
    #have been found.
    Loop
    #
    #Exit the loop when there are no more IDs.
    Exit Loop If [ $numberOfKeys = 0 ]
    #
    #Find next record.
    Enter Find Mode [ ]
    Set Field [ testlearn::_Ltestlearn; GetValue ( $findLinkedLearnRecords ; $numberOfKeys ) ]
    Extend Found Set [ ]
    #
    #Go the next ID up from the bottom of the list
    #of IDs.
    Set Variable [ $numberOfKeys; Value:$numberOfKeys - 1 ]
    End Loop
    #
    #Next find all records with links to the
    #selected record.
    If [ $$LinkedLearnRecords ≠ "" ]
    #
    Enter Find Mode [ ]
    Set Field [ testlearn::kcreference; $$main ]
    Extend Found Set [ ]
    #
    End If
    End If
    #
    #END Find records user wants to share
    #
    #
    #Put all found records in order.
    If [ $chronologicalSortOrder = "" ]
    If [ TEMP::InventoryLibraryYN = "" ]
    #Sort in reverse chronological order.
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::date; descending testlearn::timestamp; descending ] [ Restore; No dialog ]
    Else
    #Sort by location and alphabetically by item.
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::orderInventoryGroupNumber; ascending testlearn::note; ascending ] [ Restore; No dialog ]
    End If
    Else
    #Sort in chronological order.
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::date; ascending testlearn::timestamp; ascending ] [ Restore; No dialog ]
    End If
    #
    #
    End If
    #
    #END Find and order non-brainstorm/test
    #tagged records
    #
    #
    #
    #
    #
    #PART 3 >> What about references? —————
    #
    #
    #
    #
    #
    #BEGIN Ask user what to do with references?
    #
    If [ TEMP::InventoryLibraryYN = "" and $show ≠ "self" ]
    #
    #Check if any of the records found have
    #references that the user might want
    #to display at the end of this share.
    Go to Record/Request/Page [ First ]
    Loop
    If [ ValueCount ( testlearn::kcreference ) - ( Length ( Filter ( testlearn::kcreference ; "L" ) ) ) > 0 ]
    Set Variable [ $thereAreReferences; Value:1 ]
    End If
    Exit Loop If [ ValueCount ( testlearn::kcreference ) - ( Length ( Filter ( testlearn::kcreference ; "L" ) ) ) > 0 ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #If there are references, ask if the user would
    #like to keep them with their notes or display
    #them all at the end of the share.
    If [ $thereAreReferences ≠ "" ]
    Select Window [ Name: "Learn"; Current file ]
    If [ $$citationMatch = "brainstorm" ]
    Show Custom Dialog [ Message: "Keep brainstorm note references with each note, or put all references in a separate reference section?"; Default Button: “section”, Commit: “Yes”; Button 2: “note”, Commit: “No”; Button 3: “cancel”, Commit: “No” ]
    Else
    Show Custom Dialog [ Message: "Keep note references with each note, or put all references in a separate reference section?"; Default Button: “section”, Commit: “Yes”; Button 2: “note”, Commit: “No”; Button 3: “cancel”, Commit: “No” ]
    End If
    End If
    #
    #If the user decides to consolidate all notes'
    #references to single reference section at
    #the end, do the following:
    If [ Get (LastMessageChoice) = 1 ]
    #
    #Note that the user wants an end
    #reference section.
    Set Variable [ $referencesInSectionAtEnd; Value:1 ]
    #
    #Ask them what else they might
    #like removed from the note.
    Show Custom Dialog [ Message: "Keep note numbering (#) and keywords, or just numbers, or remove all (essay format)?"; Default Button: “keepAll”, Commit: “Yes”; Button 2: “keep#”, Commit: “No”; Button 3: “removeAll”, Commit: “No” ]
    If [ Get (LastMessageChoice) = 1 ]
    #
    #Would the to keep just the timestamp or
    #only the keywords?
    Show Custom Dialog [ Message: "Finally, keep timestamp and keywords, or only timestamp, or only keywords?"; Default Button: “keepBoth”, Commit: “Yes”; Button 2: “KeepTime”, Commit: “No”; Button 3: “keepKey”, Commit: “No” ]
    If [ Get (LastMessageChoice) = 1 ]
    Else If [ Get (LastMessageChoice) = 2 ]
    Set Variable [ $keepTimestamp; Value:1 ]
    Else If [ Get (LastMessageChoice) = 3 ]
    Set Variable [ $keepKeywords; Value:1 ]
    End If
    Else If [ Get (LastMessageChoice) = 2 ]
    Set Variable [ $numberOnlyFormat; Value:1 ]
    Else If [ Get (LastMessageChoice) = 3 ]
    Set Variable [ $essayFormat; Value:1 ]
    End If
    #
    #If the user wants to display them at the end,
    #open a new window to gather all learn
    #records' references.
    New Window [ Name: "Sbare"; Height: 1; Width: 1; Top: 10000; Left: 10000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “shareReferencesLast” (TEMP) ]
    #
    #Show all temp records and
    #then delete them to prepare this window for
    #the references that will pasted into it below.
    Show All Records
    Delete All Records [ No dialog ]
    New Record/Request
    Set Field [ TEMP::shareReferenceID; "firstRecord" ]
    Commit Records/Requests
    #
    #If the user cancels the script then stop it, but
    #do create 1 temporary record to display
    #information that is in these fields, like
    #the fields on the alldefaults layout.
    Else If [ Get (LastMessageChoice) = 3 ]
    Set Variable [ $$stopLoadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    Close Window [ Name: "Share"; Current file ]
    Close Window [ Name: "Sbare"; Current file ]
    Select Window [ Name: "Learn"; Current file ]
    Exit Script [ ]
    End If
    #
    End If
    #
    #END Ask user what to do with references?
    #
    #
    #
    #
    #
    #PART 4 >> Build shared document —————
    #
    #
    #
    #
    #
    #BEGIN Build note and reference sections
    #
    #
    #Now build a formatted share document,
    #numbering each record.
    Select Window [ Name: "Share"; Current file ]
    Set Variable [ $point; Value:1 ]
    Set Variable [ $evidence; Value:1 ]
    Go to Record/Request/Page [ First ]
    #
    #BEGIN LOOP SECTION Build and format notes
    #
    Loop
    #
    If [ TEMP::InventoryLibraryYN = "" ]
    #
    #BEGIN Build and format idea notes
    #
    #Assemble the note, order number, author, and
    #copyright (if different from default primary
    #node), timestamp, and keyword fields.
    #
    #Show each note found and ...
    Set Variable [ $recordReferenceCount; Value:ValueCount ( testlearn::kcreference ) - ( Length ( Filter ( testlearn::kcreference ; "L" ) ) ) ]
    If [ $essayFormat = "" and $numberOnlyFormat = "" ]
    If [ $keepKeywords = "" and $keepTimestamp = "" and $referencesInSectionAtEnd = "" ]
    #number, timestamp, keywords, references with note.
    # (Idenitical to next else if. Was going to
    # remove the grey R## from this "with notes"
    # option, but for now seems to be useful.)
    Set Variable [ $copy; Value://previous records Case ( $copy = "" ; "" ; $copy & ¶ ) & //number TextSize ( Case ( testlearn::brainstormCasePoint = "" ; $point & "." & $evidence ; $point & ".1" ) & //R# for number of references Case ( ValueCount ( testlearn::kcreference ) - ( Length ( Filter ( testlearn::kcreference ; "L" ) ) ) > 0 and TEMP::InventoryLibraryYN = "" ; " " & TextColor ( ValueCount ( testlearn::kcreference ) - ( Length ( Filter ( testlearn::kcreference ; "L" ) ) ) & "R" ; RGB ( 154 ; 154 ; 154 ) ) ; "" ) ; 11 ) & ¶ & //main text TextFont ( testlearn::note ; "Georgia" ) & ¶ & //grey text TextColor ( "_______________" ; RGB ( 200 ; 200 ; 200 ) ) & ¶ & TextSize ( TextColor ( //node Case ( tagTLNodePrimary::_Ltag ≠ TEMP::kdefaultNodePrimary ; tagTLNodePrimary::tag & Case ( testlearn::NodeOthers = "" ; "" ; "; " & testlearn::NodeOthers ) ; "" ) & //copyright Case ( tagTLNodePrimary::_Ltag ≠ TEMP::kdefaultNodePrimary ; ". Copyright " & learnCreatorsCopyright::tag & ¶ ; "" ) & //timestamp testlearn::timestamp & ¶ & //keyword Case ( testlearn::OtherKeyWords ≠ "" or testlearn::kKeywordPrimary ≠ "" ; Case ( ValueCount ( testlearn::kcKeywordOther ) + ValueCount ( testlearn::kKeywordPrimary ) = 1 ; "keyword — " ; "keywords — " ) & //primary keyword tagTLKeywordPrimary::tag & Case ( testlearn::OtherKeyWords = "" ; "" ; //other keyword Case ( testlearn::kKeywordPrimary ≠ "" ; ", " & testlearn::OtherKeyWords ; testlearn::OtherKeyWords ) ) ) & Case ( testlearn::OtherKeyWords ≠ "" or testlearn::kKeywordPrimary ≠ "" ; ¶ ; "" ) //finish text color ; RGB ( 119 ; 119 ; 119 ) ) ; 11 ) ]
    Else If [ $keepKeywords = "" and $keepTimestamp = "" and $referencesInSectionAtEnd ≠ "" ]
    #number, timestamp, keywords, references at end.
    # (Idenitical to above if. Was going to remove
    # the grey R## from the above "with notes"
    # option, but for now seems to be useful.)
    Set Variable [ $copy; Value://previous records Case ( $copy = "" ; "" ; $copy & ¶ ) & //number TextSize ( Case ( testlearn::brainstormCasePoint = "" ; $point & "." & $evidence ; $point & ".1" ) & //R# for number of references Case ( ValueCount ( testlearn::kcreference ) - ( Length ( Filter ( testlearn::kcreference ; "L" ) ) ) > 0 and TEMP::InventoryLibraryYN = "" ; " " & TextColor ( ValueCount ( testlearn::kcreference ) - ( Length ( Filter ( testlearn::kcreference ; "L" ) ) ) & "R" ; RGB ( 154 ; 154 ; 154 ) ) ; "" ) ; 11 ) & ¶ & //main text TextFont ( testlearn::note ; "Georgia" ) & ¶ & //grey text TextColor ( "_______________" ; RGB ( 200 ; 200 ; 200 ) ) & ¶ & TextSize ( TextColor ( //node Case ( tagTLNodePrimary::_Ltag ≠ TEMP::kdefaultNodePrimary ; tagTLNodePrimary::tag & Case ( testlearn::NodeOthers = "" ; "" ; "; " & testlearn::NodeOthers ) ; "" ) & //copyright Case ( tagTLNodePrimary::_Ltag ≠ TEMP::kdefaultNodePrimary ; ". Copyright " & learnCreatorsCopyright::tag & ¶ ; "" ) & //timestamp testlearn::timestamp & ¶ & //keyword Case ( testlearn::OtherKeyWords ≠ "" or testlearn::kKeywordPrimary ≠ "" ; Case ( ValueCount ( testlearn::kcKeywordOther ) + ValueCount ( testlearn::kKeywordPrimary ) = 1 ; "keyword — " ; "keywords — " ) & //primary keyword tagTLKeywordPrimary::tag & Case ( testlearn::OtherKeyWords = "" ; "" ; //other keyword Case ( testlearn::kKeywordPrimary ≠ "" ; ", " & testlearn::OtherKeyWords ; testlearn::OtherKeyWords ) ) ) & Case ( testlearn::OtherKeyWords ≠ "" or testlearn::kKeywordPrimary ≠ "" ; ¶ ; "" ) //finish text color ; RGB ( 119 ; 119 ; 119 ) ) ; 11 ) ]
    Else If [ $keepTimestamp ≠ "" ]
    #number, timestamp.
    Set Variable [ $copy; Value://previous records Case ( $copy = "" ; "" ; $copy & ¶ ) & //number TextSize ( Case ( testlearn::brainstormCasePoint = "" ; $point & "." & $evidence ; $point & ".1" ) & //R# for number of references Case ( ValueCount ( testlearn::kcreference ) - ( Length ( Filter ( testlearn::kcreference ; "L" ) ) ) > 0 and TEMP::InventoryLibraryYN = "" ; " " & TextColor ( ValueCount ( testlearn::kcreference ) - ( Length ( Filter ( testlearn::kcreference ; "L" ) ) ) & "R" ; RGB ( 154 ; 154 ; 154 ) ) ; "" ) ; 11 ) & ¶ & //main text TextFont ( testlearn::note ; "Georgia" ) & ¶ & //grey text TextColor ( "_______________" ; RGB ( 200 ; 200 ; 200 ) ) & ¶ & TextSize ( TextColor ( //node Case ( tagTLNodePrimary::_Ltag ≠ TEMP::kdefaultNodePrimary ; tagTLNodePrimary::tag & Case ( testlearn::NodeOthers = "" ; "" ; "; " & testlearn::NodeOthers ) ; "" ) & //copyright Case ( tagTLNodePrimary::_Ltag ≠ TEMP::kdefaultNodePrimary ; ". Copyright " & learnCreatorsCopyright::tag & ¶ ; "" ) & //timestamp testlearn::timestamp & ¶ //finish text color ; RGB ( 119 ; 119 ; 119 ) ) ; 11 ) ]
    Else If [ $keepKeywords ≠ "" ]
    #number, keywords.
    Set Variable [ $copy; Value://previous records Case ( $copy = "" ; "" ; $copy & ¶ ) & //number TextSize ( Case ( testlearn::brainstormCasePoint = "" ; $point & "." & $evidence ; $point & ".1" ) & //R# for number of references Case ( ValueCount ( testlearn::kcreference ) - ( Length ( Filter ( testlearn::kcreference ; "L" ) ) ) > 0 and TEMP::InventoryLibraryYN = "" ; " " & TextColor ( ValueCount ( testlearn::kcreference ) - ( Length ( Filter ( testlearn::kcreference ; "L" ) ) ) & "R" ; RGB ( 154 ; 154 ; 154 ) ) ; "" ) ; 11 ) & ¶ & //main text TextFont ( testlearn::note ; "Georgia" ) & ¶ & //grey text TextColor ( "_______________" ; RGB ( 200 ; 200 ; 200 ) ) & ¶ & TextSize ( TextColor ( //node Case ( tagTLNodePrimary::_Ltag ≠ TEMP::kdefaultNodePrimary ; tagTLNodePrimary::tag & Case ( testlearn::NodeOthers = "" ; "" ; "; " & testlearn::NodeOthers ) ; "" ) & //copyright Case ( tagTLNodePrimary::_Ltag ≠ TEMP::kdefaultNodePrimary ; ". Copyright " & learnCreatorsCopyright::tag & ¶ ; "" ) & //keyword Case ( testlearn::OtherKeyWords ≠ "" or testlearn::kKeywordPrimary ≠ "" ; Case ( ValueCount ( testlearn::kcKeywordOther ) + ValueCount ( testlearn::kKeywordPrimary ) = 1 ; "keyword — " ; "keywords — " ) & //primary keyword tagTLKeywordPrimary::tag & Case ( testlearn::OtherKeyWords = "" ; "" ; //other keyword Case ( testlearn::kKeywordPrimary ≠ "" ; ", " & testlearn::OtherKeyWords ; testlearn::OtherKeyWords ) ) ) & Case ( testlearn::OtherKeyWords ≠ "" or testlearn::kKeywordPrimary ≠ "" ; ¶ ; "" ) //finish text color ; RGB ( 119 ; 119 ; 119 ) ) ; 11 ) ]
    End If
    Else If [ $numberOnlyFormat ≠ "" ]
    #number.
    #BEGIN Number
    Set Variable [ $copy; Value://previous records Case ( $copy = "" ; "" ; $copy & ¶ ) & //number TextSize ( Case ( testlearn::brainstormCasePoint = "" ; $point & "." & $evidence ; $point & ".1" ) & //R# for number of references Case ( ValueCount ( testlearn::kcreference ) - ( Length ( Filter ( testlearn::kcreference ; "L" ) ) ) > 0 and TEMP::InventoryLibraryYN = "" ; " " & TextColor ( ValueCount ( testlearn::kcreference ) - ( Length ( Filter ( testlearn::kcreference ; "L" ) ) ) & "R" ; RGB ( 154 ; 154 ; 154 ) ) ; "" ) ; 11 ) & ¶ & //main text TextFont ( testlearn::note ; "Georgia" ) & ¶ & //node other than the primary author Case ( tagTLNodePrimary::_Ltag ≠ TEMP::kdefaultNodePrimary ; //grey text TextColor ( "_______________" ; RGB ( 200 ; 200 ; 200 ) ) & ¶ & TextSize ( TextColor ( //node Case ( tagTLNodePrimary::_Ltag ≠ TEMP::kdefaultNodePrimary ; tagTLNodePrimary::tag & Case ( testlearn::NodeOthers = "" ; "" ; "; " & testlearn::NodeOthers ) ; "" ) & //copyright Case ( tagTLNodePrimary::_Ltag ≠ TEMP::kdefaultNodePrimary ; ". Copyright " & learnCreatorsCopyright::tag & ¶ ; "" ) //finish text color ; RGB ( 119 ; 119 ; 119 ) ) ; 11 ) ; "" ) ]
    #
    #Given that the user has elected to not show
    #any information below the note (below the
    #grey line), call attention to the user when a
    #node's information is shown below a grey line
    #because the note is by a node other than the
    #one getting credit for the share.
    If [ tagTLNodePrimary::_Ltag ≠ TEMP::kdefaultNodePrimary ]
    Set Variable [ $nodeOtherThanPrimaryAuthor; Value:1 ]
    If [ tagTLNodePrimary::_Ltag ≠ TEMP::kdefaultNodePrimary ]
    Set Variable [ $nodeOtherThanPrimaryAuthor; Value:1 ]
    End If
    End If
    #END Number
    Else If [ $essayFormat ≠ "" ]
    #Show just the note and nothing else.
    #BEGIN Essay Format
    Set Variable [ $copy; Value://previous records Case ( $copy = "" ; "" ; $copy & ¶ ) & ¶ & //main text TextFont ( testlearn::note ; "Georgia" ) & ¶ & //node other than the primary author Case ( tagTLNodePrimary::_Ltag ≠ TEMP::kdefaultNodePrimary ; //grey text TextColor ( "_______________" ; RGB ( 200 ; 200 ; 200 ) ) & ¶ & TextSize ( TextColor ( //node Case ( tagTLNodePrimary::_Ltag ≠ TEMP::kdefaultNodePrimary ; tagTLNodePrimary::tag & Case ( testlearn::NodeOthers = "" ; "" ; "; " & testlearn::NodeOthers ) ; "" ) & //copyright Case ( tagTLNodePrimary::_Ltag ≠ TEMP::kdefaultNodePrimary ; ". Copyright " & learnCreatorsCopyright::tag & ¶ ; "" ) //finish text color ; RGB ( 119 ; 119 ; 119 ) ) ; 11 ) ; "" ) ]
    #
    #Given that the user has elected to not show
    #any information below the note (below the
    #grey line), call attention to the user when a
    #node's information is shown below a grey line
    #because the note is by a node other than the
    #one getting credit for the share.
    If [ tagTLNodePrimary::_Ltag ≠ TEMP::kdefaultNodePrimary ]
    Set Variable [ $nodeOtherThanPrimaryAuthor; Value:1 ]
    End If
    #END Essay Format
    #
    End If
    #
    #END Build and format idea notes
    #
    Else If [ TEMP::InventoryLibraryYN ≠ "" ]
    #
    #BEGIN Build and format inventory note
    #
    #Assemble note, order number, timestamp,
    #and location fields.
    If [ $orderInventoryGroupNumber = "" and $unknownLocation = "" or $orderInventoryGroupNumber ≠ testlearn::orderInventoryGroupNumber ]
    If [ $unknownLocation = "" ]
    Set Variable [ $copy; Value://previous records Case ( $copy = "" ; "" ; $copy & ¶ ) & Case ( $orderInventoryGroupNumber ≠ testlearn::orderInventoryGroupNumber and $orderInventoryGroupNumber ≠ "" and testlearn::orderInventoryGroupName ≠ "" ; TextSize ( ¶ ; 6 ) & "____________________" & ¶ & TextSize ( ¶ ; 14 ) & TextSize ( Case ( testlearn::orderInventoryGroupName = "" ; "Unknown Location" ; testlearn::orderInventoryGroupName ) ; 17 ) ; TextSize ( Case ( testlearn::orderInventoryGroupName = "" ; "Unknown Location" ; testlearn::orderInventoryGroupName ) ; 17 ) ) & ¶ & ¶ & //main text TextFont ( testlearn::note ; "Georgia" ) ]
    Else
    Set Variable [ $copy; Value://previous records Case ( $copy = "" ; "" ; $copy & ¶ ) & Case ( $orderInventoryGroupNumber ≠ testlearn::orderInventoryGroupNumber and testlearn::orderInventoryGroupNumber ≠ "" and testlearn::orderInventoryGroupName ≠ "" ; TextSize ( ¶ ; 6 ) & "____________________" & ¶ & TextSize ( ¶ ; 14 ) & TextSize ( Case ( testlearn::orderInventoryGroupName = "" ; "Unknown Location" ; testlearn::orderInventoryGroupName ) ; 17 ) ; TextSize ( Case ( testlearn::orderInventoryGroupName = "" ; "Unknown Location" ; testlearn::orderInventoryGroupName ) ; 17 ) ) & ¶ & ¶ & //main text TextFont ( testlearn::note ; "Georgia" ) ]
    End If
    Set Variable [ $unknownLocation; Value:Case ( testlearn::orderInventoryGroupName = "" ; 1 ; "" ) ]
    Set Variable [ $orderInventoryGroupNumber; Value:testlearn::orderInventoryGroupNumber ]
    Else
    Set Variable [ $copy; Value://previous records Case ( $copy = "" ; "" ; $copy & ¶ ) & //grey text TextColor ( "____________________" ; RGB ( 200 ; 200 ; 200 ) ) & ¶ & ¶ & //main text TextFont ( testlearn::note ; "Georgia" ) ]
    End If
    #
    #END Inventory note
    #
    End If
    #
    #BEGIN Increase note number
    #
    #Get note's number before it is updated for
    #the next note. This number will be used
    #to identify references used by this note in the
    #end section.
    #
    Set Variable [ $noteNumberForItsReferences; Value://number TextSize ( Case ( testlearn::brainstormCasePoint = "" ; $point & "." & $evidence ; $point & ".1" ) ; 11 ) ]
    #
    #Increase note number for next note.
    If [ testlearn::brainstormCasePoint = "" ]
    Set Variable [ $evidence; Value:$evidence + 1 ]
    Else
    Set Variable [ $evidence; Value:2 ]
    End If
    #
    #END Increase note number
    #
    #END LOOP SECTION Build and format notes
    #
    #
    #
    #BEGIN LOOP SECTION Build reference
    #sections for each note
    #
    #Print references if a learn record has any.
    If [ ValueCount ( testlearn::kcreference ) - ( Length ( Filter ( testlearn::kcreference ; "L" ) ) ) > 0 and TEMP::InventoryLibraryYN = "" ]
    #
    #Print title "Reference," "References,"
    #or "Location."
    If [ TEMP::InventoryLibraryYN = "" ]
    If [ $referencesInSectionAtEnd = "" ]
    Set Variable [ $copy; Value:$copy & TextSize ( ¶ ; 6 ) & //grey text TextSize ( TextColor ( //references Case ( ValueCount ( testlearn::kcreference ) - ( Length ( Filter ( testlearn::kcreference ; "L" ) ) ) = 1 ; "Reference" ; "References" ) //finish text color ; RGB ( 119 ; 119 ; 119 ) ) ; 11 ) ]
    End If
    Else
    Set Variable [ $copy; Value:$copy & ¶ & Case ( testlearn::kcreference ≠ "" ; ¶ & Case ( refTestLearn::concatenateSTUFF = "" ; TextColor ( "Location" ; RGB ( 119 ; 119 ; 119 ) ) ; TextColor ( "Location = " ; RGB ( 119 ; 119 ; 119 ) ) & refTestLearn::concatenateSTUFFcontainer // & TextColor ( ", located here:" ; RGB ( 119 ; 119 ; 119 ) ) ) ; "" ) ]
    End If
    #
    #Now get the references. The portal variable
    #needs to be reset for each learn record.
    Set Variable [ $portal; Value:1 ]
    #
    #Select portal showing either a scholarly
    #reference or inventory items location.
    If [ TEMP::InventoryLibraryYN = "" ]
    Go to Object [ Object Name: "ref1" ]
    Else
    If [ refTestLearn::concatenateSTUFF = "" ]
    Go to Object [ Object Name: "stuff location" ]
    Else
    Go to Object [ Object Name: "container location" ]
    End If
    End If
    #
    #Now collect each reference's information.
    Loop
    #If this is the first reference clear the
    #$portal variable and select portal's
    #first record.
    If [ $portal = 1 ]
    Go to Portal Row [ Select; First ]
    End If
    #
    #Print references with the learn record if
    #the user has not selected to print all the
    #references at the end of this share (after
    #all the notes have been printed).
    If [ TEMP::InventoryLibraryYN = "" ]
    If [ $referencesInSectionAtEnd = "" ]
    Set Variable [ $copy; Value:Case ( Right ( $copy ; 9 ) = "Reference" or Right ( $copy ; 10 ) = "References"; $copy & ¶ & //grey text TextSize ( TextColor ( refLearn::referenceForLearnShare ; RGB ( 119 ; 119 ; 119 ) ) ; 11 ) ; $copy & ¶ & TextSize ( ¶ ; 6 ) & //grey text TextSize ( TextColor ( refLearn::referenceForLearnShare ; RGB ( 119 ; 119 ; 119 ) ) ; 11 ) ) ]
    #
    Else
    #
    #If the user has elected to share the references
    #at the end of the share, copy each one and
    #store it in a temporary record.
    Set Variable [ $shareReferenceID; Value:refLearn::_Lreference ]
    Set Variable [ $shareReference; Value:refLearn::referenceForLearnShare ]
    #
    Go to Object [ Object Name: "shareID" ]
    If [ TEMPforShare::shareReferenceID ≠ "firstRecord" ]
    Go to Portal Row [ Select; Last ]
    End If
    #
    Set Field [ TEMPforShare::shareReferenceID; $shareReferenceID ]
    Set Field [ TEMPforShare::shareReference; $shareReference ]
    Set Field [ TEMPforShare::shareReferenceNoteNumber; $noteNumberForItsReferences ]
    End If
    #
    #
    Else
    #If this a location, not a reference, then do print
    #it with it's learn record = inventory item.
    Set Variable [ $copy; Value:Case ( refTestLearn::concatenateSTUFF = "" ; $copy & ¶ & refLearn::referenceSTUFF ; $copy & ¶ & refContainerLocation::referenceSTUFF4learnOtherContainer ) ]
    End If
    #
    #Select the record's next reference.
    #
    #Select portal showing either a scholarly
    #reference or inventory items location.
    If [ TEMP::InventoryLibraryYN = "" ]
    Go to Object [ Object Name: "ref1" ]
    Else
    If [ refTestLearn::concatenateSTUFF = "" ]
    Go to Object [ Object Name: "stuff location" ]
    Else
    Go to Object [ Object Name: "container location" ]
    End If
    End If
    #
    Go to Portal Row [ $portal ] [ No dialog ]
    Go to Portal Row [ Next ]
    Exit Loop If [ Get (LastError) = 101 ]
    Set Variable [ $portal; Value:$portal + 1 ]
    End Loop
    #
    End If
    #
    #Go to the next learn record tagged with this
    #brainstorm or inventory list tag OR exit loop
    #if this is the end of the list.
    Go to Record/Request/Page [ Next; Exit after last ]
    Set Variable [ $copy; Value:$copy & Case ( $recordReferenceCount > 0 and $referencesInSectionAtEnd = "" ; ¶ ; "" ) ]
    #
    #Increase point number if point is different.
    If [ testlearn::brainstormCasePoint ≠ "" ]
    Set Variable [ $point; Value:$point + 1 ]
    End If
    #
    #
    #END LOOP SECTION Build reference
    #sections for each note
    #
    End Loop
    #
    #
    #END Build note and reference sections
    #
    #
    #
    #
    #
    #BEGIN Build reference end section
    #
    #If the user has elected to share the references
    #at the end of the share, go to the temporary
    #window and identify any duplicate references,
    #and collect and add the note numbers of the
    #previous record to the duplicate record. This
    #addition will result in the final duplicate record
    #containing the numbers of all previous
    #duplicates, so each reference will identify all
    #the notes referencing it.
    If [ $referencesInSectionAtEnd ≠ "" ]
    #Exit field in Share window, otherwise the
    #field's record will remain in use in this
    #window and cause problems for actions
    #in the Sbare window.
    Go to Field [ ]
    Select Window [ Name: "Sbare"; Current file ]
    Show All Records
    #NOTE: This go to field step is important.
    #It keesp the script from failing when
    #the sort is performed.
    Go to Field [ ]
    Sort Records [ Specified Sort Order: TEMP::shareReferenceID; ascending TEMP::shareReferenceNoteNumber; ascending ] [ Restore; No dialog ]
    Go to Record/Request/Page [ First ]
    Set Variable [ $referenceID; Value:TEMP::shareReferenceID ]
    Set Variable [ $noteNumber; Value:TEMP::shareReferenceNoteNumber ]
    Loop
    Go to Record/Request/Page [ Next; Exit after last ]
    If [ $referenceID = TEMP::shareReferenceID ]
    Set Variable [ $noteNumber; Value:$noteNumber & ", " & TEMP::shareReferenceNoteNumber ]
    Set Field [ TEMP::shareReferenceID; "duplicate" ]
    Set Field [ TEMP::shareReferenceNoteNumber; $noteNumber ]
    Else
    Set Variable [ $referenceID; Value:TEMP::shareReferenceID ]
    Set Variable [ $noteNumber; Value:TEMP::shareReferenceNoteNumber ]
    Set Field [ TEMP::shareReferenceNoteNumber; $noteNumber ]
    End If
    End Loop
    #
    #Sort the references so the duplicates with all
    #the reference note numbers are first. Now
    #starting from the top, loop each record and
    #select the first reference record for each
    #possible duplicated reference record. Create
    #a reference with the note numbers on a line
    #above them in greyed text.
    Go to Field [ ]
    Sort Records [ Specified Sort Order: TEMP::shareReference; ascending TEMP::shareReferenceID; descending TEMP::shareReferenceNoteNumber; descending ] [ Restore; No dialog ]
    Go to Record/Request/Page [ First ]
    Set Variable [ $reference; Value:TEMP::shareReference ]
    Set Variable [ $referenceSection; Value: TextSize ( Case ( Get ( FoundCount ) = 1 ; "Reference —————" ; "References —————" ) & ¶ ; 12 ) & Case ( $essayFormat = "" ; TextSize ( ¶ ; 4 ) ; TextSize ( ¶ ; 6 ) ) & Case ( $essayFormat = "" ; TextColor ( TextSize ( TEMP::shareReferenceNoteNumber & ¶ ; 11 ) ; RGB ( 139 ; 139 ; 139 ) ) ; "" ) & TextSize ( TEMP::shareReference ; 12 ) ]
    Loop
    Go to Record/Request/Page [ Next; Exit after last ]
    If [ TEMP::shareReference ≠ $reference ]
    Set Variable [ $referenceSection; Value:$referenceSection & ¶ & Case ( $essayFormat = "" ; TextSize ( ¶ ; 8 ) & TextColor ( TextSize ( TEMP::shareReferenceNoteNumber & ¶ ; 11 ) ; RGB ( 130 ; 130 ; 130 ) ) ; TextSize ( ¶ ; 8 ) ) & //text size TextSize ( TEMP::shareReference ; 12 ) ]
    End If
    Set Variable [ $reference; Value:TEMP::shareReference ]
    End Loop
    #
    #Once the end reference section has been
    #created erase the temporary records, and
    #then create 1 temporary record to display
    #information that is in these fields, like
    #the fields on the alldefaults layout.
    Select Window [ Name: "Sbare"; Current file ]
    Delete All Records [ No dialog ]
    New Record/Request
    Close Window [ Name: "Sbare"; Current file ]
    Select Window [ Name: "Share"; Current file ]
    End If
    #
    #END Build reference end section
    #
    #
    #
    #
    #
    #BEGIN Build title header for share document
    #
    #Get primary node's copyright for this share as
    #it is the primary node that is sharing these records.
    Go to Layout [ “TEMP” (TEMP) ]
    Set Variable [ $copyright; Value:defaultCopyrightName::tag ]
    #
    #
    #
    #
    #Brainstorm or Inventory Header
    If [ $$citationMatch = "brainstorm" ]
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    #
    If [ TEMP::InventoryLibraryYN = "" ]
    #Brainstorm header
    #
    #If tag and default copyright are different,
    #note this so user can be informed.
    If [ $copyright ≠ tagsCopyright::tag ]
    Set Variable [ $informUserCopyrightNotEqualToDefault; Value:$copyright ]
    End If
    #
    #Get tag's copyright in idea mode.
    Set Variable [ $copyright; Value:tagsCopyright::tag ]
    Set Variable [ $brainstorm; Value://Title TEMP::userLibraryName & ": Brainstorm — " & //TextStyleAdd ( tagMenus::tag ; Titlecase ) tagMenus::tag & ¶ & //author and copyright date TEMP::DEFAULTNodePrimaryName & " (" & Month ( Get ( CurrentDate ) ) & "/" & Day ( Get ( CurrentDate ) ) & "/" & Year ( Get ( CurrentDate ) ) & "). Copyright " & $copyright & "." ]
    #
    Else
    #Inventory header
    #
    Set Variable [ $brainstorm; Value://Title TEMP::userLibraryName & ": Inventory List — " & //TextStyleAdd ( tagMenus::tag ; Titlecase ) tagMenus::tag & ¶ & //author and copyright date TEMP::DEFAULTNodePrimaryName & " (" & Month ( Get ( CurrentDate ) ) & "/" & Day ( Get ( CurrentDate ) ) & "/" & Year ( Get ( CurrentDate ) ) & "). Copyright " & $copyright & "." ]
    End If
    #
    #
    #
    #
    #Test Header
    Else If [ $$citationMatch = "test" ]
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    If [ TEMP::InventoryLibraryYN = "" ]
    Set Variable [ $brainstorm; Value://Title TEMP::userLibraryName & ": Test Subsection — " & //TextStyleAdd ( testSubsectionTemplate::name ; Titlecase ) testSubsectionTemplate::name & ¶ & //author and copyright date TEMP::DEFAULTNodePrimaryName & " (" & Month ( Get ( CurrentDate ) ) & "/" & Day ( Get ( CurrentDate ) ) & "/" & Year ( Get ( CurrentDate ) ) & "). Copyright " & $copyright & "." ]
    Else
    Set Variable [ $brainstorm; Value://Title TEMP::userLibraryName & ": Test Subsection — " & //TextStyleAdd ( testSubsectionTemplate::name ; Titlecase ) testSubsectionTemplate::name & ¶ & //author and copyright date TEMP::DEFAULTNodePrimaryName & " (" & Month ( Get ( CurrentDate ) ) & "/" & Day ( Get ( CurrentDate ) ) & "/" & Year ( Get ( CurrentDate ) ) & "). Copyright " & $copyright & "." ]
    End If
    #
    #
    #
    #
    #General idea and inventory share header
    Else If [ $$citationMatch ≠ "brainstorm" and $$citationMatch ≠ "test" ]
    #
    #
    #General idea header
    If [ TEMP::InventoryLibraryYN = "" ]
    #
    If [ $show = "all" ]
    #Share all records
    Set Variable [ $brainstorm; Value://Title TextStyleAdd ( TEMP::userLibraryName & " Library Notes" ; "bold" ) & ¶ & //author and copyright date TEMP::DEFAULTNodePrimaryName & " (" & Month ( Get ( CurrentDate ) ) & "/" & Day ( Get ( CurrentDate ) ) & "/" & Year ( Get ( CurrentDate ) ) & "). Copyright " & $copyright & "." & Case ( $chronologicalSortOrder = "" ; ¶ & TextStyleAdd ( "Shown in reverse chronological order." ; Italic ) ; "" ) & TextSize ( ¶ ; 6 ) & "_______________" & ¶ & TextSize ( ¶ ; 10 ) & "NOTE: This is an unsaved list of " & $numberOfRecordsBeingViewed & " records. Use the Tag Menus' 'brainstorm' option to create custom-ordered, saved, collections of thoughts, ideas, etc." & TextSize ( ¶ ; 6 ) & "_______________" ]
    #
    Else
    #Share only linked records
    Set Variable [ $brainstorm; Value://Title TEMP::userLibraryName & " Library Notes" & ¶ & //author and copyright date TEMP::DEFAULTNodePrimaryName & " (" & Month ( Get ( CurrentDate ) ) & "/" & Day ( Get ( CurrentDate ) ) & "/" & Year ( Get ( CurrentDate ) ) & "). Copyright " & $copyright & "." & Case ( $chronologicalSortOrder = "" ; TextStyleAdd ( ¶ & "Shown in reverse chronological order." ; Italic ) ; "" ) ]
    End If
    End If
    #
    #
    #General inventory header
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    #
    If [ $show = "all" ]
    #Share all records
    Set Variable [ $brainstorm; Value://Title TEMP::userLibraryName & ¶ & //author and copyright date TEMP::DEFAULTNodePrimaryName & " (" & Month ( Get ( CurrentDate ) ) & "/" & Day ( Get ( CurrentDate ) ) & "/" & Year ( Get ( CurrentDate ) ) & "). Copyright " & $copyright & "." & TextSize ( ¶ ; 6 ) & "_______________" & ¶ & TextSize ( ¶ ; 10 ) & "NOTE: This is an unsaved list of " & $numberOfRecordsBeingViewed & " records. Use the Tag Menus' 'inventory list' option to create custom-ordered, saved, lists." & TextSize ( ¶ ; 6 ) & "_______________" ]
    #
    Else
    #Share only linked records
    Set Variable [ $brainstorm; Value://Title TEMP::userLibraryName & ¶ & //author and copyright date TEMP::DEFAULTNodePrimaryName & " (" & Month ( Get ( CurrentDate ) ) & "/" & Day ( Get ( CurrentDate ) ) & "/" & Year ( Get ( CurrentDate ) ) & "). Copyright " & $copyright & "." ]
    End If
    End If
    End If
    Go to Field [ ]
    #
    #END Build title header for share document
    #
    #
    #
    #
    #
    #PART 5 >> Display share document —————
    #
    #
    #
    #
    #
    #BEGIN Assemble and display share document
    #
    #Compose the share document.
    Set Variable [ $copy; Value://Brainstorm Title and Records and References $brainstorm & ¶ & ¶ & $copy & ¶ & ¶ & $referenceSection ]
    #
    #Select Learn window so when the Share
    #window is closed it will be selected. Then
    #select the Share window to continue
    #this script.
    Select Window [ Name: "Learn"; Current file ]
    Select Window [ Name: "Share"; Current file ]
    Go to Layout [ “learnPreviewLayoutView” (testlearn) ]
    #
    Set Variable [ $$stopLoadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    #
    #Paste the document into the share layout.
    Set Field [ TEMP::paste; $copy ]
    Go to Field [ ]
    #
    #All records showing are identical,
    #so remove all but one of them.
    Go to Record/Request/Page [ First ]
    Omit Multiple Records [ Get (FoundCount) - 1 ] [ No dialog ]
    #
    #Display list.
    Scroll Window [ Home ]
    Move/Resize Window [ Current Window; Top: 0; Left: 0 ]
    Adjust Window [ Resize to Fit ]
    #
    #END Assemble and display share document
    #
    #
    #
    #
    #
    #PART 6 >> Report any issues ————————
    #
    #
    #
    #
    #
    #Inform user if one or more record's was
    #created by another library node, IF the
    #the user elected to not show timestamp
    #and keywords.
    If [ $nodeOtherThanPrimaryAuthor ≠ "" ]
    Show Custom Dialog [ Message: "FYI: This share contains at least one contribution by another author (node). They have been given credit with their name and copyright under a line, under their contribution."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #Inform user if brainstorm tag's copyright
    #is different from user's default copyright.
    If [ $informUserCopyrightNotEqualToDefault ≠ "" ]
    Show Custom Dialog [ Message: "FYI: This brainstorm's copyright — " & $copyright & " — is NOT the same as your default copyright = " & $informUserCopyrightNotEqualToDefault & "."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    Exit Script [ ]
    #
    #
    #END: SHARE DOCUMENT CREATION
    #
    #

Fields used in this script

    testlearn::kcbrainstorm
    testlearn::kctestSubsectionInfo
    TEMP::InventoryLibraryYN
    testlearn::orderTestInformation
    testlearn::timestamp
    testlearn::orderInventoryGroupNumber
    testlearn::note
    tagMenus::tag
    testlearn::kcreference
    testlearn::_Ltestlearn
    refTestLearn::_Ltestlearn
    testlearn::date
    TEMP::shareReferenceID
    testlearn::brainstormCasePoint
    tagTLNodePrimary::_Ltag
    TEMP::kdefaultNodePrimary
    tagTLNodePrimary::tag
    testlearn::NodeOthers
    learnCreatorsCopyright::tag
    testlearn::OtherKeyWords
    testlearn::kKeywordPrimary
    testlearn::kcKeywordOther
    tagTLKeywordPrimary::tag
    testlearn::orderInventoryGroupName
    refTestLearn::concatenateSTUFF
    refTestLearn::concatenateSTUFFcontainer
    refLearn::referenceForLearnShare
    refLearn::_Lreference
    TEMPforShare::shareReferenceID
    TEMPforShare::shareReference
    TEMPforShare::shareReferenceNoteNumber
    refLearn::referenceSTUFF
    refContainerLocation::referenceSTUFF4learnOtherContainer
    TEMP::shareReferenceNoteNumber
    TEMP::shareReference
    defaultCopyrightName::tag
    tagsCopyright::tag
    TEMP::userLibraryName
    TEMP::DEFAULTNodePrimaryName
    testSubsectionTemplate::name
    TEMP::paste

Scripts used in this script

Layouts used in this script

    learnPreviewLayout
    shareReferencesLast
    TEMP
    learnPreviewLayoutView

Tables used in this script

    TEMP
    reference
    reference
    tag
    tag
    testSubsectionTemplate
    testlearn

Table occurrences used by this script

    TEMP
    TEMPforShare
    defaultCopyrightName
    learnCreatorsCopyright
    refContainerLocation
    refLearn
    refTestLearn
    tagMenus
    tagTLKeywordPrimary
    tagTLNodePrimary
    tagsCopyright
    testSubsectionTemplate
    testlearn

Custom Functions used by this script

Custom menu set used by this script

    HGT Stop Share


Previous Script: [shareLearnRecords]	Parent Folder: [learn]	Next Script: [showReferencedFileFolder]
Script Name	shareWindowCopyTextButton
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    learnPreviewLayoutView

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #This script just copies whatever is in the Share
    #window to the computer's clipboard, so that it
    #can be pasted into another applicaiton: email,
    #document, etc.
    Copy [ TEMP::paste ] [ Select ]
    Go to Field [ ]
    Scroll Window [ Home ]
    #
    #

Fields used in this script

    TEMP::paste

Scripts used in this script

Layouts used in this script

Tables used in this script

    TEMP

Table occurrences used by this script

    TEMP

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [shareWindowCopyTextButton]	Parent Folder: [learn]
Script Name	showReferencedFileFolder
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    Reference
    ReferenceEDIT
    ReferenceFilePathEDIT
    ReferenceMenu3Cite
    ReferenceMenu3CiteNoPicture
    ReferencePictureWindow_HDD
    ReferenceAddToTag
    ReferenceAddToCopyright
    learn0
    learn1
    learn2
    learn3
    learn4
    learn5
    learn4EDIT
    learn4EDITLocked
    LearnTextWindow
    LearnTextWindow_iDevice
    LearnTextWindowLocked
    LearnTextWindowLocked_iDevice
    learnMenu3Cite
    learnMenu3CiteS
    learnMenu3CitePickAReference
    LearnRefExternalPictureWindow
    LearnRefExternalPictureWindowEDIT
    testInfo
    TestInfoReference
    testInfoText
    testInfoTextLocked
    reportTagInfo

Scripts that use this script

    openReferenceWebsite
    showTagLink1
    showTagLink2
    showTagLink3

Script Definition
Script Steps

    #
    #
    #FILE BUTTON (or on copyright menu WEB BUTTON)
    #See if there is a file or folder to show the user.
    If [ $$openReferencedWebsite = "" ]
    If [ ( Get (LayoutTableName) = "reference" and ( //All fields required to find file in the main or x folders. reference::fileName ≠ "" and reference::kfileLocation ≠ "" and FilterValues ( reference::kfileLocation ; "8162011225605315" ) ≠ "8162011225605315" & ¶ or //All fields required to a find file in a file path tag 'other' folder. reference::fileName ≠ "" and reference::kfileLocation ≠ "" and reference::kfolderpath ≠ "" ) ) = 0 and ( Get (LayoutTableName) = "tagMenus" and ( //All fields required to find file in the main or x folders. $$tagMenusFileName ≠ "" and $$tagMenusFileLocation ≠ "" and FilterValues ( $$tagMenusFileLocation ; "8162011225605315" ) ≠ "8162011225605315" & ¶ or //All fields required to a find file in a file path tag 'other' folder. $$tagMenusFileName ≠ "" and $$tagMenusFileLocation ≠ "" and $$tagMenusFilePath ≠ "" or //URL field is empty. $$tagMenusURL ≠ "" ) ) = 0 and ( Get (LayoutTableName) = "testlearn" and ( //Check if first reference record has media to show and that the user has not decided to show reference media. Case ( testlearn::kshowReferencedMedia = "" ; //All fields required to find file in the main or x folders. refLearn::fileName ≠ "" and refLearn::kfileLocation ≠ "" and FilterValues ( refLearn::kfileLocation ; "8162011225605315" ) ≠ "8162011225605315" & ¶ or //All fields required to find a file in a file path tag 'other' folder. refLearn::fileName ≠ "" and refLearn::kfileLocation ≠ "" and refLearn::kfolderpath ≠ "" ) or //Check if the user has decided to show reference media. Case ( testlearn::kshowReferencedMedia ≠ "" ; //All fields required to find file in the main or x folders. refLearnShowMedia::fileName ≠ "" and refLearnShowMedia::kfileLocation ≠ "" and FilterValues ( refLearnShowMedia::kfileLocation ; "8162011225605315" ) ≠ "8162011225605315" & ¶ or //All fields required to find a file in a file path tag 'other' folder. refLearnShowMedia::fileName ≠ "" and refLearnShowMedia::kfileLocation ≠ "" and refLearnShowMedia::kfolderpath ≠ "" ) ) ) = 0 and ( Get (LayoutTableName) = "testlearnReportTags" and ( //Check if first reference record has media to show and that the user has not decided to show reference media. Case ( testlearnReportTags::kshowReferencedMedia = "" ; //All fields required to find file in the main or x folders. refTest::fileName ≠ "" and refTest::kfileLocation ≠ "" and FilterValues ( refTest::kfileLocation ; "8162011225605315" ) ≠ "8162011225605315" & ¶ or //All fields required to find a file in a file path tag 'other' folder. refTest::fileName ≠ "" and refTest::kfileLocation ≠ "" and refTest::kfolderpath ≠ "" ) or //Check if the user has decided to show reference media. Case ( testlearnReportTags::kshowReferencedMedia ≠ "" ; //All fields required to find file in the main or x folders. refTestShowMedia::fileName ≠ "" and refTestShowMedia::kfileLocation ≠ "" and FilterValues ( refTestShowMedia::kfileLocation ; "8162011225605315" ) ≠ "8162011225605315" & ¶ or //All fields required to find a file in a file path tag 'other' folder. refTestShowMedia::fileName ≠ "" and refTestShowMedia::kfileLocation ≠ "" and refTestShowMedia::kfolderpath ≠ "" ) ) ) = 0 ]
    #
    #Stop script if the record has no file to open or
    #it does, but the user has not yet entered all the
    #information required to open this file.
    Exit Script [ ]
    End If
    End If
    #
    #
    #WEB BUTTON
    #See if there is a website to show the user.
    If [ $$openReferencedWebsite = 1 ]
    #
    #A return of zero for all calc's means the
    #current learn record has zero references
    #with its website/URL field filled in.
    If [ //Test to see if any reference on all layouts where they can appear has a website that can be opened. ( reference::URL ≠ "" or reference::ISBN ≠ "" or reference::ISSN ≠ "" or reference::DOI ≠ "" or //DO NOT TEST TagMenus (there is only one button for website, file, and folder) Case ( testlearn::kshowReferencedMedia = "" ; refLearn::URL ≠ "" or refLearn::ISBN ≠ "" or refLearn::ISSN ≠ "" or refLearn::DOI ≠ "" ; refLearnShowMedia::URL ≠ "" or refLearnShowMedia::ISBN ≠ "" or refLearnShowMedia::ISSN ≠ "" or refLearnShowMedia::DOI ≠ "" ) or Case ( testlearnReportTags::kshowReferencedMedia = "" ; refTest::URL ≠ "" or refTest::ISBN ≠ "" or refTest::ISSN ≠ "" or refTest::DOI ≠ "" ; refTestShowMedia::URL ≠ "" or refTestShowMedia::ISBN ≠ "" or refTestShowMedia::ISSN ≠ "" or refTestShowMedia::DOI ≠ "" ) ) = 0 ]
    #
    #Stop the script if there is website url to open.
    Set Variable [ $$openReferencedWebsite ]
    Exit Script [ ]
    End If
    #
    #If there is a website to open, then note this for
    #calcs below so the website opening calc will
    #be used.
    Set Variable [ $openReferencedWebsite; Value:1 ]
    Set Variable [ $$openReferencedWebsite ]
    End If
    #
    #
    #FILE BUTTON
    #If the user clicked a file button
    #the present them with
    #file and folder buttons.
    If [ $openReferencedWebsite = "" ]
    #
    #If the file path tag's "real shelf, box, etc."
    #checkbox in the Reference's Tag Menu's
    #window is empty, then ask if the user wants to
    #open the digital-file's folder or open the file.
    If [ tagRefFolderPath::kfileORkTestItemCreatorNode = "" and tagRefLearnFolderPath::kfileORkTestItemCreatorNode = "" and refTestFolderPath::kfileORkTestItemCreatorNode = "" and $$tagMenusRealCheckbox = "" ]
    #
    Show Custom Dialog [ Message: "Open the file's folder" & ¶ & "OR" & ¶ & "the file?"; Default Button: “file”, Commit: “Yes”; Button 2: “folder”, Commit: “No”; Button 3: “cancel”, Commit: “No” ]
    If [ Get ( LastMessageChoice ) = 3 ]
    Exit Script [ ]
    End If
    #
    Else
    #If "real shelf, box, etc." is checked, then show
    #the comment below to guide user to the
    #object's (not digital file's) physical location.
    If [ Get (LayoutTableName) = "reference" ]
    Show Custom Dialog [ Message: "Located: " & tagRefFolderPath::tag & " >>> " & Case ( reference::fileName ≠ "" ; reference::fileName ); Default Button: “OK”, Commit: “Yes” ]
    Else If [ Get (LayoutTableName) = "testlearn" ]
    Show Custom Dialog [ Message: "Located: " & tagRefLearnFolderPath::tag & " >>> " & Case ( refLearn::fileName ≠ "" ; refLearn::fileName ); Default Button: “OK”, Commit: “Yes” ]
    Else If [ Get (LayoutTableName) = "tagMenus" ]
    Show Custom Dialog [ Message: "Located: " & $$tagMenusFilePath & " >>> " & Case ( $$tagMenusFileName ≠ "" ; $$tagMenusFileName ); Default Button: “OK”, Commit: “Yes” ]
    Else If [ Get (LayoutTableName) = "testlearnReportTags" ]
    #The picture window that opens on the test and
    #report module layouts is for the testlearn
    #table, so no special message is required.
    End If
    Exit Script [ ]
    End If
    End If
    #
    #
    #If the user selects to open the file's folder
    #instead of the file, then note this for calcs
    #below so the folder opening calc will be used.
    If [ Get ( LastMessageChoice ) = 2 ]
    #
    Set Variable [ $openFolder; Value:1 ]
    #
    #Show file name and folder path before
    #opening it ...
    #
    #... on reference layouts.
    If [ Get (LayoutTableName) = "reference" ]
    Show Custom Dialog [ Message: "The folder that — " & reference::fileName & " — is in will now open >>> " & Replace ( //Get position of first slash = file path info common to both apple and windows computers: Let ( x = Position ( Get ( FilePath ) ; "/" ; 1 ; 1 ) ; //Get position of last slash = end of file path (or start of filename): Let ( y = Position ( Get (FilePath) ; "/" ; 1 ; Length ( Filter ( Get (FilePath) ; "/" ) ) ) ; //Get file path (three possible paths: Main, X, and Other) Case ( FilterValues ( reference::kfileLocation ; "8162011225558314" ) = "8162011225558314" & ¶ ; Middle ( Get ( FilePath ) ; x ; y - x ) ; FilterValues ( reference::kfileLocation ; "8162011225532313" ) = "8162011225532313" & ¶ ; Middle ( Get ( FilePath ) ; x ; y - x ) & "/x" ) ) ) ; 1 ; 1 ; "" ) & Case ( FilterValues ( reference::kfileLocation ; "8162011225605315" ) = "8162011225605315" & ¶ ; tagRefFolderPath::tag ); Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #... on tagMenus layouts.
    If [ Get (LayoutTableName) = "tagMenus" ]
    Show Custom Dialog [ Message: "The folder that — " & $$tagMenusFileName & " — is in will now open >>> " & Replace ( //Get position of first slash = file path info common to both apple and windows computers: Let ( x = Position ( Get ( FilePath ) ; "/" ; 1 ; 1 ) ; //Get position of last slash = end of file path (or start of filename): Let ( y = Position ( Get (FilePath) ; "/" ; 1 ; Length ( Filter ( Get (FilePath) ; "/" ) ) ) ; //Get file path (three possible paths: Main, X, and Other) Case ( FilterValues ( $$tagMenusFileLocation ; "8162011225558314" ) = "8162011225558314" & ¶ ; Middle ( Get ( FilePath ) ; x ; y - x ) ; FilterValues ( $$tagMenusFileLocation ; "8162011225532313" ) = "8162011225532313" & ¶ ; Middle ( Get ( FilePath ) ; x ; y - x ) & "/x" ) ) ) ; 1 ; 1 ; "" ) & Case ( FilterValues ( $$tagMenusFileLocation ; "8162011225605315" ) = "8162011225605315" & ¶ ; $$tagMenusFilePath ); Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #... on learn layouts.
    If [ Get (LayoutTableName) = "testlearn" ]
    If [ testlearn::kshowReferencedMedia ≠ "" ]
    Show Custom Dialog [ Message: "The folder that — " & refLearn::fileName & " — is in will now open >>> " & Replace ( //Get position of first slash = file path info common to both apple and windows computers: Let ( x = Position ( Get ( FilePath ) ; "/" ; 1 ; 1 ) ; //Get position of last slash = end of file path (or start of filename): Let ( y = Position ( Get (FilePath) ; "/" ; 1 ; Length ( Filter ( Get (FilePath) ; "/" ) ) ) ; //Get file path (three possible paths: Main, X, and Other) Case ( FilterValues ( refLearnShowMedia::kfileLocation ; "8162011225558314" ) = "8162011225558314" & ¶ ; Middle ( Get ( FilePath ) ; x ; y - x ) ; FilterValues ( refLearnShowMedia::kfileLocation ; "8162011225532313" ) = "8162011225532313" & ¶ ; Middle ( Get ( FilePath ) ; x ; y - x ) & "/x" ) ) ) ; 1 ; 1 ; "" ) & Case ( FilterValues ( refLearnShowMedia::kfileLocation ; "8162011225605315" ) = "8162011225605315" & ¶ ; tagRefLearnFolderPath::tag ); Default Button: “OK”, Commit: “Yes” ]
    Else If [ testlearn::kshowReferencedMedia = "" ]
    Show Custom Dialog [ Message: "The folder that — " & refLearn::fileName & " — is in will now open >>> " & Replace ( //Get position of first slash = file path info common to both apple and windows computers: Let ( x = Position ( Get ( FilePath ) ; "/" ; 1 ; 1 ) ; //Get position of last slash = end of file path (or start of filename): Let ( y = Position ( Get (FilePath) ; "/" ; 1 ; Length ( Filter ( Get (FilePath) ; "/" ) ) ) ; //Get file path (three possible paths: Main, X, and Other) Case ( FilterValues ( refLearn::kfileLocation ; "8162011225558314" ) = "8162011225558314" & ¶ ; Middle ( Get ( FilePath ) ; x ; y - x ) ; FilterValues ( refLearn::kfileLocation ; "8162011225532313" ) = "8162011225532313" & ¶ ; Middle ( Get ( FilePath ) ; x ; y - x ) & "/x" ) ) ) ; 1 ; 1 ; "" ) & Case ( FilterValues ( refLearn::kfileLocation ; "8162011225605315" ) = "8162011225605315" & ¶ ; tagRefLearnFolderPath::tag ); Default Button: “OK”, Commit: “Yes” ]
    End If
    End If
    #
    #... on test and report layouts.
    If [ Get ( LayoutTableName ) = "testlearnReportTags" ]
    If [ testlearnReportTags::kshowReferencedMedia ≠ "" ]
    Show Custom Dialog [ Message: "The folder that — " & refTestShowMedia::fileName & " — is in will now open >>> " & Replace ( //Get position of first slash = file path info common to both apple and windows computers: Let ( x = Position ( Get ( FilePath ) ; "/" ; 1 ; 1 ) ; //Get position of last slash = end of file path (or start of filename): Let ( y = Position ( Get (FilePath) ; "/" ; 1 ; Length ( Filter ( Get (FilePath) ; "/" ) ) ) ; //Get file path (three possible paths: Main, X, and Other) Case ( FilterValues ( refTestShowMedia::kfileLocation ; "8162011225558314" ) = "8162011225558314" & ¶ ; Middle ( Get ( FilePath ) ; x ; y - x ) ; FilterValues ( refTestShowMedia::kfileLocation ; "8162011225532313" ) = "8162011225532313" & ¶ ; Middle ( Get ( FilePath ) ; x ; y - x ) & "/x" ) ) ) ; 1 ; 1 ; "" ) & Case ( FilterValues ( refTestShowMedia::kfileLocation ; "8162011225605315" ) = "8162011225605315" & ¶ ; refTestFolderPath::tag ); Default Button: “OK”, Commit: “Yes” ]
    Else If [ testlearnReportTags::kshowReferencedMedia = "" ]
    Show Custom Dialog [ Message: "The folder that — " & refTest::fileName & " — is in will now open >>> " & Replace ( //Get position of first slash = file path info common to both apple and windows computers: Let ( x = Position ( Get ( FilePath ) ; "/" ; 1 ; 1 ) ; //Get position of last slash = end of file path (or start of filename): Let ( y = Position ( Get (FilePath) ; "/" ; 1 ; Length ( Filter ( Get (FilePath) ; "/" ) ) ) ; //Get file path (three possible paths: Main, X, and Other) Case ( FilterValues ( refTest::kfileLocation ; "8162011225558314" ) = "8162011225558314" & ¶ ; Middle ( Get ( FilePath ) ; x ; y - x ) ; FilterValues ( refTest::kfileLocation ; "8162011225532313" ) = "8162011225532313" & ¶ ; Middle ( Get ( FilePath ) ; x ; y - x ) & "/x" ) ) ) ; 1 ; 1 ; "" ) & Case ( FilterValues ( refTest::kfileLocation ; "8162011225605315" ) = "8162011225605315" & ¶ ; refTestFolderPath::tag ); Default Button: “OK”, Commit: “Yes” ]
    End If
    End If
    End If
    #
    #
    #
    #Proceed to opening website, file, or folder.
    #
    #
    #
    #BEGIN: REFERENCE LAYOUTS
    If [ Get ( LayoutTableName ) = "reference" ]
    #
    #
    #
    #Open website if user clicked 'web'.
    If [ $openReferencedWebsite = 1 ]
    Open URL [ Case ( reference::URL ≠ "" ; reference::URL ; reference::ISBN ≠ "" ; "http://www.worldcat.org/search?q=bn%3A" & reference::ISBN ; reference::ISSN ≠ "" ; "http://www.worldcat.org/ISSN/" & reference::ISSN ; reference::DOI ≠ "" ; "http://dx.doi.org/" & reference::DOI ) ] [ No dialog ]
    #
    #If the web address fails let user know and
    #allow them to modify url and try again.
    If [ Get (LastError) = 5 ]
    Show Custom Dialog [ Message: "The reference's web address (URL) is not working: " & Case ( reference::URL ≠ "" ; reference::URL ; reference::ISBN ≠ "" ; "http://www.worldcat.org/search?q=bn%3A" & reference::ISBN ; reference::ISSN ≠ "" ; "http://www.worldcat.org/ISSN/" & reference::ISSN ; reference::DOI ≠ "" ; "http://dx.doi.org/" & reference::DOI ) & " Make a temporary change and try again?"; Default Button: “OK”, Commit: “Yes”; Button 2: “cancel”, Commit: “No” ]
    #
    #If user cancels, then exit this script.
    If [ Get ( LastMessageChoice ) = 2 ]
    Exit Script [ ]
    End If
    #
    #If user wants to try again, let them.
    Loop
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    Open URL [ Case ( reference::URL ≠ "" ; reference::URL ; reference::ISBN ≠ "" ; "http://www.worldcat.org/search?q=bn%3A" & reference::ISBN ; reference::ISSN ≠ "" ; "http://www.worldcat.org/ISSN/" & reference::ISSN ; reference::DOI ≠ "" ; "http://dx.doi.org/" & reference::DOI ) ]
    #
    #Exit script if website opens.
    Exit Loop If [ Get ( LastError ) = 0 ]
    #
    #If it fails, ask the user if they want to try again.
    If [ Get (LastError) = 5 ]
    Show Custom Dialog [ Message: "This change to reference's web address (URL) failed: " & Case ( reference::URL ≠ "" ; reference::URL ; reference::ISBN ≠ "" ; "http://www.worldcat.org/search?q=bn%3A" & reference::ISBN ; reference::ISSN ≠ "" ; "http://www.worldcat.org/ISSN/" & reference::ISSN ; reference::DOI ≠ "" ; "http://dx.doi.org/" & reference::DOI ) & " Try again?"; Default Button: “OK”, Commit: “Yes”; Button 2: “cancel”, Commit: “No” ]
    End If
    #
    #Exit script if user cancels. There are two dialog
    #boxes in which the user can cancel: the above
    #comment and the above Open Url dialog box.
    Exit Loop If [ Get ( LastMessageChoice ) = 2 or Get ( LastError ) = 1 ]
    End Loop
    End If
    Exit Script [ ]
    End If
    #
    #
    #
    #Show file in or open ...
    #
    #... folder x.
    If [ FilterValues ( reference::kfileLocation ; "8162011225532313" ) = "8162011225532313" & ¶ ]
    #Use %20 space substitutes.
    Open URL [ Case ( $openFolder = "" ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & "x/" & reference::fileName ; " " ; "%20" ) ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & "x/" ; " " ; "%20" ) ) ] [ No dialog ]
    If [ Get ( LastError ) ≠ 0 ]
    #If that failes, try spaces.
    Open URL [ Case ( $openFolder = "" ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & "x/" & reference::fileName ; " " ; " " ) ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & "x/" ; " " ; " " ) ) ] [ No dialog ]
    End If
    If [ Get (LastError) = 5 ]
    Show Custom Dialog [ Message: Case ( $openFolder = "" ; "The file has been deleted, moved from, or never downloaded/moved into this library's x folder, OR its name is no longer " & reference::fileName & "." ; "The x folder has been moved, deleted, or perhaps never created (something the user must do during setup). The library's x folder needs to be here " & Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & "x/" ); Default Button: “OK”, Commit: “Yes” ]
    End If
    Exit Script [ ]
    #
    #... main library folder.
    Else If [ FilterValues ( reference::kfileLocation ; "8162011225558314" ) = "8162011225558314" & ¶ ]
    #Use %20 space substitutes.
    Open URL [ Case ( $openFolder = "" ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & reference::fileName ; " " ; "%20" ) ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) ; " " ; "%20" ) ) ] [ No dialog ]
    If [ Get ( LastError ) ≠ 0 ]
    #If that failes, try spaces.
    Open URL [ Case ( $openFolder = "" ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & reference::fileName ; " " ; " " ) ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) ; " " ; " " ) ) ] [ No dialog ]
    End If
    If [ Get (LastError) = 5 ]
    Show Custom Dialog [ Message: Case ( $openFolder = "" ; "The file has been deleted, moved from, or never downloaded/moved into this library's main folder, OR its name is no longer " & reference::fileName & "." ; //Since the main folder's file path is the same as the library's it will never fail to open. So a failure message is not needed. ); Default Button: “OK”, Commit: “Yes” ]
    End If
    Exit Script [ ]
    #
    #... other folder defined by a folder path tag.
    Else If [ FilterValues ( reference::kfileLocation ; "8162011225605315" ) = "8162011225605315" & ¶ ]
    #Use %20 space substitutes.
    Open URL [ Case ( $openFolder = "" ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:/" ; "file:///" ) & tagRefFolderPath::tag ; " " ; "%20" ) & //Check if file path tag ends in forward slash. If it does NOT, add one. Case ( Right ( tagRefFolderPath::tag ; 1 ) = "/" ; Substitute ( reference::fileName ; " " ; "%20" ) ; "/" & Substitute ( reference::fileName ; " " ; "%20" ) ) ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:/" ; "file:///" ) & tagRefFolderPath::tag ; " " ; "%20" ) ) ] [ No dialog ]
    If [ Get ( LastError ) ≠ 0 ]
    #If that failes, try spaces.
    Open URL [ Case ( $openFolder = "" ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:/" ; "file:///" ) & tagRefFolderPath::tag ; " " ; " " ) & //Check if file path tag ends in forward slash. If it does NOT, add one. Case ( Right ( tagRefFolderPath::tag ; 1 ) = "/" ; Substitute ( reference::fileName ; " " ; " " ) ; "/" & Substitute ( reference::fileName ; " " ; " " ) ) ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:/" ; "file:///" ) & tagRefFolderPath::tag ; " " ; " " ) ) ] [ No dialog ]
    End If
    If [ Get (LastError) = 5 ]
    Show Custom Dialog [ Message: Case ( $openFolder = "" ; "The file has been deleted or moved from " & Quote ( tagRefFolderPath::tag ) & ", OR this path tag is invalid, OR the file name is no longer " & reference::fileName & "." ; Case ( Get ( WindowName ) = "Tag Menus" and $$citationMatch ≠ "cite" ; "This folder-path tag" & Quote ( tagRefFolderPath::tag ) & " is a not working. 1) Go to the Reference section 2) Tag Menu 3) path menu to fix it." ; "This folder-path tag" & Quote ( tagRefFolderPath::tag ) & " is a not working. 1) Go to the Tag Menu 2) path menu to fix it." ) ); Default Button: “OK”, Commit: “Yes” ]
    End If
    End If
    #
    #
    #
    End If
    #END: REFERENCE LAYOUTS
    #
    #
    #
    #
    #
    #
    #BEGIN: TAGMENUS LAYOUTS
    If [ Get ( LayoutTableName ) = "tagMenus" ]
    #
    #
    #
    #Open website if user clicked 'web'.
    If [ $openReferencedWebsite = 1 ]
    Open URL [ Case ( $$tagMenusURL ≠ "" ; $$tagMenusURL ; $$tagMenusISBN ≠ "" ; "http://www.worldcat.org/search?q=bn%3A" & $$tagMenusISBN ; $$tagMenusISSN ≠ "" ; "http://www.worldcat.org/ISSN/" & $$tagMenusISSN ; $$tagMenusDOI ≠ "" ; "http://dx.doi.org/" & $$tagMenusDOI ) ] [ No dialog ]
    #
    #If the web address fails let user know and
    #allow them to modify url and try again.
    If [ Get (LastError) = 5 ]
    Show Custom Dialog [ Message: "The reference's web address (URL) is not working: " & Case ( $$tagMenusURL ≠ "" ; $$tagMenusURL ; $$tagMenusISBN ≠ "" ; "http://www.worldcat.org/search?q=bn%3A" & $$tagMenusISBN ; $$tagMenusISSN ≠ "" ; "http://www.worldcat.org/ISSN/" & $$tagMenusISSN ; $$tagMenusDOI ≠ "" ; "http://dx.doi.org/" & $$tagMenusDOI ) & " Make a temporary change and try again?"; Default Button: “OK”, Commit: “Yes”; Button 2: “cancel”, Commit: “No” ]
    #
    #If user cancels, then exit this script.
    If [ Get ( LastMessageChoice ) = 2 ]
    Exit Script [ ]
    End If
    #
    #If user wants to try again, let them.
    Loop
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    Open URL [ Case ( $$tagMenusURL ≠ "" ; $$tagMenusURL ; $$tagMenusISBN ≠ "" ; "http://www.worldcat.org/search?q=bn%3A" & $$tagMenusISBN ; $$tagMenusISSN ≠ "" ; "http://www.worldcat.org/ISSN/" & $$tagMenusISSN ; $$tagMenusDOI ≠ "" ; "http://dx.doi.org/" & $$tagMenusDOI ) ]
    #
    #Exit script if website opens.
    Exit Loop If [ Get ( LastError ) = 0 ]
    #
    #If it fails, ask the user if they want to try again.
    If [ Get (LastError) = 5 ]
    Show Custom Dialog [ Message: "This change to reference's web address (URL) failed: " & Case ( $$tagMenusURL ≠ "" ; $$tagMenusURL ; $$tagMenusISBN ≠ "" ; "http://www.worldcat.org/search?q=bn%3A" & $$tagMenusISBN ; $$tagMenusISSN ≠ "" ; "http://www.worldcat.org/ISSN/" & $$tagMenusISSN ; $$tagMenusDOI ≠ "" ; "http://dx.doi.org/" & $$tagMenusDOI ) & " Try again?"; Default Button: “OK”, Commit: “Yes”; Button 2: “cancel”, Commit: “No” ]
    End If
    #
    #Exit script if user cancels. There are two dialog
    #boxes in which the user can cancel: the above
    #comment and the above Open Url dialog box.
    Exit Loop If [ Get ( LastMessageChoice ) = 2 or Get ( LastError ) = 1 ]
    End Loop
    End If
    Exit Script [ ]
    End If
    #
    #
    #
    #Show file in or open ...
    #
    #... folder x.
    If [ FilterValues ( $$tagMenusFileLocation ; "8162011225532313" ) = "8162011225532313" & ¶ ]
    #Use %20 space substitutes.
    Open URL [ Case ( $openFolder = "" ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & "x/" & $$tagMenusFileName ; " " ; "%20" ) ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & "x/" ; " " ; "%20" ) ) ] [ No dialog ]
    If [ Get ( LastError ) ≠ 0 ]
    #If that failes, try spaces.
    Open URL [ Case ( $openFolder = "" ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & "x/" & $$tagMenusFileName ; " " ; " " ) ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & "x/" ; " " ; " " ) ) ] [ No dialog ]
    End If
    If [ Get (LastError) = 5 ]
    Show Custom Dialog [ Message: Case ( $openFolder = "" ; "The file has been deleted, moved from, or never downloaded/moved into this library's x folder, OR its name is no longer " & $$tagMenusFileName & "." ; "The x folder has been moved, deleted, or perhaps never created (something the user must do during setup). The library's x folder needs to be here " & Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & "x/" ); Default Button: “OK”, Commit: “Yes” ]
    End If
    Exit Script [ ]
    #
    #... main library folder.
    Else If [ FilterValues ( $$tagMenusFileLocation ; "8162011225558314" ) = "8162011225558314" & ¶ ]
    #Use %20 space substitutes.
    Open URL [ Case ( $openFolder = "" ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & $$tagMenusFileName ; " " ; "%20" ) ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) ; " " ; "%20" ) ) ] [ No dialog ]
    If [ Get ( LastError ) ≠ 0 ]
    #If that failes, try spaces.
    Open URL [ Case ( $openFolder = "" ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & $$tagMenusFileName ; " " ; " " ) ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) ; " " ; " " ) ) ] [ No dialog ]
    End If
    If [ Get (LastError) = 5 ]
    Show Custom Dialog [ Message: Case ( $openFolder = "" ; "The file has been deleted, moved from, or never downloaded/moved into this library's main folder, OR its name is no longer " & $$tagMenusFileName & "." ; //Since the main folder's file path is the same as the library's it will never fail to open. So a failure message is not needed. ); Default Button: “OK”, Commit: “Yes” ]
    End If
    Exit Script [ ]
    #
    #... other folder defined by a folder path tag.
    Else If [ FilterValues ( $$tagMenusFileLocation ; "8162011225605315" ) = "8162011225605315" & ¶ ]
    #Use %20 space substitutes.
    Open URL [ Case ( $openFolder = "" ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:/" ; "file:///" ) & $$tagMenusFilePath ; " " ; "%20" ) & //Check if file path tag ends in forward slash. If it does NOT, add one. Case ( Right ( $$tagMenusFilePath ; 1 ) = "/" ; Substitute ( $$tagMenusFileName ; " " ; "%20" ) ; "/" & Substitute ( $$tagMenusFileName ; " " ; "%20" ) ) ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:/" ; "file:///" ) & $$tagMenusFilePath ; " " ; "%20" ) ) ] [ No dialog ]
    If [ Get ( LastError ) ≠ 0 ]
    #If that failes, try spaces.
    Open URL [ Case ( $openFolder = "" ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:/" ; "file:///" ) & $$tagMenusFilePath ; " " ; " " ) & //Check if file path tag ends in forward slash. If it does NOT, add one. Case ( Right ( $$tagMenusFilePath ; 1 ) = "/" ; Substitute ( $$tagMenusFileName ; " " ; " " ) ; "/" & Substitute ( $$tagMenusFileName ; " " ; " " ) ) ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:/" ; "file:///" ) & $$tagMenusFilePath ; " " ; " " ) ) ] [ No dialog ]
    End If
    If [ Get (LastError) = 5 ]
    Show Custom Dialog [ Message: Case ( $openFolder = "" ; "The file has been deleted or moved from " & Quote ( $$tagMenusFilePath ) & ", OR this path tag is invalid, OR the file name is no longer " & $$tagMenusFileName & "." ; Case ( Get ( WindowName ) = "Tag Menus" and $$citationMatch ≠ "cite" ; "This folder-path tag" & Quote ( $$tagMenusFilePath ) & " is a not working. 1) Go to the Reference section 2) Tag Menu 3) path menu to fix it." ; "This folder-path tag" & Quote ( $$tagMenusFilePath ) & " is a not working. 1) Go to the Tag Menu 2) path menu to fix it." ) ); Default Button: “OK”, Commit: “Yes” ]
    End If
    End If
    #
    #
    #
    End If
    #END: TAGMENUS LAYOUTS
    #
    #
    #
    #
    #
    #
    #BEGIN: LEARN LAYOUTS
    If [ Get ( LayoutTableName ) = "testlearn" ]
    #
    #
    #
    #If there is more than one reference record
    #tagged to this Learn window record, tell the
    #how to see the rest.
    If [ ValueCount ( testlearn::kcreference ) - Length ( Filter ( testlearn::kcreference ; "L" ) ) > 1 ]
    If [ $openFolder = "" ]
    If [ $openReferencedWebsite = "" ]
    #If the user selected to open a file,
    #show this message.
    Show Custom Dialog [ Message: "The first referenced file tagged to this Learn record will now open. To see all — " & ValueCount ( testlearn::kcreference ) - Length ( Filter ( testlearn::kcreference ; "L" ) ) & " — references tagged to it, 1) click the 'QV' button in the Learn window, or the 'references' button in the Tag Menus window, 2) and scroll down to see the tagged references."; Default Button: “OK”, Commit: “Yes” ]
    Else
    #If the user selected to open a website,
    #show this message.
    Show Custom Dialog [ Message: "The first referenced website tagged to this Learn record will now open. To see all — " & ValueCount ( testlearn::kcreference ) - Length ( Filter ( testlearn::kcreference ; "L" ) ) & " — references tagged to it, 1) click the 'QV' button in the Learn window, or the 'references' button in the Tag Menus window, 2) and scroll down to see the tagged references."; Default Button: “OK”, Commit: “Yes” ]
    End If
    Else
    #If the user selected to open a folder,
    #show this message.
    Show Custom Dialog [ Message: "FYI: This is the first of — " & ValueCount ( testlearn::kcreference ) - Length ( Filter ( testlearn::kcreference ; "L" ) ) & " — references tagged to this record. Click the 'QV' button in the Learn window, or the 'references' button in the Tag Menus window, to view them all."; Default Button: “OK”, Commit: “Yes” ]
    End If
    End If
    #
    #
    #
    #Open website if user clicked 'web'.
    #
    #Media file reference selected.
    If [ $openReferencedWebsite = 1 and testlearn::kshowReferencedMedia ≠ "" ]
    Open URL [ Case ( refLearnShowMedia::URL ≠ "" ; refLearnShowMedia::URL ; refLearnShowMedia::ISBN ≠ "" ; "http://www.worldcat.org/search?q=bn%3A" & refLearnShowMedia::ISBN ; refLearnShowMedia::ISSN ≠ "" ; "http://www.worldcat.org/ISSN/" & refLearnShowMedia::ISSN ; refLearnShowMedia::DOI ≠ "" ; "http://dx.doi.org/" & refLearnShowMedia::DOI ) ] [ No dialog ]
    #
    #If the web address fails let user know and
    #allow them to modify url and try again.
    If [ Get (LastError) = 5 ]
    Show Custom Dialog [ Message: "The reference's web address (URL) is not working: " & Case ( refLearnShowMedia::URL ≠ "" ; refLearnShowMedia::URL ; refLearnShowMedia::ISBN ≠ "" ; "http://www.worldcat.org/search?q=bn%3A" & refLearnShowMedia::ISBN ; refLearnShowMedia::ISSN ≠ "" ; "http://www.worldcat.org/ISSN/" & refLearnShowMedia::ISSN ; refLearnShowMedia::DOI ≠ "" ; "http://dx.doi.org/" & refLearnShowMedia::DOI ) & " Make a temporary change and try again?"; Default Button: “OK”, Commit: “Yes”; Button 2: “cancel”, Commit: “No” ]
    #
    #If user cancels, then exit this script.
    If [ Get ( LastMessageChoice ) = 2 ]
    Exit Script [ ]
    End If
    #
    #If user wants to try again, let them.
    Loop
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    Open URL [ Case ( refLearnShowMedia::URL ≠ "" ; refLearnShowMedia::URL ; refLearnShowMedia::ISBN ≠ "" ; "http://www.worldcat.org/search?q=bn%3A" & refLearnShowMedia::ISBN ; refLearnShowMedia::ISSN ≠ "" ; "http://www.worldcat.org/ISSN/" & refLearnShowMedia::ISSN ; refLearnShowMedia::DOI ≠ "" ; "http://dx.doi.org/" & refLearnShowMedia::DOI ) ]
    #
    #Exit script if website opens.
    Exit Loop If [ Get ( LastError ) = 0 ]
    #
    #If it fails, ask the user if they want to try again.
    If [ Get (LastError) = 5 ]
    Show Custom Dialog [ Message: "This change to reference's web address (URL) failed: " & Case ( refLearnShowMedia::URL ≠ "" ; refLearnShowMedia::URL ; refLearnShowMedia::ISBN ≠ "" ; "http://www.worldcat.org/search?q=bn%3A" & refLearnShowMedia::ISBN ; refLearnShowMedia::ISSN ≠ "" ; "http://www.worldcat.org/ISSN/" & refLearnShowMedia::ISSN ; refLearnShowMedia::DOI ≠ "" ; "http://dx.doi.org/" & refLearnShowMedia::DOI ) & " Try again?"; Default Button: “OK”, Commit: “Yes”; Button 2: “cancel”, Commit: “No” ]
    End If
    #
    #Exit script if user cancels. There are two dialog
    #boxes in which the user can cancel: the above
    #comment and the above Open Url dialog box.
    Exit Loop If [ Get ( LastMessageChoice ) = 2 or Get ( LastError ) = 1 ]
    End Loop
    End If
    Exit Script [ ]
    #
    #
    #Media file reference is not selected, so first
    #reference record's web file will be shown.
    Else If [ $openReferencedWebsite = 1 and testlearn::kshowReferencedMedia = "" ]
    Open URL [ Case ( refLearn::URL ≠ "" ; refLearn::URL ; refLearn::ISBN ≠ "" ; "http://www.worldcat.org/search?q=bn%3A" & refLearn::ISBN ; refLearn::ISSN ≠ "" ; "http://www.worldcat.org/ISSN/" & refLearn::ISSN ; refLearn::DOI ≠ "" ; "http://dx.doi.org/" & refLearn::DOI ) ] [ No dialog ]
    #
    #If the web address fails let user know and
    #allow them to modify url and try again.
    If [ Get (LastError) = 5 ]
    Show Custom Dialog [ Message: "The reference's web address (URL) is not working: " & Case ( refLearn::URL ≠ "" ; refLearn::URL ; refLearn::ISBN ≠ "" ; "http://www.worldcat.org/search?q=bn%3A" & refLearn::ISBN ; refLearn::ISSN ≠ "" ; "http://www.worldcat.org/ISSN/" & refLearn::ISSN ; refLearn::DOI ≠ "" ; "http://dx.doi.org/" & refLearn::DOI ) & " Make a temporary change and try again?"; Default Button: “OK”, Commit: “Yes”; Button 2: “cancel”, Commit: “No” ]
    #
    #If user cancels, then exit this script.
    If [ Get ( LastMessageChoice ) = 2 ]
    Exit Script [ ]
    End If
    #
    #If user wants to try again, let them.
    Loop
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    Open URL [ Case ( refLearn::URL ≠ "" ; refLearn::URL ; refLearn::ISBN ≠ "" ; "http://www.worldcat.org/search?q=bn%3A" & refLearn::ISBN ; refLearn::ISSN ≠ "" ; "http://www.worldcat.org/ISSN/" & refLearn::ISSN ; refLearn::DOI ≠ "" ; "http://dx.doi.org/" & refLearn::DOI ) ]
    #
    #Exit script if website opens.
    Exit Loop If [ Get ( LastError ) = 0 ]
    #
    #If it fails, ask the user if they want to try again.
    If [ Get (LastError) = 5 ]
    Show Custom Dialog [ Message: "This change to reference's web address (URL) failed: " & Case ( refLearn::URL ≠ "" ; refLearn::URL ; refLearn::ISBN ≠ "" ; "http://www.worldcat.org/search?q=bn%3A" & refLearn::ISBN ; refLearn::ISSN ≠ "" ; "http://www.worldcat.org/ISSN/" & refLearn::ISSN ; refLearn::DOI ≠ "" ; "http://dx.doi.org/" & refLearn::DOI ) & " Try again?"; Default Button: “OK”, Commit: “Yes”; Button 2: “cancel”, Commit: “No” ]
    End If
    #
    #Exit script if user cancels. There are two dialog
    #boxes in which the user can cancel: the above
    #comment and the above Open Url dialog box.
    Exit Loop If [ Get ( LastMessageChoice ) = 2 or Get ( LastError ) = 1 ]
    End Loop
    End If
    Exit Script [ ]
    End If
    #
    #
    #
    #BEGIN: Show selected reference media file ...
    #
    #
    #
    #Show file in or open ...
    #
    #... folder x.
    If [ FilterValues ( refLearnShowMedia::kfileLocation ; "8162011225532313" ) = "8162011225532313" & ¶ ]
    #Use %20 space substitutes.
    Open URL [ Case ( $openFolder = "" ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & "x/" & refLearnShowMedia::fileName ; " " ; "%20" ) ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & "x/" ; " " ; "%20" ) ) ] [ No dialog ]
    If [ Get ( LastError ) ≠ 0 ]
    #If that failes try %20 space substitutes.
    Open URL [ Case ( $openFolder = "" ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & "x/" & refLearnShowMedia::fileName ; " " ; " " ) ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & "x/" ; " " ; " " ) ) ] [ No dialog ]
    End If
    If [ Get (LastError) = 5 ]
    Show Custom Dialog [ Message: Case ( $openFolder = "" ; "The file has been deleted, moved from, or never downloaded/moved into this library's x folder, OR its name is no longer " & refLearnShowMedia::fileName & "." ; "The x folder has been moved, deleted, or perhaps never created (something the user must do during setup). The library's x folder needs to be here " & Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & "x/" ); Default Button: “OK”, Commit: “Yes” ]
    End If
    Exit Script [ ]
    #
    #... main library folder.
    Else If [ FilterValues ( refLearnShowMedia::kfileLocation ; "8162011225558314" ) = "8162011225558314" & ¶ ]
    #Use %20 space substitutes.
    Open URL [ Case ( $openFolder = "" ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & refLearnShowMedia::fileName ; " " ; "%20" ) ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) ; " " ; "%20" ) ) ] [ No dialog ]
    If [ Get ( LastError ) ≠ 0 ]
    #If that failes, try spaces.
    Open URL [ Case ( $openFolder = "" ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & refLearnShowMedia::fileName ; " " ; " " ) ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) ; " " ; " " ) ) ] [ No dialog ]
    End If
    If [ Get (LastError) = 5 ]
    Show Custom Dialog [ Message: Case ( $openFolder = "" ; "The file has been deleted, moved from, or never downloaded/moved into this library's main folder, OR its name is no longer " & refLearnShowMedia::fileName & "." ; //Since the main folder's file path is the same as the library's it will never fail to open. So a failure message is not needed. ); Default Button: “OK”, Commit: “Yes” ]
    End If
    Exit Script [ ]
    #
    #... other folder defined by a folder path tag.
    Else If [ FilterValues ( refLearnShowMedia::kfileLocation ; "8162011225605315" ) = "8162011225605315" & ¶ ]
    #Use %20 space substitutes.
    Open URL [ Case ( $openFolder = "" ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:/" ; "file:///" ) & tagRefLearnShowMediaFolderPath::tag ; " " ; "%20" ) & //Check if file path tag ends in forward slash. If it does NOT, add one. Case ( Right ( tagRefLearnShowMediaFolderPath::tag ; 1 ) = "/" ; Substitute ( refLearnShowMedia::fileName ; " " ; "%20" ) ; "/" & Substitute ( refLearnShowMedia::fileName ; " " ; "%20" ) ) ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:/" ; "file:///" ) & tagRefLearnShowMediaFolderPath::tag ; " " ; "%20" ) ) ] [ No dialog ]
    If [ Get ( LastError ) ≠ 0 ]
    #If that failes, try spaces.
    Open URL [ Case ( $openFolder = "" ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:/" ; "file:///" ) & tagRefLearnShowMediaFolderPath::tag ; " " ; " " ) & //Check if file path tag ends in forward slash. If it does NOT, add one. Case ( Right ( tagRefLearnShowMediaFolderPath::tag ; 1 ) = "/" ; Substitute ( refLearnShowMedia::fileName ; " " ; " " ) ; "/" & Substitute ( refLearnShowMedia::fileName ; " " ; " " ) ) ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:/" ; "file:///" ) & tagRefLearnShowMediaFolderPath::tag ; " " ; " " ) ) ] [ No dialog ]
    End If
    If [ Get (LastError) = 5 ]
    Show Custom Dialog [ Message: Case ( $openFolder = "" ; "The file has been deleted or moved from " & Quote ( tagRefLearnShowMediaFolderPath::tag ) & ", OR this path tag is invalid, OR the file name is no longer " & refLearnShowMedia::fileName & "." ; "This folder-path tag" & Quote ( tagRefLearnShowMediaFolderPath::tag ) & " is a not working. 1) Go to the Reference section 2) Tag Menu 3) path menu to fix it." ); Default Button: “OK”, Commit: “Yes” ]
    End If
    End If
    #END: Show selected reference media file ...
    #
    #
    #
    #BEGIN: Show first reference file in QV list ...
    #
    #
    #
    #Show file in or open ...
    #
    #... folder x.
    If [ FilterValues ( refLearn::kfileLocation ; "8162011225532313" ) = "8162011225532313" & ¶ and testlearn::kshowReferencedMedia = "" ]
    #Use %20 space substitutes.
    Open URL [ Case ( $openFolder = "" ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & "x/" & refLearn::fileName ; " " ; "%20" ) ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & "x/" ; " " ; "%20" ) ) ] [ No dialog ]
    If [ Get ( LastError ) ≠ 0 ]
    #If that failes, try spaces.
    Open URL [ Case ( $openFolder = "" ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & "x/" & refLearn::fileName ; " " ; " " ) ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & "x/" ; " " ; " " ) ) ] [ No dialog ]
    End If
    If [ Get (LastError) = 5 ]
    Show Custom Dialog [ Message: Case ( $openFolder = "" ; "The file has been deleted, moved from, or never downloaded/moved into this library's x folder, OR its name is no longer " & refLearn::fileName & "." ; "The x folder has been moved, deleted, or perhaps never created (something the user must do during setup). The library's x folder needs to be here " & Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & "x/" ); Default Button: “OK”, Commit: “Yes” ]
    End If
    Exit Script [ ]
    #
    #... main library folder.
    Else If [ FilterValues ( refLearn::kfileLocation ; "8162011225558314" ) = "8162011225558314" & ¶ and testlearn::kshowReferencedMedia = "" ]
    #Use %20 space substitutes.
    Open URL [ Case ( $openFolder = "" ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & refLearn::fileName ; " " ; "%20" ) ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) ; " " ; "%20" ) ) ] [ No dialog ]
    If [ Get ( LastError ) ≠ 0 ]
    #If that failes, try spaces.
    Open URL [ Case ( $openFolder = "" ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & refLearn::fileName ; " " ; " " ) ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) ; " " ; " " ) ) ] [ No dialog ]
    End If
    If [ Get (LastError) = 5 ]
    Show Custom Dialog [ Message: Case ( $openFolder = "" ; "The file has been deleted, moved from, or never downloaded/moved into this library's main folder, OR its name is no longer " & refLearn::fileName & "." ; //Since the main folder's file path is the same as the library's it will never fail to open. So a failure message is not needed. ); Default Button: “OK”, Commit: “Yes” ]
    End If
    Exit Script [ ]
    #
    #... other folder defined by a folder path tag.
    Else If [ FilterValues ( refLearn::kfileLocation ; "8162011225605315" ) = "8162011225605315" & ¶ and testlearn::kshowReferencedMedia = "" ]
    #Use %20 space substitutes.
    Open URL [ Case ( $openFolder = "" ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:/" ; "file:///" ) & tagRefLearnFolderPath::tag ; " " ; "%20" ) & //Check if file path tag ends in forward slash. If it does NOT, add one. Case ( Right ( tagRefLearnFolderPath::tag ; 1 ) = "/" ; Substitute ( refLearn::fileName ; " " ; "%20" ) ; "/" & Substitute ( refLearn::fileName ; " " ; "%20" ) ) ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:/" ; "file:///" ) & tagRefLearnFolderPath::tag ; " " ; "%20" ) ) ] [ No dialog ]
    If [ Get ( LastError ) ≠ 0 ]
    #If that failes, try spaces.
    Open URL [ Case ( $openFolder = "" ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:/" ; "file:///" ) & tagRefLearnFolderPath::tag ; " " ; " " ) & //Check if file path tag ends in forward slash. If it does NOT, add one. Case ( Right ( tagRefLearnFolderPath::tag ; 1 ) = "/" ; Substitute ( refLearn::fileName ; " " ; " " ) ; "/" & Substitute ( refLearn::fileName ; " " ; " " ) ) ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:/" ; "file:///" ) & tagRefLearnFolderPath::tag ; " " ; " " ) ) ] [ No dialog ]
    End If
    If [ Get (LastError) = 5 ]
    Show Custom Dialog [ Message: Case ( $openFolder = "" ; "The file has been deleted or moved from " & Quote ( tagRefLearnFolderPath::tag ) & ", OR this path tag is invalid, OR the file name is no longer " & refLearn::fileName & "." ; "This folder-path tag" & Quote ( tagRefLearnFolderPath::tag ) & " is a not working. 1) Go to the Reference section 2) Tag Menu 3) path menu to fix it." ); Default Button: “OK”, Commit: “Yes” ]
    End If
    End If
    #END: Show first reference file in QV list ...
    #
    #
    #
    End If
    #END: LEARN LAYOUTS
    #
    #
    #
    #
    #
    #
    #BEGIN: TEST AND REPORT LAYOUTS
    If [ Get ( LayoutTableName ) = "testlearnReportTags" ]
    #
    #
    #
    #If there is more than one reference record
    #tagged to this testlearn record, then tell user
    #how to see and open them ...
    If [ ValueCount ( testlearnReportTags::kcreference ) - Length ( Filter ( testlearnReportTags::kcreference ; "L" ) ) > 1 ]
    If [ $openFolder = "" ]
    If [ $openReferencedWebsite = "" ]
    #If the user selected to open a file,
    #show this message.
    Show Custom Dialog [ Message: "The first referenced file tagged to this Learn record will now open. To see all — " & ValueCount ( testlearnReportTags::kcreference ) - Length ( Filter ( testlearnReportTags::kcreference ; "L" ) ) & " — references tagged to it, 1) click the 'QV' button in the Learn window, or the 'references' button in the Tag Menus window, 2) and scroll down to see the tagged references."; Default Button: “OK”, Commit: “Yes” ]
    Else
    #If the user selected to open a website,
    #show this message.
    Show Custom Dialog [ Message: "The first referenced website tagged to this Learn record will now open. To see all — " & ValueCount ( testlearnReportTags::kcreference ) - Length ( Filter ( testlearnReportTags::kcreference ; "L" ) ) & " — testlearnReportTags tagged to it, 1) click the 'QV' button in the Learn window, or the 'references' button in the Tag Menus window, 2) and scroll down to see the tagged references."; Default Button: “OK”, Commit: “Yes” ]
    End If
    Else
    #If the user selected to open a folder,
    #show this message.
    Show Custom Dialog [ Message: "FYI: This is the first of — " & ValueCount ( testlearnReportTags::kcreference ) - Length ( Filter ( testlearnReportTags::kcreference ; "L" ) ) & " — references tagged to this record. 1) Click the 'QV' button in the Learn window, or the 'references' button in the Tag Menus window, 2) and scroll down to see the tagged references."; Default Button: “OK”, Commit: “Yes” ]
    End If
    End If
    #
    #
    #
    #Open website if user clicked 'web'.
    #
    #Media file reference selected.
    If [ $openReferencedWebsite = 1 and testlearnReportTags::kshowReferencedMedia ≠ "" ]
    Open URL [ Case ( refTestShowMedia::URL ≠ "" ; refTestShowMedia::URL ; refTestShowMedia::ISBN ≠ "" ; "http://www.worldcat.org/search?q=bn%3A" & refTestShowMedia::ISBN ; refTestShowMedia::ISSN ≠ "" ; "http://www.worldcat.org/ISSN/" & refTestShowMedia::ISSN ; refTestShowMedia::DOI ≠ "" ; "http://dx.doi.org/" & refTestShowMedia::DOI ) ] [ No dialog ]
    #
    #If the web address fails let user know and
    #allow them to modify url and try again.
    If [ Get (LastError) = 5 ]
    Show Custom Dialog [ Message: "The reference's web address (URL) is not working: " & Case ( refTestShowMedia::URL ≠ "" ; refTestShowMedia::URL ; refTestShowMedia::ISBN ≠ "" ; "http://www.worldcat.org/search?q=bn%3A" & refTestShowMedia::ISBN ; refTestShowMedia::ISSN ≠ "" ; "http://www.worldcat.org/ISSN/" & refTestShowMedia::ISSN ; refTestShowMedia::DOI ≠ "" ; "http://dx.doi.org/" & refTestShowMedia::DOI ) & " Make a temporary change and try again?"; Default Button: “OK”, Commit: “Yes”; Button 2: “cancel”, Commit: “No” ]
    #
    #If user cancels, then exit this script.
    If [ Get ( LastMessageChoice ) = 2 ]
    Exit Script [ ]
    End If
    #
    #If user wants to try again, let them.
    Loop
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    Open URL [ Case ( refTestShowMedia::URL ≠ "" ; refTestShowMedia::URL ; refTestShowMedia::ISBN ≠ "" ; "http://www.worldcat.org/search?q=bn%3A" & refTestShowMedia::ISBN ; refTestShowMedia::ISSN ≠ "" ; "http://www.worldcat.org/ISSN/" & refTestShowMedia::ISSN ; refTestShowMedia::DOI ≠ "" ; "http://dx.doi.org/" & refTestShowMedia::DOI ) ]
    #
    #Exit script if website opens.
    Exit Loop If [ Get ( LastError ) = 0 ]
    #
    #If it fails, ask the user if they want to try again.
    If [ Get (LastError) = 5 ]
    Show Custom Dialog [ Message: "This change to reference's web address (URL) failed: " & Case ( refTestShowMedia::URL ≠ "" ; refTestShowMedia::URL ; refTestShowMedia::ISBN ≠ "" ; "http://www.worldcat.org/search?q=bn%3A" & refTestShowMedia::ISBN ; refTestShowMedia::ISSN ≠ "" ; "http://www.worldcat.org/ISSN/" & refTestShowMedia::ISSN ; refTestShowMedia::DOI ≠ "" ; "http://dx.doi.org/" & refTestShowMedia::DOI ) & " Try again?"; Default Button: “OK”, Commit: “Yes”; Button 2: “cancel”, Commit: “No” ]
    End If
    #
    #Exit script if user cancels. There are two dialog
    #boxes in which the user can cancel: the above
    #comment and the above Open Url dialog box.
    Exit Loop If [ Get ( LastMessageChoice ) = 2 or Get ( LastError ) = 1 ]
    End Loop
    End If
    Exit Script [ ]
    #
    #
    #Media file reference is not selected, so first
    #reference record's web file will be shown.
    Else If [ $openReferencedWebsite = 1 and testlearnReportTags::kshowReferencedMedia = "" ]
    Open URL [ Case ( refTest::URL ≠ "" ; refTest::URL ; refTest::ISBN ≠ "" ; "http://www.worldcat.org/search?q=bn%3A" & refTest::ISBN ; refTest::ISSN ≠ "" ; "http://www.worldcat.org/ISSN/" & refTest::ISSN ; refTest::DOI ≠ "" ; "http://dx.doi.org/" & refTest::DOI ) ] [ No dialog ]
    #
    #If the web address fails let user know and
    #allow them to modify url and try again.
    If [ Get (LastError) = 5 ]
    Show Custom Dialog [ Message: "The reference's web address (URL) is not working: " & Case ( refTest::URL ≠ "" ; refTest::URL ; refTest::ISBN ≠ "" ; "http://www.worldcat.org/search?q=bn%3A" & refTest::ISBN ; refTest::ISSN ≠ "" ; "http://www.worldcat.org/ISSN/" & refTest::ISSN ; refTest::DOI ≠ "" ; "http://dx.doi.org/" & refTest::DOI ) & " Make a temporary change and try again?"; Default Button: “OK”, Commit: “Yes”; Button 2: “cancel”, Commit: “No” ]
    #
    #If user cancels, then exit this script.
    If [ Get ( LastMessageChoice ) = 2 ]
    Exit Script [ ]
    End If
    #
    #If user wants to try again, let them.
    Loop
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    Open URL [ Case ( refTest::URL ≠ "" ; refTest::URL ; refTest::ISBN ≠ "" ; "http://www.worldcat.org/search?q=bn%3A" & refTest::ISBN ; refTest::ISSN ≠ "" ; "http://www.worldcat.org/ISSN/" & refTest::ISSN ; refTest::DOI ≠ "" ; "http://dx.doi.org/" & refTest::DOI ) ]
    #
    #Exit script if website opens.
    Exit Loop If [ Get ( LastError ) = 0 ]
    #
    #If it fails, ask the user if they want to try again.
    If [ Get (LastError) = 5 ]
    Show Custom Dialog [ Message: "This change to reference's web address (URL) failed: " & Case ( refTest::URL ≠ "" ; refTest::URL ; refTest::ISBN ≠ "" ; "http://www.worldcat.org/search?q=bn%3A" & refTest::ISBN ; refTest::ISSN ≠ "" ; "http://www.worldcat.org/ISSN/" & refTest::ISSN ; refTest::DOI ≠ "" ; "http://dx.doi.org/" & refTest::DOI ) & " Try again?"; Default Button: “OK”, Commit: “Yes”; Button 2: “cancel”, Commit: “No” ]
    End If
    #
    #Exit script if user cancels. There are two dialog
    #boxes in which the user can cancel: the above
    #comment and the above Open Url dialog box.
    Exit Loop If [ Get ( LastMessageChoice ) = 2 or Get ( LastError ) = 1 ]
    End Loop
    End If
    Exit Script [ ]
    End If
    #
    #
    #
    #BEGIN: Show selected reference media file ...
    #
    #
    #
    #Show file in or open ...
    #
    #... folder x.
    If [ FilterValues ( refTestShowMedia::kfileLocation ; "8162011225532313" ) = "8162011225532313" & ¶ ]
    #Use %20 space substitutes.
    Open URL [ Case ( $openFolder = "" ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & "x/" & refTestShowMedia::fileName ; " " ; "%20" ) ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & "x/" ; " " ; "%20" ) ) ] [ No dialog ]
    If [ Get ( LastError ) ≠ 0 ]
    #If that failes, try spaces.
    Open URL [ Case ( $openFolder = "" ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & "x/" & refTestShowMedia::fileName ; " " ; " " ) ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & "x/" ; " " ; " " ) ) ] [ No dialog ]
    End If
    If [ Get (LastError) = 5 ]
    Show Custom Dialog [ Message: Case ( $openFolder = "" ; "The file has been deleted, moved from, or never downloaded/moved into this library's x folder, OR its name is no longer " & refTestShowMedia::fileName & "." ; "The x folder has been moved, deleted, or perhaps never created (something the user must do during setup). The library's x folder needs to be here " & Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & "x/" ); Default Button: “OK”, Commit: “Yes” ]
    End If
    Exit Script [ ]
    #
    #... main library folder.
    Else If [ FilterValues ( refTestShowMedia::kfileLocation ; "8162011225558314" ) = "8162011225558314" & ¶ ]
    #Use %20 space substitutes.
    Open URL [ Case ( $openFolder = "" ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & refTestShowMedia::fileName ; " " ; "%20" ) ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) ; " " ; "%20" ) ) ] [ No dialog ]
    If [ Get ( LastError ) ≠ 0 ]
    #If that failes, try spaces.
    Open URL [ Case ( $openFolder = "" ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & refTestShowMedia::fileName ; " " ; " " ) ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) ; " " ; " " ) ) ] [ No dialog ]
    End If
    If [ Get (LastError) = 5 ]
    Show Custom Dialog [ Message: Case ( $openFolder = "" ; "The file has been deleted, moved from, or never downloaded/moved into this library's main folder, OR its name is no longer " & refTestShowMedia::fileName & "." ; //Since the main folder's file path is the same as the library's it will never fail to open. So a failure message is not needed. ); Default Button: “OK”, Commit: “Yes” ]
    End If
    Exit Script [ ]
    #
    #... other folder defined by a folder path tag.
    Else If [ FilterValues ( refTestShowMedia::kfileLocation ; "8162011225605315" ) = "8162011225605315" & ¶ ]
    #Use %20 space substitutes.
    Open URL [ Case ( $openFolder = "" ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:/" ; "file:///" ) & refTestShowMediaFolderPath::tag ; " " ; "%20" ) & //Check if file path tag ends in forward slash. If it does NOT, add one. Case ( Right ( refTestShowMediaFolderPath::tag ; 1 ) = "/" ; Substitute ( refTestShowMedia::fileName ; " " ; "%20" ) ; "/" & Substitute ( refTestShowMedia::fileName ; " " ; "%20" ) ) ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:/" ; "file:///" ) & refTestShowMediaFolderPath::tag ; " " ; "%20" ) ) ] [ No dialog ]
    If [ Get ( LastError ) ≠ 0 ]
    #If that failes, try spaces.
    Open URL [ Case ( $openFolder = "" ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:/" ; "file:///" ) & refTestShowMediaFolderPath::tag ; " " ; " " ) & Case ( Right ( refTestShowMediaFolderPath::tag ; 1 ) = "/" ; Substitute ( refTestShowMedia::fileName ; " " ; " " ) ; "/" & Substitute ( refTestShowMedia::fileName ; " " ; " " ) ) ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:/" ; "file:///" ) & refTestShowMediaFolderPath::tag ; " " ; " " ) ) ] [ No dialog ]
    End If
    If [ Get (LastError) = 5 ]
    Show Custom Dialog [ Message: Case ( $openFolder = "" ; "The file has been deleted or moved from " & Quote ( refTestShowMediaFolderPath::tag ) & ", OR this path tag is invalid, OR the file name is no longer " & refTestShowMedia::fileName & "." ; Case ( Get ( WindowName ) = "Tag Menus" ; "This folder-path tag" & Quote ( refTestShowMediaFolderPath::tag ) & " is a not working. 1) Go to the Reference section 2) Tag Menu 3) path menu to fix it." ; "This folder-path tag" & Quote ( refTestShowMediaFolderPath::tag ) & " is a not working. 1) Go to the Tag Menu 2) path menu to fix it." ) ); Default Button: “OK”, Commit: “Yes” ]
    End If
    End If
    #END: Show selected reference media file ...
    #
    #
    #
    #BEGIN: Show first reference file in QV list ...
    #
    #
    #
    #Show file in or open ...
    #
    #... folder x.
    If [ FilterValues ( refTest::kfileLocation ; "8162011225532313" ) = "8162011225532313" & ¶ and testlearnReportTags::kshowReferencedMedia = "" ]
    #Use %20 space substitutes.
    Open URL [ Case ( $openFolder = "" ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & "x/" & refTest::fileName ; " " ; "%20" ) ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & "x/" ; " " ; "%20" ) ) ] [ No dialog ]
    If [ Get ( LastError ) ≠ 0 ]
    #If that failes, try spaces.
    Open URL [ Case ( $openFolder = "" ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & "x/" & refTest::fileName ; " " ; " " ) ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & "x/" ; " " ; " " ) ) ] [ No dialog ]
    End If
    If [ Get (LastError) = 5 ]
    Show Custom Dialog [ Message: Case ( $openFolder = "" ; "The file has been deleted, moved from, or never downloaded/moved into this library's x folder, OR its name is no longer " & refTest::fileName & "." ; "The x folder has been moved, deleted, or perhaps never created (something the user must do during setup). The library's x folder needs to be here " & Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & "x/" ); Default Button: “OK”, Commit: “Yes” ]
    End If
    Exit Script [ ]
    #
    #... main library folder.
    Else If [ FilterValues ( refTest::kfileLocation ; "8162011225558314" ) = "8162011225558314" & ¶ and testlearnReportTags::kshowReferencedMedia = "" ]
    #Use %20 space substitutes.
    Open URL [ Case ( $openFolder = "" ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & refTest::fileName ; " " ; "%20" ) ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) ; " " ; "%20" ) ) ] [ No dialog ]
    If [ Get ( LastError ) ≠ 0 ]
    #If that failes, try spaces.
    Open URL [ Case ( $openFolder = "" ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) & refTest::fileName ; " " ; " " ) ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:" ; "file:/" ) & Middle ( Get ( FilePath ) ; 6 ; Length ( Get (FilePath ) ) - Length ( Get (FileName ) ) - 11) ; " " ; " " ) ) ] [ No dialog ]
    End If
    If [ Get (LastError) = 5 ]
    Show Custom Dialog [ Message: Case ( $openFolder = "" ; "The file has been deleted, moved from, or never downloaded/moved into this library's main folder, OR its name is no longer " & refTest::fileName & "." ; //Since the main folder's file path is the same as the library's it will never fail to open. So a failure message is not needed. ); Default Button: “OK”, Commit: “Yes” ]
    End If
    Exit Script [ ]
    #
    #... other folder defined by a folder path tag.
    Else If [ FilterValues ( refTest::kfileLocation ; "8162011225605315" ) = "8162011225605315" & ¶ and testlearnReportTags::kshowReferencedMedia = "" ]
    #Use %20 space substitutes.
    Open URL [ Case ( $openFolder = "" ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:/" ; "file:///" ) & refTestFolderPath::tag ; " " ; "%20" ) & //Check if file path tag ends in forward slash. If it does NOT, add one. Case ( Right ( refTestFolderPath::tag ; 1 ) = "/" ; Substitute ( refTest::fileName ; " " ; "%20" ) ; "/" & Substitute ( refTest::fileName ; " " ; "%20" ) ) ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:/" ; "file:///" ) & refTestFolderPath::tag ; " " ; "%20" ) ) ] [ No dialog ]
    If [ Get ( LastError ) ≠ 0 ]
    #If that failes, try spaces.
    Open URL [ Case ( $openFolder = "" ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:/" ; "file:///" ) & refTestFolderPath::tag ; " " ; " " ) & Case ( Right ( refTestFolderPath::tag ; 1 ) = "/" ; Substitute ( refTest::fileName ; " " ; " " ) ; "/" & Substitute ( refTest::fileName ; " " ; " " ) ) ; Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:/" ; "file:///" ) & refTestFolderPath::tag ; " " ; " " ) ) ] [ No dialog ]
    End If
    If [ Get (LastError) = 5 ]
    Show Custom Dialog [ Message: Case ( $openFolder = "" ; "The file has been deleted or moved from " & Quote ( refTestFolderPath::tag ) & ", OR this path tag is invalid, OR the file name is no longer " & refTest::fileName & "." ; Case ( Get ( WindowName ) = "Tag Menus" ; "This folder-path tag" & Quote ( refTestFolderPath::tag ) & " is a not working. 1) Go to the Reference section 2) Tag Menu 3) path menu to fix it." ; "This folder-path tag" & Quote ( refTestFolderPath::tag ) & " is a not working. 1) Go to the Tag Menu 2) path menu to fix it." ) ); Default Button: “OK”, Commit: “Yes” ]
    End If
    End If
    #END: Show first reference file in QV list ...
    #
    #
    #
    End If
    #END: TEST AND REPORT LAYOUTS
    #
    #

Fields used in this script

    reference::fileName
    reference::kfileLocation
    reference::kfolderpath
    testlearn::kshowReferencedMedia
    refLearn::fileName
    refLearn::kfileLocation
    refLearn::kfolderpath
    refLearnShowMedia::fileName
    refLearnShowMedia::kfileLocation
    refLearnShowMedia::kfolderpath
    testlearnReportTags::kshowReferencedMedia
    refTest::fileName
    refTest::kfileLocation
    refTest::kfolderpath
    refTestShowMedia::fileName
    refTestShowMedia::kfileLocation
    refTestShowMedia::kfolderpath
    reference::URL
    reference::ISBN
    reference::ISSN
    reference::DOI
    refLearn::URL
    refLearn::ISBN
    refLearn::ISSN
    refLearn::DOI
    refLearnShowMedia::URL
    refLearnShowMedia::ISBN
    refLearnShowMedia::ISSN
    refLearnShowMedia::DOI
    refTest::URL
    refTest::ISBN
    refTest::ISSN
    refTest::DOI
    refTestShowMedia::URL
    refTestShowMedia::ISBN
    refTestShowMedia::ISSN
    refTestShowMedia::DOI
    tagRefFolderPath::kfileORkTestItemCreatorNode
    tagRefLearnFolderPath::kfileORkTestItemCreatorNode
    refTestFolderPath::kfileORkTestItemCreatorNode
    tagRefFolderPath::tag
    tagRefLearnFolderPath::tag
    refTestFolderPath::tag
    testlearn::kcreference
    tagRefLearnShowMediaFolderPath::tag
    testlearnReportTags::kcreference
    refTestShowMediaFolderPath::tag

Scripts used in this script

Layouts used in this script

Tables used in this script

    reference
    tag
    testlearn

Table occurrences used by this script

    refLearn
    refLearnShowMedia
    refTest
    refTestFolderPath
    refTestShowMedia
    refTestShowMediaFolderPath
    reference
    tagRefFolderPath
    tagRefLearnFolderPath
    tagRefLearnShowMediaFolderPath
    testlearn
    testlearnReportTags

Custom Functions used by this script

Custom menu set used by this script


probablyNotInUse

libraryNewOrImport
	Parent Folder: [libraryNewOrImport]	Next Script: [Interactivate]
Script Name	importDataFromABranchIntoThisMainLibrary
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultSetup
    defaultTest
    defaultTestNewSection

Scripts that use this script

Script Definition
Script Steps

    #
    #PURPOSE: Import records from another
    #library into this library file, and overwrites
    #existing records with imported library's
    #changes.
    #
    #
    #Prevent user from importing data into a
    #branch library. This is a safeguard to help
    #users keep track of which library has the
    #most complete record set = main library; AND
    #make sure user's don't overwrite new records
    #with old records.
    If [ tempSetup::userLibraryMainOrBranch = 1 ]
    Show Custom Dialog [ Message: "This is a branch library. Import branch library records into the main library. Then replace branch libraries (libraries on other devices) with duplicates of the udpated main library file." ]
    Show Custom Dialog [ Message: "By importing all branches into your main library; then replacing them with duplicates of the main library, you insure duplicate, consolidated, up-to-date libraries on all your devices." ]
    Show Custom Dialog [ Message: "IMPORTANT!!! After you duplicate the main library, 1) make sure you open it, 2) go to the Setup Tag Menu's AllDefaults menu, 3) and check the branch-library checkbox." ]
    Exit Script [ ]
    End If
    #
    #
    #Admin tasks.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #Inform the user the import will both add new
    #records and overwrite existing records with
    #changes made in library being imported.
    Show Custom Dialog [ Message: "IMPORTANT: This import can change — update, overwrite, etc. — records in this library."; Default Button: “OK”, Commit: “No”; Button 2: “cancel”, Commit: “No” ]
    If [ Get ( LastMessageChoice ) = 2 ]
    Exit Script [ ]
    End If
    Show Custom Dialog [ Message: "For example, if a record's text in the library being imported was changed from 'Apple' to 'Orange,' then the record in this library will also be changed to 'Orange.'"; Default Button: “OK”, Commit: “No”; Button 2: “cancel”, Commit: “No” ]
    If [ Get ( LastMessageChoice ) = 2 ]
    Exit Script [ ]
    End If
    #
    #Inform user to make a backup of the current
    #library before importing new data as this
    #process can crash FileMaker which can
    #damage the main library file.
    Show Custom Dialog [ Message: "On some imports FileMaker crashes, so, a backup of this main Library file MUST be created before proceeding."; Default Button: “OK”, Commit: “No”; Button 2: “cancel”, Commit: “No” ]
    If [ Get ( LastMessageChoice ) = 2 ]
    Exit Script [ ]
    End If
    #
    #Create a copy of this library file.
    Save a Copy as [ ] [ copy of current file ]
    If [ Get ( LastError ) = 1 ]
    Exit Script [ ]
    End If
    Show Custom Dialog [ Message: "If FileMaker crashes during the import, delete this crashed main-library file, and try again with the backup you just created."; Default Button: “OK”, Commit: “No”; Button 2: “cancel”, Commit: “No” ]
    #
    #If user clicks cancel then exit
    #this script.
    If [ Get ( LastMessageChoice ) = 2 ]
    Exit Script [ ]
    End If
    Show Custom Dialog [ Message: "Do not be discouraged if FileMaker crashes several times in a row. Eventually, it will work. Always delete the crashed library, and use the fresh copy just created to import into."; Default Button: “OK”, Commit: “Yes”; Button 2: “cancel”, Commit: “No” ]
    #
    #If user clicks cancel then exit
    #this script.
    If [ Get ( LastMessageChoice ) = 2 ]
    Exit Script [ ]
    End If
    #
    #Get library's ID and name, and the library
    #creator and test subject node IDs and names.
    #This is done so that later on in the script the
    #imported library's ID record can be deleted, if
    #there is one, and any name changes can be
    #captured and reported to the user.
    Set Variable [ $libraryID; Value:TEMP::klibrary ]
    Set Variable [ $$libraryNameForNameChangeCheck; Value:TEMP::userLibraryName ]
    Set Variable [ $$primaryNodeNameChangeCheck; Value:TEMP::DEFAULTNodePrimaryName ]
    Set Variable [ $$testSubjectNodeNameChangeCheck; Value:TEMP::DEFAULTNodeTestSubjectName ]
    #
    #
    #Get path of library that user wants to import
    #files from by generating this code and
    #cuting it using the computer's clipboard so
    #it can be pasted by the library the user is now
    #opening (the one they want to import files
    #from).
    Go to Layout [ “backup” (backup) ]
    Delete All Records [ No dialog ]
    New Record/Request
    Set Field [ backup::backup; Case (tempSetup::InventoryLibraryYN[1] ; 1 ; 2 ) & "update439asdkc;liasdu;irejf.as.dkfupea;lksdfa,sm.eupqoiwendssasdeawsrre5o983498woeirf" ]
    #
    #Cut instead of copy, saves the step of erasing
    #this code from the current file, as the copy
    #command both copies and erases the code.
    Cut [ backup::backup ] [ Select ]
    #
    #Ask the user what file they want to
    #import from. Because it is an (unknown) file,
    #the user will be prompted to select this file.
    Go to Layout [ “defaultSetup” (librarySetupReferenceMain) ]
    Open File [ <unknown> ]
    #
    #If user clicks cancel then exit
    #this script.
    If [ Get (LastError) = 1 ]
    Exit Script [ ]
    End If
    #
    #Make sure the file the user selected to import
    #from was opened and its filepath copied. If it
    #was already open, then this script did not
    #open it and its startDatabase script did not
    #just run and insert this code, which would
    #have resulted in its filepath being copied by
    #the computer's clipboard. Thus the
    #computer's clipboard will still contain the
    #copy-filepath code, instead of the file's
    #filepath.
    Go to Layout [ “backup” (backup) ]
    Paste [ backup::backup ] [ Select; No style ]
    #
    #
    If [ Case (tempSetup::InventoryLibraryYN[1] ; 1 ; 2 ) & "update439asdkc;liasdu;irejf.as.dkfupea;lksdfa,sm.eupqoiwendssasdeawsrre5o983498woeirf" = backup::backup ]
    #
    #Tell the user the import failed and how to
    #succeed. Then restart the library to all the
    #user to try again.
    Set Field [ backup::backup; "" ]
    #Important!!! Clear the clipboard!
    Copy [ ] [ Select ]
    Go to Layout [ “defaultSetup” (librarySetupReferenceMain) ]
    Show Custom Dialog [ Message: "Open library's records cannot be imported. 1) Close the library you're trying to import. 2) Click the import button." ]
    Exit Script [ ]
    End If
    #
    #
    #
    #In the startDatabase script an if calc
    #determines if the library being imported is of a
    #type (idea or inventory) that is the opposite of
    #the import-into library. If it is the opposite
    #type, then the word 'idea' or 'inventory' is
    #pasted into the import-into library's backup
    #field, so that the import can be stopped.
    If [ "ideas" = backup::backup ]
    #
    Set Field [ backup::backup; "" ]
    #Important!!! Clear the clipboard!
    Copy [ ] [ Select ]
    Go to Layout [ “defaultSetup” (librarySetupReferenceMain) ]
    Show Custom Dialog [ Message: "The library selected for import is an idea library. This library is an inventory library. Idea library records cannot be imported into an inventory library." ]
    #
    Exit Script [ ]
    Else If [ "inventory" = backup::backup ]
    #
    Set Field [ backup::backup; "" ]
    #Important!!! Clear the clipboard!
    Copy [ ] [ Select ]
    Go to Layout [ “defaultSetup” (librarySetupReferenceMain) ]
    Show Custom Dialog [ Message: "The library selected for import is an inventory library. This library is an idea library. Inventory library records cannot be imported into an idea library." ]
    Exit Script [ ]
    #
    #
    #This next bit cannot work as there is no way to
    #insure the computers universal clipboard was
    #used by FileMaker or the user during
    #the import process.
    // Else If [ "failure" = backup::backup ]
    // Set Field [ backup::backup; "" ]
    // Go to Layout [ “defaultSetup” (librarySetupReferenceMain) ]
    // Show Custom Dialog [ Message: "The computer's clipboard contents where changed during the import, which caused this import attempt to fail. Please try again." ]
    // Show Custom Dialog [ Message: "IMPORTANT!!! Do not user the cut or copy commands during the import process." ]
    // Exit Script [ ]
    #
    #
    #
    #If the computer's clipboard contains a
    #filepath, then proceed with the import.
    Else
    Set Variable [ $filepath; Value:backup::backup ]
    #Important!!! Clear the clipboard!
    Set Field [ backup::backup; "" ]
    Copy [ ] [ Select ]
    End If
    #
    #
    #1) Import test section records.
    Go to Layout [ “tableTestSectionFromTemplate” (testSectionCreatedFromATemplate) ]
    Show All Records
    If [ Get (FoundCount) = 0 ]
    Import Records [ Source: “$filepath”; Target: “testSectionCreatedFromATemplate”; Method: Add; Character Set: “Unicode”; Field Mapping: Source field 1 import to testSectionCreatedFromATemplate::ktestSubjectNode Source field 2 import to testSectionCreatedFromATemplate::ksectionTemplate Source field 3 import to testSectionCreatedFromATemplate::_LtestSection Source field 4 import to testSectionCreatedFromATemplate::name Source field 5 import to testSectionCreatedFromATemplate::inUse Source field 6 import to testSectionCreatedFromATemplate::order Source field 7 import to testSectionCreatedFromATemplate::_number Source field 8 import to testSectionCreatedFromATemplate::klibrary Source field 9 import to testSectionCreatedFromATemplate::reportNumber Source field 10 import to testSectionCreatedFromATemplate::kcreatorNode Source field 12 import to testSectionCreatedFromATemplate::creationDate Source field 13 import to testSectionCreatedFromATemplate::creationTime ] [ No dialog ]
    Else
    Import Records [ Source: “$filepath”; Target: “testSectionCreatedFromATemplate”; Method: Update matching; Add remaining; Character Set: “Unicode”; Field Mapping: Source field 1 import to testSectionCreatedFromATemplate::ktestSubjectNode Source field 2 import to testSectionCreatedFromATemplate::ksectionTemplate Source field 3 match with testSectionCreatedFromATemplate::_LtestSection Source field 4 import to testSectionCreatedFromATemplate::name Source field 5 import to testSectionCreatedFromATemplate::inUse Source field 6 import to testSectionCreatedFromATemplate::order Source field 7 import to testSectionCreatedFromATemplate::_number Source field 8 import to testSectionCreatedFromATemplate::klibrary Source field 9 import to testSectionCreatedFromATemplate::reportNumber Source field 10 import to testSectionCreatedFromATemplate::kcreatorNode Source field 12 import to testSectionCreatedFromATemplate::creationDate Source field 13 import to testSectionCreatedFromATemplate::creationTime ] [ No dialog ]
    End If
    #
    #
    #2) Import test subsection records.
    Go to Layout [ “tableTestSubsectionTemplates” (testSubsectionTemplate) ]
    Show All Records
    If [ Get (FoundCount) = 0 ]
    Import Records [ Source: “$filepath”; Target: “testSubsectionTemplate”; Method: Add; Character Set: “Unicode”; Field Mapping: Source field 1 import to testSubsectionTemplate::_LtestSubsection Source field 2 import to testSubsectionTemplate::ksubsectionGroup Source field 3 import to testSubsectionTemplate::_number Source field 4 import to testSubsectionTemplate::kcsections Source field 5 import to testSubsectionTemplate::name Source field 6 import to testSubsectionTemplate::order Source field 7 import to testSubsectionTemplate::retire Source field 8 import to testSubsectionTemplate::kgtestSubject Source field 9 import to testSubsectionTemplate::gtestSectionNameGlobal Source field 10 import to testSubsectionTemplate::gtestSubjectNameGlobal Source field 11 import to testSubsectionTemplate::kgtestSection Source field 12 import to testSubsectionTemplate::gprogressGlobal Source field 13 import to testSubsectionTemplate::klibrary Source field 14 import to testSubsectionTemplate::kgreportNumber Source field 15 import to testSubsectionTemplate::mtestSubsection Source field 16 import to testSubsectionTemplate::ktestItemGroup Source field 17 import to testSubsectionTemplate::rule Source field 18 import to testSubsectionTemplate::kcreatorNode Source field 19 import to testSubsectionTemplate::kmodifierNode Source field 20 import to testSubsectionTemplate::RecordModifyDate Source field 21 import to testSubsectionTemplate::nameSpelling Source field 22 import to testSubsectionTemplate::form ] [ No dialog ]
    Else
    Import Records [ Source: “$filepath”; Target: “testSubsectionTemplate”; Method: Update matching; Add remaining; Character Set: “Unicode”; Field Mapping: Source field 1 match with testSubsectionTemplate::_LtestSubsection Source field 2 import to testSubsectionTemplate::ksubsectionGroup Source field 3 import to testSubsectionTemplate::_number Source field 4 import to testSubsectionTemplate::kcsections Source field 5 import to testSubsectionTemplate::name Source field 6 import to testSubsectionTemplate::order Source field 7 import to testSubsectionTemplate::retire Source field 8 import to testSubsectionTemplate::kgtestSubject Source field 9 import to testSubsectionTemplate::gtestSectionNameGlobal Source field 10 import to testSubsectionTemplate::gtestSubjectNameGlobal Source field 11 import to testSubsectionTemplate::kgtestSection Source field 12 import to testSubsectionTemplate::gprogressGlobal Source field 13 import to testSubsectionTemplate::klibrary Source field 14 import to testSubsectionTemplate::kgreportNumber Source field 15 import to testSubsectionTemplate::mtestSubsection Source field 16 import to testSubsectionTemplate::ktestItemGroup Source field 17 import to testSubsectionTemplate::rule Source field 18 import to testSubsectionTemplate::kcreatorNode Source field 19 import to testSubsectionTemplate::kmodifierNode Source field 20 import to testSubsectionTemplate::RecordModifyDate Source field 21 import to testSubsectionTemplate::nameSpelling Source field 22 import to testSubsectionTemplate::form ] [ No dialog ]
    End If
    #
    #
    #3) Import learn and test result records.
    Go to Layout [ “tableTestLearn” (testlearn) ]
    Show All Records
    If [ Get (FoundCount) = 0 ]
    Import Records [ Source: “$filepath”; Target: “testlearn”; Method: Add; Character Set: “Unicode”; Field Mapping: Source field 1 import to testlearn::_Ltestlearn Source field 2 import to testlearn::ktestSubject Source field 3 import to testlearn::_Number Source field 4 import to testlearn::ktestSubsection Source field 5 import to testlearn::note Source field 6 import to testlearn::picture Source field 7 import to testlearn::subsectionCustomName Source field 8 import to testlearn::kcInUseOnReportSubsection Source field 9 import to testlearn::ktestSection Source field 10 import to testlearn::countOfALLSubsectionsTestResults Source field 11 import to testlearn::checkboxCaption Source field 12 import to testlearn::recordnumberglobal Source field 13 import to testlearn::recordcountglobal Source field 14 import to testlearn::countOfONESubsectionsTestResults Source field 15 import to testlearn::rateORgradeTestResult Source field 16 import to testlearn::kclibrary Source field 17 import to testlearn::kshowReferencedMedia Source field 18 import to testlearn::kreportNumber Source field 19 import to testlearn::timestamp Source field 21 import to testlearn::orderTestResult Source field 22 import to testlearn::kcKeywordOther Source field 23 import to testlearn::kNodeOther Source field 24 import to testlearn::kcopyright Source field 25 import to testlearn::kNodePrimary Source field 26 import to testlearn::kKeywordPrimary Source field 27 import to testlearn::OtherKeyWords Source field 28 import to testlearn::NodeOthers Source field 29 import to testlearn::URL Source field 30 import to testlearn::kcreference Source field 32 import to testlearn::filterFind Source field 33 import to testlearn::kRecordCreatorNode Source field 34 import to testlearn::kRecordModifierNode Source field 35 import to testlearn::dateModify Source field 36 import to testlearn::incomplete Source field 38 import to testlearn::copyrightYear Source field 39 import to testlearn::kcbrainstorm Source field 40 import to testlearn::kgtestSection Source field 41 import to testlearn::kctestSubsectionInfo Source field 42 import to testlearn::orderTestInformation Source field 43 import to testlearn::kctestResultCheckedItems Source field 45 import to testlearn::brainstormCasePoint Source field 48 import to testlearn::pictureThumbnail ] [ No dialog ]
    Else
    Import Records [ Source: “$filepath”; Target: “testlearn”; Method: Update matching; Add remaining; Character Set: “Unicode”; Field Mapping: Source field 1 match with testlearn::_Ltestlearn Source field 2 import to testlearn::ktestSubject Source field 3 import to testlearn::_Number Source field 4 import to testlearn::ktestSubsection Source field 5 import to testlearn::note Source field 6 import to testlearn::picture Source field 7 import to testlearn::subsectionCustomName Source field 8 import to testlearn::kcInUseOnReportSubsection Source field 9 import to testlearn::ktestSection Source field 10 import to testlearn::countOfALLSubsectionsTestResults Source field 11 import to testlearn::checkboxCaption Source field 12 import to testlearn::recordnumberglobal Source field 13 import to testlearn::recordcountglobal Source field 14 import to testlearn::countOfONESubsectionsTestResults Source field 15 import to testlearn::rateORgradeTestResult Source field 16 import to testlearn::kclibrary Source field 17 import to testlearn::kshowReferencedMedia Source field 18 import to testlearn::kreportNumber Source field 19 import to testlearn::timestamp Source field 21 import to testlearn::orderTestResult Source field 22 import to testlearn::kcKeywordOther Source field 23 import to testlearn::kNodeOther Source field 24 import to testlearn::kcopyright Source field 25 import to testlearn::kNodePrimary Source field 26 import to testlearn::kKeywordPrimary Source field 27 import to testlearn::OtherKeyWords Source field 28 import to testlearn::NodeOthers Source field 29 import to testlearn::URL Source field 30 import to testlearn::kcreference Source field 32 import to testlearn::filterFind Source field 33 import to testlearn::kRecordCreatorNode Source field 34 import to testlearn::kRecordModifierNode Source field 35 import to testlearn::dateModify Source field 36 import to testlearn::incomplete Source field 38 import to testlearn::copyrightYear Source field 39 import to testlearn::kcbrainstorm Source field 40 import to testlearn::kgtestSection Source field 41 import to testlearn::kctestSubsectionInfo Source field 42 import to testlearn::orderTestInformation Source field 43 import to testlearn::kctestResultCheckedItems Source field 45 import to testlearn::brainstormCasePoint Source field 48 import to testlearn::pictureThumbnail ] [ No dialog ]
    End If
    #
    #
    #4) Import LIBRARY SETUP reference records.
    Go to Layout [ “tableSetupReference” (setupReference) ]
    Show All Records
    If [ Get (FoundCount) = 0 ]
    Import Records [ Source: “$filepath”; Target: “setupReference”; Method: Add; Character Set: “Unicode”; Field Mapping: Source field 1 import to setupReference::_LlibrarySetupHowToCredit Source field 2 import to setupReference::_Number Source field 3 import to setupReference::URL Source field 4 import to setupReference::publicationDate Source field 5 import to setupReference::kcreatorNode Source field 6 import to setupReference::name Source field 7 import to setupReference::password Source field 8 import to setupReference::klibrary Source field 9 import to setupReference::version Source field 13 import to setupReference::creatorName Source field 14 import to setupReference::note ] [ No dialog ]
    Else
    Import Records [ Source: “$filepath”; Target: “setupReference”; Method: Update matching; Add remaining; Character Set: “Unicode”; Field Mapping: Source field 1 match with setupReference::_LlibrarySetupHowToCredit Source field 2 import to setupReference::_Number Source field 3 import to setupReference::URL Source field 4 import to setupReference::publicationDate Source field 5 import to setupReference::kcreatorNode Source field 6 import to setupReference::name Source field 7 import to setupReference::password Source field 8 import to setupReference::klibrary Source field 9 import to setupReference::version Source field 13 import to setupReference::creatorName Source field 14 import to setupReference::note ] [ No dialog ]
    End If
    #
    #
    #5) Import tag records.
    Go to Layout [ “tableTag” (tagTable) ]
    Show All Records
    If [ Get (FoundCount) = 0 ]
    Import Records [ Source: “$filepath”; Target: “tagTable”; Method: Add; Character Set: “Unicode”; Field Mapping: Source field 1 import to tagTable::kGroupOrTest Source field 2 import to tagTable::_Ltag Source field 3 import to tagTable::tag Source field 4 import to tagTable::orderOrLock Source field 5 import to tagTable::textStyleOrCreatorNodeFlag Source field 6 import to tagTable::_Number Source field 7 import to tagTable::match Source field 8 import to tagTable::tagSpelling Source field 9 import to tagTable::Kpicture1 Source field 10 import to tagTable::notesOrCopyright Source field 11 import to tagTable::Ktitle1 Source field 12 import to tagTable::kfileORkTestItemCreatorNode Source field 14 import to tagTable::Kpicture2 Source field 16 import to tagTable::Kpicture3 Source field 18 import to tagTable::Ktitle2 Source field 19 import to tagTable::Ktitle3 Source field 23 import to tagTable::kRecordCreatorNode Source field 24 import to tagTable::notesForKeyandNodeTags ] [ No dialog ]
    Else
    Import Records [ Source: “$filepath”; Target: “tagTable”; Method: Update matching; Add remaining; Character Set: “Unicode”; Field Mapping: Source field 1 import to tagTable::kGroupOrTest Source field 2 match with tagTable::_Ltag Source field 3 import to tagTable::tag Source field 4 import to tagTable::orderOrLock Source field 5 import to tagTable::textStyleOrCreatorNodeFlag Source field 6 import to tagTable::_Number Source field 7 import to tagTable::match Source field 8 import to tagTable::tagSpelling Source field 9 import to tagTable::Kpicture1 Source field 10 import to tagTable::notesOrCopyright Source field 11 import to tagTable::Ktitle1 Source field 12 import to tagTable::kfileORkTestItemCreatorNode Source field 14 import to tagTable::Kpicture2 Source field 16 import to tagTable::Kpicture3 Source field 18 import to tagTable::Ktitle2 Source field 19 import to tagTable::Ktitle3 Source field 23 import to tagTable::kRecordCreatorNode Source field 24 import to tagTable::notesForKeyandNodeTags ] [ No dialog ]
    End If
    #
    #Update primary node just in case it was
    #changed by the import.
    If [ TEMP::kdefaultNodePrimary ≠ "" ]
    Enter Find Mode [ ]
    Set Field [ tagTable::_Ltag; TEMP::kdefaultNodePrimary ]
    Perform Find [ ]
    If [ tagTable::_Ltag = TEMP::kdefaultNodePrimary ]
    Set Field [ TEMP::DEFAULTNodePrimaryName; tagTable::tag ]
    End If
    End If
    #
    #Update test subject node just in case it was
    #changed by the import.
    If [ TEMP::kdefaultNodeTestSubject ≠ "" ]
    Enter Find Mode [ ]
    Set Field [ tagTable::_Ltag; TEMP::kdefaultNodeTestSubject ]
    Perform Find [ ]
    If [ tagTable::_Ltag = TEMP::kdefaultNodeTestSubject ]
    Set Field [ TEMP::DEFAULTNodeTestSubjectName; tagTable::tag ]
    End If
    End If
    #
    #
    #6) Import tag group records.
    #
    #Get this library's ID and name. It will be
    #checked for changes after import.
    Go to Layout [ “tableTagGroup” (testSubsectionGroup) ]
    Show All Records
    If [ Get (FoundCount) = 0 ]
    Import Records [ Source: “$filepath”; Target: “testSubsectionGroup”; Method: Add; Character Set: “Unicode”; Field Mapping: Source field 1 import to testSubsectionGroup::_Lgroup Source field 2 import to testSubsectionGroup::_Number Source field 3 import to testSubsectionGroup::match Source field 4 import to testSubsectionGroup::name Source field 5 import to testSubsectionGroup::klibrary Source field 6 import to testSubsectionGroup::nameSpellingFORTestItemGroup Source field 7 import to testSubsectionGroup::testReportPicture Source field 8 import to testSubsectionGroup::ReportCaptionORLibraryCreatorName Source field 9 import to testSubsectionGroup::URLOrCopyrightORUserLibraryVersion Source field 10 import to testSubsectionGroup::orderOrLibraryType Source field 11 import to testSubsectionGroup::nameSpellingEXCEPTForTestItemGroup Source field 12 import to testSubsectionGroup::kRecordCreatorNode Source field 13 import to testSubsectionGroup::versionNumber ] [ No dialog ]
    Else
    Import Records [ Source: “$filepath”; Target: “testSubsectionGroup”; Method: Update matching; Add remaining; Character Set: “Unicode”; Field Mapping: Source field 1 match with testSubsectionGroup::_Lgroup Source field 2 import to testSubsectionGroup::_Number Source field 3 import to testSubsectionGroup::match Source field 4 import to testSubsectionGroup::name Source field 5 import to testSubsectionGroup::klibrary Source field 6 import to testSubsectionGroup::nameSpellingFORTestItemGroup Source field 7 import to testSubsectionGroup::testReportPicture Source field 8 import to testSubsectionGroup::ReportCaptionORLibraryCreatorName Source field 9 import to testSubsectionGroup::URLOrCopyrightORUserLibraryVersion Source field 10 import to testSubsectionGroup::orderOrLibraryType Source field 11 import to testSubsectionGroup::nameSpellingEXCEPTForTestItemGroup Source field 12 import to testSubsectionGroup::kRecordCreatorNode Source field 13 import to testSubsectionGroup::versionNumber ] [ No dialog ]
    End If
    #
    #Remove imported library's libraryID record.
    Perform Find [ Specified Find Requests: Find Records; Criteria: testSubsectionGroup::match: “"library"” ] [ Restore ]
    Go to Record/Request/Page [ First ]
    Loop
    #
    If [ testSubsectionGroup::_Lgroup ≠ $libraryID ]
    Set Field [ testSubsectionGroup::orderOrLibraryType; "lock" ]
    Set Field [ testSubsectionGroup::match; "libraryIMPORTED" ]
    End If
    #
    #Check if the name of this library
    #was changed.
    If [ testSubsectionGroup::_Lgroup = $libraryID ]
    If [ testSubsectionGroup::name ≠ $$libraryNameForNameChangeCheck ]
    Set Variable [ $$libraryNameWASChanged; Value:testSubsectionGroup::name ]
    Set Field [ TEMP::userLibraryName; testSubsectionGroup::name ]
    End If
    End If
    #
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #
    #7) Import reference records.
    Go to Layout [ “tableReference” (reference) ]
    Show All Records
    #
    #Omit locked copyright records. This is
    #important to insure that the copyright records
    #being imported, perhaps from an older version
    #do not overwrite this library's copyright records.
    If [ Get (FoundCount) ≠ 0 ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: reference::lock; descending ] [ Restore; No dialog ]
    Go to Record/Request/Page [ First ]
    Loop
    If [ reference::lock = "lock" ]
    Omit Record
    End If
    Exit Loop If [ reference::lock ≠ "lock" ]
    Exit Loop If [ Get (FoundCount) = 0 ]
    End Loop
    End If
    #
    #Perform import.
    If [ Get (FoundCount) = 0 ]
    Import Records [ Source: “$filepath”; Target: “reference”; Method: Add; Character Set: “Unicode”; Field Mapping: Source field 1 import to reference::_Number Source field 2 import to reference::_Lreference Source field 3 import to reference::ktestSubject Source field 4 import to reference::ktest Source field 5 import to reference::kclibrary Source field 6 import to reference::knodePrimary Source field 7 import to reference::publicationYearOrStuffOrderNumber Source field 8 import to reference::URL Source field 9 import to reference::URLdate Source field 10 import to reference::Title Source field 11 import to reference::kpublication Source field 12 import to reference::volumeNumber Source field 13 import to reference::PubDate Source field 14 import to reference::pageNumberRange Source field 15 import to reference::kpublisher Source field 16 import to reference::OrginalCitation Source field 17 import to reference::kcopyrightType Source field 18 import to reference::kCopyright Source field 19 import to reference::kmedium Source field 20 import to reference::kkeywordOther Source field 21 import to reference::kkeywordPrimary Source field 22 import to reference::thoughtsNotesEtc Source field 23 import to reference::kfolderpath Source field 24 import to reference::fileName Source field 26 import to reference::referenceNodes Source field 27 import to reference::CopyrightYear Source field 28 import to reference::kcopyrightHolder Source field 29 import to reference::referenceDump Source field 30 import to reference::knodeOther Source field 31 import to reference::NodeOthers Source field 32 import to reference::OtherKeyWords Source field 33 import to reference::referenceNodesOLD Source field 34 import to reference::filterFind Source field 35 import to reference::picture Source field 36 import to reference::kfileLocation Source field 37 import to reference::rights Source field 38 import to reference::mFileFolderMainXorOther Source field 39 import to reference::kcitation Source field 40 import to reference::incomplete Source field 41 import to reference::lock Source field 43 import to reference::kcreatorNode Source field 44 import to reference::kmodifierNode Source field 45 import to reference::modifyDate Source field 47 import to reference::TimeRange Source field 48 import to reference::createDate Source field 49 import to reference::showInLearn Source field 50 import to reference::publicLibraryLinks Source field 51 import to reference::DOI Source field 52 import to reference::issueNumber Source field 53 import to reference::publisherLocation Source field 54 import to reference::publicationTitle Source field 55 import to reference::compilationEditors Source field 56 import to reference::kisWhat Source field 57 import to reference::kisON Source field 58 import to reference::compilationNumberOfEditors Source field 59 import to reference::publicationYearMonthRange Source field 60 import to reference::ISBN Source field 61 import to reference::pubDateOther Source field 62 import to reference::bookChapter Source field 63 import to reference::letterDate Source field 64 import to reference::compilationAbbr Source field 65 import to reference::emailRecipient Source field 66 import to reference::conferenceIntroWords Source field 67 import to reference::conferenceTitle Source field 68 import to reference::conferenceSubTitle Source field 69 import to reference::conferenceLocation Source field 70 import to reference::conferenceDate Source field 71 import to reference::otherIsOn Source field 72 import to reference::GovernmentDocInfo Source field 73 import to reference::governmentAuthor Source field 74 import to reference::ISSN Source field 75 import to reference::publisherTypeAlternative Source field 76 import to reference::copyrightOtherHolder Source field 77 import to reference::publisherTypeOther Source field 78 import to reference::pageNumberOther Source field 79 import to reference::dissertationThesisUniversity Source field 83 import to reference::showMedia Source field 84 import to reference::showMediaCode Source field 85 import to reference::PictureFileSize Source field 87 import to reference::pictureSourceSpeedLimit Source field 88 import to reference::pictureThumbnail Source field 91 import to reference::otherIsWhat ] [ No dialog ]
    Else
    Import Records [ Source: “$filepath”; Target: “reference”; Method: Update matching; Add remaining; Character Set: “Unicode”; Field Mapping: Source field 1 import to reference::_Number Source field 2 match with reference::_Lreference Source field 3 import to reference::ktestSubject Source field 4 import to reference::ktest Source field 5 import to reference::kclibrary Source field 6 import to reference::knodePrimary Source field 7 import to reference::publicationYearOrStuffOrderNumber Source field 8 import to reference::URL Source field 9 import to reference::URLdate Source field 10 import to reference::Title Source field 11 import to reference::kpublication Source field 12 import to reference::volumeNumber Source field 13 import to reference::PubDate Source field 14 import to reference::pageNumberRange Source field 15 import to reference::kpublisher Source field 16 import to reference::OrginalCitation Source field 17 import to reference::kcopyrightType Source field 18 import to reference::kCopyright Source field 19 import to reference::kmedium Source field 20 import to reference::kkeywordOther Source field 21 import to reference::kkeywordPrimary Source field 22 import to reference::thoughtsNotesEtc Source field 23 import to reference::kfolderpath Source field 24 import to reference::fileName Source field 26 import to reference::referenceNodes Source field 27 import to reference::CopyrightYear Source field 28 import to reference::kcopyrightHolder Source field 29 import to reference::referenceDump Source field 30 import to reference::knodeOther Source field 31 import to reference::NodeOthers Source field 32 import to reference::OtherKeyWords Source field 33 import to reference::referenceNodesOLD Source field 34 import to reference::filterFind Source field 35 import to reference::picture Source field 36 import to reference::kfileLocation Source field 37 import to reference::rights Source field 38 import to reference::mFileFolderMainXorOther Source field 39 import to reference::kcitation Source field 40 import to reference::incomplete Source field 41 import to reference::lock Source field 43 import to reference::kcreatorNode Source field 44 import to reference::kmodifierNode Source field 45 import to reference::modifyDate Source field 47 import to reference::TimeRange Source field 48 import to reference::createDate Source field 49 import to reference::showInLearn Source field 50 import to reference::publicLibraryLinks Source field 51 import to reference::DOI Source field 52 import to reference::issueNumber Source field 53 import to reference::publisherLocation Source field 54 import to reference::publicationTitle Source field 55 import to reference::compilationEditors Source field 56 import to reference::kisWhat Source field 57 import to reference::kisON Source field 58 import to reference::compilationNumberOfEditors Source field 59 import to reference::publicationYearMonthRange Source field 60 import to reference::ISBN Source field 61 import to reference::pubDateOther Source field 62 import to reference::bookChapter Source field 63 import to reference::letterDate Source field 64 import to reference::compilationAbbr Source field 65 import to reference::emailRecipient Source field 66 import to reference::conferenceIntroWords Source field 67 import to reference::conferenceTitle Source field 68 import to reference::conferenceSubTitle Source field 69 import to reference::conferenceLocation Source field 70 import to reference::conferenceDate Source field 71 import to reference::otherIsOn Source field 72 import to reference::GovernmentDocInfo Source field 73 import to reference::governmentAuthor Source field 74 import to reference::ISSN Source field 75 import to reference::publisherTypeAlternative Source field 76 import to reference::copyrightOtherHolder Source field 77 import to reference::publisherTypeOther Source field 78 import to reference::pageNumberOther Source field 79 import to reference::dissertationThesisUniversity Source field 83 import to reference::showMedia Source field 84 import to reference::showMediaCode Source field 85 import to reference::PictureFileSize Source field 87 import to reference::pictureSourceSpeedLimit Source field 88 import to reference::pictureThumbnail Source field 91 import to reference::otherIsWhat ] [ No dialog ]
    End If
    #
    #Now delete the imported lock copyright
    #records, to insure the latests locked
    #copyright records already in this file remain
    #the only ones.
    If [ Get (FoundCount) ≠ 0 ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: reference::lock; descending ] [ Restore; No dialog ]
    Go to Record/Request/Page [ First ]
    Loop
    If [ reference::lock = "lock" ]
    Delete Record/Request [ No dialog ]
    End If
    Exit Loop If [ reference::lock ≠ "lock" ]
    Exit Loop If [ Get (FoundCount) = 0 ]
    End Loop
    End If
    #
    #
    #8) Import report records.
    Go to Layout [ “tableReport” (report) ]
    Show All Records
    If [ Get (FoundCount) = 0 ]
    Import Records [ Source: “$filepath”; Target: “report”; Method: Add; Character Set: “Unicode”; Field Mapping: Source field 1 import to report::_Lreport Source field 2 import to report::_Number Source field 3 import to report::ktestSubject Source field 4 import to report::kTestSubjectSection Source field 5 import to report::general_info Source field 6 import to report::ktestSubsection Source field 7 import to report::kRecommendation1 Source field 8 import to report::order Source field 9 import to report::Picture Source field 10 import to report::kRecommendation2 Source field 11 import to report::kgeneralSpecificItemRecommendationID Source field 12 import to report::kTag1 Source field 13 import to report::kTestSubjectSection2 Source field 14 import to report::kTestSubjectSection3 Source field 15 import to report::kTestSubjectSection4 Source field 16 import to report::kTestSubjectSection5 Source field 17 import to report::PictureCaptionInsteadOfPicture Source field 18 import to report::note Source field 19 import to report::textPhotoRow1 Source field 20 import to report::pagenumberItem Source field 21 import to report::CurrentRecord Source field 22 import to report::kTag2 Source field 23 import to report::kTag3 Source field 24 import to report::kTag4 Source field 25 import to report::pagenumberTheme Source field 26 import to report::TOC Source field 27 import to report::TOCnumbers Source field 28 import to report::ReportCover Source field 29 import to report::ReportPDFtitle Source field 30 import to report::kreportNumber Source field 31 import to report::klibrary Source field 32 import to report::kRecordCreatorNode Source field 33 import to report::kRecordModifierNode Source field 34 import to report::RecordModifyDate Source field 35 import to report::kcopyright Source field 36 import to report::textPhotoRow2 ] [ No dialog ]
    Else
    Import Records [ Source: “$filepath”; Target: “report”; Method: Update matching; Add remaining; Character Set: “Unicode”; Field Mapping: Source field 1 match with report::_Lreport Source field 2 import to report::_Number Source field 3 import to report::ktestSubject Source field 4 import to report::kTestSubjectSection Source field 5 import to report::general_info Source field 6 import to report::ktestSubsection Source field 7 import to report::kRecommendation1 Source field 8 import to report::order Source field 9 import to report::Picture Source field 10 import to report::kRecommendation2 Source field 11 import to report::kgeneralSpecificItemRecommendationID Source field 12 import to report::kTag1 Source field 13 import to report::kTestSubjectSection2 Source field 14 import to report::kTestSubjectSection3 Source field 15 import to report::kTestSubjectSection4 Source field 16 import to report::kTestSubjectSection5 Source field 17 import to report::PictureCaptionInsteadOfPicture Source field 18 import to report::note Source field 19 import to report::textPhotoRow1 Source field 20 import to report::pagenumberItem Source field 21 import to report::CurrentRecord Source field 22 import to report::kTag2 Source field 23 import to report::kTag3 Source field 24 import to report::kTag4 Source field 25 import to report::pagenumberTheme Source field 26 import to report::TOC Source field 27 import to report::TOCnumbers Source field 28 import to report::ReportCover Source field 29 import to report::ReportPDFtitle Source field 30 import to report::kreportNumber Source field 31 import to report::klibrary Source field 32 import to report::kRecordCreatorNode Source field 33 import to report::kRecordModifierNode Source field 34 import to report::RecordModifyDate Source field 35 import to report::kcopyright Source field 36 import to report::textPhotoRow2 ] [ No dialog ]
    End If
    #
    #
    #Erase codes that trigger new
    #library creation script steps.
    Go to Layout [ “backup” (backup) ]
    Set Field [ backup::backup; "" ]
    Set Field [ backup::newLibrary; "" ]
    #
    #Inform the user the import was successful
    #after restarting the database and upload
    #the new record information.
    # This variable will trigger the success
    #dialogue box.
    Set Variable [ $$addRecords; Value:1 ]
    Go to Layout [ “defaultSetup” (librarySetupReferenceMain) ]
    #
    #Restart database to insure updated file's
    #information are used for this library's temp
    #fields and variables.
    Show Custom Dialog [ Message: "Library will now restart to reset values that could have changed due to changes made during import." ]
    Perform Script [ “startDatabase” ]
    #
    #

Fields used in this script

    tempSetup::userLibraryMainOrBranch
    TEMP::klibrary
    TEMP::userLibraryName
    TEMP::DEFAULTNodePrimaryName
    TEMP::DEFAULTNodeTestSubjectName
    tempSetup::InventoryLibraryYN
    backup::backup
    TEMP::kdefaultNodePrimary
    tagTable::_Ltag
    tagTable::tag
    TEMP::kdefaultNodeTestSubject
    testSubsectionGroup::match
    testSubsectionGroup::_Lgroup
    testSubsectionGroup::orderOrLibraryType
    testSubsectionGroup::name
    reference::lock
    backup::newLibrary

Scripts used in this script

    startDatabase

Layouts used in this script

    backup
    defaultSetup
    tableTestSectionFromTemplate
    tableTestSubsectionTemplates
    tableTestLearn
    tableSetupReference
    tableTag
    tableTagGroup
    tableReference
    tableReport

Tables used in this script

    TEMP
    TEMP
    backup
    reference
    tag
    tagGroup

Table occurrences used by this script

    TEMP
    backup
    reference
    tagTable
    tempSetup
    testSubsectionGroup
    testSectionCreatedFromATemplate
    testSectionCreatedFromATemplate
    testSubsectionTemplate
    testSubsectionTemplate
    testlearn
    testlearn
    setupReference
    setupReference
    report
    report

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [importDataFromABranchIntoThisMainLibrary]	Parent Folder: [libraryNewOrImport]	Next Script: [newLibraryStep1_CreateACopyOfThisLibraryFile]
Script Name	Interactivate
Run script with full access privileges	On
Include In Menu	No
Layouts that use this script

Scripts that use this script

    startDatabase

Script Definition
Script Steps

    #
    #
    #
    #This script forces the creation of new picture
    #thumbnails whose size is determined in the
    #pictureThumbnail field calculation. If you
    #change it, then you need to run this script to
    #see the new sized thumbnails.
    #
    #Source: http://www.teamdf.com/weetbicks/252/change-containers-from-files-to-interactive-content-in-an-instant
    #
    #!!!IMPORTANT!!!
    #Custom function required.
    #Function Name: Interactivate
    #Parameters: _container
    #Interactivate ( _container ) = Case ( _container ≠ "" ; Case ( _container ≠ "Replace Me. Media Required" ; Base64Decode ( Base64Encode ( _container ) ; GetContainerAttribute ( _container ; "FileName" ) ) ; "Replace Me. Media Required" ) )
    #
    #
    Set Variable [ $$stoploadCitation; Value:1 ]
    New Window [ Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    #
    #Update reference picture thumbnails.
    Go to Layout [ “Reference” (reference) ]
    Replace Field Contents [ reference::pictureThumbnail; Replace with calculation: Interactivate ( reference::picture ) ] [ No dialog ]
    #
    #Update testlearn picture thumbnails.
    Go to Layout [ “learn1” (testlearn) ]
    Replace Field Contents [ testlearn::picture; Replace with calculation: Interactivate ( testlearn::picture ) ] [ No dialog ]
    #
    Set Variable [ $$stoploadCitation ]
    Close Window [ Current Window ]
    #
    #

Fields used in this script

    reference::picture
    reference::pictureThumbnail
    testlearn::picture

Scripts used in this script

Layouts used in this script

    Reference
    learn1

Tables used in this script

    reference
    testlearn

Table occurrences used by this script

    reference
    testlearn

Custom Functions used by this script

    Interactivate

Custom menu set used by this script


Previous Script: [Interactivate]	Parent Folder: [libraryNewOrImport]	Next Script: [newLibraryStep2_EraseRecordsInCopyOfLibrary]
Script Name	newLibraryStep1_CreateACopyOfThisLibraryFile
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #PURPOSE: This script is step 1 of a three step
    #process for creating a copy of the current
    #library file for use as a new empty library or
    #as an upgrade library file.
    #— Admin access required. —
    # Step 1) Creates a copy of current library.
    #A copy not a clone must be created because some
    #records are neccessary to running the Library and
    #are removed when cloning the Library.
    #— Admin access required. —
    # Step 2) When user opens the copy that this
    #script creates, the createEmptyLibrary script
    #erases the copy's records preparing it to
    #become an empty library or an upgrade file
    #of the library ready for sharing.
    #— Regular user access —
    # Step 3 A) Create new library name
    #and node records and begin to use the library
    #file as a new library, OR B) Import records
    #from an older library and use library file as an
    #upgrade library file.
    #
    #
    #Admin tasks.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #
    #BEGIN STEP 1: Create a copy of this library.
    #
    #Make sure the admin user wants to create
    #a new library file.
    Show Custom Dialog [ Message: "Create a newlibrary?"; Default Button: “OK”, Commit: “No”; Button 2: “cancel”, Commit: “No” ]
    #
    #If admin user clicks cancel then exit
    #this script.
    If [ Get ( LastMessageChoice ) = 2 ]
    Exit Script [ ]
    End If
    #
    #Set code for library erasure, so when opened,
    #the copy of this library will read this code and
    #begin the process of erasing all data in
    #the copy.
    Go to Layout [ “backup” (backup) ]
    Delete All Records [ No dialog ]
    New Record/Request
    Set Field [ backup::newLibrary; "234874920347574weidf792342f9823984" ]
    #
    #Go to main library layout to give user a nice
    #background against which to show the
    #dialogue boxes.
    Go to Layout [ “defaultSetup” (librarySetupReferenceMain) ]
    #
    #Ask user to create the necessary folders for
    #the new library file's files.
    Show Custom Dialog [ Message: "Create a folder for this new library in your library folder. Then create another new folder, in that folder, and name it 'x'. DO THIS NOW."; Default Button: “OK”, Commit: “Yes”; Button 2: “cancel”, Commit: “No” ]
    #
    #If admin user clicks cancel then exit
    #this script.
    If [ Get ( LastMessageChoice ) = 2 ]
    Go to Layout [ “backup” (backup) ]
    Set Field [ backup::newLibrary; "" ]
    Go to Layout [ “defaultSetup” (librarySetupReferenceMain) ]
    Exit Script [ ]
    End If
    #
    #Tell the user to put the copy of this library
    #file into the newly created folder.
    Show Custom Dialog [ Message: "When asked next where to put your new library, select the new library folder that you just created (with the empty folder named 'x' inside it)."; Default Button: “OK”, Commit: “Yes”; Button 2: “cancel”, Commit: “No” ]
    #
    #If admin user clicks cancel then exit
    #this script.
    If [ Get ( LastMessageChoice ) = 2 ]
    Go to Layout [ “backup” (backup) ]
    Set Field [ backup::newLibrary; "" ]
    Go to Layout [ “defaultSetup” (librarySetupReferenceMain) ]
    Exit Script [ ]
    End If
    #
    #Create a copy of this library file.
    Save a Copy as [ ] [ copy of current file ]
    #
    #If admin user clicks cancel then exit
    #this script.
    If [ Get ( LastError ) = 1 ]
    Go to Layout [ “backup” (backup) ]
    Set Field [ backup::newLibrary; "" ]
    Go to Layout [ “defaultSetup” (librarySetupReferenceMain) ]
    Exit Script [ ]
    End If
    #
    #To insure that this orginal flie does not get
    #erased when started, remove the erase code.
    Go to Layout [ “backup” (backup) ]
    Set Field [ backup::newLibrary; "" ]
    Go to Layout [ “defaultSetup” (librarySetupReferenceMain) ]
    #
    #Close this file and inform user to now open
    #their copy of this library just created and set
    #it up = erase its records.
    Show Custom Dialog [ Message: "This library will now close. Go to your new library's folder. Name your new library file. Double click it to start it up. Allow it to delete its files, which are duplicates of this library's files."; Default Button: “OK”, Commit: “Yes” ]
    #
    #Close all open windows, which will
    #close this library.
    Perform Script [ “closeLibrary” ]
    #
    #END STEP 1: Create a copy of this library.
    #
    #

Fields used in this script

    backup::newLibrary

Scripts used in this script

    closeLibrary

Layouts used in this script

    backup
    defaultSetup

Tables used in this script

    backup

Table occurrences used by this script

    backup

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [newLibraryStep1_CreateACopyOfThisLibraryFile]	Parent Folder: [libraryNewOrImport]	Next Script: [newLibraryStep3A_makeEmptiedLibraryANewLibrary]
Script Name	newLibraryStep2_EraseRecordsInCopyOfLibrary
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    startDatabase

Script Definition
Script Steps

    #
    #
    #PURPOSE: This script is step 2 of a three step
    #process for creating a copy of the current
    #library file for use as a new empty library or
    #as an upgrade library file.
    #— Admin access required. —
    # Step 1) Creates a copy of current library.
    #A copy not a clone must be created because some
    #records are neccessary to running the Library and
    #are removed when cloning the Library.
    #— Admin access required. —
    # Step 2) When user opens the copy that this
    #script creates, the createEmptyLibrary script
    #erases the copy's records preparing it to
    #become an empty library or an upgrade file
    #of the library ready for sharing.
    #— Regular user access —
    # Step 3 A) Create new library name
    #and node records and begin to use the library
    #file as a new library, OR B) Import records
    #from an older library and use library file as an
    #upgrade library file.
    #
    #
    #BEGIN STEP 2: Erase library copy's records.
    #
    #Admin tasks.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    #
    #If this is an old library full of data, then
    #prepare to erase it and turn it into a new/
    #empty library. This will be true when an
    #admin user triggers this script from the
    #script menu.
    // If [ backup::newLibrary = "234874920347574weidf792342f9823984" ]
    #
    #Go the library's main layout and insure that
    #their is only on record to show.
    Go to Layout [ “defaultsAll” (tempSetup) ]
    Show All Records
    Delete All Records [ No dialog ]
    New Record/Request
    #
    #In the past errors occurred where the orginal
    #library file crashed before the above erase
    #library variable could be removed. This
    #dialogue box allows the admin user to
    #remove this erase variable from the current
    #libary by clicking stop. Once, the libary can
    #be opened and will function normally. If the
    #admin user really wanted to erase the this
    #library's data, they will have to start the
    #create-new-library process all over again.
    Show Custom Dialog [ Message: "Are you sure you want to delete the data in " & tempSetup::fileNameOnALLDefaultsLayout & " to make it a new empty one? If you are not sure, DO NOT CLICK any of the buttons. Instead, check the folder where this library is located and make sure this is a copy of the orignal and not the original. Next click either the stop or proceed button."; Default Button: “stop”, Commit: “Yes”; Button 2: “proceed”, Commit: “No” ]
    #
    #If the admin user clicks stop then remove the
    #erase variable turning this library into a
    #normal library with all its data intact.
    If [ Get ( LastMessageChoice ) = 1 ]
    Go to Layout [ “backup” (backup) ]
    Set Field [ backup::newLibrary; "" ]
    Go to Layout [ “defaultSetup” (librarySetupReferenceMain) ]
    Exit Script [ ]
    End If
    #
    #If user clicks proceed then continue with
    #step 2 and erase this library's data.
    #
    #Clear all temp records fields, which hold data
    #from the records that will be deleted next.
    Go to Layout [ “tableTemp” (TEMP) ]
    New Record/Request
    Go to Field [ TEMP::addTestItemGroup ]
    Loop
    Set Field [ "" ]
    Go to Next Field
    Exit Loop If [ Get ( ActiveFieldName ) = "addTestItemGroup" ]
    End Loop
    #
    #
    #1) Delete test section records.
    Go to Layout [ “tableTestSectionFromTemplate” (testSectionCreatedFromATemplate) ]
    Show All Records
    Delete All Records [ No dialog ]
    #
    #
    #2) Delete test subsection records.
    Go to Layout [ “tableTestSubsectionTemplates” (testSubsectionTemplate) ]
    Show All Records
    Delete All Records [ No dialog ]
    #
    #
    #3) Delete learn and test result records.
    Go to Layout [ “tableTestLearn” (testlearn) ]
    Show All Records
    Delete All Records [ No dialog ]
    #
    #
    #4) Delete LIBRARY SETUP reference records.
    Go to Layout [ “tableSetupReference” (setupReference) ]
    Show All Records
    Delete All Records [ No dialog ]
    #
    #
    #5) Delete tag records.
    Go to Layout [ “tableTag” (tagTable) ]
    Show All Records
    Delete All Records [ No dialog ]
    #
    #
    #6) Delete tag group records.
    Go to Layout [ “tableTagGroup” (testSubsectionGroup) ]
    Show All Records
    Delete All Records [ No dialog ]
    #
    #
    #7) Delete reference records.
    Go to Layout [ “tableReference” (reference) ]
    #
    #Remove reference records containing
    #copyright symbol images and links used
    #by the default copyright tag records.
    Enter Find Mode [ ]
    Set Field [ reference::lock; "lock" ]
    Perform Find [ ]
    Show Omitted Only
    Delete All Records [ No dialog ]
    #
    #
    #8) Delete report records.
    Go to Layout [ “tableReport” (report) ]
    Show All Records
    Delete All Records [ No dialog ]
    #
    #
    #Note that this a fresh library ready to be
    #used as a new library or to accept the data
    #from an old library (as is the case when
    #upgrading from an old to a new version of
    #the Library).
    Go to Layout [ “backup” (backup) ]
    Set Field [ backup::newLibrary; "newLibrary" ]
    #
    #Go to the default main layout for the final
    #script steps.
    Go to Layout [ “defaultsAll” (tempSetup) ]
    #
    #Make sure to clear the library type field else
    #user may see both idea and thing library
    #checkboxes checked for this library file.
    Set Field [ tempSetup::InventoryLibraryYN; "" ]
    Set Field [ tempSetup::InventoryLibraryYN[2]; "" ]
    #
    #Close this library and instruct user to
    #restart it. (Due to import failures/crashes
    #during import it is essential to create
    #mutliple copies of a new library file before
    #attempting to import an old library into it.)
    Show Custom Dialog [ Message: "This library is now ready for use. It will close. When users next open it they will be asked if they want to use it as a new library or import records from an old Library file into it."; Default Button: “OK”, Commit: “Yes” ]
    Perform Script [ “closeLibrary” ]
    #
    // End If
    #
    #END STEP 2: Erase library copy's records.
    #
    #

Fields used in this script

    backup::newLibrary
    tempSetup::fileNameOnALLDefaultsLayout
    TEMP::addTestItemGroup
    reference::lock
    tempSetup::InventoryLibraryYN

Scripts used in this script

    closeLibrary

Layouts used in this script

    defaultsAll
    backup
    defaultSetup
    tableTemp
    tableTestSectionFromTemplate
    tableTestSubsectionTemplates
    tableTestLearn
    tableSetupReference
    tableTag
    tableTagGroup
    tableReference
    tableReport

Tables used in this script

    TEMP
    TEMP
    backup
    reference

Table occurrences used by this script

    TEMP
    backup
    reference
    tempSetup

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [newLibraryStep2_EraseRecordsInCopyOfLibrary]	Parent Folder: [libraryNewOrImport]	Next Script: [newLibraryStep3B_importLibraryIntoEmptiedLibrary]
Script Name	newLibraryStep3A_makeEmptiedLibraryANewLibrary
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    startDatabase

Script Definition
Script Steps

    #
    #
    #PURPOSE: This script is step 3A of a three step
    #process for creating a copy of the current
    #library file for use as a new empty library or
    #as an upgrade library file.
    #— Admin access required. —
    # Step 1) Creates a copy of current library.
    #A copy not a clone must be created because some
    #records are neccessary to running the Library and
    #are removed when cloning the Library.
    #— Admin access required. —
    # Step 2) When user opens the copy that this
    #script creates, the createEmptyLibrary script
    #erases the copy's records preparing it to
    #become an empty library or an upgrade file
    #of the library ready for sharing.
    #— Regular user access —
    # Step 3 A) Create new library name
    #and node records and begin to use the library
    #file as a new library, OR B) Import records
    #from an older library and use library file as an
    #upgrade library file.
    #
    #
    #BEGIN STEP 3A: Create new library records.
    #
    #1) Create a node group. Do this first as its ID
    #is needed for both the primary node that
    #needs to be created and the library name
    #and info record.
    Go to Layout [ “tableTagGroup” (testSubsectionGroup) ]
    New Record/Request
    Set Field [ testSubsectionGroup::match; "node" ]
    Set Field [ testSubsectionGroup::orderOrLibraryType; "001" ]
    Set Field [ testSubsectionGroup::name; "record creators and test subjects" ]
    Set Field [ testSubsectionGroup::nameSpellingEXCEPTForTestItemGroup; "record creators and test subjects" ]
    Commit Records/Requests [ Skip data entry validation; No dialog ]
    Set Variable [ $group; Value:testSubsectionGroup::_Lgroup ]
    Set Variable [ $groupName; Value:testSubsectionGroup::name ]
    #
    #2) Create the library name and info record,
    #and add group ID and name to it.
    New Record/Request
    Set Field [ testSubsectionGroup::orderOrLibraryType; $group ]
    Set Field [ testSubsectionGroup::nameSpellingFORTestItemGroup; $groupName ]
    Set Field [ testSubsectionGroup::match; "library" ]
    Set Field [ testSubsectionGroup::name; "New Library" ]
    Set Field [ testSubsectionGroup::nameSpellingEXCEPTForTestItemGroup; "New Library" ]
    Set Field [ testSubsectionGroup::versionNumber; "" ]
    Commit Records/Requests [ Skip data entry validation; No dialog ]
    #
    #3) Create the library's first node, and assign
    #it to the library's first group, and make it the
    #primary/author node for new library records.
    Go to Layout [ “tableTag” (tagTable) ]
    New Record/Request
    Set Field [ tagTable::match; "node" ]
    Set Field [ tagTable::kGroupOrTest; $group ]
    Set Field [ tagTable::tag; "LastName, FirstName" ]
    Set Field [ tagTable::tagSpelling; "LastName, FirstName" ]
    #
    #In Setup section only show creator nodes,
    #as these are the only nodes that can create
    #or edit library records.
    Set Field [ tagTable::textStyleOrCreatorNodeFlag; 123456789 ]
    Commit Records/Requests [ Skip data entry validation; No dialog ]
    #
    #Now set node variables.
    Set Variable [ $node; Value:tagTable::_Ltag ]
    Set Variable [ $nodeName; Value:tagTable::tag ]
    Set Field [ tagTable::kRecordCreatorNode; $node ]
    Set Field [ TEMP::kdefaultNodePrimary; $node ]
    Set Field [ TEMP::DEFAULTNodePrimaryName; $nodeName ]
    #
    #4) Make the new node the creator of the
    #first node group, and the library too.
    Go to Layout [ “tableTagGroup” (testSubsectionGroup) ]
    Perform Find [ Specified Find Requests: Find Records; Criteria: testSubsectionGroup::match: “"node"” ] [ Restore ]
    Set Field [ testSubsectionGroup::kRecordCreatorNode; $node ]
    Perform Find [ Specified Find Requests: Find Records; Criteria: testSubsectionGroup::match: “"library"” ] [ Restore ]
    Set Field [ testSubsectionGroup::kRecordCreatorNode; $node ]
    Set Field [ testSubsectionGroup::ReportCaptionORLibraryCreatorName; $nodeName ]
    #
    #
    #Erase codes that trigger new
    #library creation script steps.
    Go to Layout [ “backup” (backup) ]
    Delete All Records [ No dialog ]
    New Record/Request
    Set Field [ backup::backup; "" ]
    Set Field [ backup::newLibrary; "" ]
    #
    #Complete new library by restarting it, loading
    #up the newly created data, telling the user
    #to change the primary node's name, select
    #the copyright for new records, and
    #change the name of library X.
    # This variable will trigger these final steps
    #found at the end of startDatabase script.
    Set Variable [ $$newLibraryNextSteps; Value:1 ]
    Perform Script [ “startDatabase” ]
    #
    #END STEP 3A: Create new library records.
    #
    #

Fields used in this script

    testSubsectionGroup::match
    testSubsectionGroup::orderOrLibraryType
    testSubsectionGroup::name
    testSubsectionGroup::nameSpellingEXCEPTForTestItemGroup
    testSubsectionGroup::_Lgroup
    testSubsectionGroup::nameSpellingFORTestItemGroup
    testSubsectionGroup::versionNumber
    tagTable::match
    tagTable::kGroupOrTest
    tagTable::tag
    tagTable::tagSpelling
    tagTable::textStyleOrCreatorNodeFlag
    tagTable::_Ltag
    tagTable::kRecordCreatorNode
    TEMP::kdefaultNodePrimary
    TEMP::DEFAULTNodePrimaryName
    testSubsectionGroup::kRecordCreatorNode
    testSubsectionGroup::ReportCaptionORLibraryCreatorName
    backup::backup
    backup::newLibrary

Scripts used in this script

    startDatabase

Layouts used in this script

    tableTagGroup
    tableTag
    backup

Tables used in this script

    TEMP
    backup
    tag
    tagGroup

Table occurrences used by this script

    TEMP
    backup
    tagTable
    testSubsectionGroup

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [newLibraryStep3A_makeEmptiedLibraryANewLibrary]	Parent Folder: [libraryNewOrImport]
Script Name	newLibraryStep3B_importLibraryIntoEmptiedLibrary
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    startDatabase

Script Definition
Script Steps

    #
    #
    #PURPOSE: This script is step 3B of a three step
    #process for creating a copy of the current
    #library file for use as a new empty library or
    #as an upgrade library file.
    #— Admin access required. —
    # Step 1) Creates a copy of current library.
    #A copy not a clone must be created because some
    #records are neccessary to running the Library and
    #are removed when cloning the Library.
    #— Admin access required. —
    # Step 2) When user opens the copy that this
    #script creates, the createEmptyLibrary script
    #erases the copy's records preparing it to
    #become an empty library or an upgrade file
    #of the library ready for sharing.
    #— Regular user access —
    # Step 3 A) Create new library name
    #and node records and begin to use the library
    #file as a new library, OR B) Import records
    #from an older library and use library file as an
    #upgrade library file.
    #
    #
    #BEGIN STEP 3B: Upgrade (import) old library.
    #
    #Admin tasks.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #Inform user crashing issue when importing.
    Show Custom Dialog [ Message: "On some imports FileMaker crashes. So, makes sure you have a duplicate of this Empty Library file before proceeding (cancel and duplicate if you don't)."; Default Button: “OK”, Commit: “Yes”; Button 2: “cancel”, Commit: “No” ]
    If [ Get ( LastMessageChoice ) = 2 ]
    Show Custom Dialog [ Message: "When you are ready to decide what to do with this empty library re-open it. This library will now close."; Default Button: “OK”, Commit: “Yes” ]
    Close Window [ Current Window ]
    Exit Script [ ]
    End If
    Show Custom Dialog [ Message: "Do not be discouraged if FileMaker crashes several times in a row. Eventually, it will work. Always delete the crashed library, and use a fresh copy for your import."; Default Button: “OK”, Commit: “Yes”; Button 2: “cancel”, Commit: “No” ]
    If [ Get ( LastMessageChoice ) = 2 ]
    Show Custom Dialog [ Message: "When you are ready to decide what to do with this empty library re-open it. This library will now close."; Default Button: “OK”, Commit: “Yes” ]
    Close Window [ Current Window ]
    Exit Script [ ]
    End If
    Show Custom Dialog [ Message: "If it does crash, delete the crashed library file, and try again."; Default Button: “OK”, Commit: “Yes”; Button 2: “cancel”, Commit: “No” ]
    If [ Get ( LastMessageChoice ) = 2 ]
    Show Custom Dialog [ Message: "When you are ready to decide what to do with this empty library re-open it. This library will now close."; Default Button: “OK”, Commit: “Yes” ]
    Close Window [ Current Window ]
    Exit Script [ ]
    End If
    #
    #Get path of library that user wants to import
    #files from by generating this code and
    #cuting it using the computer's clipboard so
    #it can be pasted by the library the user is now
    #opening (the one they want to import files
    #from).
    Go to Layout [ “backup” (backup) ]
    Delete All Records [ No dialog ]
    New Record/Request
    Set Field [ backup::backup; "0update439asdkc;liasdu;irejf.as.dkfupea;lksdfa,sm.eupqoiwendssasdeawsrre5o983498woeirf" ]
    #
    #Cut instead of copy, saves the step of erasing
    #this code from the current file, as the cut
    #command both copies and erases the code.
    Cut [ backup::backup ] [ Select ]
    Commit Records/Requests [ Skip data entry validation; No dialog ]
    #
    #Ask the user what file they want to
    #import from. Because it is an (unknown) file,
    #the user will be prompted to select this file.
    Go to Layout [ “defaultSetup” (librarySetupReferenceMain) ]
    Open File [ <unknown> ]
    #
    #If the user cancels the file selection process,
    #then exit this script, and close the library.
    #The library cannot be used until the user
    #either imports an old library's records into it
    #or sets it up as a new library.
    If [ Get (LastError) = 1 ]
    Show Custom Dialog [ Message: "When you are ready to decide what to do with this empty library re-open it. This library will now close."; Default Button: “OK”, Commit: “Yes” ]
    Close Window [ Current Window ]
    Exit Script [ ]
    End If
    #
    #Make sure the file the user selected to import
    #from was opened and its filepath copied. If it
    #was already open, then this script did not
    #open it and its startDatabase script did not
    #just run and insert this code, which would
    #have resulted in its filepath being copied by
    #the computer's clipboard. Thus the
    #computer's clipboard will still contain the
    #copy-filepath code, instead of the file's
    #filepath.
    Go to Layout [ “backup” (backup) ]
    Paste [ backup::backup ] [ Select; No style ]
    If [ "0update439asdkc;liasdu;irejf.as.dkfupea;lksdfa,sm.eupqoiwendssasdeawsrre5o983498woeirf" = backup::backup ]
    #
    #Tell the user the import failed and how to
    #succeed. Then restart the library to all the
    #user to try again.
    Show Custom Dialog [ Message: "Close the library whose records you wish to import and try the import process again."; Default Button: “OK”, Commit: “Yes” ]
    Set Field [ backup::backup; "" ]
    Commit Records/Requests [ Skip data entry validation; No dialog ]
    Perform Script [ “startDatabase” ]
    Exit Script [ ]
    End If
    #
    #If the computer's clipboard contains a
    #filepath, then proceed with the import.
    Set Variable [ $filepath; Value:backup::backup ]
    #
    #
    #1) Import test section records.
    Go to Layout [ “tableTestSectionFromTemplate” (testSectionCreatedFromATemplate) ]
    Import Records [ Source: “$filepath”; Target: “testSectionCreatedFromATemplate”; Method: Add; Character Set: “Unicode”; Field Mapping: Source field 1 import to testSectionCreatedFromATemplate::ktestSubjectNode Source field 2 import to testSectionCreatedFromATemplate::ksectionTemplate Source field 3 import to testSectionCreatedFromATemplate::_LtestSection Source field 4 import to testSectionCreatedFromATemplate::name Source field 5 import to testSectionCreatedFromATemplate::inUse Source field 6 import to testSectionCreatedFromATemplate::order Source field 7 import to testSectionCreatedFromATemplate::_number Source field 8 import to testSectionCreatedFromATemplate::klibrary Source field 9 import to testSectionCreatedFromATemplate::reportNumber Source field 10 import to testSectionCreatedFromATemplate::kcreatorNode Source field 12 import to testSectionCreatedFromATemplate::creationDate Source field 13 import to testSectionCreatedFromATemplate::creationTime ] [ No dialog ]
    #
    #
    #2) Import test subsection records.
    Go to Layout [ “tableTestSubsectionTemplates” (testSubsectionTemplate) ]
    Import Records [ Source: “$filepath”; Target: “testSubsectionTemplate”; Method: Add; Character Set: “Unicode”; Field Mapping: Source field 1 import to testSubsectionTemplate::_LtestSubsection Source field 2 import to testSubsectionTemplate::ksubsectionGroup Source field 3 import to testSubsectionTemplate::_number Source field 4 import to testSubsectionTemplate::kcsections Source field 5 import to testSubsectionTemplate::name Source field 6 import to testSubsectionTemplate::order Source field 7 import to testSubsectionTemplate::retire Source field 8 import to testSubsectionTemplate::kgtestSubject Source field 9 import to testSubsectionTemplate::gtestSectionNameGlobal Source field 10 import to testSubsectionTemplate::gtestSubjectNameGlobal Source field 11 import to testSubsectionTemplate::kgtestSection Source field 12 import to testSubsectionTemplate::gprogressGlobal Source field 13 import to testSubsectionTemplate::klibrary Source field 14 import to testSubsectionTemplate::kgreportNumber Source field 15 import to testSubsectionTemplate::mtestSubsection Source field 16 import to testSubsectionTemplate::ktestItemGroup Source field 17 import to testSubsectionTemplate::rule Source field 18 import to testSubsectionTemplate::kcreatorNode Source field 19 import to testSubsectionTemplate::kmodifierNode Source field 20 import to testSubsectionTemplate::RecordModifyDate Source field 21 import to testSubsectionTemplate::nameSpelling Source field 22 import to testSubsectionTemplate::form ] [ No dialog ]
    #
    #
    #3) Import learn and test result records.
    Go to Layout [ “tableTestLearn” (testlearn) ]
    Import Records [ Source: “$filepath”; Target: “testlearn”; Method: Add; Character Set: “Unicode”; Field Mapping: Source field 1 import to testlearn::_Ltestlearn Source field 2 import to testlearn::ktestSubject Source field 3 import to testlearn::_Number Source field 4 import to testlearn::ktestSubsection Source field 5 import to testlearn::note Source field 6 import to testlearn::picture Source field 7 import to testlearn::subsectionCustomName Source field 8 import to testlearn::kcInUseOnReportSubsection Source field 9 import to testlearn::ktestSection Source field 10 import to testlearn::countOfALLSubsectionsTestResults Source field 11 import to testlearn::checkboxCaption Source field 12 import to testlearn::recordnumberglobal Source field 13 import to testlearn::recordcountglobal Source field 14 import to testlearn::countOfONESubsectionsTestResults Source field 15 import to testlearn::rateORgradeTestResult Source field 16 import to testlearn::kclibrary Source field 17 import to testlearn::kshowReferencedMedia Source field 18 import to testlearn::kreportNumber Source field 19 import to testlearn::timestamp Source field 21 import to testlearn::orderTestResult Source field 22 import to testlearn::kcKeywordOther Source field 23 import to testlearn::kNodeOther Source field 24 import to testlearn::kcopyright Source field 25 import to testlearn::kNodePrimary Source field 26 import to testlearn::kKeywordPrimary Source field 27 import to testlearn::OtherKeyWords Source field 28 import to testlearn::NodeOthers Source field 29 import to testlearn::URL Source field 30 import to testlearn::kcreference Source field 32 import to testlearn::filterFind Source field 33 import to testlearn::kRecordCreatorNode Source field 34 import to testlearn::kRecordModifierNode Source field 35 import to testlearn::dateModify Source field 36 import to testlearn::incomplete Source field 38 import to testlearn::copyrightYear Source field 39 import to testlearn::kcbrainstorm Source field 40 import to testlearn::kgtestSection Source field 41 import to testlearn::kctestSubsectionInfo Source field 42 import to testlearn::orderTestInformation Source field 43 import to testlearn::kctestResultCheckedItems Source field 45 import to testlearn::brainstormCasePoint Source field 48 import to testlearn::pictureThumbnail ] [ No dialog ]
    #
    #
    #4) Import LIBRARY SETUP reference records.
    Go to Layout [ “tableSetupReference” (setupReference) ]
    Import Records [ Source: “$filepath”; Target: “setupReference”; Method: Add; Character Set: “Unicode”; Field Mapping: Source field 1 import to setupReference::_LlibrarySetupHowToCredit Source field 2 import to setupReference::_Number Source field 3 import to setupReference::URL Source field 4 import to setupReference::publicationDate Source field 5 import to setupReference::kcreatorNode Source field 6 import to setupReference::name Source field 7 import to setupReference::password Source field 8 import to setupReference::klibrary Source field 9 import to setupReference::version Source field 13 import to setupReference::creatorName Source field 14 import to setupReference::note ] [ No dialog ]
    #
    #
    #5) Import tag records.
    Go to Layout [ “tableTag” (tagTable) ]
    Import Records [ Source: “$filepath”; Target: “tagTable”; Method: Add; Character Set: “Unicode”; Field Mapping: Source field 1 import to tagTable::kGroupOrTest Source field 2 import to tagTable::_Ltag Source field 3 import to tagTable::tag Source field 4 import to tagTable::orderOrLock Source field 5 import to tagTable::textStyleOrCreatorNodeFlag Source field 6 import to tagTable::_Number Source field 7 import to tagTable::match Source field 8 import to tagTable::tagSpelling Source field 9 import to tagTable::Kpicture1 Source field 10 import to tagTable::notesOrCopyright Source field 11 import to tagTable::Ktitle1 Source field 12 import to tagTable::kfileORkTestItemCreatorNode Source field 14 import to tagTable::Kpicture2 Source field 16 import to tagTable::Kpicture3 Source field 18 import to tagTable::Ktitle2 Source field 19 import to tagTable::Ktitle3 Source field 23 import to tagTable::kRecordCreatorNode Source field 24 import to tagTable::notesForKeyandNodeTags ] [ No dialog ]
    #
    #
    #6) Import tag group records.
    Go to Layout [ “tableTagGroup” (testSubsectionGroup) ]
    Import Records [ Source: “$filepath”; Target: “testSubsectionGroup”; Method: Add; Character Set: “Unicode”; Field Mapping: Source field 1 import to testSubsectionGroup::_Lgroup Source field 2 import to testSubsectionGroup::_Number Source field 3 import to testSubsectionGroup::match Source field 4 import to testSubsectionGroup::name Source field 5 import to testSubsectionGroup::klibrary Source field 6 import to testSubsectionGroup::nameSpellingFORTestItemGroup Source field 7 import to testSubsectionGroup::testReportPicture Source field 8 import to testSubsectionGroup::ReportCaptionORLibraryCreatorName Source field 9 import to testSubsectionGroup::URLOrCopyrightORUserLibraryVersion Source field 10 import to testSubsectionGroup::orderOrLibraryType Source field 11 import to testSubsectionGroup::nameSpellingEXCEPTForTestItemGroup Source field 12 import to testSubsectionGroup::kRecordCreatorNode Source field 13 import to testSubsectionGroup::versionNumber ] [ No dialog ]
    #
    #
    #7) Import reference records.
    #Make sure no locked reference copyright
    #records are currently found, so that after the
    #import when locked records are deleted, they
    #are duplicates from the just imported library.
    Go to Layout [ “tableReference” (reference) ]
    Omit Multiple Records [ 999 ] [ No dialog ]
    Import Records [ Source: “$filepath”; Target: “reference”; Method: Add; Character Set: “Unicode”; Field Mapping: Source field 1 import to reference::_Number Source field 2 import to reference::_Lreference Source field 3 import to reference::ktestSubject Source field 4 import to reference::ktest Source field 5 import to reference::kclibrary Source field 6 import to reference::knodePrimary Source field 7 import to reference::publicationYearOrStuffOrderNumber Source field 8 import to reference::URL Source field 9 import to reference::URLdate Source field 10 import to reference::Title Source field 11 import to reference::kpublication Source field 12 import to reference::volumeNumber Source field 13 import to reference::PubDate Source field 14 import to reference::pageNumberRange Source field 15 import to reference::kpublisher Source field 16 import to reference::OrginalCitation Source field 17 import to reference::kcopyrightType Source field 18 import to reference::kCopyright Source field 19 import to reference::kmedium Source field 20 import to reference::kkeywordOther Source field 21 import to reference::kkeywordPrimary Source field 22 import to reference::thoughtsNotesEtc Source field 23 import to reference::kfolderpath Source field 24 import to reference::fileName Source field 26 import to reference::referenceNodes Source field 27 import to reference::CopyrightYear Source field 28 import to reference::kcopyrightHolder Source field 29 import to reference::referenceDump Source field 30 import to reference::knodeOther Source field 31 import to reference::NodeOthers Source field 32 import to reference::OtherKeyWords Source field 33 import to reference::referenceNodesOLD Source field 34 import to reference::filterFind Source field 35 import to reference::picture Source field 36 import to reference::kfileLocation Source field 37 import to reference::rights Source field 38 import to reference::mFileFolderMainXorOther Source field 39 import to reference::kcitation Source field 40 import to reference::incomplete Source field 41 import to reference::lock Source field 43 import to reference::kcreatorNode Source field 44 import to reference::kmodifierNode Source field 45 import to reference::modifyDate Source field 47 import to reference::TimeRange Source field 48 import to reference::createDate Source field 49 import to reference::showInLearn Source field 50 import to reference::publicLibraryLinks Source field 51 import to reference::DOI Source field 52 import to reference::issueNumber Source field 53 import to reference::publisherLocation Source field 54 import to reference::publicationTitle Source field 55 import to reference::compilationEditors Source field 56 import to reference::kisWhat Source field 57 import to reference::kisON Source field 58 import to reference::compilationNumberOfEditors Source field 59 import to reference::publicationYearMonthRange Source field 60 import to reference::ISBN Source field 61 import to reference::pubDateOther Source field 62 import to reference::bookChapter Source field 63 import to reference::letterDate Source field 64 import to reference::compilationAbbr Source field 65 import to reference::emailRecipient Source field 66 import to reference::conferenceIntroWords Source field 67 import to reference::conferenceTitle Source field 68 import to reference::conferenceSubTitle Source field 69 import to reference::conferenceLocation Source field 70 import to reference::conferenceDate Source field 71 import to reference::otherIsOn Source field 72 import to reference::GovernmentDocInfo Source field 73 import to reference::governmentAuthor Source field 74 import to reference::ISSN Source field 75 import to reference::publisherTypeAlternative Source field 76 import to reference::copyrightOtherHolder Source field 77 import to reference::publisherTypeOther Source field 78 import to reference::pageNumberOther Source field 79 import to reference::dissertationThesisUniversity Source field 83 import to reference::showMedia Source field 84 import to reference::showMediaCode Source field 85 import to reference::PictureFileSize Source field 87 import to reference::pictureSourceSpeedLimit Source field 88 import to reference::pictureThumbnail Source field 91 import to reference::otherIsWhat ] [ No dialog ]
    #
    #Now delete the imported lock copyright
    #records, to insure the latests locked
    #copyright records already in this file remain
    #the only ones.
    If [ Get (FoundCount) ≠ 0 ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: reference::lock; descending ] [ Restore; No dialog ]
    Go to Record/Request/Page [ First ]
    Loop
    If [ reference::lock = "lock" ]
    Delete Record/Request [ No dialog ]
    End If
    Exit Loop If [ reference::lock ≠ "lock" ]
    Exit Loop If [ Get (FoundCount) = 0 ]
    End Loop
    End If
    #
    #
    #8) Import report records.
    Go to Layout [ “tableReport” (report) ]
    Import Records [ Source: “$filepath”; Target: “report”; Method: Add; Character Set: “Unicode”; Field Mapping: Source field 1 import to report::_Lreport Source field 2 import to report::_Number Source field 3 import to report::ktestSubject Source field 4 import to report::kTestSubjectSection Source field 5 import to report::general_info Source field 6 import to report::ktestSubsection Source field 7 import to report::kRecommendation1 Source field 8 import to report::order Source field 9 import to report::Picture Source field 10 import to report::kRecommendation2 Source field 11 import to report::kgeneralSpecificItemRecommendationID Source field 12 import to report::kTag1 Source field 13 import to report::kTestSubjectSection2 Source field 14 import to report::kTestSubjectSection3 Source field 15 import to report::kTestSubjectSection4 Source field 16 import to report::kTestSubjectSection5 Source field 17 import to report::PictureCaptionInsteadOfPicture Source field 18 import to report::note Source field 19 import to report::textPhotoRow1 Source field 20 import to report::pagenumberItem Source field 21 import to report::CurrentRecord Source field 22 import to report::kTag2 Source field 23 import to report::kTag3 Source field 24 import to report::kTag4 Source field 25 import to report::pagenumberTheme Source field 26 import to report::TOC Source field 27 import to report::TOCnumbers Source field 28 import to report::ReportCover Source field 29 import to report::ReportPDFtitle Source field 30 import to report::kreportNumber Source field 31 import to report::klibrary Source field 32 import to report::kRecordCreatorNode Source field 33 import to report::kRecordModifierNode Source field 34 import to report::RecordModifyDate Source field 35 import to report::kcopyright Source field 36 import to report::textPhotoRow2 ] [ No dialog ]
    #
    #
    #9) Import TEMP records.
    Go to Layout [ “tableTemp” (TEMP) ]
    Show All Records
    Delete All Records [ No dialog ]
    Import Records [ Source: “$filepath”; Target: “TEMP”; Method: Add; Character Set: “Unicode”; Field Mapping: Source field 1 import to TEMP::theme Source field 2 import to TEMP::klibrary Source field 3 import to TEMP::userLibraryName Source field 4 import to TEMP::testSubsectionNameForSubject Source field 5 import to TEMP::orderLocation Source field 6 import to TEMP::orderMod1 Source field 7 import to TEMP::orderMod2 Source field 8 import to TEMP::reportNumber Source field 9 import to TEMP::ktestItemSubsection Source field 10 import to TEMP::ktestItemSubsectionOLD Source field 11 import to TEMP::TimeStamp Source field 12 import to TEMP::ktestSection Source field 13 import to TEMP::ktestSubsection Source field 14 import to TEMP::showFavorites Source field 15 import to TEMP::kabout Source field 16 import to TEMP::mtestSubsection Source field 17 import to TEMP::DeleteMessageInTempWindow1 Source field 18 import to TEMP::mSwitch Source field 19 import to TEMP::pageNumber Source field 21 import to TEMP::import Source field 22 import to TEMP::theme Copy Source field 23 import to TEMP::newEvidenceListWindow Source field 24 import to TEMP::EvidenceItemNameAndNumber Source field 25 import to TEMP::sortKey Source field 26 import to TEMP::sortNode Source field 27 import to TEMP::sortPublisher Source field 28 import to TEMP::sortMedium Source field 29 import to TEMP::sortPath Source field 30 import to TEMP::tagName Source field 31 import to TEMP::testSubsectionName Source field 32 import to TEMP::sortPublication Source field 33 import to TEMP::sortCopyright Source field 34 import to TEMP::sortCite Source field 35 import to TEMP::layoutRtagN Source field 36 import to TEMP::layoutRtagK Source field 37 import to TEMP::layoutLtagK Source field 38 import to TEMP::layoutLtagN Source field 39 import to TEMP::sortRef Source field 40 import to TEMP::DetailmoreORLessLayout Source field 41 import to TEMP::kdefaultNodePrimary Source field 42 import to TEMP::kdefaultCopyright Source field 43 import to TEMP::kdefaultNodeOther Source field 44 import to TEMP::DEFAULTNodeOtherNames Source field 46 import to TEMP::DefaultmoreORLessLayoutNode Source field 47 import to TEMP::layoutLmain Source field 48 import to TEMP::sortBrainstorm Source field 49 import to TEMP::tempListNode Source field 50 import to TEMP::TLBrainstormSort Source field 51 import to TEMP::TLTestSort Source field 52 import to TEMP::sortTestSubsection Source field 53 import to TEMP::kdefaultNodeTestSubject Source field 55 import to TEMP::sortTestSection Source field 56 import to TEMP::pulldownAttribute Source field 57 import to TEMP::testHideFormTextItemsFTs Source field 58 import to TEMP::userLocationName Source field 59 import to TEMP::kctagTest Source field 61 import to TEMP::mtestSection Source field 62 import to TEMP::kcsubsectionSections Source field 63 import to TEMP::sortTestItem Source field 64 import to TEMP::mTestItemGroup Source field 65 import to TEMP::addTestItemGroup Source field 66 import to TEMP::ktestSubsectionName Source field 67 import to TEMP::filePathLibraryToSwitchTo Source field 68 import to TEMP::DEFAULTNodePrimaryName Source field 69 import to TEMP::textORcheck Source field 70 import to TEMP::mTag Source field 71 import to TEMP::duplicateOtherKeywords Source field 72 import to TEMP::kcbrainstorm Source field 74 import to TEMP::primaryNodeIsLocked Source field 75 import to TEMP::nodeLockedShow Source field 76 import to TEMP::paste Source field 77 import to TEMP::mCopyright Source field 79 import to TEMP::Help Source field 80 import to TEMP::helpName Source field 81 import to TEMP::InventoryLibraryYN Source field 82 import to TEMP::DEFAULTNodeTestSubjectName Source field 83 import to TEMP::Message Source field 84 import to TEMP::layoutLtagR Source field 85 import to TEMP::layoutLtagL Source field 86 import to TEMP::ReferenceFolder Source field 88 import to TEMP::HelpRepetitionNumber Source field 89 import to TEMP::HelpMessage Source field 92 import to TEMP::textDateIntialTime Source field 93 import to TEMP::DEFAULTSectionName Source field 94 import to TEMP::kdefaultSectionTemplate Source field 95 import to TEMP::passwordCheck Source field 96 import to TEMP::userLibraryMainOrBranch Source field 97 import to TEMP::DEFAULTprimaryNodeCopyrightGroup Source field 98 import to TEMP::kdefaultTestSubjectCopyright Source field 99 import to TEMP::ReferenceDump Source field 100 import to TEMP::kdefaultNodePrimaryCreator Source field 101 import to TEMP::primaryNodesCreatorNodeIsLocked Source field 103 import to TEMP::copyrightCreatorsName Source field 104 import to TEMP::testSubjectNodeIsLocked Source field 105 import to TEMP::testSubsectionHideTextItems Source field 106 import to TEMP::DeleteMessageInTempWindow2 Source field 107 import to TEMP::layoutTmain Source field 109 import to TEMP::testAndReportMainWindowHeader Source field 110 import to TEMP::testItemMenuShowTheWordLock Source field 111 import to TEMP::userLibraryVersionNumber ] [ No dialog ]
    #
    #
    #Erase codes that trigger new
    #library creation script steps.
    Go to Layout [ “backup” (backup) ]
    Delete All Records [ No dialog ]
    New Record/Request
    Set Field [ backup::backup; "" ]
    Set Field [ backup::newLibrary; "" ]
    #
    #Complete import by restarting the library,
    #loading up the imported data, telling the
    #user to pick themselves as the primary node,
    #and to select the copyright for new records.
    # This variable will trigger these final steps
    #found at the end of startDatabase script.
    Set Variable [ $$import; Value:1 ]
    Perform Script [ “startDatabase” ]
    #
    #END STEP 3B: Upgrade (import) old library.
    #
    #

Fields used in this script

    backup::backup
    reference::lock
    backup::newLibrary

Scripts used in this script

    startDatabase

Layouts used in this script

    backup
    defaultSetup
    tableTestSectionFromTemplate
    tableTestSubsectionTemplates
    tableTestLearn
    tableSetupReference
    tableTag
    tableTagGroup
    tableReference
    tableReport
    tableTemp

Tables used in this script

    backup
    reference

Table occurrences used by this script

    backup
    reference
    testSectionCreatedFromATemplate
    testSubsectionTemplate
    testlearn
    setupReference
    tagTable
    testSubsectionGroup
    report
    TEMP

Custom Functions used by this script

Custom menu set used by this script


librarySetup
	Parent Folder: [librarySetup]	Next Script: [changeLibraryName]
Script Name	allAppsMenu
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    gotoAllAppsMenuORActionLogApp

Script Definition
Script Steps

    #PURPOSE go to all solutions menu.
    #
    #
    #Set variable that will close this other apps menu
    #when the user selectes a new database, and
    Set Variable [ $$otherApps; Value:1 ]
    #
    #1 go to the edit/create layout and show all users.
    Close Window [ Name: "All Apps"; Current file ]
    New Window [ Name: "All Apps"; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “allApps” (tempSetup) ]
    Show All Records
    #
    #Size window to 100%
    Set Zoom Level [ 100%; Camera: Back; Resolution: Full ]
    Adjust Window [ Resize to Fit ]
    #
    #Pause script so user has to close this window
    #before they are allowed to anything else.
    Pause/Resume Script [ Indefinitely ]

Fields used in this script

Scripts used in this script

Layouts used in this script

    allApps

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [allAppsMenu]	Parent Folder: [librarySetup]	Next Script: [gotoBudgetPlanner]
Script Name	changeLibraryName
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #Update the temp library name field and the
    #library's backup spelling field (not is use at
    #this time because I decided the library's name
    #should not be lockable, so if remixed, the
    #shared remix can have a new name to not
    #confuse it with the original, which may be
    #composed of locked records).
    #
    #Save and capture new library name and
    #version number once the user leaves
    #either the field.
    Commit Records/Requests
    Set Variable [ $name; Value:tempSetup::userLibraryName ]
    Set Variable [ $version; Value:tempSetup::userLibraryVersionNumber ]
    #
    #Update library record.
    Go to Layout [ “tableTagGroup” (testSubsectionGroup) ]
    Enter Find Mode [ ]
    Set Field [ testSubsectionGroup::_Lgroup; TEMP::klibrary ]
    Perform Find [ ]
    Set Field [ testSubsectionGroup::name; $name ]
    Set Field [ testSubsectionGroup::nameSpellingEXCEPTForTestItemGroup; $name ]
    If [ $version ≠ "" ]
    Set Field [ testSubsectionGroup::versionNumber; $version ]
    Else
    Set Field [ testSubsectionGroup::versionNumber; "" ]
    End If
    Go to Layout [ “defaultSetup” (librarySetupReferenceMain) ]
    #
    #Make sure users understand that this field is
    #for this copy only, whereas the library setup
    #reference records travel with each copy.
    Show Custom Dialog [ Message: "The name and version fields are for you to customize your copy of this library file. If you plan on publishing it for others to use, create a library setup reference record below. Click the ? button for more info."; Default Button: “OK”, Commit: “Yes” ]
    #
    #

Fields used in this script

    tempSetup::userLibraryName
    tempSetup::userLibraryVersionNumber
    TEMP::klibrary
    testSubsectionGroup::_Lgroup
    testSubsectionGroup::name
    testSubsectionGroup::nameSpellingEXCEPTForTestItemGroup
    testSubsectionGroup::versionNumber

Scripts used in this script

Layouts used in this script

    tableTagGroup
    defaultSetup

Tables used in this script

    TEMP
    TEMP
    tagGroup

Table occurrences used by this script

    TEMP
    tempSetup
    testSubsectionGroup

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [changeLibraryName]	Parent Folder: [librarySetup]	Next Script: [gotoHeartWhisperer]
Script Name	gotoBudgetPlanner
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    allApps

Scripts that use this script

Script Definition
Script Steps

    #
    #Open using this url on iPad/iPhone.
    If [ Get ( SystemPlatform ) = 3 ]
    Open URL [ "fmp://%7e/BudgetPlanner" ] [ No dialog ]
    Close Window [ Name: "All Apps"; Current file ]
    Halt Script
    End If
    #
    Select Window [ Name: "Budget Planner" ]
    If [ Get (LastError) = 112 ]
    Open URL [ Substitute ( MemorySwitch::helpPath ; "help" ; "budgetplanner" ) ] [ No dialog ]
    Open URL [ Substitute ( MemorySwitch::helpPath ; "help" ; "budgetplanner" ) ] [ No dialog ]
    End If
    #
    #Close all solutions window.
    If [ $$otherApps = 1 ]
    Set Variable [ $$otherApps ]
    Close Window [ Name: "All Apps"; Current file ]
    Halt Script
    End If

Fields used in this script

    MemorySwitch::helpPath

Scripts used in this script

Layouts used in this script

Tables used in this script

    MemorySwitch

Table occurrences used by this script

    MemorySwitch

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [gotoBudgetPlanner]	Parent Folder: [librarySetup]	Next Script: [gotoHelpGiveThanksWebsite]
Script Name	gotoHeartWhisperer
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    allApps

Scripts that use this script

Script Definition
Script Steps

    #
    #Open using this url on iPad/iPhone.
    If [ Get ( SystemPlatform ) = 3 ]
    Open URL [ "fmp://%7e/HeartWhisperer" ] [ No dialog ]
    Close Window [ Name: "All Apps"; Current file ]
    Halt Script
    End If
    #
    Select Window [ Name: "Icons" ]
    Select Window [ Name: "Workout Editor" ]
    Select Window [ Name: "Plan Week" ]
    Select Window [ Name: "My Workouts" ]
    Select Window [ Name: "Planned Workouts" ]
    If [ MemorySwitch::fatPath = "Workout Editor" ]
    Select Window [ Name: "Icons" ]
    Select Window [ Name: "Workout Editor" ]
    Select Window [ Name: "Plan Week" ]
    Else If [ MemorySwitch::fatPath = "Plan Week" ]
    Select Window [ Name: "Icons" ]
    Select Window [ Name: "Workout Editor" ]
    Select Window [ Name: "Plan Week" ]
    Else If [ MemorySwitch::fatPath = "Icons" ]
    Select Window [ Name: "Icons" ]
    Select Window [ Name: "Workout Editor" ]
    Select Window [ Name: "Plan Week" ]
    Else If [ MemorySwitch::fatPath = "My Workouts" ]
    Select Window [ Name: "My Workouts" ]
    Select Window [ Name: "Planned Workouts" ]
    Else If [ MemorySwitch::fatPath = "Planned Workouts" ]
    Select Window [ Name: "My Workouts" ]
    Select Window [ Name: "Planned Workouts" ]
    End If
    Select Window [ Name: MemorySwitch::fatPath ]
    If [ Get (LastError) = 112 ]
    Open URL [ Substitute ( MemorySwitch::helpPath ; "help" ; "heartwhisperer" ) ] [ No dialog ]
    Open URL [ Substitute ( MemorySwitch::helpPath ; "help" ; "heartwhisperer" ) ] [ No dialog ]
    End If
    #
    #Close all apps window.
    If [ $$otherApps = 1 ]
    Set Variable [ $$otherApps ]
    Close Window [ Name: "All Apps"; Current file ]
    Halt Script
    End If

Fields used in this script

    MemorySwitch::fatPath
    MemorySwitch::helpPath

Scripts used in this script

Layouts used in this script

Tables used in this script

    MemorySwitch

Table occurrences used by this script

    MemorySwitch

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [gotoHeartWhisperer]	Parent Folder: [librarySetup]	Next Script: [gotoIQLogs]
Script Name	gotoHelpGiveThanksWebsite
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    allApps

Scripts that use this script

Script Definition
Script Steps

    #
    #Close all solutions window after selecting website.
    If [ $$otherApps = 1 ]
    Set Variable [ $$otherApps ]
    Close Window [ Name: "All Apps"; Current file ]
    Open URL [ "https://helpgivethanks.github.io/" ] [ No dialog ]
    Halt Script
    End If

Fields used in this script

Scripts used in this script

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [gotoHelpGiveThanksWebsite]	Parent Folder: [librarySetup]	Next Script: [gotoOtherLibrary]
Script Name	gotoIQLogs
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    allApps

Scripts that use this script

Script Definition
Script Steps

    #
    #!!!!!!!!!! NOTE !!!!!!!!!!!!!
    #!!!!!!!!!! NOTE !!!!!!!!!!!!!
    #!!!!!!!!!! NOTE !!!!!!!!!!!!!
    #This script needs to be kept identical to the
    #same script in the ActionLog.
    #
    #
    Show Custom Dialog [ Message: "Brain exercises result in measurable increases in cognitive abilities, like how fast we can read aloud, how far we can see, etc. The IQ Log app guides you thru several cognitive tests."; Default Button: “OK”, Commit: “Yes” ]
    Show Custom Dialog [ Message: "Use it to track increases in your brain's abilities, and determine when you need to increase the difficulty of your brain exercises. It will be released when time permits."; Default Button: “OK”, Commit: “Yes” ]

Fields used in this script

Scripts used in this script

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [gotoIQLogs]	Parent Folder: [librarySetup]	Next Script: [libraryMainOrBranchRepition1]
Script Name	gotoOtherLibrary
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    allApps

Scripts that use this script

Script Definition
Script Steps

    #
    #!!!!!!!!!! NOTE !!!!!!!!!!!!!
    #!!!!!!!!!! NOTE !!!!!!!!!!!!!
    #!!!!!!!!!! NOTE !!!!!!!!!!!!!
    #This script needs to be kept identical to the
    #same script in the ActionLog.
    #
    #Because this portal is to external database it is
    #essential to get this record's path info for use in
    #other script steps.
    Set Variable [ $path; Value:MemorySwitch::path ]
    Set Variable [ $name; Value:MemorySwitch::name ]
    #
    #Open using this url on iPad/iPhone.
    If [ Get ( SystemPlatform ) = 3 ]
    Set Error Capture [ On ]
    #
    Set Field [ MemorySwitch::currentLibraryName; $name ]
    Open URL [ "fmp://%7e/" & Substitute ( MemorySwitch::name ; " " ; "%20" ) ] [ No dialog ]
    #
    If [ Get ( LastError ) ≠ 0 ]
    #If the library fails to open inform user why.
    Show Custom Dialog [ Message: "Click the folder icon (top left corner) to start a library and add it to this menu. The one you selected is not available on this device or its name was changed so this shortcut is being deleted."; Default Button: “OK”, Commit: “No” ]
    Delete Portal Row [ No dialog ]
    Exit Script [ ]
    End If
    #
    #Close all solutions window if open after selecting a library.
    Close Window [ Name: "All Apps"; Current file ]
    Set Variable [ $$otherApps ]
    Halt Script
    #
    End If
    #
    #If library path is blank (which should only happen if
    #admin adds library manually with path), then delete
    #this library name from the list.
    If [ MemorySwitch::path = "" ]
    Show Custom Dialog [ Message: "This library file cannot be found under the name " & MemorySwitch::name & ". It will be removed from this list. You can add it back by going to its folder on your PC and double clicking on it."; Default Button: “OK”, Commit: “No” ]
    #
    #This seems to work if just the portal row is
    #deleted. Further testing is needed to confirm.
    Delete Portal Row [ No dialog ]
    #
    // #ISSUE: If you have a portal into a table that is more
    // #than one relationship away, and if that related table
    // #exists in an external file, then you cannot delete
    // #the portal row.
    // Go to Portal Row [ $row ] [ No dialog ]
    // Delete Record/Request [ No dialog ]
    // Delete Portal Row [ No dialog ]
    #
    #Because the one step above seems to work, I
    #am disabling these next steps for deleting a
    #portal row.
    // Go to Layout [ <unknown> ]
    // Show All Records
    // Go to Record/Request/Page [ First ]
    // Loop
    // Exit Loop If [ $path = MemorySwitch::path ]
    // Go to Record/Request/Page [ Next; Exit after last ]
    // End Loop
    // If [ $path = MemorySwitch::path ]
    // Delete Record/Request [ No dialog ]
    // End If
    // Go to Layout [ <unknown> ]
    Exit Script [ ]
    End If
    #
    #Select the current library windows if open and selected.
    If [ MemorySwitch::currentLibraryPath = $path ]
    Select Window [ Name: GetValue ( WindowNames ( Case ( Get ( SystemPlatform ) = - 2 ; MemorySwitch::name ; MemorySwitch::name ) ) ; 1 ) ]
    Select Window [ Name: GetValue ( WindowNames ( Case ( Get ( SystemPlatform ) = - 2 ; MemorySwitch::name ; MemorySwitch::name ) ) ; 2 ) ]
    Select Window [ Name: MemorySwitch::currentLibraryWIndows ]
    End If
    #
    #There is no harm in leaving multiple libraries
    #open, so just open the selected one if
    #available. NOTE: There are too many
    #different window names that could be open
    #for a library, and further testing needs to be
    #done make sure all are accounted for before
    #closing an open library is a sure thing!
    // #If the library selected is not open, then close the current
    // #library, which means closing all of its windows, and
    // #then open the selected library.
    If [ MemorySwitch::currentLibraryPath ≠ $path or Get (LastError) = 112 ]
    #
    // Set Variable [ $number; Value:1 ]
    // Loop
    // Loop
    // Close Window [ Name: Case ( $number = 1 ; "Setup" ; $number = 2 ; "References" ; $number = 3 ; "Test" ; $number = 4 ; "Learn" ; $number = 5 ; "Report" ; $number = 6 ; "Tag Menus" ) ]
    // Exit Loop If [ Get (LastError) = 112 ]
    // End Loop
    // Set Variable [ $number; Value:$number + 1 ]
    // Exit Loop If [ $number = 7 ]
    // End Loop
    #
    Set Field [ MemorySwitch::currentLibraryPath; $path ]
    Set Field [ MemorySwitch::currentLibraryName; $name ]
    Open URL [ Case ( Get ( SystemPlatform ) = - 2 ; Substitute (MemorySwitch::path ; " " ; "%20" ) ; Substitute ( Substitute ( MemorySwitch::path ; "file:/" ; "file://" ) ; " " ; "%20" ) ) ] [ No dialog ]
    End If
    #
    #If the path stored for the selected library failed to open
    #the library, then that library is no longer there or its
    #name has been changed, so delete it from the
    #library list.
    If [ Get (LastError) = 5 ]
    Show Custom Dialog [ Message: "This library file cannot be found under the name " & MemorySwitch::name & ". It will be removed from this list. You can add it back by going to its folder on your PC and double clicking on it."; Default Button: “OK”, Commit: “No” ]
    #
    #This seems to work if just the portal row is
    #deleted. Further testing is needed to confirm.
    Delete Portal Row [ No dialog ]
    #
    // #ISSUE: If you have a portal into a table that is more
    // #than one relationship away, and if that related table
    // #exists in an external file, then you cannot delete
    // #the portal row.
    // Go to Portal Row [ $row ] [ No dialog ]
    // Delete Record/Request [ No dialog ]
    // Delete Portal Row [ No dialog ]
    #
    #Because the one step above seems to work, I
    #am disabling these next steps for deleting a
    #portal row.
    // Go to Layout [ <unknown> ]
    // Show All Records
    // Go to Record/Request/Page [ First ]
    // Loop
    // Exit Loop If [ $path = MemorySwitch::path ]
    // Go to Record/Request/Page [ Next; Exit after last ]
    // End Loop
    // If [ $path = MemorySwitch::path ]
    // Delete Record/Request [ No dialog ]
    // End If
    // Go to Layout [ <unknown> ]
    Exit Script [ ]
    End If
    #
    #Set selected path and name to current name
    #and path.
    Set Field [ MemorySwitch::currentLibraryPath; $path ]
    Set Field [ MemorySwitch::currentLibraryName; $name ]
    #
    #Close other solutions window if open after selecting a library.
    If [ $$otherApps = 1 ]
    Close Window [ Name: "All Apps"; Current file ]
    Set Variable [ $$otherApps ]
    Halt Script
    End If
    #

Fields used in this script

    MemorySwitch::path
    MemorySwitch::name
    MemorySwitch::currentLibraryName
    MemorySwitch::currentLibraryPath
    MemorySwitch::currentLibraryWIndows

Scripts used in this script

Layouts used in this script

    <Missing Layout>

Tables used in this script

    MemorySwitch

Table occurrences used by this script

    MemorySwitch

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [gotoOtherLibrary]	Parent Folder: [librarySetup]	Next Script: [libraryMainOrBranchRepition2]
Script Name	libraryMainOrBranchRepition1
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #Exit the checkbox.
    Go to Field [ ]
    #
    If [ TEMP::userLibraryMainOrBranch[1] = "" ]
    #
    #Designate library as a reference library.
    Set Field [ TEMP::userLibraryMainOrBranch[2]; 1 ]
    #
    Else
    #
    #Designate library as branch library.
    Set Field [ TEMP::userLibraryMainOrBranch[2]; "" ]
    #
    End If

Fields used in this script

    TEMP::userLibraryMainOrBranch

Scripts used in this script

Layouts used in this script

Tables used in this script

    TEMP

Table occurrences used by this script

    TEMP

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [libraryMainOrBranchRepition1]	Parent Folder: [librarySetup]	Next Script: [libraryTypeCheckBoxRepition1]
Script Name	libraryMainOrBranchRepition2
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #Exit the checkbox.
    Go to Field [ ]
    #
    If [ tempSetup::userLibraryMainOrBranch[2] = 1 ]
    #
    #Designate library as a reference library.
    Set Field [ TEMP::userLibraryMainOrBranch; "" ]
    #
    Else
    #
    #Designate library as a stuff/inventory library.
    Set Field [ TEMP::userLibraryMainOrBranch; 1 ]
    #
    End If

Fields used in this script

    tempSetup::userLibraryMainOrBranch
    TEMP::userLibraryMainOrBranch

Scripts used in this script

Layouts used in this script

Tables used in this script

    TEMP

Table occurrences used by this script

    TEMP
    tempSetup

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [libraryMainOrBranchRepition2]	Parent Folder: [librarySetup]	Next Script: [libraryTypeCheckBoxRepition2]
Script Name	libraryTypeCheckBoxRepition1
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #Admin tasks.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #Exit the checkbox.
    Go to Field [ ]
    #
    #Set default layout views for
    #a reference library.
    If [ tempSetup::InventoryLibraryYN[1] = "" ]
    Set Field [ tempSetup::layoutLtagK; "" ]
    Set Field [ tempSetup::layoutRtagK; "" ]
    Set Field [ tempSetup::layoutLtagN; "" ]
    Set Field [ tempSetup::layoutRtagN; "" ]
    #
    #Designate library as a reference library.
    Set Field [ TEMP::InventoryLibraryYN[2]; 1 ]
    #
    #Update library record.
    Go to Layout [ “tableTagGroup” (testSubsectionGroup) ]
    Enter Find Mode [ ]
    Set Field [ testSubsectionGroup::_Lgroup; TEMP::klibrary ]
    Perform Find [ ]
    Set Field [ testSubsectionGroup::orderOrLibraryType; "" ]
    Go to Layout [ “defaultSetup” (librarySetupReferenceMain) ]
    #
    #Explain to user importance of sticking to the
    #library type choosen once they start creating
    #records for it.
    Show Custom Dialog [ Message: "FYI: Records created in an inventory library, or an idea library, will cause minor problems if you switch the library they are in to the opposite library type."; Default Button: “OK”, Commit: “Yes” ]
    Show Custom Dialog [ Message: "Choose the purpose for which you wish to use this library, and then don't change it (or you'll end up fixing a lot of minor problems)."; Default Button: “OK”, Commit: “Yes” ]
    #
    #
    #
    Else
    #
    #
    #
    #Set default layout views for
    #a stuff/inventory library.
    Set Field [ tempSetup::layoutLtagK; "moreltagNKs2" ]
    Set Field [ tempSetup::layoutRtagK; "moreReferenceMenu2SkeywordOrNode1" ]
    Set Field [ tempSetup::layoutLtagN; "moreltagNKs2" ]
    Set Field [ tempSetup::layoutRtagN; "moreReferenceMenu2SkeywordOrNode1" ]
    #
    #Designate library as a stuff/inventory library.
    Set Field [ TEMP::InventoryLibraryYN[2]; "" ]
    #
    #Update library record.
    Go to Layout [ “tableTagGroup” (testSubsectionGroup) ]
    Enter Find Mode [ ]
    Set Field [ testSubsectionGroup::_Lgroup; TEMP::klibrary ]
    Perform Find [ ]
    Set Field [ testSubsectionGroup::orderOrLibraryType; 1 ]
    #
    #Now save a backup of the inventory reference
    #records. This is due to the fact that inventory
    #reference records when locked are editable
    #because their is no edit layout for them. If this
    #is backup is not done, then the first time going
    #to the reference layout all backup fields will be
    #blank, and so erase main field data, which
    #would be a disaster for a user just playing
    #around to see what a refernce library
    #looks like in invtory mode. So to insure such an
    #exploration does not result in data loss, this
    #backup is done before the user can get to
    #those records. Then, when they visit them,
    #the backup fields will not be blank, and so,
    #data in the primary fields will not be erased.
    Go to Layout [ “tableReference” (reference) ]
    Go to Record/Request/Page [ First ]
    Loop
    #
    #
    #Only change records that have been changed.
    #Changes result in the record modify date being
    #reset, and this should only be done when the
    #user modifies the record.
    If [ reference::Title[1] ≠ reference::Title[2] ]
    Set Field [ reference::Title[2]; reference::Title[1] ]
    End If
    If [ reference::thoughtsNotesEtc[1] ≠ reference::thoughtsNotesEtc[2] ]
    Set Field [ reference::thoughtsNotesEtc[2]; reference::thoughtsNotesEtc[1] ]
    End If
    If [ reference::publicationYearOrStuffOrderNumber[1] ≠ reference::publicationYearOrStuffOrderNumber[2] ]
    #
    #Insure that only 3 digit numbers are
    #saved in this field.
    Set Variable [ $threeDigitNumber; Value:Right ( GetAsNumber (reference::publicationYearOrStuffOrderNumber[1]) ; 3 ) ]
    Set Field [ reference::publicationYearOrStuffOrderNumber[2]; $threeDigitNumber ]
    Set Field [ reference::publicationYearOrStuffOrderNumber; $threeDigitNumber ]
    End If
    #
    #
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #
    Go to Layout [ “defaultSetup” (librarySetupReferenceMain) ]
    #
    #
    #Explain to user importance of sticking to the
    #library type choosen once they start creating
    #records for it.
    Show Custom Dialog [ Message: "FYI: Records created in an inventory library, or an idea library, will cause minor problems if you switch the library they are in to the opposite library type."; Default Button: “OK”, Commit: “Yes” ]
    Show Custom Dialog [ Message: "Choose the purpose for which you wish to use this library, and then don't change it (or you'll end up fixing a lot of minor problems)."; Default Button: “OK”, Commit: “Yes” ]
    #
    End If
    #
    #

Fields used in this script

    tempSetup::InventoryLibraryYN
    tempSetup::layoutLtagK
    tempSetup::layoutRtagK
    tempSetup::layoutLtagN
    tempSetup::layoutRtagN
    TEMP::InventoryLibraryYN
    TEMP::klibrary
    testSubsectionGroup::_Lgroup
    testSubsectionGroup::orderOrLibraryType
    reference::Title
    reference::thoughtsNotesEtc
    reference::publicationYearOrStuffOrderNumber

Scripts used in this script

Layouts used in this script

    tableTagGroup
    defaultSetup
    tableReference

Tables used in this script

    TEMP
    reference
    tagGroup

Table occurrences used by this script

    TEMP
    reference
    tempSetup
    testSubsectionGroup

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [libraryTypeCheckBoxRepition1]	Parent Folder: [librarySetup]	Next Script: [moreInfo]
Script Name	libraryTypeCheckBoxRepition2
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #Admin tasks.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #Exit the checkbox.
    Go to Field [ ]
    #
    #Set default layout views for
    #a reference library.
    If [ tempSetup::InventoryLibraryYN[2] = 1 ]
    Set Field [ tempSetup::layoutLtagK; "" ]
    Set Field [ tempSetup::layoutRtagK; "" ]
    Set Field [ tempSetup::layoutLtagN; "" ]
    Set Field [ tempSetup::layoutRtagN; "" ]
    #
    #Designate library as a reference library.
    Set Field [ TEMP::InventoryLibraryYN; "" ]
    #
    #Update library record.
    Go to Layout [ “tableTagGroup” (testSubsectionGroup) ]
    Enter Find Mode [ ]
    Set Field [ testSubsectionGroup::_Lgroup; TEMP::klibrary ]
    Perform Find [ ]
    Set Field [ testSubsectionGroup::orderOrLibraryType; "" ]
    Go to Layout [ “defaultSetup” (librarySetupReferenceMain) ]
    #
    #Explain to user importance of sticking to the
    #library type choosen once they start creating
    #records for it.
    Show Custom Dialog [ Message: "FYI: Records created in an inventory library, or an idea library, will cause minor problems if you switch the library they are in to the opposite library type."; Default Button: “OK”, Commit: “Yes” ]
    Show Custom Dialog [ Message: "Choose the purpose for which you wish to use this library, and then don't change it (or you'll end up fixing a lot of minor problems)."; Default Button: “OK”, Commit: “Yes” ]
    #
    #
    #
    Else
    #
    #
    #
    #Set default layout views for
    #a stuff/inventory library.
    Set Field [ tempSetup::layoutLtagK; "moreltagNKs2" ]
    Set Field [ tempSetup::layoutRtagK; "moreReferenceMenu2SkeywordOrNode1" ]
    Set Field [ tempSetup::layoutLtagN; "moreltagNKs2" ]
    Set Field [ tempSetup::layoutRtagN; "moreReferenceMenu2SkeywordOrNode1" ]
    #
    #Designate library as a stuff/inventory library.
    Set Field [ TEMP::InventoryLibraryYN; 1 ]
    #
    #Update library record.
    Go to Layout [ “tableTagGroup” (testSubsectionGroup) ]
    Enter Find Mode [ ]
    Set Field [ testSubsectionGroup::_Lgroup; TEMP::klibrary ]
    Perform Find [ ]
    Set Field [ testSubsectionGroup::orderOrLibraryType; 1 ]
    #
    #Now save a backup of the inventory reference
    #records. This is due to the fact that inventory
    #reference records when locked are editable
    #because their is no edit layout for them. If this
    #is backup is not done, then the first time going
    #to the reference layout all backup fields will be
    #blank, and so erase main field data, which
    #would be a disaster for a user just playing
    #around to see what a refernce library
    #looks like in invtory mode. So to insure such an
    #exploration does not result in data loss, this
    #backup is done before the user can get to
    #those records. Then, when they visit them,
    #the backup fields will not be blank, and so,
    #data in the primary fields will not be erased.
    Go to Layout [ “tableReference” (reference) ]
    Go to Record/Request/Page [ First ]
    Loop
    #
    #
    #Only change records that have been changed.
    #Changes result in the record modify date being
    #reset, and this should only be done when the
    #user modifies the record.
    If [ reference::Title[1] ≠ reference::Title[2] ]
    Set Field [ reference::Title[2]; reference::Title[1] ]
    End If
    If [ reference::thoughtsNotesEtc[1] ≠ reference::thoughtsNotesEtc[2] ]
    Set Field [ reference::thoughtsNotesEtc[2]; reference::thoughtsNotesEtc[1] ]
    End If
    If [ reference::publicationYearOrStuffOrderNumber[1] ≠ reference::publicationYearOrStuffOrderNumber[2] ]
    #
    #Insure that only 3 digit numbers are
    #saved in this field.
    Set Variable [ $threeDigitNumber; Value:Right ( GetAsNumber (reference::publicationYearOrStuffOrderNumber[1]) ; 3 ) ]
    Set Field [ reference::publicationYearOrStuffOrderNumber[2]; $threeDigitNumber ]
    Set Field [ reference::publicationYearOrStuffOrderNumber; $threeDigitNumber ]
    End If
    #
    #
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #
    Go to Layout [ “defaultSetup” (librarySetupReferenceMain) ]
    #
    #Explain to user importance of sticking to the
    #library type choosen once they start creating
    #records for it.
    Show Custom Dialog [ Message: "FYI: Records created in an inventory library, or an idea library, will cause minor problems if you switch the library they are in to the opposite library type."; Default Button: “OK”, Commit: “Yes” ]
    Show Custom Dialog [ Message: "Choose the purpose for which you wish to use this library, and then don't change it (or you'll end up fixing a lot of minor problems)."; Default Button: “OK”, Commit: “Yes” ]
    End If

Fields used in this script

    tempSetup::InventoryLibraryYN
    tempSetup::layoutLtagK
    tempSetup::layoutRtagK
    tempSetup::layoutLtagN
    tempSetup::layoutRtagN
    TEMP::InventoryLibraryYN
    TEMP::klibrary
    testSubsectionGroup::_Lgroup
    testSubsectionGroup::orderOrLibraryType
    reference::Title
    reference::thoughtsNotesEtc
    reference::publicationYearOrStuffOrderNumber

Scripts used in this script

Layouts used in this script

    tableTagGroup
    defaultSetup
    tableReference

Tables used in this script

    TEMP
    reference
    tagGroup

Table occurrences used by this script

    TEMP
    reference
    tempSetup
    testSubsectionGroup

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [libraryTypeCheckBoxRepition2]	Parent Folder: [librarySetup]	Next Script: [setupReference_Delete]
Script Name	moreInfo
Run script with full access privileges	Off
Include In Menu	Yes
Layouts that use this script

    defaultSetup

Scripts that use this script

Script Definition
Script Steps

    New Window [ Name: "More Info"; Left: Get ( WindowDesktopWidth ) - (Get ( WindowDesktopWidth ) / 2 ); Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “moreInfo” (TEMP) ]
    Adjust Window [ Resize to Fit ]
    Delete All Records [ No dialog ]
    New Record/Request
    Pause/Resume Script [ Indefinitely ]

Fields used in this script

Scripts used in this script

Layouts used in this script

    moreInfo

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [moreInfo]	Parent Folder: [librarySetup]	Next Script: [setupReference_GoToPortalReferenceRevieworWebsite]
Script Name	setupReference_Delete
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultSetup
    setupReferenceViewUnlocked
    defaultSetupViewAndEdit

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Stop script if there are no records to lock.
    If [ Get (FoundCount) = 0 ]
    Exit Script [ ]
    End If
    #
    #
    #If there is a password, the delete (x) button
    #is invisible, but it can still be clicked, so its
    #important to stop this script.
    If [ librarySetupReferenceMain::password[2] ≠ "" ]
    Exit Script [ ]
    End If
    #
    #
    #If record's creator node is locked, tell the
    #user it's locked, but the record can still be
    #deleted or edited because it is not locked.
    If [ librarySetupCreator::orderOrLock ≠ "" ]
    Show Custom Dialog [ Message: "This library setup-reference's creator node — " & librarySetupCreator::tag & " — is locked. HOWEVER, the lock for these setup-reference records are separate from their creator's lock, so you can edit and delete it."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #
    #Make sure the user wants to delete
    #the record.
    Show Custom Dialog [ Message: "Delete this library setup-reference?"; Default Button: “Cancel”, Commit: “Yes”; Button 2: “OK”, Commit: “No” ]
    #
    #
    #If user cancels delete, exit script.
    If [ Get ( LastMessageChoice ) = 1 ]
    Go to Field [ ]
    Exit Script [ ]
    End If
    #
    #
    #Delete the record.
    Delete Record/Request [ No dialog ]
    #
    #
    #Close the Review Reference window if open.
    If [ Get (WindowName) = "Review Reference" or Get (WindowName) = "Edit Reference" ]
    Close Window [ Current Window ]
    Halt Script
    End If
    #
    #

Fields used in this script

    librarySetupReferenceMain::password
    librarySetupCreator::orderOrLock
    librarySetupCreator::tag

Scripts used in this script

Layouts used in this script

Tables used in this script

    setupReference
    tag

Table occurrences used by this script

    librarySetupCreator
    librarySetupReferenceMain

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [setupReference_Delete]	Parent Folder: [librarySetup]	Next Script: [setupReference_GoToReviewOrEditWindow]
Script Name	setupReference_GoToPortalReferenceRevieworWebsite
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultSetup

Scripts that use this script

    setupReference_New

Script Definition
Script Steps

    #
    #
    #If there are no user created references, then tell user
    #how to download a fresh copy of the library app.
    If [ Get (FoundCount) = 0 ]
    Show Custom Dialog [ Message: "This library when downloaded was an empty, unmodified version of the applicaiton, without any user created notes (Learn records), references, or test templates in it."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #
    #Capture variables needed when user clicks
    #the review button, or clicks on a portal
    #reference record.
    If [ Get ( ActiveFieldName ) = "" ]
    Set Variable [ $record; Value:librarySetupReferenceMain::_LlibrarySetupHowToCredit ]
    Set Variable [ $password; Value:librarySetupReferenceMain::password ]
    Set Variable [ $url; Value:librarySetupReferenceMain::URL ]
    Else
    Set Variable [ $record; Value:librarySetupReferencePortal::_LlibrarySetupHowToCredit ]
    Set Variable [ $password; Value:librarySetupReferencePortal::password ]
    Set Variable [ $url; Value:librarySetupReferencePortal::URL ]
    Set Variable [ $portal; Value:1 ]
    End If
    #
    #Exit any field user was in.
    Go to Field [ ]
    #
    #
    #Ask the user if they want to view this library'e
    #record, edit it, or go to the library's website,
    #BUT ONLY IF the record has a URL, and the
    #user click on a portal record. (The main
    #record has a button to go to the web, so it
    #would be redundant to ask them if they want
    #to go to the web when they just clicked the
    #review button insetad of the web button.)
    If [ $URL ≠ "" and $portal ≠ "" ]
    Show Custom Dialog [ Message: "Review setup reference, or go to its website?"; Default Button: “cancel”, Commit: “Yes”; Button 2: “review”, Commit: “No”; Button 3: “go”, Commit: “No” ]
    End If
    #
    #
    #If they click cancel, then exit the script.
    If [ Get (LastMessageChoice) = 1 ]
    Go to Field [ ]
    Exit Script [ ]
    End If
    #
    #
    #If they click go, then go (in the portal
    #message dialogue box) to the library's
    #website.
    If [ Get (LastMessageChoice) = 3 ]
    Open URL [ librarySetupReferencePortal::URL ] [ No dialog ]
    Go to Field [ ]
    Exit Script [ ]
    End If
    #
    #
    #Close a Review Reference window that
    #might be open due to a script interruption.
    Close Window [ Name: "Review Reference"; Current file ]
    #
    #Open an Review Reference window.
    New Window [ Name: "Review Reference"; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    #
    #If there is no password, go the review layout
    #with an edit button, otherwise go to the
    #review layout with no edit button.
    If [ $password = "" ]
    Go to Layout [ “setupReferenceViewUnlocked” (librarySetupReferenceMain) ]
    Else
    Go to Layout [ “setupReferenceViewLocked” (librarySetupReferenceMain) ]
    End If
    #
    #Adjust window size and postion (for
    #iDevice users), and then find just the
    #record the user is interested in reviewing.
    Adjust Window [ Resize to Fit ]
    Move/Resize Window [ Current Window; Height: Get (ScreenHeight) ]
    Enter Find Mode [ ]
    Set Field [ librarySetupReferenceMain::_LlibrarySetupHowToCredit; $record ]
    Perform Find [ ]
    #
    #
    #If this script was triggered by the
    #newSetupReference script, then
    #go to the edit layout, otherwise
    #stay on the review layout.
    If [ $$newSetupReference ≠ "" ]
    Set Variable [ $$newSetupReference ]
    Go to Layout [ “defaultSetupViewAndEdit” (librarySetupReferenceMain) ]
    #
    #Tell user why the must enter their
    #name again, when they used their
    #node record to create this record.
    Go to Field [ librarySetupReferenceMain::name ]
    Show Custom Dialog [ Message: "NOTE: The creator name field is not filled in because unlike node tags, it needs to be in FirstName LastName order, like the author's name on the cover of a book."; Default Button: “OK”, Commit: “Yes” ]
    Go to Field [ librarySetupReferenceMain::name ]
    End If
    #
    #Pause the script to prevent the user doing
    #anything else until they have closed this
    #review window.
    Pause/Resume Script [ Indefinitely ]
    #
    #Just in case, close this window if the user
    #hits the continue button somehow.
    Close Window [ Current Window ]
    Exit Script [ ]
    #
    #

Fields used in this script

    librarySetupReferenceMain::_LlibrarySetupHowToCredit
    librarySetupReferenceMain::password
    librarySetupReferenceMain::URL
    librarySetupReferencePortal::_LlibrarySetupHowToCredit
    librarySetupReferencePortal::password
    librarySetupReferencePortal::URL
    librarySetupReferenceMain::name

Scripts used in this script

Layouts used in this script

    setupReferenceViewUnlocked
    setupReferenceViewLocked
    defaultSetupViewAndEdit

Tables used in this script

    setupReference

Table occurrences used by this script

    librarySetupReferenceMain
    librarySetupReferencePortal

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [setupReference_GoToPortalReferenceRevieworWebsite]	Parent Folder: [librarySetup]	Next Script: [setupReference_GoToWebsite]
Script Name	setupReference_GoToReviewOrEditWindow
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    setupReferenceViewUnlocked
    defaultSetupViewAndEdit

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #If user is on the review layout, take them
    #to the edit layout.
    If [ Get (WindowName) = "Review Reference" ]
    Go to Layout [ “defaultSetupViewAndEdit” (librarySetupReferenceMain) ]
    Set Window Title [ Of Window: "Review Reference"; Current file; New Title: "Edit Reference" ]
    #
    #
    #If record's creator node is locked, tell the
    #user it's locked, but the record can still be
    #deleted or edited because it is not locked.
    If [ librarySetupCreator::orderOrLock ≠ "" ]
    Show Custom Dialog [ Message: "This library setup-reference's creator node — " & librarySetupCreator::tag & " — is locked. HOWEVER, the lock for these setup-reference records are separate from their creator's lock, so you can edit and delete it."; Default Button: “OK”, Commit: “No” ]
    End If
    #
    #
    #If user is on the edit layout, take them
    #to the review layout.
    Else If [ Get (WindowName) = "Edit Reference" ]
    Go to Layout [ “setupReferenceViewUnlocked” (librarySetupReferenceMain) ]
    Set Window Title [ Of Window: "Edit Reference"; Current file; New Title: "Review Reference" ]
    End If
    #
    #

Fields used in this script

    librarySetupCreator::orderOrLock
    librarySetupCreator::tag

Scripts used in this script

Layouts used in this script

    defaultSetupViewAndEdit
    setupReferenceViewUnlocked

Tables used in this script

    tag

Table occurrences used by this script

    librarySetupCreator

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [setupReference_GoToReviewOrEditWindow]	Parent Folder: [librarySetup]	Next Script: [setupReference_Lock]
Script Name	setupReference_GoToWebsite
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultSetup
    setupReferenceViewLocked
    setupReferenceViewUnlocked
    defaultSetupViewAndEdit

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #If there are no setup references, then
    #go to the helpgive thanks website.
    If [ Get (FoundCount) = 0 ]
    Open URL [ "https://helpgivethanks.github.io" ] [ No dialog ]
    Exit Script [ ]
    End If
    #
    #
    #If there is no URL, then tell the user how
    #to add one ...
    If [ librarySetupReferenceMain::URL = "" ]
    #
    #on the Setup window ...
    If [ Get (WindowName) = "Setup" ]
    #
    If [ librarySetupReferenceMain::password = "" ]
    #If NOT locked ...
    Show Custom Dialog [ Message: "1) Click the review button, and then 2) the edit button, 3) to add a website URL to this setup reference in the edit window."; Default Button: “OK”, Commit: “Yes” ]
    Else
    #If locked ...
    Show Custom Dialog [ Message: "1) Click the lock button and unlock this setup reference, 2) then click the review button, 3) the edit button, 4) to add a website URL to this setup reference in the edit window."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #on the Review Reference window ...
    Else If [ Get (WindowName) = "Review Reference" ]
    #
    If [ librarySetupReferenceMain::password = "" ]
    #If NOT locked ...
    Show Custom Dialog [ Message: "1) Click the edit button, 2) to add a website URL to this in the Edit Reference window."; Default Button: “OK”, Commit: “Yes” ]
    Else
    #If locked ...
    Show Custom Dialog [ Message: "1) Click the lock button and unlock this setup reference, 2) then click edit button, 3) to add a website URL to this in the Edit Reference window."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #on the Edit Reference window, which is
    #always unlocked.
    Else If [ Get (WindowName) = "Edit Reference" ]
    Show Custom Dialog [ Message: "Add a website URL below, then click the web button again to go to that website."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #
    #
    #
    #If there is a URL, then go to it.
    Else
    Open URL [ librarySetupReferenceMain::URL ] [ No dialog ]
    End If
    #
    #

Fields used in this script

    librarySetupReferenceMain::URL
    librarySetupReferenceMain::password

Scripts used in this script

Layouts used in this script

Tables used in this script

    setupReference

Table occurrences used by this script

    librarySetupReferenceMain

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [setupReference_GoToWebsite]	Parent Folder: [librarySetup]	Next Script: [setupReference_New]
Script Name	setupReference_Lock
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultSetup
    setupReferenceViewLocked
    setupReferenceViewUnlocked
    defaultSetupViewAndEdit

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Stop script if there are no records to lock.
    If [ Get (FoundCount) = 0 ]
    Exit Script [ ]
    End If
    #
    #
    #Capture the password for comparrison and to return
    #the password field back to if the user fails to get the
    #password right.
    Set Variable [ $password; Value:librarySetupReferenceMain::password[2] ]
    Set Field [ TEMP::passwordCheck; "" ]
    Go to Field [ ]
    #
    #Use the halt instead of exit script step as the
    #user can sometimes click the lock button
    #twice. The halt stops the second click's
    #calling up of this script.
    #
    #If there is a password, ask user to enter it.
    If [ librarySetupReferenceMain::password[2] ≠ "" ]
    Loop
    Show Custom Dialog [ Message: "Enter the password to unlock — " & Case ( Length ( librarySetupReferenceMain::name & " by " & librarySetupReferenceMain::creatorName ) < 36 ; Left ( librarySetupReferenceMain::name & " by " & librarySetupReferenceMain::creatorName ; 35 ) & "... |" ; librarySetupReferenceMain::name & " by " & librarySetupReferenceMain::creatorName & " |" ); Default Button: “enter”, Commit: “Yes”; Button 2: “cancel”, Commit: “No”; Input #1: TEMP::passwordCheck, Password ]
    If [ Get ( LastMessageChoice ) = 2 ]
    Set Field [ TEMP::passwordCheck; "" ]
    Halt Script
    End If
    #
    #Unlock reference if password is correct.
    If [ $password = TEMP::passwordCheck ]
    #
    #If user is in the Review Reference window,
    #then take user to the unlocked review layout.
    If [ Get (WindowName) = "Review Reference" ]
    Go to Layout [ “setupReferenceViewUnlocked” (librarySetupReferenceMain) ]
    End If
    #
    Show Custom Dialog [ Message: "unlocked"; Default Button: “OK”, Commit: “No” ]
    Set Field [ TEMP::passwordCheck; "" ]
    Set Field [ librarySetupReferenceMain::password; "" ]
    Set Field [ librarySetupReferenceMain::password[2]; "" ]
    #
    Halt Script
    End If
    End Loop
    #
    #If there is no password, ask user to create one.
    Else If [ librarySetupReferenceMain::password[2] = "" ]
    Set Field [ TEMP::passwordCheck; "" ]
    Show Custom Dialog [ Message: "Enter a password to lock — " & Case ( Length ( librarySetupReferenceMain::name & " by " & librarySetupReferenceMain::creatorName ) < 36 ; Left ( librarySetupReferenceMain::name & " by " & librarySetupReferenceMain::creatorName ; 35 ) & "... |" ; librarySetupReferenceMain::name & " by " & librarySetupReferenceMain::creatorName & " |" ) & " WARNING: If you can't remember this password, your records will remain locked."; Default Button: “enter”, Commit: “Yes”; Button 2: “cancel”, Commit: “No”; Input #1: librarySetupReferenceMain::password, Password, "password"; Input #2: TEMP::passwordCheck, Password, "confirm password" ]
    If [ Get ( LastMessageChoice ) = 2 ]
    Set Field [ librarySetupReferenceMain::password; "" ]
    Exit Script [ ]
    End If
    #
    #Check validity of password entered.
    #
    #If they don't match, ask user to try again.
    Loop
    If [ librarySetupReferenceMain::password ≠ TEMP::passwordCheck ]
    Show Custom Dialog [ Message: "Passwords did not match."; Default Button: “enter”, Commit: “Yes”; Button 2: “cancel”, Commit: “No”; Input #1: librarySetupReferenceMain::password, Password, "password"; Input #2: TEMP::passwordCheck, Password, "confirm password" ]
    If [ Get ( LastMessageChoice ) = 2 ]
    Set Field [ librarySetupReferenceMain::password; "" ]
    Halt Script
    End If
    End If
    #
    #If the user picks 0, then make them choose
    #another and explain why the must do so.
    If [ TEMP::passwordCheck = 0 ]
    Show Custom Dialog [ Message: "Zero is not allowed. Try again."; Default Button: “enter”, Commit: “Yes”; Button 2: “cancel”, Commit: “No”; Input #1: librarySetupReferenceMain::password, Password, "password"; Input #2: TEMP::passwordCheck, Password, "confirm password" ]
    If [ Get ( LastMessageChoice ) = 2 ]
    Set Field [ librarySetupReferenceMain::password; "" ]
    Halt Script
    End If
    End If
    #
    #If the password is valid exit the
    #password check loop.
    Exit Loop If [ librarySetupReferenceMain::password = TEMP::passwordCheck and TEMP::passwordCheck ≠ 0 ]
    End Loop
    #
    #Move the user entered password into the
    #second field, and replace it with 0, which will
    #tell the system that this node is locked, but
    #will not reveal to any user what the actual
    #password is, as the second field appears on
    #zero layouts.
    Set Field [ librarySetupReferenceMain::password[2]; TEMP::passwordCheck ]
    If [ TEMP::passwordCheck ≠ "" ]
    Set Field [ librarySetupReferenceMain::password; 0 ]
    End If
    #
    #If user in the Review Reference window,
    #then take user to the locked review layout.
    If [ Get (WindowName) = "Review Reference" or Get (WindowName) = "Edit Reference" ]
    Go to Layout [ “setupReferenceViewLocked” (librarySetupReferenceMain) ]
    Set Window Title [ Current Window; New Title: "Review Reference" ]
    End If
    #
    End If
    #
    Halt Script
    #

Fields used in this script

    librarySetupReferenceMain::password
    TEMP::passwordCheck
    librarySetupReferenceMain::name
    librarySetupReferenceMain::creatorName
    <Missing Field>

Scripts used in this script

Layouts used in this script

    setupReferenceViewUnlocked
    setupReferenceViewLocked

Tables used in this script

    TEMP
    setupReference

Table occurrences used by this script

    TEMP
    librarySetupReferenceMain

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [setupReference_Lock]	Parent Folder: [librarySetup]
Script Name	setupReference_New
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultSetup

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #This script is for creating a curator record.
    If [ TEMP::kdefaultNodePrimary = "" ]
    Show Custom Dialog [ Message: "Select yourself (the node responsible for creating new records) by clicking the node button."; Default Button: “OK”, Commit: “Yes” ]
    Halt Script
    End If
    #
    #If node is currenlty locked then stop script,
    #and inform the user.
    Perform Script [ “stopNewRecordsBeingCreatedByLockedNode” ]
    #
    #Make sure user understands the reason
    #to create a setup reference record.
    Show Custom Dialog [ Message: "NOTE: Create setup reference records to share a library filled with templates, information, and reference records to help others track a process, learning something, etc."; Default Button: “cancel”, Commit: “Yes”; Button 2: “OK”, Commit: “No” ]
    #
    #If they click cancel, then exit the script.
    If [ Get (LastMessageChoice) = 1 ]
    Go to Field [ ]
    Exit Script [ ]
    End If
    #
    #Encourage user to improve any library
    #setup the use.
    Show Custom Dialog [ Message: "1) Make a short note about your setup's purpose, or improvements, modifications, etc. to another's setup. 2) Give yourself credit. 3) Share!"; Default Button: “cancel”, Commit: “Yes”; Button 2: “OK”, Commit: “No” ]
    #
    #If they click cancel, then exit the script.
    If [ Get (LastMessageChoice) = 1 ]
    Go to Field [ ]
    Exit Script [ ]
    End If
    #
    #Create new setup reference.
    New Record/Request
    Set Field [ librarySetupReferenceMain::kcreatorNode; TEMP::kdefaultNodePrimary ]
    #
    #Call the new library a remix if there is already
    #one library reference present.
    If [ Get (FoundCount) = 1 ]
    Set Field [ librarySetupReferenceMain::name; "Library Setup Name" ]
    Else
    Set Field [ librarySetupReferenceMain::name; "Remix of Library Setup Name" ]
    End If
    #
    Set Field [ librarySetupReferenceMain::creatorName; "FirstName LastName" ]
    Set Field [ librarySetupReferenceMain::version; "1" ]
    #
    #Go to edit setup reference window.
    Set Variable [ $$newSetupReference; Value:1 ]
    Perform Script [ “setupReference_GoToPortalReferenceRevieworWebsite” ]
    #
    #
    #

Fields used in this script

    TEMP::kdefaultNodePrimary
    librarySetupReferenceMain::kcreatorNode
    librarySetupReferenceMain::name
    librarySetupReferenceMain::creatorName
    librarySetupReferenceMain::version

Scripts used in this script

    stopNewRecordsBeingCreatedByLockedNode
    setupReference_GoToPortalReferenceRevieworWebsite

Layouts used in this script

Tables used in this script

    TEMP
    setupReference

Table occurrences used by this script

    TEMP
    librarySetupReferenceMain

Custom Functions used by this script

Custom menu set used by this script


probablyNotInUse
	Parent Folder: [probablyNotInUse]
Script Name	copyPrimaryNodeID
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Decided a user copy paste for Node ID was
    #too risky. Will eventually create script to
    #allow user to merge to nodes, after importing
    #another libraries records.
    #
    #This was the old copy strategy...
    #
    // #Copy node ID.
    // Copy [ tempSetup::CopyNodeIDforNewDatabase ] [ Select ]
    // Go to Field [ ]
    // Show Custom Dialog [ Message: tempSetup::DEFAULTNodePrimaryName & "'s ID number " & tempSetup::kdefaultNodePrimary & " has been copied."; Default Button: “OK”, Commit: “Yes” ]
    #
    #
    #This is was the updated copy strategy...
    #
    // #Copy node ID.
    // Set Field [ tagMenus::tag; tagMenus::_Ltag ]
    // Copy [ tagMenus::tag ] [ Select ]
    // Set Field [ tagMenus::tag; tagMenus::tagSpelling ]
    // Go to Field [ ]
    // Show Custom Dialog [ Message: "Node ID number — " & tagMenus::_Ltag & " — for node — " & tagMenus::tag & " — has been successfully copied."; Default Button: “OK”, Commit: “No” ]

Fields used in this script

    tempSetup::CopyNodeIDforNewDatabase
    tempSetup::DEFAULTNodePrimaryName
    tempSetup::kdefaultNodePrimary
    tagMenus::_Ltag
    tagMenus::tag
    tagMenus::tagSpelling

Scripts used in this script

Layouts used in this script

Tables used in this script

    TEMP
    tag

Table occurrences used by this script

    tagMenus
    tempSetup

Custom Functions used by this script

Custom menu set used by this script


pictures
	Parent Folder: [pictures]	Next Script: [addPicture1ToTag]
Script Name	addLinksPicturesToTagsMode
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    CopyrightEDIT
    defaultNode1
    defaultNode2
    defaultNodeS2
    defaultNode3
    defaultNodeS3
    defaultNodeS4
    defaultNode4
    ReferenceMenu2keywordOrNode1
    ReferenceMenu2keywordOrNode2
    ReferenceMenu2keywordOrNode3
    ReferenceMenu2keywordOrNode4
    ReferenceMenu2keywordOrNode5
    addMenu1
    addMenuNodeKeyword
    addMenu2
    addMenuTestItem
    ReferenceAddToTag
    ReferenceAddToCopyright
    ltagNK1
    ltagNK2
    ltagNK3
    ltagNK4
    ltagNK5
    testMenuTestItemEdit
    testMenuTestItemMORE

Scripts that use this script

    menuKey
    menuNode

Script Definition
Script Steps

    #
    #For now, hide the the add button until a
    #solution can be figured out to allow user to
    #create references for pictures used by node
    #tags in inventory mode.
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Show Custom Dialog [ Message: "In inventory mode, pictures and links cannot be added to tags as of library version 4.0d. Plans are to add this feature back in a future version."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #Admin tasks.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #Stop user from adding pictures from
    #brainstorm menu, and tell user how.
    If [ $$citationMatch = "brainstorm" ]
    Go to Field [ ]
    Show Custom Dialog [ Message: "To add or edit a picture or website link 1) go to the copyright tag menu in the Setup or Reference section, 2) select this copyright, 3) click review, 4) click add."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #If user is editing a reference record then stop
    #this script and inform user as to why.
    If [ $$stopAdd = 1 ]
    Go to Field [ ]
    Show Custom Dialog [ Message: "Exit 'edit' mode to add pictures to tags: 1) click 'back' in the Reference window, then 2) click 'add' in the Tag Menus window. "; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #If the user has not selected a primary node,
    #then prevent this script from creating new .
    #records. All records must be created by the
    #primary node.
    If [ tempSetup::kdefaultNodePrimary = "" ]
    Show Custom Dialog [ Message: "Select yourself (the node responsible) from Tag Menus window OR create a node record for yourself?"; Default Button: “select”, Commit: “No”; Button 2: “create”, Commit: “No” ]
    If [ Get ( LastMessageChoice ) = 1 ]
    Halt Script
    Else
    Set Field [ tempSetup::kdefaultNodePrimary; "self" ]
    End If
    End If
    #
    #If node is currenlty locked then stop script, inform user.
    If [ tagCreatorLock::orderOrLock ≠ "" ]
    Go to Field [ ]
    Show Custom Dialog [ Message: "This record is locked. Go the node that created it — " & tagCreatorLock::tag & " — and enter the password to unlock it; you will then be able to add pictures and links to it."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    If [ tagCreatorLock::orderOrLock ≠ "" and tagMenus::match = "brainstorm" or tagCreatorLock::orderOrLock ≠ "" and tagMenus::match = "copyright" or tagCreatorLock::orderOrLock ≠ "" and tagMenus::match = "test" ]
    Show Custom Dialog [ Message: "This record is currently locked. Select the node that created it and enter the password to unlock it, then you will able to start the delete process."; Default Button: “OK”, Commit: “No” ]
    Exit Script [ ]
    Else If [ tagMenus::orderOrLock ≠ "" and tagMenus::match = "copyright" ]
    Show Custom Dialog [ Message: "This record is a default copyright tag and so is locked. Choose reference-section images and web links for any copyright tags that you create: 1) Click 'new' and then 2) click 'add'."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #This script allows users to add pictures and
    #file links to tags from citation records.
    #
    #If on the test setup layout, then stop the script
    #if the user has not created any tags to add pictures
    #and links to
    If [ TEMP::ktestSubsection ≠ "" and Get (RecordNumber) = 0 ]
    Show Custom Dialog [ Message: "Create a tag record then click the add button."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #If user is in the copyright window then
    #temporarily close this window and them
    #re-open it at the end of the add pictures
    #process.
    If [ Get (WindowName) = "Copyright" ]
    Set Variable [ $$userInCopyrightWindow; Value:1 ]
    Close Window [ Current Window ]
    End If
    #
    #
    #Prevent halting in loadTagRecord script.
    Set Variable [ $$doNotHaltOtherScripts; Value:1 ]
    #
    #
    #If user is not in add mode (indicated green highlight
    #on 'add' button) then enter add mode.
    #Go to layout where user can see all
    #possible places an item can be added:
    #3 picture places and 3 link places.
    If [ $$add = "" ]
    #
    #if user was on the keyword or nod tag layout ...
    If [ $$citationMatch = "key" or $$citationMatch = "node" ]
    #
    #Remember layout user was on.
    Set Variable [ $$tagLayout; Value:Get (LayoutName) ]
    Go to Layout [ “addMenuNodeKeyword” (tagMenus) ]
    #
    #if user was on the testItem tag layout ...
    Else If [ $$citationMatch = "testItem" ]
    #
    #Remember layout user was on.
    Set Variable [ $$tagLayout; Value:Get (LayoutName) ]
    Go to Layout [ “addMenuTestItem” (tagMenus) ]
    #
    #if user was any of the other tag layouts ...
    Else If [ 1 = 1 ]
    #
    #Remember layout user was on.
    Set Variable [ $$tagLayout; Value:Get (LayoutName) ]
    Go to Layout [ “addMenu1” (tagMenus) ]
    End If
    #
    #Conditionally format add button.
    Set Variable [ $$add; Value:1 ]
    Refresh Window
    #
    #Capture main window layout.
    #Capture record user is on.
    #Stop record load script to speed things up.
    Set Variable [ $$stoploadCitation; Value:1 ]
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    If [ Get (LastError) = 112 ]
    #
    #If setup ...
    Select Window [ Name: "Setup"; Current file ]
    Set Variable [ $$returnWIndow; Value:"defaultSetup" ]
    Set Variable [ $$returnRecord; Value:testSubsectionTemplate::_LtestSubsection ]
    Else If [ Get (LastError) ≠ 112 ]
    #
    #If learn ...
    Set Variable [ $$returnWIndow; Value:"Learn" ]
    Set Variable [ $$returnLayout; Value:Get (LayoutName) ]
    Set Variable [ $$returnRecord; Value:testlearn::_Ltestlearn ]
    #
    #If adding to copyright records then show
    #locked reference copyright pictures.
    If [ $$citationMatch = "copyright" ]
    Extend Found Set [ Specified Find Requests: Find Records; Criteria: reference::lock: “"lock"” ] [ Restore ]
    #
    #Explalin to user what these additional
    Show Custom Dialog [ Message: "Default, locked copyright record images and links are shown (scroll down) in case they will be useful to you. Create new copyright reference records for links and images as needed (you'll need to exit add mode first)."; Default Button: “OK”, Commit: “No” ]
    End If
    End If
    Else If [ Get (LastError) ≠ 112 ]
    #
    #If references ...
    Set Variable [ $$returnWIndow; Value:"References" ]
    Set Variable [ $$returnRecord; Value:reference::_Lreference ]
    End If
    #
    #Re-title main window.
    Set Window Title [ Current Window; New Title: "References" ]
    #
    #Goto the referenceTag layout.
    If [ $$userInCopyrightWindow = "" ]
    Go to Layout [ “ReferenceAddToTag” (reference) ]
    Else
    Go to Layout [ “ReferenceAddToCopyright” (reference) ]
    End If
    #
    #Omit locked records, which are the copyright
    #images used by default copyright tags.
    Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: reference::lock: “lock” ] [ Restore ]
    #
    #If no records are showing then, show all Reference records.
    If [ Get (FoundCount) = 0 ]
    #
    #Find main records.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Show All Records
    #
    #Omit locked records, which are the copyright
    #images used by default copyright tags.
    Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: reference::lock: “lock” ] [ Restore ]
    #
    End If
    #
    #If adding to copyright records then show
    #locked reference copyright pictures.
    If [ $$citationMatch = "copyright" ]
    Extend Found Set [ Specified Find Requests: Find Records; Criteria: reference::lock: “"lock"” ] [ Restore ]
    #
    #Remove all records that lack both pictures and
    #links, as these are the only things users can
    #add to copyright records.
    Go to Record/Request/Page [ First ]
    Loop
    If [ reference::picture = "" and reference::URL = "" ]
    Omit Record
    Set Variable [ $omitRecordsWithoutPicturesOrLinks; Value:1 ]
    Else
    Go to Record/Request/Page [ Next ]
    End If
    Exit Loop If [ Get ( FoundCount ) = Get ( RecordNumber ) ]
    End Loop
    #
    Go to Record/Request/Page [ First ]
    #
    #If references were moved then inform
    #user of this and why.
    If [ $omitRecordsWithoutPicturesOrLinks ≠ "" ]
    Show Custom Dialog [ Message: "References have been removed that have no picture or link. The copyright image field requires the image to be stored in the references picture field."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #Explalin to user what these additional
    Show Custom Dialog [ Message: "Locked copyright records' images and links are shown (scroll down) in case they will be useful to you. Create new copyright reference records for links and images as needed (you'll need to exit add mode first)."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #Clear the stop load record variable and load
    #the current record's info.
    Set Variable [ $$stoploadCitation ]
    Perform Script [ “loadLearnOrRefMainRecord” ]
    #
    #Go to tag menu window.
    Select Window [ Name: "Tag Menus"; Current file ]
    Exit Script [ ]
    #
    #END start add mode
    #
    #
    #
    #
    #BEGIN stop add mode
    #
    #If in add mode then clear the add variable to conditionally
    #format the 'add' button to indicate that add mode
    #has been turned off.
    Else If [ $$add = 1 ]
    Set Variable [ $$add ]
    #
    #If the user was in test mode prior to add mode ...
    If [ $$citationMatch = "testItem" ]
    #
    #This may be lazy, but instead of doing an if
    #test to figure out what window a user is in,
    #it seems that telling the system to select both
    #possible windows the user could be
    #in works just fine. The system always
    #selects the one the user is in.
    Select Window [ Name: "References"; Current file ]
    Select Window [ Name: "Learn"; Current file ]
    #
    #Now loop to the record the user was on,
    #and turn off the load record script to speed things
    #up. ( This record set does not need to be found
    # first because during add mode test records
    # are not touched. )
    Set Variable [ $$ID; Value:"ignore" ]
    Go to Layout [ “setupTestSubsection” (testSubsectionTemplate) ]
    Loop
    Exit Loop If [ testSubsectionTemplate::_LtestSubsection = $$returnRecord ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Set the window title to Setup and turn back on
    #the load record script, but do not load the record
    #as this record's variables are already loaded.
    Set Window Title [ Current Window; New Title: "Setup" ]
    Set Variable [ $$ID; Value:testSubsectionTemplate::_LtestSubsection ]
    #
    #Go to the tag menu and perform the TestItem
    #menu script to reset the conditional formatting.
    Select Window [ Name: "Tag Menus"; Current file ]
    Go to Layout [ “setupTestItem” (tagMenus) ]
    Perform Script [ “menuTestItem” ]
    #
    #Clear all add mode variables and exit script.
    Set Variable [ $$returnWindow ]
    Set Variable [ $$returnLayout ]
    Set Variable [ $$returnRecord ]
    Set Variable [ $$tagLayout ]
    Exit Script [ ]
    #
    #If the user was in default mode prior to add mode ...
    Else If [ $$returnWindow = "defaultSetup" ]
    #
    #If adding to copyright records then remove/omit
    #locked reference copyright pictures.
    Select Window [ Name: "References"; Current file ]
    If [ $$citationMatch = "copyright" ]
    Set Variable [ $$stoploadCitation; Value:1 ]
    Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: reference::lock: “lock” ] [ Restore ]
    Set Variable [ $$stoploadCitation ]
    End If
    #
    #There is always only one default record, so
    #finding and looping to record is not necessary.
    Go to Layout [ “defaultSetup” (librarySetupReferenceMain) ]
    Set Window Title [ Current Window; New Title: "Setup" ]
    #
    #Go to the tag menu and perform the Node
    #menu script to reset the conditional formatting.
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    #If user was in the copyright window then
    If [ $$citationMatch = "copyright" ]
    Go to Layout [ “defaultCopyright” (tagMenus) ]
    #
    #Set citationMatch to color menu button with inUse color.
    Set Variable [ $$citationitem; Value:tempSetup::kdefaultCopyright ]
    Refresh Window
    If [ $$userInCopyrightWindow = 1 ]
    Perform Script [ “reviewCopyright” ]
    #
    #
    #Turn back on the last section of the
    #loadTagRecord script, which was turned on
    #when this add script started add mode.
    Set Variable [ $$doNotHaltOtherScripts ]
    #
    #Exit the script after running the above script as the
    #variables below are cleared in the above script.
    Exit Script [ ]
    End If
    Else
    Go to Layout [ “defaultNode2” (tagMenus) ]
    Perform Script [ “defaultNodeMenu” ]
    End If
    #
    #Turn back on the last section of the
    #loadTagRecord script, which was turned on
    #when this add script started add mode.
    Set Variable [ $$doNotHaltOtherScripts ]
    #
    #Clear all add mode variables and exit script.
    Set Variable [ $$returnWindow ]
    Set Variable [ $$returnLayout ]
    Set Variable [ $$returnRecord ]
    Set Variable [ $$tagLayout ]
    Exit Script [ ]
    End If
    #
    #If going back to a Learn or Reference layout,
    #then first turn off the record load variable.
    #I decided to do it here rather than include it
    #each time before it is needed.
    Set Variable [ $$stoploadCitation; Value:1 ]
    #
    #If the user was in learn mode prior to add mode ...
    If [ $$returnWindow = "Learn" ]
    #
    #Go to tag layout user was on before entering
    #add mode. ( This may not be useful as user
    # could also predict that tag window will stay
    # on the tag it is on in add mode. User might
    # not remember what tag they where on when
    # they started add mode. Have to see if this
    # is useful or not. )
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    If [ $$citationMatch = "node" or $$citationMatch = "key" or $$citationMatch = "testItem" ]
    #
    Go to Layout [ $$tagLayout ]
    #
    Else If [ $$citationMatch = "medium" or $$citationMatch = "copyright" or $$citationMatch = "publication" or $$citationMatch = "publisher" or //$$citationMatch = "brainstorm" or $$citationMatch = "path" ]
    Go to Layout [ $$tagLayout ]
    End If
    #
    #
    #This may be lazy, but instead of doing an if
    #test to figure out what window a user is in,
    #it seems that telling the system to select both
    #possible windows the user could be
    #in works just fine. The system always
    #selects the one the user is in.
    Select Window [ Name: "References"; Current file ]
    Select Window [ Name: "Learn"; Current file ]
    Set Window Title [ Current Window; New Title: "Learn" ]
    Go to Layout [ $$returnLayout ]
    #
    // #Find main learn records.
    // Enter Find Mode [ ]
    // Set Field [ testlearn::filterFind; "main" & ¶ ]
    // Perform Find [ ]
    #
    #Go to record user was on before add mode.
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::date; descending testlearn::timestamp; descending ] [ Restore; No dialog ]
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    Loop
    Exit Loop If [ testlearn::_Ltestlearn = $$returnRecord ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Clear all add mode variables and exit script.
    Set Variable [ $$returnWindow ]
    Set Variable [ $$returnLayout ]
    Set Variable [ $$returnRecord ]
    Set Variable [ $$tagLayout ]
    Set Variable [ $$stoploadCitation ]
    Perform Script [ “loadLearnOrRefMainRecord” ]
    #
    #If the user was in reference mode prior to add mode ...
    Else If [ $$returnWIndow = "References" ]
    #
    #Go to tag layout user was on before entering
    #add mode. ( This may not be useful as user
    # could also predict that tag window will stay
    # on the tag it is on in add mode. User might
    # not remember what tag they where on when
    # they started add mode. Have to see if this
    # is useful or not. )
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    #Get the record number.
    Set Variable [ $recordNumber; Value:Get (RecordNumber) ]
    #
    If [ $$citationMatch = "node" or $$citationMatch = "key" or $$citationMatch = "testItem" ]
    #
    Go to Layout [ Middle ( TEMP::layoutRtagK ; 5 ; 42 ) ]
    #
    Else If [ $$citationMatch = "medium" or $$citationMatch = "publication" or $$citationMatch = "publisher" or $$citationMatch = "path" ]
    Go to Layout [ “ReferenceMenu1” (tagMenus) ]
    #
    Else If [ $$citationMatch = "copyright" ]
    Go to Layout [ “ReferenceMenuCopyright” (tagMenus) ]
    End If
    #
    #This may be lazy, but instead of doing an if
    #test to figure out what window a user is in,
    #it seems that telling the system to select both
    #possible windows the user could be
    #in works just fine. The system always
    #selects the one the user is in.
    Select Window [ Name: "References"; Current file ]
    Select Window [ Name: "Learn"; Current file ]
    Set Window Title [ Current Window; New Title: "References" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “ReferenceStuff” (reference) ]
    Else
    Go to Layout [ “Reference” (reference) ]
    End If
    #
    #If adding to copyright records then remove/omit
    #locked reference copyright pictures.
    Select Window [ Name: "References"; Current file ]
    If [ $$citationMatch = "copyright" ]
    Set Variable [ $$stoploadCitation; Value:1 ]
    Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: reference::lock: “lock” ] [ Restore ]
    Set Variable [ $$stoploadCitation ]
    End If
    #
    #Keep the reference records the user found
    #instead of finding all the Reference records
    #when the user leaves add mode.
    // #Find main reference records.
    // Set Error Capture [ On ]
    // Allow User Abort [ Off ]
    // Enter Find Mode [ ]
    // Set Field [ reference::filterFind; "main" ]
    // Perform Find [ ]
    #
    #Go to record user was on before add mode.
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagKeywordPrimary::tag; ascending ] [ Restore; No dialog ]
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    Loop
    Exit Loop If [ reference::_Lreference = $$returnRecord ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Clear all add mode variables and exit script.
    Set Variable [ $$stoploadCitation ]
    Set Variable [ $$returnLayout ]
    Set Variable [ $$returnRecord ]
    Set Variable [ $$returnWindow ]
    Perform Script [ “loadLearnOrRefMainRecord” ]
    #
    #Go to record user was on before add mode.
    Scroll Window [ Home ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Go to Record/Request/Page [ $recordNumber ] [ No dialog ]
    #
    #If user was in the copyright window then
    #return user to this window.
    If [ $$userInCopyrightWindow = 1 ]
    Set Variable [ $$userInCopyrightWindow ]
    Perform Script [ “reviewCopyright” ]
    End If
    #
    End If
    End If
    #
    #Turn back on the last section of the
    #loadTagRecord script, which was turned on
    #when this add script started add mode.
    Set Variable [ $$doNotHaltOtherScripts ]
    #
    #
    #Go to tag menu window.
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    #

Fields used in this script

    TEMP::InventoryLibraryYN
    tempSetup::kdefaultNodePrimary
    tagCreatorLock::orderOrLock
    tagCreatorLock::tag
    tagMenus::match
    tagMenus::orderOrLock
    TEMP::ktestSubsection
    testSubsectionTemplate::_LtestSubsection
    testlearn::_Ltestlearn
    reference::lock
    reference::_Lreference
    reference::picture
    reference::URL
    tempSetup::kdefaultCopyright
    testlearn::filterFind
    testlearn::date
    testlearn::timestamp
    TEMP::layoutRtagK
    reference::filterFind
    tagKeywordPrimary::tag

Scripts used in this script

    loadLearnOrRefMainRecord
    menuTestItem
    reviewCopyright
    defaultNodeMenu

Layouts used in this script

    addMenuNodeKeyword
    addMenuTestItem
    addMenu1
    ReferenceAddToTag
    ReferenceAddToCopyright
    setupTestSubsection
    setupTestItem
    defaultSetup
    defaultCopyright
    defaultNode2
    <Missing Layout>
    ReferenceMenu1
    ReferenceMenuCopyright
    ReferenceStuff
    Reference

Tables used in this script

    TEMP
    TEMP
    reference
    tag
    tag
    testSubsectionTemplate
    testlearn

Table occurrences used by this script

    TEMP
    reference
    tagCreatorLock
    tagKeywordPrimary
    tagMenus
    tempSetup
    testSubsectionTemplate
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [addLinksPicturesToTagsMode]	Parent Folder: [pictures]	Next Script: [addPicture2ToTag]
Script Name	addPicture1ToTag
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferenceAddToTag
    ReferenceAddToCopyright

Scripts that use this script

Script Definition
Script Steps

    #
    #Note which button has been clicked ( 1, 2 or 3)
    #and if there is a picture to show then link it
    #to tag user is currently wanting to link it to.
    If [ reference::picture ≠ "" or reference::showMedia ≠ "" and reference::URL ≠ "" or reference::showMedia[2] ≠ "" and reference::fileName ≠ "" ]
    Set Variable [ $$name; Value:"picture" ]
    Set Variable [ $$number; Value:1 ]
    #
    #If the filterFind checkbox is not checked for the
    #the current $$CitationMatch variable, then
    #these next scripts will identify that problem,
    #fix it, and inform the user of what it did.
    If [ $$citationMatch = "key" ]
    If [ "keyword" & ¶ ≠ FilterValues ( reference::filterFind ; "keyword" & ¶) ]
    Set Variable [ $filterFind; Value:reference::filterFind ]
    Set Field [ reference::filterFind; "keyword" & ¶ & $filterFind ]
    // Show Custom Dialog [ Message: "The system has added this reference record to the " & If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) & " citation record set. You will not have to click the 'all' button anymore to find it for " & If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) & " tags." //Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " & //If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) & " tags."; Default Button: “OK”, Commit: “No” ]
    End If
    Else If [ $$citationMatch & ¶ ≠ FilterValues ( reference::filterFind ; $$citationMatch & ¶) ]
    Set Variable [ $filterFind; Value:reference::filterFind ]
    Set Field [ reference::filterFind; $$citationMatch & ¶ & $filterFind ]
    // Show Custom Dialog [ Message: "The system has added this reference record to the " & If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) & " citation record set. You will not have to click the 'all' button anymore to find it for " & If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) & " tags." //Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " & //If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) & " tags."; Default Button: “OK”, Commit: “No” ]
    End If
    #
    #Now perform the script that adds the tag.
    Perform Script [ “CHUNK_addPictureToTag” ]
    End If
    #

Fields used in this script

    reference::picture
    reference::showMedia
    reference::URL
    reference::fileName
    reference::filterFind

Scripts used in this script

    CHUNK_addPictureToTag

Layouts used in this script

Tables used in this script

    reference

Table occurrences used by this script

    reference

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [addPicture1ToTag]	Parent Folder: [pictures]	Next Script: [addPicture3ToTag]
Script Name	addPicture2ToTag
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferenceAddToTag

Scripts that use this script

Script Definition
Script Steps

    #
    #If user was in the copyright window then
    #return user to this window.
    If [ $$userInCopyrightWindow = 1 ]
    Show Custom Dialog [ Message: "For copyright records, there is only one picture allowed."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #Note which button has been clicked ( 1, 2 or 3)
    #and if there is a picture to show then link it
    #to tag user is currently wanting to link it to.
    If [ reference::picture ≠ "" or reference::showMedia ≠ "" and reference::URL ≠ "" or reference::showMedia[2] ≠ "" and reference::fileName ≠ "" ]
    Set Variable [ $$name; Value:"picture" ]
    Set Variable [ $$number; Value:2 ]
    #
    #If the filterFind checkbox is not checked for the
    #the current $$CitationMatch variable, then
    #these next scripts will identify that problem,
    #fix it, and inform the user of what it did.
    If [ $$citationMatch = "key" ]
    If [ "keyword" ≠ GetValue ( FilterValues ( reference::filterFind ; "keyword" ) ; 1 ) ]
    Set Variable [ $filterFind; Value:reference::filterFind ]
    Set Field [ reference::filterFind; "keyword" & ¶ & $filterFind ]
    // Show Custom Dialog [ Message: "The system has added this reference record to the " & If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) & " citation record set. You will not have to click the 'all' button anymore to find it for " & If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) & " tags." //Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " & //If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) & " tags."; Default Button: “OK”, Commit: “No” ]
    End If
    Else If [ $$citationMatch & ¶ ≠ FilterValues ( reference::filterFind ; $$citationMatch & ¶) ]
    Set Variable [ $filterFind; Value:reference::filterFind ]
    Set Field [ reference::filterFind; $$citationMatch & ¶ & $filterFind ]
    // Show Custom Dialog [ Message: "The system has added this reference record to the " & If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) & " citation record set. You will not have to click the 'all' button anymore to find it for " & If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) & " tags." //Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " & //If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) & " tags."; Default Button: “OK”, Commit: “No” ]
    End If
    #
    #Now perform the script that adds the tag.
    Perform Script [ “CHUNK_addPictureToTag” ]
    End If
    #

Fields used in this script

    reference::picture
    reference::showMedia
    reference::URL
    reference::fileName
    reference::filterFind

Scripts used in this script

    CHUNK_addPictureToTag

Layouts used in this script

Tables used in this script

    reference

Table occurrences used by this script

    reference

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [addPicture2ToTag]	Parent Folder: [pictures]	Next Script: [CHUNK_addPictureToTag]
Script Name	addPicture3ToTag
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferenceAddToTag

Scripts that use this script

Script Definition
Script Steps

    #
    #If user was in the copyright window then
    #return user to this window.
    If [ $$userInCopyrightWindow = 1 ]
    Show Custom Dialog [ Message: "For copyright records, there is only one picture allowed."; Default Button: “OK”, Commit: “No” ]
    Exit Script [ ]
    End If
    #
    #Note which button has been clicked ( 1, 2 or 3)
    #and if there is a picture to show then link it
    #to tag user is currently wanting to link it to.
    If [ reference::picture ≠ "" or reference::showMedia ≠ "" and reference::URL ≠ "" or reference::showMedia[2] ≠ "" and reference::fileName ≠ "" ]
    Set Variable [ $$name; Value:"picture" ]
    Set Variable [ $$number; Value:3 ]
    #
    #If the filterFind checkbox is not checked for the
    #the current $$CitationMatch variable, then
    #these next scripts will identify that problem,
    #fix it, and inform the user of what it did.
    If [ $$citationMatch = "key" ]
    If [ "keyword" & ¶ ≠ FilterValues ( reference::filterFind ; "keyword" & ¶) ]
    Set Variable [ $filterFind; Value:reference::filterFind ]
    Set Field [ reference::filterFind; "keyword" & ¶ & $filterFind ]
    // Show Custom Dialog [ Message: "The system has added this reference record to the " & If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) & " citation record set. You will not have to click the 'all' button anymore to find it for " & If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) & " tags." //Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " & //If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) & " tags."; Default Button: “OK”, Commit: “No” ]
    End If
    Else If [ $$citationMatch & ¶ ≠ FilterValues ( reference::filterFind ; $$citationMatch & ¶) ]
    Set Variable [ $filterFind; Value:reference::filterFind ]
    Set Field [ reference::filterFind; $$citationMatch & ¶ & $filterFind ]
    // Show Custom Dialog [ Message: "The system has added this reference record to the " & If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) & " citation record set. You will not have to click the 'all' button anymore to find it for " & If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) & " tags." //Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " & //If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) & " tags."; Default Button: “OK”, Commit: “No” ]
    End If
    #
    #Now perform the script that adds the tag.
    Perform Script [ “CHUNK_addPictureToTag” ]
    End If
    #

Fields used in this script

    reference::picture
    reference::showMedia
    reference::URL
    reference::fileName
    reference::filterFind

Scripts used in this script

    CHUNK_addPictureToTag

Layouts used in this script

Tables used in this script

    reference

Table occurrences used by this script

    reference

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [addPicture3ToTag]	Parent Folder: [pictures]	Next Script: [CHUNK_insertPictureOrMovie]
Script Name	CHUNK_addPictureToTag
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    addPicture1ToTag
    addPicture2ToTag
    addPicture3ToTag

Script Definition
Script Steps

    #
    #Get key for tag that is to be added to record.
    If [ Get ( LayoutTableName ) = "reference" ]
    Set Variable [ $tag; Value:reference::_Lreference ]
    Set Variable [ $number; Value:$$number ]
    Set Variable [ $$number ]
    Set Variable [ $name; Value:$$name ]
    Set Variable [ $$name ]
    Set Variable [ $window; Value:Get (WindowName) ]
    Else If [ Get ( LayoutTableName ) = "testlearn" ]
    Set Variable [ $tag; Value:testlearn::_Ltestlearn ]
    Set Variable [ $number; Value:$$number ]
    Set Variable [ $$number ]
    Set Variable [ $name; Value:$$name ]
    Set Variable [ $$name ]
    Set Variable [ $window; Value:Get (WindowName) ]
    End If
    #
    #Now add all the added record’s node and keyword
    #tags to any newly added sections.
    Perform Script [ “CHUNK_addReferenceNodeAndKeywordTagIDs” ]
    #
    #Complete process of adding picture to tag.
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    #Leave field so user can see
    #conditional formatting.
    Go to Field [ ]
    #
    #Remove key from other slots in may be in, to
    #prevent duplicates showing up.
    If [ tagMenus::Kpicture1 = $tag and $number ≠ 1 ]
    Set Field [ tagMenus::Kpicture1; "" ]
    Else If [ tagMenus::Kpicture2 = $tag and $number ≠ 2 ]
    Set Field [ tagMenus::Kpicture2; "" ]
    Else If [ tagMenus::Kpicture3= $tag and $number ≠ 3 ]
    Set Field [ tagMenus::Kpicture3; "" ]
    End If
    #
    #Place key in selected slot.
    If [ $name = "picture" ]
    #
    If [ tagMenus::Kpicture1 ≠ $tag and $number = 1 ]
    Set Field [ tagMenus::Kpicture1; $tag ]
    Select Window [ Name: $window; Current file ]
    Exit Script [ ]
    Else If [ tagMenus::Kpicture2 ≠ $tag and $number = 2 ]
    Set Field [ tagMenus::Kpicture2; $tag ]
    Select Window [ Name: $window; Current file ]
    Exit Script [ ]
    Else If [ tagMenus::Kpicture3 ≠ $tag and $number = 3 ]
    Set Field [ tagMenus::Kpicture3; $tag ]
    Select Window [ Name: $window; Current file ]
    Exit Script [ ]
    End If
    End If
    #
    #Remove it key if it is already in use.
    If [ $name = "picture" ]
    If [ tagMenus::Kpicture1 = $tag and $number = 1 ]
    Set Field [ tagMenus::Kpicture1; "" ]
    Else If [ tagMenus::Kpicture2 = $tag and $number = 2 ]
    Set Field [ tagMenus::Kpicture2; "" ]
    Else If [ tagMenus::Kpicture3 = $tag and $number = 3 ]
    Set Field [ tagMenus::Kpicture3; "" ]
    End If
    Select Window [ Name: $window; Current file ]
    #
    End If
    #

Fields used in this script

    reference::_Lreference
    testlearn::_Ltestlearn
    tagMenus::Kpicture1
    tagMenus::Kpicture2
    tagMenus::Kpicture3

Scripts used in this script

    CHUNK_addReferenceNodeAndKeywordTagIDs

Layouts used in this script

Tables used in this script

    reference
    tag
    testlearn

Table occurrences used by this script

    reference
    tagMenus
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [CHUNK_addPictureToTag]	Parent Folder: [pictures]	Next Script: [clearpicture1]
Script Name	CHUNK_insertPictureOrMovie
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    pictureReplaceButton
    showCitationPicture1inNewWindow

Script Definition
Script Steps

    #
    #
    #
    #!!! IMPORTANT !!! SAY WHAT !!! HERE YE, HERE YE !!!
    #
    #If converting from fp7, replace unknown
    #fields below as noted below. Also update all
    #FileInsert script steps as noted below.
    #
    #!!! IMPORTANT !!! SAY WHAT !!! HERE YE, HERE YE !!!
    #
    #
    #Admin tasks.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #Tranfer the global variables to local variables
    #and then clear the globals. This way these
    #needed variables don't need to be cleared
    #before every exit step in this script, as local
    #variables expire as soon as the script exits.
    Set Variable [ $picture; Value:$$picture ]
    Set Variable [ $reportTable; Value:$$reportTable ]
    Set Variable [ $fileLocation; Value:$$fileLocation ]
    Set Variable [ $learnLayout; Value:$$learnLayout ]
    Set Variable [ $referenceLayout; Value:$$referenceLayout ]
    #
    Set Variable [ $$picture ]
    Set Variable [ $$reportTable ]
    Set Variable [ $$fileLocation ]
    Set Variable [ $$learnLayout ]
    Set Variable [ $$referenceLayout ]
    #
    #
    #If the user is replacing media, then the Media
    #window will already be open, and the script
    #needs to know what table media is going into.
    If [ Get ( WindowName ) = "Media" ]
    #
    #If user is on a reference layout...
    If [ Get (LayoutTableName) = "reference" ]
    Set Variable [ $referenceLayout; Value:1 ]
    #
    #If user is on a learn layout...
    Else If [ Get (LayoutTableName) = "testLearn" or Get (LayoutTableName) = "testLearnReportTags" ]
    Set Variable [ $learnLayout; Value:1 ]
    End If
    #
    End If
    #
    #
    #------------------------
    #
    #
    #BEGIN: iDevice
    #
    #
    #If the user in on an iDevice...
    If [ Get ( SystemPlatform ) = 3 ]
    #
    #
    #
    #NOTE: This sequence of questions may seem
    #to be in reverse order, however, FileMaker
    #displays sequences of buttons from
    #right-to-left instead of left-to-right, so
    #LastMessageChoice 1 = right,
    #2 = middle, and 3 = left button, thus for the
    #dialogue box the user sees we have to deal
    #here in reverse order so it reads left to right for
    #the user.
    #
    #
    #
    #Ask user if they want to
    # A) get media from an iDevice's library,
    # B) create new media with the camera,
    # C) or cancel.
    Show Custom Dialog [ Message: "Get a picture, or movie, from your device's media library; or use its camera to take a picture, or make a movie?"; Default Button: “cancel”, Commit: “Yes”; Button 2: “camera”, Commit: “No”; Button 3: “library”, Commit: “No” ]
    #
    #
    #
    #BEGIN Answer C (cancel)
    #
    #
    #
    #C) If the user cancels, then exit the script.
    If [ Get ( LastMessageChoice ) = 1 ]
    #
    #If on a reference layout ...
    If [ $referenceLayout = 1 ]
    #
    #If media is required, insert a place holder.
    If [ $$ReplaceMeMediaRequired = 1 ]
    Set Field [ reference::picture; "Replace Me. Media Required" ]
    Set Variable [ $$ReplaceMeMediaRequired ]
    End If
    #
    #If in inventory mode, turn back on variable that
    #allows the user to edit this reference record.
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Set Variable [ $$editLocation; Value:reference::_Lreference ]
    End If
    #
    End If
    #
    Exit Script [ ]
    #
    #
    #
    #END Answer C (cancel)
    #
    #
    #
    #BEGIN Answer B (create new media with the camera)
    #
    #
    #
    #B) If the user selects the camera option
    #ask them if they want to use it to ...
    Else If [ Get ( LastMessageChoice ) = 2 ]
    # B1) take a picture,
    # B2) make a movie,
    # B3) or cancel.
    Show Custom Dialog [ Message: "Take a picture or make a movie?"; Default Button: “cancel”, Commit: “No”; Button 2: “movie”, Commit: “No”; Button 3: “picture”, Commit: “No” ]
    #
    #
    #BEGIN Answer B3 (cancel)
    #
    #
    #B3) If the user cancels, then exit the script.
    If [ Get ( LastMessageChoice ) = 1 ]
    Exit Script [ ]
    #
    #
    #END Answer B3 (cancel)
    #
    #
    #BEGIN Answer B2 (make a movie)
    #
    #
    #B2) If the user clicks 'movie'...
    Else If [ Get ( LastMessageChoice ) = 2 ]
    #
    #Prevent record load scripts and
    #and then open new window.
    If [ Get ( WindowName ) ≠ "Media" ]
    Set Variable [ $$stoploadCitation; Value:1 ]
    Set Variable [ $$stoploadtestinfo; Value:1 ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Set Variable [ $$stopLoadTestRecord; Value:1 ]
    Set Variable [ $$stopLoadTestResultRecord; Value:1 ]
    New Window [ Name: "Media"; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Set Zoom Level [ 100%; Camera: Back; Resolution: Full ]
    #
    #Go to correct media layout.
    If [ $referenceLayout = 1 ]
    Go to Layout [ “ReferencePictureWindowEDIT” (reference) ]
    Else If [ $learnLayout = 1 ]
    Go to Layout [ “LearnPictureWindowEDIT” (testlearn) ]
    End If
    #
    #If library was focused on a report table layout,
    #then the first testlearn table record will be
    #showing and not the report record the user
    #was just on (report layouts are tied to alias
    #tables of the testlearn table). To insert the
    #new media into the correct record, it must first
    #be found.
    If [ $reportTable = 1 ]
    Enter Find Mode [ ]
    Set Field [ testlearn::_Ltestlearn; $picture ]
    Perform Find [ ]
    End If
    #
    #Restart record load scripts.
    Set Variable [ $$stoploadCitation ]
    Set Variable [ $$stoploadtestinfo ]
    Set Variable [ $$stopLoadTagRecord ]
    Set Variable [ $$stopLoadTestRecord ]
    Set Variable [ $$stopLoadTestResultRecord ]
    End If
    #
    #Go to the picture field to accept new media.
    If [ $referenceLayout = 1 ]
    Go to Field [ reference::picture ]
    Else If [ $learnLayout = 1 ]
    Go to Field [ testlearn::picture ]
    End If
    #
    #Give user access to device's media controls.
    #If converting from fp7replace 'unknown' script
    #step below with 'Insert from Device' with the
    #following options:
    # type: Video Camera
    # camera: Back; Resolution: full
    Insert from Device [ Type: Video Camera; Camera: Back; Resolution: Full ]
    #
    #
    #If the user cancels, the photo field will be
    #empty, and the window needs to be closed.
    If [ reference::picture = "" and $referenceLayout = 1 ]
    #
    #
    #If media is required, insert a place holder.
    If [ $$ReplaceMeMediaRequired = 1 ]
    Set Field [ reference::picture; "Replace Me. Media Required" ]
    Set Variable [ $$ReplaceMeMediaRequired ]
    End If
    #
    #If in inventory mode, turn back on variable that
    #allows the user to edit this reference record.
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Set Variable [ $$editLocation; Value:reference::_Lreference ]
    End If
    #
    #Close window and exit script.
    Close Window [ Current Window ]
    Exit Script [ ]
    #
    #
    #If media is never required because this is a
    #learn record just close the window.
    Else If [ testlearn::picture = "" and $learnLayout = 1 ]
    Close Window [ Current Window ]
    Exit Script [ ]
    End If
    #
    #
    #Allow the user to look at their new media.
    Go to Field [ ]
    Pause/Resume Script [ Indefinitely ]
    Set Variable [ $$ReplaceMeMediaRequired ]
    Exit Script [ ]
    #
    #
    #END Answer B2 (make a movie)
    #
    #
    #BEGIN Answer B1 (take a picture)
    #
    #
    #B1) If the user clicks 'picture'...
    Else If [ Get ( LastMessageChoice ) = 3 ]
    #
    #Prevent record load scripts and
    #and then open new window.
    If [ Get ( WindowName ) ≠ "Media" ]
    Set Variable [ $$stoploadCitation; Value:1 ]
    Set Variable [ $$stoploadtestinfo; Value:1 ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Set Variable [ $$stopLoadTestRecord; Value:1 ]
    Set Variable [ $$stopLoadTestResultRecord; Value:1 ]
    New Window [ Name: "Media"; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Set Zoom Level [ 100%; Camera: Back; Resolution: Full ]
    #
    #Go to correct media layout.
    If [ $referenceLayout = 1 ]
    Go to Layout [ “ReferencePictureWindowEDIT” (reference) ]
    Else If [ $learnLayout = 1 ]
    Go to Layout [ “LearnPictureWindowEDIT” (testlearn) ]
    End If
    #
    #If library was focused on a report table layout,
    #then the first testlearn table record will be
    #showing and not the report record the user
    #was just on (report layouts are tied to alias
    #tables of the testlearn table). To insert the
    #new media into the correct record, it must first
    #be found.
    If [ $reportTable = 1 ]
    Enter Find Mode [ ]
    Set Field [ testlearn::_Ltestlearn; $picture ]
    Perform Find [ ]
    End If
    #
    #Restart record load scripts.
    Set Variable [ $$stoploadCitation ]
    Set Variable [ $$stoploadtestinfo ]
    Set Variable [ $$stopLoadTagRecord ]
    Set Variable [ $$stopLoadTestRecord ]
    Set Variable [ $$stopLoadTestResultRecord ]
    End If
    #
    #Go to the picture field to accept new media.
    If [ $referenceLayout = 1 ]
    Go to Field [ reference::picture ]
    Else If [ $learnLayout = 1 ]
    Go to Field [ testlearn::picture ]
    End If
    #
    #Give user access to device's media controls.
    #If converting from fp7replace 'unknown' script
    #step below with 'Insert from Device' with the
    #following options:
    # type: Camera
    # camera: Back; Resolution: full
    Insert from Device [ Type: Camera; Camera: Back; Resolution: Full ]
    #
    #
    #If the user cancels, the photo field will be
    #empty, and the window needs to be closed.
    If [ reference::picture = "" and $referenceLayout = 1 ]
    #
    #
    #If media is required, insert a place holder.
    If [ $$ReplaceMeMediaRequired = 1 ]
    Set Field [ reference::picture; "Replace Me. Media Required" ]
    Set Variable [ $$ReplaceMeMediaRequired ]
    End If
    #
    #If in inventory mode, turn back on variable that
    #allows the user to edit this reference record.
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Set Variable [ $$editLocation; Value:reference::_Lreference ]
    End If
    #
    #Close window and exit script.
    Close Window [ Current Window ]
    Exit Script [ ]
    #
    #
    #If media is never required because this is a
    #learn record just close the window.
    Else If [ testlearn::picture = "" and $learnLayout = 1 ]
    Close Window [ Current Window ]
    Exit Script [ ]
    End If
    #
    #
    #Allow the user to look at their new media.
    Go to Field [ ]
    Pause/Resume Script [ Indefinitely ]
    Exit Script [ ]
    End If
    #
    #
    #END Answer B1 (take a picture)
    #
    #
    #
    #END Answer B (create new media with the camera)
    #
    #
    #
    #BEGIN Answer A (get media from an iDevice's library)
    #
    #
    #
    #A) If the user selects the library option...
    Else If [ Get ( LastMessageChoice ) = 3 ]
    #
    #Prevent record load scripts and
    #and then open new window.
    If [ Get ( WindowName ) ≠ "Media" ]
    Set Variable [ $$stoploadCitation; Value:1 ]
    Set Variable [ $$stoploadtestinfo; Value:1 ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Set Variable [ $$stopLoadTestRecord; Value:1 ]
    Set Variable [ $$stopLoadTestResultRecord; Value:1 ]
    New Window [ Name: "Media"; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Set Zoom Level [ 100%; Camera: Back; Resolution: Full ]
    #
    #Go to correct media layout.
    If [ $referenceLayout = 1 ]
    Go to Layout [ “ReferencePictureWindowEDIT” (reference) ]
    Else If [ $learnLayout = 1 ]
    Go to Layout [ “LearnPictureWindowEDIT” (testlearn) ]
    End If
    #
    #If library was focused on a report table layout,
    #then the first testlearn table record will be
    #showing and not the report record the user
    #was just on (report layouts are tied to alias
    #tables of the testlearn table). To insert the
    #new media into the correct record, it must first
    #be found.
    If [ $reportTable = 1 ]
    Enter Find Mode [ ]
    Set Field [ testlearn::_Ltestlearn; $picture ]
    Perform Find [ ]
    End If
    #
    #Restart record load scripts.
    Set Variable [ $$stoploadCitation ]
    Set Variable [ $$stoploadtestinfo ]
    Set Variable [ $$stopLoadTagRecord ]
    Set Variable [ $$stopLoadTestRecord ]
    Set Variable [ $$stopLoadTestResultRecord ]
    End If
    #
    #Go to the picture field to accept new media.
    If [ $referenceLayout = 1 ]
    Go to Field [ reference::picture ]
    Else If [ $learnLayout = 1 ]
    Go to Field [ testlearn::picture ]
    End If
    #
    #Give user access to device's photo library.
    #If converting from fp7replace 'unknown' script
    #step below with 'Insert from Device' with the
    #following options:
    # type: Photo Library
    Insert from Device [ Type: Photo Library ]
    #
    #
    #If the user cancels, the photo field will be
    #empty, and the window needs to be closed.
    If [ reference::picture = "" and $referenceLayout = 1 ]
    #
    #
    #If media is required, insert a place holder.
    If [ $$ReplaceMeMediaRequired = 1 ]
    Set Field [ reference::picture; "Replace Me. Media Required" ]
    Set Variable [ $$ReplaceMeMediaRequired ]
    End If
    #
    #If in inventory mode, turn back on variable that
    #allows the user to edit this reference record.
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Set Variable [ $$editLocation; Value:reference::_Lreference ]
    End If
    #
    #Close window and exit script.
    Close Window [ Current Window ]
    Exit Script [ ]
    #
    #
    #If media is never required because this is a
    #learn record just close the window.
    Else If [ testlearn::picture = "" and $learnLayout = 1 ]
    Close Window [ Current Window ]
    Exit Script [ ]
    End If
    #
    #
    #Allow the user to look at their new media.
    Go to Field [ ]
    Set Variable [ $$ReplaceMeMediaRequired ]
    Pause/Resume Script [ Indefinitely ]
    Exit Script [ ]
    End If
    #
    #
    #
    #END Answer A (get media from an iDevice's library)
    #
    #
    #END: iDevice
    #
    #
    #------------------------
    #
    #
    #BEGIN: Desktop/Laptop Computer
    #
    #
    #If the user in on an desktop/laptop computer...
    Else If [ Get ( SystemPlatform ) ≠ 3 ]
    #
    #
    #
    #NOTE: This sequence of questions may seem
    #to be in reverse order, however, FileMaker
    #displays sequences of buttons from
    #right-to-left instead of left-to-right, so
    #LastMessageChoice 1 = right,
    #2 = middle, and 3 = left button, thus for the
    #dialogue box the user sees we have to deal
    #here in reverse order so it reads left to right for
    #the user.
    #
    #
    #
    #Ask user if they want to
    # A) insert a picture from a hard drive,
    # B) insert a movie from a hard drive,
    # C) or cancel.
    Show Custom Dialog [ Message: "Select a picture or movie to insert."; Default Button: “cancel”, Commit: “Yes”; Button 2: “movie”, Commit: “No”; Button 3: “picture”, Commit: “No” ]
    #
    #
    #BEGIN Answer C (cancel)
    #
    #
    #C) If the user cancels, then halt the script and
    #also the showCitationPicture1inNewWindow
    #script.
    If [ Get ( LastMessageChoice ) = 1 ]
    #
    #If on a reference layout ...
    If [ $referenceLayout = 1 ]
    #
    #If media is required and there is no media,
    #then insert a place holder.
    If [ $$ReplaceMeMediaRequired = 1 and reference::showMedia[1] = "" and reference::showMedia[2] = "" ]
    Set Field [ reference::picture; "Replace Me. Media Required" ]
    Set Variable [ $$ReplaceMeMediaRequired ]
    End If
    #
    #If in inventory mode, turn back on variable that
    #allows the user to edit this reference record.
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Set Variable [ $$editLocation; Value:reference::_Lreference ]
    End If
    #
    End If
    #
    Exit Script [ ]
    #
    #
    #END Answer C (cancel)
    #
    #
    #BEGIN Answer B (insert movie from a hard drive)
    #
    #
    #B) If the user clicks 'movie'...
    Else If [ Get ( LastMessageChoice ) = 2 ]
    #
    #Prevent record load scripts and
    #and then open new window.
    If [ Get ( WindowName ) ≠ "Media" ]
    Set Variable [ $$stoploadCitation; Value:1 ]
    Set Variable [ $$stoploadtestinfo; Value:1 ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Set Variable [ $$stopLoadTestRecord; Value:1 ]
    Set Variable [ $$stopLoadTestResultRecord; Value:1 ]
    New Window [ Name: "Media"; Height: Get (ScreenHeight)/2; Width: Get (ScreenWidth)/2; Top: Get (ScreenHeight)/4; Left: Get (ScreenWidth)/4; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Set Zoom Level [ 100%; Camera: Back; Resolution: Full ]
    #
    #If user is on a reference layout...
    If [ Get (LayoutTableName) = "reference" ]
    Set Variable [ $referenceLayout; Value:1 ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “ReferenceSTagMenusPictureWindowEDIT” (reference) ]
    Else
    Go to Layout [ “ReferencePictureWindowEDIT” (reference) ]
    End If
    #
    #If user is on a learn layout...
    Else If [ Get (LayoutTableName) = "testLearn" or Get (LayoutTableName) = "testLearnReportTags" ]
    Set Variable [ $learnLayout; Value:1 ]
    Go to Layout [ “LearnPictureWindowEDIT” (testlearn) ]
    End If
    #
    #If library was focused on a report table layout,
    #then the first testlearn table record will be
    #showing and not the report record the user
    #was just on (report layouts are tied to alias
    #tables of the testlearn table). To insert the
    #new media into the correct record, it must first
    #be found.
    If [ $reportTable = 1 ]
    Enter Find Mode [ ]
    Set Field [ testlearn::_Ltestlearn; $picture ]
    Perform Find [ ]
    End If
    #
    #Restart record load scripts.
    Set Variable [ $$stoploadCitation ]
    Set Variable [ $$stoploadtestinfo ]
    Set Variable [ $$stopLoadTagRecord ]
    Set Variable [ $$stopLoadTestRecord ]
    Set Variable [ $$stopLoadTestResultRecord ]
    End If
    #
    #Go to the picture field to accept new media.
    If [ $referenceLayout = 1 ]
    Go to Field [ reference::picture ]
    Else If [ $learnLayout = 1 ]
    Go to Field [ testlearn::picture ]
    End If
    #
    #If converting from fp7 file change "Insert file [ ]"
    #>> Dialogue options << as follows:
    #
    # add new dialogue option: COPY AND PASTE THIS TEXT >> "Playable movies mp4, m4v" ; extensions: mp4, m4v
    #
    # Storage options: SELECT >>> insert <<<
    #
    # Display: SELECT >>> content of file (when possible) <<<
    Insert File [ ] [ Filters ] [ "All Files": ( *.* ) ] [ "Playable movies mp4, m4v": ( mp4, m4v ) ] [ Storage method: Insert ] [ Display content ] [ Compression: Never compress ]
    #
    If [ Get ( LastError ) = 732 ]
    Show Custom Dialog [ Message: "This file cannot be inserted because it contains other files. (You could compress/zip it if you really want to store it here.)"; Default Button: “OK”, Commit: “No” ]
    Else If [ Get ( LastError ) = 731 ]
    Show Custom Dialog [ Message: "File you are importing from contains no data."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #If the user cancels, the photo field will be
    #empty, and the window needs to be closed.
    If [ reference::picture = "" and $referenceLayout = 1 ]
    #
    #If there is reference media the user must have
    #clicked the replace button, and now that they
    #are canceling, they need to be returned to
    #the reference picture layout in the
    #Media window, BUT if there is no media,
    #then close the Media window.
    If [ reference::showMedia[1] = "" and reference::showMedia[2] = "" ]
    Close Window [ Current Window ]
    End If
    #
    #If media is required, insert a place holder.
    If [ $$ReplaceMeMediaRequired = 1 and reference::showMedia[1] = "" and reference::showMedia[2] = "" ]
    Set Field [ reference::picture; "Replace Me. Media Required" ]
    Set Variable [ $$ReplaceMeMediaRequired ]
    End If
    #
    #If in inventory mode, turn back on variable that
    #allows the user to edit this reference record.
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Set Variable [ $$editLocation; Value:reference::_Lreference ]
    End If
    #
    Exit Script [ ]
    Else If [ testlearn::picture = "" and $learnLayout = 1 ]
    #
    #If there is reference media the user must have
    #clicked the replace button, and now that they
    #are canceling, they need to be returned to
    #the reference picture layout in the
    #Media window.
    If [ testlearn::kshowReferencedMedia = "" ]
    Close Window [ Current Window ]
    End If
    #
    Exit Script [ ]
    End If
    #
    #Allow the user to look at their new media.
    Go to Field [ ]
    Set Variable [ $$ReplaceMeMediaRequired ]
    #
    #Remove reference media if user just replaced
    #it with media inserted into this learn record.
    Set Field [ testlearn::kshowReferencedMedia; "" ]
    Exit Script [ ]
    #
    #
    #END Answer B (insert movie from a hard drive)
    #
    #
    #BEGIN Answer A (insert picture from a hard drive)
    #
    #
    #A) If the user clicks 'picture'...
    Else If [ Get ( LastMessageChoice ) = 3 ]
    #
    #Prevent record load scripts and
    #and then open new window.
    If [ Get ( WindowName ) ≠ "Media" ]
    Set Variable [ $$stoploadCitation; Value:1 ]
    Set Variable [ $$stoploadtestinfo; Value:1 ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Set Variable [ $$stopLoadTestRecord; Value:1 ]
    Set Variable [ $$stopLoadTestResultRecord; Value:1 ]
    New Window [ Name: "Media"; Height: Get (ScreenHeight)/2; Width: Get (ScreenWidth)/2; Top: Get (ScreenHeight)/4; Left: Get (ScreenWidth)/4; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Set Zoom Level [ 100%; Camera: Back; Resolution: Full ]
    #
    #If user is on a reference layout...
    If [ Get (LayoutTableName) = "reference" ]
    Set Variable [ $referenceLayout; Value:1 ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “ReferenceSTagMenusPictureWindowEDIT” (reference) ]
    Else
    Go to Layout [ “ReferencePictureWindowEDIT” (reference) ]
    End If
    #
    #If user is on a learn layout...
    Else If [ Get (LayoutTableName) = "testLearn" or Get (LayoutTableName) = "testLearnReportTags" ]
    Set Variable [ $learnLayout; Value:1 ]
    Go to Layout [ “LearnPictureWindowEDIT” (testlearn) ]
    End If
    #
    #
    #
    #If library was focused on a report table layout,
    #then the first testlearn table record will be
    #showing and not the report record the user
    #was just on (report layouts are tied to alias
    #tables of the testlearn table). To insert the
    #new media into the correct record, it must first
    #be found.
    If [ $reportTable = 1 ]
    Enter Find Mode [ ]
    Set Field [ testlearn::_Ltestlearn; $picture ]
    Perform Find [ ]
    End If
    #
    #Restart record load scripts.
    Set Variable [ $$stoploadCitation ]
    Set Variable [ $$stoploadtestinfo ]
    Set Variable [ $$stopLoadTagRecord ]
    Set Variable [ $$stopLoadTestRecord ]
    Set Variable [ $$stopLoadTestResultRecord ]
    End If
    #
    #Go to the picture field to accept new media.
    If [ $referenceLayout = 1 ]
    Go to Field [ reference::picture ]
    Else If [ $learnLayout = 1 ]
    Go to Field [ testlearn::picture ]
    End If
    Insert Picture [ ]
    #
    If [ Get ( LastError ) = 732 ]
    Show Custom Dialog [ Message: "This file cannot be inserted because it contains other files. (You could compress/zip it if you really want to store it here.)"; Default Button: “OK”, Commit: “No” ]
    Else If [ Get ( LastError ) = 731 ]
    Show Custom Dialog [ Message: "File you are importing from contains no data."; Default Button: “OK”, Commit: “Yes” ]
    Else If [ Get ( LastError ) = 734 ]
    Show Custom Dialog [ Message: "This file type cannot be displayed as a picture."; Default Button: “OK”, Commit: “No” ]
    Else If [ Get ( LastError ) = 735 ]
    Show Custom Dialog [ Message: "This file type will be displayed as a file, unlike these types = bmp, eps (sometimes), gif, jpeg, jpg, mov, m4v, mp4, pdf, png, psd, sgi, tga, tif, and tiff."; Default Button: “OK”, Commit: “No” ]
    End If
    #
    #If the user cancels, the photo field will be
    #empty, and the window needs to be closed.
    If [ reference::picture = "" and $referenceLayout = 1 ]
    #
    #If there is reference media the user must have
    #clicked the replace button, and now that they
    #are canceling, they need to be returned to
    #the reference picture layout in the
    #Media window, BUT if there is no media,
    #then close the Media window.
    If [ reference::showMedia[1] = "" and reference::showMedia[2] = "" ]
    Close Window [ Current Window ]
    End If
    #
    #If media is required, insert a place holder.
    If [ $$ReplaceMeMediaRequired = 1 and reference::showMedia[1] = "" and reference::showMedia[2] = "" ]
    Set Field [ reference::picture; "Replace Me. Media Required" ]
    Set Variable [ $$ReplaceMeMediaRequired ]
    End If
    #
    #If in inventory mode, turn back on variable that
    #allows the user to edit this reference record.
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Set Variable [ $$editLocation; Value:reference::_Lreference ]
    End If
    #
    Exit Script [ ]
    Else If [ testlearn::picture = "" and $learnLayout = 1 ]
    #
    #If there is reference media the user must have
    #clicked the replace button, and now that they
    #are canceling, they need to be returned to
    #the reference picture layout in the
    #Media window, BUT if there is no media,
    #then close the Media window.
    If [ testlearn::kshowReferencedMedia = "" ]
    Close Window [ Current Window ]
    End If
    #
    Exit Script [ ]
    End If
    #
    #Allow the user to look at their new media.
    Go to Field [ ]
    Set Variable [ $$ReplaceMeMediaRequired ]
    #
    #Remove reference media if user just replaced
    #it with media inserted into this learn record.
    Set Field [ testlearn::kshowReferencedMedia; "" ]
    Exit Script [ ]
    End If
    #
    End If
    #
    #
    #END Answer A (insert picture from a hard drive)
    #
    #
    #END: Desktop/Laptop Computer
    #
    #

Fields used in this script

    reference::picture
    TEMP::InventoryLibraryYN
    reference::_Lreference
    testlearn::_Ltestlearn
    testlearn::picture
    reference::showMedia
    testlearn::kshowReferencedMedia

Scripts used in this script

Layouts used in this script

    ReferencePictureWindowEDIT
    LearnPictureWindowEDIT
    ReferenceSTagMenusPictureWindowEDIT

Tables used in this script

    TEMP
    reference
    testlearn

Table occurrences used by this script

    TEMP
    reference
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [CHUNK_insertPictureOrMovie]	Parent Folder: [pictures]	Next Script: [clearpicture2]
Script Name	clearpicture1
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    PrintReportEdit

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Prevent open reference window from being
    #closed and the Tag Menus window from being
    #resized during this process.
    Set Variable [ $$stopClosingResizingWindows; Value:1 ]
    #
    #Capture field name where the action of
    #the next script needs to focus, and then
    #perform this script.
    Go to Field [ report::kTag1 ]
    Perform Script [ “removeTestResultOrInfoRecordFromReport” ]
    Go to Field [ ]

Fields used in this script

    report::kTag1

Scripts used in this script

    removeTestResultOrInfoRecordFromReport

Layouts used in this script

Tables used in this script

    report

Table occurrences used by this script

    report

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [clearpicture1]	Parent Folder: [pictures]	Next Script: [clearpicture3]
Script Name	clearpicture2
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    PrintReportEdit

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Prevent open reference window from being
    #closed and the Tag Menus window from being
    #resized during this process.
    Set Variable [ $$stopClosingResizingWindows; Value:1 ]
    #
    #Capture field name where the action of
    #the next script needs to focus, and then
    #perform this script.
    Go to Field [ report::kTag2 ]
    Perform Script [ “removeTestResultOrInfoRecordFromReport” ]
    Go to Field [ ]

Fields used in this script

    report::kTag2

Scripts used in this script

    removeTestResultOrInfoRecordFromReport

Layouts used in this script

Tables used in this script

    report

Table occurrences used by this script

    report

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [clearpicture2]	Parent Folder: [pictures]	Next Script: [clearpicture4]
Script Name	clearpicture3
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    PrintReportEdit

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Prevent open reference window from being
    #closed and the Tag Menus window from being
    #resized during this process.
    Set Variable [ $$stopClosingResizingWindows; Value:1 ]
    #
    #Capture field name where the action of
    #the next script needs to focus, and then
    #perform this script.
    Go to Field [ report::kTag3 ]
    Perform Script [ “removeTestResultOrInfoRecordFromReport” ]
    Go to Field [ ]

Fields used in this script

    report::kTag3

Scripts used in this script

    removeTestResultOrInfoRecordFromReport

Layouts used in this script

Tables used in this script

    report

Table occurrences used by this script

    report

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [clearpicture3]	Parent Folder: [pictures]	Next Script: [exitIfNotiPhone]
Script Name	clearpicture4
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    PrintReportEdit

Scripts that use this script

Script Definition
Script Steps

    #
    #Prevent open reference window from being
    #closed and the Tag Menus window from being
    #resized during this process.
    Set Variable [ $$stopClosingResizingWindows; Value:1 ]
    #
    #Capture field name where the action of
    #the next script needs to focus, and then
    #perform this script.
    Go to Field [ report::kTag4 ]
    Perform Script [ “removeTestResultOrInfoRecordFromReport” ]
    Go to Field [ ]

Fields used in this script

    report::kTag4

Scripts used in this script

    removeTestResultOrInfoRecordFromReport

Layouts used in this script

Tables used in this script

    report

Table occurrences used by this script

    report

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [clearpicture4]	Parent Folder: [pictures]	Next Script: [pictureDelete]
Script Name	exitIfNotiPhone
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    If [ $$PictureOnReportLayout ≠ "" ]
    Go to Field [ ]
    End If

Fields used in this script

Scripts used in this script

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [exitIfNotiPhone]	Parent Folder: [pictures]	Next Script: [pictureExport]
Script Name	pictureDelete
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferencePictureWindowEDIT
    ReferenceSPictureWindowEDIT
    ReferenceSTagMenusPictureWindowEDIT
    LearnPictureWindowEDIT

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Admin tasks.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #
    #If record is locked (which all default
    #copyright symbols used for locked
    #copyright tags are), then exit the script.
    If [ reference::lock = "lock" ]
    Show Custom Dialog [ Message: "This record is used by default copyright tags and so is locked."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #
    #If the primary node that created this record is
    #locked then exit the script.
    If [ tagTLNodePrimary::orderOrLock ≠ "" or $$PictureOnReportLayout ≠ "" ]
    If [ tagTLNodePrimary::orderOrLock = "0" ]
    Show Custom Dialog [ Message: "This Learn record's creator — " & tagTLNodePrimary::tag & " — is locked. To unlock, A) go back to the setup node tag menu. B) Select this test subject. C) Click 'lock' and enter the password."; Default Button: “OK”, Commit: “No” ]
    Else If [ tagTLReportNodePrimary::orderOrLock = "0" ]
    Show Custom Dialog [ Message: "This Learn record's creator — " & tagTLReportNodePrimary::tag & " — is locked. To unlock, A) go back to the setup node tag menu. B) Select this test subject. C) Click 'lock' and enter the password."; Default Button: “OK”, Commit: “No” ]
    End If
    Exit Script [ ]
    End If
    #
    #
    #See if reference's media is in use and then
    # inform user if it is that they cannot delete it.
    Set Variable [ $$pictureDelete; Value:1 ]
    If [ Get (LayoutTableName) = "reference" ]
    Perform Script [ “CHUNK_checkIfReferencePicIsInUse” ]
    End If
    #
    #If CHUNK_checkIfReferencePicIsInUse finds that the
    #reference's media is in use, then stop this delete.
    If [ $$pictureDelete = 2 ]
    Set Variable [ $$pictureDelete ]
    #
    #
    If [ $$replacePicture = 1 ]
    Perform Script [ “pictureReplaceButton” ]
    End If
    #
    #Halt the script if the Media window was just
    #closed, so the "continue" button will be
    #turned off allowing user to move to other
    #windows.
    If [ Get (WindowName) = "References" ]
    Halt Script
    Else
    Exit Script [ ]
    End If
    #
    #If not then proceed with the delete.
    Else
    Set Variable [ $$pictureDelete ]
    End If
    #
    #
    #Confirm reference media is free to be deleted,
    #and ask user if they want to delete it.
    If [ reference::picture ≠ "" and reference::lock = "" ]
    Show Custom Dialog [ Message: "Delete current picture?"; Default Button: “Cancel”, Commit: “Yes”; Button 2: “OK”, Commit: “No” ]
    #
    #If user cancels delete, exit script.
    If [ Get ( LastMessageChoice ) = 1 ]
    Go to Field [ ]
    Exit Script [ ]
    #
    #If user decides to delete media, then delete it and
    #make sure other media checkboxes are not checked.
    Else If [ Get ( LastMessageChoice ) = 2 ]
    Set Field [ reference::picture; "" ]
    Set Field [ reference::showMedia; "" ]
    #
    #Close the Media window and halt all running scripts.
    Close Window [ Current Window ]
    Halt Script
    End If
    #
    #
    #Ask user if they want to delete Learn media.
    Else If [ testlearn::picture ≠ "" ]
    Show Custom Dialog [ Message: "Delete current picture?"; Default Button: “Cancel”, Commit: “No”; Button 2: “OK”, Commit: “No” ]
    #
    #If user cancels delete, exit script.
    If [ Get ( LastMessageChoice ) = 1 ]
    Go to Field [ ]
    Exit Script [ ]
    End If
    #
    If [ testlearn::kcInUseOnReportSubsection ≠ "" ]
    If [ ValueCount ( testlearn::kcInUseOnReportSubsection ) = 1 ]
    Show Custom Dialog [ Message: "This learn records picture and text are in use in the report section " & ValueCount ( testlearn::kcInUseOnReportSubsection ) & " time. (Deleting the picture, like editing the text, will not remove the link to the report, just change what is on it.)"; Default Button: “Cancel”, Commit: “Yes”; Button 2: “delete”, Commit: “No” ]
    Else
    Show Custom Dialog [ Message: "This learn records picture and text are in use in the report section " & ValueCount ( testlearn::kcInUseOnReportSubsection ) & " times? (Deleting the picture, like editing the text, will not remove links to the report, just change what is on them.)"; Default Button: “cancel”, Commit: “Yes”; Button 2: “delete”, Commit: “No” ]
    End If
    End If
    #
    #If user cancels delete, exit script.
    If [ Get ( LastMessageChoice ) = 1 ]
    Go to Field [ ]
    Exit Script [ ]
    #
    #If user decides to delete media, then delete it.
    Else If [ Get ( LastMessageChoice ) = 2 ]
    Set Field [ testlearn::picture; "" ]
    #
    #Close the Media window and halt all running scripts.
    Close Window [ Current Window ]
    Halt Script
    End If
    End If
    #

Fields used in this script

    reference::lock
    tagTLNodePrimary::orderOrLock
    tagTLNodePrimary::tag
    tagTLReportNodePrimary::orderOrLock
    tagTLReportNodePrimary::tag
    reference::picture
    reference::showMedia
    testlearn::picture
    testlearn::kcInUseOnReportSubsection

Scripts used in this script

    CHUNK_checkIfReferencePicIsInUse
    pictureReplaceButton

Layouts used in this script

Tables used in this script

    reference
    tag
    testlearn

Table occurrences used by this script

    reference
    tagTLNodePrimary
    tagTLReportNodePrimary
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [pictureDelete]	Parent Folder: [pictures]	Next Script: [pictureReplaceButton]
Script Name	pictureExport
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferencePictureWindow
    ReferenceSPictureWindow
    ReferencePictureWindowEDIT
    ReferenceSPictureWindowEDIT
    ReferenceSTagMenusPictureWindowEDIT
    LearnPictureWindow
    LearnPictureWindowEDIT
    LearnRefPictureWindow
    LearnRefPictureWindowEDIT

Scripts that use this script

Script Definition
Script Steps

    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    If [ reference::picture ≠ "" ]
    #
    #
    #If a creative commons trademark then the user needs to get a new copy of the file from the web.
    #
    #
    #
    Show Custom Dialog [ ]
    Export Field Contents [ reference::picture ]
    Else If [ testlearn::picture ≠ "" ]
    Export Field Contents [ testlearn::picture ]
    Else If [ testlearnReportTags::picture ≠ "" ]
    Export Field Contents [ testlearnReportTags::picture ]
    Else If [ refLearnShowMedia::picture ≠ "" ]
    Export Field Contents [ refLearnShowMedia::picture ]
    End If

Fields used in this script

    reference::picture
    testlearn::picture
    testlearnReportTags::picture
    refLearnShowMedia::picture

Scripts used in this script

Layouts used in this script

Tables used in this script

    reference
    testlearn

Table occurrences used by this script

    refLearnShowMedia
    reference
    testlearn
    testlearnReportTags

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [pictureExport]	Parent Folder: [pictures]	Next Script: [pictureViewButton]
Script Name	pictureReplaceButton
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferencePictureWindowEDIT
    ReferenceSPictureWindowEDIT
    ReferenceSTagMenusPictureWindowEDIT
    ReferencePictureWindow_WebEDIT
    ReferencePictureWindow_HDDEDIT
    LearnPictureWindowEDIT
    LearnRefPictureWindowEDIT
    LearnRefWebPictureWindowEDIT
    LearnRefExternalPictureWindowEDIT

Scripts that use this script

    pictureDelete

Script Definition
Script Steps

    #
    #
    #If record is locked, which all default
    #copyright symbols used for locked
    #copyright tags are, then exit the script.
    If [ reference::lock = "lock" ]
    Show Custom Dialog [ Message: "This record is used by default copyright tags and so is locked."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #
    #If the primary node for this record is locked
    #then exit the script.
    If [ tagTLNodePrimary::orderOrLock ≠ "" or $$PictureOnReportLayout ≠ "" ]
    If [ tagTLNodePrimary::orderOrLock = "0" ]
    Show Custom Dialog [ Message: "This Learn record's creator — " & tagTLNodePrimary::tag & " — is locked. To unlock, A) go back to the setup node tag menu. B) Select this test subject. C) Click 'lock' and enter the password."; Default Button: “OK”, Commit: “No” ]
    Else If [ tagTLReportNodePrimary::orderOrLock = "0" ]
    Show Custom Dialog [ Message: "This Learn record's creator — " & tagTLReportNodePrimary::tag & " — is locked. To unlock, A) go back to the setup node tag menu. B) Select this test subject. C) Click 'lock' and enter the password."; Default Button: “OK”, Commit: “No” ]
    End If
    Exit Script [ ]
    End If
    #
    #
    #
    #
    #Learn Media Window for Reference Media
    #
    #Ask the user if they want to replace the media with
    #new media or with a reference tag's media.
    If [ Left ( Get ( LayoutName ) ; 8 ) = "LearnRef" ]
    Set Variable [ $referenceLayout; Value:1 ]
    Show Custom Dialog [ Message: "Add a new picture or movie or display a different reference tag's picture or movie?"; Default Button: “cancel”, Commit: “Yes”; Button 2: “display”, Commit: “No”; Button 3: “new”, Commit: “No” ]
    #
    #If the user cancels, exit this script.
    If [ Get (LastMessageChoice) = 1 ]
    Exit Script [ ]
    #
    #If the user decides on using a reference tag's media,
    #tell the user how to do this.
    Else If [ Get (LastMessageChoice) = 2 ]
    If [ $$pictureWindowColor = "test" or $$pictureWindowColor = "report" ]
    #If on a test module layout...
    Show Custom Dialog [ Message: "1) Click 'back'. 2) Click 'edit/new'. 3) Click 'Qv'. 4) From the Qv's reference section, select a reference tag's picture/movie to show."; Default Button: “OK”, Commit: “Yes” ]
    Else
    #If on a Learn module layout...
    Show Custom Dialog [ Message: "1) click 'back'. 2) Click 'Qv'. 3) From the Qv's reference section, select a reference tag's picture/movie to show."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #If the user decides on new media, add new media.
    Else If [ Get (LastMessageChoice) = 3 ]
    Set Variable [ $refMediaLayout; Value:Get (LayoutName) ]
    Set Variable [ $kshowReferencedMedia; Value:testlearn::kshowReferencedMedia ]
    #
    #Go to Learn media layout to accept
    #new learn media.
    Go to Layout [ “LearnPictureWindowEDIT” (testlearn) ]
    Perform Script [ “CHUNK_insertPictureOrMovie” ]
    If [ testlearn::picture = "" ]
    Go to Layout [ $refMediaLayout ]
    Set Field [ testlearn::kshowReferencedMedia; $kshowReferencedMedia ]
    End If
    End If
    #
    #
    #
    #
    #Reference Media Window
    Else If [ Left ( Get ( LayoutName ) ; 9 ) = "reference" and Get ( LayoutTableName ) = "reference" ]
    #
    #
    #Ask the user if they want to replace media
    #with new media or display web or HDD
    #media, UNLESS the library is in inventory
    #mode, in which case the only option is to
    #replace the media in the picture field, so
    #don't ask any questions, just proceed to
    #replacing it.
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Perform Script [ “CHUNK_insertPictureOrMovie” ]
    #
    Else If [ TEMP::InventoryLibraryYN = "" ]
    Show Custom Dialog [ Message: "Add a new picture or movie, or display web or harddrive media?"; Default Button: “cancel”, Commit: “Yes”; Button 2: “display”, Commit: “No”; Button 3: “new”, Commit: “No” ]
    #
    #If the user cancels, exit this script.
    If [ Get (LastMessageChoice) = 1 ]
    Exit Script [ ]
    #
    #If the user decides on displaying external media,
    #tell the user how to do this.
    Else If [ Get (LastMessageChoice) = 2 ]
    #
    #
    If [ $$replacePicture = 1 ]
    Set Variable [ $$replacePicture ]
    Set Field [ reference::picture; "Replace Me. Media Required" ]
    Close Window [ Name: "Media"; Current file ]
    #
    Else If [ $$replacePicture = "" ]
    #
    If [ reference::showMedia[1] = "" and reference::showMedia[2] = "" ]
    Show Custom Dialog [ Message: "1) Click 'x' to delete the current picture. 2) Click 'back'. 3) Add a webpage url below and click the WebMedia checkbox, or 4) enter a media file's name, add its folder-path tag, and click the HDDMedia checkbox."; Default Button: “OK”, Commit: “Yes” ]
    Else
    Show Custom Dialog [ Message: "1) Click 'back'. 3) Add a new webpage url below and click the WebMedia checkbox, or 4) enter a new media file's name, add its folder-path tag, and click the HDDMedia checkbox."; Default Button: “OK”, Commit: “Yes” ]
    End If
    End If
    #
    #If the user decides on new media = message
    #choice 3, replace the media.
    Else If [ Get (LastMessageChoice) = 3 ]
    #
    #The replace button could have been clicked
    #on a web or HDD media layout, so go to the
    #picture field layout before adding media to it.
    Go to Layout [ “ReferencePictureWindowEDIT” (reference) ]
    #
    #Add new media.
    Perform Script [ “CHUNK_insertPictureOrMovie” ]
    #
    #If user canceled add and there is no picture
    #return to the layout on which the replace was
    #button was clicked.
    If [ reference::picture = "" ]
    Go to Layout [ original layout ]
    #
    #If the user added new media, make sure web
    #and harddrive checkboxes are unchecked.
    Else
    Set Field [ reference::showMedia; "" ]
    Set Field [ reference::showMedia[2]; "" ]
    End If
    End If
    #
    End If
    #
    #
    #
    #
    #Learn Media Window
    Else
    #
    #Ask the user if they want to replace the media with
    #new media or with a reference tag's media, except
    #when on the test layout where users can only add
    #new media.
    If [ testlearn::filterFind = "main" & ¶ or testlearn::filterFind = "main" ]
    #If on a Learn module layout...
    Show Custom Dialog [ Message: "Add a new picture or movie or display a reference tag's picture or movie?"; Default Button: “cancel”, Commit: “Yes”; Button 2: “display”, Commit: “No”; Button 3: “new”, Commit: “No” ]
    Else If [ testlearn::filterFind = "" ]
    #If on a test module layout...
    Show Custom Dialog [ Message: "Add a new picture or movie?"; Default Button: “cancel”, Commit: “Yes”; Button 3: “new”, Commit: “No” ]
    End If
    #
    #If the user cancels, exit this script.
    If [ Get (LastMessageChoice) = 1 ]
    Exit Script [ ]
    #
    #If the user decides on using a reference tag's media,
    #tell the user how to do this.
    Else If [ Get (LastMessageChoice) = 2 ]
    If [ $$pictureWindowColor = "test" or $$pictureWindowColor = "report" ]
    #If on a test module layout...
    Show Custom Dialog [ Message: "1) Click 'x' to delete the current picture. 2) Click 'back'. 3) Click 'edit/new'. 4) Click 'Qv'. 5) From the Qv's reference section, select a reference tag's picture/movie to show."; Default Button: “OK”, Commit: “Yes” ]
    Else
    #If on a Learn module layout...
    Show Custom Dialog [ Message: "1) Click 'x' to delete the current picture. 2) Click 'back'. 3) Click 'Qv'. 4) From the Qv's reference section, select a reference tag's picture/movie to show."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    Else If [ Get (LastMessageChoice) = 3 ]
    #If the user decides on new media, add new media.
    Perform Script [ “CHUNK_insertPictureOrMovie” ]
    End If
    End If
    #

Fields used in this script

    reference::lock
    tagTLNodePrimary::orderOrLock
    tagTLNodePrimary::tag
    tagTLReportNodePrimary::orderOrLock
    tagTLReportNodePrimary::tag
    testlearn::kshowReferencedMedia
    testlearn::picture
    TEMP::InventoryLibraryYN
    reference::picture
    reference::showMedia
    testlearn::filterFind

Scripts used in this script

    CHUNK_insertPictureOrMovie

Layouts used in this script

    LearnPictureWindowEDIT
    ReferencePictureWindowEDIT

Tables used in this script

    TEMP
    reference
    tag
    testlearn

Table occurrences used by this script

    TEMP
    reference
    tagTLNodePrimary
    tagTLReportNodePrimary
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [pictureReplaceButton]	Parent Folder: [pictures]	Next Script: [reportCopyPastPart2Tag1]
Script Name	pictureViewButton
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferencePictureWindow
    ReferenceSPictureWindow
    ReferencePictureWindowEDIT
    ReferenceSPictureWindowEDIT
    ReferenceSTagMenusPictureWindowEDIT
    ReferencePictureWindow_Web
    ReferencePictureWindow_WebEDIT
    ReferencePictureWindow_HDD
    ReferencePictureWindow_HDDEDIT
    LearnPictureWindow
    LearnPictureWindowEDIT
    LearnRefPictureWindow
    LearnRefPictureWindowEDIT
    LearnRefWebPictureWindow
    LearnRefWebPictureWindowEDIT
    LearnRefExternalPictureWindow
    LearnRefExternalPictureWindowEDIT

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Toggle between small and full screen picture
    #window, unless on iDevice, in which case tell
    #the user how to use two fingers to zoom
    #in and out.
    Go to Field [ ]
    If [ Get ( SystemPlatform ) = 3 ]
    Show Custom Dialog [ Message: "Touch two fingers to the screen and pinch and spread apart to zoom in and out. NOTE: On desktop/laptop computers this button increases/decreases the media's size."; Default Button: “OK”, Commit: “Yes” ]
    Else
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Move/Resize Window [ Current Window; Height: If ( 435 = Get (WindowHeight) ; Get (ScreenHeight) ; 435 ); Width: If ( 435 = Get (WindowHeight); Get (ScreenWidth) ; 400 ); Top: If ( 435 = Get (WindowHeight) ; 0 ; Get (ScreenHeight) / 4 ); Left: If ( 435 = Get (WindowHeight) ; 0 ; Get (ScreenWidth) / 4 ) ]
    Else
    Move/Resize Window [ Current Window; Height: If ( 395 = Get (WindowHeight) ; Get (ScreenHeight) ; 395 ); Width: If ( 395 = Get (WindowHeight); Get (ScreenWidth) ; 400 ); Top: If ( 395 = Get (WindowHeight) ; 0 ; Get (ScreenHeight) / 4 ); Left: If ( 395= Get (WindowHeight) ; 0 ; Get (ScreenWidth) / 4 ) ]
    End If
    End If
    #
    #
    #Turned this off because it kept YouTube
    #video's from resizing quickly.
    // #Had to insert two zoom levels in order to get
    // #the header to show up. With the just the 100
    // #zoom, the header will sometimes disappear,
    // #until you manually zoom 75 then back to 100.
    // Set Zoom Level [ 75%; Camera: Back; Resolution: Full ]
    // Set Zoom Level [ 100%; Camera: Back; Resolution: Full ]

Fields used in this script

    TEMP::InventoryLibraryYN

Scripts used in this script

Layouts used in this script

Tables used in this script

    TEMP

Table occurrences used by this script

    TEMP

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [pictureViewButton]	Parent Folder: [pictures]	Next Script: [reportCopyPastPart2Tag2]
Script Name	reportCopyPastPart2Tag1
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    PrintReportEdit

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Prevent open reference window from being
    #closed and the Tag Menus window from being
    #resized during this process.
    Set Variable [ $$stopClosingResizingWindows; Value:1 ]
    #
    #Capture field name where the action of
    #the next script needs to focus, and then
    #perform this script.
    Go to Field [ report::kTag1 ]
    Perform Script [ “reportCopyPastPart3” ]
    Go to Field [ ]

Fields used in this script

    report::kTag1

Scripts used in this script

    reportCopyPastPart3

Layouts used in this script

Tables used in this script

    report

Table occurrences used by this script

    report

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [reportCopyPastPart2Tag1]	Parent Folder: [pictures]	Next Script: [reportCopyPastPart2Tag3]
Script Name	reportCopyPastPart2Tag2
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    PrintReportEdit

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Prevent open reference window from being
    #closed and the Tag Menus window from being
    #resized during this process.
    Set Variable [ $$stopClosingResizingWindows; Value:1 ]
    #
    #Capture field name where the action of
    #the next script needs to focus, and then
    #perform this script.
    Go to Field [ report::kTag2 ]
    Perform Script [ “reportCopyPastPart3” ]
    Go to Field [ ]

Fields used in this script

    report::kTag2

Scripts used in this script

    reportCopyPastPart3

Layouts used in this script

Tables used in this script

    report

Table occurrences used by this script

    report

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [reportCopyPastPart2Tag2]	Parent Folder: [pictures]	Next Script: [reportCopyPastPart2Tag4]
Script Name	reportCopyPastPart2Tag3
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    PrintReportEdit

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Prevent open reference window from being
    #closed and the Tag Menus window from being
    #resized during this process.
    Set Variable [ $$stopClosingResizingWindows; Value:1 ]
    #
    #Capture field name where the action of
    #the next script needs to focus, and then
    #perform this script.
    Go to Field [ report::kTag3 ]
    Perform Script [ “reportCopyPastPart3” ]
    Go to Field [ ]

Fields used in this script

    report::kTag3

Scripts used in this script

    reportCopyPastPart3

Layouts used in this script

Tables used in this script

    report

Table occurrences used by this script

    report

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [reportCopyPastPart2Tag3]	Parent Folder: [pictures]	Next Script: [selectLearnRecordsTaggedReferenceRecord]
Script Name	reportCopyPastPart2Tag4
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    PrintReportEdit

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Prevent open reference window from being
    #closed and the Tag Menus window from being
    #resized during this process.
    Set Variable [ $$stopClosingResizingWindows; Value:1 ]
    #
    #Capture field name where the action of
    #the next script needs to focus, and then
    #perform this script.
    Go to Field [ report::kTag4 ]
    Set Variable [ $$photo ]
    Perform Script [ “reportCopyPastPart3” ]
    Go to Field [ ]

Fields used in this script

    report::kTag4

Scripts used in this script

    reportCopyPastPart3

Layouts used in this script

Tables used in this script

    report

Table occurrences used by this script

    report

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [reportCopyPastPart2Tag4]	Parent Folder: [pictures]	Next Script: [showCitationPicture1inNewWindow]
Script Name	selectLearnRecordsTaggedReferenceRecord
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    learn4
    learnStuff4
    learnStuff5
    learn4EDIT
    learn4EDITstuff

Scripts that use this script

Script Definition
Script Steps

    #
    #If node is currenlty locked then stop script, inform user.
    If [ tagTLNodePrimary::orderOrLock ≠ "" ]
    Show Custom Dialog [ Message: "The node — " & tagTLNodePrimary::tag & " — is locked. Go to the Default Node Tag Menu and A) click 'lock' to unlock it."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #This script is activited by the picture
    #selection button on the QV layout. It allows
    #the user to show a selected reference's
    #media in the layout's picture window.
    If [ testlearn::picture = "" ]
    If [ testlearn::kshowReferencedMedia = refLearn::_Lreference ]
    Set Field [ testlearn::kshowReferencedMedia; "" ]
    Set Variable [ $$refMediaSelectedToShow; Value:Case ( testlearn::kshowReferencedMedia = "" ; "" ; testlearn::kshowReferencedMedia ) ]
    Else If [ //There is a picture to show if... refLearn::picture ≠ "" or refLearn::showMedia ≠ "" and refLearn::URL ≠ "" or refLearn::showMedia[2] ≠ "" and refLearn::kfileLocation ≠ "" and refLearn::fileName ≠ "" ]
    Set Field [ testlearn::kshowReferencedMedia; refLearn::_Lreference ]
    Set Variable [ $$refMediaSelectedToShow; Value:Case ( testlearn::kshowReferencedMedia = "" ; "" ; testlearn::kshowReferencedMedia ) ]
    Else
    If [ TEMP::InventoryLibraryYN = "" ]
    Show Custom Dialog [ Message: "This reference has no media to show. Picture button will be a darker grey if there is media to show."; Default Button: “OK”, Commit: “Yes” ]
    Else
    Show Custom Dialog [ Message: "This location has no media to show. Picture button will be a darker grey if there is media to show."; Default Button: “OK”, Commit: “Yes” ]
    End If
    End If
    #
    Else
    #If the learn record has a picture then stop
    #this script and tell the user to remove it
    #before adding a reference picture.
    Set Field [ testlearn::kshowReferencedMedia; "" ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Show Custom Dialog [ Message: "To show a reference picture, first remove the picture that is currently showing. 1) Click on the picture. 2) Click the 'x' button in the picture window."; Default Button: “OK”, Commit: “Yes” ]
    Else
    Show Custom Dialog [ Message: "To show a location picture, first remove the picture that is currently showing. 1) Click on the picture. 2) Click the 'x' button in the picture window."; Default Button: “OK”, Commit: “Yes” ]
    End If
    End If
    #
    #
    #Insure that FileMaker knows about change, or
    #else the file and web button scripts will fail to
    #calculate the change.
    Commit Records/Requests
    #
    #

Fields used in this script

    tagTLNodePrimary::orderOrLock
    tagTLNodePrimary::tag
    testlearn::picture
    testlearn::kshowReferencedMedia
    refLearn::_Lreference
    refLearn::picture
    refLearn::showMedia
    refLearn::URL
    refLearn::kfileLocation
    refLearn::fileName
    TEMP::InventoryLibraryYN

Scripts used in this script

Layouts used in this script

Tables used in this script

    TEMP
    reference
    tag
    testlearn

Table occurrences used by this script

    TEMP
    refLearn
    tagTLNodePrimary
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [selectLearnRecordsTaggedReferenceRecord]	Parent Folder: [pictures]	Next Script: [showCitationPicture2inNewWindow]
Script Name	showCitationPicture1inNewWindow
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultsAll
    defaultCopyright
    CopyrightVIEW
    CopyrightEDIT
    defaultNode2
    defaultNode3
    defaultNode4
    Reference
    ReferenceStuff
    ReferenceEDIT
    ReferenceMenuCopyright
    ReferenceMenu3Cite
    ReferenceMenu2keywordOrNode3
    ReferenceMenu2SkeywordOrNode3
    ReferenceMenu2keywordOrNode4
    ReferenceMenu2SkeywordOrNode4
    ReferenceMenu2keywordOrNode5
    ReferenceMenu2SkeywordOrNode5
    ReferenceMenu3CiteFind
    addMenu1
    addMenuNodeKeyword
    addMenu2
    addMenuTestItem
    ReferenceAddToTag
    ReferenceAddToCopyright
    learn0
    learn1
    learnStuff1
    learn2
    learn3
    learnStuff3
    learn4
    learnStuff4
    learn5
    learnStuff5
    learn4EDIT
    learn4EDITLocked
    learn4EDITstuff
    learn4EDITstuffLocked
    ltagNK3
    ltagNKs3
    ltagNK4
    ltagNK5
    learnMenu3Cite
    learnMenuRefStuff
    learnMenu4RefCite
    learnMenu4STUFFRefCite
    learnFindCite
    learnFindStuffCite
    learnMenu4RefCiteFindTL
    learnMenu4RefStuffCiteFindTL
    testResult0
    testResultLOCKED0
    testResult1
    testResultLOCKED1
    testInfo
    TestInfoReference
    testInfoText
    testInfoTextLocked
    reportTestResult
    reportTestResultLocked
    reportTagInfo

Scripts that use this script

    showPrimaryNodePicture
    showCitationPicture2inNewWindow
    showCitationPicture3inNewWindow
    showRefHarddriveMedia
    showRefWebMedia
    showTestSubjectCopyrightPicture
    addORremovePrimaryTag
    addORremoveRefTagStep1
    findPrimaryRef
    findPrimaryTL
    showPicture1
    showPicture2
    showPicture3
    showPicture4

Script Definition
Script Steps

    #
    #
    #Admin tasks.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #Stop script if user clicked in the media field to
    #navigate to this record, not to open the media
    #window.
    If [ $$stopOpenNewTextWindow = 1 ]
    Set Variable [ $$stopOpenNewTextWindow ]
    Exit Script [ ]
    End If
    #
    #If on the Tag Menus learn layout and there
    #is no media to show, exit this script.
    If [ Get ( WindowName ) = "Tag Menus" and Get ( LayoutTableName ) = "testlearn" and testlearn::picture = "" and testlearn::kshowReferencedMedia = "" ]
    Exit Script [ ]
    End If
    #
    #
    #In inventory mode, if the user is not in any
    #hidden fields, and there is no media for this
    #record, and the user just activated this script
    #by clicking on the empty media field, then
    #show the hidden fields including the hidden
    #media field so the user can click on it and add
    #a media if they want to.
    If [ Get ( WindowName ) = "Tag Menus" and reference::picture = "" and $$editLocation = reference::_Lreference and TEMP::InventoryLibraryYN ≠ "" ]
    If [ Get ( ActiveFieldName ) = "" ]
    Go to Object [ Object Name: "tag 1" ]
    Refresh Window
    Halt Script
    Else
    Set Variable [ $$editLocation ]
    Set Variable [ $openHIddenPicture; Value:1 ]
    Refresh Window
    End If
    End If
    Go to Field [ ]
    #
    #
    #Make sure on layouts where long text field
    #extends over the picture field AND when this
    #field is has text because there is no picture to
    #cover up, that this script is stopped, and the
    #user is taken to this long text field instead of
    #the picture window opening up.
    If [ reference::referenceHidePicture ≠ "" and Get (LayoutTableName) = "reference" and Get (WindowName) = "Tag Menus" and $openHIddenPicture = "" or reference::referenceHidePicture ≠ "" and Get (LayoutName) = "TestInfoReference" ]
    Go to Object [ Object Name: "tag 1" ]
    Set Variable [ $$stopGoToKeyTag; Value:1 ]
    Exit Script [ ]
    Else If [ Get (LayoutTableName) = "tagMenus" and tagMenus::tagTestTextItemOrLongTagField ≠ "" ]
    Go to Object [ Object Name: "tag 1" ]
    Exit Script [ ]
    End If
    #
    #If in stuff/inventory mode and the user is in
    #the reference section which does not have an
    #edit screen, then tell user when they click on
    #a picture that they cannot edit if its creator is
    #locked. In reference mode, the user expects
    #to see a view only picture window on the
    #main reference list screen. The edit picture
    #reference window only shows up in reference
    #mode when the user is on the edit screen, but
    #since in stuff mode the list view shows
    #editable records, show this message so the
    #user knows why they are not seeing an edit
    #picture screen.
    If [ TEMP::InventoryLibraryYN ≠ "" and Get(LayoutTableName) = "reference" and $$add = "" and Get (WindowName) ≠ "Tag Menus" ]
    If [ refCreatorNode::orderOrLock ≠ "" ]
    Show Custom Dialog [ Message: "The node that created this record — " & refCreatorNode::tag & " — is locked. Select this node in the setup window and enter the password to unlock it, then you will able to edit records assigned to it."; Default Button: “OK”, Commit: “Yes” ]
    Else If [ TEMP::primaryNodeIsLocked ≠ "" ]
    Show Custom Dialog [ Message: "The default primary node — " & TEMP::DEFAULTNodePrimaryName & " — is locked. Go to the Default Node Tag Menu and A) click 'lock' to unlock it, B) select an unlocked node for the primary node, or C) create a new primary node."; Default Button: “OK”, Commit: “No” ]
    End If
    End If
    #
    #If reference media is required and the user is on a
    #reference edit layout, note this in case user decides
    #to cancel the insert media section of this script.
    If [ reference::picture = "Replace Me. Media Required" and Get (LayoutName) = "ReferenceEDIT" or reference::picture = "Replace Me. Media Required" and Get (LayoutName) = "ReferenceStuff" ]
    Set Field [ reference::picture; "" ]
    Set Variable [ $$ReplaceMeMediaRequired; Value:1 ]
    Go to Field [ ]
    Else
    Set Variable [ $$ReplaceMeMediaRequired ]
    End If
    #
    #
    #To prevent multiple copies of the media
    #window being left open, always close it when
    #starting this script.
    Close Window [ Name: "Media"; Current file ]
    #
    #
    #If the PRIMARY node is currenlty locked then
    If [ $$add = "" ]
    If [ TEMP::primaryNodeIsLocked ≠ "" ]
    Set Variable [ $lock; Value:1 ]
    // #If the primary node's CREATOR node is
    // Else If [ TEMP::primaryNodesCreatorNodeIsLocked ≠ "" ]
    // Set Variable [ $lock; Value:1 ]
    #If the TEST SUBJECT node is locked then stop
    Else If [ testSubsectionTestSubjectLock::orderOrLock = "0" or ReportResultTestSubject::orderOrLock ≠ "" or reportTestSubjectLock::orderOrLock = "0" ]
    Set Variable [ $lock; Value:1 ]
    #If the LEARN record's creator node is locked then stop
    Else If [ tagTLNodePrimary::orderOrLock = "0" or tagTLReportNodePrimary::orderOrLock = "0" ]
    Set Variable [ $lock; Value:1 ]
    #If the REFERENCE record's creator node is locked then stop
    Else If [ refCreatorNode::orderOrLock = "0" or refLearnCreatorNodeLock::orderOrLock = "0" or refLearnTestCreatorNodeLock::orderOrLock = "0" ]
    Set Variable [ $lock; Value:1 ]
    End If
    End If
    #
    #
    #
    #Determine source of media and layout. This
    #info/variables will determine whether to show
    #user an edit or view-only window, and whether
    #to show user a web, harddrive, or FileMaker
    #media window.
    #
    #
    #If user is on a reference layout...
    If [ Get (LayoutTableName) = "tempSetup" or Get (LayoutTableName) = "reference" or Get (LayoutTableName) = "tagMenus" ]
    Set Variable [ $referenceLayout; Value:1 ]
    #
    If [ Get (LayoutTableName) = "tempSetup" ]
    #SETUP DEFAULTS WINDOW
    If [ $$defaultTestSubjecPicture ≠ "" ]
    Set Variable [ $picture; Value:$$defaultTestSubjecPicture ]
    Set Variable [ $fileLocation; Value:$$fileLocation ]
    Else If [ $$defaultPrimaryNodePicture ≠ "" ]
    Set Variable [ $picture; Value:$$defaultPrimaryNodePicture ]
    Set Variable [ $fileLocation; Value:$$fileLocation ]
    Else
    Set Variable [ $picture; Value:defaultNodesCopyright::Kpicture1 ]
    Set Variable [ $fileLocation; Value:Case ( defaultNodeCopyrightsPicture::picture ≠ "" ; "database" ; defaultNodeCopyrightsPicture::kfileLocation ≠ "" and defaultNodeCopyrightsPicture::fileName ≠ "" and defaultNodeCopyrightsPicture::showMedia = "" ; "harddrive" ; defaultNodeCopyrightsPicture::URL ≠ "" and defaultNodeCopyrightsPicture::showMedia ≠ "" ; "web" ; "tag=none" ) ]
    End If
    #
    Else If [ Get (LayoutTableName) = "reference" ]
    #REFERENCE WINDOW
    Set Variable [ $picture; Value:reference::_Lreference ]
    Set Variable [ $fileLocation; Value:Case ( reference::picture ≠ "" ; "database" ; reference::kfileLocation ≠ "" and reference::fileName ≠ "" and reference::showMedia[2] ≠ "" ; "harddrive" ; reference::URL ≠ "" and reference::showMedia ≠ "" ; "web" ; Case ( Get (LayoutName) = "ReferenceEDIT" or Get (LayoutName) = "ReferenceSTUFF" or Get (LayoutName) = "learnMenuRefStuff" ; "none" ; "tag=none" ) ) ]
    If [ Get (LayoutName) = "ReferenceEDIT" and tagTLNodePrimary::orderOrLock = "" ]
    Set Variable [ $referenceEDIT; Value:1 ]
    End If
    #
    Else If [ Get (LayoutTableName) = "tagMenus" ]
    #TAG MENUS WINDOW (Reference and Learn tags)
    If [ $$picture = "" ]
    Set Variable [ $picture; Value:tagMenus::Kpicture1 ]
    Set Variable [ $fileLocation; Value:Case ( refPicture1::picture ≠ "" ; "database" ; refPicture1::kfileLocation ≠ "" and refPicture1::fileName ≠ "" and refPicture1::showMedia = "" ; "harddrive" ; refPicture1::URL ≠ "" and refPicture1::showMedia ≠ "" ; "web" ; "tag=none" ) ]
    Else If [ $$picture = "Kpicture2" ]
    Set Variable [ $picture; Value:tagMenus::Kpicture2 ]
    Set Variable [ $fileLocation; Value:Case ( refPicture2::picture ≠ "" ; "database" ; refPicture2::kfileLocation ≠ "" and refPicture2::fileName ≠ "" and refPicture2::showMedia = "" ; "harddrive" ; refPicture2::URL ≠ "" and refPicture2::showMedia ≠ "" ; "web" ; "tag=none" ) ]
    Else If [ $$picture = "Kpicture3" ]
    Set Variable [ $picture; Value:tagMenus::Kpicture3 ]
    Set Variable [ $fileLocation; Value:Case ( refPicture3::picture ≠ "" ; "database" ; refPicture3::kfileLocation ≠ "" and refPicture3::fileName ≠ "" and refPicture3::showMedia = "" ; "harddrive" ; refPicture3::URL ≠ "" and refPicture3::showMedia ≠ "" ; "web" ; "tag=none" ) ]
    End If
    End If
    #
    #
    #If user is on a learn layout...
    Else If [ Get (LayoutTableName) = "testLearn" or Get (LayoutTableName) = "testlearnReportTags" or Get (LayoutTableName) = "report" ]
    Set Variable [ $learnLayout; Value:1 ]
    #
    If [ Get (LayoutTableName) = "testLearn" ]
    #LEARN and TEST WINDOWS
    Set Variable [ $picture; Value:testlearn::_Ltestlearn ]
    Set Variable [ $fileLocation; Value:Case ( testlearn::picture ≠ "" ; "TLpicture" ; Case ( refLearnShowMedia::picture ≠ "" ; "database" ; refLearnShowMedia::kfileLocation ≠ "" and refLearnShowMedia::fileName ≠ "" and refLearnShowMedia::showMedia = "" ; "harddrive" ; refLearnShowMedia::URL ≠ "" and refLearnShowMedia::showMedia ≠ "" ; "web" ; "none" ) ) ]
    #
    Else If [ Get (LayoutTableName) = "testlearnReportTags" ]
    #TEST INFO and REPORT INFO WINDOWS
    Set Variable [ $picture; Value:testlearnReportTags::_Ltestlearn ]
    Set Variable [ $fileLocation; Value:Case ( testlearnReportTags::picture ≠ "" ; "TLpicture" ; Case ( refTestShowMedia::picture ≠ "" ; "database" ; refTestShowMedia::kfileLocation ≠ "" and refTestShowMedia::fileName ≠ "" and refTestShowMedia::showMedia = "" ; "harddrive" ; refTestShowMedia::URL ≠ "" and refTestShowMedia::showMedia ≠ "" ; "web" ; Case ( testlearnReportTags::filterFind = "" ; "none" ; "tag=none" ) ) ) ]
    Set Variable [ $reportTable; Value:1 ]
    #
    Else If [ Get (LayoutTableName) = "report" ]
    #REPORT IWINDOW
    Set Variable [ $picture; Value:$$PictureOnReportLayout ]
    Set Variable [ $fileLocation; Value:$$fileLocation ]
    Set Variable [ $reportTable; Value:1 ]
    End If
    End If
    #
    #
    #Clear variables that transferred information
    #about a picture field on the default setup, tag
    #menu, or report layout when the user clicked
    #on it triggering this script.
    Set Variable [ $$picture ]
    Set Variable [ $$fileLocation ]
    Set Variable [ $$PictureOnReportLayout ]
    Set Variable [ $$defaultTestSubjecPicture ]
    Set Variable [ $$defaultPrimaryNodePicture ]
    #
    #
    #If the user clicked on a picture field that is
    #empty in the tag window exit this script, unless the user is in an inventory library.
    If [ $fileLocation = "tag=none" or $fileLocation = "none" and $lock = 1 ]
    #
    #Don't bother telling user how to add a picture
    #to tag, as most of the time these empt fields
    #are clicked on to navigate to a tag record and
    #not to add a picture to them.
    // Show Custom Dialog [ Message: "Use the 'add' button above to add pictures to this tag." ]
    #
    #
    #
    #
    Set Variable [ $$ReplaceMeMediaRequired ]
    #
    #
    Exit Script [ ]
    End If
    #
    #
    #Exit any field to avoid in-use error = 301 error.
    Go to Field [ ]
    #
    #
    #
    #
    #
    #BEGIN insert or take new picture or movie
    #
    #
    #If there is no picture (see note) and record
    #is not locked then start the insert script.
    #NOTE: Calculations above deterimined that
    #there is no picture internally (in the database),
    #or externally on the web or hard drive.
    If [ $fileLocation = "none" //$fileLocation = "none" and Get (LayoutName) = "ReferencePictureWindowEDIT" // or $fileLocation = "none" and Get (LayoutName) = "ReferenceSPictureWindowEDIT" ]
    #
    #Get variables needed to run
    #the insert script below.
    Set Variable [ $$picture; Value:$picture ]
    Set Variable [ $$reportTable; Value:$reportTable ]
    Set Variable [ $$fileLocation; Value:$fileLocation ]
    Set Variable [ $$learnLayout; Value:$learnLayout ]
    Set Variable [ $$referenceLayout; Value:$referenceLayout ]
    #
    Perform Script [ “CHUNK_insertPictureOrMovie” ]
    #
    #If the user canceled the media add, then exit
    #this script as there is no picture to show.
    If [ reference::picture = "" or reference::picture = "Replace Me. Media Required" ]
    Exit Script [ ]
    End If
    #
    End If
    #
    #
    #
    #
    #WHY???? Testing required!
    Set Variable [ $$ReplaceMeMediaRequired ]
    #
    #
    #END insert or take new picture or movie
    #
    #
    #
    #
    #
    #BEGIN display picture or movie
    #
    #
    #REFERENCE SECTION
    #
    #If user is on a reference layout when they
    #clicked the picture thumbnail...
    If [ $referenceLayout = 1 ]
    Set Variable [ $$stoploadCitation; Value:1 ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Set Variable [ $$stopWhenLoadingInfoRecordReferences; Value:1 ]
    If [ Get ( WindowName ) ≠ "Media" ]
    New Window [ Name: "Media"; Height: 435; Width: 400; Top: Get (ScreenHeight)/4; Left: Get (ScreenWidth)/4; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Set Zoom Level [ 100%; Camera: Back; Resolution: Full ]
    End If
    #
    #
    #If in stuff library mode just go to the reference
    #picture edit window, because harddrive and
    #web pictures are not allowed in stuff mode.
    #Also, there is no reason to prevent user from
    #editing a location picture from the tag menu.
    If [ $lock = "" and TEMP::InventoryLibraryYN ≠ "" and $fileLocation = "database" and $$citationMatch ≠ "node" ]
    If [ Get (LayoutTableName) = "reference" and Left ( Get (LayoutName) ; 1 ) = "l" ]
    Go to Layout [ “ReferenceSTagMenusPictureWindowEDIT” (reference) ]
    #
    #Need to know this keyword information just
    #in case the user changes while in this picture
    #window. If they do, the Tag Menus window
    #will need to be re-sorted to show the new
    #location keyword group the user put this
    #Reference/Location record in.
    Set Variable [ $$locationKeyword; Value:reference::kkeywordPrimary ]
    #
    #Go to reference edit picture layout if in the
    #Reference section for a stuff/inventory library.
    Else If [ Get (LayoutTableName) = "reference" and Left ( Get (LayoutName) ; 1 ) = "r" ]
    Go to Layout [ “ReferenceSPictureWindowEDIT” (reference) ]
    #
    #Go the view layout if the above two
    #if statements are not true.
    Else
    Go to Layout [ “ReferenceSPictureWindow” (reference) ]
    End If
    #
    #
    #UNLESS ... the user is locked, or on
    #the node tag menu.
    Else If [ $lock ≠ "" and TEMP::InventoryLibraryYN ≠ "" and $fileLocation = "database" or $$citationMatch = "node" and TEMP::InventoryLibraryYN ≠ "" and $fileLocation = "database" ]
    Go to Layout [ “ReferenceSPictureWindow” (reference) ]
    #
    #Inform user if the picture record was created
    #while in reference mode versus stuff mode,
    #and how to edit it.
    Else If [ TEMP::InventoryLibraryYN ≠ "" and $fileLocation = "harddrive" ]
    Go to Layout [ “ReferencePictureWindow_HDD” (reference) ]
    Show Custom Dialog [ Message: "This library is set to remember things. When it was set to remember ideas, a link to this harddrive media was added to it. If you need to edit this link, you must do so in idea mode."; Default Button: “OK”, Commit: “Yes” ]
    Show Custom Dialog [ Message: "To switch back to idea mode 1) click the 'back' buttons in the media and main windows. 2) On the main screen, click the checkbox next to 'idea library'."; Default Button: “OK”, Commit: “Yes” ]
    Else If [ TEMP::InventoryLibraryYN ≠ "" and $fileLocation = "web" ]
    Go to Layout [ “ReferencePictureWindow_Web” (reference) ]
    Show Custom Dialog [ Message: "This library is set to remember things. When it was set to remember ideas, a link to this web media was added to it. If you need to edit this link, you must do so in idea mode."; Default Button: “OK”, Commit: “Yes” ]
    Show Custom Dialog [ Message: "To switch back to idea mode 1) click the 'back' buttons in the media and main windows. 2) On the main screen, click the checkbox next to 'idea library'."; Default Button: “OK”, Commit: “Yes” ]
    #
    #
    #If in reference library mode determine the
    #where the media file is located and display it in
    #on the correct layout.
    #
    #Display database file.
    Else If [ TEMP::InventoryLibraryYN = "" ]
    #
    #Go to edit media layout only if on the
    #referenceEDIT layout, and the node
    #that created the referenced hasn't
    #locked it.
    If [ $fileLocation = "database" ]
    If [ $referenceEDIT = 1 and $lock = "" ]
    Go to Layout [ “ReferencePictureWindowEDIT” (reference) ]
    Else
    Go to Layout [ “ReferencePictureWindow” (reference) ]
    End If
    #
    #Display harddrive file.
    Else If [ $fileLocation = "harddrive" ]
    If [ $referenceEDIT = 1 and $lock = "" ]
    Go to Layout [ “ReferencePictureWindow_HDDEDIT” (reference) ]
    Else
    Go to Layout [ “ReferencePictureWindow_HDD” (reference) ]
    End If
    #
    #Display webpage.
    Else If [ $fileLocation = "web" ]
    If [ $referenceEDIT = 1 and $lock = "" ]
    Go to Layout [ “ReferencePictureWindow_WebEDIT” (reference) ]
    Else
    Go to Layout [ “ReferencePictureWindow_Web” (reference) ]
    End If
    End If
    End If
    #
    #Show only the record of interest.
    Enter Find Mode [ ]
    Set Field [ reference::_Lreference; $picture ]
    Perform Find [ ]
    #
    #If picture is of a locked copyright image,
    #then go to view only layout. This layout
    #check is needed if the user happens to be in
    #inventory mode on the Setup copyright
    #layout, where it is essential that a full
    #reference library reference is shown
    #versus the inventory library reference.
    If [ reference::lock = "lock" or $$citationMatch = "copyright" and $$add ≠ "" ]
    Go to Layout [ “ReferencePictureWindow” (reference) ]
    // Else If [ $$add ≠ "" ]
    // Go to Layout [ “ReferenceSPictureWindow” (reference) ]
    End If
    #
    #
    #Turn back on the record load variables and
    #pause the script to allow the user the
    #opportunity to look at the media. Pausing will
    #prevent the user from doing anything else until
    #they are finished and close the media window.
    Set Variable [ $$stoploadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    Set Variable [ $$stopWhenLoadingInfoRecordReferences ]
    #Resize window so it is compatible with the
    #pictureViewButton script's window sizes.
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Move/Resize Window [ Current Window; Height: 435; Width: 400; Top: Get (ScreenHeight) / 4; Left: Get (ScreenWidth) / 4 ]
    Else
    Move/Resize Window [ Current Window; Height: 395; Width: 400; Top: Get (ScreenHeight) / 4; Left: Get (ScreenWidth) / 4 ]
    End If
    Pause/Resume Script [ Indefinitely ]
    Exit Script [ ]
    #
    #
    End If
    #
    #REFERENCE SECTION
    #
    #
    #LEARN SECTION
    #
    #NOTE: Learn records can display both
    #referenced reference record's media
    #as well as their own media.
    #
    #If user is on a testlearn table layout when they
    #clicked the picture thumbnail...
    If [ Get (LayoutTableName) = "testLearn" or Get (LayoutTableName) = "testlearnReportTags" or Get (LayoutTableName) = "report" ]
    Set Variable [ $$stoploadCitation; Value:1 ]
    Set Variable [ $$stoploadtestinfo; Value:1 ]
    Set Variable [ $$stopLoadTestRecord; Value:1 ]
    Set Variable [ $learnWindowName; Value:Get ( WindowName ) ]
    New Window [ Name: "Media"; Height: Get (ScreenHeight)/2; Width: Get (ScreenWidth)/2; Top: Get (ScreenHeight)/4; Left: Get (ScreenWidth)/4; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Set Zoom Level [ 100%; Camera: Back; Resolution: Full ]
    #
    #
    #Go to edit media layout only if on a
    #Learn window layout, and the node
    #that created the learn record hasn't
    #locked it.
    If [ $lock = "" and testlearnReportTags::filterFind = "" and tagTLNodePrimary::orderOrLock = "" and tagTLReportNodePrimary::orderOrLock = "" and Get (LayoutName) ≠ "PrintReportEdit" ]
    #
    #Display database file.
    If [ $fileLocation = "database" or $fileLocation = "TLpicture" ]
    If [ $fileLocation = "database" ]
    #
    #If looking at learn media in the tag menus
    #window, go to the view layout.
    If [ $learnWindowName = "Tag Menus" and Get ( LayoutTableName ) = "testlearn" ]
    Go to Layout [ “LearnRefPictureWindow” (testlearn) ]
    Else
    Go to Layout [ “LearnRefPictureWindowEDIT” (testlearn) ]
    End If
    Else If [ $fileLocation = "TLpicture" ]
    #
    #If looking at learn media in the tag menus
    #window, go to the view layout.
    If [ $learnWindowName = "Tag Menus" and Get ( LayoutTableName ) = "testlearn" ]
    Go to Layout [ “LearnPictureWindow” (testlearn) ]
    Else
    Go to Layout [ “LearnPictureWindowEDIT” (testlearn) ]
    End If
    End If
    #
    #Display harddrive file.
    Else If [ $fileLocation = "harddrive" ]
    #
    #If looking at learn media in the tag menus
    #window, go to the view layout.
    If [ $learnWindowName = "Tag Menus" and Get ( LayoutTableName ) = "testlearn" ]
    Go to Layout [ “LearnRefExternalPictureWindow” (testlearn) ]
    Else
    Go to Layout [ “LearnRefExternalPictureWindowEDIT” (testlearn) ]
    End If
    #
    #Display webpage.
    Else If [ $fileLocation = "web" ]
    #
    #If looking at learn media in the tag menus
    #window, go to the view layout.
    If [ $learnWindowName = "Tag Menus" and Get ( LayoutTableName ) = "testlearn" ]
    Go to Layout [ “LearnRefWebPictureWindow” (testlearn) ]
    Else
    Go to Layout [ “LearnRefWebPictureWindowEDIT” (testlearn) ]
    End If
    End If
    #
    #Not editable (view only) layouts.
    Else If [ $lock ≠ "" or $reportTable ≠ "" or tagTLNodePrimary::orderOrLock ≠ "" or tagTLReportNodePrimary::orderOrLock ≠ "" or Get (LayoutName) = "PrintReportEdit" // or Right ( Get (LayoutName) ; 4 ) = "info" ]
    #
    #Display database file.
    If [ $fileLocation = "database" or $fileLocation = "TLpicture" ]
    If [ $fileLocation = "database" ]
    Go to Layout [ “LearnRefPictureWindow” (testlearn) ]
    Else If [ $fileLocation = "TLpicture" ]
    Go to Layout [ “LearnPictureWindow” (testlearn) ]
    End If
    #
    #Display harddrive file.
    Else If [ $fileLocation = "harddrive" ]
    Go to Layout [ “LearnRefExternalPictureWindow” (testlearn) ]
    #
    #Display webpage.
    Else If [ $fileLocation = "web" ]
    Go to Layout [ “LearnRefWebPictureWindow” (testlearn) ]
    End If
    End If
    #
    #Show only the record of interest.
    Enter Find Mode [ ]
    Set Field [ testlearn::_Ltestlearn; $picture ]
    Perform Find [ ]
    #
    #Turn back on the record load variables and
    #pause the script to allow the user the
    #opportunity to look at the media. Pausing will
    #prevent the user from doing anything else until
    #they are finished and close the media window.
    Set Variable [ $$stoploadtestinfo ]
    Set Variable [ $$stoploadCitation ]
    Set Variable [ $$stopLoadTestRecord ]
    #Resize window so it is compatible with the
    #pictureViewButton script's window sizes.
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Move/Resize Window [ Current Window; Height: 435; Width: 400; Top: Get (ScreenHeight) / 4; Left: Get (ScreenWidth) / 4 ]
    Else
    Move/Resize Window [ Current Window; Height: 395; Width: 400; Top: Get (ScreenHeight) / 4; Left: Get (ScreenWidth) / 4 ]
    End If
    Pause/Resume Script [ Indefinitely ]
    Exit Script [ ]
    #
    End If
    #
    #LEARN SECTION
    #

Fields used in this script

    testlearn::picture
    testlearn::kshowReferencedMedia
    reference::picture
    reference::_Lreference
    TEMP::InventoryLibraryYN
    reference::referenceHidePicture
    tagMenus::tagTestTextItemOrLongTagField
    refCreatorNode::orderOrLock
    refCreatorNode::tag
    TEMP::primaryNodeIsLocked
    TEMP::DEFAULTNodePrimaryName
    TEMP::primaryNodesCreatorNodeIsLocked
    testSubsectionTestSubjectLock::orderOrLock
    ReportResultTestSubject::orderOrLock
    reportTestSubjectLock::orderOrLock
    tagTLNodePrimary::orderOrLock
    tagTLReportNodePrimary::orderOrLock
    refLearnCreatorNodeLock::orderOrLock
    refLearnTestCreatorNodeLock::orderOrLock
    defaultNodesCopyright::Kpicture1
    defaultNodeCopyrightsPicture::picture
    defaultNodeCopyrightsPicture::kfileLocation
    defaultNodeCopyrightsPicture::fileName
    defaultNodeCopyrightsPicture::showMedia
    defaultNodeCopyrightsPicture::URL
    reference::kfileLocation
    reference::fileName
    reference::showMedia
    reference::URL
    tagMenus::Kpicture1
    refPicture1::picture
    refPicture1::kfileLocation
    refPicture1::fileName
    refPicture1::showMedia
    refPicture1::URL
    tagMenus::Kpicture2
    refPicture2::picture
    refPicture2::kfileLocation
    refPicture2::fileName
    refPicture2::showMedia
    refPicture2::URL
    tagMenus::Kpicture3
    refPicture3::picture
    refPicture3::kfileLocation
    refPicture3::fileName
    refPicture3::showMedia
    refPicture3::URL
    testlearn::_Ltestlearn
    refLearnShowMedia::picture
    refLearnShowMedia::kfileLocation
    refLearnShowMedia::fileName
    refLearnShowMedia::showMedia
    refLearnShowMedia::URL
    testlearnReportTags::_Ltestlearn
    testlearnReportTags::picture
    refTestShowMedia::picture
    refTestShowMedia::kfileLocation
    refTestShowMedia::fileName
    refTestShowMedia::showMedia
    refTestShowMedia::URL
    testlearnReportTags::filterFind
    reference::kkeywordPrimary
    reference::lock

Scripts used in this script

    CHUNK_insertPictureOrMovie

Layouts used in this script

    ReferenceSTagMenusPictureWindowEDIT
    ReferenceSPictureWindowEDIT
    ReferenceSPictureWindow
    ReferencePictureWindow_HDD
    ReferencePictureWindow_Web
    ReferencePictureWindowEDIT
    ReferencePictureWindow
    ReferencePictureWindow_HDDEDIT
    ReferencePictureWindow_WebEDIT
    LearnRefPictureWindow
    LearnRefPictureWindowEDIT
    LearnPictureWindow
    LearnPictureWindowEDIT
    LearnRefExternalPictureWindow
    LearnRefExternalPictureWindowEDIT
    LearnRefWebPictureWindow
    LearnRefWebPictureWindowEDIT

Tables used in this script

    TEMP
    reference
    tag
    tag
    tag
    testlearn

Table occurrences used by this script

    ReportResultTestSubject
    TEMP
    defaultNodeCopyrightsPicture
    defaultNodesCopyright
    refCreatorNode
    refLearnCreatorNodeLock
    refLearnShowMedia
    refLearnTestCreatorNodeLock
    refPicture1
    refPicture2
    refPicture3
    refTestShowMedia
    reference
    reportTestSubjectLock
    tagMenus
    tagTLNodePrimary
    tagTLReportNodePrimary
    testSubsectionTestSubjectLock
    testlearn
    testlearnReportTags

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [showCitationPicture1inNewWindow]	Parent Folder: [pictures]	Next Script: [showCitationPicture3inNewWindow]
Script Name	showCitationPicture2inNewWindow
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultNode4
    ReferenceMenu2keywordOrNode5
    ReferenceMenu2SkeywordOrNode5
    addMenuNodeKeyword
    addMenu2
    addMenuTestItem
    ltagNK5

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #
    Set Variable [ $$picture; Value:"Kpicture2" ]
    Perform Script [ “showCitationPicture1inNewWindow” ]
    #
    #
    #

Fields used in this script

Scripts used in this script

    showCitationPicture1inNewWindow

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [showCitationPicture2inNewWindow]	Parent Folder: [pictures]	Next Script: [showRefHarddriveMedia]
Script Name	showCitationPicture3inNewWindow
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultNode4
    ReferenceMenu2SkeywordOrNode5
    addMenuNodeKeyword
    addMenu2
    addMenuTestItem
    ltagNK5

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #
    #
    Set Variable [ $$picture; Value:"Kpicture3" ]
    Perform Script [ “showCitationPicture1inNewWindow” ]
    #
    #
    #

Fields used in this script

Scripts used in this script

    showCitationPicture1inNewWindow

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [showCitationPicture3inNewWindow]	Parent Folder: [pictures]	Next Script: [showRefWebMedia]
Script Name	showRefHarddriveMedia
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Inform user if they have not entered a FileName or
    #selected the file's location: main, other, x.
    If [ reference::fileName = "" and reference::kfileLocation = "" and reference::picture = "" and reference::showMedia[2] ≠ "" or reference::fileName = "" and reference::kfileLocation = "" and reference::picture = "Replace Me. Media Required" and reference::showMedia[2] ≠ "" ]
    Set Field [ reference::showMedia[2]; "" ]
    Go to Field [ ]
    Show Custom Dialog [ Message: "Enter a filename and select a file location below to see HDDmedia displayed here."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    #
    #Inform user if they have not entered a FileName.
    Else If [ reference::fileName = "" and reference::picture = "" and reference::showMedia[2] ≠ "" or reference::fileName = "" and reference::picture = "Replace Me. Media Required" and reference::showMedia[2] ≠ "" ]
    Set Field [ reference::showMedia[2]; "" ]
    Go to Field [ ]
    Show Custom Dialog [ Message: "Enter a filename below to see HDDmedia displayed here."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    #
    #Inform user if they have not selected
    #the file's location: main, other, x.
    Else If [ reference::kfileLocation = "" and reference::picture = "" and reference::showMedia[2] ≠ "" or reference::kfileLocation = "" and reference::picture = "Replace Me. Media Required" and reference::showMedia[2] ≠ "" ]
    Set Field [ reference::showMedia[2]; "" ]
    Go to Field [ ]
    Show Custom Dialog [ Message: "Select a file location to see HDDmedia displayed here."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    #
    #Inform user if they have not selected
    #the file's location path.
    Else If [ FilterValues ( reference::kfileLocation ; "8162011225605315" ) = "8162011225605315" & ¶ and reference::kfolderpath = "" and reference::picture = "" and reference::showMedia[2] ≠ "" or FilterValues ( reference::kfileLocation ; "8162011225605315" ) = "8162011225605315" & ¶ and reference::kfolderpath = "" and reference::picture = "Replace Me. Media Required" and reference::showMedia[2] ≠ "" ]
    Set Field [ reference::showMedia[2]; "" ]
    Go to Field [ ]
    Show Custom Dialog [ Message: "Select the media's file-path tag to see HDDmedia displayed here."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    #
    #Inform user that the picture field is filled and must be
    #cleared before they can display other media, unless
    #the picture field is filled with a placeholder, in which
    #case delete the place holder and show the
    #other media.
    Else If [ reference::picture ≠ "" ]
    If [ reference::picture = "Replace Me. Media Required" ]
    Set Field [ reference::picture; "" ]
    Go to Field [ ]
    Exit Script [ ]
    End If
    Set Field [ reference::showMedia[2]; "" ]
    Go to Field [ ]
    Show Custom Dialog [ Message: "You can click to view HDDmedia only if you first delete the current picture. 1) Click on the picture. 2) Click 'X' in the popup window that opens."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    #
    #Check if file is a media that will display:
    #IMAGE — bmp, gif, jpeg, jpg, png, psd, sgi,
    #tga, tif, tiff; MOVIE — mp4, m4v.
    Else If [ //Check if file is a media that will display. 0 = ( reference::kfileLocation = "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "bmp" or reference::kfileLocation = "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "gif" or reference::kfileLocation = "" and reference::fileName ≠ "" and Right ( reference::fileName ; 4 ) = "jpeg" or reference::kfileLocation = "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "jpg" or reference::kfileLocation = "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "png" or reference::kfileLocation = "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "psd" or reference::kfileLocation = "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "sgi" or reference::kfileLocation = "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "tga" or reference::kfileLocation = "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "tif" or reference::kfileLocation = "" and reference::fileName ≠ "" and Right ( reference::fileName ; 4 ) = "tiff" or reference::kfileLocation = "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "mp4" or reference::kfileLocation = "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "m4v" or reference::kfileLocation ≠ "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "bmp" or reference::kfileLocation ≠ "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "gif" or reference::kfileLocation ≠ "" and reference::fileName ≠ "" and Right ( reference::fileName ; 4 ) = "jpeg" or reference::kfileLocation ≠ "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "jpg" or reference::kfileLocation ≠ "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "png" or reference::kfileLocation ≠ "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "psd" or reference::kfileLocation ≠ "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "sgi" or reference::kfileLocation ≠ "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "tga" or reference::kfileLocation ≠ "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "tif" or reference::kfileLocation ≠ "" and reference::fileName ≠ "" and Right ( reference::fileName ; 4 ) = "tiff" or reference::kfileLocation ≠ "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "mp4" or reference::kfileLocation ≠ "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "m4v") ]
    #
    #If the media file is not displayable, inform the
    #user so they can convert it to a format that
    #will display.
    Set Field [ reference::showMedia[2]; "" ]
    Go to Field [ ]
    Show Custom Dialog [ Message: "Your file name must include one of these file extensions to be displayed: IMAGE = bmp, gif, jpeg, jpg, png, psd, sgi, tga, tif, tiff; MOVIE = mp4, m4v."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #
    #Remove check from web media box if checked
    #so HDD media will show up.
    Set Field [ reference::showMedia; "" ]
    Go to Field [ ]
    #
    #
    #If media is in use then inform user if they
    #attempt to edit it.
    If [ reference::showMedia = "" and reference::showMedia[2] = "" ]
    Set Variable [ $$showRefURLmedia; Value:2 ]
    Perform Script [ “CHUNK_checkIfReferencePicIsInUse” ]
    Go to Field [ ]
    Set Variable [ $$showRefURLmedia ]
    If [ reference::picture = "Replace Me. Media Required" ]
    Perform Script [ “showCitationPicture1inNewWindow” ]
    End If
    End If
    #

Fields used in this script

    reference::fileName
    reference::kfileLocation
    reference::picture
    reference::showMedia
    reference::kfolderpath

Scripts used in this script

    CHUNK_checkIfReferencePicIsInUse
    showCitationPicture1inNewWindow

Layouts used in this script

Tables used in this script

    reference

Table occurrences used by this script

    reference

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [showRefHarddriveMedia]	Parent Folder: [pictures]	Next Script: [showTagsReferenceForPicture1]
Script Name	showRefWebMedia
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Inform user if they have not entered a URL.
    If [ reference::URL = "" and reference::picture = "" and reference::showMedia ≠ "" or reference::URL = "" and reference::picture = "Replace Me. Media Required" and reference::showMedia ≠ "" ]
    Set Field [ reference::showMedia; "" ]
    Go to Field [ ]
    Show Custom Dialog [ Message: "Enter a valid URL below (web address) to see webmedia displayed here."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    #
    #Inform user that the picture field is filled and must be
    #cleared before they can display other media, unless
    #the picture field is filled with a placeholder, in which
    #case delete the place holder and show the
    #other media.
    Else If [ reference::picture ≠ "" ]
    If [ reference::picture = "Replace Me. Media Required" ]
    Set Field [ reference::picture; "" ]
    Go to Field [ ]
    Exit Script [ ]
    End If
    Set Field [ reference::showMedia; "" ]
    Go to Field [ ]
    Show Custom Dialog [ Message: "You can click to view webmedia only if you first delete the current picture. 1) Click on the picture. 2) Click 'X' in the popup window that opens."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #
    #Remove check from HDD media box if checked
    #so web media will show up.
    Set Field [ reference::showMedia[2]; "" ]
    Go to Field [ ]
    #
    #
    #If media is in use then inform user if they
    #attempt to edit it.
    If [ reference::showMedia = "" and reference::showMedia[2] = "" ]
    Set Variable [ $$showRefURLmedia; Value:1 ]
    Perform Script [ “CHUNK_checkIfReferencePicIsInUse” ]
    Go to Field [ ]
    Set Variable [ $$showRefURLmedia ]
    If [ reference::picture = "Replace Me. Media Required" ]
    Perform Script [ “showCitationPicture1inNewWindow” ]
    End If
    End If
    #

Fields used in this script

    reference::URL
    reference::picture
    reference::showMedia

Scripts used in this script

    CHUNK_checkIfReferencePicIsInUse
    showCitationPicture1inNewWindow

Layouts used in this script

Tables used in this script

    reference

Table occurrences used by this script

    reference

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [showRefWebMedia]	Parent Folder: [pictures]	Next Script: [showTagsReferenceForPicture2]
Script Name	showTagsReferenceForPicture1
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    addMenu1
    addMenuNodeKeyword
    addMenu2
    addMenuTestItem

Scripts that use this script

Script Definition
Script Steps

    #
    #If user is not in add mode then inform user they
    #must be before the database will show them reference
    #data. The reason for this is because the layout
    #in the reference or learn window changes to the
    #add tag from these windows to the Tag Menu
    #item selected. So instead of having the system
    #automatically go into add mode, the user must
    #decide they want to do this and thus be expecting
    #a change in the layouts. Otherwise this change
    #could confuse a user. So at the cost of minor
    #inconvience I have choose not to have the system
    #guess the user wants to go into add mode and is
    #expecting the system to do that when they click
    #one of these numbered buttons on the showEvenMore
    #layouts.
    If [ $$add = "" ]
    Show Custom Dialog [ Message: "Click the 'add' button above and then click this button to see citation for this item. "; Default Button: “OK”, Commit: “No” ]
    Exit Script [ ]
    End If
    #
    #If the field is blank then stop the script.
    #No poin in looking for a record where there isn't one.
    If [ tagMenus::Kpicture1 = "" ]
    Exit Script [ ]
    End If
    #
    #Capture the key to unlock the record it belongs to.
    Set Variable [ $key; Value:tagMenus::Kpicture1 ]
    #
    #Select the reference window.
    Select Window [ Name: "References"; Current file ]
    #
    #Loop to selected reference if not selected.
    If [ reference::_Lreference ≠ $key ]
    #
    #Prevent record loading script during loops to
    #find wanted record, which would slow down system.
    Set Variable [ $$stoploadCitation; Value:1 ]
    #
    #Now loop thru all the records until the record
    #that fits the key is found.
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ reference::_Lreference = $key ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Allow the record load script to run and run it.
    Set Variable [ $$stoploadCitation ]
    Perform Script [ “loadLearnOrRefMainRecord” ]
    End If
    #
    #Return to Tag Menus window and conditionally
    #format any items that may be linked to record
    #in the other window.
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    #
    #Show user reference record selected.
    Select Window [ Name: "References"; Current file ]
    #

Fields used in this script

    tagMenus::Kpicture1
    reference::_Lreference

Scripts used in this script

    loadLearnOrRefMainRecord

Layouts used in this script

Tables used in this script

    reference
    tag

Table occurrences used by this script

    reference
    tagMenus

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [showTagsReferenceForPicture1]	Parent Folder: [pictures]	Next Script: [showTagsReferenceForPicture3]
Script Name	showTagsReferenceForPicture2
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    addMenuNodeKeyword
    addMenu2
    addMenuTestItem

Scripts that use this script

Script Definition
Script Steps

    #
    #If user is not in add mode then inform user they
    #must be before the database will show them reference
    #data. The reason for this is because the layout
    #in the reference or learn window changes to the
    #add tag from these windows to the Tag Menu
    #item selected. So instead of having the system
    #automatically go into add mode, the user must
    #decide they want to do this and thus be expecting
    #a change in the layouts. Otherwise this change
    #could confuse a user. So at the cost of minor
    #inconvience I have choose not to have the system
    #guess the user wants to go into add mode and is
    #expecting the system to do that when they click
    #one of these numbered buttons on the showEvenMore
    #layouts.
    If [ $$add = "" ]
    Show Custom Dialog [ Message: "Click the 'add' button above and then click this button to see citation for this item. "; Default Button: “OK”, Commit: “No” ]
    Exit Script [ ]
    End If
    #
    #If the field is blank then stop the script.
    #No poin in looking for a record where there isn't one.
    If [ tagMenus::Kpicture2 = "" ]
    Exit Script [ ]
    End If
    #
    #Capture the key to unlock the record it belongs to.
    Set Variable [ $key; Value:tagMenus::Kpicture2 ]
    #
    #Select the reference window.
    Select Window [ Name: "References"; Current file ]
    #
    #Loop to selected reference if not selected.
    If [ reference::_Lreference ≠ $key ]
    #
    #Prevent record loading script during loops to
    #find wanted record, which would slow down system.
    Set Variable [ $$stoploadCitation; Value:1 ]
    #
    #Now loop thru all the records until the record
    #that fits the key is found.
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ reference::_Lreference = $key ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #If key is not found in this section's set of records
    #then look for it in the other sections.
    If [ reference::_Lreference ≠ $key ]
    Enter Find Mode [ ]
    Set Field [ reference::_Lreference; $key ]
    Extend Found Set [ ]
    End If
    #
    #Allow the record load script to run and run it.
    Set Variable [ $$stoploadCitation ]
    Perform Script [ “loadLearnOrRefMainRecord” ]
    End If
    #
    #Return to Tag Menus window and conditionally
    #format any items that may be linked to record
    #in the other window.
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    #
    #Show user reference record selected.
    Select Window [ Name: "References"; Current file ]
    #

Fields used in this script

    tagMenus::Kpicture2
    reference::_Lreference

Scripts used in this script

    loadLearnOrRefMainRecord

Layouts used in this script

Tables used in this script

    reference
    tag

Table occurrences used by this script

    reference
    tagMenus

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [showTagsReferenceForPicture2]	Parent Folder: [pictures]	Next Script: [showTestSubjectCopyrightPicture]
Script Name	showTagsReferenceForPicture3
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    addMenuNodeKeyword
    addMenu2
    addMenuTestItem

Scripts that use this script

Script Definition
Script Steps

    #
    #If user is not in add mode then inform user they
    #must be before the database will show them reference
    #data. The reason for this is because the layout
    #in the reference or learn window changes to the
    #add tag from these windows to the Tag Menu
    #item selected. So instead of having the system
    #automatically go into add mode, the user must
    #decide they want to do this and thus be expecting
    #a change in the layouts. Otherwise this change
    #could confuse a user. So at the cost of minor
    #inconvience I have choose not to have the system
    #guess the user wants to go into add mode and is
    #expecting the system to do that when they click
    #one of these numbered buttons on the showEvenMore
    #layouts.
    If [ $$add = "" ]
    Show Custom Dialog [ Message: "Click the 'add' button above and then click this button to see citation for this item. "; Default Button: “OK”, Commit: “No” ]
    Exit Script [ ]
    End If
    #
    #If the field is blank then stop the script.
    #No poin in looking for a record where there isn't one.
    If [ tagMenus::Kpicture3 = "" ]
    Exit Script [ ]
    End If
    #
    #Capture the key to unlock the record it belongs to.
    Set Variable [ $key; Value:tagMenus::Kpicture3 ]
    #
    #Select the reference window.
    Select Window [ Name: "References"; Current file ]
    #
    #Loop to selected reference if not selected.
    If [ reference::_Lreference ≠ $key ]
    #
    #Prevent record loading script during loops to
    #find wanted record, which would slow down system.
    Set Variable [ $$stoploadCitation; Value:1 ]
    #
    #Now loop thru all the records until the record
    #that fits the key is found.
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ reference::_Lreference = $key ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Allow the record load script to run and run it.
    Set Variable [ $$stoploadCitation ]
    Perform Script [ “loadLearnOrRefMainRecord” ]
    End If
    #
    #Return to Tag Menus window and conditionally
    #format any items that may be linked to record
    #in the other window.
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    #
    #Show user reference record selected.
    Select Window [ Name: "References"; Current file ]
    #

Fields used in this script

    tagMenus::Kpicture3
    reference::_Lreference

Scripts used in this script

    loadLearnOrRefMainRecord

Layouts used in this script

Tables used in this script

    reference
    tag

Table occurrences used by this script

    reference
    tagMenus

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [showTagsReferenceForPicture3]	Parent Folder: [pictures]
Script Name	showTestSubjectCopyrightPicture
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultsAll

Scripts that use this script

Script Definition
Script Steps

    #
    #
    Set Variable [ $$defaultTestSubjecPicture; Value:testSubjectsCopyrightPicture::_Lreference ]
    Set Variable [ $$fileLocation; Value:Case ( testSubjectsCopyrightPicture::picture ≠ "" ; "database" ; testSubjectsCopyrightPicture::kfileLocation ≠ "" and testSubjectsCopyrightPicture::fileName ≠ "" and testSubjectsCopyrightPicture::showMedia = "" ; "harddrive" ; testSubjectsCopyrightPicture::URL ≠ "" and testSubjectsCopyrightPicture::showMedia ≠ "" ; "web" ; "none" ) ]
    #
    #
    If [ $$fileLocation ≠ "none" ]
    Perform Script [ “showCitationPicture1inNewWindow” ]
    End If

Fields used in this script

    testSubjectsCopyrightPicture::_Lreference
    testSubjectsCopyrightPicture::picture
    testSubjectsCopyrightPicture::kfileLocation
    testSubjectsCopyrightPicture::fileName
    testSubjectsCopyrightPicture::showMedia
    testSubjectsCopyrightPicture::URL

Scripts used in this script

    showCitationPicture1inNewWindow

Layouts used in this script

Tables used in this script

    reference

Table occurrences used by this script

    testSubjectsCopyrightPicture

Custom Functions used by this script

Custom menu set used by this script


probablyNotInUse
	Parent Folder: [probablyNotInUse]
Script Name	showPrimaryNodePicture
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #
    Set Variable [ $$defaultPrimaryNodePicture; Value:PictureDefaultNode::_Lreference ]
    Set Variable [ $$fileLocation; Value:Case ( PictureDefaultNode::picture ≠ "" ; "database" ; PictureDefaultNode::kfileLocation ≠ "" and PictureDefaultNode::fileName ≠ "" and PictureDefaultNode::showMedia = "" ; "harddrive" ; PictureDefaultNode::URL ≠ "" and PictureDefaultNode::showMedia ≠ "" ; "web" ; "none" ) ]
    #
    #
    If [ $$fileLocation ≠ "none" ]
    Perform Script [ “showCitationPicture1inNewWindow” ]
    End If

Fields used in this script

    PictureDefaultNode::_Lreference
    PictureDefaultNode::picture
    PictureDefaultNode::kfileLocation
    PictureDefaultNode::fileName
    PictureDefaultNode::showMedia
    PictureDefaultNode::URL

Scripts used in this script

    showCitationPicture1inNewWindow

Layouts used in this script

Tables used in this script

    reference

Table occurrences used by this script

    PictureDefaultNode

Custom Functions used by this script

Custom menu set used by this script


reference
	Parent Folder: [reference]	Next Script: [addFileLink6ToTag]
Script Name	addFileLink4ToTag
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferenceAddToTag
    ReferenceAddToCopyright

Scripts that use this script

Script Definition
Script Steps

    #
    #Clear fields and then determine if there something
    #to link.
    Go to Field [ ]
    If [ reference::Title ≠ "" and FilterValues ( reference::kfileLocation ; "8162011225532313" ) = "8162011225532313" & ¶ and reference::fileName ≠ "" or reference::Title ≠ "" and FilterValues ( reference::kfileLocation ; "8162011225558314" ) = "8162011225558314" & ¶ and reference::fileName ≠ "" or reference::Title ≠ "" and FilterValues ( reference::kfileLocation ; "8162011225605315" ) = "8162011225605315" & ¶ and tagRefFolderPath::tag ≠ "" and reference::fileName ≠ "" or reference::URL ≠ "" ]
    #
    #Set variables to passed on to linking script.
    Set Variable [ $$name; Value:"title" ]
    Set Variable [ $$number; Value:1 ]
    #
    #If the filterFind checkbox is not checked for the
    #the current $$CitationMatch variable, then
    #these next scripts will identify that problem,
    #fix it, and inform the user of what it did.
    If [ $$citationMatch = "key" and "keyword" & ¶ ≠ FilterValues ( reference::filterFind ; "keyword" ) ]
    Set Variable [ $filterFind; Value:reference::filterFind ]
    Set Field [ reference::filterFind; "keyword" & ¶ & $filterFind ]
    // Show Custom Dialog [ Message: "The system has added this reference record to the " & If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) & " citation record set. You will not have to click the 'all' button anymore to find it for " & If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) & " tags." //Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " & //If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) & " tags."; Default Button: “OK”, Commit: “No” ]
    Else If [ $$citationMatch & ¶ ≠ FilterValues ( reference::filterFind ; $$citationMatch ) ]
    Set Variable [ $filterFind; Value:reference::filterFind ]
    Set Field [ reference::filterFind; $$citationMatch & ¶ & $filterFind ]
    // Show Custom Dialog [ Message: "The system has added this reference record to the " & If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) & " citation record set. You will not have to click the 'all' button anymore to find it for " & If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) & " tags." //Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " & //If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) & " tags."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #Now perform the script that adds the tag.
    Perform Script [ “CHUNK_addLinkToTag” ]
    Exit Script [ ]
    End If
    #
    #If the conditions for adding the tag are not met
    #tell the user which ones needs to be met before
    #the tag can be added.
    If [ reference::fileName = "" and Get ( LayoutTableName ) = "reference" ]
    Show Custom Dialog [ Message: "A file name is required including the file's extension: .jpg , .gif , .pdf , .mov , etc. OR a URL is required to add a link."; Default Button: “OK”, Commit: “No” ]
    Else If [ reference::kfileLocation = "" and reference::fileName ≠ "" and Get ( LayoutTableName ) = "reference" ]
    Show Custom Dialog [ Message: "Check the box next the location of your file: main, other, or x."; Default Button: “OK”, Commit: “No” ]
    Else If [ FilterValues ( reference::kfileLocation ; "8162011225605315" ) = "8162011225605315" & ¶ and tagRefFolderPath::tag = "" ]
    Show Custom Dialog [ Message: "Select a file path from the Tag Menus window. If there are none then add one by opening the file with a browser (Firefox, Explore, etc.) and dragging/pasting the address into a new tag's text box."; Default Button: “OK”, Commit: “Yes” ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Perform Script [ “menuPath” ]
    End If

Fields used in this script

    reference::Title
    reference::kfileLocation
    reference::fileName
    tagRefFolderPath::tag
    reference::URL
    reference::filterFind

Scripts used in this script

    CHUNK_addLinkToTag
    menuPath

Layouts used in this script

Tables used in this script

    reference
    tag

Table occurrences used by this script

    reference
    tagRefFolderPath

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [addFileLink4ToTag]	Parent Folder: [reference]	Next Script: [addFileLink5ToTag]
Script Name	addFileLink6ToTag
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferenceAddToTag

Scripts that use this script

Script Definition
Script Steps

    #
    #If user was in the copyright window then
    #return user to this window.
    If [ $$userInCopyrightWindow = 1 ]
    Show Custom Dialog [ Message: "For copyright records, only one weblink is allowed."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #Add file link to Tag Menu item.
    Go to Field [ ]
    If [ reference::Title ≠ "" and FilterValues ( reference::kfileLocation ; "8162011225532313" ) = "8162011225532313" & ¶ and reference::fileName ≠ "" or reference::Title ≠ "" and FilterValues ( reference::kfileLocation ; "8162011225558314" ) = "8162011225558314" & ¶ and reference::fileName ≠ "" or reference::Title ≠ "" and FilterValues ( reference::kfileLocation ; "8162011225605315" ) = "8162011225605315" & ¶ and tagRefFolderPath::tag ≠ "" and reference::fileName ≠ "" or reference::URL ≠ "" ]
    Set Variable [ $$name; Value:"title" ]
    Set Variable [ $$number; Value:3 ]
    #
    #If the filterFind checkbox is not checked for the
    #the current $$CitationMatch variable, then
    #these next scripts will identify that problem,
    #fix it, and inform the user of what it did.
    If [ $$citationMatch = "key" and "keyword" & ¶ ≠ FilterValues ( reference::filterFind ; "keyword" ) ]
    Set Variable [ $filterFind; Value:reference::filterFind ]
    Set Field [ reference::filterFind; "keyword" & ¶ & $filterFind ]
    // Show Custom Dialog [ Message: "The system has added this reference record to the " & If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) & " citation record set. You will not have to click the 'all' button anymore to find it for " & If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) & " tags." //Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " & //If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) & " tags."; Default Button: “OK”, Commit: “No” ]
    Else If [ $$citationMatch & ¶ ≠ FilterValues ( reference::filterFind ; $$citationMatch ) ]
    Set Variable [ $filterFind; Value:reference::filterFind ]
    Set Field [ reference::filterFind; $$citationMatch & ¶ & $filterFind ]
    // Show Custom Dialog [ Message: "The system has added this reference record to the " & If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) & " citation record set. You will not have to click the 'all' button anymore to find it for " & If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) & " tags." //Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " & //If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) & " tags."; Default Button: “OK”, Commit: “No” ]
    End If
    #
    #Now perform the script that adds the tag.
    Perform Script [ “CHUNK_addLinkToTag” ]
    Exit Script [ ]
    End If
    #
    If [ reference::fileName = "" and Get ( LayoutTableName ) = "reference" ]
    Show Custom Dialog [ Message: "A file name is required including the file's extension: .jpg , .gif , .pdf , .mov , etc. OR a URL is required to add a link."; Default Button: “OK”, Commit: “Yes” ]
    Else If [ reference::kfileLocation = "" and reference::fileName ≠ "" and Get ( LayoutTableName ) = "reference" ]
    Show Custom Dialog [ Message: "Check the box next the location of your file: main, other, or x."; Default Button: “OK”, Commit: “No” ]
    Else If [ FilterValues ( reference::kfileLocation ; "8162011225605315" ) = "8162011225605315" & ¶ and tagRefFolderPath::tag = "" ]
    Show Custom Dialog [ Message: "Select a file path from the Tag Menus window. If there are none then add one by opening the file with a browser (Firefox, Explore, etc.) and dragging/pasting the address into a new tag's text box."; Default Button: “OK”, Commit: “No” ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Perform Script [ “menuPath” ]
    End If

Fields used in this script

    reference::Title
    reference::kfileLocation
    reference::fileName
    tagRefFolderPath::tag
    reference::URL
    reference::filterFind

Scripts used in this script

    CHUNK_addLinkToTag
    menuPath

Layouts used in this script

Tables used in this script

    reference
    tag

Table occurrences used by this script

    reference
    tagRefFolderPath

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [addFileLink6ToTag]	Parent Folder: [reference]	Next Script: [addModeReferenceLearnToggle]
Script Name	addFileLink5ToTag
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferenceAddToTag

Scripts that use this script

Script Definition
Script Steps

    #
    #If user was in the copyright window then
    #return user to this window.
    If [ $$userInCopyrightWindow = 1 ]
    Show Custom Dialog [ Message: "For copyright records, only one weblink is allowed."; Default Button: “OK”, Commit: “No” ]
    Exit Script [ ]
    End If
    #
    #Clear fields and then determine if there something
    #to link.
    Go to Field [ ]
    If [ reference::Title ≠ "" and FilterValues ( reference::kfileLocation ; "8162011225532313" ) = "8162011225532313" & ¶ and reference::fileName ≠ "" or reference::Title ≠ "" and FilterValues ( reference::kfileLocation ; "8162011225558314" ) = "8162011225558314" & ¶ and reference::fileName ≠ "" or reference::Title ≠ "" and FilterValues ( reference::kfileLocation ; "8162011225605315" ) = "8162011225605315" & ¶ and tagRefFolderPath::tag ≠ "" and reference::fileName ≠ "" or reference::URL ≠ "" ]
    #
    #Set variables to passed on to linking script.
    Set Variable [ $$name; Value:"title" ]
    Set Variable [ $$number; Value:2 ]
    #
    #If the filterFind checkbox is not checked for the
    #the current $$CitationMatch variable, then
    #these next scripts will identify that problem,
    #fix it, and inform the user of what it did.
    If [ $$citationMatch = "key" and "keyword" & ¶ ≠ FilterValues ( reference::filterFind ; "keyword" ) ]
    Set Variable [ $filterFind; Value:reference::filterFind ]
    Set Field [ reference::filterFind; "keyword" & ¶ & $filterFind ]
    // Show Custom Dialog [ Message: "The system has added this reference record to the " & If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) & " citation record set. You will not have to click the 'all' button anymore to find it for " & If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) & " tags." //Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " & //If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) & " tags."; Default Button: “OK”, Commit: “No” ]
    Else If [ $$citationMatch & ¶ ≠ FilterValues ( reference::filterFind ; $$citationMatch ) ]
    Set Variable [ $filterFind; Value:reference::filterFind ]
    Set Field [ reference::filterFind; $$citationMatch & ¶ & $filterFind ]
    // Show Custom Dialog [ Message: "The system has added this reference record to the " & If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) & " citation record set. You will not have to click the 'all' button anymore to find it for " & If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) & " tags." //Next time you click on the add button, this record will be found as part of the records supplying pictures, file and web links to " & //If ( $$citationMatch = "key" ; "keyword (key)" ; $$citationMatch ) & " tags."; Default Button: “OK”, Commit: “No” ]
    End If
    #
    #Now perform the script that adds the tag.
    Perform Script [ “CHUNK_addLinkToTag” ]
    Exit Script [ ]
    End If
    #
    #If the conditions for adding the tag are not met
    #tell the user which ones needs to be met before
    #the tag can be added.
    If [ reference::fileName = "" and Get ( LayoutTableName ) = "reference" ]
    Show Custom Dialog [ Message: "A file name is required including the file's extension: .jpg , .gif , .pdf , .mov , etc. OR a URL is required to add a link."; Default Button: “OK”, Commit: “No” ]
    Else If [ reference::kfileLocation = "" and reference::fileName ≠ "" and Get ( LayoutTableName ) = "reference" ]
    Show Custom Dialog [ Message: "Check the box next the location of your file: main, other, or x."; Default Button: “OK”, Commit: “Yes” ]
    Else If [ FilterValues ( reference::kfileLocation ; "8162011225605315" ) = "8162011225605315" & ¶ and tagRefFolderPath::tag = "" ]
    Show Custom Dialog [ Message: "Select a file path from the Tag Menus window. If there are none then add one by opening the file with a browser (Firefox, Explore, etc.) and dragging/pasting the address into a new tag's text box."; Default Button: “OK”, Commit: “No” ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Perform Script [ “menuPath” ]
    End If

Fields used in this script

    reference::Title
    reference::kfileLocation
    reference::fileName
    tagRefFolderPath::tag
    reference::URL
    reference::filterFind

Scripts used in this script

    CHUNK_addLinkToTag
    menuPath

Layouts used in this script

Tables used in this script

    reference
    tag

Table occurrences used by this script

    reference
    tagRefFolderPath

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [addFileLink5ToTag]	Parent Folder: [reference]	Next Script: [catchFindReferenceErrorMessages_BUTTONCreateDateField]
Script Name	addModeReferenceLearnToggle
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    If [ Get (WindowName) = "References" ]
    Go to Layout [ <unknown> ]
    Set Window Title [ Current Window; New Title: "Learn" ]
    Else If [ Get (WindowName) = "Learn" ]
    Go to Layout [ “ReferenceAddToTag” (reference) ]
    Set Window Title [ Current Window; New Title: "References" ]
    End If

Fields used in this script

Scripts used in this script

Layouts used in this script

    <Missing Layout>
    ReferenceAddToTag

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [addModeReferenceLearnToggle]	Parent Folder: [reference]	Next Script: [catchFindReferenceErrorMessages_BUTTONModifyDateField]
Script Name	catchFindReferenceErrorMessages_BUTTONCreateDateField
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferenceFIND
    ReferenceFINDstuff

Scripts that use this script

Script Definition
Script Steps

    #
    Set Variable [ $$GoToField; Value:"createDate" ]
    #
    Perform Script [ “catchFindReferenceErrorMessages” ]
    #

Fields used in this script

Scripts used in this script

    catchFindReferenceErrorMessages

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [catchFindReferenceErrorMessages_BUTTONCreateDateField]	Parent Folder: [reference]	Next Script: [catchFindReferenceErrorMessages_BUTTONReference]
Script Name	catchFindReferenceErrorMessages_BUTTONModifyDateField
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferenceFIND
    ReferenceFINDstuff

Scripts that use this script

Script Definition
Script Steps

    #
    Set Variable [ $$GoToField; Value:"modifyDate" ]
    #
    Perform Script [ “catchFindReferenceErrorMessages” ]
    #

Fields used in this script

Scripts used in this script

    catchFindReferenceErrorMessages

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [catchFindReferenceErrorMessages_BUTTONModifyDateField]	Parent Folder: [reference]	Next Script: [catchFindReferenceErrorMessages]
Script Name	catchFindReferenceErrorMessages_BUTTONReference
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferenceFIND
    ReferenceFINDstuff

Scripts that use this script

Script Definition
Script Steps

    #
    Set Variable [ $$GoToField; Value:"reference" ]
    #
    Perform Script [ “catchFindReferenceErrorMessages” ]
    #

Fields used in this script

Scripts used in this script

    catchFindReferenceErrorMessages

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [catchFindReferenceErrorMessages_BUTTONReference]	Parent Folder: [reference]	Next Script: [changeFileLocationFolder]
Script Name	catchFindReferenceErrorMessages
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    catchFindReferenceErrorMessages_BUTTONCreateDateField
    catchFindReferenceErrorMessages_BUTTONModifyDateField
    catchFindReferenceErrorMessages_BUTTONReference
    findReferenceRecord

Script Definition
Script Steps

    #
    #This script is used by the findReference
    #Record script.
    #
    #!!! IMPORTANT !!! SAY WHAT !!! HERE YE, HERE YE !!!
    #
    #The error check logic of this script is identical
    #to the logic in the ActionLog's catch error
    #message script and the catchFindLearnErrorMessage
    #script. Any changes made to this logic needs
    #to also be made to those scripts to keep
    #them all identical.
    #
    #!!! IMPORTANT !!! SAY WHAT !!! HERE YE, HERE YE !!!
    #
    #
    #BEGIN identical catch error logic
    #
    #
    #Admin tasks.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #
    #Copy the user's current find request.
    Set Variable [ $$captureUserFindRequests; Value:1 ]
    Perform Script [ “CHUNK_findReferenceRecordUserFindRequests” ]
    Set Variable [ $$captureUserFindRequests ]
    #
    #
    #Enter the text field and exit it to see if a "user
    #cancelled action" = 1 error is generated or the
    #508 = "invalid find request" variable is generated.
    If [ $$r4 ≠ "" ]
    Set Field [ reference::referenceForReferenceFINDWindow; $$r4 ]
    #
    #BUG: The 1 error is a bug because the script,
    #not the user, is generating the error. If the user
    #actually click's into another field causing the
    #error that this script will now look for, FileMaker
    #fails to pass along this error code. The only
    #way to know if it is happening is to have a
    #script generate this "user" caused 1 error.
    # Now in the test of a text field, FileMaker
    #will not allow an invalid find request to be
    #entered by the script, generating a 508 error
    #when the attempt is made. In contrast, an
    #invalid find request is allowed to be put into
    #a date field by FileMaker = 500 error,
    #however, FileMaker will not allow the script to
    #leave the bad date in the field and generates
    #the "user cancelled action" = 1 error when
    #the script moves on.
    #
    #If an error is produced...
    If [ Get (LastError) = 1 or Get (LastError) = 508 ]
    #
    #Check the text field to see if an error is being
    #caused by question marks.
    If [ Left ( Filter ( $$r4 ; "?" ) ; 1 ) = "?" and Left ( $$r4 ; 2 ) ≠ "*\"" and Right ( $$r4 ; 1 ) ≠ "\"" or Left ( Filter ( $$r4 ; "?" ) ; 1 ) = "?" and Left ( $$r4 ; 1 ) ≠ "\"" and Right ( $$r4 ; 1 ) ≠ "\"" ]
    #
    #Make find request valid.
    Set Field [ reference::referenceForReferenceFINDWindow; "*" & Quote ( $$r4 ) ]
    #
    #Explain problem with question marks in the
    #find request.
    Show Custom Dialog [ Message: "Find requests that include a question mark with a space between it and another character, or find requests with two or more question marks in a row \"like this ???\" must be put in quotes."; Default Button: “OK”, Commit: “No” ]
    Show Custom Dialog [ Message: "This is now done. The astrix before the first quote is to find what you've typed starting from anywhere including the beginning of phase, or the middle of a word."; Default Button: “OK”, Commit: “No” ]
    #
    #Return to the text field and allow the user to
    #edit their find request.
    Go to Field [ reference::referenceForReferenceFINDWindow ]
    Pause/Resume Script [ Indefinitely ]
    #
    #If this script was activated by the user, which
    #would turn on the GoToField variable...
    If [ $$GoToField ≠ "" ]
    #
    #Reset this go to field variable for future use.
    Set Variable [ $$GoToField ]
    Exit Script [ ]
    #
    #If this script was activated by find script...
    Else If [ $$GoToField = "" ]
    #
    #Start this script over.
    # NOTE: The user can leave a text box with
    #an invalid find, and if they do by hitting the
    #return key on a desktop computer, or the go
    #key on an iDevice keyboard, this script will
    #exit, which is bad. This relaunch of
    #this script below is exactly what happens
    #when the user clicks the 'find' button on the
    #layout.
    # A copy of this script needs to be running
    #during a find request session to catch any
    #textbox invalid find requests, and inform the
    #user about how to deal with them.
    # The result being that many copies of the
    #script will be running if the user makes many
    #invalid find requests in a row. No problem.
    # Once the user finally makes a valid find
    #request, or cancels their find session, this
    #script or the cancel find script will halt all
    #copies of the script launched during the
    #sesion.
    Perform Script [ “findReferenceRecord” ]
    Exit Script [ ]
    End If
    End If
    End If
    End If
    #
    #
    #Check the create date field to see if it is
    #improperly formatted.
    If [ $$r0 ≠ "" ]
    #
    #Enter the create date field and exit it to see if a
    #"user cancelled action" = 1 error is generated.
    #SEE ABOVE BUG.
    Set Field [ reference::createDate; $$r0 ]
    Go to Field [ reference::createDate ]
    Go to Field [ ]
    #
    #If an error is produced...
    If [ Get (LastError) = 1 ]
    Set Field [ reference::createDate; $$r0 ]
    #
    #Explain problems with enter date and time
    #and how this problem can be addressed.
    Show Custom Dialog [ Message: "Date searches must include both date and time entered like this" & ¶ & "1/5/2016 12:25:30."; Default Button: “OK”, Commit: “No” ]
    Show Custom Dialog [ Message: "You can replace the M/D/2016 H:M:S numbers with asterisks to, for example, search by year = */*/2016 *:*:*"; Default Button: “OK”, Commit: “No” ]
    Show Custom Dialog [ Message: "Click the 'less than' (or search before this date), 'more than' (or search after this date), or between dates search strategy buttons, and a properly formatted date search will be inserted for you to edit."; Default Button: “OK”, Commit: “No” ]
    #
    #Return to the create date field and allow the
    #user to edit their find request.
    Go to Field [ reference::createDate ]
    Pause/Resume Script [ Indefinitely ]
    #
    #If this script was activated by the user, which
    #would turn on the GoToField variable...
    If [ $$GoToField ≠ "" ]
    #
    #Reset this go to field variable for future use.
    Set Variable [ $$GoToField ]
    Exit Script [ ]
    #
    #If this script was activated by find script...
    Else If [ $$GoToField = "" ]
    #
    #Start this script over. SEE ABOVE NOTE.
    Perform Script [ “findReferenceRecord” ]
    Exit Script [ ]
    End If
    End If
    End If
    #
    #
    #Check the modify date field to see if it is
    #improperly formatted.
    If [ $$r1 ≠ "" ]
    #
    #Enter the modify date field and exit it to see if
    #a "user cancelled action" = 1 error is generated.
    #SEE ABOVE BUG.
    Set Field [ reference::modifyDate; $$r1 ]
    Go to Field [ reference::modifyDate ]
    Go to Field [ ]
    #
    #If an error is produced...
    If [ Get (LastError) = 1 ]
    Set Field [ reference::modifyDate; $$r1 ]
    #
    #Explain problems with enter date and time
    #and how this problem can be addressed.
    Show Custom Dialog [ Message: "Date searches must include both date and time entered like this" & ¶ & "1/5/2016 12:25:30."; Default Button: “OK”, Commit: “No” ]
    Show Custom Dialog [ Message: "You can replace the M/D/2016 H:M:S numbers with asterisks to, for example, search by year = */*/2016 *:*:*"; Default Button: “OK”, Commit: “No” ]
    Show Custom Dialog [ Message: "Click the 'less than' (or search before this date), 'more than' (or search after this date), or between dates search strategy buttons, and a properly formatted date search will be inserted for you to edit."; Default Button: “OK”, Commit: “No” ]
    #
    #Return to the modify date field and allow the
    #user to edit their find request.
    Go to Field [ reference::modifyDate ]
    Pause/Resume Script [ Indefinitely ]
    #
    #If this script was activated by the user, which
    #would turn on the GoToField variable...
    If [ $$GoToField ≠ "" ]
    #
    #Reset this go to field variable for future use.
    Set Variable [ $$GoToField ]
    Exit Script [ ]
    #
    #If this script was activated by find script...
    Else If [ $$GoToField = "" ]
    #
    #Start this script over. SEE ABOVE NOTE.
    Perform Script [ “findReferenceRecord” ]
    Exit Script [ ]
    End If
    End If
    End If
    #
    #
    #Peform one last invalid find error check just to
    #catch any that do not involve the quesion mark.
    If [ $$r4 ≠ "" ]
    Set Field [ reference::referenceForReferenceFINDWindow; $$r4 ]
    #
    #If an error is produced...
    If [ Get (LastError) = 1 or Get (LastError) = 508 ]
    #
    #Make find request valid.
    Set Field [ reference::referenceForReferenceFINDWindow; "*" & Quote ( $$r4 ) ]
    #
    #Explain unknown invalid find request error
    #and its remedy.
    Show Custom Dialog [ Message: "Find request is producing an \"invalid find request\" error. Putting it in quotes should make FileMaker happy."; Default Button: “OK”, Commit: “No” ]
    Show Custom Dialog [ Message: "This is now done. The astrix before the first quote is to find what you've typed starting from anywhere including the beginning of phase, or the middle of a word."; Default Button: “OK”, Commit: “No” ]
    Show Custom Dialog [ Message: "If you continue to get this error message, you'll need to change your find request."; Default Button: “OK”, Commit: “No” ]
    #
    #Return to the text field and allow the user to
    #edit their find request.
    Go to Field [ reference::referenceForReferenceFINDWindow ]
    Pause/Resume Script [ Indefinitely ]
    #
    #If this script was activated by the user, which
    #would turn on the GoToField variable...
    If [ $$GoToField ≠ "" ]
    #
    #Reset this go to field variable for future use.
    Set Variable [ $$GoToField ]
    Exit Script [ ]
    #
    #If this script was activated by find script...
    Else If [ $$GoToField = "" ]
    #
    #Start this script over. SEE ABOVE NOTE.
    Perform Script [ “findReferenceRecord” ]
    Exit Script [ ]
    End If
    End If
    End If
    #
    #
    #In order to generate an invalid find request
    #custom error message, I had to turn the
    #layouts fields into buttons, which run scripts
    #that all turn on this script and generate the
    #error 1. If no error is actually found, these
    #next steps actually enter the field the user
    #wanted to enter. End result for the user is
    #looks like they are entering a field instead of
    #pressing a button. OH IF ONLY FileMaker
    #would pass along the invalid find request
    #variable!!! Well, until it does, this work around
    #does the job (except when the user just hits
    #the return key on a desktop computer).
    If [ $$GoToField = "reference" ]
    Go to Field [ reference::referenceForReferenceFINDWindow ]
    #
    Else If [ $$GoToField = "createDate" ]
    Go to Field [ reference::createDate ]
    #
    Else If [ $$GoToField = "modifyDate" ]
    Go to Field [ reference::modifyDate ]
    #
    End If
    #
    #Reset this go to field variable for future use.
    Set Variable [ $$GoToField ]
    #
    #
    #END identical catch error logic
    #
    #

Fields used in this script

    reference::referenceForReferenceFINDWindow
    reference::createDate
    reference::modifyDate

Scripts used in this script

    CHUNK_findReferenceRecordUserFindRequests
    findReferenceRecord

Layouts used in this script

Tables used in this script

    reference

Table occurrences used by this script

    reference

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [catchFindReferenceErrorMessages]	Parent Folder: [reference]	Next Script: [CHUNK_checkIfReferencePicIsInUse]
Script Name	changeFileLocationFolder
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    If [ reference::kfileLocation = TEMP::ReferenceFolder ]
    Show Custom Dialog [ Message: "Delete file folder location?"; Default Button: “yes”, Commit: “Yes”; Button 2: “cancel”, Commit: “No” ]
    If [ Get (LastMessageChoice) = 1 ]
    Set Field [ reference::kfileLocation; "" ]
    End If
    End If
    Set Field [ TEMP::ReferenceFolder; reference::kfileLocation ]
    Go to Field [ ]

Fields used in this script

    reference::kfileLocation
    TEMP::ReferenceFolder

Scripts used in this script

Layouts used in this script

Tables used in this script

    TEMP
    reference

Table occurrences used by this script

    TEMP
    reference

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [changeFileLocationFolder]	Parent Folder: [reference]	Next Script: [CHUNK_findReferenceRecordUserFindRequests]
Script Name	CHUNK_checkIfReferencePicIsInUse
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    pictureDelete
    showRefHarddriveMedia
    showRefWebMedia

Script Definition
Script Steps

    #
    #
    #NOTE: this code is copied from the script
    #deleteReference.
    # SO if there is a problem with this code
    #check to make sure it is also addressed
    #in that script too.
    #
    #
    #If user is in tag field and has changed spelling
    #exit this tag record, otherwise current reference record
    #will get deleted by the spelling check script.
    Set Variable [ $windowName; Value:Get (WindowName) ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Go to Field [ ]
    #
    #
    #Insure when script is done and the picture
    #window is closed the user sees the
    #References window and not the Tag Menus
    #window.
    Select Window [ Name: "References"; Current file ]
    Select Window [ Name: $windowName; Current file ]
    #
    #
    #Prevent all record load scripts (they slow down
    #this script and are uneccessary).
    Set Variable [ $$stoploadCitation; Value:1 ]
    #
    #
    #Set variables to find other records using
    #its media.
    Set Variable [ $delete; Value:reference::_Lreference ]
    Set Variable [ $deleteName; Value:reference::_Number ]
    Set Variable [ $recordNumber; Value:Get (RecordNumber) ]
    #
    #
    #Because there may be no records found, stop
    #the system from informing the user of this.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #
    #Open a new window and look for record's
    #media being used by another record.
    New Window [ Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    #
    #
    #See if reference's media is used
    #by any learn records, which in turn might be
    #used on a report, which is something that
    #would be nice to know and finding out
    #should be added at later date.
    Go to Layout [ “tableTestLearn” (testlearn) ]
    Enter Find Mode [ ]
    Set Field [ testlearn::kshowReferencedMedia; $delete ]
    Perform Find [ ]
    #
    If [ Get (LastError) ≠ 401 ]
    Set Variable [ $inUse; Value:Get (FoundCount) & " Learn" ]
    End If
    #
    #
    #See if reference record's media
    #is used by any tag records.
    #There are three pictures per record.
    Go to Layout [ “tableTag” (tagTable) ]
    #
    #picture1
    Enter Find Mode [ ]
    Set Field [ tagTable::Kpicture1; $delete ]
    Perform Find [ ]
    Set Variable [ $tagFound1; Value:Get (FoundCount) ]
    If [ Get (FoundCount) > 0 ]
    Go to Record/Request/Page [ First ]
    Loop
    Set Variable [ $tagNameADD; Value:$tagName ]
    Set Variable [ $tagName; Value:Case ( $tagNameAdd = "" ; tagTable::tag ; $tagNameAdd & "; " & tagTable::tag ) ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    End If
    #
    #picture2
    Enter Find Mode [ ]
    Set Field [ tagTable::Kpicture2; $delete ]
    Perform Find [ ]
    Set Variable [ $tagFound2; Value:Get (FoundCount) ]
    If [ Get (FoundCount) > 0 ]
    Go to Record/Request/Page [ First ]
    Loop
    Set Variable [ $tagNameADD; Value:$tagName ]
    Set Variable [ $tagName; Value:Case ( $tagNameAdd = "" ; tagTable::tag ; $tagNameAdd & "; " & tagTable::tag ) ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    End If
    #
    #picture3
    Enter Find Mode [ ]
    Set Field [ tagTable::Kpicture3; $delete ]
    Perform Find [ ]
    Set Variable [ $tagFound3; Value:Get (FoundCount) ]
    If [ Get (FoundCount) > 0 ]
    Go to Record/Request/Page [ First ]
    Loop
    Set Variable [ $tagNameADD; Value:$tagName ]
    Set Variable [ $tagName; Value:Case ( $tagNameAdd = "" ; tagTable::tag ; $tagNameAdd & "; " & tagTable::tag ) ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    End If
    #
    If [ $tagFound1 + $tagFound2 + $tagFound3 ≠ 0 ]
    If [ $inUse ≠ "" ]
    Set Variable [ $addToInUse; Value:$inUse ]
    Set Variable [ $inUse; Value:$addToInUse & ", " & ($tagFound1 + $tagFound2 + $tagFound3) & " Tag Menus (picture for tag: " & $tagName & ")" ]
    Else If [ $inUse = "" ]
    Set Variable [ $inUse; Value:($tagFound1 + $tagFound2 + $tagFound3) & " Tag Menus (picture for tag: " & $tagName & ")" ]
    End If
    End If
    #
    #
    #Close window used to find records that
    #might be using the reference's media.
    Close Window [ Current Window ]
    #
    #
    #Report on findings if there are any.
    If [ $inUse ≠ "" ]
    Set Variable [ $delete ]
    Refresh Window
    #
    #
    #If this script was run by the either the
    #web or hdd media check box scripts...
    If [ $$showRefURLmedia ≠ "" ]
    #
    #Re-check the unchecked checkbox.
    If [ $$showRefURLmedia = 1 ]
    Set Field [ reference::showMedia; 1 ]
    Else
    Set Field [ reference::showMedia[2]; 2 ]
    End If
    #
    #Inform user this reference's media is in use and must
    #be replaced or left as is (thus the re-checking of the
    #media check box).
    Show Custom Dialog [ Message: "MEDIA REQUIRED (picture, etc.) in use by X number of records here: " & $inUse & "."; Default Button: “cancel”, Commit: “Yes”; Button 2: “replace”, Commit: “No” ]
    #
    #If user cancels, then exit this script and
    #the picture delete script.
    If [ Get ( LastMessageChoice ) = 1 ]
    Set Variable [ $$pictureDelete; Value:2 ]
    #
    #Turn off variables that where turned on
    #by this script to speed it up.
    Set Variable [ $$addTagToCitation ]
    Set Variable [ $$stopLoadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    Exit Script [ ]
    End If
    #
    #If the user decides to replace the media, then put a
    #place holder in the picture field until the user replaces
    #it. This way, if the user leaves the reference record
    #without replacing in-use media, at least this
    #place holder will show up where this reference's
    #media is in use.
    If [ Get ( LastMessageChoice ) = 2 ]
    Set Field [ reference::showMedia; "" ]
    Set Field [ reference::showMedia[2]; "" ]
    Set Field [ reference::picture; "Replace Me. Media Required" ]
    End If
    #
    #
    #If this script was run by the pictureDelete script...
    Else If [ $$pictureDelete = 1 ]
    #
    #Inform user this reference's media is in use and must
    #be replaced or left as is.
    Show Custom Dialog [ Message: "MEDIA REQUIRED (picture, etc.) in use by X number of records here: " & $inUse & "."; Default Button: “cancel”, Commit: “Yes”; Button 2: “replace”, Commit: “No” ]
    #
    #If user cancels, then exit this script and
    #the picture delete script.
    If [ Get ( LastMessageChoice ) = 1 ]
    Set Variable [ $$pictureDelete; Value:2 ]
    #
    #Turn off variables that where turned on
    #by this script to speed it up.
    Set Variable [ $$addTagToCitation ]
    Set Variable [ $$stopLoadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    Exit Script [ ]
    End If
    #
    #If user clicks replace, then run script
    #to replace it and exit the delete script.
    If [ Get ( LastMessageChoice ) = 2 ]
    Set Variable [ $$pictureDelete; Value:2 ]
    Set Variable [ $$replacePicture; Value:1 ]
    #
    #Turn off variables that where turned on
    #by this script to speed it up.
    Set Variable [ $$addTagToCitation ]
    Set Variable [ $$stopLoadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    Exit Script [ ]
    End If
    End If
    #
    End If
    #

Fields used in this script

    reference::_Lreference
    reference::_Number
    testlearn::kshowReferencedMedia
    tagTable::Kpicture1
    tagTable::tag
    tagTable::Kpicture2
    tagTable::Kpicture3
    reference::showMedia
    reference::picture

Scripts used in this script

Layouts used in this script

    tableTestLearn
    tableTag

Tables used in this script

    reference
    tag
    testlearn

Table occurrences used by this script

    reference
    tagTable
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [CHUNK_checkIfReferencePicIsInUse]	Parent Folder: [reference]	Next Script: [deleteReference]
Script Name	CHUNK_findReferenceRecordUserFindRequests
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    cancelLearnAndRefFind
    catchFindReferenceErrorMessages
    findReferenceRecord

Script Definition
Script Steps

    #
    #
    #Capture the user's current find requests.
    If [ $$captureUserFindRequests = 1 ]
    Set Variable [ $$r0; Value:reference::createDate ]
    Set Variable [ $$r1; Value:reference::modifyDate ]
    Set Variable [ $$r2; Value:reference::showInLearn ]
    Set Variable [ $$r3; Value:reference::incomplete ]
    Set Variable [ $$r4; Value:reference::referenceForReferenceFINDWindow ]
    Set Variable [ $$r5; Value:reference::kisON ]
    Set Variable [ $$r5b; Value:reference::showMedia ]
    Set Variable [ $$r5c; Value:reference::showMedia[2] ]
    Set Variable [ $$r6; Value:reference::kisWhat ]
    Set Variable [ $$r7; Value:reference::otherIsOn ]
    Set Variable [ $$r8; Value:reference::referenceNodes ]
    Set Variable [ $$r9; Value:reference::Title ]
    Set Variable [ $$r10; Value:reference::bookChapter ]
    Set Variable [ $$r11; Value:reference::governmentAuthor ]
    Set Variable [ $$r12; Value:reference::GovernmentDocInfo ]
    Set Variable [ $$r13; Value:reference::letterDate ]
    Set Variable [ $$r14; Value:reference::emailRecipient ]
    Set Variable [ $$r15; Value:reference::publicationTitle ]
    Set Variable [ $$r16; Value:reference::compilationEditors ]
    Set Variable [ $$r17a; Value:reference::compilationAbbr ]
    Set Variable [ $$r17b; Value:reference::compilationNumberOfEditors ]
    Set Variable [ $$r18; Value:reference::conferenceIntroWords ]
    Set Variable [ $$r19; Value:reference::conferenceTitle ]
    Set Variable [ $$r20; Value:reference::conferenceSubTitle ]
    Set Variable [ $$r22; Value:reference::conferenceLocation ]
    Set Variable [ $$r23; Value:reference::conferenceDate ]
    Set Variable [ $$r24; Value:reference::volumeNumber ]
    Set Variable [ $$r25; Value:reference::issueNumber ]
    Set Variable [ $$r26; Value:reference::pageNumberRange ]
    Set Variable [ $$r26b; Value:reference::pageNumberOther ]
    Set Variable [ $$r27; Value:reference::TimeRange ]
    Set Variable [ $$r28; Value:reference::publisherTypeAlternative ]
    Set Variable [ $$r29; Value:reference::publisherLocation ]
    Set Variable [ $$r30; Value:reference::publicationYearOrStuffOrderNumber ]
    Set Variable [ $$r31; Value:reference::PubDate ]
    Set Variable [ $$r32; Value:reference::pubDateOther ]
    Set Variable [ $$r33; Value:reference::CopyrightYear ]
    Set Variable [ $$r34; Value:reference::copyrightOtherHolder ]
    Set Variable [ $$r35; Value:reference::URL ]
    Set Variable [ $$r36; Value:reference::URLdate ]
    Set Variable [ $$r37; Value:reference::publicLibraryLinks ]
    Set Variable [ $$r38; Value:reference::ISBN ]
    Set Variable [ $$r39; Value:reference::DOI ]
    Set Variable [ $$r40; Value:reference::ISSN ]
    Set Variable [ $$r41; Value:reference::fileName ]
    Set Variable [ $$r42; Value:reference::kfileLocation ]
    Set Variable [ $$r43; Value:reference::thoughtsNotesEtc ]
    Set Variable [ $$r44; Value:reference::referenceDump ]
    End If
    #
    #
    #Put back the user's current find requests.
    If [ $$putBackUserFindRequests = 1 ]
    Set Field [ reference::createDate; $$r0 ]
    Set Field [ reference::modifyDate; $$r1 ]
    Set Field [ reference::showInLearn; $$r2 ]
    Set Field [ reference::incomplete; $$r3 ]
    Set Field [ reference::referenceForReferenceFINDWindow; $$r4 ]
    Set Field [ reference::kisON; $$r5 ]
    Set Field [ reference::showMedia; $$r5b ]
    Set Field [ reference::showMedia[2]; $$r5c ]
    Set Field [ reference::kisWhat; $$r6 ]
    Set Field [ reference::otherIsOn; $$r7 ]
    Set Field [ reference::referenceNodes; $$r8 ]
    Set Field [ reference::Title; $$r9 ]
    Set Field [ reference::bookChapter; $$r10 ]
    Set Field [ reference::governmentAuthor; $$r11 ]
    Set Field [ reference::GovernmentDocInfo; $$r12 ]
    Set Field [ reference::letterDate; $$r13 ]
    Set Field [ reference::emailRecipient; $$r14 ]
    Set Field [ reference::publicationTitle; $$r15 ]
    Set Field [ reference::compilationEditors; $$r16 ]
    Set Field [ reference::compilationAbbr; $$r17a ]
    Set Field [ reference::compilationNumberOfEditors; $$r17b ]
    Set Field [ reference::conferenceIntroWords; $$r18 ]
    Set Field [ reference::conferenceTitle; $$r19 ]
    Set Field [ reference::conferenceSubTitle; $$r20 ]
    Set Field [ reference::conferenceLocation; $$r22 ]
    Set Field [ reference::conferenceDate; $$r23 ]
    Set Field [ reference::volumeNumber; $$r24 ]
    Set Field [ reference::issueNumber; $$r25 ]
    Set Field [ reference::pageNumberRange; $$r26 ]
    Set Field [ reference::pageNumberOther; $$r26b ]
    Set Field [ reference::TimeRange; $$r27 ]
    Set Field [ reference::publisherTypeAlternative; $$r28 ]
    Set Field [ reference::publisherLocation; $$r29 ]
    Set Field [ reference::publicationYearOrStuffOrderNumber; $$r30 ]
    Set Field [ reference::PubDate; $$r31 ]
    Set Field [ reference::pubDateOther; $$r32 ]
    Set Field [ reference::CopyrightYear; $$r33 ]
    Set Field [ reference::copyrightOtherHolder; $$r34 ]
    Set Field [ reference::URL; $$r35 ]
    Set Field [ reference::URLdate; $$r36 ]
    Set Field [ reference::publicLibraryLinks; $$r37 ]
    Set Field [ reference::ISBN; $$r38 ]
    Set Field [ reference::DOI; $$r39 ]
    Set Field [ reference::ISSN; $$r40 ]
    Set Field [ reference::fileName; $$r41 ]
    Set Field [ reference::kfileLocation; $$r42 ]
    Set Field [ reference::thoughtsNotesEtc; $$r43 ]
    Set Field [ reference::referenceDump; $$r44 ]
    End If
    #
    #
    #Clear the user's current find requests.
    If [ $$clearUserFindRequests = 1 ]
    Set Variable [ $$r0 ]
    Set Variable [ $$r1 ]
    Set Variable [ $$r2 ]
    Set Variable [ $$r3 ]
    Set Variable [ $$r4 ]
    Set Variable [ $$r5 ]
    Set Variable [ $$r5b ]
    Set Variable [ $$r5c ]
    Set Variable [ $$r6 ]
    Set Variable [ $$r7 ]
    Set Variable [ $$r8 ]
    Set Variable [ $$r9 ]
    Set Variable [ $$r10 ]
    Set Variable [ $$r11 ]
    Set Variable [ $$r12 ]
    Set Variable [ $$r13 ]
    Set Variable [ $$r14 ]
    Set Variable [ $$r15 ]
    Set Variable [ $$r16 ]
    Set Variable [ $$r17a ]
    Set Variable [ $$r17b ]
    Set Variable [ $$r18 ]
    Set Variable [ $$r19 ]
    Set Variable [ $$r20 ]
    Set Variable [ $$r21 ]
    Set Variable [ $$r22 ]
    Set Variable [ $$r23 ]
    Set Variable [ $$r24 ]
    Set Variable [ $$r25 ]
    Set Variable [ $$r26 ]
    Set Variable [ $$r26b ]
    Set Variable [ $$r27 ]
    Set Variable [ $$r28 ]
    Set Variable [ $$r29 ]
    Set Variable [ $$r30 ]
    Set Variable [ $$r31 ]
    Set Variable [ $$r32 ]
    Set Variable [ $$r33 ]
    Set Variable [ $$r34 ]
    Set Variable [ $$r35 ]
    Set Variable [ $$r36 ]
    Set Variable [ $$r37 ]
    Set Variable [ $$r38 ]
    Set Variable [ $$r39 ]
    Set Variable [ $$r40 ]
    Set Variable [ $$r41 ]
    Set Variable [ $$r42 ]
    Set Variable [ $$r43 ]
    Set Variable [ $$r44 ]
    End If
    #
    #

Fields used in this script

    reference::createDate
    reference::modifyDate
    reference::showInLearn
    reference::incomplete
    reference::referenceForReferenceFINDWindow
    reference::kisON
    reference::showMedia
    reference::kisWhat
    reference::otherIsOn
    reference::referenceNodes
    reference::Title
    reference::bookChapter
    reference::governmentAuthor
    reference::GovernmentDocInfo
    reference::letterDate
    reference::emailRecipient
    reference::publicationTitle
    reference::compilationEditors
    reference::compilationAbbr
    reference::compilationNumberOfEditors
    reference::conferenceIntroWords
    reference::conferenceTitle
    reference::conferenceSubTitle
    reference::conferenceLocation
    reference::conferenceDate
    reference::volumeNumber
    reference::issueNumber
    reference::pageNumberRange
    reference::pageNumberOther
    reference::TimeRange
    reference::publisherTypeAlternative
    reference::publisherLocation
    reference::publicationYearOrStuffOrderNumber
    reference::PubDate
    reference::pubDateOther
    reference::CopyrightYear
    reference::copyrightOtherHolder
    reference::URL
    reference::URLdate
    reference::publicLibraryLinks
    reference::ISBN
    reference::DOI
    reference::ISSN
    reference::fileName
    reference::kfileLocation
    reference::thoughtsNotesEtc
    reference::referenceDump

Scripts used in this script

Layouts used in this script

Tables used in this script

    reference

Table occurrences used by this script

    reference

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [CHUNK_findReferenceRecordUserFindRequests]	Parent Folder: [reference]	Next Script: [duplicateReferenceRecord]
Script Name	deleteReference
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    Reference
    ReferenceStuff
    learnMenuRefStuff

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #NOTE: some if this code is used in the script
    #CHUNKcheckIfReferencePicIsInUse for the
    #purpose of figuring out if a picture is in use.
    #SO if there is a problem with this code then
    #check to make sure it is also addressed in
    #that script too.
    #
    #
    #If record is locked, which all default
    #copyright symbols used for locked
    #copyright tags are, then exit the script.
    If [ reference::lock = "lock" ]
    Show Custom Dialog [ Message: "This record is used by default copyright tags and so is locked."; Default Button: “OK”, Commit: “No” ]
    Exit Script [ ]
    End If
    #
    #
    #If node is currenlty locked then stop script, inform user.
    If [ refCreatorNode::orderOrLock ≠ "" ]
    Show Custom Dialog [ Message: "This record was created by " & $$lockedMainRefRecord & ", a node which is locked. Select this node in the setup window and enter the password to unlock it, then you will able to delete records created by this node."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #
    #If in find mode, exit script.
    If [ $$findMode ≠ "" ]
    Show Custom Dialog [ Message: "Currently in find mode. Click done in the tag menus window to exit find mode, and then click this button."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #
    #If user is in tag field and has changed spelling
    #exit this tag record, otherwise current reference record
    #will get deleted by the spelling check script.
    If [ TEMP::InventoryLibraryYN = "" ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Go to Field [ ]
    Select Window [ Name: "References"; Current file ]
    End If
    #
    If [ TEMP::InventoryLibraryYN = "" ]
    #
    #If reference is sorted by ...
    If [ $$referenceSort = "" ]
    #keyword
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagKeywordPrimary::orderOrLock; based on value list: “order Pulldown List” tagKeywordPrimary::tag; ascending reference::referenceShort; ascending ] [ Restore; No dialog ]
    Else If [ $$referenceSort = "author" ]
    #author
    Sort Records [ Keep records in sorted order; Specified Sort Order: reference::sortByAuthor; ascending reference::referenceShort; ascending ] [ Restore; No dialog ]
    Else If [ $$referenceSort = "dateCreated" ]
    #dateCreated
    Sort Records [ Keep records in sorted order; Specified Sort Order: reference::createDate; descending reference::referenceShort; ascending ] [ Restore; No dialog ]
    Else If [ $$referenceSort = "dateModified" ]
    #dateModified
    Sort Records [ Keep records in sorted order; Specified Sort Order: reference::modifyDate; descending reference::referenceShort; ascending ] [ Restore; No dialog ]
    Else If [ $$referenceSort = "datePublished" ]
    #datePublished
    Sort Records [ Keep records in sorted order; Specified Sort Order: reference::sortByDatePublished; ascending reference::referenceShort; ascending ] [ Restore; No dialog ]
    Else If [ $$referenceSort = "publication" ]
    #publication title
    Sort Records [ Keep records in sorted order; Specified Sort Order: reference::sortByPublication; ascending reference::referenceShort; ascending ] [ Restore; No dialog ]
    Else If [ $$referenceSort = "publisher" ]
    #publisher's name
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagPublisher::tag; ascending reference::referenceShort; ascending ] [ Restore; No dialog ]
    Else If [ $$referenceSort = "title" ]
    #title
    Sort Records [ Keep records in sorted order; Specified Sort Order: reference::sortByTitle; ascending ] [ Restore; No dialog ]
    End If
    End If
    #
    #
    #Exit field so user can see red delete
    #formatting later on.
    Go to Field [ ]
    #
    #
    #Prevent all record load scripts (they slow down
    #this script and are uneccessary).
    Set Variable [ $$stoploadCitation; Value:1 ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    #
    #
    #Set variables to conditionally format section to
    #be deleted, and its record number so if the
    #user cancels the delete, the system can return
    #to this record.
    Set Variable [ $delete; Value:reference::_Lreference ]
    Set Variable [ $deleteName; Value:reference::_Number ]
    Set Variable [ $recordNumber; Value:Get (RecordNumber) ]
    #
    #
    #Because there may be no records found, stop
    #the system from informing the user of this.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #
    #Open a new window and look for record being
    #cited or used as a reference by another record.
    New Window [ Height: 1; Width: 1; Top: -10000; Left: -10000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    #
    #
    #See if reference is used by any learn records as a
    #reference.
    Go to Layout [ “tableTestLearn” (testlearn) ]
    Enter Find Mode [ ]
    Set Field [ testlearn::kcreference; $delete ]
    Perform Find [ ]
    #
    If [ Get (LastError) ≠ 401 ]
    If [ $inUse ≠ "" ]
    Set Variable [ $addToInUse; Value:$inUse ]
    If [ Get (FoundCount) = 1 ]
    Set Variable [ $inUse; Value:$addToInUse & " | " & Get (FoundCount) & " Learn record" ]
    Else
    Set Variable [ $inUse; Value:$addToInUse & " | " & Get (FoundCount) & " Learn records" ]
    End If
    Else If [ $inUse = "" ]
    If [ Get (FoundCount) = 1 ]
    Set Variable [ $inUse; Value:Get (FoundCount) & " Learn record" ]
    Else
    Set Variable [ $inUse; Value:Get (FoundCount) & " Learn records" ]
    End If
    End If
    End If
    #
    #
    #See if reference is used by any reference records as a
    #citation.
    Go to Layout [ “Reference” (reference) ]
    Enter Find Mode [ ]
    Set Field [ reference::kcitation; $delete ]
    Perform Find [ ]
    #
    If [ Get (LastError) ≠ 401 ]
    If [ $inUse ≠ "" ]
    Set Variable [ $addToInUse; Value:$inUse ]
    If [ Get (FoundCount) = 1 ]
    Set Variable [ $inUse; Value:$addToInUse & " | " & Get (FoundCount) & " cite tag for a reference" ]
    Else
    Set Variable [ $inUse; Value:$addToInUse & " | " & Get (FoundCount) & " Cite tags for references" ]
    End If
    Else If [ $inUse = "" ]
    If [ Get (FoundCount) = 1 ]
    Set Variable [ $inUse; Value:Get (FoundCount) & " Cite tag for a reference" ]
    Else
    Set Variable [ $inUse; Value:Get (FoundCount) & " Cite tags for references" ]
    End If
    End If
    End If
    #
    #
    #See if reference record's media
    #is used by any tag records.
    #There are three pictures per record.
    Go to Layout [ “tableTag” (tagTable) ]
    #
    #picture1
    Enter Find Mode [ ]
    Set Field [ tagTable::Kpicture1; $delete ]
    Perform Find [ ]
    Set Variable [ $tagFound1; Value:Get (FoundCount) ]
    If [ Get (FoundCount) > 0 ]
    Go to Record/Request/Page [ First ]
    Loop
    Set Variable [ $tagNameADD; Value:$tagName ]
    Set Variable [ $tagName; Value:Case ( $tagNameAdd = "" ; tagTable::tag ; $tagNameAdd & "; " & tagTable::tag ) ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    End If
    #
    #picture2
    Enter Find Mode [ ]
    Set Field [ tagTable::Kpicture2; $delete ]
    Perform Find [ ]
    Set Variable [ $tagFound2; Value:Get (FoundCount) ]
    If [ Get (FoundCount) > 0 ]
    Go to Record/Request/Page [ First ]
    Loop
    Set Variable [ $tagNameADD; Value:$tagName ]
    Set Variable [ $tagName; Value:Case ( $tagNameAdd = "" ; tagTable::tag ; $tagNameAdd & "; " & tagTable::tag ) ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    End If
    #
    #picture3
    Enter Find Mode [ ]
    Set Field [ tagTable::Kpicture3; $delete ]
    Perform Find [ ]
    Set Variable [ $tagFound3; Value:Get (FoundCount) ]
    If [ Get (FoundCount) > 0 ]
    Go to Record/Request/Page [ First ]
    Loop
    Set Variable [ $tagNameADD; Value:$tagName ]
    Set Variable [ $tagName; Value:Case ( $tagNameAdd = "" ; tagTable::tag ; $tagNameAdd & "; " & tagTable::tag ) ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    End If
    #
    If [ $tagFound1 + $tagFound2 + $tagFound3 ≠ 0 ]
    If [ $inUse ≠ "" ]
    Set Variable [ $addToInUse; Value:$inUse ]
    If [ $tagFound1 + $tagFound2 + $tagFound3 = 1 ]
    Set Variable [ $inUse; Value:$addToInUse & " | " & ($tagFound1 + $tagFound2 + $tagFound3) & " Picture for tag " & $tagName ]
    Else
    Set Variable [ $inUse; Value:$addToInUse & " | " & ($tagFound1 + $tagFound2 + $tagFound3) & " Pictures for tags " & $tagName ]
    End If
    Else If [ $inUse = "" ]
    If [ $tagFound1 + $tagFound2 + $tagFound3 = 1 ]
    Set Variable [ $inUse; Value:($tagFound1 + $tagFound2 + $tagFound3) & " Picture for tag " & $tagName ]
    Else
    Set Variable [ $inUse; Value:($tagFound1 + $tagFound2 + $tagFound3) & " Pictures for tags " & $tagName ]
    End If
    End If
    End If
    #
    #
    #Clear tag variables or use with link tags next.
    Set Variable [ $tagFound1 ]
    Set Variable [ $tagFound2 ]
    Set Variable [ $tagFound3 ]
    Set Variable [ $tagNameADD ]
    Set Variable [ $tagName ]
    #
    #
    #See if reference record's web link
    #is used by any tag records.
    #There are link fields per record.
    Go to Layout [ “tableTag” (tagTable) ]
    #
    #link1
    Enter Find Mode [ ]
    Set Field [ tagTable::Ktitle1; $delete ]
    Perform Find [ ]
    Set Variable [ $tagFound1; Value:Get (FoundCount) ]
    If [ Get (FoundCount) > 0 ]
    Go to Record/Request/Page [ First ]
    Loop
    Set Variable [ $tagNameADD; Value:$tagName ]
    Set Variable [ $tagName; Value:Case ( $tagNameAdd = "" ; tagTable::tag ; $tagNameAdd & "; " & tagTable::tag ) ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    End If
    #
    #link2
    Enter Find Mode [ ]
    Set Field [ tagTable::Ktitle2; $delete ]
    Perform Find [ ]
    Set Variable [ $tagFound2; Value:Get (FoundCount) ]
    If [ Get (FoundCount) > 0 ]
    Go to Record/Request/Page [ First ]
    Loop
    Set Variable [ $tagNameADD; Value:$tagName ]
    Set Variable [ $tagName; Value:Case ( $tagNameAdd = "" ; tagTable::tag ; $tagNameAdd & "; " & tagTable::tag ) ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    End If
    #
    #link3
    Enter Find Mode [ ]
    Set Field [ tagTable::Ktitle3; $delete ]
    Perform Find [ ]
    Set Variable [ $tagFound3; Value:Get (FoundCount) ]
    If [ Get (FoundCount) > 0 ]
    Go to Record/Request/Page [ First ]
    Loop
    Set Variable [ $tagNameADD; Value:$tagName ]
    Set Variable [ $tagName; Value:Case ( $tagNameAdd = "" ; tagTable::tag ; $tagNameAdd & "; " & tagTable::tag ) ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    End If
    #
    If [ $tagFound1 + $tagFound2 + $tagFound3 ≠ 0 ]
    If [ $inUse ≠ "" ]
    Set Variable [ $addToInUse; Value:$inUse ]
    If [ $tagFound1 + $tagFound2 + $tagFound3 = 1 ]
    Set Variable [ $inUse; Value:$addToInUse & " | " & ($tagFound1 + $tagFound2 + $tagFound3) & " Web link for tag " & $tagName ]
    Else
    Set Variable [ $inUse; Value:$addToInUse & " | " & ($tagFound1 + $tagFound2 + $tagFound3) & " Web links for tags " & $tagName ]
    End If
    Else If [ $inUse = "" ]
    If [ $tagFound1 + $tagFound2 + $tagFound3 = 1 ]
    Set Variable [ $inUse; Value:($tagFound1 + $tagFound2 + $tagFound3) & " Web link for tag " & $tagName ]
    Else
    Set Variable [ $inUse; Value:($tagFound1 + $tagFound2 + $tagFound3) & " Web links for tags " & $tagName ]
    End If
    End If
    End If
    #
    #
    #Close window used to find records
    #that might be using the reference.
    Close Window [ Current Window ]
    #
    #
    #Report on findings, or, if therer are none,
    #proceed to delete reference record.
    If [ $inUse ≠ "" ]
    Set Variable [ $delete ]
    Refresh Window
    If [ GetAsNumber ( $inuse ) = 1 ]
    Show Custom Dialog [ Message: "Reference is in use by " & $inUse & " record and cannot be deleted."; Default Button: “OK”, Commit: “Yes” ]
    Else
    Show Custom Dialog [ Message: "Reference is in use by X number of records and cannot be deleted: " & $inUse & "."; Default Button: “OK”, Commit: “Yes” ]
    End If
    Set Variable [ $$addTagToCitation ]
    Set Variable [ $$stopLoadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    Exit Script [ ]
    End If
    #
    #
    #If the record being deleted was not found,
    #make sure the user really wants it deleted.
    Refresh Window
    Show Custom Dialog [ Message: "Delete current record?"; Default Button: “cancel”, Commit: “Yes”; Button 2: “delete”, Commit: “No” ]
    #
    #
    #If the user cancels, stop the delete.
    If [ Get ( LastMessageChoice ) = 1 ]
    Go to Field [ ]
    Set Variable [ $delete ]
    Refresh Window
    Refresh Window
    Set Variable [ $$addTagToCitation ]
    Set Variable [ $$stopLoadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    Exit Script [ ]
    #
    #
    #If the user says yes, then delete the record.
    Else If [ Get ( LastMessageChoice ) = 2 ]
    Delete Record/Request [ No dialog ]
    #
    #
    #After the delete, load up the newly selected
    #reference record's information.
    Set Variable [ $$addTagToCitation ]
    Set Variable [ $$stopLoadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Perform Script [ “loadLearnOrRefMainRecord” ]
    Else
    Perform Script [ “loadTagRecord” ]
    End If
    End If
    #

Fields used in this script

    reference::lock
    refCreatorNode::orderOrLock
    TEMP::InventoryLibraryYN
    tagKeywordPrimary::orderOrLock
    tagKeywordPrimary::tag
    reference::referenceShort
    reference::sortByAuthor
    reference::createDate
    reference::modifyDate
    reference::sortByDatePublished
    reference::sortByPublication
    tagPublisher::tag
    reference::sortByTitle
    reference::_Lreference
    reference::_Number
    testlearn::kcreference
    reference::kcitation
    tagTable::Kpicture1
    tagTable::tag
    tagTable::Kpicture2
    tagTable::Kpicture3
    tagTable::Ktitle1
    tagTable::Ktitle2
    tagTable::Ktitle3

Scripts used in this script

    loadLearnOrRefMainRecord
    loadTagRecord

Layouts used in this script

    tableTestLearn
    Reference
    tableTag

Tables used in this script

    TEMP
    reference
    tag
    tag
    testlearn

Table occurrences used by this script

    TEMP
    refCreatorNode
    reference
    tagKeywordPrimary
    tagPublisher
    tagTable
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [deleteReference]	Parent Folder: [reference]	Next Script: [editReference]
Script Name	duplicateReferenceRecord
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    Reference
    ReferenceStuff

Scripts that use this script

Script Definition
Script Steps

    #
    #If node is currenlty locked then stop script,
    #and inform the user.
    Perform Script [ “stopNewRecordsBeingCreatedByLockedNode” ]
    #
    #If in find mode, exit script.
    If [ $$findMode ≠ "" ]
    Show Custom Dialog [ Message: "Currently in find mode. Click done in the tag menus window to exit find mode, and then click this button."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #If in find mode, exit find mode.
    If [ $$findMode= 1 ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Set Variable [ $$findMode ]
    Set Variable [ $$firstFind ]
    Set Variable [ $$firstFindOther ]
    Set Variable [ $$found ]
    Set Variable [ $$foundOther ]
    Go to Layout [ $$findLayout ]
    Set Variable [ $$stoploadCitation ]
    Select Window [ Name: "References"; Current file ]
    End If
    #
    #If user is in tag field and has changed spelling
    #exit this tag record, otherwise current reference record
    #will get deleted by the spelling check script.
    Select Window [ Name: "Tag Menus"; Current file ]
    Go to Field [ ]
    Select Window [ Name: "References"; Current file ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Sort Records [ ] [ No dialog ]
    End If
    #
    #Capture all record information to be duplicated.
    Set Variable [ $type; Value:reference::kisON ]
    Set Variable [ $media; Value:reference::kisWhat ]
    Set Variable [ $typeOther; Value:reference::otherIsOn ]
    #
    Set Variable [ $P; Value:reference::kkeywordPrimary ]
    Set Variable [ $O; Value:reference::kkeywordOther ]
    Set Variable [ $Owords; Value:reference::OtherKeyWords ]
    #$$nodeprimary is already known by the system.
    Set Variable [ $NodeOthers; Value:reference::NodeOthers ]
    Set Variable [ $authorList; Value:reference::referenceNodes ]
    Set Variable [ $authorListOLD; Value:reference::referenceNodesOLD ]
    Set Variable [ $title; Value:reference::Title ]
    #
    Set Variable [ $picture; Value:reference::picture ]
    Set Variable [ $showMedia1; Value:reference::showMedia[1] ]
    Set Variable [ $showMedia2; Value:reference::showMedia[2] ]
    #
    Set Variable [ $chapter; Value:reference::bookChapter ]
    Set Variable [ $dissertation; Value:reference::dissertationThesisUniversity ]
    Set Variable [ $govt; Value:reference::governmentAuthor ]
    Set Variable [ $govtDoc; Value:reference::GovernmentDocInfo ]
    Set Variable [ $letter; Value:reference::letterDate ]
    Set Variable [ $email; Value:reference::emailRecipient ]
    Set Variable [ $ctitle; Value:reference::publicationTitle ]
    Set Variable [ $ceditor; Value:reference::compilationEditors ]
    Set Variable [ $cnumber; Value:reference::compilationNumberOfEditors ]
    Set Variable [ $cAbbr; Value:reference::compilationAbbr ]
    Set Variable [ $conIntro; Value:reference::conferenceIntroWords ]
    Set Variable [ $conTitle; Value:reference::conferenceTitle ]
    Set Variable [ $conSubTitle; Value:reference::conferenceSubTitle ]
    Set Variable [ $conLocation; Value:reference::conferenceLocation ]
    Set Variable [ $conDate; Value:reference::conferenceDate ]
    #
    Set Variable [ $volumeNumber; Value:reference::volumeNumber ]
    Set Variable [ $issueNumber; Value:reference::issueNumber ]
    Set Variable [ $pageNumberRange; Value:reference::pageNumberRange ]
    #
    Set Variable [ $noPP; Value:reference::pageNumberOther ]
    #
    Set Variable [ $TimeRange; Value:reference::TimeRange ]
    Set Variable [ $copyrightHolder; Value:reference::kcopyrightHolder ]
    #
    Set Variable [ $notPub; Value:reference::publisherTypeAlternative ]
    Set Variable [ $notPubOther; Value:reference::publisherTypeOther ]
    Set Variable [ $pubLocation; Value:reference::publisherLocation ]
    #
    Set Variable [ $pubYear; Value:reference::publicationYearOrStuffOrderNumber ]
    #
    Set Variable [ $pubDate; Value:reference::PubDate ]
    Set Variable [ $pubDateOther; Value:reference::pubDateOther ]
    #
    Set Variable [ $copyrightYear; Value:reference::CopyrightYear ]
    #
    Set Variable [ $copyrightOtherHolder; Value:reference::copyrightOtherHolder ]
    #
    Set Variable [ $URL; Value:reference::URL ]
    Set Variable [ $URLdate; Value:reference::URLdate ]
    #
    Set Variable [ $library; Value:reference::publicLibraryLinks ]
    Set Variable [ $isbn; Value:reference::ISBN ]
    Set Variable [ $doi; Value:reference::DOI ]
    Set Variable [ $issn; Value:reference::ISSN ]
    #
    Set Variable [ $fileName; Value:reference::fileName ]
    Set Variable [ $InFolder; Value:reference::kfileLocation ]
    Set Variable [ $citation; Value:reference::kcitation ]
    Set Variable [ $notes; Value:reference::thoughtsNotesEtc ]
    Set Variable [ $refDump; Value:reference::referenceDump ]
    #
    Set Variable [ $rights; Value:reference::rights ]
    Go to Field [ ]
    #
    #Now create a new record and give it the
    #copied information.
    Set Variable [ $$stoploadCitation; Value:1 ]
    New Record/Request
    #
    #
    Set Field [ reference::kisON; $type ]
    Set Field [ reference::kisWhat; $media ]
    Set Field [ reference::otherIsOn; $typeOther ]
    #
    Set Field [ reference::kkeywordPrimary; $P ]
    Set Field [ reference::kkeywordOther; $O ]
    Set Field [ reference::OtherKeyWords; $Owords ]
    Set Field [ reference::knodePrimary; $$primaryNode ]
    Set Field [ reference::knodeOther; $$node ]
    Set Field [ reference::NodeOthers; $NodeOthers ]
    Set Field [ reference::referenceNodes; $authorList ]
    Set Field [ reference::referenceNodesOLD; $authorListOLD ]
    Set Field [ reference::Title; $title ]
    #
    Set Field [ reference::picture; $picture ]
    Set Field [ reference::showMedia; $showMedia1 ]
    Set Field [ reference::showMedia[2]; $showMedia2 ]
    #
    Set Field [ reference::bookChapter; $chapter ]
    Set Field [ reference::dissertationThesisUniversity; $dissertation ]
    Set Field [ reference::governmentAuthor; $govt ]
    Set Field [ reference::GovernmentDocInfo; $govtDoc ]
    Set Field [ reference::letterDate; $letter ]
    Set Field [ reference::emailRecipient; $email ]
    Set Field [ reference::publicationTitle; $ctitle ]
    Set Field [ reference::compilationEditors; $ceditor ]
    Set Field [ reference::compilationNumberOfEditors; $cnumber ]
    Set Field [ reference::compilationAbbr; $cAbbr ]
    Set Field [ reference::conferenceIntroWords; $conIntro ]
    Set Field [ reference::conferenceTitle; $conTitle ]
    Set Field [ reference::conferenceSubTitle; $conSubTitle ]
    Set Field [ reference::conferenceLocation; $conLocation ]
    Set Field [ reference::conferenceDate; $conDate ]
    #
    Set Field [ reference::kpublication; $$publication ]
    Set Field [ reference::volumeNumber; $volumeNumber ]
    Set Field [ reference::issueNumber; $issueNumber ]
    Set Field [ reference::pageNumberRange; $pageNumberRange ]
    #
    Set Field [ reference::pageNumberOther; $noPP ]
    #
    Set Field [ reference::kcopyrightHolder; $copyrightHolder ]
    Set Field [ reference::TimeRange; $TimeRange ]
    #
    Set Field [ reference::kpublisher; $$publisher ]
    #
    Set Field [ reference::publisherTypeAlternative; $notPub ]
    Set Field [ reference::publisherTypeOther; $notPubOther ]
    Set Field [ reference::publisherLocation; $pubLocation ]
    #
    Set Field [ reference::publicationYearOrStuffOrderNumber; $pubYear ]
    #
    Set Field [ reference::PubDate; $pubDate ]
    Set Field [ reference::pubDateOther; $pubDateOther ]
    #
    Set Field [ reference::kCopyright; $$copyright ]
    Set Field [ reference::CopyrightYear; $copyrightYear ]
    #
    Set Field [ reference::copyrightOtherHolder; $copyrightOtherHolder ]
    #
    Set Field [ reference::URL; $URL ]
    Set Field [ reference::URLdate; $URLdate ]
    #
    Set Field [ reference::publicLibraryLinks; $library ]
    Set Field [ reference::ISBN; $isbn ]
    Set Field [ reference::DOI; $doi ]
    Set Field [ reference::ISSN; $issn ]
    #
    Set Field [ reference::fileName; $fileName ]
    Set Field [ reference::kfileLocation; $InFolder ]
    Set Field [ reference::kfolderpath; $$Path ]
    Set Field [ reference::kcitation; $citation ]
    Set Field [ reference::thoughtsNotesEtc; $notes ]
    Set Field [ reference::referenceDump; $refDump ]
    #
    Set Field [ reference::rights; $rights ]
    Set Field [ reference::ktest; TEMP::ktestSubsection ]
    #
    Set Field [ reference::kcopyrightType; $$copyrightType ]
    Set Field [ reference::lock; $$Ref ]
    #
    #
    #Load new record as the record being
    #focused on.
    Set Variable [ $$stoploadCitation ]
    Perform Script [ “loadLearnOrRefMainRecord” ]
    #
    #Determine if in stuff or idea mode.
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    #
    #If in stuff mode than select to
    #show record in the Learn section.
    Set Field [ reference::showInLearn; "show in learn" ]
    #
    #Decided to make main reference layout also
    #include the fields that will be edited, so no
    #need in stuffLibrary mode to go an
    #edit layout.
    Else
    #
    #If in idea mode then open new record in a
    #separate window. This is neccessary to allow
    #user to scroll thru just this new record after
    #finding just this new record in the new
    #window.
    # Also, the new window strategy means the
    #main reference window will not need to be
    #resorted, and so moved unless the
    #alphabetical location of this new record
    #requires it to be resorted.
    Set Variable [ $$stoploadCitation; Value:1 ]
    Sort Records [ ] [ No dialog ]
    Set Variable [ $$editRecord; Value:Get (RecordNumber) ]
    Go to Record/Request/Page [ $$editRecord ] [ No dialog ]
    #
    #Go to edit layout in new window.
    Set Window Title [ Current Window; New Title: "Hidden" ]
    #
    #Mark record as incomplete.
    Set Field [ reference::incomplete; "incomplete" & ¶ ]
    #
    #For some reason it is essential that a Go to
    #field step is included prior to opening the
    #new window for Add to tags scripts to work.
    Go to Field [ ]
    #
    New Window [ Name: "References"; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “ReferenceEDIT” (reference) ]
    #
    #Find just the record to be edited.
    Enter Find Mode [ ]
    Set Field [ reference::_Lreference; $$citationRecord ]
    Perform Find [ ]
    Set Variable [ $$stoploadCitation ]
    #
    End If
    #
    #Prevent add mode.
    Set Variable [ $$stopAdd; Value:1 ]
    #
    #

Fields used in this script

    TEMP::InventoryLibraryYN
    reference::kisON
    reference::kisWhat
    reference::otherIsOn
    reference::kkeywordPrimary
    reference::kkeywordOther
    reference::OtherKeyWords
    reference::NodeOthers
    reference::referenceNodes
    reference::referenceNodesOLD
    reference::Title
    reference::picture
    reference::showMedia
    reference::bookChapter
    reference::dissertationThesisUniversity
    reference::governmentAuthor
    reference::GovernmentDocInfo
    reference::letterDate
    reference::emailRecipient
    reference::publicationTitle
    reference::compilationEditors
    reference::compilationNumberOfEditors
    reference::compilationAbbr
    reference::conferenceIntroWords
    reference::conferenceTitle
    reference::conferenceSubTitle
    reference::conferenceLocation
    reference::conferenceDate
    reference::volumeNumber
    reference::issueNumber
    reference::pageNumberRange
    reference::pageNumberOther
    reference::TimeRange
    reference::kcopyrightHolder
    reference::publisherTypeAlternative
    reference::publisherTypeOther
    reference::publisherLocation
    reference::publicationYearOrStuffOrderNumber
    reference::PubDate
    reference::pubDateOther
    reference::CopyrightYear
    reference::copyrightOtherHolder
    reference::URL
    reference::URLdate
    reference::publicLibraryLinks
    reference::ISBN
    reference::DOI
    reference::ISSN
    reference::fileName
    reference::kfileLocation
    reference::kcitation
    reference::thoughtsNotesEtc
    reference::referenceDump
    reference::rights
    reference::knodePrimary
    reference::knodeOther
    reference::kpublication
    reference::kpublisher
    reference::kCopyright
    reference::kfolderpath
    TEMP::ktestSubsection
    reference::ktest
    reference::kcopyrightType
    reference::lock
    reference::showInLearn
    reference::incomplete
    reference::_Lreference

Scripts used in this script

    stopNewRecordsBeingCreatedByLockedNode
    loadLearnOrRefMainRecord

Layouts used in this script

    <Missing Layout>
    ReferenceEDIT

Tables used in this script

    TEMP
    reference

Table occurrences used by this script

    TEMP
    reference

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [duplicateReferenceRecord]	Parent Folder: [reference]	Next Script: [enterShortOrLongTagField]
Script Name	editReference
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    Reference

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #If record is locked, which all default
    #copyright symbols used for locked
    #copyright tags are, then exit the script.
    If [ reference::lock = "lock" ]
    Show Custom Dialog [ Message: "This record is used by default copyright tags and so is locked."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #If node is currenlty locked then stop script, inform user.
    If [ refCreatorNode::orderOrLock ≠ "" ]
    Show Custom Dialog [ Message: "This record was created by " & $$lockedMainRefRecord & ", a node which is locked. Select this node in the setup window and enter the password to unlock it. You can edit your location for this locked reference's file."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #If in find mode, exit script.
    If [ $$findMode ≠ "" ]
    Show Custom Dialog [ Message: "Currently in find mode. Click done in the tag menus window to exit find mode, and then click this button."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #If file name is for media that is being used to
    #show a picture set variable to insure media is
    #not deleted if in use as determined by this
    #script exitAndSeeIfMediaIsInUse.
    If [ reference::kfileLocation ≠ "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "jpg" or reference::kfileLocation ≠ "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "gif" or reference::kfileLocation ≠ "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "psd" or reference::kfileLocation ≠ "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "png" or reference::kfileLocation ≠ "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "tga" or reference::kfileLocation ≠ "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "tif" or reference::kfileLocation ≠ "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "bmp" ]
    Set Variable [ $$fileNameFieldHasMedia; Value:1 ]
    End If
    #
    #If in find mode, exit find mode.
    If [ $$findMode= 1 ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Set Variable [ $$findMode ]
    Set Variable [ $$firstFind ]
    Set Variable [ $$firstFindOther ]
    Set Variable [ $$found ]
    Set Variable [ $$foundOther ]
    Go to Layout [ $$findLayout ]
    Set Variable [ $$stoploadCitation ]
    Select Window [ Name: "References"; Current file ]
    End If
    #
    #If user is in tag field and has changed spelling
    #exit this tag record, otherwise current reference record
    #will get deleted by the spelling check script.
    Select Window [ Name: "Tag Menus"; Current file ]
    Go to Field [ ]
    Select Window [ Name: "References"; Current file ]
    #
    #Go to edit layout in new window.
    Set Window Title [ Current Window; New Title: "Hidden" ]
    #
    #For some reason it is essential that a Go to
    #field step is included prior to opening the
    #new window for Add to tags scripts to work.
    Go to Field [ ]
    #
    #Open new window and title it references
    #as the add tag scripts look for the
    #references window.
    New Window [ Name: "References"; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    If [ refCreatorNode::orderOrLock ≠ "" ]
    Go to Layout [ “ReferenceFilePathEDIT” (reference) ]
    Else
    Go to Layout [ “ReferenceEDIT” (reference) ]
    End If
    #
    #Get rid of spaces in bookChapter field, if any.
    Set Field [ reference::bookChapter; Trim ( reference::bookChapter ) ]
    #
    #Prevent add mode.
    Set Variable [ $$stopAdd; Value:1 ]
    #
    #Note records position so on the way back
    #from the edit window the system can
    #determine if it moved as a result of editing it.
    Set Variable [ $$editRecord; Value:Get (RecordNumber) ]
    #
    #Find just the record to be edited.
    Enter Find Mode [ ]
    Set Field [ reference::_Lreference; $$citationRecord ]
    Perform Find [ ]
    #

Fields used in this script

    reference::lock
    refCreatorNode::orderOrLock
    reference::kfileLocation
    reference::fileName
    reference::bookChapter
    reference::_Lreference

Scripts used in this script

Layouts used in this script

    <Missing Layout>
    ReferenceFilePathEDIT
    ReferenceEDIT

Tables used in this script

    reference
    tag

Table occurrences used by this script

    refCreatorNode
    reference

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [editReference]	Parent Folder: [reference]	Next Script: [exitAndStopClearCitationMatch]
Script Name	enterShortOrLongTagField
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultNode1
    defaultNode2
    defaultNodeS2
    defaultNode3
    defaultNodeS3
    defaultNodeS4
    defaultNode4
    ReferenceMenu3Cite
    ReferenceMenu2keywordOrNode1
    ReferenceMenu2SkeywordOrNode1
    ReferenceMenu2keywordOrNode2
    ReferenceMenu2SkeywordOrNode2
    ReferenceMenu2keywordOrNode3
    ReferenceMenu2SkeywordOrNode3
    ReferenceMenu2keywordOrNode4
    ReferenceMenu2SkeywordOrNode4
    ReferenceMenu2keywordOrNode5
    ReferenceMenu2SkeywordOrNode5
    ReferenceMenu3CiteFind
    ltagNK1
    ltagNKs1
    ltagNK2
    ltagNKs2
    ltagNK3
    ltagNKs3
    ltagNK4
    ltagNKs4
    ltagNK5
    ltagNKs5
    learnMenu3Cite
    learnMenuRefStuff
    learnFindCite
    TestInfoReference

Scripts that use this script

    loadRefCiteTag
    loadTagRecord

Script Definition
Script Steps

    #
    #
    #Stops script when user is going to the Learn
    #or Reference section, except for exit script
    #when user has navigated to a key tag menu
    #record by clicking on the order-number
    #popup menu.
    If [ $$stopGoToKeyTag ≠ "" ]
    Set Variable [ $$stopGoToKeyTag ]
    Set Variable [ $$editLocation; Value:reference::_Lreference ]
    If [ $$keyOrderNumberPossibleChanged ≠ "" ]
    #Disable this variable as the exit script needs
    #to know if the order field triggered this script.
    // Set Variable [ $$keyOrderNumberPossibleChanged ]
    Perform Script [ “exit” ]
    End If
    Exit Script [ ]
    End If
    #
    #
    #Allow empty picture fields to be hidden, and
    #the tag's text box to appear longer, basically
    #covering up the unused picture field on
    #reference table Tag Menus.
    If [ reference::referenceHidePicture = "" and Get (LayoutTableName) = "reference" ]
    #
    #If in inventory mode where the empty picture
    #and title and description fields are hidden do
    #the following to reveal these hidden fields, and
    #if currently showing to go the field the user is
    #currently not in, thus allowing the user to
    #switch between these temporarily unhidden
    #fields.
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Set Variable [ $$editLocation; Value:reference::_Lreference ]
    Refresh Window
    If [ Get ( ActiveFieldName ) ≠ "Title" ]
    Set Variable [ $$editLocation ]
    Go to Object [ Object Name: "tag 1" ]
    Set Variable [ $$editLocation; Value:reference::_Lreference ]
    Refresh Window
    Else
    Set Variable [ $$editLocation ]
    Go to Object [ Object Name: "tag 2" ]
    Set Variable [ $$editLocation; Value:reference::_Lreference ]
    Refresh Window
    End If
    #
    Else
    #
    #If in idea mode, then just go the short field.
    Go to Object [ Object Name: "tag 2" ]
    End If
    #
    #
    Else If [ reference::referenceHidePicture ≠ "" and Get (LayoutTableName) = "reference" ]
    #
    #If in inventory mode where the empty picture
    #and title and description fields are hidden do
    #the following to reveal these hidden fields and
    #if currently showing to go the field the user is
    #currently not in, thus allowing the user to
    #switch between these temporarily unhidden
    #fields.
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Set Variable [ $$editLocation; Value:reference::_Lreference ]
    Refresh Window
    If [ Get ( ActiveFieldName ) ≠ "Title" ]
    Set Variable [ $$editLocation ]
    Go to Object [ Object Name: "tag 1" ]
    Set Variable [ $$editLocation; Value:reference::_Lreference ]
    Refresh Window
    Else
    Set Variable [ $$editLocation ]
    Go to Object [ Object Name: "tag 2" ]
    Set Variable [ $$editLocation; Value:reference::_Lreference ]
    Refresh Window
    End If
    Exit Script [ ]
    #
    Else
    #
    #If in idea mode, then just go the short field.
    Go to Object [ Object Name: "tag 1" ]
    End If
    End If
    #
    #
    #Allow empty picture fields to be hidden, and
    #the tag's text box to appear longer, basically
    #covering up the unused picture field on tag
    #table Tag Menus layouts.
    If [ Get (LayoutTableName) = "tagMenus" and tagMenus::tagTestTextItemOrLongTagField ≠ "" ]
    Go to Object [ Object Name: "tag 1" ]
    Else If [ Get (LayoutTableName) = "tagMenus" and tagMenus::tagTestTextItemOrLongTagField = "" ]
    Go to Object [ Object Name: "tag 2" ]
    End If
    #
    #

Fields used in this script

    reference::_Lreference
    reference::referenceHidePicture
    TEMP::InventoryLibraryYN
    tagMenus::tagTestTextItemOrLongTagField

Scripts used in this script

    exit

Layouts used in this script

Tables used in this script

    TEMP
    reference
    tag

Table occurrences used by this script

    TEMP
    reference
    tagMenus

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [enterShortOrLongTagField]	Parent Folder: [reference]	Next Script: [exitLockedStuffRef]
Script Name	exitAndStopClearCitationMatch
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #Not sure what this does, and need to test
    #to document, when time permits.
    If [ $$turnOffThisScript = 1 ]
    Set Variable [ $$turnOffThisScript; Value:2 ]
    End If
    #
    #After a user selects a popup calendar date,
    #the variable below is set. FileMaker leaves the
    #date field and enters the help field, which
    #thanks to this variable will not run, giving the
    #user a pleasant experience of selecting a
    #calendar date and watching the calendar go
    #away without anything else happening.
    Set Variable [ $$pleaseExitUserJustLeftCalendarField; Value:1 ]

Fields used in this script

Scripts used in this script

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [exitAndStopClearCitationMatch]	Parent Folder: [reference]	Next Script: [extractCreateDateFromReferenceRecords]
Script Name	exitLockedStuffRef
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #Stop script if user has just clicked on this
    #record and it is still loading.
    If [ $$turnOffRefStuffExitScript = 1 ]
    Exit Script [ ]
    End If
    #
    #Exit field user is in.
    Go to Field [ ]
    #
    #In stuff mode when changes are made to a
    #reference record, if it is unlocked then backup
    #those changes, so if it is locked in the future
    #and changes are made, they can be overwritten
    #with the saved backup data.
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    #
    #
    #If the record is unlocked, then save any
    #changes in the backup data fields.
    If [ refCreatorNode::orderOrLock = "" ]
    #
    #
    #Only change records that have been changed.
    #Changes result in the record modify date being
    #reset, and this should only be done when the
    #user modifies the record.
    If [ reference::Title[1] ≠ reference::Title[2] ]
    Set Field [ reference::Title[2]; reference::Title[1] ]
    End If
    If [ reference::thoughtsNotesEtc[1] ≠ reference::thoughtsNotesEtc[2] ]
    Set Field [ reference::thoughtsNotesEtc[2]; reference::thoughtsNotesEtc[1] ]
    End If
    If [ reference::publicationYearOrStuffOrderNumber[1] ≠ reference::publicationYearOrStuffOrderNumber[2] ]
    #
    #Insure that only 3 digit numbers are
    #saved in this field.
    Set Variable [ $threeDigitNumber; Value:Right ( GetAsNumber (reference::publicationYearOrStuffOrderNumber[1]) ; 3 ) ]
    Set Field [ reference::publicationYearOrStuffOrderNumber[2]; $threeDigitNumber ]
    Set Field [ reference::publicationYearOrStuffOrderNumber; $threeDigitNumber ]
    End If
    #
    #
    #If the record is locked, then replace any
    #changes with the saved back up data.
    Else If [ refCreatorNode::orderOrLock ≠ "" ]
    #
    #
    #Only change records that have been changed.
    #Changes result in the record modify date being
    #reset, and this should only be done when the
    #user modifies the record.
    If [ reference::Title[1] ≠ reference::Title[2] ]
    Set Field [ reference::Title; reference::Title[2] ]
    End If
    If [ reference::thoughtsNotesEtc[1] ≠ reference::thoughtsNotesEtc[2] ]
    Set Field [ reference::thoughtsNotesEtc; reference::thoughtsNotesEtc[2] ]
    End If
    If [ reference::publicationYearOrStuffOrderNumber[1] ≠ reference::publicationYearOrStuffOrderNumber[2] ]
    Set Field [ reference::publicationYearOrStuffOrderNumber; reference::publicationYearOrStuffOrderNumber[2] ]
    End If
    #
    #Inform the user why the cannot change the
    #locked record's data.
    Show Custom Dialog [ Message: "The node that created this record — " & refCreatorNode::tag & " — is locked. Select this node in the setup window and enter the password to unlock it, then you will able to edit records assigned to it."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #
    End If
    #
    #

Fields used in this script

    TEMP::InventoryLibraryYN
    refCreatorNode::orderOrLock
    reference::Title
    reference::thoughtsNotesEtc
    reference::publicationYearOrStuffOrderNumber
    refCreatorNode::tag

Scripts used in this script

Layouts used in this script

Tables used in this script

    TEMP
    reference
    tag

Table occurrences used by this script

    TEMP
    refCreatorNode
    reference

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [exitLockedStuffRef]	Parent Folder: [reference]	Next Script: [findALL_LearnOrRefRecords]
Script Name	extractCreateDateFromReferenceRecords
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    Loop
    Set Variable [ $number; Value:reference::_Lreference ]
    If [ Middle ( $number ; 5 ; 2 ) ≠ 20 ]
    Set Variable [ $number; Value:0 & reference::_Lreference ]
    End If
    Set Field [ reference::createDate; Left ( $number ; 2 ) & "/" & Middle ( $number ; 3 ; 2 ) & "/" & Middle ( $number ; 5 ; 4 ) & " " & Middle ( $number ; 9 ; 2 ) & ":" & Middle ( $number ; 11 ; 2 ) & ":" & Middle ( $number ; 13 ; 2 ) ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop

Fields used in this script

    reference::_Lreference
    reference::createDate

Scripts used in this script

Layouts used in this script

Tables used in this script

    reference

Table occurrences used by this script

    reference

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [extractCreateDateFromReferenceRecords]	Parent Folder: [reference]	Next Script: [findReferenceRecord]
Script Name	findALL_LearnOrRefRecords
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    Reference
    ReferenceStuff
    learn0
    learnStuff0
    learn1
    learnStuff1
    learn2
    learnStuff2
    learn3
    learnStuff3
    learn4
    learnStuff4
    learn5
    learnStuff5

Scripts that use this script

    cancelLearnAndRefFind

Script Definition
Script Steps

    #
    #If in find mode, exit script.
    If [ $$findMode ≠ "" ]
    Show Custom Dialog [ Message: "Exit find mode in the Tag Menus window, then click this button."; Default Button: “OK”, Commit: “No” ]
    Exit Script [ ]
    End If
    #
    #If user is in tag field and has changed spelling
    #exit this tag record, otherwise current reference record
    #will get deleted by the spelling check script.
    Select Window [ Name: "Tag Menus"; Current file ]
    Go to Field [ ]
    Select Window [ Name: "References"; Current file ]
    Select Window [ Name: "Learn"; Current file ]
    #
    #As going to the other window will be involved
    #stop the record load script on that window until
    #this script is finished to speed things up and
    #stop flashing effect.
    Set Variable [ $$stoploadCitation; Value:1 ]
    // Set Variable [ $$findMode ]
    Set Variable [ $$firstFind ]
    Set Variable [ $$firstFindOther ]
    Set Variable [ $$found ]
    Set Variable [ $$foundOther ]
    // Set Variable [ $$foundLayout ]
    #
    #Find all Learn records in a section. This would
    #need to be done if the user was just in find mode
    #on the tag screen and was showing only a few
    #of a section's records using this mode.
    If [ Get ( WindowName ) = "Learn" ]
    Enter Find Mode [ ]
    Set Field [ testlearn::filterFind; "main" & ¶ ]
    Perform Find [ ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::date; descending testlearn::timestamp; descending ] [ Restore; No dialog ]
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::orderInventoryGroupNumber; ascending testlearn::note; ascending ] [ Restore; No dialog ]
    End If
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    Set Variable [ $$stoploadCitation ]
    Perform Script [ “loadLearnOrRefMainRecord” ]
    Exit Script [ ]
    End If
    #
    If [ Get ( WindowName ) = "References" ]
    #find on reference layout ...
    If [ Left (Get (LayoutName) ; 1) = "r" ]
    Show All Records
    #
    #find on learn layout ...
    Else If [ Left (Get (LayoutName) ; 1) = "l" ]
    Enter Find Mode [ ]
    Set Field [ testlearn::filterFind; "main" & ¶ ]
    Perform Find [ ]
    End If
    End If
    #
    #Omit locked records, which are the copyright
    #images used by default copyright tags.
    Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: reference::lock: “lock” ] [ Restore ]
    #
    #Sort and go to the first record. Due to bugs,
    #two sorts are required to scroll the window to
    #first record.
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::date; descending testlearn::timestamp; descending ] [ Restore; No dialog ]
    If [ TEMP::InventoryLibraryYN = "" ]
    #
    #If reference is sorted by ...
    If [ $$referenceSort = "" ]
    #keyword
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagKeywordPrimary::orderOrLock; based on value list: “order Pulldown List” tagKeywordPrimary::tag; ascending reference::referenceShort; ascending ] [ Restore; No dialog ]
    Else If [ $$referenceSort = "author" ]
    #author
    Sort Records [ Keep records in sorted order; Specified Sort Order: reference::sortByAuthor; ascending reference::referenceShort; ascending ] [ Restore; No dialog ]
    Else If [ $$referenceSort = "dateCreated" ]
    #dateCreated
    Sort Records [ Keep records in sorted order; Specified Sort Order: reference::createDate; descending reference::referenceShort; ascending ] [ Restore; No dialog ]
    Else If [ $$referenceSort = "dateModified" ]
    #dateModified
    Sort Records [ Keep records in sorted order; Specified Sort Order: reference::modifyDate; descending reference::referenceShort; ascending ] [ Restore; No dialog ]
    Else If [ $$referenceSort = "datePublished" ]
    #datePublished
    Sort Records [ Keep records in sorted order; Specified Sort Order: reference::sortByDatePublished; ascending reference::referenceShort; ascending ] [ Restore; No dialog ]
    Else If [ $$referenceSort = "publication" ]
    #publication title
    Sort Records [ Keep records in sorted order; Specified Sort Order: reference::sortByPublication; ascending reference::referenceShort; ascending ] [ Restore; No dialog ]
    Else If [ $$referenceSort = "publisher" ]
    #publisher's name
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagPublisher::tag; ascending reference::referenceShort; ascending ] [ Restore; No dialog ]
    Else If [ $$referenceSort = "title" ]
    #title
    Sort Records [ Keep records in sorted order; Specified Sort Order: reference::sortByTitle; ascending ] [ Restore; No dialog ]
    End If
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagKeywordPrimary::orderOrLock; based on value list: “testPulldownListANDsortOrderList” tagKeywordPrimary::tag; ascending reference::publicationYearOrStuffOrderNumber; based on value list: “testPulldownListANDsortOrderList” reference::Title; ascending reference::thoughtsNotesEtc; ascending ] [ Restore; No dialog ]
    End If
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    Set Variable [ $$stoploadCitation ]
    Perform Script [ “loadLearnOrRefMainRecord” ]
    #
    #

Fields used in this script

    testlearn::filterFind
    TEMP::InventoryLibraryYN
    testlearn::date
    testlearn::timestamp
    testlearn::orderInventoryGroupNumber
    testlearn::note
    reference::lock
    tagKeywordPrimary::orderOrLock
    tagKeywordPrimary::tag
    reference::referenceShort
    reference::sortByAuthor
    reference::createDate
    reference::modifyDate
    reference::sortByDatePublished
    reference::sortByPublication
    tagPublisher::tag
    reference::sortByTitle
    reference::publicationYearOrStuffOrderNumber
    reference::Title
    reference::thoughtsNotesEtc

Scripts used in this script

    loadLearnOrRefMainRecord

Layouts used in this script

Tables used in this script

    TEMP
    reference
    tag
    testlearn

Table occurrences used by this script

    TEMP
    reference
    tagKeywordPrimary
    tagPublisher
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [findALL_LearnOrRefRecords]	Parent Folder: [reference]	Next Script: [finishReferenceEdit]
Script Name	findReferenceRecord
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    Reference
    ReferenceStuff
    ReferenceFIND
    ReferenceFINDallfields
    ReferenceFINDstuff

Scripts that use this script

    catchFindReferenceErrorMessages
    findReferenceRecord

Script Definition
Script Steps

    #
    #
    #!!! IMPORTANT !!! SAY WHAT !!! HERE YE, HERE YE !!!
    #
    #The find logic of this script is identical to the
    #find logic in the findLearnRecord and the
    #ActionLog's findSpecificAction script, as are
    #their layouts where text and date field are
    #concerned. Any changes made to this logic
    #needs to also be made to those scripts to
    #keep them identical.
    #
    #!!! IMPORTANT !!! SAY WHAT !!! HERE YE, HERE YE !!!
    #
    #
    #If in find mode in the Tag Window, exit script.
    If [ $$findMode ≠ "" ]
    Show Custom Dialog [ Message: "Cancel find in Tag Menus window then click this button."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #If user is in tag field and has changed spelling
    #exit this tag record, otherwise current
    #reference record will get deleted by the
    #spelling check script.
    Select Window [ Name: "Tag Menus"; Current file ]
    If [ Get ( ActiveFieldName ) ≠ "" ]
    Show Custom Dialog [ Message: "You'll be able to perform a find once you exit the field you're in on the tag window."; Default Button: “OK”, Commit: “Yes” ]
    Select Window [ Name: "References"; Current file ]
    Exit Script [ ]
    End If
    Select Window [ Name: "References"; Current file ]
    #
    #
    #
    #!!! IMPORTANT !!! SAY WHAT !!! HERE YE, HERE YE !!!
    #
    #BEGIN identical find logic
    #
    #
    #Admin tasks.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #If the user has just clicked 'find' to perform
    #a find and thus is not yet in find mode ...
    If [ Get (WindowMode) ≠ 1 ]
    #
    #Capture the current layout name (to return user
    #to it after find), enter find mode, go to the find
    #layout, and await the user's find request.
    Set Variable [ $$findReferenceLayout; Value:Get (LayoutName) ]
    Enter Find Mode [ ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Go to Layout [ “ReferenceFIND” (reference) ]
    Else
    Go to Layout [ “ReferenceFINDstuff” (reference) ]
    End If
    Pause/Resume Script [ Indefinitely ]
    #
    End If
    #
    #
    #
    #If alread in find mode on the find layout ...
    #
    #FIRST check for find request errors,
    #and copy current find request in case
    #there are no errors but the find fails
    #and the current find request needs
    #to be re-entered by this script to
    #allow the user to edit it for success.
    If [ Get (WindowMode) = 1 ]
    Perform Script [ “catchFindReferenceErrorMessages” ]
    End If
    #
    #
    #
    #SECOND If there are no invalid find requests
    #then perform the find.
    If [ Get (WindowMode) = 1 ]
    #
    #Try to find the requested records.
    Perform Find [ ]
    #
    #Get the error generated, which if successful
    #will be zero.
    Set Variable [ $error; Value:Get (LastError) ]
    #
    #Omit locked records, which are the copyright
    #images used by default copyright tags.
    Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: reference::lock: “lock” ] [ Restore ]
    #
    #If after removing the locked records, there are
    #zero records, and the current error is not 508
    #or 1 then set the error variable to 401 = no
    #records found.
    If [ Get (FoundCount) = 0 and $error ≠ 508 and $error ≠ 1 ]
    Set Variable [ $error; Value:401 ]
    End If
    #
    End If
    #
    #
    #
    #If the find was not successful...
    #
    #
    #If the find attempt fails and generates a
    #508 = invalid find request error or a 1 = user
    #canceled action error.
    If [ $error = 508 or $error = 1 ]
    #
    #Re-enter find mode to trigger the error capture
    #portion of this script when it is restarted, which
    #will tell the user what went wrong and how to
    #fix it.
    Enter Find Mode [ ]
    #
    #Start this script over.
    Perform Script [ “findReferenceRecord” ]
    #
    End If
    #
    #
    #If the find fails tell the user it failed and give them
    #option to modify their request or cancel the find.
    If [ $error = 401 or $error ≠ 0 and $error ≠ "" ]
    #
    #If currently not in find mode, then enter
    #find mode.
    If [ Get (WindowMode) ≠ 1 ]
    Enter Find Mode [ ]
    End If
    #
    #Replace user's last find requests so they can
    #modify if they want to.
    Set Variable [ $$putBackUserFindRequests; Value:1 ]
    Perform Script [ “CHUNK_findReferenceRecordUserFindRequests” ]
    Set Variable [ $$putBackUserFindRequests ]
    #
    #Inform the user that their find request found
    #zero records.
    Show Custom Dialog [ Message: "No records match this request."; Default Button: “cancel”, Commit: “No”; Button 2: “modify find”, Commit: “No” ]
    #
    #
    #If the user decides to modify their request
    #then stay in find mode and await the user's
    #new request.
    If [ Get ( LastMessageChoice ) = 2 ]
    Pause/Resume Script [ Indefinitely ]
    #
    #These next script steps only come into use
    #if the user clicks the 'return' key on desktop
    #computer's keyboard or the 'go' button on an
    #iDevice. If instead, the user clicks the 'find'
    #button again on the find layout, a duplicate
    #copy of this script is started from the top to
    #perform the find request.
    #
    #Start this script over. SEE NOTE ABOVE.
    Perform Script [ “findReferenceRecord” ]
    #
    #
    #If they cancel the find ...
    Else If [ Get ( LastMessageChoice ) = 1 ]
    #
    #Return to main layout and
    #enter browse mode.
    Perform Script [ “cancelLearnAndRefFind” ]
    #
    End If
    #
    #
    End If
    #
    #
    #
    #If the find is successful ...
    #
    #After a succesful find show the user
    #the found records on the main layout.
    If [ $$findReferenceLayout = "" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “ReferenceStuff” (reference) ]
    Else
    Go to Layout [ “Reference” (reference) ]
    End If
    #
    Else
    Go to Layout [ $$findReferenceLayout ]
    Set Variable [ $$findReferenceLayout ]
    End If
    Sort Records [ ] [ No dialog ]
    Scroll Window [ Home ]
    Go to Record/Request/Page [ First ]
    #
    #
    #Clear user find request variables.
    Set Variable [ $$clearUserFindRequests; Value:1 ]
    Perform Script [ “CHUNK_findReferenceRecordUserFindRequests” ]
    Set Variable [ $$clearUserFindRequests ]
    #
    #Clear out all paused find scripts.
    Halt Script
    #
    #
    #!!! IMPORTANT !!! SAY WHAT !!! HERE YE, HERE YE !!!
    #
    #END identical find logic
    #

Fields used in this script

    TEMP::InventoryLibraryYN
    reference::lock

Scripts used in this script

    catchFindReferenceErrorMessages
    findReferenceRecord
    CHUNK_findReferenceRecordUserFindRequests
    cancelLearnAndRefFind

Layouts used in this script

    ReferenceFIND
    ReferenceFINDstuff
    ReferenceStuff
    Reference
    <Missing Layout>

Tables used in this script

    TEMP
    reference

Table occurrences used by this script

    TEMP
    reference

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [findReferenceRecord]	Parent Folder: [reference]	Next Script: [formatTitle]
Script Name	finishReferenceEdit
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferenceEDIT
    ReferenceFilePathEDIT

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Admin tasks.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #If in an unlocked reference edit window...
    If [ refCreatorNode::orderOrLock = "" ]
    #
    #If user is in tag field and has changed spelling
    #exit this tag record, otherwise current reference record
    #will get deleted by the spelling check script.
    Select Window [ Name: "Tag Menus"; Current file ]
    Go to Field [ ]
    Select Window [ Name: "References"; Current file ]
    Go to Field [ ]
    #
    #If media and media type have not been
    #selected then tell user that these fields are
    #required before exiting the reference record.
    If [ reference::kisWhat = "" and TEMP::InventoryLibraryYN = "" or Right ( Filter (isON::isON_Pulldown ; "—" ) ; 1 ) = "—" ]
    Show Custom Dialog [ Message: "REQUIRED: Click on " & Quote ( "What's it on/in?" ) & " pulldown menu and make a selection."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    Else If [ reference::kisON = "" and TEMP::InventoryLibraryYN = "" or Right ( Filter (isWhat::isWhat_Pulldown ; "—" ) ; 1 ) = "—" ]
    Show Custom Dialog [ Message: "REQUIRED: Click on " & Quote ( "What is it?" ) & " pulldown menu and make a selection."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #If the user is leaving the edit layout with
    #copyright check boxes checked for which there
    #is no copyright holder, inform them of this and
    #give them option to fix this.
    If [ Filter ( reference::kcopyrightHolder ; "1" ) = 1 and reference::knodeOther = "" and reference::knodePrimary = "" and reference::referenceNodes = "" ]
    Set Variable [ $blankCopyrightHolders; Value:"Author" ]
    End If
    If [ Filter ( reference::kcopyrightHolder ; "2" ) = 2 and reference::governmentAuthor = "" ]
    Set Variable [ $blankCopyrightHolderNew; Value:Case ( $blankCopyrightHolders = "" ; "" ; $blankCopyrightHolders & ", " ) & "Government Author" ]
    Set Variable [ $blankCopyrightHolders; Value:$blankCopyrightHolderNew ]
    End If
    If [ Filter ( reference::kcopyrightHolder ; "3" ) = 3 and reference::compilationEditors = "" ]
    Set Variable [ $blankCopyrightHolderNew; Value:Case ( $blankCopyrightHolders = "" ; "" ; $blankCopyrightHolders & ", " ) & "Editor" ]
    Set Variable [ $blankCopyrightHolders; Value:$blankCopyrightHolderNew ]
    End If
    If [ Filter ( reference::kcopyrightHolder ; "4" ) = 4 and reference::kpublication = "" ]
    Set Variable [ $blankCopyrightHolderNew; Value:Case ( $blankCopyrightHolders = "" ; "" ; $blankCopyrightHolders & ", " ) & "Publication" ]
    Set Variable [ $blankCopyrightHolders; Value:$blankCopyrightHolderNew ]
    End If
    If [ Filter ( reference::kcopyrightHolder ; "5" ) = 5 and reference::kpublisher = "" ]
    Set Variable [ $blankCopyrightHolderNew; Value:Case ( $blankCopyrightHolders = "" ; "" ; $blankCopyrightHolders & ", " ) & "Publisher" ]
    Set Variable [ $blankCopyrightHolders; Value:$blankCopyrightHolderNew ]
    End If
    If [ Filter ( reference::kcopyrightHolder ; "6" ) = 6 and reference::copyrightOtherHolder = "" ]
    Set Variable [ $blankCopyrightHolderNew; Value:Case ( $blankCopyrightHolders = "" ; "" ; $blankCopyrightHolders & ", " ) & "Other copyright holder" ]
    Set Variable [ $blankCopyrightHolders; Value:$blankCopyrightHolderNew ]
    End If
    If [ $blankCopyrightHolders ≠ "" ]
    Show Custom Dialog [ Message: "The following copyright checkboxes where checked, but no copyright holder was specified for them: " & $blankCopyrightHolders & ". Fix this later or now?"; Default Button: “now”, Commit: “Yes”; Button 2: “later”, Commit: “No” ]
    If [ Get ( LastMessageChoice ) = 1 ]
    Exit Script [ ]
    End If
    End If
    #
    #
    If [ reference::showMedia[1] and reference::URL = "" ]
    Show Custom Dialog [ Message: "You have checked the Picture's display web media box, BUT, you deleted the url (web address) for this media (located in the Public copy location area below). Fix this later or now?"; Default Button: “now”, Commit: “Yes”; Button 2: “later”, Commit: “No” ]
    If [ Get ( LastMessageChoice ) = 1 ]
    Exit Script [ ]
    End If
    End If
    #
    #
    End If
    #
    #
    #Clear file name variable used to determine
    #valid file types.
    Set Variable [ $$fileNameFieldHasMedia ]
    #
    #See if the edited record changed position in
    #the main reference window as a result of
    #alphabetical or order number changing edits.
    Set Variable [ $$stoploadCitation ]
    Select Window [ Name: "Hidden"; Current file ]
    #
    #If the edited record moved then note this.
    #Later in this script, if the record did move,
    #then the main reference window will have to
    #be re-sorted to scroll to it in the reference window
    #on the moved, edited record.
    If [ $$editRecord ≠ Get (RecordNumber) ]
    Set Variable [ $recordMoved; Value:Get (RecordNumber) ]
    End If
    #
    #Close editing window
    Close Window [ Name: "References"; Current file ]
    Select Window [ Name: "Hidden"; Current file ]
    Set Window Title [ Current Window; New Title: "References" ]
    #
    #Resort by subject and scroll to edited record.
    If [ $recordMoved ≠ "" ]
    Scroll Window [ End ]
    Sort Records [ ] [ No dialog ]
    End If
    #
    #Allow add mode.
    Set Variable [ $$stopAdd ]
    #
    #Close reference help window if open.
    Close Window [ Name: "Reference Field Help"; Current file ]
    Close Window [ Name: "View Reference"; Current file ]
    #
    #Turn off editing variables.
    Set Variable [ $$editRecord ]
    Set Variable [ $$stoploadCitation ]
    Set Variable [ $$turnOffThisScript ]
    #

Fields used in this script

    refCreatorNode::orderOrLock
    reference::kisWhat
    TEMP::InventoryLibraryYN
    isON::isON_Pulldown
    reference::kisON
    isWhat::isWhat_Pulldown
    reference::kcopyrightHolder
    reference::knodeOther
    reference::knodePrimary
    reference::referenceNodes
    reference::governmentAuthor
    reference::compilationEditors
    reference::kpublication
    reference::kpublisher
    reference::copyrightOtherHolder
    reference::showMedia
    reference::URL

Scripts used in this script

Layouts used in this script

Tables used in this script

    TEMP
    refIsONandIsWHAT
    refIsONandIsWHAT
    reference
    tag

Table occurrences used by this script

    TEMP
    isON
    isWhat
    refCreatorNode
    reference

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [finishReferenceEdit]	Parent Folder: [reference]	Next Script: [gotoReference]
Script Name	formatTitle
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferenceEDIT

Scripts that use this script

Script Definition
Script Steps

    Set Field [ TextFontRemove ( (Get ( ActiveFieldContents )) ) ]
    Set Field [ TextFormatRemove ( (Get ( ActiveFieldContents )) ) ]
    Set Field [ TextSizeRemove ( (Get ( ActiveFieldContents )) ) ]
    Set Field [ TextStyleAdd ( Get ( ActiveFieldContents ) ; Titlecase ) ]

Fields used in this script

Scripts used in this script

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [formatTitle]	Parent Folder: [reference]	Next Script: [goToRefRecord]
Script Name	gotoReference
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultSetup
    defaultTest
    defaultTestNewSection
    learnMenu3Cite
    learnMenu3CiteS

Scripts that use this script

Script Definition
Script Steps

    #
    #basic administration tasks
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    #
    If [ tempSetup::kdefaultCopyright = "" ]
    Show Custom Dialog [ Message: "Select the default copyright for any new records that you create by clicking the copyright button (you can always change your mind)."; Default Button: “OK”, Commit: “Yes” ]
    Halt Script
    Else If [ tempSetup::kdefaultNodePrimary = "" ]
    Show Custom Dialog [ Message: "Select yourself (the node responsible for creating new records) by clicking the node button."; Default Button: “OK”, Commit: “No” ]
    Halt Script
    End If
    #
    #Set in copyAndpastTags script.
    Set Variable [ $$copyAndpastTagsRECORD ]
    #
    #Determine if user wants to edit an external citation.
    If [ Get (LayoutTableName) = "reference" ]
    #
    #Capture record ID so system can return user
    #after editing is complete.
    Set Variable [ $$tagEdit; Value:reference::_Lreference ]
    Set Variable [ $$learnTagLayout; Value:Get (LayoutName) ]
    Set Variable [ $$module; Value:"ref" ]
    #
    #Go to reference tag menu so load citation script
    #below will work properly.
    Set Variable [ $$stoploadTagRecord; Value:1 ]
    Go to Layout [ “ReferenceMenu2keywordOrNode2” (tagMenus) ]
    Set Variable [ $$stoploadTagRecord ]
    #
    #Capture record ID so system can return user
    #after editing is complete.
    Select Window [ Name: "Learn"; Current file ]
    Set Variable [ $$LearnEdit; Value:testlearn::_Ltestlearn ]
    #
    #Take user to reference layout without pictures
    #for faster looping thru records.
    Set Variable [ $$stoploadCitation; Value:1 ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “ReferenceStuffScriptLoops” (reference) ]
    Else
    Go to Layout [ “ReferenceStuffScriptLoops” (reference) ]
    End If
    Set Window Title [ Current Window; New Title: "References" ]
    #
    #Find main records.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Show All Records
    #
    #Omit locked records, which are the copyright
    #images used by default copyright tags.
    Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: reference::lock: “lock” ] [ Restore ]
    #
    If [ TEMP::InventoryLibraryYN = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagKeywordPrimary::orderOrLock; based on value list: “order Pulldown List” tagKeywordPrimary::tag; ascending reference::referenceShort; ascending ] [ Restore; No dialog ]
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagKeywordPrimary::orderOrLock; based on value list: “order Pulldown List” tagKeywordPrimary::tag; ascending reference::referenceShort; ascending ] [ Restore; No dialog ]
    End If
    #
    #Loop to record to be edited.
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    Loop
    Exit Loop If [ $$tagEdit = reference::_Lreference ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Load selected records keys and the menu 'key'.
    Set Variable [ $$stoploadCitation ]
    Perform Script [ “menuKey” ]
    Perform Script [ “loadLearnOrRefMainRecord” ]
    #
    #Take user to reference edit layout with pictures.
    Set Variable [ $$stoploadCitation; Value:1 ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “ReferenceStuff” (reference) ]
    Else
    Go to Layout [ “Reference” (reference) ]
    End If
    Set Variable [ $$stoploadCitation ]
    #
    Else If [ Left ( Get (LayoutName) ; 1 ) = "d" ]
    #
    #
    #Capture record ID so system can return user
    #after editing is complete.
    Set Variable [ $$defaultRecordNumber; Value:Get (RecordNumber) ]
    Set Variable [ $$defaultTagLayout; Value:Get (LayoutName) ]
    #
    #Go to reference tag menu so load citation script
    #below will work properly.
    Set Variable [ $$stoploadTagRecord; Value:1 ]
    Go to Layout [ “ReferenceMenu2keywordOrNode2” (tagMenus) ]
    Set Variable [ $$stoploadTagRecord ]
    #
    #Capture record ID so system can return user
    #after editing is complete.
    Select Window [ Name: "Setup"; Current file ]
    #
    #Take user to citation edit layout.
    Set Variable [ $$stoploadCitation; Value:1 ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “ReferenceStuff” (reference) ]
    Else
    Go to Layout [ “Reference” (reference) ]
    End If
    Set Window Title [ Current Window; New Title: "References" ]
    #
    #Find main records.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Show All Records
    #
    #Omit locked records, which are the copyright
    #images used by default copyright tags.
    Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: reference::lock: “lock” ] [ Restore ]
    #
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    #
    Go to Layout [ “ReferenceStuff” (reference) ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagKeywordPrimary::orderOrLock; based on value list: “testPulldownListANDsortOrderList” tagKeywordPrimary::tag; ascending reference::publicationYearOrStuffOrderNumber; based on value list: “testPulldownListANDsortOrderList” reference::Title; ascending reference::thoughtsNotesEtc; ascending ] [ Restore; No dialog ]
    #
    Else
    #
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagKeywordPrimary::orderOrLock; based on value list: “order Pulldown List” tagKeywordPrimary::tag; ascending reference::referenceShort; ascending ] [ Restore; No dialog ]
    #
    End If
    #
    #Go to first record.
    Go to Record/Request/Page [ First ]
    Set Variable [ $$stoploadCitation ]
    Perform Script [ “menuKey” ]
    Perform Script [ “loadLearnOrRefMainRecord” ]
    Scroll Window [ Home ]
    #
    #
    End If

Fields used in this script

    tempSetup::kdefaultCopyright
    tempSetup::kdefaultNodePrimary
    reference::_Lreference
    testlearn::_Ltestlearn
    TEMP::InventoryLibraryYN
    reference::lock
    tagKeywordPrimary::orderOrLock
    tagKeywordPrimary::tag
    reference::referenceShort
    reference::publicationYearOrStuffOrderNumber
    reference::Title
    reference::thoughtsNotesEtc

Scripts used in this script

    menuKey
    loadLearnOrRefMainRecord

Layouts used in this script

    ReferenceMenu2keywordOrNode2
    ReferenceStuffScriptLoops
    ReferenceStuff
    Reference

Tables used in this script

    TEMP
    TEMP
    reference
    tag
    testlearn

Table occurrences used by this script

    TEMP
    reference
    tagKeywordPrimary
    tempSetup
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [gotoReference]	Parent Folder: [reference]	Next Script: [helpReferenceFields]
Script Name	goToRefRecord
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    Set Variable [ $refRecordNumber; Value:Get ( RecordNumber ) ]
    Go to Record/Request/Page [ Last ]
    Go to Record/Request/Page [ $refRecordNumber ] [ No dialog ]

Fields used in this script

Scripts used in this script

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [goToRefRecord]	Parent Folder: [reference]	Next Script: [insertTimeInRefTimeField]
Script Name	helpReferenceFields
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #NOTE!!! IF future help fields need to be added,
    #leave repition 50 blank as it is the one used on
    #the reference layout. By leaving it blank, no
    #text appears in this field.
    #
    #After a user selects a popup calendar date,
    #the exitAndStopClearCitationMatch sets the
    #variable below and then FileMaker leaves the
    #date field and enters the help field, which
    #thanks to this variable will not run, giving the
    #user a pleasant experience of selecting a
    #calendar date and watching the calendar go
    #away without anything else happening.
    If [ $$pleaseExitUserJustLeftCalendarField ≠ "" ]
    Set Variable [ $$pleaseExitUserJustLeftCalendarField ]
    Go to Field [ ]
    Exit Script [ ]
    End If
    #
    #
    #Get help message number from the object
    #names: r33 = 33, and so on.
    Set Variable [ $objectName; Value:Middle ( Get ( ActiveLayoutObjectName ) ; 2 ; 2 ) ]
    Set Field [ TEMP::HelpMessage; TEMP::Help [$objectName] ]
    Set Field [ TEMP::HelpRepetitionNumber; TextColor ( "help" ; RGB ( 150 ; 150 ; 150 ) ) & TextSize ( TextColor ( " #" ; RGB ( 150 ; 150 ; 150 ) ) ; 15 ) & Middle ( Get ( ActiveLayoutObjectName ) ; 2 ; 2 ) ]
    Go to Field [ ]
    #
    #Get current window's width so view window
    #can be moved the right of it.
    Set Variable [ $width; Value:Get ( WindowWidth ) ]
    #
    #Closer this window just in case a copy of it
    #is open, and then open a new one.
    Close Window [ Name: "Reference Field Help"; Current file ]
    #
    #Open help message in a new window.
    Set Variable [ $$stoploadCitation; Value:1 ]
    New Window [ Name: "Reference Field Help"; Height: 431; Width: 331; Left: Case ( Get ( ScreenWidth ) > $width + 331 ; $width ; Get ( ScreenWidth ) - 331 ); Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “ReferenceHelp” (reference) ]
    Set Zoom Level [ 100%; Camera: Back; Resolution: Full ]
    Set Variable [ $$stoploadCitation ]
    #

Fields used in this script

    TEMP::Help
    TEMP::HelpMessage
    TEMP::HelpRepetitionNumber

Scripts used in this script

Layouts used in this script

    ReferenceHelp

Tables used in this script

    TEMP

Table occurrences used by this script

    TEMP

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [helpReferenceFields]	Parent Folder: [reference]	Next Script: [isONpulldownMenu]
Script Name	insertTimeInRefTimeField
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    If [ reference::TimeRange = "" ]
    Set Field [ reference::TimeRange; "0:00:00" ]
    End If

Fields used in this script

    reference::TimeRange

Scripts used in this script

Layouts used in this script

Tables used in this script

    reference

Table occurrences used by this script

    reference

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [insertTimeInRefTimeField]	Parent Folder: [reference]	Next Script: [isWHATpulldownMenu]
Script Name	isONpulldownMenu
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Clear the other fields.
    Set Field [ reference::otherIsOn; "" ]
    Set Field [ reference::otherIsWhat; "" ]
    #
    #Clear the 'What is it?' key.
    Set Field [ reference::kisWhat; "" ]
    #
    #If 'What is it?' insert other's key.
    If [ Left (isON::key ; 1 ) = 9 ]
    Set Field [ reference::kisWhat; 5122017153755111 ]
    End If
    #
    #copyright tags are, then exit the script.
    If [ isON::key = 9.1 ]
    Set Field [ reference::otherIsWhat; "database" ]
    Go to Field [ reference::otherIsWhat ]
    Else If [ isON::key = 9.2 ]
    Set Field [ reference::otherIsWhat; "broadcast" ]
    Go to Field [ reference::otherIsWhat ]
    Else If [ isON::key = 9.3 ]
    Set Field [ reference::otherIsWhat; "museum" ]
    Go to Field [ reference::otherIsWhat ]
    Else If [ isON::key = 9.4 ]
    Set Field [ reference::otherIsWhat; "conversation" ]
    Go to Field [ reference::otherIsWhat ]
    Else If [ isON::key = 9.5 ]
    Set Field [ reference::otherIsWhat; "computer" ]
    Go to Field [ reference::otherIsWhat ]
    Else If [ isON::key = 9.6 ]
    Set Field [ reference::otherIsWhat; "experience" ]
    Go to Field [ reference::otherIsWhat ]
    Else If [ isON::key = 9.7 ]
    Set Field [ reference::otherIsWhat; "painting" ]
    Go to Field [ reference::otherIsWhat ]
    Else If [ isON::key = 9.8 ]
    Set Field [ reference::otherIsWhat; "performance" ]
    Go to Field [ reference::otherIsWhat ]
    Else If [ isON::key = 9.9 ]
    Set Field [ reference::otherIsWhat; "presentation" ]
    Go to Field [ reference::otherIsWhat ]
    Else
    Go to Field [ ]
    End If
    #
    Halt Script
    #

Fields used in this script

    reference::otherIsOn
    reference::otherIsWhat
    reference::kisWhat
    isON::key

Scripts used in this script

Layouts used in this script

Tables used in this script

    refIsONandIsWHAT
    reference

Table occurrences used by this script

    isON
    reference

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [isONpulldownMenu]	Parent Folder: [reference]	Next Script: [loadLearnOrRefMainRecord]
Script Name	isWHATpulldownMenu
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Clear the other field.
    Set Field [ reference::otherIsWhat; "" ]
    Go to Field [ ]
    Halt Script

Fields used in this script

    reference::otherIsWhat

Scripts used in this script

Layouts used in this script

Tables used in this script

    reference

Table occurrences used by this script

    reference

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [isWHATpulldownMenu]	Parent Folder: [reference]	Next Script: [LocationEditFieldsHIDE]
Script Name	loadLearnOrRefMainRecord
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    deleteLearnMainRecord
    duplicateLearnRecord
    newLearn
    addLinksPicturesToTagsMode
    showTagsReferenceForPicture1
    showTagsReferenceForPicture2
    showTagsReferenceForPicture3
    deleteReference
    duplicateReferenceRecord
    findALL_LearnOrRefRecords
    gotoReference
    newReference
    showCitation
    showTagsReferenceForLink1
    showTagsReferenceForLink2
    showTagsReferenceForLink3
    backToLearnOrDefaultSetup
    findKeyOtherRef
    findKeyOtherTL
    findPrimaryRef
    findPrimaryTL
    loadBrainstormTags
    loadTestTags
    showCited

Script Definition
Script Steps

    #
    #
    #This first section is key to stopping this script
    #when another script for example loops thru
    #many records each of which would trigger this
    #script and really slow down the program and
    #create strobe effect that is really irritating to
    #look at.
    If [ $$stoploadCitation = 1 ]
    Exit Script [ ]
    End If
    #
    #
    #Admin tasks.
    Set Variable [ ]
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #If user clicked in the key word menu field
    #(when selecting this record) and so activiated
    #the script that loads the key tag menu, stop
    #it from being loaded.
    Set Variable [ $$stopTgotoCitationMenu; Value:1 ]
    #
    #These steps effect the button action where when the
    #use clicks on the actual text box of a learn record
    #a new window opens just displaying the text. This
    #stops this when the user was clicking on it to select
    #this record instead of adding text to it.
    If [ Get (LayoutName) = "learn0" or Get (LayoutName) = "learn1" or Get (LayoutName) = "learn2" or Get (LayoutName) = "learn3" or Get (LayoutName) = "learn4" or Get (LayoutName) = "learn5" or Get (LayoutName) = "learnStuff0" or Get (LayoutName) = "learnStuff1" or Get (LayoutName) = "learnStuff2" or Get (LayoutName) = "learnStuff3" or Get (LayoutName) = "learnStuff4" or Get (LayoutName) = "learnStuff5" ]
    Set Variable [ $$stopOpenNewTextWindow; Value:1 ]
    End If
    #
    #This key effects the conditional formatting
    #of any records in the Tag Menus window
    #that are related to the citation record that triggered
    #this script (by the user click on it, of course).
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    Set Variable [ $$main; Value:testlearn::_Ltestlearn ]
    If [ $$citationMatch = "node" ]
    Set Variable [ $$citationItem; Value:testlearn::kNodePrimary ]
    Set Variable [ $$tagTest ]
    Set Variable [ $$tagBrainstorm ]
    Else If [ $$citationMatch = "key" ]
    Set Variable [ $$citationItem; Value:testlearn::kKeywordPrimary ]
    Else If [ $$citationMatch = "ref" ]
    Set Variable [ $$citationItem; Value:testlearn::kcreference ]
    Set Variable [ $$tagTest ]
    Set Variable [ $$tagBrainstorm ]
    Else If [ $$citationMatch = "test" ]
    Set Variable [ $$citationItem; Value:testlearn::kctestSubsectionInfo ]
    Else If [ $$citationMatch = "brainstorm" ]
    Set Variable [ $$citationItem; Value:testlearn::kcbrainstorm ]
    End If
    #
    #capture keys of related tag menu items to
    #to allow the citationMenu scripts to loop to the
    #primary record of interest when the user navigates
    #to a item on the Tag Menu window
    #whose list of tags like node, keyword, medium, etc.
    #might contain an item related to the current
    #citation record, but which one, which is why all
    #the keys have to be readied. Mmm... now that
    #I write this out, I'm thinking I could have the
    #citationMenu scripts select the citation window
    #to grab the key if any in the current current
    #record that applies the the menu item.
    Set Variable [ $$citationRecord; Value:testlearn::_Ltestlearn ]
    Set Variable [ $$node; Value:testlearn::kNodeOther ]
    Set Variable [ $$primaryNode; Value:testlearn::kNodePrimary ]
    Set Variable [ $$copyright; Value:testlearn::kcopyright ]
    Set Variable [ $$ref; Value:testlearn::kcreference ]
    Set Variable [ $$refMediaSelectedToShow; Value:Case ( testlearn::kshowReferencedMedia = "" ; "" ; testlearn::kshowReferencedMedia ) ]
    Set Variable [ $$PrimaryKey; Value:testlearn::kKeywordPrimary ]
    Set Variable [ $$Key; Value:testlearn::kcKeywordOther ]
    Set Variable [ $$OtherKey; Value:testlearn::kcKeywordOther ]
    Set Variable [ $$test; Value:testlearn::kctestSubsectionInfo ]
    Set Variable [ $$brainstorm; Value:testlearn::kcbrainstorm ]
    Set Variable [ $$RecordID; Value:Get (RecordID) ]
    Set Variable [ $windowName; Value:Get (WindowName) ]
    #
    #Note if record is locked to protect its tags.
    If [ tagTLNodePrimary::orderOrLock ≠ "" ]
    Set Variable [ $$lockedMainLearnRecord; Value:tagTLNodePrimary::tag ]
    Else
    Set Variable [ $$lockedMainLearnRecord ]
    End If
    Commit Records/Requests
    #
    If [ $$add = "" and $$DuplicateDontGoToTagMenuWindow = "" ]
    #Match any records in tag window and go to
    #primary tag record or to first record if none.
    #And don't run LoadTagRecord until matching is
    #done to prevent flashing and slowing down script.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    #Turn off the reveal hidden field's variable so
    #they don't get revealed in the location Tag
    #Menus window by navigating to a different
    #learn record, which would be odd.
    Set Variable [ $$editLocation ]
    #
    If [ Get (LastError) = 112 ]
    Perform Script [ “TgotoCitationMenu” ]
    End If
    Refresh Window
    Go to Field [ ]
    #
    #Turn back on the reveal hidden field's variable
    #so if the user now selects the current location
    #record in the Tag Menus window, the hidden
    #fields they need to edit it will show up.
    Set Variable [ $$editLocation; Value:reference::_Lreference ]
    #
    End If
    Set Variable [ $$DuplicateDontGoToTagMenuWindow ]
    #
    Else If [ Get (LastError) ≠ 112 ]
    #
    #Get reference groups and references order
    #number in case user changes it.
    Set Variable [ $$refGroupOrderNumber; Value:tagKeywordPrimary::orderOrLock ]
    Set Variable [ $$refOrderNumber; Value:reference::publicationYearOrStuffOrderNumber ]
    #
    #Get record number so if during the editing of
    #this record its alphabetical order should
    #change, the library will sort the window to
    #keep the user focused on the changed
    #record.
    Set Variable [ $$referenceRecordPosition; Value:Get ( RecordNumber ) ]
    #
    Set Variable [ $$main; Value:reference::_Lreference ]
    Set Field [ TEMP::ReferenceFolder; reference::kfileLocation ]
    If [ $$citationMatch = "node" ]
    Set Variable [ $$citationItem; Value:reference::knodePrimary ]
    Else If [ $$citationMatch = "medium" ]
    Set Variable [ $$citationItem; Value:reference::kmedium ]
    Else If [ $$citationMatch = "Path" ]
    Set Variable [ $$citationItem; Value:reference::kfolderpath ]
    Else If [ $$citationMatch = "key" ]
    Set Variable [ $$citationItem; Value:reference::kkeywordPrimary ]
    Else If [ $$citationMatch = "publication" ]
    Set Variable [ $$citationItem; Value:reference::kpublication ]
    Else If [ $$citationMatch = "publisher" ]
    Set Variable [ $$citationItem; Value:reference::kpublisher ]
    Else If [ $$citationMatch = "copyright" ]
    Set Variable [ $$citationItem; Value:reference::kCopyright ]
    Else If [ $$citationMatch = "cite" ]
    Set Variable [ $$citationItem; Value:reference::kcitation ]
    Else If [ $$citationMatch = "ref" ]
    Set Variable [ $$citationItem; Value:testlearn::kcreference ]
    End If
    #
    #capture keys of related tag menu items to
    #to allow the citationMenu scripts to loop to the
    #primary record of interest when the user navigates
    #to a item on the Tag Menu window
    #whose list of tags like node, keyword, medium, etc.
    #might contain an item related to the current
    #citation record, but which one, which is why all
    #the keys have to be readied. Mmm... now that
    #I write this out, I'm thinking I could have the
    #citationMenu scripts select the citation window
    #to grab the key if any in the current current
    #record that applies the the menu item.
    Set Variable [ $$citationRecord; Value:reference::_Lreference ]
    Set Variable [ $$node; Value:reference::knodeOther ]
    Set Variable [ $$primaryNode; Value:reference::knodePrimary ]
    Set Variable [ $$publication; Value:reference::kpublication ]
    Set Variable [ $$publisher; Value:reference::kpublisher ]
    Set Variable [ $$medium; Value:reference::kmedium ]
    Set Variable [ $$copyright; Value:reference::kCopyright ]
    Set Variable [ $$CopyrightType; Value:reference::kcopyrightType ]
    Set Variable [ $$Path; Value:reference::kfolderpath ]
    Set Variable [ $$cite; Value:reference::kcitation ]
    Set Variable [ $$ref; Value:reference::lock ]
    Set Variable [ $$PrimaryKey; Value:reference::kkeywordPrimary ]
    Set Variable [ $$Key; Value:reference::kkeywordOther ]
    Set Variable [ $$OtherKey; Value:reference::kkeywordOther ]
    Set Variable [ $$RecordID; Value:Get (RecordID) ]
    Set Variable [ $windowName; Value:Get (WindowName) ]
    #
    #
    #Note if record is locked to protect its tags.
    If [ refCreatorNode::orderOrLock ≠ "" ]
    Set Variable [ $$lockedMainRefRecord; Value:refCreatorNode::tag ]
    Else
    Set Variable [ $$lockedMainRefRecord ]
    End If
    #
    #Stop user getting locked record message by
    #turning of the exit script that will be triggered
    #once this record commits.
    Set Variable [ $$turnOffRefStuffExitScript; Value:1 ]
    Commit Records/Requests
    Set Variable [ $$turnOffRefStuffExitScript ]
    #
    If [ $$add = "" ]
    #Match any records in tag window and go to
    #primary tag record or to first record if none.
    #And don't run LoadTagRecord until matching is
    #done to prevent flashing and slowing down script.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Select Window [ Name: "Tag Menus"; Current file ]
    If [ Get (LastError) = 112 ]
    Perform Script [ “TgotoCitationMenu” ]
    End If
    Refresh Window
    End If
    End If
    #
    #Return to observation or reference window.
    Set Variable [ $$stopLoadTagRecord ]
    Select Window [ Name: $windowName; Current file ]
    Refresh Window
    #
    #
    #Purple highlight the find button for idea notes.
    #If user is loading a learn record, then check
    #if any learn records reference it and if so
    #set a variable to conditionally format the learn
    #window's 'find' button purple to indicate this.
    If [ Get ( WindowName ) = "Learn" and TEMP::InventoryLibraryYN = "" ]
    Set Variable [ $$stoploadCitation; Value:1 ]
    New Window [ Name: "LinkedLearnRecords"; Height: 1; Width: 1; Top: -1000; Left: -1000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    // New Window [ Name: "LinkedLearnRecords"; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    #
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    Enter Find Mode [ ]
    Set Field [ testlearn::kcreference; $$main ]
    Perform Find [ ]
    #
    If [ Get (LastError) = 401 ]
    Set Variable [ $$stoploadCitation ]
    Set Variable [ $$LinkedLearnRecords ]
    Set Variable [ $$stopTgotoCitationMenu; Value:1 ]
    Close Window [ Name: "LinkedLearnRecords"; Current file ]
    Refresh Window
    Exit Script [ ]
    End If
    #
    Set Variable [ $$LinkedLearnRecords; Value:Get (FoundCount) ]
    #
    Set Variable [ $$stoploadCitation ]
    Close Window [ Name: "LinkedLearnRecords"; Current file ]
    #
    Refresh Window
    End If
    #
    Set Variable [ $$stopTgotoCitationMenu ]
    #
    #

Fields used in this script

    testlearn::_Ltestlearn
    testlearn::kNodePrimary
    testlearn::kKeywordPrimary
    testlearn::kcreference
    testlearn::kctestSubsectionInfo
    testlearn::kcbrainstorm
    testlearn::kNodeOther
    testlearn::kcopyright
    testlearn::kshowReferencedMedia
    testlearn::kcKeywordOther
    tagTLNodePrimary::orderOrLock
    tagTLNodePrimary::tag
    reference::_Lreference
    tagKeywordPrimary::orderOrLock
    reference::publicationYearOrStuffOrderNumber
    reference::kfileLocation
    TEMP::ReferenceFolder
    reference::knodePrimary
    reference::kmedium
    reference::kfolderpath
    reference::kkeywordPrimary
    reference::kpublication
    reference::kpublisher
    reference::kCopyright
    reference::kcitation
    reference::knodeOther
    reference::kcopyrightType
    reference::lock
    reference::kkeywordOther
    refCreatorNode::orderOrLock
    refCreatorNode::tag
    TEMP::InventoryLibraryYN

Scripts used in this script

    TgotoCitationMenu

Layouts used in this script

Tables used in this script

    TEMP
    reference
    tag
    testlearn

Table occurrences used by this script

    TEMP
    refCreatorNode
    reference
    tagKeywordPrimary
    tagTLNodePrimary
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [loadLearnOrRefMainRecord]	Parent Folder: [reference]	Next Script: [menuLearn]
Script Name	LocationEditFieldsHIDE
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #Stop this script when first navigating to a
    #record. User most likely just wanted to
    #go this record; not edit it.
    If [ $$editLocation = "" ]
    Exit Script [ ]
    End If
    #
    #If the user decided not continue editing this
    #Hide the edit fields (which are hidden once
    #this variable is blank and the window
    #is refreshed).
    Set Variable [ $$editLocation ]
    Refresh Window
    #
    #Once the field is hidden, re-load this variable
    #so the next time the user clicks on the picture
    #field (if there is no picture) they will be taken
    #to the edit fields. If this variable remains
    #blank, then the next time they click on an
    #empty picture field, nothing will happen, which
    #can be frustrating if you're trying to edit.
    Set Variable [ $$editLocation; Value:reference::_Lreference ]
    #
    #

Fields used in this script

    reference::_Lreference

Scripts used in this script

Layouts used in this script

Tables used in this script

    reference

Table occurrences used by this script

    reference

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [LocationEditFieldsHIDE]	Parent Folder: [reference]	Next Script: [newLocationRecord]
Script Name	menuLearn
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ltagNK1
    ltagNK2
    ltagNK3
    ltagNK4
    ltagNK5
    learnMenu3Cite
    learnMenu3CiteS
    learnMenu4RefCite
    learnMenu4noPicRefCite
    learnTagWindowNoTags
    learnMenuBrainstorm
    learnTest

Scripts that use this script

    findMode
    TgotoCitationMenu

Script Definition
Script Steps

    #
    #
    #Clear brainstorm and test tags so there conditional
    #formatting in the Learn window is removed.
    If [ $$citationMatch = "brainstorm" or $$citationMatch = "test" ]
    Select Window [ Name: "Learn"; Current file ]
    Go to Field [ ]
    Set Variable [ $$tagBrainstorm ]
    Set Variable [ $$tagtest ]
    Set Variable [ $$tagRecordID ]
    Set Variable [ $$tagEdit ]
    #
    #Sort the records by date field, if current sort is
    #by order number.
    If [ TEMP::TLTestSort = 1 or TEMP::TLBrainstormSort = 1 ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::date; descending testlearn::timestamp; descending ] [ Restore; No dialog ]
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::orderInventoryGroupNumber; ascending testlearn::note; ascending ] [ Restore; No dialog ]
    End If
    #
    #Set the sort preference field to date.
    If [ $$citationMatch = "brainstorm" ]
    Set Field [ TEMP::TLBrainstormSort; "" ]
    Else If [ $$citationMatch = "test" ]
    Set Field [ TEMP::TLTestSort; "" ]
    End If
    End If
    #
    End If
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    #Set citationMatch to color menu button with inUse color.
    Set Variable [ $$citationMatch; Value:"learn" ]
    #
    #Set testlearn internal reference field conditional
    #formatting to green if there are any.
    Set Variable [ $$internal; Value:1 ]
    #
    #Speed up script.
    Set Variable [ $$stoploadCitation; Value:1 ]
    #
    #Show all internal reference possibilities.
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “learnMenu4noPicRefCite” (testlearn) ]
    Else
    Go to Layout [ “learnMenu4noPicRefCite” (testlearn) ]
    End If
    #
    #Find learn records that can be referenced.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    Enter Find Mode [ ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Set Field [ testlearn::brainstormCasePoint; "1" ]
    End If
    Set Field [ testlearn::filterFind; "main" ]
    Perform Find [ ]
    #
    #If the user has yet to create any Learn or internal records
    #let them know, and return user to outside reference records.
    If [ Get (FoundCount) = 0 ]
    #
    Show Custom Dialog [ Message: "No Learn records have been created."; Default Button: “OK”, Commit: “Yes” ]
    #
    #Turn back on essential variable.
    Set Variable [ $$stoploadCitation ]
    Exit Script [ ]
    #
    End If
    #
    #Continue with show all internal reference possibilities...
    If [ TEMP::InventoryLibraryYN = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::date; descending testlearn::timestamp; descending ] [ Restore; No dialog ]
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::orderInventoryGroupNumber; ascending testlearn::note; ascending ] [ Restore; No dialog ]
    End If
    #
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    #
    #If the current learn record references another
    #learn record, find it.
    If [ Filter ( $$ref ; "L" ) ≠ "" ]
    Loop
    Exit Loop If [ testlearn::_Ltestlearn & "L¶" = FilterValues ( $$ref ; testlearn::_Ltestlearn & "L¶" ) and $$citationMatch = "ref" ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #If no records are used as a cite or ref, go to first record.
    If [ Get (LastError) = 101 ]
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    End If
    #
    End If
    #
    #Goto correct layout.
    If [ TEMP::InventoryLibraryYN = "" ]
    #Idea Mode
    #
    If [ TEMP::layoutLtagL = "" ]
    #If no layout preference is set, then on iDevices
    #go the layout with no pictures, and to the
    #layout with pictures on desktop computers.
    If [ Get (SystemPlatform) = 3 ]
    Go to Layout [ “learnMenu4noPicRefCite” (testlearn) ]
    Set Field [ TEMP::layoutLtagL; "more" & Get (LayoutName) ]
    Else
    Go to Layout [ “learnMenu4RefCite” (testlearn) ]
    Set Field [ TEMP::layoutLtagL; "less" & Get (LayoutName) ]
    End If
    Else
    #
    #Go the layout the user has selected.
    Go to Layout [ Middle ( TEMP::layoutLtagL ; 5 ; 42 ) ]
    End If
    #
    Else
    #
    #Inventory Mode
    If [ Left (Get (LayoutName) ; 1) = "l" ]
    Go to Layout [ “learnMenu4STUFFRefCite” (testlearn) ]
    // Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::orderInventoryGroupNumber; ascending testlearn::note; ascending ] [ Restore; No dialog ]
    Else If [ Left (Get (LayoutName) ; 1) = "r" ]
    End If
    #
    #
    End If
    #
    #Update conditional formatting in main window.
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    Go to Field [ ]
    Else If [ Get (LastError) ≠ 112 ]
    Go to Field [ ]
    End If
    Refresh Window
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    #Turn back on essential variable.
    Set Variable [ $$stoploadCitation ]
    #

Fields used in this script

    TEMP::TLTestSort
    TEMP::TLBrainstormSort
    TEMP::InventoryLibraryYN
    testlearn::date
    testlearn::timestamp
    testlearn::orderInventoryGroupNumber
    testlearn::note
    testlearn::brainstormCasePoint
    testlearn::filterFind
    testlearn::_Ltestlearn
    TEMP::layoutLtagL

Scripts used in this script

Layouts used in this script

    learnMenu4noPicRefCite
    learnMenu4RefCite
    learnMenu4STUFFRefCite

Tables used in this script

    TEMP
    testlearn

Table occurrences used by this script

    TEMP
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [menuLearn]	Parent Folder: [reference]	Next Script: [newReference]
Script Name	newLocationRecord
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    learnMenuRefStuff

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #If node is currenlty locked then stop script,
    #and inform the user.
    Perform Script [ “stopNewRecordsBeingCreatedByLockedNode” ]
    #
    #Copy primary key word/subject of current
    #record so it can be given to then new record.
    #The user will expect that clicking the new
    #button will result in new record in the current
    #subject area.
    If [ reference::kkeywordPrimary = "" ]
    Set Variable [ $P; Value:31120182009273386 ]
    Else
    Set Variable [ $P; Value:reference::kkeywordPrimary ]
    End If
    #Copy the current order number.
    Set Variable [ $pubYear; Value:reference::publicationYearOrStuffOrderNumber ]
    #
    #Now create a new record and give it the
    #copied information.
    Go to Field [ ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    New Record/Request
    Set Field [ reference::kkeywordPrimary; $P ]
    Set Field [ reference::publicationYearOrStuffOrderNumber; $pubYear ]
    #
    #Load new record as the record being
    #focused on.
    Set Variable [ $$stopLoadTagRecord ]
    Set Variable [ $$doNotHaltOtherScripts; Value:1 ]
    Perform Script [ “loadTagRecord” ]
    #
    #Now go the new record's title field.
    Set Variable [ $$editLocation; Value:reference::_Lreference ]
    Refresh Window
    Set Variable [ $$editLocation ]
    Go to Object [ Object Name: "tag 1" ]
    Set Variable [ $$editLocation; Value:reference::_Lreference ]
    Refresh Window
    Set Variable [ $$doNotHaltOtherScripts ]
    #
    #

Fields used in this script

    reference::kkeywordPrimary
    reference::publicationYearOrStuffOrderNumber
    reference::_Lreference

Scripts used in this script

    stopNewRecordsBeingCreatedByLockedNode
    loadTagRecord

Layouts used in this script

Tables used in this script

    reference

Table occurrences used by this script

    reference

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [newLocationRecord]	Parent Folder: [reference]	Next Script: [openReferenceWebsite]
Script Name	newReference
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    Reference
    ReferenceStuff

Scripts that use this script

Script Definition
Script Steps

    #
    #If node is currenlty locked then stop script,
    #and inform the user.
    Perform Script [ “stopNewRecordsBeingCreatedByLockedNode” ]
    #
    #If in find mode, exit script.
    If [ $$findMode ≠ "" ]
    Show Custom Dialog [ Message: "Currently in find mode. Click done in the tag menus window to exit find mode, and then click this button."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #If in find mode, exit find mode.
    If [ $$findMode= 1 ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Set Variable [ $$findMode ]
    Set Variable [ $$firstFind ]
    Set Variable [ $$firstFindOther ]
    Set Variable [ $$found ]
    Set Variable [ $$foundOther ]
    Go to Layout [ $$findLayout ]
    Set Variable [ $$stoploadCitation ]
    Select Window [ Name: "References"; Current file ]
    End If
    #
    #If user is in tag field and has changed spelling
    #exit this tag record, otherwise current reference record
    #will get deleted by the spelling check script.
    Select Window [ Name: "Tag Menus"; Current file ]
    Go to Field [ ]
    Select Window [ Name: "References"; Current file ]
    Sort Records [ ] [ No dialog ]
    #
    #Copy primary key word/subject of current
    #record so it can be given to then new record.
    # The user will expect that clicking the 'new'
    #button will result in new record in the current
    #subject area.
    Set Variable [ $P; Value:reference::kkeywordPrimary ]
    #
    Go to Field [ ]
    #
    #Now create a new record and give it the
    #copied subject/keyword.
    Set Variable [ $$stoploadCitation; Value:1 ]
    New Record/Request
    Set Field [ reference::kkeywordPrimary; $P ]
    #
    #Load new record as the record being
    #focused on.
    Set Variable [ $$stoploadCitation ]
    Perform Script [ “loadLearnOrRefMainRecord” ]
    #
    #Determine if in stuff or idea mode.
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    #
    #If in stuff mode than select to
    #show record in the Learn section.
    Set Field [ reference::showInLearn; "show in learn" ]
    #
    #Decided to make main reference layout also
    #include the fields that will be edited, so no
    #need in stuffLibrary mode to go an
    #edit layout.
    Else
    #
    #If in idea mode then open new record in a
    #separate window. This is neccessary to allow
    #user to scroll thru just this new record after
    #finding just this new record in the new
    #window.
    # Also, the new window strategy means the
    #main reference window will not need to be
    #resorted, and so moved unless the
    #alphabetical location of this new record
    #requires it to be resorted.
    Set Variable [ $$stoploadCitation; Value:1 ]
    Sort Records [ ] [ No dialog ]
    Set Variable [ $$editRecord; Value:Get (RecordNumber) ]
    Go to Record/Request/Page [ $$editRecord ] [ No dialog ]
    #
    #Go to edit layout in new window.
    Set Window Title [ Current Window; New Title: "Hidden" ]
    #
    #Mark record as incomplete.
    Set Field [ reference::incomplete; "incomplete" & ¶ ]
    #
    #For some reason it is essential that a Go to
    #field step is included prior to opening the
    #new window for Add to tags scripts to work.
    Go to Field [ ]
    #
    New Window [ Name: "References"; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “ReferenceEDIT” (reference) ]
    #
    #Find just the record to be edited.
    Enter Find Mode [ ]
    Set Field [ reference::_Lreference; $$citationRecord ]
    Perform Find [ ]
    Set Variable [ $$stoploadCitation ]
    #
    End If
    #
    #Prevent add mode.
    Set Variable [ $$stopAdd; Value:1 ]
    #

Fields used in this script

    reference::kkeywordPrimary
    TEMP::InventoryLibraryYN
    reference::showInLearn
    reference::incomplete
    reference::_Lreference

Scripts used in this script

    stopNewRecordsBeingCreatedByLockedNode
    loadLearnOrRefMainRecord

Layouts used in this script

    <Missing Layout>
    ReferenceEDIT

Tables used in this script

    TEMP
    reference

Table occurrences used by this script

    TEMP
    reference

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [newReference]	Parent Folder: [reference]	Next Script: [publisherCheckboxRadioButtonActionPart1]
Script Name	openReferenceWebsite
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    Reference
    ReferenceEDIT
    ReferenceFilePathEDIT
    ReferenceMenu3Cite
    ReferenceMenu3CiteNoPicture
    ReferencePictureWindow_Web
    ReferenceAddToTag
    ReferenceAddToCopyright
    learn0
    learn1
    learn2
    learn3
    learn4
    learn5
    learn4EDIT
    learn4EDITLocked
    LearnTextWindow
    LearnTextWindow_iDevice
    LearnTextWindowLocked
    LearnTextWindowLocked_iDevice
    learnMenu3Cite
    learnMenu3CiteS
    learnMenu3CitePickAReference
    LearnRefWebPictureWindow
    LearnRefWebPictureWindowEDIT
    testInfo
    TestInfoReference
    testInfoText
    testInfoTextLocked
    reportTagInfo

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Note that user has clicked the web button.
    Set Variable [ $$openReferencedWebsite; Value:1 ]
    #
    #
    #Perform the showFileWebsite script to see if
    #there is a website to show, and if there is
    #open it.
    Perform Script [ “showReferencedFileFolder” ]
    #
    #

Fields used in this script

Scripts used in this script

    showReferencedFileFolder

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [openReferenceWebsite]	Parent Folder: [reference]	Next Script: [removeCopyrightType]
Script Name	publisherCheckboxRadioButtonActionPart1
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    If [ ValueCount ( reference::publisherTypeAlternative ) = 2 ]
    Set Field [ reference::publisherTypeAlternative; Substitute ( reference::publisherTypeAlternative ; GetValue (reference::publisherTypeAlternative;1 ) & "¶" ; "" ) ]
    End If
    Go to Field [ ]
    #

Fields used in this script

    reference::publisherTypeAlternative

Scripts used in this script

Layouts used in this script

Tables used in this script

    reference

Table occurrences used by this script

    reference

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [publisherCheckboxRadioButtonActionPart1]	Parent Folder: [reference]	Next Script: [removeTextFormatting]
Script Name	removeCopyrightType
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #
    Set Variable [ $fieldName; Value:Get ( ActiveFieldName ) ]
    #
    #Remove author copyright holder if there are
    #no authors.
    If [ $fieldName = "referenceNodes" and reference::knodeOther = "" and reference::knodePrimary = "" and reference::referenceNodes = "" ]
    #Perform removal for items with and without a
    #paragraph mark, as the last item in checklist
    #has no paragraph mark after it.
    If [ Filter ( reference::kcopyrightHolder ; "1" ) = 1 ]
    Show Custom Dialog [ Message: "Author is currently checked in the copyright section for this reference as a copyright holder. Remove this check?"; Default Button: “No”, Commit: “Yes”; Button 2: “Yes”, Commit: “No” ]
    If [ Get ( LastMessageChoice ) = 2 ]
    Set Field [ reference::kcopyrightHolder; Substitute ( reference::kcopyrightHolder ; "1" & "¶" ; "" ) ]
    Set Field [ reference::kcopyrightHolder; Substitute ( reference::kcopyrightHolder ; "1" ; "" ) ]
    End If
    End If
    End If
    #
    #Remove government author copyright holder if
    #there isn't a government author.
    If [ $fieldName = "governmentAuthor" and reference::governmentAuthor = "" ]
    #Perform removal for items with and without a
    #paragraph mark, as the last item in checklist
    #has no paragraph mark after it.
    If [ Filter ( reference::kcopyrightHolder ; "2" ) = 2 ]
    Show Custom Dialog [ Message: "Government author is currently checked in the copyright section for this reference as a copyright holder. Remove this check?"; Default Button: “No”, Commit: “Yes”; Button 2: “Yes”, Commit: “No” ]
    If [ Get ( LastMessageChoice ) = 2 ]
    Set Field [ reference::kcopyrightHolder; Substitute ( reference::kcopyrightHolder ; "2" & "¶" ; "" ) ]
    Set Field [ reference::kcopyrightHolder; Substitute ( reference::kcopyrightHolder ; "2" ; "" ) ]
    End If
    End If
    End If
    #
    #Remove editor copyright holder if there is not
    #an editor.
    If [ $fieldName = "compilationEditors" and reference::compilationEditors = "" ]
    #Perform removal for items with and without a
    #paragraph mark, as the last item in checklist
    #has no paragraph mark after it.
    If [ Filter ( reference::kcopyrightHolder ; "3" ) = 3 ]
    Show Custom Dialog [ Message: "Editor is currently checked in the copyright section for this reference as a copyright holder. Remove this check?"; Default Button: “No”, Commit: “Yes”; Button 2: “Yes”, Commit: “No” ]
    If [ Get ( LastMessageChoice ) = 2 ]
    Set Field [ reference::kcopyrightHolder; Substitute ( reference::kcopyrightHolder ; "3" & "¶" ; "" ) ]
    Set Field [ reference::kcopyrightHolder; Substitute ( reference::kcopyrightHolder ; "3" ; "" ) ]
    End If
    End If
    End If

Fields used in this script

    reference::knodeOther
    reference::knodePrimary
    reference::referenceNodes
    reference::kcopyrightHolder
    reference::governmentAuthor
    reference::compilationEditors

Scripts used in this script

Layouts used in this script

Tables used in this script

    reference

Table occurrences used by this script

    reference

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [removeCopyrightType]	Parent Folder: [reference]	Next Script: [removeTextFormattingAndCommas]
Script Name	removeTextFormatting
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferenceEDIT
    LearnTextWindow
    LearnTextWindow_iDevice
    LearnTextWindowStuff
    LearnTextWindowStuff_iDevice
    PrintReportEdit

Scripts that use this script

Script Definition
Script Steps

    Set Field [ TextFontRemove ( (Get ( ActiveFieldContents )) ) ]
    Set Field [ TextFormatRemove ( (Get ( ActiveFieldContents )) ) ]
    Set Field [ TextSizeRemove ( (Get ( ActiveFieldContents )) ) ]

Fields used in this script

Scripts used in this script

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [removeTextFormatting]	Parent Folder: [reference]	Next Script: [seeIfFilenameIsValid]
Script Name	removeTextFormattingAndCommas
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    checkKeyANDNodeTagNames

Script Definition
Script Steps

    #
    #
    #Stop script if running it slows down another
    #script looping thru multiple records.
    If [ $$stopTest ≠ "" ]
    Exit Script [ ]
    End If
    #
    #
    #Insure changes made to current record are
    #noticed by the script steps below.
    Commit Records/Requests
    #
    #Remove formatting.
    Set Field [ tagMenus::tag; TextFontRemove ( tagMenus::tag ) ]
    Set Field [ tagMenus::tag; TextFormatRemove ( tagMenus::tag ) ]
    Set Field [ tagMenus::tag; TextSizeRemove ( tagMenus::tag ) ]
    #
    #Remove any white spaces in front or after tag.
    Set Field [ tagMenus::tag; Trim ( tagMenus::tag ) ]
    #
    #Capture tag.
    Set Variable [ $tag; Value:tagMenus::tag ]
    #
    #Remove punctuation on key and node tag tags
    #that will stop the library from keeping track of them.
    If [ Filter ( tagMenus::tag ; "," ) = "," and $$citationMatch = "key" ]
    Show Custom Dialog [ Message: "commas prevent system from keeping track of this item and have been removed"; Default Button: “OK”, Commit: “Yes” ]
    Set Field [ tagMenus::tag; Substitute ( $tag ; "," ; "" ) ]
    Else If [ Filter ( tagMenus::tag ; ";" ) = ";" and $$citationMatch = "node" ]
    Show Custom Dialog [ Message: "semicolons prevent system from keeping track of this item and have been removed"; Default Button: “OK”, Commit: “Yes” ]
    Set Field [ tagMenus::tag; Substitute ( $tag ; ";" ; "" ) ]
    End If
    #
    #On brainstorm, copyright, path, publication
    #and publisher layouts run spell check script.
    #This is neccessary because the exit script
    #trigger, which on key and node layouts runs
    #this script, used by this formatting script,
    #and so it need to trigger the spellcheck.
    If [ $$citationmatch = "brainstorm" or $$citationmatch = "copyright" or $$citationmatch = "path" or $$citationmatch = "publication" or $$citationmatch = "publisher" ]
    Perform Script [ “CHUNK_checkForDraggedPasteChanges” ]
    End If
    #
    #If on the Tag Menus path layout ...
    If [ $$citationMatch = "path" and tagMenus::tag ≠ "" ]
    #
    If [ $$stopFilePathWarning ≠ 1 ]
    #
    #If the real checkbox is checked tell user this.
    If [ tagMenus::kfileORkTestItemCreatorNode ≠ "" ]
    Show Custom Dialog [ Message: "File path to a folder on a computer? " & ¶ & " Uncheck the 'real shelf, box, etc.' checkbox."; Default Button: “OK”, Commit: “Yes” ]
    #
    #
    #If the real checkbox is NOT checked tell user
    #this and check the folder path that they enter.
    Else
    #
    #Make sure path does NOT begin
    #with a forward slash.
    If [ Left ( tagMenus::tag ; 1 ) = "/" ]
    Set Field [ tagMenus::tag; Middle ( $tag ; 2 ; 1000 ) ]
    Set Field [ tagMenus::tagSpelling; Middle ( $tag ; 2 ; 1000 ) ]
    #
    #Capture updated tag.
    Set Variable [ $tag; Value:tagMenus::tag ]
    Show Custom Dialog [ Message: "Filepaths cannot begin forward slash / or they will not work. The beginning forward slash has been removed for you."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #Make sure path ends with a forward slash.
    If [ Right ( tagMenus::tag ; 1 ) ≠ "/" ]
    Set Field [ tagMenus::tag; $tag & "/" ]
    Set Field [ tagMenus::tagSpelling; $tag & "/" ]
    Show Custom Dialog [ Message: "All filepaths must end with forward slash / or they will not work. One has been added for you."; Default Button: “OK”, Commit: “No” ]
    End If
    #
    Show Custom Dialog [ Message: "Make sure this file Path does not end with a file Name." & ¶ & " Real location? " & ¶ & " Check the 'real shelf, box, etc.' checkbox."; Default Button: “OK”, Commit: “Yes” ]
    #
    #Now test open folder for user.
    Show Custom Dialog [ Message: "The library will now test this filepath to insure it opens this folder."; Default Button: “OK”, Commit: “Yes” ]
    #
    #Use %20 space substitutes.
    Open URL [ Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:/" ; "file:///" ) & tagMenus::tag ; " " ; "%20" ) ] [ No dialog ]
    If [ Get ( LastError ) ≠ 0 ]
    #If that failes, try spaces.
    Open URL [ Substitute ( Case ( Get ( SystemPlatform ) = - 2 ; "file:/" ; "file:///" ) & tagMenus::tag ; " " ; " " ) ] [ No dialog ]
    End If
    If [ Get (LastError) = 5 ]
    Show Custom Dialog [ Message: "This file path is not working. A valid path should look something like this >>> /users/you/documents/other folder/"; Default Button: “OK”, Commit: “Yes” ]
    End If
    End If
    End If
    End If

Fields used in this script

    tagMenus::tag
    tagMenus::kfileORkTestItemCreatorNode
    tagMenus::tagSpelling

Scripts used in this script

    CHUNK_checkForDraggedPasteChanges

Layouts used in this script

Tables used in this script

    tag

Table occurrences used by this script

    tagMenus

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [removeTextFormattingAndCommas]	Parent Folder: [reference]	Next Script: [SeeIfFileNameIsValidAndCanBeDisplayed]
Script Name	seeIfFilenameIsValid
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    SeeIfFileNameIsValidAndCanBeDisplayed

Script Definition
Script Steps

    #
    #This stop variable is set by the
    #exitAndSeeIfFileNameIsValid which is
    #triggered when the user leaves the filename
    #field. It prevents a logic loop.
    If [ $$stopFileNameCheck = 1 ]
    Exit Script [ ]
    End If
    #
    #These characters ? # / ; : prevent the
    #Library from opening files. Give the user the
    #opportunity to change their file name so it
    #will open using FileMaker's open file
    #script step.
    If [ Filter ( reference::fileName ; "?" ) = "?" or Filter ( reference::fileName ; "#" ) = "#" or Filter ( reference::fileName ; ";" ) = ";" or Filter ( reference::fileName ; "/" ) = "/" or Filter ( reference::fileName ; ":" ) = ":" ]
    Show Custom Dialog [ Message: "These characters ? # / ; : prevent the Library from opening files. Change this file's name (remove these characters) both on the harddrive and here if you want the 'file' button above to open your file."; Default Button: “OK”, Commit: “Yes” ]
    Go to Field [ reference::fileName ]
    End If

Fields used in this script

    reference::fileName

Scripts used in this script

Layouts used in this script

Tables used in this script

    reference

Table occurrences used by this script

    reference

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [seeIfFilenameIsValid]	Parent Folder: [reference]	Next Script: [setCitationMatchForAuthors]
Script Name	SeeIfFileNameIsValidAndCanBeDisplayed
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #If more than one box is checked, tell user to
    #remove check from the other box.
    If [ ValueCount ( reference::kfileLocation ) = 3 ]
    Show Custom Dialog [ Message: "Please uncheck two of the folders — main, other, x — as only one folder should be checked at a time."; Default Button: “OK”, Commit: “Yes” ]
    Else If [ ValueCount ( reference::kfileLocation ) > 1 ]
    Show Custom Dialog [ Message: "Please uncheck one of the folders — main, other, x — as only one folder should be checked at a time. (In a future update this will be fixed, so that you can only check one at a time.)"; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #If this a physical location then
    #don't run this script.
    If [ tagRefFolderPath::kfileORkTestItemCreatorNode = 1 ]
    Exit Script [ ]
    End If
    #
    #Prevents a logic loop. This script is triggered
    #when the user leaves the filename field. If
    #there is a problem detected by this script it
    #will enter and exit this same field thus
    #triggering itself = logic loop.
    If [ $$stopFilenameCheck = 1 ]
    Set Variable [ $$stopFilenameCheck ]
    Halt Script
    End If
    #
    #First see if the filename is valid.
    Perform Script [ “seeIfFilenameIsValid” ]
    #
    #Check if file has a file extension.
    If [ Left ( Right ( reference::fileName ; 4 ) ; 1 ) = "." or Left ( Right ( reference::fileName ; 5 ) ; 1 ) = "." or Left ( Right ( reference::fileName ; 6 ) ; 1 ) = "." or Left ( Right ( reference::fileName ; 7 ) ; 1 ) = "." or Left ( Right ( reference::fileName ; 8 ) ; 1 ) = "." or Left ( Right ( reference::fileName ; 9 ) ; 1 ) = "." or Left ( Right ( reference::fileName ; 10 ) ; 1 ) = "." or Left ( Right ( reference::fileName ; 11 ) ; 1 ) = "." ]
    #
    #If it is displayable, then exit the field and halt
    #this script.
    Go to Field [ ]
    #
    #The halt script step exits any field the user
    #may have entered into when clicking away
    #from this field.
    Halt Script
    #
    #If the media file is not displayable, inform the
    #user so they can convert it to a format that
    #will display.
    Else
    Show Custom Dialog [ Message: "The 'file' button can only open files that end with a period " & Quote ( "." ) & " followed by a file extension: DOCUMENT: doc, html, ods, pdf, txt, webarchive; IMAGE = bmp, gif, jpeg, jpg, png, psd, sgi, tga, tif, tiff; MOVIE = mp4, m4v."; Default Button: “Fix”, Commit: “Yes”; Button 2: “Don't Fix”, Commit: “No” ]
    #
    #If they decide to fix the file, then stay in the
    #field and wait for the new file type extension
    #to be entered.
    If [ Get (LastMessageChoice) = 1 ]
    Set Variable [ $$stopFilenameCheck; Value:1 ]
    Go to Field [ ]
    Go to Field [ reference::fileName ]
    #
    #If the user decides not to fix the file format,
    #then exit the field and halt this script.
    Else
    Go to Field [ ]
    #
    #The halt script step exits any field the user
    #may have entered into when clicking away
    #from this field.
    Halt Script
    End If
    End If
    #

Fields used in this script

    reference::kfileLocation
    tagRefFolderPath::kfileORkTestItemCreatorNode
    reference::fileName

Scripts used in this script

    seeIfFilenameIsValid

Layouts used in this script

Tables used in this script

    reference
    tag

Table occurrences used by this script

    reference
    tagRefFolderPath

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [SeeIfFileNameIsValidAndCanBeDisplayed]	Parent Folder: [reference]	Next Script: [showCitation]
Script Name	setCitationMatchForAuthors
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    Set Variable [ $$citationMatch; Value:reference::referenceNodes ]

Fields used in this script

    reference::referenceNodes

Scripts used in this script

Layouts used in this script

Tables used in this script

    reference

Table occurrences used by this script

    reference

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [setCitationMatchForAuthors]	Parent Folder: [reference]	Next Script: [showTagLink1]
Script Name	showCitation
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #Capture the key to unlock the record it belongs to.
    Set Variable [ $key; Value:reference::_Lreference ]
    #
    #Select the correct window and then change its
    #name if neccessary to match the table the
    #records are coming from.
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    End If
    Set Variable [ $$cited; Value:reference::_Lreference ]
    Set Variable [ $$citeLayout; Value:Get (LayoutName) ]
    Set Window Title [ Current Window; New Title: "References" ]
    Go to Layout [ “Reference” (reference) ]
    #
    #Prevent record loading script during loops to
    #find wanted record, which would slow down system.
    Set Variable [ $$stoploadCitation; Value:1 ]
    #
    #Now loop thru all the records until the record
    #that fits the key is found.
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ reference::_Lreference = $key ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Allow the record load script to run and run it.
    Set Variable [ $$stoploadCitation ]
    Perform Script [ “loadLearnOrRefMainRecord” ]
    #
    #Return to Tag Menus window and conditionally
    #format any items that may be linked to record
    #in the other window.
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window

Fields used in this script

    reference::_Lreference

Scripts used in this script

    loadLearnOrRefMainRecord

Layouts used in this script

    Reference

Tables used in this script

    reference

Table occurrences used by this script

    reference

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [showCitation]	Parent Folder: [reference]	Next Script: [showTagLink2]
Script Name	showTagLink1
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultCopyright
    CopyrightVIEW
    CopyrightEDIT
    defaultNode3
    defaultNode4
    ReferenceMenuCopyright
    ReferenceMenu2keywordOrNode4
    ReferenceMenu2SkeywordOrNode4
    ReferenceMenu2keywordOrNode5
    ReferenceMenu2SkeywordOrNode5
    addMenu1
    addMenuNodeKeyword
    addMenu2
    addMenuTestItem
    ltagNK4
    ltagNK5
    testMenuTestItemMORE

Scripts that use this script

Script Definition
Script Steps

    #
    #Capture needed link info.
    Set Variable [ $$tagMenusRealCheckbox; Value:tagFileLocation1::kfileORkTestItemCreatorNode ]
    Set Variable [ $$tagMenusFilePath; Value:tagFileLocation1::tag ]
    Set Variable [ $$tagMenusFileName; Value:refTitle1::fileName ]
    Set Variable [ $$tagMenusFileLocation; Value:refTitle1::kfileLocation ]
    Set Variable [ $$tagMenusURL; Value:refTitle1::URL ]
    Set Variable [ $$tagMenusISBN; Value:refTitle1::ISBN ]
    Set Variable [ $$tagMenusISSN; Value:refTitle1::ISSN ]
    Set Variable [ $$tagMenusDOI; Value:refTitle1::DOI ]
    #
    #Open link for user.
    Perform Script [ “showReferencedFileFolder” ]
    #
    #Clear link variables.
    Set Variable [ $$tagMenusRealCheckbox ]
    Set Variable [ $$tagMenusFilePath ]
    Set Variable [ $$tagMenusFileName ]
    Set Variable [ $$tagMenusFileLocation ]
    Set Variable [ $$tagMenusURL ]
    Set Variable [ $$tagMenusISBN ]
    Set Variable [ $$tagMenusISSN ]
    Set Variable [ $$tagMenusDOI ]
    #

Fields used in this script

    tagFileLocation1::kfileORkTestItemCreatorNode
    tagFileLocation1::tag
    refTitle1::fileName
    refTitle1::kfileLocation
    refTitle1::URL
    refTitle1::ISBN
    refTitle1::ISSN
    refTitle1::DOI

Scripts used in this script

    showReferencedFileFolder

Layouts used in this script

Tables used in this script

    reference
    tag

Table occurrences used by this script

    refTitle1
    tagFileLocation1

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [showTagLink1]	Parent Folder: [reference]	Next Script: [showTagLink3]
Script Name	showTagLink2
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultNode3
    defaultNode4
    ReferenceMenu2keywordOrNode4
    ReferenceMenu2SkeywordOrNode4
    ReferenceMenu2keywordOrNode5
    ReferenceMenu2SkeywordOrNode5
    addMenuNodeKeyword
    addMenu2
    addMenuTestItem
    ltagNK4
    ltagNK5
    testMenuTestItemMORE

Scripts that use this script

Script Definition
Script Steps

    #
    #Capture needed link info.
    Set Variable [ $$tagMenusRealCheckbox; Value:tagFileLocation2::kfileORkTestItemCreatorNode ]
    Set Variable [ $$tagMenusFilePath; Value:tagFileLocation2::tag ]
    Set Variable [ $$tagMenusFileName; Value:refTitle2::fileName ]
    Set Variable [ $$tagMenusFileLocation; Value:refTitle2::kfileLocation ]
    Set Variable [ $$tagMenusURL; Value:refTitle2::URL ]
    Set Variable [ $$tagMenusISBN; Value:refTitle2::ISBN ]
    Set Variable [ $$tagMenusISSN; Value:refTitle2::ISSN ]
    Set Variable [ $$tagMenusDOI; Value:refTitle2::DOI ]
    #
    #Open link for user.
    Perform Script [ “showReferencedFileFolder” ]
    #
    #Clear link variables.
    Set Variable [ $$tagMenusRealCheckbox ]
    Set Variable [ $$tagMenusFilePath ]
    Set Variable [ $$tagMenusFileName ]
    Set Variable [ $$tagMenusFileLocation ]
    Set Variable [ $$tagMenusURL ]
    Set Variable [ $$tagMenusISBN ]
    Set Variable [ $$tagMenusISSN ]
    Set Variable [ $$tagMenusDOI ]
    #

Fields used in this script

    tagFileLocation2::kfileORkTestItemCreatorNode
    tagFileLocation2::tag
    refTitle2::fileName
    refTitle2::kfileLocation
    refTitle2::URL
    refTitle2::ISBN
    refTitle2::ISSN
    refTitle2::DOI

Scripts used in this script

    showReferencedFileFolder

Layouts used in this script

Tables used in this script

    reference
    tag

Table occurrences used by this script

    refTitle2
    tagFileLocation2

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [showTagLink2]	Parent Folder: [reference]	Next Script: [showTagsReferenceForLink1]
Script Name	showTagLink3
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultNode3
    defaultNode4
    ReferenceMenu2keywordOrNode4
    ReferenceMenu2SkeywordOrNode4
    ReferenceMenu2keywordOrNode5
    ReferenceMenu2SkeywordOrNode5
    addMenuNodeKeyword
    addMenu2
    addMenuTestItem
    ltagNK4
    ltagNK5
    testMenuTestItemMORE

Scripts that use this script

Script Definition
Script Steps

    #
    #Capture needed link info.
    Set Variable [ $$tagMenusRealCheckbox; Value:tagFileLocation3::kfileORkTestItemCreatorNode ]
    Set Variable [ $$tagMenusFilePath; Value:tagFileLocation3::tag ]
    Set Variable [ $$tagMenusFileName; Value:refTitle3::fileName ]
    Set Variable [ $$tagMenusFileLocation; Value:refTitle3::kfileLocation ]
    Set Variable [ $$tagMenusURL; Value:refTitle3::URL ]
    Set Variable [ $$tagMenusISBN; Value:refTitle3::ISBN ]
    Set Variable [ $$tagMenusISSN; Value:refTitle3::ISSN ]
    Set Variable [ $$tagMenusDOI; Value:refTitle3::DOI ]
    #
    #Open link for user.
    Perform Script [ “showReferencedFileFolder” ]
    #
    #Clear link variables.
    Set Variable [ $$tagMenusRealCheckbox ]
    Set Variable [ $$tagMenusFilePath ]
    Set Variable [ $$tagMenusFileName ]
    Set Variable [ $$tagMenusFileLocation ]
    Set Variable [ $$tagMenusURL ]
    Set Variable [ $$tagMenusISBN ]
    Set Variable [ $$tagMenusISSN ]
    Set Variable [ $$tagMenusDOI ]
    #

Fields used in this script

    tagFileLocation3::kfileORkTestItemCreatorNode
    tagFileLocation3::tag
    refTitle3::fileName
    refTitle3::kfileLocation
    refTitle3::URL
    refTitle3::ISBN
    refTitle3::ISSN
    refTitle3::DOI

Scripts used in this script

    showReferencedFileFolder

Layouts used in this script

Tables used in this script

    reference
    tag

Table occurrences used by this script

    refTitle3
    tagFileLocation3

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [showTagLink3]	Parent Folder: [reference]	Next Script: [showTagsReferenceForLink2]
Script Name	showTagsReferenceForLink1
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    addMenu1
    addMenuNodeKeyword
    addMenu2
    addMenuTestItem

Scripts that use this script

Script Definition
Script Steps

    #
    #If user is not in add mode then inform user they
    #must be before the database will show them reference
    #data. The reason for this is because the layout
    #in the reference or learn window changes to the
    #add tag from these windows to the Tag Menu
    #item selected. So instead of having the system
    #automatically go into add mode, the user must
    #decide they want to do this and thus be expecting
    #a change in the layouts. Otherwise this change
    #could confuse a user. So at the cost of minor
    #inconvience I have choose not to have the system
    #guess the user wants to go into add mode and is
    #expecting the system to do that when they click
    #one of these numbered buttons on the showEvenMore
    #layouts.
    If [ $$add = "" ]
    Show Custom Dialog [ Message: "Click the 'add' button above and then click this button to see citation for this item. "; Default Button: “OK”, Commit: “No” ]
    Exit Script [ ]
    End If
    #
    #If the field is blank then stop the script.
    #No poin in looking for a record where there isn't one.
    If [ tagMenus::Ktitle1 = "" ]
    Exit Script [ ]
    End If
    #
    #Capture the key to unlock the record it belongs to.
    Set Variable [ $key; Value:tagMenus::Ktitle1 ]
    #
    #Select the reference window.
    Select Window [ Name: "References"; Current file ]
    #
    #Loop to selected reference if not selected.
    If [ reference::_Lreference ≠ $key ]
    #
    #Prevent record loading script during loops to
    #find wanted record, which would slow down system.
    Set Variable [ $$stoploadCitation; Value:1 ]
    #
    #Now loop thru all the records until the record
    #that fits the key is found.
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ reference::_Lreference = $key ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Allow the record load script to run and run it.
    Set Variable [ $$stoploadCitation ]
    Perform Script [ “loadLearnOrRefMainRecord” ]
    End If
    #
    #Select Tag Menus window and conditionally
    #format any items that may be linked to record
    #in the other window.
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    #
    #Show user reference record selected.
    Select Window [ Name: "References"; Current file ]
    #

Fields used in this script

    tagMenus::Ktitle1
    reference::_Lreference

Scripts used in this script

    loadLearnOrRefMainRecord

Layouts used in this script

Tables used in this script

    reference
    tag

Table occurrences used by this script

    reference
    tagMenus

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [showTagsReferenceForLink1]	Parent Folder: [reference]	Next Script: [showTagsReferenceForLink3]
Script Name	showTagsReferenceForLink2
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    addMenuNodeKeyword
    addMenu2
    addMenuTestItem

Scripts that use this script

Script Definition
Script Steps

    #
    #If user is not in add mode then inform user they
    #must be before the database will show them reference
    #data. The reason for this is because the layout
    #in the reference or learn window changes to the
    #add tag from these windows to the Tag Menu
    #item selected. So instead of having the system
    #automatically go into add mode, the user must
    #decide they want to do this and thus be expecting
    #a change in the layouts. Otherwise this change
    #could confuse a user. So at the cost of minor
    #inconvience I have choose not to have the system
    #guess the user wants to go into add mode and is
    #expecting the system to do that when they click
    #one of these numbered buttons on the showEvenMore
    #layouts.
    If [ $$add = "" ]
    Show Custom Dialog [ Message: "Click the 'add' button above and then click this button to see citation for this item. "; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #If the field is blank then stop the script.
    #No poin in looking for a record where there isn't one.
    If [ tagMenus::Ktitle2 = "" ]
    Exit Script [ ]
    End If
    #
    #Capture the key to unlock the record it belongs to.
    Set Variable [ $key; Value:tagMenus::Ktitle2 ]
    #
    #Select the reference window.
    Select Window [ Name: "References"; Current file ]
    #
    #Loop to selected reference if not selected.
    If [ reference::_Lreference ≠ $key ]
    #
    #Prevent record loading script during loops to
    #find wanted record, which would slow down system.
    Set Variable [ $$stoploadCitation; Value:1 ]
    #
    #Now loop thru all the records until the record
    #that fits the key is found.
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ reference::_Lreference = $key ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Allow the record load script to run and run it.
    Set Variable [ $$stoploadCitation ]
    Perform Script [ “loadLearnOrRefMainRecord” ]
    End If
    #
    #Select Tag Menus window and conditionally
    #format any items that may be linked to record
    #in the other window.
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    #
    #Show user reference record selected.
    Select Window [ Name: "References"; Current file ]
    #

Fields used in this script

    tagMenus::Ktitle2
    reference::_Lreference

Scripts used in this script

    loadLearnOrRefMainRecord

Layouts used in this script

Tables used in this script

    reference
    tag

Table occurrences used by this script

    reference
    tagMenus

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [showTagsReferenceForLink2]	Parent Folder: [reference]	Next Script: [sortEditedStuffModeReference]
Script Name	showTagsReferenceForLink3
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    addMenuNodeKeyword
    addMenu2
    addMenuTestItem

Scripts that use this script

Script Definition
Script Steps

    #
    #If user is not in add mode then inform user they
    #must be before the database will show them reference
    #data. The reason for this is because the layout
    #in the reference or learn window changes to the
    #add tag from these windows to the Tag Menu
    #item selected. So instead of having the system
    #automatically go into add mode, the user must
    #decide they want to do this and thus be expecting
    #a change in the layouts. Otherwise this change
    #could confuse a user. So at the cost of minor
    #inconvience I have choose not to have the system
    #guess the user wants to go into add mode and is
    #expecting the system to do that when they click
    #one of these numbered buttons on the showEvenMore
    #layouts.
    If [ $$add = "" ]
    Show Custom Dialog [ Message: "Click the 'add' button above and then click this button to see citation for this item. "; Default Button: “OK”, Commit: “No” ]
    Exit Script [ ]
    End If
    #
    #If the field is blank then stop the script.
    #No poin in looking for a record where there isn't one.
    If [ tagMenus::Ktitle3 = "" ]
    Exit Script [ ]
    End If
    #
    #Capture the key to unlock the record it belongs to.
    Set Variable [ $key; Value:tagMenus::Ktitle3 ]
    #
    #Select the reference window.
    Select Window [ Name: "References"; Current file ]
    #
    #Loop to selected reference if not selected.
    If [ reference::_Lreference ≠ $key ]
    #
    #Prevent record loading script during loops to
    #find wanted record, which would slow down system.
    Set Variable [ $$stoploadCitation; Value:1 ]
    #
    #Now loop thru all the records until the record
    #that fits the key is found.
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ reference::_Lreference = $key ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Allow the record load script to run and run it.
    Set Variable [ $$stoploadCitation ]
    Perform Script [ “loadLearnOrRefMainRecord” ]
    End If
    #
    #Select Tag Menus window and conditionally
    #format any items that may be linked to record
    #in the other window.
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    #
    #Show user reference record selected.
    Select Window [ Name: "References"; Current file ]
    #

Fields used in this script

    tagMenus::Ktitle3
    reference::_Lreference

Scripts used in this script

    loadLearnOrRefMainRecord

Layouts used in this script

Tables used in this script

    reference
    tag

Table occurrences used by this script

    reference
    tagMenus

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [showTagsReferenceForLink3]	Parent Folder: [reference]	Next Script: [sortRefByAuthor]
Script Name	sortEditedStuffModeReference
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #If the user cannot change the order number,
    #then do not re-sort the window.
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    If [ refCreatorNode::orderOrLock ≠ "" ]
    Exit Script [ ]
    End If
    End If
    #
    #If user elected to delete the order number
    #then delete it.
    If [ reference::publicationYearOrStuffOrderNumber = "delete number" ]
    Set Field [ reference::publicationYearOrStuffOrderNumber; "" ]
    End If
    #
    #Resort and go to edited record.
    Scroll Window [ End ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagKeywordPrimary::orderOrLock; based on value list: “testPulldownListANDsortOrderList” tagKeywordPrimary::tag; ascending reference::publicationYearOrStuffOrderNumber; based on value list: “testPulldownListANDsortOrderList” reference::Title; ascending reference::thoughtsNotesEtc; ascending ] [ Restore; No dialog ]
    #

Fields used in this script

    TEMP::InventoryLibraryYN
    refCreatorNode::orderOrLock
    reference::publicationYearOrStuffOrderNumber
    tagKeywordPrimary::orderOrLock
    tagKeywordPrimary::tag
    reference::Title
    reference::thoughtsNotesEtc

Scripts used in this script

Layouts used in this script

Tables used in this script

    TEMP
    reference
    tag

Table occurrences used by this script

    TEMP
    refCreatorNode
    reference
    tagKeywordPrimary

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [sortEditedStuffModeReference]	Parent Folder: [reference]	Next Script: [sortRefByDate]
Script Name	sortRefByAuthor
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    Reference
    ReferenceAddToTag
    ReferenceAddToCopyright
    TestInfoReference

Scripts that use this script

Script Definition
Script Steps

    #
    #
    Sort Records [ Keep records in sorted order; Specified Sort Order: reference::sortByAuthor; ascending reference::referenceShort; ascending ] [ Restore; No dialog ]
    Set Variable [ $$referenceSort; Value:"author" ]

Fields used in this script

    reference::sortByAuthor
    reference::referenceShort

Scripts used in this script

Layouts used in this script

Tables used in this script

    reference

Table occurrences used by this script

    reference

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [sortRefByAuthor]	Parent Folder: [reference]	Next Script: [sortRefByPub]
Script Name	sortRefByDate
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    Reference
    ReferenceAddToTag
    ReferenceAddToCopyright
    TestInfoReference

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #
    Show Custom Dialog [ Message: "Sort by date created or modified or published?"; Default Button: “created”, Commit: “Yes”; Button 2: “modified”, Commit: “No”; Button 3: “published”, Commit: “No” ]
    #
    If [ Get ( LastMessageChoice ) = 1 ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: reference::createDate; descending reference::referenceShort; ascending ] [ Restore; No dialog ]
    Set Variable [ $$referenceSort; Value:"dateCreated" ]
    Else If [ Get ( LastMessageChoice ) = 2 ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: reference::modifyDate; descending reference::referenceShort; ascending ] [ Restore; No dialog ]
    Set Variable [ $$referenceSort; Value:"dateModified" ]
    Else If [ Get ( LastMessageChoice ) = 3 ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: reference::sortByDatePublished; ascending reference::referenceShort; ascending ] [ Restore; No dialog ]
    Set Variable [ $$referenceSort; Value:"datePublished" ]
    End If
    #
    #

Fields used in this script

    reference::createDate
    reference::referenceShort
    reference::modifyDate
    reference::sortByDatePublished

Scripts used in this script

Layouts used in this script

Tables used in this script

    reference

Table occurrences used by this script

    reference

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [sortRefByDate]	Parent Folder: [reference]	Next Script: [sortRefBySubject]
Script Name	sortRefByPub
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    Reference
    ReferenceAddToTag
    ReferenceAddToCopyright
    TestInfoReference

Scripts that use this script

Script Definition
Script Steps

    #
    #Give user the option of either sorting
    #by publication or by publisher.
    Show Custom Dialog [ Message: "Sort by publication or publisher?"; Default Button: “publisher”, Commit: “Yes”; Button 2: “publication”, Commit: “No” ]
    #
    If [ Get ( LastMessageChoice ) = 1 ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagPublisher::tag; ascending reference::referenceShort; ascending ] [ Restore; No dialog ]
    Set Variable [ $$referenceSort; Value:"publisher" ]
    Else If [ Get ( LastMessageChoice ) = 2 ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: reference::sortByPublication; ascending reference::referenceShort; ascending ] [ Restore; No dialog ]
    Set Variable [ $$referenceSort; Value:"publication" ]
    End If
    #

Fields used in this script

    tagPublisher::tag
    reference::referenceShort
    reference::sortByPublication

Scripts used in this script

Layouts used in this script

Tables used in this script

    reference
    tag

Table occurrences used by this script

    reference
    tagPublisher

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [sortRefByPub]	Parent Folder: [reference]	Next Script: [sortRefByTitle]
Script Name	sortRefBySubject
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    Reference
    ReferenceAddToTag
    ReferenceAddToCopyright
    TestInfoReference

Scripts that use this script

    CHUNK_findLearnRecordsReferences

Script Definition
Script Steps

    #
    #
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagKeywordPrimary::orderOrLock; based on value list: “order Pulldown List” tagKeywordPrimary::tag; ascending reference::referenceForReferenceWindow; ascending ] [ Restore; No dialog ]
    Set Variable [ $$referenceSort ]

Fields used in this script

    tagKeywordPrimary::orderOrLock
    tagKeywordPrimary::tag
    reference::referenceForReferenceWindow

Scripts used in this script

Layouts used in this script

Tables used in this script

    reference
    tag

Table occurrences used by this script

    reference
    tagKeywordPrimary

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [sortRefBySubject]	Parent Folder: [reference]	Next Script: [viewReference]
Script Name	sortRefByTitle
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    Reference
    ReferenceAddToTag
    ReferenceAddToCopyright
    TestInfoReference

Scripts that use this script

Script Definition
Script Steps

    #
    #
    Sort Records [ Keep records in sorted order; Specified Sort Order: reference::sortByTitle; ascending ] [ Restore; No dialog ]
    Set Variable [ $$referenceSort; Value:"title" ]

Fields used in this script

    reference::sortByTitle

Scripts used in this script

Layouts used in this script

Tables used in this script

    reference

Table occurrences used by this script

    reference

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [sortRefByTitle]	Parent Folder: [reference]
Script Name	viewReference
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferenceEDIT
    ReferenceEDIT Copy

Scripts that use this script

Script Definition
Script Steps

    #
    #Exit RefDump field if user is in it.
    Go to Field [ ]
    #
    #Get current window's width so view window
    #can be moved the right of it.
    Set Variable [ $width; Value:Get ( WindowWidth ) ]
    #
    #Close this window just in case a copy of it
    #is open, and then open a new one.
    Close Window [ Name: "View Reference"; Current file ]
    New Window [ Name: "View Reference"; Height: 431; Width: 331; Left: Case ( Get ( ScreenWidth ) > $width + 331 ; $width ; Get ( ScreenWidth ) - 331 ); Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    #
    #Show just the record of interest.
    Go to Layout [ “ReferenceViewEDIT” (reference) ]
    Set Zoom Level [ 100%; Camera: Back; Resolution: Full ]
    #
    // #Prevent the user doing anything else until
    // #they leave this window.
    // Pause/Resume Script [ Indefinitely ]
    #

Fields used in this script

Scripts used in this script

Layouts used in this script

    ReferenceViewEDIT

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


probablyNotInUse

sharedLayoutScripts
	Parent Folder: [sharedLayoutScripts]	Next Script: [backToLearnOrDefaultSetup]
Script Name	backFromTemplateEditor
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    setupTestSection
    setupTestSubsection
    setupTestItem
    setupTestItemLOCKED

Scripts that use this script

Script Definition
Script Steps

    #
    // #If the optional 'back' button is clicked in the
    // #Tag Menus window it will go to the
    // #default Setup windows, then exit the script.
    // #This optional 'back' button is visible only
    // #when the user goes clicks the edit/new
    // #button in the Tags Menu window, so when it
    // #is clicked it will return the user to this same
    // #Tags Menu window layout.
    // If [ Left ( $$module ; 7 ) = "default" and Get ( WindowName ) = "Tag Menus" or $$module = "" and Get ( WindowName ) = "Tag Menus" ]
    // Exit Script [ ]
    // End If
    #
    #
    #Admin tasks.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    #
    #Clear main record node lock variable.
    Set Variable [ $$lockedMainSubsectionRecord ]
    #
    #Insure that all locked fields are revereted back if changed.
    Set Variable [ $$goBackToSetup; Value:1 ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Perform Script [ “checkTestSectionSubsectionAndItemRecordSpellings” ]
    Select Window [ Name: "Test Templates"; Current file ]
    Perform Script [ “checkTestSectionSubsectionAndItemRecordSpellings” ]
    Set Variable [ $$goBackToSetup ]
    #
    #Return to Learn module.
    If [ Left ( $$module ; 1 ) = "l" ]
    Set Variable [ $$citationMatch; Value:"test" ]
    Set Variable [ $$testSubsection ]
    Perform Script [ “backToLearnOrDefaultSetup” ]
    Exit Script [ ]
    #
    #
    #Return to Setup.
    Else If [ Left ( $$module ; 1 ) = "d" ]
    #
    #For returning to the test setup module, find
    #and delete all temp records that may have been
    #created while setting up or deleting tests and
    #then create one new temp record to show the user
    #the default selections from the global fields whose
    #contents cannot be deleted even when all records
    #containing them are deleted. With a new record
    #any info in their global fields will go into a
    #newly created record.
    Select Window [ Name: "Tag Menus"; Current file ]
    Go to Layout [ “defaultsAll” (tempSetup) ]
    Show All Records
    Delete All Records [ No dialog ]
    New Record/Request
    Go to Field [ ]
    #
    #Return to test setup layout on the Tag Menus
    #window, and clear the global fields needed for
    #creating and deleting tests in the test setup module.
    Select Window [ Name: "Test Templates"; Current file ]
    Set Window Title [ Current Window; New Title: "Setup" ]
    Go to Layout [ “defaultTest” (testSectionCreatedFromATemplate) ]
    #
    Set Field [ TEMP::ktestSubsection; "" ]
    Set Field [ TEMP::ktestItemSubsection; "" ]
    Set Field [ TEMP::ktestItemSubsectionOLD; "" ]
    Set Field [ TEMP::ktestSubsectionName; "" ]
    #
    Set Variable [ $$testSubsection ]
    #
    #Refind all test sections and sort them.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    Show All Records
    #
    #Sort
    Sort Records [ Keep records in sorted order; Specified Sort Order: testSubjectName::tag; ascending testSectionCreatedFromATemplate::reportNumber; descending testSectionCreatedFromATemplate::order; based on value list: “order Pulldown List” testSectionCreatedFromATemplate::name; ascending ] [ Restore; No dialog ]
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    #
    Exit Script [ ]
    End If
    #
    #
    #Return to Report or Test sections.
    Perform Script [ “returnToSetup” ]
    #

Fields used in this script

    TEMP::ktestSubsection
    TEMP::ktestItemSubsection
    TEMP::ktestItemSubsectionOLD
    TEMP::ktestSubsectionName
    testSubjectName::tag
    testSectionCreatedFromATemplate::reportNumber
    testSectionCreatedFromATemplate::order
    testSectionCreatedFromATemplate::name

Scripts used in this script

    checkTestSectionSubsectionAndItemRecordSpellings
    backToLearnOrDefaultSetup
    returnToSetup

Layouts used in this script

    defaultsAll
    defaultTest

Tables used in this script

    TEMP
    tag
    testSectionCreatedFromATemplate

Table occurrences used by this script

    TEMP
    testSectionCreatedFromATemplate
    testSubjectName

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [backFromTemplateEditor]	Parent Folder: [sharedLayoutScripts]	Next Script: [backtoSetup]
Script Name	backToLearnOrDefaultSetup
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    Reference
    ReferenceStuff

Scripts that use this script

    backFromTemplateEditor

Script Definition
Script Steps

    #
    #Admin tasks.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    Set Variable [ $$referenceRecordOne ]
    Set Variable [ $$referenceSort ]
    Set Variable [ $$findMode ]
    #
    #
    #If in stuff library mode, run these next steps to
    #replace any dragged changes to stuff
    #reference/location records. This is where the
    #user did not enter a record's field to change
    #them, but instead just dragged (maybe
    #accidentally) text into fields. If so, the script
    #that updates the backup field or, when the
    #record is locked, replaces changes with the
    #backup data, is not triggered, SO this next bit
    #of script takes care of dragged changes.
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    #
    #
    Set Variable [ $$stoploadCitation; Value:1 ]
    Go to Layout [ “tableReference” (reference) ]
    Set Variable [ $$stoploadCitation ]
    #
    #
    Go to Record/Request/Page [ First ]
    Loop
    #
    #
    #If the record is unlocked, then save any
    #changes in the backup data fields.
    If [ refCreatorNode::orderOrLock = "" ]
    #
    #Only change records that have been changed.
    #Changes result in the record modify date being
    #reset, and this should only be done when the
    #user modifies the record.
    If [ reference::Title[1] ≠ reference::Title[2] ]
    Set Field [ reference::Title[2]; reference::Title[1] ]
    End If
    If [ reference::thoughtsNotesEtc[1] ≠ reference::thoughtsNotesEtc[2] ]
    Set Field [ reference::thoughtsNotesEtc[2]; reference::thoughtsNotesEtc[1] ]
    End If
    If [ reference::publicationYearOrStuffOrderNumber[1] ≠ reference::publicationYearOrStuffOrderNumber[2] ]
    #
    #Insure that only 3 digit numbers are
    #saved in this field.
    Set Variable [ $threeDigitNumber; Value:Right ( GetAsNumber (reference::publicationYearOrStuffOrderNumber[1]) ; 3 ) ]
    Set Field [ reference::publicationYearOrStuffOrderNumber[2]; $threeDigitNumber ]
    Set Field [ reference::publicationYearOrStuffOrderNumber; $threeDigitNumber ]
    End If
    #
    #
    #If the record is locked, then replace any
    #changes with the saved back up data.
    Else If [ refCreatorNode::orderOrLock ≠ "" ]
    #
    #
    #Only change records that have been changed.
    #Changes result in the record modify date being
    #reset, and this should only be done when the
    #user modifies the record.
    If [ reference::Title[1] ≠ reference::Title[2] ]
    Set Field [ reference::Title; reference::Title[2] ]
    End If
    If [ reference::thoughtsNotesEtc[1] ≠ reference::thoughtsNotesEtc[2] ]
    Set Field [ reference::thoughtsNotesEtc; reference::thoughtsNotesEtc[2] ]
    End If
    If [ reference::publicationYearOrStuffOrderNumber[1] ≠ reference::publicationYearOrStuffOrderNumber[2] ]
    Set Field [ reference::publicationYearOrStuffOrderNumber; reference::publicationYearOrStuffOrderNumber[2] ]
    End If
    #
    End If
    #
    #
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #
    End If
    #
    #
    #Clear main record node lock variable.
    Set Variable [ $$lockedMainRefRecord ]
    #
    #Set in copyAndpastTags script.
    Set Variable [ $$copyAndpastTagsRECORD ]
    #
    If [ Left ( $$defaultTagLayout ; 1 ) = "d" ]
    #
    #If user is in tag field and has changed spelling
    #exit this tag record, otherwise current reference record
    #will get deleted by the spelling check script.
    Select Window [ Name: "Tag Menus"; Current file ]
    Go to Field [ ]
    #
    #Check for any dragged changes to tag spellings.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Go to Layout [ “ltagSCRIPTloops” (tagMenus) ]
    Show All Records
    Set Variable [ $$stopLoadTagRecord ]
    Perform Script [ “CHUNK_checkForDraggedPasteChanges” ]
    #
    #Go to default tags layout
    #and load up defaults.
    Perform Script [ “defaultsAll” ]
    Set Variable [ $$stopAddTagToCitation ]
    Set Variable [ $$defaultRecordNumber ]
    Set Variable [ $$defaultTagLayout ]
    Set Variable [ $$citationMatch ]
    #
    #Change main window to Setup.
    Select Window [ Name: "References"; Current file ]
    Select Window [ Name: "Learn"; Current file ]
    Set Window Title [ Current Window; New Title: "Setup" ]
    Move/Resize Window [ Current Window; Height: Get (ScreenHeight); Width: Get (ScreenWidth) / 2; Top: 0; Left: 0 ]
    Go to Layout [ “defaultSetup” (librarySetupReferenceMain) ]
    #
    #Clear variables that where set
    #in other modules.
    Go to Field [ ]
    Set Variable [ $$citationitem; Value:tempSetup::klibrary ]
    Set Variable [ $$stopAddTagToCitation ]
    Set Variable [ $$defaultRecordNumber ]
    Set Variable [ $$defaultTagLayout ]
    Set Variable [ $$node ]
    Set Variable [ $$tagBrainstorm ]
    Set Variable [ $$tagTest ]
    Set Variable [ $$citationRecord ]
    Set Variable [ $$primaryNode ]
    Set Variable [ $$medium ]
    Set Variable [ $$copyright ]
    Set Variable [ $$Path ]
    Set Variable [ $$cite ]
    Set Variable [ $$ref ]
    Set Variable [ $$PrimaryKey ]
    Set Variable [ $$Key ]
    Set Variable [ $$OtherKey ]
    Set Variable [ $$RecordID ]
    #
    Set Field [ TEMP::ktestSubsection; "" ]
    #
    Set Variable [ $$findMode ]
    Set Variable [ $$firstFind ]
    Set Variable [ $$firstFindOther ]
    Set Variable [ $$found ]
    Set Variable [ $$foundOther ]
    Set Variable [ $$findLayout ]
    Exit Script [ ]
    End If
    #
    #Go to testlearn layout and loop back to record.
    Set Variable [ $$stoploadCitation; Value:1 ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Set Window Title [ Current Window; New Title: "Learn" ]
    #
    If [ TEMP::InventoryLibraryYN = "" ]
    Go to Layout [ “learn2” (testlearn) ]
    Else
    Go to Layout [ “learnStuff2” (testlearn) ]
    End If
    #
    Enter Find Mode [ ]
    Set Field [ testlearn::filterFind; "main" & ¶ ]
    Perform Find [ ]
    #
    If [ TEMP::InventoryLibraryYN = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::date; descending testlearn::timestamp; descending ] [ Restore; No dialog ]
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::orderInventoryGroupNumber; ascending testlearn::note; ascending ] [ Restore; No dialog ]
    End If
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ $$LearnEdit = testlearn::_Ltestlearn ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Show user layout that they selected.
    If [ tempSetup::layoutLmain = "" ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Go to Layout [ “learn2” (testlearn) ]
    Else
    Go to Layout [ “learnStuff3” (testlearn) ]
    End If
    Set Field [ TEMP::layoutLmain; "more" & Get (LayoutName) ]
    Else If [ tempSetup::layoutLmain ≠ "" ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Go to Layout [ "Learn" & Right ( tempSetup::layoutLmain ; 1 ) ]
    Else
    Go to Layout [ "LearnStuff" & Right ( tempSetup::layoutLmain ; 1 ) ]
    End If
    End If
    #
    Set Variable [ $$stoploadCitation ]
    #
    #Go to Learn tag menu layout and loop back to record.
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    #If user is in tag field and has changed spelling
    #exit this tag record, otherwise current reference record
    #will get deleted by the spelling check script.
    Select Window [ Name: "Tag Menus"; Current file ]
    Go to Field [ ]
    #
    #Check for any dragged changes to tag spellings.
    Go to Field [ ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Go to Layout [ “ltagSCRIPTloops” (tagMenus) ]
    Show All Records
    Set Variable [ $$stopLoadTagRecord ]
    #
    #Prevent halting to loadTagRecord script.
    Set Variable [ $$doNotHaltOtherScripts; Value:1 ]
    #
    Perform Script [ “CHUNK_checkForDraggedPasteChanges” ]
    #
    Go to Layout [ $$learnTagLayout ]
    Set Variable [ $$learnTagLayout ]
    Set Variable [ $$stopLoadTagRecord ]
    If [ $$module = "ref" ]
    Perform Script [ “menuReference” ]
    Else If [ $$module = "learnTest" or $$module = "learnSTest" ]
    Perform Script [ “menuTest” ]
    End If
    #
    #Turn of stop halt variable.
    Set Variable [ $$doNotHaltOtherScripts ]
    #
    Select Window [ Name: "Learn"; Current file ]
    #
    #Perform Load Citation script to restore conditional
    #formatting.
    Perform Script [ “loadLearnOrRefMainRecord” ]
    #
    #Finish up back script on the Tag Menus
    #if this is where the user started from by
    #clicking an edit/new button.
    If [ $$module = "ref" or $$module = "learnTest" ]
    Select Window [ Name: "Tag Menus"; Current file ]
    End If
    #
    #

Fields used in this script

    TEMP::InventoryLibraryYN
    refCreatorNode::orderOrLock
    reference::Title
    reference::thoughtsNotesEtc
    reference::publicationYearOrStuffOrderNumber
    tempSetup::klibrary
    TEMP::ktestSubsection
    testlearn::filterFind
    testlearn::date
    testlearn::timestamp
    testlearn::orderInventoryGroupNumber
    testlearn::note
    testlearn::_Ltestlearn
    tempSetup::layoutLmain
    TEMP::layoutLmain

Scripts used in this script

    CHUNK_checkForDraggedPasteChanges
    defaultsAll
    menuReference
    menuTest
    loadLearnOrRefMainRecord

Layouts used in this script

    tableReference
    ltagSCRIPTloops
    defaultSetup
    learn2
    learnStuff2
    learnStuff3
    <Missing Layout>

Tables used in this script

    TEMP
    TEMP
    reference
    tag
    testlearn

Table occurrences used by this script

    TEMP
    refCreatorNode
    reference
    tempSetup
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [backToLearnOrDefaultSetup]	Parent Folder: [sharedLayoutScripts]	Next Script: [closeWindow]
Script Name	backtoSetup
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    Go to Layout [ “setupTestSubsection” (testSubsectionTemplate) ]
    Set Variable [ $$first ]
    Set Variable [ $$last ]
    Go to Field [ ]

Fields used in this script

Scripts used in this script

Layouts used in this script

    setupTestSubsection

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [backtoSetup]	Parent Folder: [sharedLayoutScripts]	Next Script: [closeWindowResumePause]
Script Name	closeWindow
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    CopyrightVIEW
    CopyrightEDIT
    ReferencePictureWindow
    ReferenceSPictureWindow
    ReferencePictureWindowEDIT
    ReferenceSPictureWindowEDIT
    ReferenceSTagMenusPictureWindowEDIT
    ReferencePictureWindow_Web
    ReferencePictureWindow_WebEDIT
    ReferencePictureWindow_HDD
    ReferencePictureWindow_HDDEDIT
    LearnTextWindow
    LearnTextWindow_iDevice
    LearnTextWindowStuff
    LearnTextWindowStuff_iDevice
    LearnTextWindowLocked
    LearnTextWindowLocked_iDevice
    LearnPictureWindow
    LearnPictureWindowEDIT
    LearnRefPictureWindow
    LearnRefPictureWindowEDIT
    LearnRefWebPictureWindow
    LearnRefWebPictureWindowEDIT
    LearnRefExternalPictureWindow
    LearnRefExternalPictureWindowEDIT
    testInfoText
    testInfoTextLocked
    learnMenuStuffBrainstormLocations

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #In copyright tag review window, check
    #changes to any locked group names.
    If [ $$citationMatch = "copyright" ]
    Perform Script [ “checkTagGroupNamesEXCEPTtestItemGroups” ]
    End If
    #
    #
    #Close window and clear unneeded variables.
    Show/Hide Text Ruler [ Hide ]
    Set Variable [ $mediaWindowName; Value:Case ( Get ( WindowName ) = "Media" ; 1 ; "" ) ]
    Close Window [ Current Window ]
    Set Variable [ $$PictureOnReportLayout ]
    Set Variable [ $$userInCopyrightWindow ]
    Set Variable [ $$showCopyrightLockMessage ]
    #
    #Scroll window to selected record if
    #it has been changed in a stuff/inventory
    #library.
    If [ $$copyNoteForSortCheck ≠ testlearn::note ]
    If [ TEMP::InventoryLibraryYN ≠ "" and Get (WindowName) = "Tag Menus" or TEMP::InventoryLibraryYN ≠ "" and Get (WindowName) = "Learn" ]
    If [ reference::Title[1] ≠ reference::Title[2] or reference::thoughtsNotesEtc[1] ≠ reference::thoughtsNotesEtc[2] or reference::publicationYearOrStuffOrderNumber[1] ≠ reference::publicationYearOrStuffOrderNumber[2] or reference::kkeywordPrimary ≠ $$locationKeyword ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagKeywordPrimary::orderOrLock; based on value list: “order Pulldown List” tagKeywordPrimary::tag; ascending reference::publicationYearOrStuffOrderNumber; based on value list: “order Pulldown List” reference::Title; ascending ] [ Restore; No dialog ]
    Set Variable [ $$locationKeyword ]
    End If
    If [ Get (WindowName) = "Learn" and $mediaWindowName ≠ 1 and Get ( LayoutName ) ≠ "learn4EDITstuff" ]
    Scroll Window [ End ]
    Sort Records [ ] [ No dialog ]
    End If
    End If
    Set Variable [ $$copyNoteForSortCheck ]
    End If
    #

Fields used in this script

    testlearn::note
    TEMP::InventoryLibraryYN
    reference::Title
    reference::thoughtsNotesEtc
    reference::publicationYearOrStuffOrderNumber
    reference::kkeywordPrimary
    tagKeywordPrimary::orderOrLock
    tagKeywordPrimary::tag

Scripts used in this script

    checkTagGroupNamesEXCEPTtestItemGroups

Layouts used in this script

Tables used in this script

    TEMP
    reference
    tag
    testlearn

Table occurrences used by this script

    TEMP
    reference
    tagKeywordPrimary
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [closeWindow]	Parent Folder: [sharedLayoutScripts]	Next Script: [closeWindowHaltScript]
Script Name	closeWindowResumePause
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    learnMenu3CitePickAReference

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Clear this variable to reveal the edit note controls.
    Set Variable [ $$hideEditNoteControls ]
    #
    #Determine if punctuation for reference.
    If [ TEMP::referenceInsertBeforeOrAfterPeriod = 1 or TEMP::referenceInsertBeforeOrAfterPeriod = "" ]
    Set Variable [ $$referenceToInsert; Value:"(" & $$referenceToInsert & ")" ]
    Else
    Set Variable [ $$referenceToInsert; Value:"[" & $$referenceToInsert & "]" ]
    End If
    #
    #Close window and restart the pause, so the
    #user cannot leave the selected window until
    #they are finished using it.
    Close Window [ Current Window ]
    #
    #Insert the text block.
    If [ Length ( $$referenceToInsert ) ≠ 2 ]
    Insert Calculated Result [ $$referenceToInsert ]
    Show Custom Dialog [ Message: "Your reference was inserted >> " & $$referenceToInsert; Default Button: “OK”, Commit: “Yes” ]
    End If
    Set Variable [ $$referenceToInsert ]
    Refresh Window
    #
    Pause/Resume Script [ Indefinitely ]
    #
    #

Fields used in this script

    TEMP::referenceInsertBeforeOrAfterPeriod

Scripts used in this script

Layouts used in this script

Tables used in this script

    TEMP

Table occurrences used by this script

    TEMP

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [closeWindowResumePause]	Parent Folder: [sharedLayoutScripts]	Next Script: [copyAndpastTags]
Script Name	closeWindowHaltScript
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    moreInfo
    allApps
    setupReferenceViewLocked
    setupReferenceViewUnlocked
    defaultSetupViewAndEdit
    ReferenceViewEDIT
    ReferenceViewDump
    testItemFormPreview

Scripts that use this script

Script Definition
Script Steps

    Close Window [ Current Window ]
    Halt Script

Fields used in this script

Scripts used in this script

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [closeWindowHaltScript]	Parent Folder: [sharedLayoutScripts]	Next Script: [exit]
Script Name	copyAndpastTags
Run script with full access privileges	On
Include In Menu	No
Layouts that use this script

    Reference
    learn0
    learn1
    learn2
    learn3
    learn4
    learn5
    learn4EDIT
    learn4EDITLocked

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #If in find mode, exit script.
    If [ $$findMode ≠ "" ]
    Show Custom Dialog [ Message: "Currently in find mode. Click done in the tag menus window to exit find mode, and then click this button."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #If node is currenlty locked then stop script, inform user.
    If [ tagTLNodePrimary::orderOrLock ≠ "" ]
    Show Custom Dialog [ Message: "The node that created this record, " & tagTLNodePrimary::tag & ", is locked, so all this node's records are locked too. Go back to Setup to unlock it."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    Else If [ refCreatorNode::orderOrLock ≠ "" ]
    Show Custom Dialog [ Message: "The node that created this record, " & $$lockedMainRefRecord & ", is locked, so all this node's records are locked too. Go back to Setup to unlock it."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #If there are no tags exit script and
    #inform user why.
    If [ testlearn::kcKeywordOther = "" and testlearn::kKeywordPrimary = "" and $$copyAndpastTagsRECORD = "" and Get ( LayoutTableName ) = "testlearn" or reference::kkeywordOther = "" and reference::kkeywordPrimary = "" and $$copyAndpastTagsRECORD = "" and Get ( LayoutTableName ) = "Reference" ]
    Show Custom Dialog [ Message: "There are no keywords to copy. You can add some by copying them from a note that has them, or by adding some keywords from the key tag menu."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #This is a scripts purpose is to copy tags from a
    #learn or reference record and paste them
    #in a different record.
    If [ $$copyAndpastTagsRECORD = "" ]
    Set Variable [ $$copyAndpastTagsPrimaryID; Value:Case ( Get (LayoutTableName) = "reference" ; reference::kkeywordPrimary ; testlearn::kKeywordPrimary ) ]
    Set Variable [ $$copyAndpastTagsOtherID; Value:Case ( Get (LayoutTableName) = "reference" ; reference::kkeywordOther ; testlearn::kcKeywordOther ) ]
    Set Variable [ $$copyAndpastTagsOther; Value:Case ( Get (LayoutTableName) = "reference" ; reference::OtherKeyWords ; testlearn::OtherKeyWords ) ]
    Set Variable [ $$copyAndpastTagsRECORD; Value:Case ( Get (LayoutTableName) = "reference" ; reference::_Lreference ; testlearn::_Ltestlearn ) ]
    Else
    If [ $$copyAndpastTagsRECORD = reference::_Lreference or $$copyAndpastTagsRECORD = testlearn::_Ltestlearn ]
    Set Variable [ $$copyAndpastTagsPrimaryID ]
    Set Variable [ $$copyAndpastTagsOtherID ]
    Set Variable [ $$copyAndpastTagsOther ]
    Set Variable [ $$copyAndpastTagsRECORD ]
    Else
    If [ $$copyAndpastTagsOtherID = "" and $$copyAndpastTagsPrimaryID = "" ]
    Show Custom Dialog [ Message: "Paste blanks? FYI: You copied blanks, and pasting them will delete/blank this record's keywords."; Default Button: “yes”, Commit: “Yes”; Button 2: “Cancel”, Commit: “No” ]
    Else
    If [ testlearn::kcKeywordOther = "" and testlearn::kKeywordPrimary = "" and Get ( LayoutTableName ) = "testlearn" or reference::kkeywordOther = "" and reference::kkeywordPrimary = "" and Get ( LayoutTableName ) = "Reference" ]
    Else
    Show Custom Dialog [ Message: "Replace this record's keywords with the copied ones?"; Default Button: “yes”, Commit: “Yes”; Button 2: “Cancel”, Commit: “No” ]
    End If
    End If
    If [ Get (LastMessageChoice) ≠ 2 ]
    If [ Get (LayoutTableName) = "reference" ]
    #
    #Because keyword primary in the Reference
    #window will change the records location, not
    #this and re-sort the window to keep the
    #the selected record in view (scrolled to).
    If [ $$copyAndpastTagsPrimaryID ≠ reference::kkeywordPrimary ]
    Set Variable [ $sort; Value:1 ]
    End If
    Set Field [ reference::kkeywordPrimary; $$copyAndpastTagsPrimaryID ]
    Set Field [ reference::kkeywordOther; $$copyAndpastTagsOtherID ]
    Set Field [ reference::OtherKeyWords; $$copyAndpastTagsOther ]
    Commit Records/Requests [ Skip data entry validation; No dialog ]
    Set Variable [ $$citationItem; Value:reference::kkeywordPrimary ]
    Set Variable [ $$PrimaryKey; Value:reference::kkeywordPrimary ]
    Set Variable [ $$Key; Value:reference::kkeywordOther ]
    Set Variable [ $$OtherKey; Value:reference::kkeywordOther ]
    Refresh Window
    If [ $sort = 1 ]
    Sort Records [ ] [ No dialog ]
    End If
    If [ $$citationMatch = "key" ]
    Set Variable [ $currentWindow; Value:Get (WindowName) ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    Select Window [ Name: $currentWindow; Current file ]
    End If
    Else
    Set Field [ testlearn::kKeywordPrimary; $$copyAndpastTagsPrimaryID ]
    Set Field [ testlearn::kcKeywordOther; $$copyAndpastTagsOtherID ]
    Set Field [ testlearn::OtherKeyWords; $$copyAndpastTagsOther ]
    Commit Records/Requests [ Skip data entry validation; No dialog ]
    Set Variable [ $$citationItem; Value:testlearn::kKeywordPrimary ]
    Set Variable [ $$PrimaryKey; Value:testlearn::kKeywordPrimary ]
    Set Variable [ $$Key; Value:testlearn::kcKeywordOther ]
    Set Variable [ $$OtherKey; Value:testlearn::kcKeywordOther ]
    Refresh Window
    If [ $$citationMatch = "key" ]
    Set Variable [ $currentWindow; Value:Get (WindowName) ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    Select Window [ Name: $currentWindow; Current file ]
    End If
    End If
    Set Variable [ $$copyAndpastTagsPrimaryID ]
    Set Variable [ $$copyAndpastTagsOtherID ]
    Set Variable [ $$copyAndpastTagsOther ]
    Set Variable [ $$copyAndpastTagsRECORD ]
    Else
    Set Variable [ $$copyAndpastTagsPrimaryID ]
    Set Variable [ $$copyAndpastTagsOtherID ]
    Set Variable [ $$copyAndpastTagsOther ]
    Set Variable [ $$copyAndpastTagsRECORD ]
    End If
    End If
    End If
    #
    Refresh Window
    #

Fields used in this script

    tagTLNodePrimary::orderOrLock
    tagTLNodePrimary::tag
    refCreatorNode::orderOrLock
    testlearn::kcKeywordOther
    testlearn::kKeywordPrimary
    reference::kkeywordOther
    reference::kkeywordPrimary
    reference::OtherKeyWords
    testlearn::OtherKeyWords
    reference::_Lreference
    testlearn::_Ltestlearn

Scripts used in this script

Layouts used in this script

Tables used in this script

    reference
    tag
    testlearn

Table occurrences used by this script

    refCreatorNode
    reference
    tagTLNodePrimary
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [copyAndpastTags]	Parent Folder: [sharedLayoutScripts]	Next Script: [exitOnly]
Script Name	exit
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    enterShortOrLongTagField
    loadSetupTestSubsection

Script Definition
Script Steps

    #
    // #Follow the record whose order number was
    // #changed on the reportTestResult layout.
    // If [ Get ( WindowName ) = "References" ]
    // Scroll Window [ Home ]
    // Sort Records [ ] [ No dialog ]
    // End If
    #
    #Get active field name for see if key tag menu
    #order number has been changed below.
    If [ $$keyOrderNumberPossibleChanged ≠ "" ]
    Set Variable [ $$keyOrderNumberPossibleChanged ]
    Set Variable [ $activeFieldName; Value:"orderOrLock" ]
    Else
    Set Variable [ $activeFieldName; Value:Get ( ActiveFieldName ) ]
    End If
    #
    #If there are no editors on the referenceEDIT
    #layout than delete any abbreviations.
    If [ reference::compilationEditors = "" and Get ( ActiveFieldName ) = "compilationAbbr" ]
    Set Field [ reference::compilationAbbr; "" ]
    Set Field [ reference::compilationNumberOfEditors; "" ]
    Go to Field [ ]
    Show Custom Dialog [ Message: "Type in the editor, compiler, or translators' names before checking the box to indicate what they are."; Default Button: “OK”, Commit: “No” ]
    Else If [ reference::compilationEditors = "" and Get ( ActiveFieldName ) = "compilationNumberOfEditors" ]
    Set Field [ reference::compilationNumberOfEditors; "" ]
    Go to Field [ ]
    Show Custom Dialog [ Message: "Type in the editor, compiler, or translators' names before checking the 'plural' box to indicate that there is more than one."; Default Button: “OK”, Commit: “No” ]
    End If
    #
    If [ Get ( WindowName ) = "References" ]
    Go to Field [ ]
    If [ Get (LayoutTableName) and tagKeywordPrimary::orderOrLock = "delete number" ]
    Set Field [ tagKeywordPrimary::orderOrLock; "" ]
    End If
    #
    #Follow the record whose order number was
    #changed on the reference layout.
    If [ Get (LayoutTableName) = "reference" and $$refGroupOrderNumber ≠ tagKeywordPrimary::orderOrLock or Get (LayoutTableName) = "reference" and $$refOrderNumber ≠ reference::publicationYearOrStuffOrderNumber ]
    Scroll Window [ Home ]
    Sort Records [ ] [ No dialog ]
    #
    #Get reference groups and references order
    #number in case user changes it.
    Set Variable [ $$refGroupOrderNumber; Value:tagKeywordPrimary::orderOrLock ]
    Set Variable [ $$refOrderNumber; Value:reference::publicationYearOrStuffOrderNumber ]
    End If
    Exit Script [ ]
    End If
    #
    #TEST ITEM ORDER NUMBER
    #If this is a test item and it is locked replace
    #revert the order number change and exit
    # the script.
    If [ Get (LayoutName) = "setupTestItem" and tagMenus::match = "testItem" and nodeLockTestTagItemGroup::orderOrLock ≠ "" ]
    If [ tagMenus::orderOrLock ≠ tagMenus::orderOrLock[2] ]
    Set Field [ tagMenus::orderOrLock; tagMenus::orderOrLock[2] ]
    End If
    If [ tagMenuTestItemGroup::orderOrLibraryType ≠ tagMenuTestItemGroup::orderOrLibraryType[2] ]
    Set Field [ tagMenuTestItemGroup::orderOrLibraryType; tagMenuTestItemGroup::orderOrLibraryType[2] ]
    End If
    #
    #If this is a test item and it is not locked replace
    #the backup order number with the new
    #change, and continue the script to sort the test
    #items based on this change.
    Else If [ Get (LayoutName) = "setupTestItem" and tagMenus::match = "testItem" and nodeLockTestTagItemGroup::orderOrLock = "" ]
    If [ tagMenus::orderOrLock ≠ tagMenus::orderOrLock[2] or tagMenuTestItemGroup::orderOrLibraryType ≠ tagMenuTestItemGroup::orderOrLibraryType[2] ]
    Set Variable [ $sortTestItems; Value:1 ]
    End If
    Set Field [ tagMenus::orderOrLock[2]; tagMenus::orderOrLock[1] ]
    Set Field [ tagMenuTestItemGroup::orderOrLibraryType[2]; tagMenuTestItemGroup::orderOrLibraryType[1] ]
    End If
    #
    #SUBSECTION ORDER NUMBER
    #If this is a test item and it is locked replace
    #revert the order number change and exit
    # the script.
    If [ Get (LayoutName) = "setupTestSubsection" and testSectionCreatorLock::orderOrLock ≠ "" ]
    Set Field [ testSubsectionTemplate::order; testSubsectionTemplate::order[2] ]
    End If
    If [ Get (LayoutName) = "setupTestSubsection" and testSubsectionGroupNodeLock::orderOrLock ≠ "" ]
    Set Field [ testSubsectionGroup::orderOrLibraryType; testSubsectionGroup::orderOrLibraryType[2] ]
    End If
    #
    #If this is a test item and it is not locked replace
    #the backup order number with the new
    #change, and continue the script to sort the test
    #items based on this change.
    If [ Get (LayoutName) = "setupTestSubsection" and testSectionCreatorLock::orderOrLock = "" ]
    If [ testSubsectionTemplate::order ≠ testSubsectionTemplate::order[2] ]
    Set Field [ testSubsectionTemplate::order[2]; testSubsectionTemplate::order[1] ]
    Set Variable [ $sortTestItems; Value:1 ]
    End If
    End If
    If [ Get (LayoutName) = "setupTestSubsection" and testSubsectionGroupNodeLock::orderOrLock = "" ]
    If [ testSubsectionGroup::orderOrLibraryType ≠ testSubsectionGroup::orderOrLibraryType[2] ]
    Set Field [ testSubsectionGroup::orderOrLibraryType[2]; testSubsectionGroup::orderOrLibraryType[1] ]
    Set Variable [ $sortTestItems; Value:1 ]
    End If
    End If
    #
    #Delete tag group order number if user selects
    #delete order number option.
    If [ $$citationMatch = "key" and tagMenuGroup::orderOrLibraryType = "delete number" or $$citationMatch = "node" and tagMenuGroup::orderOrLibraryType = "delete number" ]
    Set Field [ tagMenuGroup::orderOrLibraryType; "" ]
    End If
    #
    #Delete tag order number if user selects
    #delete order number option.
    If [ $$citationMatch = "brainstorm" and tagMenus::orderOrLock = "delete number" or $$citationMatch = "key" and tagMenus::orderOrLock = "delete number" or $$citationMatch = "testItem" and tagMenus::orderOrLock = "delete number" or Get (LayoutTableName) and tagKeywordPrimary::orderOrLock = "delete number" ]
    If [ Get (LayoutTableName) and tagKeywordPrimary::orderOrLock = "delete number" ]
    Set Field [ tagKeywordPrimary::orderOrLock; "" ]
    Else
    Set Field [ tagMenus::orderOrLock; "" ]
    End If
    End If
    #
    #Delete test result order number if user selects
    #delete order number option.
    If [ //testlearnReportTags::orderDiscovery = "delete number" Get ( ActiveFieldContents ) = "delete number" ]
    // Set Field [ testlearnReportTags::orderTestResult; "" ]
    Set Field [ "" ]
    End If
    #
    #
    #If node is currenlty locked then stop script, inform user.
    If [ tagTLNodePrimary::orderOrLock ≠ "" ]
    If [ testlearn::brainstormCasePoint = 1 ]
    Set Field [ testlearn::brainstormCasePoint; "" ]
    Else
    Set Field [ testlearn::brainstormCasePoint; "1" ]
    End If
    Go to Field [ ]
    Show Custom Dialog [ Message: "The node — " & tagTLNodePrimary::tag & " — is locked. Go to the Default Node Tag Menu and A) click 'lock' to unlock it."; Default Button: “OK”, Commit: “No” ]
    Exit Script [ ]
    End If
    #
    #If node doesn't have a password delete any
    #order number, but if the node does have
    #password then put in a zero.
    If [ $$citationMatch = "node" and tagMenus::orderOrLock[2] = "" and Get (LayoutName) ≠ "defaultSections" and Get (LayoutName) ≠ "defaultTestNewSection" and Get (WindowName) = "Tag Menus" ]
    Set Field [ tagMenus::orderOrLock; "" ]
    Set Field [ tagMenus::orderOrLock[2]; "" ]
    Else If [ $$citationMatch = "node" and tagMenus::orderOrLock[2] ≠ "" and Get (LayoutName) ≠ "defaultSections" ]
    Set Field [ tagMenus::orderOrLock; 0 ]
    End If
    #
    #If user changed copyright of a locked node,
    #on the Node menu change it back and inform user.
    If [ tagMenus::notesOrCopyright ≠ $$oldCopyright and tagCreatorLock::orderOrLock ≠ "" and tagMenus::match = "node" or tagMenus::notesOrCopyright ≠ $$oldCopyright and tagMenus::orderOrLock = "0" and tagMenus::match = "node" ]
    Set Field [ tagMenus::notesOrCopyright; $$oldCopyright ]
    Go to Field [ ]
    If [ tagMenus::orderOrLock[2] = "" ]
    Show Custom Dialog [ Message: "This record is locked. Go the node that created it — " & tagCreatorLock::tag & " — enter the password to unlock it."; Default Button: “OK”, Commit: “Yes” ]
    Else
    Show Custom Dialog [ Message: "This node is locked. Click the lock button above, and enter its password to unlock it."; Default Button: “OK”, Commit: “No” ]
    End If
    End If
    #
    #If user changed copyright of a locked node,
    #on the brainstorm menu change it back
    #and inform user.
    If [ tagCreatorLock::orderOrLock ≠ "" and tagMenus::orderOrLock ≠ "lock" and tagMenus::match = "brainstorm" or tagCreatorLock::orderOrLock ≠ "" and tagMenus::orderOrLock ≠ "lock" and tagMenus::match = "copyright" or tagCreatorLock::orderOrLock ≠ "" and tagMenus::orderOrLock ≠ "lock" and tagMenus::match = "test" ]
    Set Field [ tagMenus::notesOrCopyright; $$oldCopyright ]
    Go to Field [ ]
    Show Custom Dialog [ Message: "The node that created this brainstorm — " & tagCreatorLock::tag & " — is locked. Go to the setup tag window and enter its password to unlock it."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #
    #If this is the primary node on a default layout,
    #and if the default copyright is blank or is
    #different from primary's copyright, then update
    #the default copyright to match this node's copyright.
    If [ $$citationMatch = "node" and tempSetup::kdefaultCopyright ≠ tagMenus::notesOrCopyright and tagMenus::_Ltag = tempSetup::kdefaultNodePrimary ]
    Set Variable [ $$copyright; Value:tagMenus::notesOrCopyright ]
    Set Field [ tempSetup::kdefaultCopyright; tagMenus::notesOrCopyright ]
    Show Custom Dialog [ Message: "The library's default copyright has been updated to match the default node's copyright."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #
    #Exit field.
    Go to Field [ ]
    #
    #Follow the record whose order number was
    #changed on the reportTestResult layout.
    If [ $$citationMatch = "testResult" or $$citationMatch = "testItem" and $sortTestItems = 1 or Get (LayoutName) = "setupTestSubsection" and $sortTestItems = 1 ]
    Scroll Window [ Home ]
    Sort Records [ ] [ No dialog ]
    End If
    #
    #Follow the record whose order number was
    #changed on the reference layout.
    If [ Get (LayoutTableName) = "reference" and $$refGroupOrderNumber ≠ tagKeywordPrimary::orderOrLock or Get (LayoutTableName) = "reference" and $$refOrderNumber ≠ reference::publicationYearOrStuffOrderNumber ]
    Scroll Window [ Home ]
    Sort Records [ ] [ No dialog ]
    #
    #Get reference groups and references order
    #number in case user changes it.
    Set Variable [ $$refGroupOrderNumber; Value:tagKeywordPrimary::orderOrLock ]
    Set Variable [ $$refOrderNumber; Value:reference::publicationYearOrStuffOrderNumber ]
    #
    #One more sort seems needed sometimes
    #to get FM to focus on selected record.
    Sort Records [ ] [ No dialog ]
    End If
    #
    #The next sections of code require doing finds
    #that could result in nothing found error
    #messages, so prevent these from showing up.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #If this is the keyword tag menu and user is
    #looking at either author/node or keyword/
    #subject ordered records, check to see if this
    #has changed the reference group order as a
    #result of re-ordering the author/node or
    #keyword/subject tags.
    If [ $activeFieldName = "orderOrLock" ]
    If [ $$citationMatch = "key" and $$referenceSort = "" and Get ( WindowName ) = "Tag Menus" or $$citationMatch = "node" and $$referenceSort = "author" and Get ( WindowName ) = "Tag Menus" ]
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) ≠ 112 ]
    Commit Records/Requests
    #
    #See if the edited record changed position in
    #the main reference window as a result of
    #alphabetical or order number changing edits.
    Set Variable [ $$stoploadCitation; Value:1 ]
    Set Variable [ $currentrecord; Value:Get (RecordNumber) ]
    New Window [ Name: "CheckDuplicateRecordPosition"; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    If [ $$citationMatch = "key" and $$referenceSort = "" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagKeywordPrimary::orderOrLock; based on value list: “testPulldownListANDsortOrderList” tagKeywordPrimary::tag; ascending reference::publicationYearOrStuffOrderNumber; based on value list: “testPulldownListANDsortOrderList” reference::Title; ascending reference::thoughtsNotesEtc; ascending ] [ Restore; No dialog ]
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagKeywordPrimary::orderOrLock; based on value list: “order Pulldown List” tagKeywordPrimary::tag; ascending reference::referenceForReferenceWindow; ascending ] [ Restore; No dialog ]
    End If
    Else If [ $$citationMatch = "node" and $$referenceSort = "author" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: reference::sortByAuthor; ascending reference::referenceForReferenceWindow; ascending ] [ Restore; No dialog ]
    End If
    #
    #If the edited record moved then note this.
    If [ $currentrecord ≠ Get (RecordNumber) ]
    Set Variable [ $recordMoved; Value:Get (RecordNumber) ]
    End If
    Close Window [ Name: "CheckDuplicateRecordPosition"; Current file ]
    #
    #Re-sort to view edited record if it
    #was moved.
    If [ $recordMoved ≠ "" ]
    If [ $$citationMatch = "key" and $$referenceSort = "" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagKeywordPrimary::orderOrLock; based on value list: “testPulldownListANDsortOrderList” tagKeywordPrimary::tag; ascending reference::publicationYearOrStuffOrderNumber; based on value list: “testPulldownListANDsortOrderList” reference::Title; ascending reference::thoughtsNotesEtc; ascending ] [ Restore; No dialog ]
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagKeywordPrimary::orderOrLock; based on value list: “order Pulldown List” tagKeywordPrimary::tag; ascending reference::referenceForReferenceWindow; ascending ] [ Restore; No dialog ]
    End If
    Else If [ $$citationMatch = "node" and $$referenceSort = "author" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: reference::sortByAuthor; ascending reference::referenceForReferenceWindow; ascending ] [ Restore; No dialog ]
    End If
    Go to Record/Request/Page [ $recordMoved ] [ No dialog ]
    End If
    #
    #Return to the Tag Menus window.
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    #Check keyword sort order.
    Else
    Set Variable [ $checkReferenceKeywordHeaderOrder; Value:1 ]
    End If
    #
    #Check keyword sort order.
    Else
    Set Variable [ $checkReferenceKeywordHeaderOrder; Value:1 ]
    End If
    #
    #If keyword order number is being changed,
    #and the Reference Main window is not
    #showing (because user in the Learn section),
    #or it is showing but not currently sorted by
    #keyword, then inform user with a dialogue box
    #that changes to the order number affect the
    #keyword headers for references.
    If [ $checkReferenceKeywordHeaderOrder ≠ "" ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Set Variable [ $keyTag; Value:tagMenus::_Ltag ]
    New Window [ Name: "CheckDuplicateRecordPosition"; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “ReferenceScriptLoops” (reference) ]
    Enter Find Mode [ ]
    Set Field [ tagKeywordPrimary::_Ltag; $keyTag ]
    Perform Find [ ]
    #
    #If the edited record moved then note this.
    If [ Get ( FoundCount ) ≠ 0 ]
    Set Variable [ $keyHeaderMoved; Value:1 ]
    End If
    #
    #Return to the Tag Menus window.
    Close Window [ Current Window ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Set Variable [ $$stopLoadTagRecord ]
    Go to Field [ ]
    #
    #Tell user if this changed a reference header.
    If [ $keyHeaderMoved ≠ "" ]
    If [ tagMenus::orderOrLock = "" ]
    Show Custom Dialog [ Message: "FYI: This key (keyword) tag is in use as a reference group header, which will now, like this keyword, be sorted alphabetically."; Default Button: “OK”, Commit: “Yes” ]
    Else
    Show Custom Dialog [ Message: "FYI: This key (keyword) tag is in use as a reference group header, and like the keyword, the header will no longer be sorted alphabetically."; Default Button: “OK”, Commit: “Yes” ]
    End If
    End If
    End If
    #
    #Sort records to follow changed order number.
    Sort Records [ ] [ No dialog ]
    End If
    #
    #
    #
    #If this is the location tag menu and user is
    #changing an order number or deleting one,
    #re-sort the learn window records in case
    #they are affected.
    If [ $activeFieldName = "publicationYearOrStuffOrderNumber" ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Set Variable [ $refTag; Value:reference::_Lreference ]
    New Window [ Name: "CheckDuplicateRecordPosition"; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “learnSCRIPTloops” (testlearn) ]
    Enter Find Mode [ ]
    Set Field [ testlearn::kcreference; $refTag ]
    Perform Find [ ]
    #
    #If the edited record moved then note this.
    If [ Get ( FoundCount ) ≠ 0 ]
    Set Variable [ $refHeaderMoved; Value:1 ]
    End If
    #
    #Return to the Tag Menus window.
    Close Window [ Current Window ]
    Set Variable [ $$stopLoadTagRecord ]
    Go to Field [ ]
    #
    #Return to the Tag Menus window.
    If [ $refHeaderMoved ≠ "" ]
    Select Window [ Name: "Learn"; Current file ]
    Sort Records [ ] [ No dialog ]
    End If
    Select Window [ Name: "Tag Menus"; Current file ]
    End If
    #
    #
    #
    #This prevents the system trademark tag (not
    #user created) being used improperly.
    If [ tagsCopyrightGroup::_Lgroup = "92020171119521809" and Left ( Get ( LayoutName ) ; 9 ) = "learnMenu" ]
    Show Custom Dialog [ Message: "Trademark tags can only be added to reference records, and then only if if the reference is for a trademark, logo, brand, etc."; Default Button: “OK”, Commit: “Yes” ]
    #
    #Set default copyright for tag.
    Set Field [ tagMenus::notesOrCopyright; TEMP::kdefaultCopyright ]
    #
    Show Custom Dialog [ Message: "The copyright has been reset to the current default. Please choose again if this not what you want."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #
    #
    #

Fields used in this script

    reference::compilationEditors
    reference::compilationAbbr
    reference::compilationNumberOfEditors
    tagKeywordPrimary::orderOrLock
    reference::publicationYearOrStuffOrderNumber
    tagMenus::match
    nodeLockTestTagItemGroup::orderOrLock
    tagMenus::orderOrLock
    tagMenuTestItemGroup::orderOrLibraryType
    testSectionCreatorLock::orderOrLock
    testSubsectionTemplate::order
    testSubsectionGroupNodeLock::orderOrLock
    testSubsectionGroup::orderOrLibraryType
    tagMenuGroup::orderOrLibraryType
    testlearnReportTags::orderTestResult
    tagTLNodePrimary::orderOrLock
    testlearn::brainstormCasePoint
    tagTLNodePrimary::tag
    tagMenus::notesOrCopyright
    tagCreatorLock::orderOrLock
    tagCreatorLock::tag
    tempSetup::kdefaultCopyright
    tagMenus::_Ltag
    tempSetup::kdefaultNodePrimary
    TEMP::InventoryLibraryYN
    tagKeywordPrimary::tag
    reference::Title
    reference::thoughtsNotesEtc
    reference::referenceForReferenceWindow
    reference::sortByAuthor
    tagKeywordPrimary::_Ltag
    reference::_Lreference
    testlearn::kcreference
    tagsCopyrightGroup::_Lgroup
    TEMP::kdefaultCopyright

Scripts used in this script

Layouts used in this script

    ReferenceScriptLoops
    learnSCRIPTloops

Tables used in this script

    TEMP
    TEMP
    reference
    tag
    tag
    tagGroup
    tagGroup
    testSubsectionTemplate
    testlearn
    testlearn

Table occurrences used by this script

    TEMP
    nodeLockTestTagItemGroup
    reference
    tagCreatorLock
    tagKeywordPrimary
    tagMenuGroup
    tagMenuTestItemGroup
    tagMenus
    tagTLNodePrimary
    tagsCopyrightGroup
    tempSetup
    testSectionCreatorLock
    testSubsectionGroup
    testSubsectionGroupNodeLock
    testSubsectionTemplate
    testlearn
    testlearnReportTags

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [exit]	Parent Folder: [sharedLayoutScripts]	Next Script: [findInactiveButtonMessage]
Script Name	exitOnly
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    learn2
    learn3
    learn4
    learn4EDITLocked

Scripts that use this script

Script Definition
Script Steps

    #
    #Exit field.
    Go to Field [ ]
    Go to Field [ ]
    #

Fields used in this script

Scripts used in this script

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [exitOnly]	Parent Folder: [sharedLayoutScripts]	Next Script: [gotoAllAppsMenuORActionLogApp]
Script Name	findInactiveButtonMessage
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    referenceMenuFINDref
    referenceFINDNK
    learnMenuFINDref
    learnMenuFINDrefLearn
    learnMenuFINDstuffRef
    learnMenuFINDstuffRefLearn
    ltagFINDNK
    ltagFINDstuffNK

Scripts that use this script

Script Definition
Script Steps

    #
    #
    Show Custom Dialog [ Message: "To search another tag's tags, 1) click 'cancel', then 2) click that tag's button to view its tags, and finally 3) click 'find' again to search thru them."; Default Button: “OK”, Commit: “Yes” ]
    #
    #

Fields used in this script

Scripts used in this script

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [findInactiveButtonMessage]	Parent Folder: [sharedLayoutScripts]	Next Script: [gotoTimeLogLogWindow]
Script Name	gotoAllAppsMenuORActionLogApp
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultSetup
    defaultTest
    defaultTestNewSection
    Reference
    ReferenceStuff
    ReferenceEDIT
    ReferenceFilePathEDIT
    ReferenceAddToTag
    ReferenceAddToCopyright
    learn0
    learnStuff0
    learn1
    learnStuff1
    learn2
    learnStuff2
    learn3
    learnStuff3
    learn4
    learnStuff4
    learn5
    learnStuff5
    learn4EDIT
    learn4EDITLocked
    learn4EDITstuff
    learn4EDITstuffLocked
    setupTestSection
    setupTestSubsection
    setupTestItem
    setupTestItemLOCKED
    testingSubsectionMenu
    testResult0
    testResultLOCKED0
    testResult1
    testResultLOCKED1
    testResult2
    testResultLOCKED2
    testResult3
    testResultLOCKED3
    testResult4
    testResultLOCKED4
    testResult5
    testResultLOCKED5
    PrintReportEdit
    PrintReportLock

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Ask user if they want to go the timer or
    #the all apps menu.
    Show Custom Dialog [ Message: "Open the Action Log (timer) or the all apps menu?"; Default Button: “timer”, Commit: “Yes”; Button 2: “all apps”, Commit: “No”; Button 3: “cancel”, Commit: “No” ]
    If [ Get ( LastMessageChoice ) = 2 ]
    Perform Script [ “allAppsMenu” ]
    Exit Script [ ]
    End If
    #
    If [ Get ( LastMessageChoice ) = 3 ]
    Exit Script [ ]
    End If
    #
    #
    #
    #BEGIN Find and record all open windows
    #
    #
    #Get the name of the window that the user
    #clicked the app button on.
    Set Variable [ $windowAppWasClickedOn; Value:Get (WindowName) ]
    #
    #
    #Now figure out what other windows are open.
    #There can be up to three windows open.
    #LEARN
    #Is this window open and not alread recorded?
    Select Window [ Name: "Learn"; Current file ]
    If [ Get (LastError) ≠ 112 //window is missing = 112 and $windowAppWasClickedOn ≠ Get ( WindowName ) ]
    #Is the second open window accounted for?
    If [ $windowAlsoOpen2 = "" ]
    Set Variable [ $windowAlsoOpen2; Value:Get (WindowName) ]
    Else
    Set Variable [ $windowAlsoOpen3; Value:Get (WindowName) ]
    End If
    End If
    #REFERENCE (NOTE: Change this window
    #name to references when time permits.)
    #Is this window open and not alread recorded?
    Select Window [ Name: "Reference"; Current file ]
    If [ Get (LastError) ≠ 112 //window is missing = 112 and $windowAppWasClickedOn ≠ Get ( WindowName ) ]
    #Is the second open window accounted for?
    If [ $windowAlsoOpen2 = "" ]
    Set Variable [ $windowAlsoOpen2; Value:Get (WindowName) ]
    Else
    Set Variable [ $windowAlsoOpen3; Value:Get (WindowName) ]
    End If
    End If
    #REFERENCES
    #Is this window open and not alread recorded?
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) ≠ 112 //window is missing = 112 and $windowAppWasClickedOn ≠ Get ( WindowName ) ]
    #Is the second open window accounted for?
    If [ $windowAlsoOpen2 = "" ]
    Set Variable [ $windowAlsoOpen2; Value:Get (WindowName) ]
    Else
    Set Variable [ $windowAlsoOpen3; Value:Get (WindowName) ]
    End If
    End If
    #REPORT
    #Is this window open and not alread recorded?
    Select Window [ Name: "Report"; Current file ]
    If [ Get (LastError) ≠ 112 //window is missing = 112 and $windowAppWasClickedOn ≠ Get ( WindowName ) ]
    #Is the second open window accounted for?
    If [ $windowAlsoOpen2 = "" ]
    Set Variable [ $windowAlsoOpen2; Value:Get (WindowName) ]
    Else
    Set Variable [ $windowAlsoOpen3; Value:Get (WindowName) ]
    End If
    End If
    #SETUP
    #Is this window open and not alread recorded?
    Select Window [ Name: "Setup"; Current file ]
    If [ Get (LastError) ≠ 112 //window is missing = 112 and $windowAppWasClickedOn ≠ Get ( WindowName ) ]
    #Is the second open window accounted for?
    If [ $windowAlsoOpen2 = "" ]
    Set Variable [ $windowAlsoOpen2; Value:Get (WindowName) ]
    Else
    Set Variable [ $windowAlsoOpen3; Value:Get (WindowName) ]
    End If
    End If
    #SHARE
    #Is this window open and not alread recorded?
    Select Window [ Name: "Share"; Current file ]
    If [ Get (LastError) ≠ 112 //window is missing = 112 and $windowAppWasClickedOn ≠ Get ( WindowName ) ]
    #Is the second open window accounted for?
    If [ $windowAlsoOpen2 = "" ]
    Set Variable [ $windowAlsoOpen2; Value:Get (WindowName) ]
    Else
    Set Variable [ $windowAlsoOpen3; Value:Get (WindowName) ]
    End If
    End If
    #TAG MENUS
    #Is this window open and not alread recorded?
    Select Window [ Name: "Tag Menus"; Current file ]
    If [ Get (LastError) ≠ 112 //window is missing = 112 and $windowAppWasClickedOn ≠ Get ( WindowName ) ]
    #Is the second open window accounted for?
    If [ $windowAlsoOpen2 = "" ]
    Set Variable [ $windowAlsoOpen2; Value:Get (WindowName) ]
    Else
    Set Variable [ $windowAlsoOpen3; Value:Get (WindowName) ]
    End If
    End If
    #TEST
    #Is this window open and not alread recorded?
    Select Window [ Name: "Test"; Current file ]
    If [ Get (LastError) ≠ 112 //window is missing = 112 and $windowAppWasClickedOn ≠ Get ( WindowName ) ]
    #Is the second open window accounted for?
    If [ $windowAlsoOpen2 = "" ]
    Set Variable [ $windowAlsoOpen2; Value:Get (WindowName) ]
    Else
    Set Variable [ $windowAlsoOpen3; Value:Get (WindowName) ]
    End If
    End If
    #TEST TEMPLATES
    #Is this window open and not alread recorded?
    Select Window [ Name: "Test Templates"; Current file ]
    If [ Get (LastError) ≠ 112 //window is missing = 112 and $windowAppWasClickedOn ≠ Get ( WindowName ) ]
    #Is the second open window accounted for?
    If [ $windowAlsoOpen2 = "" ]
    Set Variable [ $windowAlsoOpen2; Value:Get (WindowName) ]
    Else
    Set Variable [ $windowAlsoOpen3; Value:Get (WindowName) ]
    End If
    End If
    #
    Set Field [ MemorySwitch::currentLibraryPath; Get ( FilePath ) ]
    Set Field [ MemorySwitch::currentLibraryWIndows; $windowAppWasClickedOn ]
    Set Field [ MemorySwitch::currentLibraryWIndows[2]; $windowAlsoOpen2 ]
    Set Field [ MemorySwitch::currentLibraryWIndows[3]; $windowAlsoOpen3 ]
    #
    #
    #END Find and record all open windows
    #
    #
    #
    #Open using this url on iPad/iPhone.
    If [ Get ( SystemPlatform ) = 3 ]
    Open URL [ "fmp://%7e/ActionLog" ] [ No dialog ]
    Exit Script [ ]
    Else
    Select Window [ Name: "Tag" ]
    If [ Get (LastError) = 112 ]
    Set Variable [ $notOpen; Value:1 ]
    End If
    Select Window [ Name: "Day" ]
    If [ Get (LastError) = 112 ]
    Set Variable [ $notOpen; Value:1 + $notOpen ]
    End If
    Select Window [ Name: "Timer" ]
    If [ Get (LastError) = 112 ]
    Set Variable [ $notOpen; Value:1 + $notOpen ]
    End If
    Select Window [ Name: "Specific Action" ]
    If [ Get (LastError) = 112 ]
    Set Variable [ $notOpen; Value:1 + $notOpen ]
    End If
    Select Window [ Name: "HelpGiveThanks Apps" ]
    If [ Get (LastError) = 112 ]
    Set Variable [ $notOpen; Value:1 + $notOpen ]
    End If
    End If
    #
    #If ActionLog is not open on the desktop
    #computer, then open it.
    If [ $notOpen = 5 ]
    Open URL [ Substitute ( MemorySwitch::helpPath ; "help" ; "actionlog" ) ] [ No dialog ]
    Open URL [ Substitute ( MemorySwitch::helpPath ; "help" ; "actionLog" ) ] [ No dialog ]
    End If
    #
    #
    If [ Get (LastError) = 5 ]
    Show Custom Dialog [ Message: "This library file needs to be put into the HGT folder. "; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #

Fields used in this script

    MemorySwitch::currentLibraryPath
    MemorySwitch::currentLibraryWIndows
    MemorySwitch::helpPath

Scripts used in this script

    allAppsMenu

Layouts used in this script

Tables used in this script

    MemorySwitch

Table occurrences used by this script

    MemorySwitch

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [gotoAllAppsMenuORActionLogApp]	Parent Folder: [sharedLayoutScripts]	Next Script: [returnToAddRecordPUTONHOLD!!!!]
Script Name	gotoTimeLogLogWindow
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    Select Window [ Name: "Issues Log" ]
    Select Window [ Name: "Activity Log" ]

Fields used in this script

Scripts used in this script

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [gotoTimeLogLogWindow]	Parent Folder: [sharedLayoutScripts]	Next Script: [stopLockedNodesRecordsBeingDeleted]
Script Name	returnToAddRecordPUTONHOLD!!!!
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #I've decided to not continue finishing this script.
    #The idea was if the user navigated away from
    #the record they came into add mode to add to
    #this script would re-select that record.
    #Part of the reason for this was that in add mode
    #The database was set to just keyword or node
    #in terms of noting the FilterFind field. But that
    #has now been made by dynamic by tying this noting
    #to the citation match field. If later on this seems
    #useful this script can be polished for use. Right
    #now it just seems like giving the user too much
    #help, which looks like to many buttons on the layout!
    #
    If [ $$addCitationMatch = "node" and $$addCitationMatch ≠ $$CitationMatch ]
    #
    #
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    #Set citationMatch to color menu button with inUse color.
    Set Variable [ $$citationMatch; Value:"node" ]
    #
    #Do not load tag records until the end of script
    #to prevent flashing of window and to speed up
    #script.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    #
    #Goto correct layout.
    If [ TEMP::layoutRtagN = "" or TEMP::layoutLtagN = "" ]
    If [ Left (Get (LayoutName) ; 1) = "l" ]
    Go to Layout [ “ltagNK3” (tagMenus) ]
    Else If [ Left (Get (LayoutName) ; 1) = "r" ]
    Go to Layout [ “ReferenceMenu2keywordOrNode2” (tagMenus) ]
    End If
    #
    Else If [ TEMP::layoutRtagN ≠ "" or TEMP::layoutLtagN ≠ "" ]
    If [ Left (Get (LayoutName) ; 1) = "l" ]
    Go to Layout [ TEMP::layoutLtagN ]
    Else If [ Left (Get (LayoutName) ; 1) = "r" ]
    Go to Layout [ TEMP::layoutRtagN ]
    End If
    End If
    #
    #Find node tags.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Enter Find Mode [ ]
    Set Field [ tagMenus::match; $$citationMatch ]
    Perform Find [ ]
    #
    #If no records exist then create one.
    If [ Get (FoundCount)=0 ]
    Perform Script [ “newTagMenuTagGroup” ]
    End If
    #
    #Sort according to current users wishes.
    If [ TEMP::sortNode = "cat" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    Else If [ TEMP::sortNode = "abc" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenus::tag; ascending ] [ Restore; No dialog ]
    End If
    #
    #
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ $$addRecord = tagMenus::_Ltag ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Inform user of items use on both screens.
    Set Variable [ $$stopLoadTagRecord ]
    Perform Script [ “loadTagRecord” ]
    #
    #Just in case user was in nonTag field on this
    #window when user clicked a menu button on
    #the other window, exit all fields.
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    Go to Field [ ]
    Set Variable [ $$citationItem; Value:testlearn::kNodePrimary ]
    Else If [ Get (LastError) ≠ 112 ]
    Go to Field [ ]
    Set Variable [ $$citationItem; Value:reference::knodePrimary ]
    End If
    Refresh Window
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    #
    Else If [ $$addCitationMatch = "key" and $$addCitationMatch ≠ $$CitationMatch ]
    #
    #Set citationMatch to color menu button with inUse color.
    Set Variable [ $$citationMatch; Value:"key" ]
    #
    #Do not load tag records until the end of script
    #to prevent flashing of window and to speed up
    #script.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    #
    #Goto correct layout.
    If [ TEMP::layoutRtagK = "" or TEMP::layoutLtagK = "" ]
    If [ Left (Get (LayoutName) ; 1) = "l" ]
    Go to Layout [ “ltagNK3” (tagMenus) ]
    Else If [ Left (Get (LayoutName) ; 1) = "r" ]
    Go to Layout [ “ReferenceMenu2keywordOrNode2” (tagMenus) ]
    End If
    #
    Else If [ TEMP::layoutRtagK ≠ "" or TEMP::layoutLtagK ≠ "" ]
    If [ Left (Get (LayoutName) ; 1) = "l" ]
    Go to Layout [ TEMP::layoutLtagK ]
    Else If [ Left (Get (LayoutName) ; 1) = "r" ]
    Go to Layout [ TEMP::layoutRtagK ]
    End If
    End If
    #
    #Find key tags for library section.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Enter Find Mode [ ]
    Set Field [ tagMenus::match; $$citationMatch ]
    Perform Find [ ]
    #
    #If no records exist then create one.
    If [ Get (FoundCount)=0 ]
    Perform Script [ “newTagMenuTagGroup” ]
    End If
    #
    #Sort according to current users wishes.
    If [ TEMP::sortKey = "cat" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    Else If [ TEMP::sortKey = "abc" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenus::tag; ascending ] [ Restore; No dialog ]
    End If
    #
    #
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ $$addRecord = tagMenus::_Ltag ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Inform user of items use on both screens.
    Set Variable [ $$stopLoadTagRecord ]
    Perform Script [ “loadTagRecord” ]
    #
    #Just in case user was in nonTag field on this
    #window when user clicked a menu button on
    #the other window, exit all fields.
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    Go to Field [ ]
    Set Variable [ $$citationItem; Value:testlearn::kKeywordPrimary ]
    Else If [ Get (LastError) ≠ 112 ]
    Go to Field [ ]
    Set Variable [ $$citationItem; Value:reference::kkeywordPrimary ]
    End If
    Refresh Window
    #
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    Else If [ $$addCitationMatch = "testItem" and $$addCitationMatch ≠ $$CitationMatch ]
    #
    #Goto correct layout.
    If [ TEMP::DetailmoreORLessLayout = "" ]
    Go to Layout [ “setupTestItem” (tagMenus) ]
    Else If [ TEMP::DetailmoreORLessLayout ≠ "" ]
    Go to Layout [ TEMP::DetailmoreORLessLayout ]
    End If
    Set Variable [ $$citationMatch; Value:"testItem" ]
    #
    #Find detail tags for library section.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Enter Find Mode [ ]
    Set Field [ tagMenus::kGroupOrTest; TEMP::ktestItemSubsection ]
    Perform Find [ ]
    #
    #If no records exist then create one.
    If [ Get (FoundCount)=0 ]
    Perform Script [ “newTagMenuTagGroup” ]
    End If
    #
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuTestItemGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuTestItemGroup::name; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    #
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ $$addRecord = tagMenus::_Ltag ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    End If

Fields used in this script

    TEMP::layoutRtagN
    TEMP::layoutLtagN
    tagMenus::match
    TEMP::sortNode
    tagMenuGroup::orderOrLibraryType
    tagMenuGroup::name
    tagMenus::orderOrLock
    tagMenus::tag
    tagMenus::_Ltag
    testlearn::kNodePrimary
    reference::knodePrimary
    TEMP::layoutRtagK
    TEMP::layoutLtagK
    TEMP::sortKey
    testlearn::kKeywordPrimary
    reference::kkeywordPrimary
    TEMP::DetailmoreORLessLayout
    TEMP::ktestItemSubsection
    tagMenus::kGroupOrTest
    tagMenuTestItemGroup::orderOrLibraryType
    tagMenuTestItemGroup::name

Scripts used in this script

    newTagMenuTagGroup
    loadTagRecord

Layouts used in this script

    ltagNK3
    ReferenceMenu2keywordOrNode2
    <Missing Layout>
    setupTestItem

Tables used in this script

    TEMP
    reference
    tag
    tagGroup
    testlearn

Table occurrences used by this script

    TEMP
    reference
    tagMenuGroup
    tagMenuTestItemGroup
    tagMenus
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [returnToAddRecordPUTONHOLD!!!!]	Parent Folder: [sharedLayoutScripts]	Next Script: [stopLockedRecordsFromBeingDeleted]
Script Name	stopLockedNodesRecordsBeingDeleted
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    deleteKeywordTag

Script Definition
Script Steps

    #
    #
    #Scripts that use this script —
    #CHECK THE DDR! To get the most uptodate
    #list of scripts currently using this one!
    #
    #
    #If the PRIMARY node is currenlty locked then
    #stop ALL scripts, and inform the user.
    #(By ALL scripts, I mean the script that used this
    #one to see if running it was OK.)
    If [ TEMP::primaryNodeIsLocked ≠ "" ]
    If [ Left ( Get (LayoutName) ; 11 ) = "defaultNode" ]
    Show Custom Dialog [ Message: "The default primary node — " & TEMP::DEFAULTNodePrimaryName & " — is locked. A) Click 'lock' to unlock it, B) select an unlocked node for the primary node, or C) create a new primary node."; Default Button: “OK”, Commit: “Yes”; Button 2: “new primary”, Commit: “No” ]
    Else
    Show Custom Dialog [ Message: "The default primary node — " & TEMP::DEFAULTNodePrimaryName & " — is locked. Go to the Default Node Tag Menu and A) click 'lock' to unlock it, B) select an unlocked node for the primary node, or C) create a new primary node."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #If the user decides to create a new primary
    #record then proceed to do so.
    If [ Get (LastMessageChoice) = 2 ]
    Show Custom Dialog [ Message: "A new node to assign to yourself will now be created, allowing you to make new records, tags, etc. If you lock it, all its creations will also be locked."; Default Button: “OK”, Commit: “Yes”; Button 2: “Cancel”, Commit: “No” ]
    If [ Get (LastMessageChoice) = 2 ]
    Halt Script
    End If
    #
    #This variable tells the create new node script to
    #create a new user node, which is a node that is
    #its own creator, and thus can only be locked
    #directly, versus locked by also locking its creator.
    Set Variable [ $$createNewPrimary; Value:1 ]
    #
    #If user doesn't elect to create a new user node,
    #then halt the script.
    Else
    Halt Script
    End If
    #
    #If the primary node's CREATOR node is
    #currenlty locked then stop ALL scripts, and
    #inform the user.
    #(By ALL scripts, I mean the script that used this
    #one to see if running it was OK.)
    Else If [ TEMP::primaryNodesCreatorNodeIsLocked ≠ "" ]
    If [ Left ( Get (LayoutName) ; 11 ) = "defaultNode" ]
    Show Custom Dialog [ Message: "The creator — " & TEMP::primaryNodesCreatorNodeIsLocked & " — of the default primary node — " & TEMP::DEFAULTNodePrimaryName & " — is locked. A) Click 'lock' to unlock it, B) select an unlocked node for the primary node, or C) create a new primary node."; Default Button: “OK”, Commit: “Yes”; Button 2: “new primary”, Commit: “No” ]
    Else
    Show Custom Dialog [ Message: "The creator — " & TEMP::primaryNodesCreatorNodeIsLocked & " — of the default primary node — " & TEMP::DEFAULTNodePrimaryName & " — is locked. Go to the Default Node Tag Menu and A) click 'lock' to unlock it, B) select an unlocked node for the primary node, or C) create a new primary node."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #If the user decides to create a new primary
    #record then proceed to do so.
    If [ Get (LastMessageChoice) = 2 ]
    Show Custom Dialog [ Message: "A new node to assign to yourself will now be created, allowing you to make new records, tags, etc. If you lock it, all its creations will also be locked."; Default Button: “OK”, Commit: “No”; Button 2: “Cancel”, Commit: “No” ]
    If [ Get (LastMessageChoice) = 2 ]
    Halt Script
    End If
    #
    #This variable tells the create new node script to
    #create a new user node, which is a node that is
    #its own creator, and thus can only be locked
    #directly, versus locked by also locking its creator.
    Set Variable [ $$createNewPrimary; Value:1 ]
    #
    #If user doesn't elect to create a new user node,
    #then halt the script.
    Else
    Halt Script
    End If
    #
    #If the TEST SUBJECT node is locked then stop
    #ALL scripts, and inform the user.
    #(By ALL scripts, I mean the script that used this
    #one to see if running it was OK.)
    Else If [ testSubsectionTestSubjectLock::orderOrLock = "0" or ReportResultTestSubject::orderOrLock ≠ "" or reportTestSubjectLock::orderOrLock = "0" ]
    #
    #If the script that used this script was started
    #by the user on a different layout or window,
    #return to it before informing the user about
    #the locked status of the test subject.
    If [ Get (LayoutName) = "testResult" ]
    Perform Script [ “returnToSubsections” ]
    Else If [ $$checkORaddTestItem = 1 and Get ( WindowName ) = "Test" or $$checkORaddTestItem = 1 and Get ( WindowName ) = "Report" ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Set Variable [ $$checkORaddTestItem ]
    End If
    Show Custom Dialog [ Message: "The test subject — " & TEMP::DEFAULTNodeTestSubjectName & " — is locked. To unlock, A) go back to the setup node tag menu. B) Select this test subject. C) Click 'lock' and enter the password."; Default Button: “OK”, Commit: “Yes” ]
    #
    Halt Script
    #
    #If the LEARN record's node is locked then stop
    #ALL scripts, and inform the user.
    #(By ALL scripts, I mean the script that used this
    #one to see if running it was OK.)
    Else If [ tagTLNodePrimary::orderOrLock = "0" or tagTLReportNodePrimary::orderOrLock = "0" ]
    #
    #Figure out what layout the user is on to
    #retrieve the correct user name to show.
    If [ tagTLNodePrimary::orderOrLock = "0" ]
    Show Custom Dialog [ Message: "This Learn record's creator — " & tagTLNodePrimary::tag & " — is locked. To unlock, A) go back to the setup node tag menu. B) Select this test subject. C) Click 'lock' and enter the password."; Default Button: “OK”, Commit: “Yes” ]
    Else If [ tagTLReportNodePrimary::orderOrLock = "0" ]
    Show Custom Dialog [ Message: "This Learn record's creator — " & tagTLReportNodePrimary::tag & " — is locked. To unlock, A) go back to the setup node tag menu. B) Select this test subject. C) Click 'lock' and enter the password."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    Halt Script
    End If
    #
    #

Fields used in this script

    TEMP::primaryNodeIsLocked
    TEMP::DEFAULTNodePrimaryName
    TEMP::primaryNodesCreatorNodeIsLocked
    testSubsectionTestSubjectLock::orderOrLock
    ReportResultTestSubject::orderOrLock
    reportTestSubjectLock::orderOrLock
    TEMP::DEFAULTNodeTestSubjectName
    tagTLNodePrimary::orderOrLock
    tagTLReportNodePrimary::orderOrLock
    tagTLNodePrimary::tag
    tagTLReportNodePrimary::tag

Scripts used in this script

    returnToSubsections

Layouts used in this script

Tables used in this script

    TEMP
    tag

Table occurrences used by this script

    ReportResultTestSubject
    TEMP
    reportTestSubjectLock
    tagTLNodePrimary
    tagTLReportNodePrimary
    testSubsectionTestSubjectLock

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [stopLockedNodesRecordsBeingDeleted]	Parent Folder: [sharedLayoutScripts]	Next Script: [stopNewRecordsBeingCreatedByLockedNode]
Script Name	stopLockedRecordsFromBeingDeleted
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #If node is currenlty locked then stop script,
    #and inform the user.
    If [ tagCreatorLock::orderOrLock ≠ "" ]
    Show Custom Dialog [ Message: "This record is locked. Go the node that created it — " & tagCreatorLock::tag & " — in the setup tag window and enter the password to unlock it."; Default Button: “OK”, Commit: “Yes” ]
    Halt Script
    End If
    #

Fields used in this script

    tagCreatorLock::orderOrLock
    tagCreatorLock::tag

Scripts used in this script

Layouts used in this script

Tables used in this script

    tag

Table occurrences used by this script

    tagCreatorLock

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [stopLockedRecordsFromBeingDeleted]	Parent Folder: [sharedLayoutScripts]	Next Script: [toggleMainWindowView]
Script Name	stopNewRecordsBeingCreatedByLockedNode
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    duplicateLearnRecord
    newLearn
    setupReference_New
    duplicateReferenceRecord
    newLocationRecord
    newReference
    duplicateBrainstorm
    newTagMenuTag
    newTagMenuTagGroup
    newTag
    newRowOfPhotos
    duplicateSectionFromTemplate
    newSection
    newSectionFromTemplate
    newSubsection
    newSubsectionGroup
    newTestItem
    newTestItemGroup
    gotoTestResults
    newTestResult
    reportNewTestResult
    testSubsectionNA

Script Definition
Script Steps

    #
    #
    #Scripts that use this script —
    #duplicateLearnRecord,
    #duplicateReferenceRecord,
    #duplicateSectionFromTemplate,
    #duplicateBrainstorm, itemNA, newLearn,
    #learnOpenTextNewWindow,
    #newReference, newRowOfPhotos, newSection,
    #newSectionFromTemplate, newTag,
    #newTagMenuTag. newTagMenuTagGroup,
    #newTest, newTestGroup, newTestItem,
    #newTestItemGroup, newTestResult,
    #newTestSection, newTestSubsection,
    #reportNewTestResult.
    #CHECK THE DDR! To get the most uptodate
    #list of scripts currently using this one!
    #
    #
    #If the PRIMARY node is currenlty locked then
    #stop ALL scripts, and inform the user.
    #(By ALL scripts, I mean the script that used this
    #one to see if running it was OK.)
    If [ TEMP::primaryNodeIsLocked ≠ "" ]
    If [ Left ( Get (LayoutName) ; 11 ) = "defaultNode" ]
    Show Custom Dialog [ Message: "The default primary node — " & TEMP::DEFAULTNodePrimaryName & " — is locked. A) Click 'lock' to unlock it, B) select an unlocked node for the primary node, or C) create a new primary node."; Default Button: “OK”, Commit: “Yes”; Button 2: “new primary”, Commit: “No” ]
    Else
    Show Custom Dialog [ Message: "The default primary node — " & TEMP::DEFAULTNodePrimaryName & " — is locked. Go to the Default Node Tag Menu and A) click 'lock' to unlock it, B) select an unlocked node for the primary node, or C) create a new primary node."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #If the user decides to create a new primary
    #record then proceed to do so.
    If [ Get (LastMessageChoice) = 2 ]
    Show Custom Dialog [ Message: "A new node to assign to yourself will now be created, allowing you to make new records, tags, etc. If you lock it, all its creations will also be locked."; Default Button: “OK”, Commit: “Yes”; Button 2: “Cancel”, Commit: “No” ]
    If [ Get (LastMessageChoice) = 2 ]
    Halt Script
    End If
    #
    #This variable tells the create new node script to
    #create a new user node, which is a node that is
    #its own creator, and thus can only be locked
    #directly, versus locked by also locking its creator.
    Set Variable [ $$createNewPrimary; Value:1 ]
    #
    #If user doesn't elect to create a new user node,
    #then halt the script.
    Else
    Halt Script
    End If
    #
    #If the primary node's CREATOR node is
    #currenlty locked then stop ALL scripts, and
    #inform the user.
    #(By ALL scripts, I mean the script that used this
    #one to see if running it was OK.)
    Else If [ TEMP::primaryNodesCreatorNodeIsLocked ≠ "" ]
    If [ Left ( Get (LayoutName) ; 11 ) = "defaultNode" ]
    Show Custom Dialog [ Message: "The creator — " & TEMP::primaryNodesCreatorNodeIsLocked & " — of the default primary node — " & TEMP::DEFAULTNodePrimaryName & " — is locked. A) Click 'lock' to unlock it, B) select an unlocked node for the primary node, or C) create a new primary node."; Default Button: “OK”, Commit: “Yes”; Button 2: “new primary”, Commit: “No” ]
    Else
    Show Custom Dialog [ Message: "The creator — " & TEMP::primaryNodesCreatorNodeIsLocked & " — of the default primary node — " & TEMP::DEFAULTNodePrimaryName & " — is locked. Go to the Default Node Tag Menu and A) click 'lock' to unlock it, B) select an unlocked node for the primary node, or C) create a new primary node."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #If the user decides to create a new primary
    #record then proceed to do so.
    If [ Get (LastMessageChoice) = 2 ]
    Show Custom Dialog [ Message: "A new node to assign to yourself will now be created, allowing you to make new records, tags, etc. If you lock it, all its creations will also be locked."; Default Button: “OK”, Commit: “No”; Button 2: “Cancel”, Commit: “No” ]
    If [ Get (LastMessageChoice) = 2 ]
    Halt Script
    End If
    #
    #This variable tells the create new node script to
    #create a new user node, which is a node that is
    #its own creator, and thus can only be locked
    #directly, versus locked by also locking its creator.
    Set Variable [ $$createNewPrimary; Value:1 ]
    #
    #If user doesn't elect to create a new user node,
    #then halt the script.
    Else
    Halt Script
    End If
    #
    #If the TEST SUBJECT node is locked then stop
    #ALL scripts, and inform the user.
    #(By ALL scripts, I mean the script that used this
    #one to see if running it was OK.)
    Else If [ testSubsectionTestSubjectLock::orderOrLock = "0" or ReportResultTestSubject::orderOrLock ≠ "" or reportTestSubjectLock::orderOrLock = "0" or TEMP::testSubjectNodeIsLocked ≠ "" and Get ( LayoutName ) = "defaultTestNewSection" ]
    #
    #Get the current test subject's name.
    Set Variable [ $testSubjectName; Value:Case ( testSubsectionTestSubjectLock::orderOrLock = "0" ; testSubsectionTestSubjectLock::tag ; ReportResultTestSubject::orderOrLock ≠ "" ; ReportResultTestSubject::tag ; reportTestSubjectLock::orderOrLock = "0" ; reportTestSubjectLock::tag ; TEMP::testSubjectNodeIsLocked ≠ "" ; TEMP::DEFAULTNodeTestSubjectName ) ]
    #
    #If the script that used this script was started
    #by the user on a different layout or window,
    #return to it before informing the user about
    #the locked status of the test subject.
    If [ Get (LayoutName) = "testResult" ]
    Perform Script [ “returnToSubsections” ]
    Else If [ $$checkORaddTestItem = 1 and Get ( WindowName ) = "Test" or $$checkORaddTestItem = 1 and Get ( WindowName ) = "Report" ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Set Variable [ $$checkORaddTestItem ]
    End If
    Set Variable [ $$highlightTestSubject; Value:1 ]
    Refresh Window
    Show Custom Dialog [ Message: "The test subject — " & $testSubjectName & " — is locked. To unlock, A) go back to the setup node tag menu. B) Select this test subject. C) Click 'lock' and enter the password."; Default Button: “OK”, Commit: “Yes” ]
    Set Variable [ $$highlightTestSubject ]
    Refresh Window
    #
    Halt Script
    #
    #If the LEARN record's node is locked then stop
    #ALL scripts, and inform the user.
    #(By ALL scripts, I mean the script that used this
    #one to see if running it was OK.)
    Else If [ tagTLNodePrimary::orderOrLock = "0" or tagTLReportNodePrimary::orderOrLock = "0" ]
    #
    #Figure out what layout the user is on to
    #retrieve the correct user name to show.
    If [ tagTLNodePrimary::orderOrLock = "0" ]
    Show Custom Dialog [ Message: "This Learn record's creator — " & tagTLNodePrimary::tag & " — is locked. To unlock, A) go back to the setup node tag menu. B) Select this test subject. C) Click 'lock' and enter the password."; Default Button: “OK”, Commit: “Yes” ]
    Else If [ tagTLReportNodePrimary::orderOrLock = "0" ]
    Show Custom Dialog [ Message: "This Learn record's creator — " & tagTLReportNodePrimary::tag & " — is locked. To unlock, A) go back to the setup node tag menu. B) Select this test subject. C) Click 'lock' and enter the password."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    Halt Script
    End If
    #
    #

Fields used in this script

    TEMP::primaryNodeIsLocked
    TEMP::DEFAULTNodePrimaryName
    TEMP::primaryNodesCreatorNodeIsLocked
    testSubsectionTestSubjectLock::orderOrLock
    ReportResultTestSubject::orderOrLock
    reportTestSubjectLock::orderOrLock
    TEMP::testSubjectNodeIsLocked
    testSubsectionTestSubjectLock::tag
    ReportResultTestSubject::tag
    reportTestSubjectLock::tag
    TEMP::DEFAULTNodeTestSubjectName
    tagTLNodePrimary::orderOrLock
    tagTLReportNodePrimary::orderOrLock
    tagTLNodePrimary::tag
    tagTLReportNodePrimary::tag

Scripts used in this script

    returnToSubsections

Layouts used in this script

Tables used in this script

    TEMP
    tag

Table occurrences used by this script

    ReportResultTestSubject
    TEMP
    reportTestSubjectLock
    tagTLNodePrimary
    tagTLReportNodePrimary
    testSubsectionTestSubjectLock

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [stopNewRecordsBeingCreatedByLockedNode]	Parent Folder: [sharedLayoutScripts]
Script Name	toggleMainWindowView
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    learn0
    learnStuff0
    learn1
    learnStuff1
    learn2
    learnStuff2
    learn3
    learnStuff3
    learn4
    learnStuff4
    learn5
    learnStuff5

Scripts that use this script

Script Definition
Script Steps

    #
    #Reveal more or fewer pictures and links for tag.
    #First toggle from current view to next view.
    #Turn off loadRecord script to speed up process.
    Set Variable [ $$stopLoadCitation; Value:1 ]
    #
    #from 0 to 1
    If [ Right ( Get (LayoutName) ; 1) = 0 and Left ( TEMP::layoutLmain ; 4 ) = "more" ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Go to Layout [ “learn1” (testlearn) ]
    Else
    Go to Layout [ “learnStuff1” (testlearn) ]
    End If
    #
    #from 1 to 2
    Else If [ Right ( Get (LayoutName) ; 1) = 1 and Left ( TEMP::layoutLmain ; 4 ) = "more" ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Go to Layout [ “learn2” (testlearn) ]
    Else
    Go to Layout [ “learnStuff2” (testlearn) ]
    End If
    #
    #from 2 to 3
    Else If [ Right ( Get (LayoutName) ; 1) = 2 and Left ( TEMP::layoutLmain ; 4 ) = "more" ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Go to Layout [ “learn3” (testlearn) ]
    Else
    Go to Layout [ “learnStuff3” (testlearn) ]
    End If
    #
    #from 3 to 4
    Else If [ Right ( Get (LayoutName) ; 1) = 3 and Left ( TEMP::layoutLmain ; 4 ) = "more" ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Go to Layout [ “learn4” (testlearn) ]
    Else
    Go to Layout [ “learnStuff4” (testlearn) ]
    End If
    #
    #from 4 to 5
    Else If [ Right ( Get (LayoutName) ; 1) = 4 and Left ( TEMP::layoutLmain ; 4 ) = "more" ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Go to Layout [ “learn5” (testlearn) ]
    Else
    Go to Layout [ “learnStuff5” (testlearn) ]
    End If
    #
    #from 5 to 4
    Else If [ Right ( Get (LayoutName) ; 1) = 5 and Left ( TEMP::layoutLmain ; 4 ) = "less" ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Go to Layout [ “learn4” (testlearn) ]
    Else
    Go to Layout [ “learnStuff4” (testlearn) ]
    End If
    #
    #from 4 to 3
    Else If [ Right ( Get (LayoutName) ; 1) = 4 and Left ( TEMP::layoutLmain ; 4 ) = "less" ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Go to Layout [ “learn3” (testlearn) ]
    Else
    Go to Layout [ “learnStuff3” (testlearn) ]
    End If
    #
    #from 3 to 2
    Else If [ Right ( Get (LayoutName) ; 1) = 3 and Left ( TEMP::layoutLmain ; 4 ) = "less" ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Go to Layout [ “learn2” (testlearn) ]
    Else
    Go to Layout [ “learnStuff2” (testlearn) ]
    End If
    #
    #from 2 to 1
    Else If [ Right ( Get (LayoutName) ; 1) = 2 and Left ( TEMP::layoutLmain ; 4 ) = "less" ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Go to Layout [ “learn1” (testlearn) ]
    Else
    Go to Layout [ “learnStuff1” (testlearn) ]
    End If
    #
    #from 1 to 0
    Else If [ Right ( Get (LayoutName) ; 1) = 1 and Left ( TEMP::layoutLmain ; 4 ) = "less" ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Go to Layout [ “learn0” (testlearn) ]
    Else
    Go to Layout [ “learnStuff0” (testlearn) ]
    End If
    End If
    #
    #Remember layout user is on so they can be
    #returned to correct view.
    #Turn on loadRecord script needed for other scripts.
    Set Variable [ $$stopLoadCitation ]
    #
    #from 0 to 1
    If [ Right ( Get (LayoutName) ; 1) = 1 and Left ( TEMP::layoutLmain ; 4 ) = "more" ]
    Set Field [ TEMP::layoutLmain; "more" & Get (LayoutName) ]
    #from 1 to 2
    Else If [ Right ( Get (LayoutName) ; 1) = 2 and Left ( TEMP::layoutLmain ; 4 ) = "more" ]
    Set Field [ TEMP::layoutLmain; "more" & Get (LayoutName) ]
    #from 2 to 3
    Else If [ Right ( Get (LayoutName) ; 1) = 3 and Left ( TEMP::layoutLmain ; 4 ) = "more" ]
    Set Field [ TEMP::layoutLmain; "more" & Get (LayoutName) ]
    #from 3 to 4
    Else If [ Right ( Get (LayoutName) ; 1) = 4 and Left ( TEMP::layoutLmain ; 4 ) = "more" ]
    Set Field [ TEMP::layoutLmain; "more" & Get (LayoutName) ]
    #from 4 to 5
    Else If [ Right ( Get (LayoutName) ; 1) = 5 and Left ( TEMP::layoutLmain ; 4 ) = "more" ]
    Set Field [ TEMP::layoutLmain; "less" & Get (LayoutName) ]
    #from 5 to 4
    Else If [ Right ( Get (LayoutName) ; 1) = 4 and Left ( TEMP::layoutLmain ; 4 ) = "less" ]
    Set Field [ TEMP::layoutLmain; "less" & Get (LayoutName) ]
    #from 4 to 3
    Else If [ Right ( Get (LayoutName) ; 1) = 3 and Left ( TEMP::layoutLmain ; 4 ) = "less" ]
    Set Field [ TEMP::layoutLmain; "less" & Get (LayoutName) ]
    #from 3 to 2
    Else If [ Right ( Get (LayoutName) ; 1) = 2 and Left ( TEMP::layoutLmain ; 4 ) = "less" ]
    Set Field [ TEMP::layoutLmain; "less" & Get (LayoutName) ]
    #from 2 to 1
    Else If [ Right ( Get (LayoutName) ; 1) = 1 and Left ( TEMP::layoutLmain ; 4 ) = "less" ]
    Set Field [ TEMP::layoutLmain; "less" & Get (LayoutName) ]
    #from 1 to 0
    Else If [ Right ( Get (LayoutName) ; 1) = 0 and Left ( TEMP::layoutLmain ; 4 ) = "less" ]
    Set Field [ TEMP::layoutLmain; "more" & Get (LayoutName) ]
    End If
    #
    #This scrolling step is affect brainstorm view
    #when viewing brainstorm tags. Disabling it
    #seems to accomplish what these two steps are
    #supposed to do, which is keep selected record
    #showing. Not sure why it was put in. Further
    #testing is required before removing it, as in
    #some contexts it might be required, in which
    #case a sort just for brainstorm tags will need
    #to be included as well.
    // #Bring selected record to the top.
    // Scroll Window [ End ]
    // Sort Records [ ] [ No dialog ]
    #

Fields used in this script

    TEMP::layoutLmain
    TEMP::InventoryLibraryYN

Scripts used in this script

Layouts used in this script

    learn1
    learnStuff1
    learn2
    learnStuff2
    learn3
    learnStuff3
    learn4
    learnStuff4
    learn5
    learnStuff5
    learn0
    learnStuff0

Tables used in this script

    TEMP

Table occurrences used by this script

    TEMP

Custom Functions used by this script

Custom menu set used by this script


startclose
	Parent Folder: [startclose]	Next Script: [CHUNK_CopyrightLockedFields]
Script Name	CHUNK_checkCreatorNodeAndPrimaryNode
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    startDatabase
    defaultNodeMenu

Script Definition
Script Steps

    #
    #PURPOSE: Restores library's creator node If
    #accidently deleted while in admin mode, and
    #checks to see if primary node's creator is locked.
    #
    #Admin tasks.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #Get creator node information from
    #library record.
    Go to Layout [ “tableTagGroup” (testSubsectionGroup) ]
    Perform Find [ Specified Find Requests: Find Records; Criteria: testSubsectionGroup::match: “"library"” ] [ Restore ]
    If [ Get (FoundCount) = 0 ]
    Show Custom Dialog [ Message: "This library's library ID record has been deleted. It will no longer work. If it has records, then import them into a new library. "; Default Button: “OK”, Commit: “Yes” ]
    Show Custom Dialog [ Message: "If you can, check the creator node key fields for records in this library, and make sure there is a creator node for them, and if not, re-create one."; Default Button: “OK”, Commit: “Yes” ]
    Close Window [ Current Window ]
    Set Field [ TEMP::kdefaultNodeOther; "" ]
    Set Field [ TEMP::kdefaultCopyright; "" ]
    Halt Script
    End If
    Set Variable [ $node; Value:testSubsectionGroup::kRecordCreatorNode ]
    Set Variable [ $nodeName; Value:testSubsectionGroup::ReportCaptionORLibraryCreatorName ]
    Set Variable [ $group; Value:testSubsectionGroup::orderOrLibraryType ]
    Set Variable [ $groupName; Value:testSubsectionGroup::nameSpellingFORTestItemGroup ]
    #
    #Make sure the creator node's group exists.
    Enter Find Mode [ ]
    Set Field [ testSubsectionGroup::_Lgroup; $group ]
    Perform Find [ ]
    #
    #If not, recreate this group.
    If [ Get (FoundCount) = 0 ]
    New Record/Request
    Set Field [ testSubsectionGroup::match; "node" ]
    Set Field [ testSubsectionGroup::kRecordCreatorNode; $node ]
    Set Field [ testSubsectionGroup::_Lgroup; $group ]
    Set Field [ testSubsectionGroup::nameSpellingEXCEPTForTestItemGroup; $groupName ]
    Set Field [ testSubsectionGroup::nameSpellingFORTestItemGroup; $groupName ]
    End If
    #
    #Make sure the creator node exists.
    Go to Layout [ “tableTag” (tagTable) ]
    Enter Find Mode [ ]
    Set Field [ tagTable::_Ltag; $node ]
    Perform Find [ ]
    #
    #If not, recreate this node.
    If [ Get (FoundCount) = 0 ]
    New Record/Request
    Set Field [ tagTable::_Ltag; $node ]
    Set Field [ tagTable::match; "node" ]
    Set Field [ tagTable::kGroupOrTest; $group ]
    Set Field [ tagTable::tag; $nodeName ]
    Set Field [ tagTable::tagSpelling; $nodeName ]
    Set Field [ tagTable::kRecordCreatorNode; $node ]
    End If
    #
    #
    #
    #
    #See primary node's creator is locked.
    #
    If [ tempSetup::DEFAULTNodePrimaryName ≠ "" ]
    #Do not load tag records until the end of script
    #to prevent flashing of window and to speed up
    #script.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    #
    #Find the pimary node if there is one.
    Go to Layout [ “defaultNode1” (tagMenus) ]
    Enter Find Mode [ ]
    Set Field [ tagMenus::_Ltag; tempSetup::kdefaultNodePrimary ]
    Perform Find [ ]
    #
    #Note primary node's creator if it is locked,
    #and clear it if not locked.
    If [ primaryNodesCreatorLock::orderOrLock ≠ "" ]
    Set Field [ tempSetup::primaryNodesCreatorNodeIsLocked; primaryNodesCreatorLock::tag ]
    Set Field [ tempSetup::kdefaultNodePrimaryCreator; primaryNodesCreatorLock::_Ltag ]
    Else
    Set Field [ tempSetup::primaryNodesCreatorNodeIsLocked; "" ]
    Set Field [ tempSetup::kdefaultNodePrimaryCreator; "" ]
    End If
    End If
    #
    Set Variable [ $$stopLoadTagRecord ]
    #
    #

Fields used in this script

    testSubsectionGroup::match
    TEMP::kdefaultNodeOther
    TEMP::kdefaultCopyright
    testSubsectionGroup::kRecordCreatorNode
    testSubsectionGroup::ReportCaptionORLibraryCreatorName
    testSubsectionGroup::orderOrLibraryType
    testSubsectionGroup::nameSpellingFORTestItemGroup
    testSubsectionGroup::_Lgroup
    testSubsectionGroup::nameSpellingEXCEPTForTestItemGroup
    tagTable::_Ltag
    tagTable::match
    tagTable::kGroupOrTest
    tagTable::tag
    tagTable::tagSpelling
    tagTable::kRecordCreatorNode
    tempSetup::DEFAULTNodePrimaryName
    tempSetup::kdefaultNodePrimary
    tagMenus::_Ltag
    primaryNodesCreatorLock::orderOrLock
    primaryNodesCreatorLock::tag
    tempSetup::primaryNodesCreatorNodeIsLocked
    primaryNodesCreatorLock::_Ltag
    tempSetup::kdefaultNodePrimaryCreator

Scripts used in this script

Layouts used in this script

    tableTagGroup
    tableTag
    defaultNode1

Tables used in this script

    TEMP
    TEMP
    tag
    tag
    tagGroup

Table occurrences used by this script

    TEMP
    primaryNodesCreatorLock
    tagMenus
    tagTable
    tempSetup
    testSubsectionGroup

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [CHUNK_checkCreatorNodeAndPrimaryNode]	Parent Folder: [startclose]	Next Script: [New Script]
Script Name	CHUNK_CopyrightLockedFields
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    startDatabase

Script Definition
Script Steps

    #
    #
    #Admin tasks.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    #
    #
    #Refresh copyright groups by deleting them
    #and then recreating them.
    Go to Layout [ “tableTagGroup” (testSubsectionGroup) ]
    Perform Find [ Specified Find Requests: Find Records; Criteria: testSubsectionGroup::orderOrLibraryType: “"lock"” ] [ Restore ]
    If [ Get ( LastError ) = 0 ]
    Delete All Records [ No dialog ]
    End If
    #
    #0 Share - all copyrights given up by creator
    New Record/Request
    Set Field [ testSubsectionGroup::orderOrLibraryType; "lock" ]
    Set Field [ testSubsectionGroup::match; "copyright" ]
    Set Field [ testSubsectionGroup::kRecordCreatorNode; "defaultCopyrightGroup" ]
    #1308
    Set Field [ testSubsectionGroup::_Number; 1308 ]
    Set Field [ testSubsectionGroup::_Lgroup; 31620121911511308 ]
    Set Variable [ $name; Value:"0 Share - all copyrights given up by creator" ]
    Set Field [ testSubsectionGroup::name; $name ]
    Set Field [ testSubsectionGroup::nameSpellingEXCEPTForTestItemGroup; $name ]
    #
    #1a Share - public domain possibly everywhere
    New Record/Request
    Set Field [ testSubsectionGroup::orderOrLibraryType; "lock" ]
    Set Field [ testSubsectionGroup::match; "copyright" ]
    Set Field [ testSubsectionGroup::kRecordCreatorNode; "defaultCopyrightGroup" ]
    #1306
    Set Field [ testSubsectionGroup::_Number; 1308 ]
    Set Field [ testSubsectionGroup::_Lgroup; 31620121853131306 ]
    Set Variable [ $name; Value:"1a Share - public domain possibly everywhere" ]
    Set Field [ testSubsectionGroup::name; $name ]
    Set Field [ testSubsectionGroup::nameSpellingEXCEPTForTestItemGroup; $name ]
    #
    #1b Share - public domain in some places, not all
    New Record/Request
    Set Field [ testSubsectionGroup::orderOrLibraryType; "lock" ]
    Set Field [ testSubsectionGroup::match; "copyright" ]
    Set Field [ testSubsectionGroup::kRecordCreatorNode; "defaultCopyrightGroup" ]
    #554
    Set Field [ testSubsectionGroup::_Number; 554 ]
    Set Field [ testSubsectionGroup::_Lgroup; 8172011134941554 ]
    Set Variable [ $name; Value:"1b Share - public domain in some places, not all" ]
    Set Field [ testSubsectionGroup::name; $name ]
    Set Field [ testSubsectionGroup::nameSpellingEXCEPTForTestItemGroup; $name ]
    #
    #2 Share and give credit CC BY
    New Record/Request
    Set Field [ testSubsectionGroup::orderOrLibraryType; "lock" ]
    Set Field [ testSubsectionGroup::match; "copyright" ]
    Set Field [ testSubsectionGroup::kRecordCreatorNode; "defaultCopyrightGroup" ]
    #1302
    Set Field [ testSubsectionGroup::_Number; 1302 ]
    Set Field [ testSubsectionGroup::_Lgroup; 31620121746441302 ]
    Set Variable [ $name; Value:"2 Share and give credit" ]
    Set Field [ testSubsectionGroup::name; $name ]
    Set Field [ testSubsectionGroup::nameSpellingEXCEPTForTestItemGroup; $name ]
    #
    #3 Share, give credit, and use the same copyright license CC BY-SA
    New Record/Request
    Set Field [ testSubsectionGroup::orderOrLibraryType; "lock" ]
    Set Field [ testSubsectionGroup::match; "copyright" ]
    Set Field [ testSubsectionGroup::kRecordCreatorNode; "defaultCopyrightGroup" ]
    #1305
    Set Field [ testSubsectionGroup::_Number; 1305 ]
    Set Field [ testSubsectionGroup::_Lgroup; 31620121841541305 ]
    Set Variable [ $name; Value:"3 Share, give credit, and use the same copyright license" ]
    Set Field [ testSubsectionGroup::name; $name ]
    Set Field [ testSubsectionGroup::nameSpellingEXCEPTForTestItemGroup; $name ]
    #
    #4 Share, give credit, and don’t change CC BY-ND
    New Record/Request
    Set Field [ testSubsectionGroup::orderOrLibraryType; "lock" ]
    Set Field [ testSubsectionGroup::match; "copyright" ]
    Set Field [ testSubsectionGroup::kRecordCreatorNode; "defaultCopyrightGroup" ]
    #1307
    Set Field [ testSubsectionGroup::_Number; 1307 ]
    Set Field [ testSubsectionGroup::_Lgroup; 31620121902441307 ]
    Set Variable [ $name; Value:"4 Share, give credit, and don’t change" ]
    Set Field [ testSubsectionGroup::name; $name ]
    Set Field [ testSubsectionGroup::nameSpellingEXCEPTForTestItemGroup; $name ]
    #
    #5 Share, give credit, and don’t sell CC BY-NC
    New Record/Request
    Set Field [ testSubsectionGroup::orderOrLibraryType; "lock" ]
    Set Field [ testSubsectionGroup::match; "copyright" ]
    Set Field [ testSubsectionGroup::kRecordCreatorNode; "defaultCopyrightGroup" ]
    #1304
    Set Field [ testSubsectionGroup::_Number; 1304 ]
    Set Field [ testSubsectionGroup::_Lgroup; 31620121837161304 ]
    Set Variable [ $name; Value:"5 Share, give credit, and don’t sell" ]
    Set Field [ testSubsectionGroup::name; $name ]
    Set Field [ testSubsectionGroup::nameSpellingEXCEPTForTestItemGroup; $name ]
    #
    #6 Share, give credit, don’t sell, and use the same copyright license CC BY-NC-SA
    New Record/Request
    Set Field [ testSubsectionGroup::orderOrLibraryType; "lock" ]
    Set Field [ testSubsectionGroup::match; "copyright" ]
    Set Field [ testSubsectionGroup::kRecordCreatorNode; "defaultCopyrightGroup" ]
    #553
    Set Field [ testSubsectionGroup::_Number; 553 ]
    Set Field [ testSubsectionGroup::_Lgroup; 8162011231825553 ]
    Set Variable [ $name; Value:"6 Share, give credit, don’t sell, and use the same copyright license" ]
    Set Field [ testSubsectionGroup::name; $name ]
    Set Field [ testSubsectionGroup::nameSpellingEXCEPTForTestItemGroup; $name ]
    #
    #7 Share, give credit, don’t sell, don't change CC BY-NC-ND
    New Record/Request
    Set Field [ testSubsectionGroup::orderOrLibraryType; "lock" ]
    Set Field [ testSubsectionGroup::match; "copyright" ]
    Set Field [ testSubsectionGroup::kRecordCreatorNode; "defaultCopyrightGroup" ]
    #1303
    Set Field [ testSubsectionGroup::_Number; 1303 ]
    Set Field [ testSubsectionGroup::_Lgroup; 31620121824141303 ]
    Set Variable [ $name; Value:"7 Share, give credit, don’t sell, don't change" ]
    Set Field [ testSubsectionGroup::name; $name ]
    Set Field [ testSubsectionGroup::nameSpellingEXCEPTForTestItemGroup; $name ]
    #
    #8 Don’t share - personal use only
    New Record/Request
    Set Field [ testSubsectionGroup::orderOrLibraryType; "lock" ]
    Set Field [ testSubsectionGroup::match; "copyright" ]
    Set Field [ testSubsectionGroup::kRecordCreatorNode; "defaultCopyrightGroup" ]
    #540
    Set Field [ testSubsectionGroup::_Number; 540 ]
    Set Field [ testSubsectionGroup::_Lgroup; 8102011220941540 ]
    Set Variable [ $name; Value:"8 Don’t share - personal use only" ]
    Set Field [ testSubsectionGroup::name; $name ]
    Set Field [ testSubsectionGroup::nameSpellingEXCEPTForTestItemGroup; $name ]
    #
    #Trademark, Service Mark, Logo, Etc.
    New Record/Request
    Set Field [ testSubsectionGroup::orderOrLibraryType; "lock" ]
    Set Field [ testSubsectionGroup::match; "copyright" ]
    Set Field [ testSubsectionGroup::kRecordCreatorNode; "defaultCopyrightGroup" ]
    #1809
    Set Field [ testSubsectionGroup::_Number; 1809 ]
    Set Field [ testSubsectionGroup::_Lgroup; 92020171119521809 ]
    Set Variable [ $name; Value:"Trademark, Service Mark, Logo, Etc." ]
    Set Field [ testSubsectionGroup::name; $name ]
    Set Field [ testSubsectionGroup::nameSpellingEXCEPTForTestItemGroup; $name ]
    #
    #
    #
    #
    #
    #
    #
    #Refresh locked tag records (filelocation,
    #inventory location headers, and copyright
    #records) by deleting them and then
    #recreating them.
    Go to Layout [ “tableTag” (tagTable) ]
    Perform Find [ Specified Find Requests: Find Records; Criteria: tagTable::orderOrLock: “"lock"” ] [ Restore ]
    Delete All Records [ No dialog ]
    #
    #
    #
    #
    #
    #
    #Refresh filelocation records for Reference
    #edit layouts' location checkboxes.
    New Record/Request
    Set Field [ tagTable::tag; "x" ]
    Set Field [ tagTable::_Number; 313 ]
    Set Field [ tagTable::tagSpelling; "x" ]
    Set Field [ tagTable::orderOrLock; "lock" ]
    Set Field [ tagTable::match; "fileLocation" ]
    Set Field [ tagTable::_Ltag; "8162011225532313" ]
    Set Field [ tagTable::kRecordCreatorNode; "defaultFilePathCheckBox" ]
    #
    New Record/Request
    Set Field [ tagTable::tag; "main" ]
    Set Field [ tagTable::_Number; 314 ]
    Set Field [ tagTable::tagSpelling; "main" ]
    Set Field [ tagTable::orderOrLock; "lock" ]
    Set Field [ tagTable::match; "fileLocation" ]
    Set Field [ tagTable::_Ltag; "8162011225558314" ]
    Set Field [ tagTable::kRecordCreatorNode; "defaultFilePathCheckBox" ]
    #
    New Record/Request
    Set Field [ tagTable::tag; "other" ]
    Set Field [ tagTable::_Number; 315 ]
    Set Field [ tagTable::tagSpelling; "other" ]
    Set Field [ tagTable::orderOrLock; "lock" ]
    Set Field [ tagTable::match; "fileLocation" ]
    Set Field [ tagTable::_Ltag; "8162011225605315" ]
    Set Field [ tagTable::kRecordCreatorNode; "defaultFilePathCheckBox" ]
    #
    #
    #
    #
    #
    #
    #
    #Refresh inventory library's 3 location groups.
    New Record/Request
    Set Field [ tagTable::tag; "primary location" ]
    Set Field [ tagTable::_Number; 3386 ]
    Set Field [ tagTable::tagSpelling; "primary location" ]
    Set Field [ tagTable::orderOrLock; "lock" ]
    Set Field [ tagTable::match; "location" ]
    Set Field [ tagTable::_Ltag; "31120182009273386" ]
    Set Field [ tagTable::kRecordCreatorNode; "defaultLocation" ]
    #
    New Record/Request
    Set Field [ tagTable::tag; "secondary location" ]
    Set Field [ tagTable::_Number; 3387 ]
    Set Field [ tagTable::tagSpelling; "secondary location" ]
    Set Field [ tagTable::orderOrLock; "lock" ]
    Set Field [ tagTable::match; "location" ]
    Set Field [ tagTable::_Ltag; "31120182009473387" ]
    Set Field [ tagTable::kRecordCreatorNode; "defaultLocation" ]
    #
    New Record/Request
    Set Field [ tagTable::tag; "tertiary location" ]
    Set Field [ tagTable::_Number; 3388 ]
    Set Field [ tagTable::tagSpelling; "tertiary location" ]
    Set Field [ tagTable::orderOrLock; "lock" ]
    Set Field [ tagTable::match; "location" ]
    Set Field [ tagTable::_Ltag; 31120182009593388 ]
    Set Field [ tagTable::kRecordCreatorNode; "defaultLocation" ]
    #
    #
    #
    #
    #
    #
    #
    #
    #Refresh copyright records.
    #
    #0 Share - all copyrights given up by creator
    New Record/Request
    Set Field [ tagTable::kGroupOrTest; 31620121911511308 ]
    Set Field [ tagTable::match; "copyright" ]
    Set Field [ tagTable::orderOrLock; "lock" ]
    Set Field [ tagTable::kRecordCreatorNode; "defaultCopyright" ]
    #1235
    Set Field [ tagTable::_Number; 1235 ]
    Set Field [ tagTable::_Ltag; 31620121911511235 ]
    Set Variable [ $tag; Value:"CC0 1.0 — Creative Commons Universal Public Domain Dedication " & Quote ( "No Rights Reserved" ) ]
    Set Field [ tagTable::tag; $tag ]
    Set Field [ tagTable::tagSpelling; $tag ]
    Set Field [ tagTable::notesOrCopyright; ¶ & TextSize ( TextColor ( TextFont ( "[NOTE: Click the 'web' button above to view the most current and complete source of the text below, copied on September 22, 2017 from creativecommons.org/publicdomain/zero/1.0/ for your convenience.]" & ¶ ; "Arial" ) ; RGB ( 51 ; 51 ; 51 ) ) ; 16 ) & ¶ & TextStyleAdd ( "CC0 1.0 Universal (CC0 1.0) Universal Public Domain Dedication" ; Bold ) & ¶ & ¶ & "This is a human-readable summary of the Legal Code (read the full text). Disclaimer" & ¶ & ¶ & TextStyleAdd ( "No Copyright" ; Bold ) & ¶ & "The person who associated a work with this deed has dedicated the work to the public domain by waiving all of his or her rights to the work worldwide under copyright law, including all related and neighboring rights, to the extent allowed by law." & ¶ & ¶ & "You can copy, modify, distribute and perform the work, even for commercial purposes, all without asking permission. See Other Information below. " & ¶ & ¶ & TextStyleAdd ( "Other Information" ; Bold ) & ¶ & " • In no way are the patent or trademark rights of any person affected by CC0, nor are the rights that other persons may have in the work or in how the work is used, such as publicity or privacy rights." & ¶ & " • Unless expressly stated otherwise, the person who associated a work with this deed makes no warranties about the work, and disclaims liability for all uses of the work, to the fullest extent permitted by applicable law." & ¶ & " • When using or citing the work, you should not imply endorsement by the author or the affirmer." ]
    Set Field [ tagTable::Ktitle1; 3162012191328147 ]
    Set Field [ tagTable::Kpicture1; 92020172213321496 ]
    #
    #
    #
    #0 Share - all copyrights given up by creator
    New Record/Request
    Set Field [ tagTable::kGroupOrTest; 31620121911511308 ]
    Set Field [ tagTable::match; "copyright" ]
    Set Field [ tagTable::orderOrLock; "lock" ]
    Set Field [ tagTable::kRecordCreatorNode; "defaultCopyright" ]
    #4557
    Set Field [ tagTable::_Number; 4557 ]
    Set Field [ tagTable::_Ltag; 92120171055254557 ]
    Set Variable [ $tag; Value:"PD by Creator — I, the copyright holder of this work, release this work into the public domain. This applies worldwide. In some countries this may not be legally possible; if so: I grant anyone the right to use this work for any purpose, without any conditions, unless such conditions are required by law." ]
    Set Field [ tagTable::tag; $tag ]
    Set Field [ tagTable::tagSpelling; $tag ]
    Set Field [ tagTable::notesOrCopyright; ¶ & TextSize ( TextColor ( TextFont ( "[NOTE: Click the 'web' button above to view the most current and complete source of the text excerpts below, copied on September 22, 2017 from https://commons.wikimedia.org/wiki/Template:PD-self for your convenience.]" & ¶ ; "Arial" ) ; RGB ( 51 ; 51 ; 51 ) ) ; 16 ) & ¶ & TextStyleAdd ( "Template:PD-self" ; Bold ) & ¶ & ¶ & "I, the copyright holder of this work, release this work into the public domain. This applies worldwide. " & ¶ & ¶ & "In some countries this may not be legally possible; if so: " & ¶ & ¶ & "I grant anyone the right to use this work for any purpose, without any conditions, unless such conditions are required by law." ]
    Set Field [ tagTable::Ktitle1; 92120171058331505 ]
    Set Field [ tagTable::Kpicture1; 92120171043101504 ]
    #
    #
    #
    #1a Share - public domain possibly everywhere
    New Record/Request
    Set Field [ tagTable::kGroupOrTest; 31620121853131306 ]
    Set Field [ tagTable::match; "copyright" ]
    Set Field [ tagTable::orderOrLock; "lock" ]
    Set Field [ tagTable::kRecordCreatorNode; "defaultCopyright" ]
    #1228
    Set Field [ tagTable::_Number; 1228 ]
    Set Field [ tagTable::_Ltag; 31620121743201228 ]
    Set Variable [ $tag; Value:"CC PD — Creative Commons Public Domain Mark" ]
    Set Field [ tagTable::tag; $tag ]
    Set Field [ tagTable::tagSpelling; $tag ]
    Set Field [ tagTable::notesOrCopyright; ¶ & TextSize ( TextColor ( TextFont ( "[NOTE: Click the 'web' button above to view the most current and complete source of the text below, copied on September 22, 2017 from creativecommons.org/share-your-work/public-domain/pdm/ for your convenience.]" & ¶ ; "Arial" ) ; RGB ( 51 ; 51 ; 51 ) ) ; 16 ) & ¶ & TextStyleAdd ( "Public Domain Mark" ; Bold ) & ¶ & ¶ & Quote ( "No Known Copyright" ) & ¶ & ¶ & "Our Public Domain Mark enables works that are no longer restricted by copyright to be marked as such in a standard and simple way, making them easily discoverable and available to others. Many cultural heritage institutions including museums, libraries and other curators are knowledgeable about the copyright status of paintings, books and manuscripts, photographs and other works in their collections, many of which are old and no longer under copyright. The Public Domain Mark operates as a tag or a label, allowing institutions like those as well as others with such knowledge to communicate that a work is no longer restricted by copyright and can be freely used by others. The mark can also be an important source of information, allowing others to verify a work’s copyright status and learn more about the work." & ¶ & ¶ & TextStyleAdd ( "Recommended Uses of the Public Domain Mark" ; Bold ) & ¶ & "The Public Domain Mark is recommended for works that are free of known copyright around the world. These will typically be very old works. It is " & TextStyleAdd ( "not" ; Bold ) & " recommended for use with works that are in the public domain in some jurisdictions if they also known to be restricted by copyright in others." & ¶ & ¶ & "A work may have limited or " & Quote ( "hybrid" ) & " public domain status for several reasons. Some jurisdictions have unusually long copyright terms, which may mean that a work free from copyright restrictions most everywhere in the world could still be protected by the copyright laws of that particular country. Sometimes a work is no longer restricted by copyright in a jurisdiction because the author or owner failed to comply with local formalities such as renewal, where those formalities apply. It could also be the case for works that are deemed not protected by copyright by operation of law in a particular jurisdiction, but that are afforded protection under the copyright laws of other jurisdictions." & ¶ & ¶ & "CC does not recommend the Public Domain Mark for works with limited, hybrid public domain status at this time, though we will be exploring means for doing so in 2014." & ¶ & ¶ & TextStyleAdd ( "• Learn more about the Public Domain Mark" ; Bold ) & ¶ & ¶ & TextStyleAdd ( "• Use the Public Domain Mark to label public domain works" ; Bold ) ]
    Set Field [ tagTable::Ktitle1; 1122012003249115 ]
    Set Field [ tagTable::Kpicture1; 92020172201021493 ]
    #
    #
    #
    #1a Share - public domain possibly everywhere
    New Record/Request
    Set Field [ tagTable::kGroupOrTest; 31620121853131306 ]
    Set Field [ tagTable::match; "copyright" ]
    Set Field [ tagTable::orderOrLock; "lock" ]
    Set Field [ tagTable::kRecordCreatorNode; "defaultCopyright" ]
    #9228
    Set Field [ tagTable::_Number; 9228 ]
    Set Field [ tagTable::_Ltag; 91620171343209228 ]
    Set Variable [ $tag; Value:"Ineligible for copyright" ]
    Set Field [ tagTable::tag; $tag ]
    Set Field [ tagTable::tagSpelling; $tag ]
    Set Field [ tagTable::notesOrCopyright; ¶ & TextSize ( TextColor ( TextFont ( "[NOTE: Click the 'web' button above to view the most current and complete source of the text excerpts below, copied on September 22, 2017 from commons.wikimedia.org/wiki/Template:PD-ineligible for your convenience.]" & ¶ ; "Arial" ) ; RGB ( 51 ; 51 ; 51 ) ) ; 16 ) & ¶ & TextStyleAdd ( "Template:PD-ineligible" ; Bold ) & ¶ & ¶ & "This file is ineligible for copyright and is therefore in the public domain because it consists entirely of information that is common property and contains no original authorship. " & ¶ & ¶ & "Use this template to mark a file which you have identified as being ineligible for copyright protection by virtue of it 1.) consisting only of information that is itself in the public domain and 2.) lacking evidence of original authorship/ creative input of any kind. This template should not be used if a more-specific suitable public domain copyright tag is available (e.g., the tag PD-chem for images of chemical compounds or PD-textlogo for ineligible logos). However, the sweat-of-the-brow doctrine means that even complicated images/ files may be ineligible for copyright protection so long as they consist solely of information and are utterly lacking in originality and creativity— in that case, this tag may be appropriate." ]
    Set Field [ tagTable::Ktitle1; 92020172311201501 ]
    Set Field [ tagTable::Kpicture1; 92120171043101504 ]
    #
    #
    #
    #1b Share - public domain in some places, not all
    New Record/Request
    Set Field [ tagTable::kGroupOrTest; 8172011134941554 ]
    Set Field [ tagTable::match; "copyright" ]
    Set Field [ tagTable::orderOrLock; "lock" ]
    Set Field [ tagTable::kRecordCreatorNode; "defaultCopyright" ]
    #376
    Set Field [ tagTable::_Number; 376 ]
    Set Field [ tagTable::_Ltag; 9072011223903376 ]
    Set Variable [ $tag; Value:"PD in USA — Public domain in the United States" ]
    Set Field [ tagTable::tag; $tag ]
    Set Field [ tagTable::tagSpelling; $tag ]
    Set Field [ tagTable::notesOrCopyright; ¶ & TextSize ( TextColor ( TextFont ( "[NOTE: Click the 'web' button above to view the most current and complete source of the text excerpts below, copied on September 22, 2017 from commons.wikimedia.org/wiki/Template:PD-US for your convenience.]" & ¶ ; "Arial" ) ; RGB ( 51 ; 51 ; 51 ) ) ; 16 ) & ¶ & TextStyleAdd ( "Template:PD-US" ; Bold ) & ¶ & ¶ & "This media file is in the public domain in the United States." & ¶ & ¶ & "This applies to U.S. works where the copyright has expired, often because its first publication occurred prior to January 1, 1923." & ¶ & ¶ & "This image might not be in the public domain outside of the United States; this especially applies in the countries and areas that do not apply the rule of the shorter term for US works, such as Canada, Mainland China (not Hong Kong or Macao), Germany, Mexico, and Switzerland. The creator and year of publication are essential information and must be provided. See Wikipedia:Public domain and Wikipedia:Copyrights for more details." ]
    Set Field [ tagTable::Ktitle1; 121920161421511408 ]
    Set Field [ tagTable::Kpicture1; 92120171043101504 ]
    #
    #1b Share - public domain in some places, not all
    New Record/Request
    Set Field [ tagTable::kGroupOrTest; 8172011134941554 ]
    Set Field [ tagTable::match; "copyright" ]
    Set Field [ tagTable::orderOrLock; "lock" ]
    Set Field [ tagTable::kRecordCreatorNode; "defaultCopyright" ]
    #374
    Set Field [ tagTable::_Number; 374 ]
    Set Field [ tagTable::_Ltag; 9072011221202374 ]
    Set Variable [ $tag; Value:"PD 70 — Public domain in country of origin where copyright term is the author's life plus 70 years or less." ]
    Set Field [ tagTable::tag; $tag ]
    Set Field [ tagTable::tagSpelling; $tag ]
    Set Field [ tagTable::notesOrCopyright; ¶ & TextSize ( TextColor ( TextFont ( "[NOTE: Click the 'web' button above to view the most current and complete source of the text excerpts below, copied on September 22, 2017 from commons.wikimedia.org/wiki/Template:PD-old for your convenience.]" & ¶ ; "Arial" ) ; RGB ( 51 ; 51 ; 51 ) ) ; 16 ) & ¶ & TextStyleAdd ( "Template:PD-old" ; Bold ) & ¶ & ¶ & "This work is in the public domain in its country of origin and other countries and areas where the copyright term is the author's life plus 70 years or less. " & ¶ & ¶ & "You must also include a United States public domain tag to indicate why this work is in the public domain in the United States. Note that a few countries have copyright terms longer than 70 years: Mexico has 100 years, Jamaica has 95 years, Colombia has 80 years, and Guatemala and Samoa have 75 years. This image may not be in the public domain in these countries, which moreover do not implement the rule of the shorter term. Côte d'Ivoire has a general copyright term of 99 years and Honduras has 75 years, but they do implement the rule of the shorter term. Copyright may extend on works created by French who died for France in World War II (more information), Russians who served in the Eastern Front of World War II (known as the Great Patriotic War in Russia) and posthumously rehabilitated victims of Soviet repressions (more information)." ]
    Set Field [ tagTable::Ktitle1; 121920161534521409 ]
    Set Field [ tagTable::Kpicture1; 92120171043101504 ]
    #
    #1b Share - public domain in some places, not all
    New Record/Request
    Set Field [ tagTable::kGroupOrTest; 8172011134941554 ]
    Set Field [ tagTable::match; "copyright" ]
    Set Field [ tagTable::orderOrLock; "lock" ]
    Set Field [ tagTable::kRecordCreatorNode; "defaultCopyright" ]
    #1278
    Set Field [ tagTable::_Number; 1278 ]
    Set Field [ tagTable::_Ltag; 42420122157181278 ]
    Set Variable [ $tag; Value:"PD Title 17 — Public domain in the United States because it is a work prepared by an officer or employee of the United States Government as part of that person’s official duties under the terms of Title 17, Chapter 1, Section 105 of the US Code." ]
    Set Field [ tagTable::tag; $tag ]
    Set Field [ tagTable::tagSpelling; $tag ]
    Set Field [ tagTable::notesOrCopyright; ¶ & TextSize ( TextColor ( TextFont ( "[NOTE: Click the 'web' button above to view the most current and complete source of the text excerpts below, copied on September 22, 2017 from commons.wikimedia.org/wiki/Template:PD-USGov for your convenience.]" & ¶ ; "Arial" ) ; RGB ( 51 ; 51 ; 51 ) ) ; 16 ) & ¶ & TextStyleAdd ( "Template:PD-USGov" ; Bold ) & ¶ & ¶ & "This work is in the public domain in the United States because it is a work prepared by an officer or employee of the United States Government as part of that person’s official duties under the terms of Title 17, Chapter 1, Section 105 of the US Code. See Copyright." & ¶ & ¶ & "Note: This only applies to original works of the Federal Government and not to the work of any individual U.S. state, territory, commonwealth, county, municipality, or any other subdivision. This template also does not apply to postage stamp designs published by the United States Postal Service since 1978. (See § 313.6(C)(1) of Compendium of U.S. Copyright Office Practices). It also does not apply to certain US coins; see The US Mint Terms of Use." ]
    Set Field [ tagTable::Ktitle1; 121920161625111411 ]
    Set Field [ tagTable::Kpicture1; 92120171043101504 ]
    #
    #
    #
    #2 Share and give credit CC BY
    New Record/Request
    Set Field [ tagTable::kGroupOrTest; 31620121746441302 ]
    Set Field [ tagTable::match; "copyright" ]
    Set Field [ tagTable::orderOrLock; "lock" ]
    Set Field [ tagTable::kRecordCreatorNode; "defaultCopyright" ]
    #1229
    Set Field [ tagTable::_Number; 1229 ]
    Set Field [ tagTable::_Ltag; 31620121746441229 ]
    Set Variable [ $tag; Value:"CC By 3.0 — Creative Commons Attribution 3.0 Unported" ]
    Set Field [ tagTable::tag; $tag ]
    Set Field [ tagTable::tagSpelling; $tag ]
    Set Field [ tagTable::notesOrCopyright; ¶ & TextSize ( TextColor ( TextFont ( "[NOTE: Click the 'web' button above to view the most current and complete source of the text below, copied on September 22, 2017 from creativecommons.org/licenses/by/3.0/ for your convenience.]" & ¶ ; "Arial" ) ; RGB ( 51 ; 51 ; 51 ) ) ; 16 ) & ¶ & TextStyleAdd ( "Attribution 3.0 Unported (CC BY 3.0) " ; Bold ) & ¶ & ¶ & "This is a human-readable summary of the Legal Code (read the full text). Disclaimer" & ¶ & ¶ & TextStyleAdd ( "You are free to:" ; Bold ) & ¶ & ¶ & TextStyleAdd ( "Share" ; Bold ) & " — copy and redistribute the material in any medium or format" & ¶ & ¶ & TextStyleAdd ( "Adapt" ; Bold ) & " — remix, transform, and build upon the material for any purpose, even commercially. " & ¶ & ¶ & "The licensor cannot revoke these freedoms as long as you follow the license terms." & ¶ & ¶ & TextStyleAdd ( "Under the following terms:" ; Bold ) & ¶ & ¶ & TextStyleAdd ( "Attribution" ; Bold ) & " — You must give appropriate credit, provide a link to the license, and indicate if changes were made. You may do so in any reasonable manner, but not in any way that suggests the licensor endorses you or your use." & ¶ & ¶ & TextStyleAdd ( "No additional restrictions" ; Bold ) & " — You may not apply legal terms or technological measures that legally restrict others from doing anything the license permits." & ¶ & ¶ & TextStyleAdd ( "Notices:" ; Bold ) & ¶ & ¶ & "You do not have to comply with the license for elements of the material in the public domain or where your use is permitted by an applicable exception or limitation." & ¶ & ¶ & "No warranties are given. The license may not give you all of the permissions necessary for your intended use. For example, other rights such as publicity, privacy, or moral rights may limit how you use the material." ]
    Set Field [ tagTable::Ktitle1; 1122012154502117 ]
    Set Field [ tagTable::Kpicture1; 92020171106021484 ]
    #
    #2 Share and give credit CC BY
    New Record/Request
    Set Field [ tagTable::kGroupOrTest; 31620121746441302 ]
    Set Field [ tagTable::match; "copyright" ]
    Set Field [ tagTable::orderOrLock; "lock" ]
    Set Field [ tagTable::kRecordCreatorNode; "defaultCopyright" ]
    #904
    Set Field [ tagTable::_Number; 904 ]
    Set Field [ tagTable::_Ltag; 6282014220454904 ]
    Set Variable [ $tag; Value:"CC By 4.0 — Creative Commons Attribution 4.0 International" ]
    Set Field [ tagTable::tag; $tag ]
    Set Field [ tagTable::tagSpelling; $tag ]
    Set Field [ tagTable::notesOrCopyright; ¶ & TextSize ( TextColor ( TextFont ( "[NOTE: Click the 'web' button above to view the most current and complete source of the text below, copied on September 22, 2017 from creativecommons.org/licenses/by/4.0/ for your convenience.]" & ¶ ; "Arial" ) ; RGB ( 51 ; 51 ; 51 ) ) ; 16 ) & ¶ & TextStyleAdd ( "Attribution 4.0 International (CC BY 4.0) " ; Bold ) & ¶ & ¶ & "This is a human-readable summary of the Legal Code (read the full text). Disclaimer" & ¶ & ¶ & TextStyleAdd ( "You are free to:" ; Bold ) & ¶ & ¶ & TextStyleAdd ( "Share" ; Bold ) & " — copy and redistribute the material in any medium or format" & ¶ & ¶ & TextStyleAdd ( "Adapt" ; Bold ) & " — remix, transform, and build upon the material for any purpose, even commercially. " & ¶ & ¶ & "The licensor cannot revoke these freedoms as long as you follow the license terms." & ¶ & ¶ & TextStyleAdd ( "Under the following terms:" ; Bold ) & ¶ & ¶ & TextStyleAdd ( "Attribution" ; Bold ) & " — You must give appropriate credit, provide a link to the license, and indicate if changes were made. You may do so in any reasonable manner, but not in any way that suggests the licensor endorses you or your use." & ¶ & ¶ & TextStyleAdd ( "No additional restrictions" ; Bold ) & " — You may not apply legal terms or technological measures that legally restrict others from doing anything the license permits." & ¶ & ¶ & TextStyleAdd ( "Notices:" ; Bold ) & ¶ & ¶ & "You do not have to comply with the license for elements of the material in the public domain or where your use is permitted by an applicable exception or limitation." & ¶ & ¶ & "No warranties are given. The license may not give you all of the permissions necessary for your intended use. For example, other rights such as publicity, privacy, or moral rights may limit how you use the material." ]
    Set Field [ tagTable::Ktitle1; 62820142202121325 ]
    Set Field [ tagTable::Kpicture1; 92020171106021484 ]
    #
    #
    #
    #3 Share, give credit, and use the same copyright license CC BY-SA
    New Record/Request
    Set Field [ tagTable::kGroupOrTest; 31620121841541305 ]
    Set Field [ tagTable::match; "copyright" ]
    Set Field [ tagTable::orderOrLock; "lock" ]
    Set Field [ tagTable::kRecordCreatorNode; "defaultCopyright" ]
    #1232
    Set Field [ tagTable::_Number; 1232 ]
    Set Field [ tagTable::_Ltag; 31620121841541232 ]
    Set Variable [ $tag; Value:"CC By SA 3.0 — Creative Commons Attribution-ShareAlike 3.0 Unported" ]
    Set Field [ tagTable::tag; $tag ]
    Set Field [ tagTable::tagSpelling; $tag ]
    Set Field [ tagTable::notesOrCopyright; ¶ & TextSize ( TextColor ( TextFont ( "[NOTE: Click the 'web' button above to view the most current and complete source of the text below, copied on September 22, 2017 from creativecommons.org/licenses/by-sa/3.0/ for your convenience.]" & ¶ ; "Arial" ) ; RGB ( 51 ; 51 ; 51 ) ) ; 16 ) & ¶ & TextStyleAdd ( "Attribution-ShareAlike 3.0 Unported (CC BY-SA 3.0)" ; Bold ) & ¶ & ¶ & "This is a human-readable summary of the Legal Code (read the full text). Disclaimer" & ¶ & ¶ & TextStyleAdd ( "You are free to:" ; Bold ) & ¶ & ¶ & TextStyleAdd ( "Share" ; Bold ) & " — copy and redistribute the material in any medium or format" & ¶ & ¶ & TextStyleAdd ( "Adapt" ; Bold ) & " — remix, transform, and build upon the material for any purpose, even commercially. " & ¶ & ¶ & "The licensor cannot revoke these freedoms as long as you follow the license terms." & ¶ & ¶ & TextStyleAdd ( "Under the following terms:" ; Bold ) & ¶ & ¶ & TextStyleAdd ( "Attribution" ; Bold ) & " — You must give appropriate credit, provide a link to the license, and indicate if changes were made. You may do so in any reasonable manner, but not in any way that suggests the licensor endorses you or your use." & ¶ & ¶ & TextStyleAdd ( "ShareAlike" ; Bold ) & " — If you remix, transform, or build upon the material, you must distribute your contributions under the same license as the original." & ¶ & ¶ & TextStyleAdd ( "No additional restrictions" ; Bold ) & " — You may not apply legal terms or technological measures that legally restrict others from doing anything the license permits." & ¶ & ¶ & TextStyleAdd ( "Notices:" ; Bold ) & ¶ & ¶ & "You do not have to comply with the license for elements of the material in the public domain or where your use is permitted by an applicable exception or limitation." & ¶ & ¶ & "No warranties are given. The license may not give you all of the permissions necessary for your intended use. For example, other rights such as publicity, privacy, or moral rights may limit how you use the material." ]
    Set Field [ tagTable::Ktitle1; 1122012155338120 ]
    Set Field [ tagTable::Kpicture1; 92020172247301499 ]
    #
    #3 Share, give credit, and use the same copyright license CC BY-SA
    New Record/Request
    Set Field [ tagTable::kGroupOrTest; 31620121841541305 ]
    Set Field [ tagTable::match; "copyright" ]
    Set Field [ tagTable::orderOrLock; "lock" ]
    Set Field [ tagTable::kRecordCreatorNode; "defaultCopyright" ]
    #905
    Set Field [ tagTable::_Number; 905 ]
    Set Field [ tagTable::_Ltag; 6282014225223905 ]
    Set Variable [ $tag; Value:"CC By SA 4.0 — Creative Commons Attribution-ShareAlike 4.0 International" ]
    Set Field [ tagTable::tag; $tag ]
    Set Field [ tagTable::tagSpelling; $tag ]
    Set Field [ tagTable::notesOrCopyright; ¶ & TextSize ( TextColor ( TextFont ( "[NOTE: Click the 'web' button above to view the most current and complete source of the text below, copied on September 22, 2017 from creativecommons.org/licenses/by-sa/4.0/ for your convenience.]" & ¶ ; "Arial" ) ; RGB ( 51 ; 51 ; 51 ) ) ; 16 ) & ¶ & TextStyleAdd ( "Attribution-ShareAlike 4.0 International (CC BY-SA 4.0)" ; Bold ) & ¶ & ¶ & "This is a human-readable summary of the Legal Code (read the full text). Disclaimer" & ¶ & ¶ & TextStyleAdd ( "You are free to:" ; Bold ) & ¶ & ¶ & TextStyleAdd ( "Share" ; Bold ) & " — copy and redistribute the material in any medium or format" & ¶ & ¶ & TextStyleAdd ( "Adapt" ; Bold ) & " — remix, transform, and build upon the material for any purpose, even commercially. " & ¶ & ¶ & "The licensor cannot revoke these freedoms as long as you follow the license terms." & ¶ & ¶ & TextStyleAdd ( "Under the following terms:" ; Bold ) & ¶ & ¶ & TextStyleAdd ( "Attribution" ; Bold ) & " — You must give appropriate credit, provide a link to the license, and indicate if changes were made. You may do so in any reasonable manner, but not in any way that suggests the licensor endorses you or your use." & ¶ & ¶ & TextStyleAdd ( "ShareAlike" ; Bold ) & " — If you remix, transform, or build upon the material, you must distribute your contributions under the same license as the original." & ¶ & ¶ & TextStyleAdd ( "No additional restrictions" ; Bold ) & " — You may not apply legal terms or technological measures that legally restrict others from doing anything the license permits." & ¶ & ¶ & TextStyleAdd ( "Notices:" ; Bold ) & ¶ & ¶ & "You do not have to comply with the license for elements of the material in the public domain or where your use is permitted by an applicable exception or limitation." & ¶ & ¶ & "No warranties are given. The license may not give you all of the permissions necessary for your intended use. For example, other rights such as publicity, privacy, or moral rights may limit how you use the material." ]
    Set Field [ tagTable::Ktitle1; 62820142252121331 ]
    Set Field [ tagTable::Kpicture1; 92020172247301499 ]
    #
    #
    #
    #4 Share, give credit, and don’t change CC BY-ND
    New Record/Request
    Set Field [ tagTable::kGroupOrTest; 31620121902441307 ]
    Set Field [ tagTable::match; "copyright" ]
    Set Field [ tagTable::orderOrLock; "lock" ]
    Set Field [ tagTable::kRecordCreatorNode; "defaultCopyright" ]
    #1234
    Set Field [ tagTable::_Number; 1234 ]
    Set Field [ tagTable::_Ltag; 31620121902441234 ]
    Set Variable [ $tag; Value:"CC By ND 3.0 — Creative Commons Attribution-NoDerivs 3.0 Unported" ]
    Set Field [ tagTable::tag; $tag ]
    Set Field [ tagTable::tagSpelling; $tag ]
    Set Field [ tagTable::notesOrCopyright; ¶ & TextSize ( TextColor ( TextFont ( "[NOTE: Click the 'web' button above to view the most current and complete source of the text below, copied on September 22, 2017 from creativecommons.org/licenses/by-nd/3.0/ for your convenience.]" & ¶ ; "Arial" ) ; RGB ( 51 ; 51 ; 51 ) ) ; 16 ) & ¶ & TextStyleAdd ( "Attribution-ShareAlike 3.0 Unported (CC BY-SA 3.0)" ; Bold ) & ¶ & ¶ & "This is a human-readable summary of the Legal Code (read the full text). Disclaimer" & ¶ & ¶ & TextStyleAdd ( "You are free to:" ; Bold ) & ¶ & ¶ & TextStyleAdd ( "Share" ; Bold ) & " — copy and redistribute the material in any medium or format for any purpose, even commercially. " & ¶ & ¶ & "The licensor cannot revoke these freedoms as long as you follow the license terms." & ¶ & ¶ & TextStyleAdd ( "Under the following terms:" ; Bold ) & ¶ & ¶ & TextStyleAdd ( "Attribution" ; Bold ) & " — You must give appropriate credit, provide a link to the license, and indicate if changes were made. You may do so in any reasonable manner, but not in any way that suggests the licensor endorses you or your use." & ¶ & ¶ & TextStyleAdd ( "NoDerivatives" ; Bold ) & " — If you remix, transform, or build upon the material, you may not distribute the modified material." & ¶ & ¶ & TextStyleAdd ( "No additional restrictions" ; Bold ) & " — You may not apply legal terms or technological measures that legally restrict others from doing anything the license permits." & ¶ & ¶ & TextStyleAdd ( "Notices:" ; Bold ) & ¶ & ¶ & "You do not have to comply with the license for elements of the material in the public domain or where your use is permitted by an applicable exception or limitation." & ¶ & ¶ & "No warranties are given. The license may not give you all of the permissions necessary for your intended use. For example, other rights such as publicity, privacy, or moral rights may limit how you use the material." ]
    Set Field [ tagTable::Ktitle1; 3162012190014146 ]
    Set Field [ tagTable::Kpicture1; 92020172209091494 ]
    #This field must be set to get copyright tags to
    #sort so that the 3.0 ND tag comes before the
    #4.0 ND tag as it does for all the other Creative
    #Commons tags.
    Set Field [ tagTable::textStyleOrCreatorNodeFlag; 1 ]
    #
    #4 Share, give credit, and don’t change CC BY-ND
    New Record/Request
    Set Field [ tagTable::kGroupOrTest; 31620121902441307 ]
    Set Field [ tagTable::match; "copyright" ]
    Set Field [ tagTable::orderOrLock; "lock" ]
    Set Field [ tagTable::kRecordCreatorNode; "defaultCopyright" ]
    #908
    Set Field [ tagTable::_Number; 908 ]
    Set Field [ tagTable::_Ltag; 6282014232807908 ]
    Set Variable [ $tag; Value:"CC By ND 4.0 — Creative Commons Attribution-NoDerivatives 4.0 International" ]
    Set Field [ tagTable::tag; $tag ]
    Set Field [ tagTable::tagSpelling; $tag ]
    Set Field [ tagTable::notesOrCopyright; ¶ & TextSize ( TextColor ( TextFont ( "[NOTE: Click the 'web' button above to view the most current and complete source of the text below, copied on September 22, 2017 from creativecommons.org/licenses/by-nd/4.0/ for your convenience.]" & ¶ ; "Arial" ) ; RGB ( 51 ; 51 ; 51 ) ) ; 16 ) & ¶ & TextStyleAdd ( "Attribution-NoDerivatives 4.0 International (CC BY-ND 4.0)" ; Bold ) & ¶ & ¶ & "This is a human-readable summary of the Legal Code (read the full text). Disclaimer" & ¶ & ¶ & TextStyleAdd ( "You are free to:" ; Bold ) & ¶ & ¶ & TextStyleAdd ( "Share" ; Bold ) & " — copy and redistribute the material in any medium or format for any purpose, even commercially. " & ¶ & ¶ & "The licensor cannot revoke these freedoms as long as you follow the license terms." & ¶ & ¶ & TextStyleAdd ( "Under the following terms:" ; Bold ) & ¶ & ¶ & TextStyleAdd ( "Attribution" ; Bold ) & " — You must give appropriate credit, provide a link to the license, and indicate if changes were made. You may do so in any reasonable manner, but not in any way that suggests the licensor endorses you or your use." & ¶ & ¶ & TextStyleAdd ( "NoDerivatives" ; Bold ) & " — If you remix, transform, or build upon the material, you may not distribute the modified material." & ¶ & ¶ & TextStyleAdd ( "No additional restrictions" ; Bold ) & " — You may not apply legal terms or technological measures that legally restrict others from doing anything the license permits." & ¶ & ¶ & TextStyleAdd ( "Notices:" ; Bold ) & ¶ & ¶ & "You do not have to comply with the license for elements of the material in the public domain or where your use is permitted by an applicable exception or limitation." & ¶ & ¶ & "No warranties are given. The license may not give you all of the permissions necessary for your intended use. For example, other rights such as publicity, privacy, or moral rights may limit how you use the material." ]
    Set Field [ tagTable::Ktitle1; 62820142328311335 ]
    Set Field [ tagTable::Kpicture1; 92020172209091494 ]
    #This field must be set to get copyright tags to
    #sort so that the 3.0 ND tag comes before the
    #4.0 ND tag as it does for all the other Creative
    #Commons tags.
    Set Field [ tagTable::textStyleOrCreatorNodeFlag; 2 ]
    #
    #
    #
    #5 Share, give credit, and don’t sell CC BY-NC
    New Record/Request
    Set Field [ tagTable::kGroupOrTest; 31620121837161304 ]
    Set Field [ tagTable::match; "copyright" ]
    Set Field [ tagTable::orderOrLock; "lock" ]
    Set Field [ tagTable::kRecordCreatorNode; "defaultCopyright" ]
    #1231
    Set Field [ tagTable::_Number; 1231 ]
    Set Field [ tagTable::_Ltag; 31620121837161231 ]
    Set Variable [ $tag; Value:"CC By NC 3.0 — Creative Commons Attribution-NonCommercial 3.0 Unported" ]
    Set Field [ tagTable::tag; $tag ]
    Set Field [ tagTable::tagSpelling; $tag ]
    Set Field [ tagTable::notesOrCopyright; ¶ & TextSize ( TextColor ( TextFont ( "[NOTE: Click the 'web' button above to view the most current and complete source of the text below, copied on September 22, 2017 from creativecommons.org/licenses/by-nc/3.0/ for your convenience.]" & ¶ ; "Arial" ) ; RGB ( 51 ; 51 ; 51 ) ) ; 16 ) & ¶ & TextStyleAdd ( "Attribution-NonCommercial 3.0 Unported (CC BY-NC 3.0)" ; Bold ) & ¶ & ¶ & "This is a human-readable summary of the Legal Code (read the full text). Disclaimer" & ¶ & ¶ & TextStyleAdd ( "You are free to:" ; Bold ) & ¶ & ¶ & TextStyleAdd ( "Share" ; Bold ) & " — copy and redistribute the material in any medium or format " & ¶ & ¶ & TextStyleAdd ( "Adapt" ; Bold ) & " — remix, transform, and build upon the material" & ¶ & ¶ & "The licensor cannot revoke these freedoms as long as you follow the license terms." & ¶ & ¶ & TextStyleAdd ( "Under the following terms:" ; Bold ) & ¶ & ¶ & TextStyleAdd ( "Attribution" ; Bold ) & " — You must give appropriate credit, provide a link to the license, and indicate if changes were made. You may do so in any reasonable manner, but not in any way that suggests the licensor endorses you or your use." & ¶ & ¶ & TextStyleAdd ( "NonCommercial" ; Bold ) & " — You may not use the material for commercial purposes." & ¶ & ¶ & TextStyleAdd ( "No additional restrictions" ; Bold ) & " — You may not apply legal terms or technological measures that legally restrict others from doing anything the license permits." & ¶ & ¶ & TextStyleAdd ( "Notices:" ; Bold ) & ¶ & ¶ & "You do not have to comply with the license for elements of the material in the public domain or where your use is permitted by an applicable exception or limitation." & ¶ & ¶ & "No warranties are given. The license may not give you all of the permissions necessary for your intended use. For example, other rights such as publicity, privacy, or moral rights may limit how you use the material." ]
    Set Field [ tagTable::Ktitle1; 1122012155421121 ]
    Set Field [ tagTable::Kpicture1; 92020172214211498 ]
    #
    #5 Share, give credit, and don’t sell CC BY-NC
    New Record/Request
    Set Field [ tagTable::kGroupOrTest; 31620121837161304 ]
    Set Field [ tagTable::match; "copyright" ]
    Set Field [ tagTable::orderOrLock; "lock" ]
    Set Field [ tagTable::kRecordCreatorNode; "defaultCopyright" ]
    #903
    Set Field [ tagTable::_Number; 903 ]
    Set Field [ tagTable::_Ltag; 6272014222057903 ]
    Set Variable [ $tag; Value:"CC By NC 4.0 — Creative Commons Attribution-NonCommercial 4.0 International" ]
    Set Field [ tagTable::tag; $tag ]
    Set Field [ tagTable::tagSpelling; $tag ]
    Set Field [ tagTable::notesOrCopyright; ¶ & TextSize ( TextColor ( TextFont ( "[NOTE: Click the 'web' button above to view the most current and complete source of the text below, copied on September 22, 2017 from creativecommons.org/licenses/by-nc/4.0/ for your convenience.]" & ¶ ; "Arial" ) ; RGB ( 51 ; 51 ; 51 ) ) ; 16 ) & ¶ & TextStyleAdd ( "Attribution-NonCommercial 4.0 International (CC BY-NC 4.0)" ; Bold ) & ¶ & ¶ & "This is a human-readable summary of the Legal Code (read the full text). Disclaimer" & ¶ & ¶ & TextStyleAdd ( "You are free to:" ; Bold ) & ¶ & ¶ & TextStyleAdd ( "Share" ; Bold ) & " — copy and redistribute the material in any medium or format " & ¶ & ¶ & TextStyleAdd ( "Adapt" ; Bold ) & " — remix, transform, and build upon the material" & ¶ & ¶ & "The licensor cannot revoke these freedoms as long as you follow the license terms." & ¶ & ¶ & TextStyleAdd ( "Under the following terms:" ; Bold ) & ¶ & ¶ & TextStyleAdd ( "Attribution" ; Bold ) & " — You must give appropriate credit, provide a link to the license, and indicate if changes were made. You may do so in any reasonable manner, but not in any way that suggests the licensor endorses you or your use." & ¶ & ¶ & TextStyleAdd ( "NonCommercial" ; Bold ) & " — You may not use the material for commercial purposes." & ¶ & ¶ & TextStyleAdd ( "No additional restrictions" ; Bold ) & " — You may not apply legal terms or technological measures that legally restrict others from doing anything the license permits." & ¶ & ¶ & TextStyleAdd ( "Notices:" ; Bold ) & ¶ & ¶ & "You do not have to comply with the license for elements of the material in the public domain or where your use is permitted by an applicable exception or limitation." & ¶ & ¶ & "No warranties are given. The license may not give you all of the permissions necessary for your intended use. For example, other rights such as publicity, privacy, or moral rights may limit how you use the material." ]
    Set Field [ tagTable::Ktitle1; 62820142355431336 ]
    Set Field [ tagTable::Kpicture1; 92020172214211498 ]
    #
    #
    #
    #6 Share, give credit, don’t sell, and use the same copyright license CC BY-NC-SA
    New Record/Request
    Set Field [ tagTable::kGroupOrTest; 8162011231825553 ]
    Set Field [ tagTable::match; "copyright" ]
    Set Field [ tagTable::orderOrLock; "lock" ]
    Set Field [ tagTable::kRecordCreatorNode; "defaultCopyright" ]
    #326
    Set Field [ tagTable::_Number; 326 ]
    Set Field [ tagTable::_Ltag; 8162011231825326 ]
    Set Variable [ $tag; Value:"CC By NC SA 3.0 — Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported" ]
    Set Field [ tagTable::tag; $tag ]
    Set Field [ tagTable::tagSpelling; $tag ]
    Set Field [ tagTable::notesOrCopyright; ¶ & TextSize ( TextColor ( TextFont ( "[NOTE: Click the 'web' button above to view the most current and complete source of the text below, copied on September 22, 2017 from creativecommons.org/licenses/by-nc-sa/3.0/ for your convenience.]" & ¶ ; "Arial" ) ; RGB ( 51 ; 51 ; 51 ) ) ; 16 ) & ¶ & TextStyleAdd ( "Attribution-NonCommercial-ShareAlike 3.0 Unported (CC BY-NC-SA 3.0)" ; Bold ) & ¶ & ¶ & "This is a human-readable summary of the Legal Code (read the full text). Disclaimer" & ¶ & ¶ & TextStyleAdd ( "You are free to:" ; Bold ) & ¶ & ¶ & TextStyleAdd ( "Share" ; Bold ) & " — copy and redistribute the material in any medium or format " & ¶ & ¶ & TextStyleAdd ( "Adapt" ; Bold ) & " — remix, transform, and build upon the material" & ¶ & ¶ & "The licensor cannot revoke these freedoms as long as you follow the license terms." & ¶ & ¶ & TextStyleAdd ( "Under the following terms:" ; Bold ) & ¶ & ¶ & TextStyleAdd ( "Attribution" ; Bold ) & " — You must give appropriate credit, provide a link to the license, and indicate if changes were made. You may do so in any reasonable manner, but not in any way that suggests the licensor endorses you or your use." & ¶ & ¶ & TextStyleAdd ( "NonCommercial" ; Bold ) & " — You may not use the material for commercial purposes." & ¶ & ¶ & TextStyleAdd ( "ShareAlike" ; Bold ) & " — If you remix, transform, or build upon the material, you must distribute your contributions under the same license as the original. " & ¶ & ¶ & TextStyleAdd ( "No additional restrictions" ; Bold ) & " — You may not apply legal terms or technological measures that legally restrict others from doing anything the license permits." & ¶ & ¶ & TextStyleAdd ( "Notices:" ; Bold ) & ¶ & ¶ & "You do not have to comply with the license for elements of the material in the public domain or where your use is permitted by an applicable exception or limitation." & ¶ & ¶ & "No warranties are given. The license may not give you all of the permissions necessary for your intended use. For example, other rights such as publicity, privacy, or moral rights may limit how you use the material." ]
    Set Field [ tagTable::Ktitle1; 1122012000717114 ]
    Set Field [ tagTable::Kpicture1; 92020172213531497 ]
    #
    #6 Share, give credit, don’t sell, and use the same copyright license CC BY-NC-SA
    New Record/Request
    Set Field [ tagTable::kGroupOrTest; 8162011231825553 ]
    Set Field [ tagTable::match; "copyright" ]
    Set Field [ tagTable::orderOrLock; "lock" ]
    Set Field [ tagTable::kRecordCreatorNode; "defaultCopyright" ]
    #906
    Set Field [ tagTable::_Number; 906 ]
    Set Field [ tagTable::_Ltag; 6282014225704906 ]
    Set Variable [ $tag; Value:"CC By NC SA 4.0 — Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International" ]
    Set Field [ tagTable::tag; $tag ]
    Set Field [ tagTable::tagSpelling; $tag ]
    Set Field [ tagTable::notesOrCopyright; ¶ & TextSize ( TextColor ( TextFont ( "[NOTE: Click the 'web' button above to view the most current and complete source of the text below, copied on September 22, 2017 from creativecommons.org/licenses/by-nc-sa/4.0/ for your convenience.]" & ¶ ; "Arial" ) ; RGB ( 51 ; 51 ; 51 ) ) ; 16 ) & ¶ & TextStyleAdd ( "Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0)" ; Bold ) & ¶ & ¶ & "This is a human-readable summary of the Legal Code (read the full text). Disclaimer" & ¶ & ¶ & TextStyleAdd ( "You are free to:" ; Bold ) & ¶ & ¶ & TextStyleAdd ( "Share" ; Bold ) & " — copy and redistribute the material in any medium or format " & ¶ & ¶ & TextStyleAdd ( "Adapt" ; Bold ) & " — remix, transform, and build upon the material" & ¶ & ¶ & "The licensor cannot revoke these freedoms as long as you follow the license terms." & ¶ & ¶ & TextStyleAdd ( "Under the following terms:" ; Bold ) & ¶ & ¶ & TextStyleAdd ( "Attribution" ; Bold ) & " — You must give appropriate credit, provide a link to the license, and indicate if changes were made. You may do so in any reasonable manner, but not in any way that suggests the licensor endorses you or your use." & ¶ & ¶ & TextStyleAdd ( "NonCommercial" ; Bold ) & " — You may not use the material for commercial purposes." & ¶ & ¶ & TextStyleAdd ( "ShareAlike" ; Bold ) & " — If you remix, transform, or build upon the material, you must distribute your contributions under the same license as the original. " & ¶ & ¶ & TextStyleAdd ( "No additional restrictions" ; Bold ) & " — You may not apply legal terms or technological measures that legally restrict others from doing anything the license permits." & ¶ & ¶ & TextStyleAdd ( "Notices:" ; Bold ) & ¶ & ¶ & "You do not have to comply with the license for elements of the material in the public domain or where your use is permitted by an applicable exception or limitation." & ¶ & ¶ & "No warranties are given. The license may not give you all of the permissions necessary for your intended use. For example, other rights such as publicity, privacy, or moral rights may limit how you use the material." ]
    Set Field [ tagTable::Ktitle1; 62820142320251334 ]
    Set Field [ tagTable::Kpicture1; 92020172213531497 ]
    #
    #
    #
    #7 Share, give credit, don’t sell, don't change = use the same copyright license CC BY-NC-ND
    New Record/Request
    Set Field [ tagTable::kGroupOrTest; 31620121824141303 ]
    Set Field [ tagTable::match; "copyright" ]
    Set Field [ tagTable::orderOrLock; "lock" ]
    Set Field [ tagTable::kRecordCreatorNode; "defaultCopyright" ]
    #1049
    Set Field [ tagTable::_Number; 1049 ]
    Set Field [ tagTable::_Ltag; 121620112002051049 ]
    Set Variable [ $tag; Value:"CC By NC ND 3.0 — Creative Commons Attribution-NonCommercial-NoDerivs 3.0 Unported" ]
    Set Field [ tagTable::tag; $tag ]
    Set Field [ tagTable::tagSpelling; $tag ]
    Set Field [ tagTable::notesOrCopyright; ¶ & TextSize ( TextColor ( TextFont ( "[NOTE: Click the 'web' button above to view the most current and complete source of the text below, copied on September 22, 2017 from creativecommons.org/licenses/by-nc-nd/3.0/ for your convenience.]" & ¶ ; "Arial" ) ; RGB ( 51 ; 51 ; 51 ) ) ; 16 ) & ¶ & TextStyleAdd ( "Attribution-NonCommercial-NoDerivs 3.0 Unported (CC BY-NC-ND 3.0)" ; Bold ) & ¶ & ¶ & "This is a human-readable summary of the Legal Code (read the full text). Disclaimer" & ¶ & ¶ & TextStyleAdd ( "You are free to:" ; Bold ) & ¶ & ¶ & TextStyleAdd ( "Share" ; Bold ) & " — copy and redistribute the material in any medium or format" & ¶ & ¶ & "The licensor cannot revoke these freedoms as long as you follow the license terms." & ¶ & ¶ & TextStyleAdd ( "Under the following terms:" ; Bold ) & ¶ & ¶ & TextStyleAdd ( "Attribution" ; Bold ) & " — You must give appropriate credit, provide a link to the license, and indicate if changes were made. You may do so in any reasonable manner, but not in any way that suggests the licensor endorses you or your use." & ¶ & ¶ & TextStyleAdd ( "NonCommercial" ; Bold ) & " — You may not use the material for commercial purposes." & ¶ & ¶ & TextStyleAdd ( "NoDerivatives" ; Bold ) & " — If you remix, transform, or build upon the material, you may not distribute the modified material." & ¶ & ¶ & TextStyleAdd ( "No additional restrictions" ; Bold ) & " — You may not apply legal terms or technological measures that legally restrict others from doing anything the license permits." & ¶ & ¶ & TextStyleAdd ( "Notices:" ; Bold ) & ¶ & ¶ & "You do not have to comply with the license for elements of the material in the public domain or where your use is permitted by an applicable exception or limitation." & ¶ & ¶ & "No warranties are given. The license may not give you all of the permissions necessary for your intended use. For example, other rights such as publicity, privacy, or moral rights may limit how you use the material." ]
    Set Field [ tagTable::Ktitle1; 1122012155517122 ]
    Set Field [ tagTable::Kpicture1; 92020172144131485 ]
    #This field must be set to get copyright tags to
    #sort so that the 3.0 ND tag comes before the
    #4.0 ND tag as it does for all the other Creative
    #Commons tags.
    Set Field [ tagTable::textStyleOrCreatorNodeFlag; 1 ]
    #
    #7 Share, give credit, don’t sell, don't change = use the same copyright license CC BY-NC-ND
    New Record/Request
    Set Field [ tagTable::kGroupOrTest; 31620121824141303 ]
    Set Field [ tagTable::match; "copyright" ]
    Set Field [ tagTable::orderOrLock; "lock" ]
    Set Field [ tagTable::kRecordCreatorNode; "defaultCopyright" ]
    #907
    Set Field [ tagTable::_Number; 907 ]
    Set Field [ tagTable::_Ltag; 6282014230310907 ]
    Set Variable [ $tag; Value:"CC By NC ND 4.0 — Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International" ]
    Set Field [ tagTable::tag; $tag ]
    Set Field [ tagTable::tagSpelling; $tag ]
    Set Field [ tagTable::notesOrCopyright; ¶ & TextSize ( TextColor ( TextFont ( "[NOTE: Click the 'web' button above to view the most current and complete source of the text below, copied on September 22, 2017 from creativecommons.org/licenses/by-nc-nd/4.0/ for your convenience.]" & ¶ ; "Arial" ) ; RGB ( 51 ; 51 ; 51 ) ) ; 16 ) & ¶ & TextStyleAdd ( "Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)" ; Bold ) & ¶ & ¶ & "This is a human-readable summary of the Legal Code (read the full text). Disclaimer" & ¶ & ¶ & TextStyleAdd ( "You are free to:" ; Bold ) & ¶ & ¶ & TextStyleAdd ( "Share" ; Bold ) & " — copy and redistribute the material in any medium or format" & ¶ & ¶ & "The licensor cannot revoke these freedoms as long as you follow the license terms." & ¶ & ¶ & TextStyleAdd ( "Under the following terms:" ; Bold ) & ¶ & ¶ & TextStyleAdd ( "Attribution" ; Bold ) & " — You must give appropriate credit, provide a link to the license, and indicate if changes were made. You may do so in any reasonable manner, but not in any way that suggests the licensor endorses you or your use." & ¶ & ¶ & TextStyleAdd ( "NonCommercial" ; Bold ) & " — You may not use the material for commercial purposes." & ¶ & ¶ & TextStyleAdd ( "NoDerivatives" ; Bold ) & " — If you remix, transform, or build upon the material, you may not distribute the modified material." & ¶ & ¶ & TextStyleAdd ( "No additional restrictions" ; Bold ) & " — You may not apply legal terms or technological measures that legally restrict others from doing anything the license permits." & ¶ & ¶ & TextStyleAdd ( "Notices:" ; Bold ) & ¶ & ¶ & "You do not have to comply with the license for elements of the material in the public domain or where your use is permitted by an applicable exception or limitation." & ¶ & ¶ & "No warranties are given. The license may not give you all of the permissions necessary for your intended use. For example, other rights such as publicity, privacy, or moral rights may limit how you use the material." ]
    Set Field [ tagTable::Ktitle1; 62820142257411332 ]
    Set Field [ tagTable::Kpicture1; 92020172144131485 ]
    #This field must be set to get copyright tags to
    #sort so that the 3.0 ND tag comes before the
    #4.0 ND tag as it does for all the other Creative
    #Commons tags.
    Set Field [ tagTable::textStyleOrCreatorNodeFlag; 2 ]
    #
    #
    #
    #8 Don’t share - personal use only
    New Record/Request
    Set Field [ tagTable::kGroupOrTest; 8102011220941540 ]
    Set Field [ tagTable::match; "copyright" ]
    Set Field [ tagTable::orderOrLock; "lock" ]
    Set Field [ tagTable::kRecordCreatorNode; "defaultCopyright" ]
    #282
    Set Field [ tagTable::_Number; 282 ]
    Set Field [ tagTable::_Ltag; 8102011220941282 ]
    Set Variable [ $tag; Value:"© All rights reserved" ]
    Set Field [ tagTable::tag; $tag ]
    Set Field [ tagTable::tagSpelling; $tag ]
    Set Field [ tagTable::notesOrCopyright; ¶ & TextSize ( TextColor ( TextFont ( "[NOTE: Click the 'web' button above to view the most current and complete source of the text excerpts below, copied on September 21, 2017 from en.wikipedia.org/wiki/Copyright_notice for your convenience.]" & ¶ ; "Arial" ) ; RGB ( 51 ; 51 ; 51 ) ) ; 16 ) & ¶ & TextStyleAdd ( "Copyright notice" ; Bold ) & ¶ & ¶ & "This article is about the US statutorily-defined copyright notice. For notifications of claimed copyright infringement, see Online Copyright Infringement Liability Limitation Act." & ¶ & ¶ & "..." & ¶ & ¶ & "In United States copyright law, a copyright notice is a notice of statutorily prescribed form that informs users of the underlying claim to copyright ownership in a published work." & ¶ & ¶ & "Use of the notice informs the public that a work is protected by copyright, identifies the copyright owner, and shows the year of first publication. Furthermore, in the event that a work is infringed, if the work carries a proper notice, the court will not give any weight to a defendant’s use of an innocent infringement defense—that is, to a claim that the defendant did not realize that the work was protected." & ¶ & ¶ & "For works first published on or after March 1, 1989, use of the copyright notice is optional. Before March 1, 1989, the use of the notice was mandatory on all published works. Omitting the notice on any work first published from January 1, 1978, to February 28, 1989, could have resulted in the loss of copyright protection if corrective steps were not taken within a certain amount of time. Works published before January 1, 1978, are governed by the 1909 Copyright Act. Under that law, if a work was published under the copyright owner’s authority without a proper notice of copyright, all copyright protection for that work was permanently lost in the United States." & ¶ & ¶ & "..." & ¶ & ¶ & TextStyleAdd ( "Form of notice for visually perceptible copies" ; Bold ) & ¶ & ¶ & "1. The notice for visually perceptible copies should contain all three elements described below. They should appear together or in close proximity on the copies." & ¶ & ¶ & "2. The symbol © (letter C in a circle); the word " & Quote ( "Copyright" ) & "; or the abbreviation " & Quote ( "Copr." ) & ¶ & ¶ & "3. The year of first publication. If the work is a derivative work or a compilation incorporating previously published material, the year date of first publication of the derivative work or compilation is sufficient. Examples of derivative works are translations or dramatizations; an example of a compilation is an anthology. The year may be omitted when a pictorial, graphic, or sculptural work, with accompanying textual matter, if any, is reproduced in or on greeting cards, postcards, stationery, jewelry, dolls, toys, or useful articles." & ¶ & ¶ & "The name of the copyright owner, an abbreviation by which the name can be recognized, or a generally known alternative designation of owner." ]
    Set Field [ tagTable::Ktitle1; 62820142315491333 ]
    Set Field [ tagTable::Kpicture1; 92120170936171502 ]
    #
    #
    #
    #Trademark, Service Mark, Logo, Etc.
    New Record/Request
    Set Field [ tagTable::kGroupOrTest; 92020171119521809 ]
    Set Field [ tagTable::match; "copyright" ]
    Set Field [ tagTable::orderOrLock; "lock" ]
    Set Field [ tagTable::kRecordCreatorNode; "defaultCopyright" ]
    #4454
    Set Field [ tagTable::_Number; 4454 ]
    Set Field [ tagTable::_Ltag; 92020171119524454 ]
    Set Variable [ $tag; Value:"Trademark — Check owner's policy webpage for use and restrictions guidelines." ]
    Set Field [ tagTable::tag; $tag ]
    Set Field [ tagTable::tagSpelling; $tag ]
    Set Field [ tagTable::notesOrCopyright; ¶ & TextSize ( TextColor ( TextFont ( "[NOTE: Click the 'web' button above to view the most current and complete source of the text excerpts below, copied on September 21, 2017 from en.wikipedia.org/wiki/Trademark for your convenience.]" & ¶ ; "Arial" ) ; RGB ( 51 ; 51 ; 51 ) ) ; 16 ) & ¶ & TextStyleAdd ( "Trademark" ; Bold ) & ¶ & ¶ & "A trademark, trade mark, or trade-mark[1] is a recognizable sign, design, or expression which identifies products or services of a particular source from those of others,[2][3] although trademarks used to identify services are usually called service marks.[4][5] The trademark owner can be an individual, business organization, or any legal entity. A trademark may be located on a package, a label, a voucher, or on the product itself. For the sake of corporate identity, trademarks are often displayed on company buildings." & ¶ & ¶ & "..." & ¶ & ¶ & "The owner of a trademark may pursue legal action against trademark infringement. Most countries require formal registration of a trademark as a precondition for pursuing this type of action. The United States, Canada and other countries also recognize common law trademark rights, which means action can be taken to protect an unregistered trademark if it is in use. Still, common law trademarks offer the holder in general less legal protection than registered trademarks." & ¶ & ¶ & "The term trademark is also used informally to refer to any distinguishing attribute by which an individual is readily identified, such as the well-known characteristics of celebrities. When a trademark is used in relation to services rather than products, it may sometimes be called a service mark, particularly in the United States.[7]" & ¶ & ¶ & "..." & ¶ & ¶ & TextStyleAdd ( "Terminology" ; Bold ) & ¶ & ¶ & "... Terms such as " & Quote ( "mark" ) & ", " & Quote ( "brand" ) & " and " & Quote ( "trade" ) & " are sometimes used interchangeably with " & Quote ( "trademark" ) & ". " & Quote ( "Trademark" ) & ", however, also includes any device, brand, label, name, signature, word, letter, numerical, shape of goods, packaging, colour or combination of colours, smell, sound, movement or any combination thereof which is capable of distinguishing goods and services of one business from those of others. It must be capable of graphical representation and must be applied to goods or services for which it is registered." & ¶ & ¶ & "..." & ¶ & ¶ & TextStyleAdd ( "Comparison with patents, designs and copyright" ; Bold ) & ¶ & ¶ & "... Trademarks, patents and designs collectively form a subset of intellectual property known as industrial property because they are often created and used in an industrial or commercial context." & ¶ & ¶ & "By comparison, copyright law generally seeks to protect original literary, artistic and other creative works. Continued active use and re-registration can make a trademark perpetual, whereas copyright usually lasts for the duration of the author's lifespan plus 70 years for works by individuals, and some limited time after creation for works by bodies corporate.[36] This can lead to confusion in cases where a work passes into the public domain but the character in question remains a registered trademark." & ¶ & ¶ & "... Unlike patents and copyrights, which in theory are granted for one-off fixed terms, trademarks remain valid as long as the owner actively uses and defends them and maintains their registrations with the competent authorities. This often involves payment of a periodic renewal fee." & ¶ & ¶ & "As a trademark must be used to maintain rights in relation to that mark, a trademark can be 'abandoned' or its registration can be cancelled or revoked if the mark is not continuously used. By comparison, patents and copyrights cannot be 'abandoned' and a patent holder or copyright owner can generally enforce their rights without taking any particular action to maintain the patent or copyright. Additionally, patent holders and copyright owners may not necessarily need to actively police their rights. " ]
    Set Field [ tagTable::Ktitle1; 62820142315491333 ]
    Set Field [ tagTable::Kpicture1; 92020172259191500 ]
    #
    #
    Go to Field [ ]
    #
    #

Fields used in this script

    testSubsectionGroup::orderOrLibraryType
    testSubsectionGroup::match
    testSubsectionGroup::kRecordCreatorNode
    testSubsectionGroup::_Number
    testSubsectionGroup::_Lgroup
    testSubsectionGroup::name
    testSubsectionGroup::nameSpellingEXCEPTForTestItemGroup
    tagTable::orderOrLock
    tagTable::tag
    tagTable::_Number
    tagTable::tagSpelling
    tagTable::match
    tagTable::_Ltag
    tagTable::kRecordCreatorNode
    tagTable::kGroupOrTest
    tagTable::notesOrCopyright
    tagTable::Ktitle1
    tagTable::Kpicture1
    tagTable::textStyleOrCreatorNodeFlag

Scripts used in this script

Layouts used in this script

    tableTagGroup
    tableTag

Tables used in this script

    tag
    tagGroup

Table occurrences used by this script

    tagTable
    testSubsectionGroup

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [CHUNK_CopyrightLockedFields]	Parent Folder: [startclose]	Next Script: [closeLibrary]
Script Name	New Script
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

Fields used in this script

Scripts used in this script

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [New Script]	Parent Folder: [startclose]	Next Script: [startDatabase]
Script Name	closeLibrary
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultSetup
    defaultTest
    defaultTestNewSection

Scripts that use this script

    newLibraryStep1_CreateACopyOfThisLibraryFile
    newLibraryStep2_EraseRecordsInCopyOfLibrary
    startDatabase

Script Definition
Script Steps

    #
    #This will close this Library's open windows.
    Close File [ Current File ]
    #

Fields used in this script

Scripts used in this script

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [closeLibrary]	Parent Folder: [startclose]
Script Name	startDatabase
Run script with full access privileges	Off
Include In Menu	Yes
Layouts that use this script

Scripts that use this script

    importDataFromABranchIntoThisMainLibrary
    newLibraryStep3A_makeEmptiedLibraryANewLibrary
    newLibraryStep3B_importLibraryIntoEmptiedLibrary

Script Definition
Script Steps

    #
    #PURPOSE: Manage the 4 script newLibrary
    #creation process, OR open the library.
    #
    #BEGIN: Manage new library creation process.
    #
    #Check if database is being started by any of
    #the newLibrary scripts.
    Set Window Title [ Current Window; New Title: "Library Update" ]
    Go to Layout [ “backup” (backup) ]
    Delete All Records [ No dialog ]
    New Record/Request
    #
    #If this is a new copy of the library created by the
    #newLibraryStep1createACopyOfThisLibraryFile
    #script, then it will have this erase-records
    #code in the newLibrary field. Proceed with
    #step 2 of creating a new library file, rather
    #than starting up this copy of the library as
    #ready to use library file.
    If [ backup::newLibrary = "234874920347574weidf792342f9823984" ]
    Perform Script [ “newLibraryStep2_EraseRecordsInCopyOfLibrary” ]
    Exit Script [ ]
    End If
    #
    #If user is opening a just-copied library file
    #(step 1 of the newLibrary creation process),
    #has just had all its records erased (step 2),
    #then ask the user how to proceed: perform
    #step 3A (new library) or step 3B (upgrade old
    #library to this library's version)?
    If [ backup::newLibrary = "newLibrary" ]
    Go to Layout [ “defaultSetup” (librarySetupReferenceMain) ]
    Show Custom Dialog [ Message: "1) Create a new, empty library." & ¶ & "2) Import another library's records into version " & tempSetup::versionNumber & " of the library application."; Default Button: “new”, Commit: “Yes”; Button 2: “import”, Commit: “No”; Button 3: “cancel”, Commit: “No” ]
    #
    #If the user cancels, then close this new file as
    #the user cannot do anything with a new
    #library until they decide to use it as a new/
    #empty library or to import another library's
    #data into it = upgrade.
    If [ Get ( LastMessageChoice ) = 3 ]
    Show Custom Dialog [ Message: "When you are ready to decide what to do with this empty library re-open it. This library will now close."; Default Button: “OK”, Commit: “Yes” ]
    Close Window [ Current Window ]
    Exit Script [ ]
    #
    #Perform step 3A if the user clicks new.
    Else If [ Get ( LastMessageChoice ) = 1 ]
    Perform Script [ “newLibraryStep3A_makeEmptiedLibraryANewLibrary” ]
    Exit Script [ ]
    #
    #Perform step 3B if the user clicks import.
    Else If [ Get ( LastMessageChoice ) = 2 ]
    Perform Script [ “newLibraryStep3B_importLibraryIntoEmptiedLibrary” ]
    Exit Script [ ]
    End If
    End If
    #
    #Check if this library file is being started
    #by an import script. If it is, the computer's
    #clipboard will contain this hopefully
    #impossible to get code from anywhere but the
    #library's two import scripts. This code tells
    #this library that it was opened only to
    #get its filepath. This filepath will be used
    #after this library file is closed by the library
    #file that opened it to import it records.
    Paste [ backup::backup ] [ Select ]
    Set Variable [ $ideasORthingsLibrary; Value:Left ( backup::backup ; 1 ) ]
    Set Variable [ $importCode; Value:Middle ( backup::backup ; 2 ; 999 ) ]
    Set Field [ backup::backup; $importCode ]
    #
    #
    #In the importDataFromABranchIntoThisMainLibrary
    #script an if calc determines if the library being
    #imported into is the opposite type (idea or
    #inventory) of this library. If it is the opposite
    #type, then the word 'idea' or 'inventory' is
    #pasted into the import-into library's backup
    #field, and then cut, and pasted into the library
    #these records are being imported into, so that
    #the import can be stopped.
    If [ backup::backup = "update439asdkc;liasdu;irejf.as.dkfupea;lksdfa,sm.eupqoiwendssasdeawsrre5o983498woeirf" ]
    #If library asking for import is a new library, and
    #so neither an idea or inventory library, then
    #proceed with getting filepath for this library,
    #and skip these exit import script steps.
    If [ Case (tempSetup::InventoryLibraryYN[1] ; 1 ; 2 ) ≠ $ideasORthingsLibrary and 0 ≠ $ideasORthingsLibrary ]
    Set Field [ backup::backup; Case (tempSetup::InventoryLibraryYN[1] ; "inventory" ; "ideas" ) ]
    Cut [ backup::backup ] [ Select ]
    Perform Script [ “closeLibrary” ]
    Exit Script [ ]
    #
    #
    #
    #
    #If this library is OK to import, then copy its file
    #path so that the importing library can have its
    #file path for the script
    #importDataFromABranchIntoThisMainLibrary
    #to complete the import process.
    Else
    Set Field [ backup::backup; "" ]
    Copy [ backup::filepath ] [ Select ]
    #
    #Prepare to import TEMP fields by making sure
    #there is a record to import.
    Go to Layout [ “tableTemp” (TEMP) ]
    Show All Records
    Delete All Records [ No dialog ]
    New Record/Request
    Perform Script [ “closeLibrary” ]
    Exit Script [ ]
    End If
    End If
    #
    #
    #This next bit cannot work as there is no way to
    #insure the computers universal clipboard was
    #used by FileMaker or the user during
    #the import process.
    // If [ backup::backup ≠ "update439asdkc;liasdu;irejf.as.dkfupea;lksdfa,sm.eupqoiwendssasdeawsrre5o983498woeirf" and backup::backup ≠ "" ]
    // Set Field [ backup::backup; "failure" ]
    // Cut [ backup::backup ] [ Select ]
    // Perform Script [ “closeLibrary” ]
    // Exit Script [ ]
    // End If
    #
    #
    #END: Manage new library creation process.
    #
    #
    #
    #BEGIN: Open library.
    #
    #Start database with just one window. This is
    #essential if user decides to restart the
    #database. This step eliminates the possibility
    #of extra windows.
    Loop
    Exit Loop If [ ValueCount ( WindowNames ( Get ( FileName ) ) ) = 1 ]
    Close Window [ Current Window ]
    End Loop
    #
    #Set zoom level to 100%.
    Set Zoom Level [ 100%; Camera: Back; Resolution: Full ]
    #
    #Resize window just in case it is a 1x1 point window!
    Move/Resize Window [ Current Window; Height: Get (WindowDesktopHeight) - 21; Width: Get (ScreenWidth) / 2; Top: 0; Left: 0 ]
    #
    #Clear these variables.
    Set Variable [ $$add ]
    Set Variable [ $$pause ]
    Set Variable [ $$tagtest ]
    Set Variable [ $$stopAdd ]
    Set Variable [ $$tagLayout ]
    Set Variable [ $$timeRecord ]
    Set Variable [ $$returnLayout ]
    Set Variable [ $$returnRecord ]
    Set Variable [ $$returnWindow ]
    Set Variable [ $$goBackToSetup ]
    Set Variable [ $$stopChangeName ]
    Set Variable [ $$stopLoadTestRecord ]
    Set Variable [ $$lockedMainRefRecord ]
    Set Variable [ $$doNotHaltOtherScripts ]
    Set Variable [ $$userInCopyrightWindow ]
    Set Variable [ $$lockedMainLearnRecord ]
    Set Variable [ $$stopOpenNewTextWindow ]
    Set Variable [ $$showFTmessageOnlyOnce ]
    Set Variable [ $$stopLoadingTestSubSection ]
    Set Variable [ $$lockedMainSubsectionRecord ]
    Set Variable [ $$showCreatorNodemessageOnlyOnce ]
    #
    #Clear test temporary template fields.
    Set Field [ TEMP::reportNumber; "" ]
    Set Field [ TEMP::DEFAULTSectionName; "" ]
    Set Field [ TEMP::kdefaultSectionTemplate; "" ]
    #IMPORTANT!!! DO NOT clear the test subject!
    #Warning messages are affected if cleared, and
    #in general user will be annoyed because the
    #test subject will show as selected in the Setup
    #Node menu, but will not show up anywhere
    #else as the library knows what test subject is
    #selected thru this temp variable.
    // Set Field [ TEMP::DEFAULTNodeTestSubjectName; "" ]
    #
    #Clear the message remember variable. They
    #are used to show user a message only once
    #per session.
    Set Variable [ $$rememberTestItemChoice ]
    Set Variable [ $$showReportItemCommentOnce ]
    Set Variable [ $$stopShowingTestItemLockMessage ]
    #
    #Force system to calculate new values if
    #needed by deleting current and creating new
    #default's record.
    Go to Layout [ “tableTemp” (TEMP) ]
    Show All Records
    Delete All Records [ No dialog ]
    New Record/Request
    #
    #
    #Get library ID if this key field is blank.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    If [ TEMP::klibrary = "" or TEMP::userLibraryName = "" ]
    Go to Layout [ “tableTagGroup” (testSubsectionGroup) ]
    Enter Find Mode [ ]
    Set Field [ testSubsectionGroup::match; "library" ]
    Perform Find [ ]
    #
    Set Field [ TEMP::klibrary; testSubsectionGroup::_Lgroup ]
    Set Field [ TEMP::userLibraryName; testSubsectionGroup::name ]
    Set Field [ TEMP::userLibraryVersionNumber; testSubsectionGroup::versionNumber ]
    End If
    #
    #Re-title and re-size main library setup window.
    Go to Layout [ “defaultSetup” (librarySetupReferenceMain) ]
    Set Window Title [ Current Window; New Title: "Setup" ]
    Show/Hide Text Ruler [ Hide ]
    If [ Get ( SystemPlatform ) = - 2 ]
    Move/Resize Window [ Current Window; Height: Get (WindowDesktopHeight) - 21; Width: Get (ScreenWidth) / 2; Top: 0; Left: 0 ]
    Else
    Move/Resize Window [ Current Window; Height: Get (ScreenHeight); Width: Get (ScreenWidth) / 2; Top: 0; Left: 0 ]
    End If
    Go to Field [ ]
    #
    #Show all library setup references and sort
    #them by date so focus is on most current
    #setup reference.
    Show All Records
    Sort Records [ Keep records in sorted order; Specified Sort Order: librarySetupReferenceMain::publicationDate; descending ] [ Restore; No dialog ]
    Go to Record/Request/Page [ First ]
    #
    #Make sure library's creator node and
    #its tag node group exists.
    Perform Script [ “CHUNK_checkCreatorNodeAndPrimaryNode” ]
    #
    #Insure filelocation records are present,
    #and default copyright tags.
    Perform Script [ “CHUNK_CopyrightLockedFields” ]
    #
    #Insure during last session, user didn't drag
    #new spellings into locked tag records.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Go to Layout [ “ltagSCRIPTloops” (tagMenus) ]
    Show All Records
    Set Variable [ $$stopLoadTagRecord ]
    Perform Script [ “CHUNK_checkForDraggedPasteChanges” ]
    #
    #Open Setup's Tag-Menus window.
    If [ Get ( SystemPlatform ) = - 2 ]
    New Window [ Name: "Tag Menus"; Height: Get (WindowDesktopHeight) - 21; Width: Get (ScreenWidth) / 2; Top: 0; Left: Get (ScreenWidth) / 2; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Else
    New Window [ Name: "Tag Menus"; Height: Get (ScreenHeight); Width: Get (ScreenWidth) / 2; Top: 0; Left: Get (ScreenWidth) / 2; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    End If
    #
    #Show regular menus if Admin logs in only.
    If [ Get ( AccountName ) = "Admin" ]
    Go to Layout [ “defaultsAll” (tempSetup) ]
    Show/Hide Toolbars [ Hide ]
    Select Window [ Name: "Setup"; Current file ]
    Show/Hide Toolbars [ Hide ]
    Print Setup [ Orientation: Portrait; Paper size: 8.5" x 11111" ] [ Restore; No dialog ]
    Else
    Go to Layout [ “defaultsAll” (tempSetup) ]
    Show/Hide Toolbars [ Lock; Hide ]
    Select Window [ Name: "Setup"; Current file ]
    Show/Hide Toolbars [ Lock; Hide ]
    Print Setup [ Orientation: Portrait; Paper size: 8.5" x 11" ] [ Restore; No dialog ]
    End If
    #
    #Set library defaults.
    Perform Script [ “defaultLibraryButton” ]
    If [ tempSetup::InventoryLibraryYN = "" and tempSetup::InventoryLibraryYN[2] = "" ]
    #Set default layout views for
    #a reference library.
    Set Field [ tempSetup::layoutLtagK; "" ]
    Set Field [ tempSetup::layoutRtagK; "" ]
    Set Field [ tempSetup::layoutLtagN; "" ]
    Set Field [ tempSetup::layoutRtagN; "" ]
    #
    #Designate library as a reference library.
    Set Field [ libraryNameAndInfo::orderOrLibraryType; "" ]
    Set Field [ TEMP::InventoryLibraryYN[2]; 1 ]
    End If
    #
    #Set test section to hide FT results.
    Set Field [ TEMP::testHideFormTextItemsFTs; 1 ]
    #
    #Tell other databases to go to this library
    #when user clicks the 'library' button in
    #another Help Give Thanks database.
    Set Field [ MemorySwitch::currentLibraryWIndows; "Setup" ]
    Set Field [ MemorySwitch::currentLibraryWIndows[2]; "Tag Menus" ]
    Set Field [ MemorySwitch::currentLibraryWIndows[3]; "" ]
    Go to Layout [ “startMemorySwitch” (MemorySwitch) ]
    Show All Records
    #
    Go to Record/Request/Page [ First ]
    Loop
    If [ Get (SystemPlatform) = 3 ]
    Exit Loop If [ Get ( FileName ) = MemorySwitch::name ]
    Else
    Exit Loop If [ Get ( FilePath ) = MemorySwitch::path or Get ( FileName ) = MemorySwitch::name and MemorySwitch::path = "" ]
    End If
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #On the iPhone/iPad, leave the path field
    #blank. This script will add the path when
    #used on a desktop/laptop. This allows one
    #record per library, using the name to find it
    #on iDevices and the path to find it on full
    #computers.
    If [ Get ( FileName ) = MemorySwitch::name and MemorySwitch::path = "" and Get (SystemPlatform) ≠ 3 ]
    Set Field [ MemorySwitch::path; TEMP::filePath ]
    Else If [ Get ( FileName ) ≠ MemorySwitch::name and Get ( FilePath ) ≠ MemorySwitch::path and Get (SystemPlatform) ≠ 3 ]
    New Record/Request
    Set Field [ MemorySwitch::path; TEMP::filePath ]
    Set Field [ MemorySwitch::name; TEMP::fileName ]
    Else If [ Get ( FileName ) ≠ MemorySwitch::name and Get (SystemPlatform) = 3 ]
    New Record/Request
    Set Field [ MemorySwitch::name; TEMP::fileName ]
    End If
    #
    #Get file path and name.
    Set Field [ MemorySwitch::currentLibraryPath; Get ( FilePath ) ]
    Set Field [ MemorySwitch::currentLibraryName; TEMP::fileName ]
    #
    #Report version number to Memory Switch Table.
    Set Field [ MemorySwitch::versionLibrary; tempSetup::versionNumber ]
    #
    #Go to the main layout.
    Go to Layout [ “defaultSetup” (librarySetupReferenceMain) ]
    #
    #Show regular menus if Admin logs and set the
    #print page size for one long page so when
    #generating PDFs for GitHub a scripts title will
    #be shown only once (it shows multiple times if
    #the script takes several letter size pages).
    Show/Hide Text Ruler [ Hide ]
    If [ Get ( AccountName ) = "Admin" ]
    Show/Hide Toolbars [ Hide ]
    Install Menu Set [ “[Standard FileMaker Menus]” ]
    Print Setup [ Orientation: Portrait; Paper size: 8.5" x 1000" ] [ Restore; No dialog ]
    Else
    Show/Hide Toolbars [ Lock; Hide ]
    Install Menu Set [ “HGT” ]
    Print Setup [ Orientation: Portrait; Paper size: 8.5" x 11" ] [ Restore; No dialog ]
    End If
    #
    #Warn user if the library files are on the
    #desktop and not in a folder.
    If [ PatternCount ( Get (FilePath) ; "/desktop/" & Get ( FileName )) ]
    Show Custom Dialog [ Message: "This library will not work properly from the destop of your computer. It needs to go in its own folder, inside the folder where the ActionLog and Reference files are located. Click ? for more information."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #Finish setting up the new library.
    If [ $$newLibraryNextSteps = 1 ]
    Set Variable [ $$newLibraryNextSteps ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Perform Script [ “defaultNodeMenu” ]
    Show Custom Dialog [ Message: "Your new library is almost ready! Change the name of the first node to your name since you will be the creator of new library records."; Default Button: “OK”, Commit: “Yes” ]
    Show Custom Dialog [ Message: "Select the default copyright for your new records, and last, click 'main' and change the name of library X to make this library ready for use."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #Finish the upgrade to a new library file.
    If [ $$import = 1 ]
    Set Variable [ $$import ]
    #
    #Force remaking of picture thumbnails to sure
    #all pictures have thumbnails with the current
    #database's specified dimensions.
    Perform Script [ “Interactivate” ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Show Custom Dialog [ Message: "Import is complete! Make sure you're selected as the primary node (the one creating new records), and check your selected copyright!"; Default Button: “OK”, Commit: “Yes” ]
    Perform Script [ “defaultNodeMenu” ]
    End If
    #
    #Finish the import of new records.
    If [ $$addRecords = 1 ]
    #
    #Force remaking of picture thumbnails to sure
    #all pictures have thumbnails with the current
    #database's specified dimensions.
    Set Variable [ $$addRecords ]
    Perform Script [ “Interactivate” ]
    Show Custom Dialog [ Message: "Successful import! Delete the backup file created before this import. It now lacks the files, just imported. Of course, it is always good to regularly backup your most current Library file."; Default Button: “OK”, Commit: “No” ]
    #
    #
    #Inform the user if this library's name
    #was changed.
    If [ $$libraryNameWASChanged ≠ "" ]
    Show Custom Dialog [ Message: "This library's name was changed during the import from " & $$libraryNameForNameChangeCheck & " to " & $$libraryNameWASChanged & "."; Default Button: “OK”, Commit: “No” ]
    End If
    #
    #Inform the user if the primary node's name
    #was changed.
    If [ TEMP::DEFAULTNodePrimaryName ≠ $$primaryNodeNameChangeCheck ]
    Show Custom Dialog [ Message: "This library's primary node's name was changed during the import from " & $$primaryNodeNameChangeCheck & " to " & TEMP::DEFAULTNodePrimaryName & "."; Default Button: “OK”, Commit: “No” ]
    End If
    #
    #Inform the user if the test subject's name
    #was changed.
    If [ TEMP::DEFAULTNodeTestSubjectName ≠ $$testSubjectNodeNameChangeCheck ]
    Show Custom Dialog [ Message: "This library's test subject node's name was changed during the import from " & $$testSubjectNodeNameChangeCheck & " to " & TEMP::DEFAULTNodeTestSubjectName & "."; Default Button: “OK”, Commit: “No” ]
    End If
    #
    Set Variable [ $$libraryNameWASChanged ]
    Set Variable [ $$primaryNodeNameChangeCheck ]
    Set Variable [ $$libraryNameForNameChangeCheck ]
    Set Variable [ $$testSubjectNodeNameChangeCheck ]
    #
    End If
    #
    #END: Open library.
    #
    #Halt any scripts that may be running after
    #the user elects to restart the library.
    Halt Script
    #

Fields used in this script

    backup::newLibrary
    tempSetup::versionNumber
    backup::backup
    tempSetup::InventoryLibraryYN
    backup::filepath
    TEMP::reportNumber
    TEMP::DEFAULTSectionName
    TEMP::kdefaultSectionTemplate
    TEMP::DEFAULTNodeTestSubjectName
    TEMP::klibrary
    TEMP::userLibraryName
    testSubsectionGroup::match
    testSubsectionGroup::_Lgroup
    testSubsectionGroup::name
    testSubsectionGroup::versionNumber
    TEMP::userLibraryVersionNumber
    librarySetupReferenceMain::publicationDate
    tempSetup::layoutLtagK
    tempSetup::layoutRtagK
    tempSetup::layoutLtagN
    tempSetup::layoutRtagN
    libraryNameAndInfo::orderOrLibraryType
    TEMP::InventoryLibraryYN
    TEMP::testHideFormTextItemsFTs
    MemorySwitch::currentLibraryWIndows
    MemorySwitch::name
    MemorySwitch::path
    TEMP::filePath
    TEMP::fileName
    MemorySwitch::currentLibraryPath
    MemorySwitch::currentLibraryName
    MemorySwitch::versionLibrary
    TEMP::DEFAULTNodePrimaryName

Scripts used in this script

    newLibraryStep2_EraseRecordsInCopyOfLibrary
    newLibraryStep3A_makeEmptiedLibraryANewLibrary
    newLibraryStep3B_importLibraryIntoEmptiedLibrary
    closeLibrary
    CHUNK_checkCreatorNodeAndPrimaryNode
    CHUNK_CopyrightLockedFields
    CHUNK_checkForDraggedPasteChanges
    defaultLibraryButton
    defaultNodeMenu
    Interactivate

Layouts used in this script

    backup
    defaultSetup
    tableTemp
    tableTagGroup
    ltagSCRIPTloops
    defaultsAll
    startMemorySwitch

Tables used in this script

    MemorySwitch
    TEMP
    TEMP
    backup
    setupReference
    tagGroup
    tagGroup

Table occurrences used by this script

    MemorySwitch
    TEMP
    backup
    libraryNameAndInfo
    librarySetupReferenceMain
    tempSetup
    testSubsectionGroup

Custom Functions used by this script

Custom menu set used by this script

    [Standard FileMaker Menus]
    HGT


tagMenu
	Parent Folder: [tagMenu]	Next Script: [addORremoveOtherTagStep1]
Script Name	addInitialDateTimeToTextField
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    testMenuTestItem
    reportTagItem

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #
    #On the test-item layout, set this stop check
    #or text variable to allows the user to click into
    #this field for the purpose of navigating to a
    #new record without changing the check or
    #text mark status.
    If [ $$stopCheckOrTest = 1 ]
    Set Variable [ $$stopCheckOrTest ]
    Exit Script [ ]
    End If
    #
    #
    #
    #Stop this script if any of the following are true:
    #
    #Test subject is locked.
    If [ $$testSubjectIsLocked ≠ "" and Get ( LayoutName ) ≠ "defaultTest" and Get ( LayoutName ) ≠ "learnTest" ]
    Show Custom Dialog [ Message: "The test subject — " & $$testSubjectIsLocked & " — is locked. To unlock, A) go back to the setup node tag menu. B) Select this test subject. C) Click 'lock' and enter the password."; Default Button: “OK”, Commit: “No” ]
    Set Variable [ $exit; Value:1 ]
    End If
    #
    #Primary node is locked.
    If [ TEMP::primaryNodeIsLocked ≠ "" ]
    If [ $exit = "" ]
    Show Custom Dialog [ Message: "The default primary node — " & TEMP::DEFAULTNodePrimaryName & " — is locked. Go to the Default Node Tag Menu and A) click 'lock' to unlock it, B) select an unlocked node for the primary node, or C) create a new primary node."; Default Button: “OK”, Commit: “No” ]
    Else
    Show Custom Dialog [ Message: "ALSO, the default primary node — " & TEMP::DEFAULTNodePrimaryName & " — is locked. Go to the Default Node Tag Menu and A) click 'lock' to unlock it, B) select an unlocked node for the primary node, or C) create a new primary node."; Default Button: “OK”, Commit: “No” ]
    End If
    Set Variable [ $exit; Value:1 ]
    End If
    #
    #If any of the above are true, then
    #exit this script.
    If [ $exit = 1 ]
    Exit Script [ ]
    End If
    #
    #
    #
    #Admin tasks.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    Go to Field [ ]
    #
    #
    #
    #BEGIN Create the text block to be inserted.
    #
    #
    #Initials
    Set Variable [ $initial; Value:TEMP::textDateIntialTime[2] ]
    #
    #TimeStamp
    If [ TEMP::textDateIntialTime = 1 ]
    If [ $initial = "" ]
    Set Variable [ $time; Value:Left ( DayName ( Get ( CurrentDate ) ) ; 3 ) & " " & Month ( Get ( CurrentDate ) ) & "/" & Day ( Get ( CurrentDate ) ) & "/" & Middle ( Year ( Get ( CurrentDate ) ) ; 3 ; 2 ) & " " & Case ( Right ( Left ( Get ( CurrentTime ) ; 5 ) ; 1 ) = ":" ; Left ( Get ( CurrentTime ) ; 4 ) ; Left ( Get ( CurrentTime ) ; 5 ) ) & " " & Right ( Get ( CurrentTime ) ; 2 ) ]
    Else
    Set Variable [ $time; Value:" | " & Left ( DayName ( Get ( CurrentDate ) ) ; 3 ) & " " & Month ( Get ( CurrentDate ) ) & "/" & Day ( Get ( CurrentDate ) ) & "/" & Middle ( Year ( Get ( CurrentDate ) ) ; 3 ; 2 ) & " " & Case ( Right ( Left ( Get ( CurrentTime ) ; 5 ) ; 1 ) = ":" ; Left ( Get ( CurrentTime ) ; 4 ) ; Left ( Get ( CurrentTime ) ; 5 ) ) & " " & Right ( Get ( CurrentTime ) ; 2 ) ]
    End If
    End If
    #
    #Time Spent
    If [ TEMP::textDateIntialTime[3] ≠ "" ]
    Show Custom Dialog [ Message: "Enter time spent."; Default Button: “OK”, Commit: “Yes”; Input #1: TEMP::textDateIntialTime[3], "hours"; Input #2: TEMP::textDateIntialTime[4], "minutes" ]
    If [ $initial = "" and $time = "" ]
    Set Variable [ $minutes; Value:Case ( TEMP::textDateIntialTime[3] = "" or TEMP::textDateIntialTime[3] = "0" or TEMP::textDateIntialTime[3] = "00" ; 0 ; TEMP::textDateIntialTime[3] ) & "h " & TEMP::textDateIntialTime[4] & "m" ]
    Else
    Set Variable [ $minutes; Value:" | " & Case ( TEMP::textDateIntialTime[3] = "" or TEMP::textDateIntialTime[3] = "0" or TEMP::textDateIntialTime[3] = "00" ; 0 ; TEMP::textDateIntialTime[3] ) & "h " & TEMP::textDateIntialTime[4] & "m" ]
    End If
    End If
    #
    #Combine the text text blocks into one line of text.
    Set Variable [ $tag; Value:" " & TextStyleAdd ( TextSize ( TextFont ( TextColor ( Case ( $initial ≠ "" ; $initial ; "" ) & Case ( $time ≠ "" ; $time ; "" ) & Case ( $minutes ≠ "" ; $minutes ; "" ) ;RGB(177 ; 177 ; 177 )) ; "Arial" ) ; 16 ) ; Plain ) & " " ]
    #
    #If there are no selected items to compose
    #a text block, then exit the script.
    If [ (TEMP::textDateIntialTime = 1 or TEMP::textDateIntialTime[2] ≠ "" or TEMP::textDateIntialTime[3] ≠ "") = 0 ]
    Show Custom Dialog [ Message: "Enter intials or click on the date or time buttons to create a an information text block to insert."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #END Create the text block to be inserted.
    #
    #
    #
    #BEGIN Insert text block.
    #
    #
    #See if the user in the test section
    #or report section.
    Select Window [ Name: "Test"; Current file ]
    If [ Get ( LastError )= 112 ]
    Select Window [ Name: "Report"; Current file ]
    End If
    #
    #Make sure the cursor is in active field and if
    #not tell them to click in one.
    If [ Get ( ActiveFieldName ) = "" ]
    Show Custom Dialog [ Message: "To insert this text — " & Trim ($tag) & " — 1) click into a field, and then 2) click exactly where you want it inserted in the field."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    #
    #Insert the text block.
    Else
    If [ Get ( ActiveFieldContents ) = "" ]
    Insert Calculated Result [ $tag ]
    Else
    Insert Calculated Result [ $tag & ¶ ]
    End If
    End If
    #
    Exit Script [ ]
    #
    #
    #END Insert text block.
    #
    #

Fields used in this script

    TEMP::primaryNodeIsLocked
    TEMP::DEFAULTNodePrimaryName
    TEMP::textDateIntialTime
    <Missing Field>

Scripts used in this script

Layouts used in this script

Tables used in this script

    TEMP

Table occurrences used by this script

    TEMP

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [addInitialDateTimeToTextField]	Parent Folder: [tagMenu]	Next Script: [addORremoveOtherTagStep2_keyword]
Script Name	addORremoveOtherTagStep1
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultNode1
    defaultNode2
    defaultNodeS2
    defaultNode3
    defaultNodeS3
    defaultNodeS4
    defaultNode4
    ReferenceMenu2keywordOrNode1
    ReferenceMenu2keywordOrNode2
    ReferenceMenu2keywordOrNode3
    ReferenceMenu2keywordOrNode4
    ReferenceMenu2keywordOrNode5
    addMenu2
    addMenuTestItem
    ltagNK1
    ltagNKs1
    ltagNK2
    ltagNKs2
    ltagNK3
    ltagNKs3
    ltagNK4
    ltagNKs4
    ltagNK5
    ltagNKs5

Scripts that use this script

Script Definition
Script Steps

    #
    #Stop script if user is looking at item/detail tags
    #in add mode, as these tags cannot be applied
    #to reference records.
    If [ $$add = 1 and $$citationMatch = "testItem" ]
    Show Custom Dialog [ Message: "You cannot tag reference records with item tags. So why then are there buttons? The buttons show up because I have not made time to create a separate layout just for item tags. This issue has been logged as a minor irritation."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #If main record node is currenlty locked then
    #stop script and inform the user.
    If [ $$citationMatch ≠ "path" and $$citationMatch ≠ "key" and $$citationMatch ≠ "brainstorm" and $$citationMatch ≠ "test" ]
    If [ $$lockedMainRefRecord ≠ "" and Left ( Get (LayoutName) ; 1 ) = "r" ]
    Show Custom Dialog [ Message: "Tags cannot be added or removed from locked reference records (EXCEPTIONS — Key P and O tags and Path tags). Select this record's creator node — " & $$lockedMainRefRecord & " — in the setup window and enter the password to unlock it."; Default Button: “OK”, Commit: “Yes” ]
    Halt Script
    Else If [ $$lockedMainLearnRecord ≠ "" and Left ( Get (LayoutName) ; 1 ) = "l" ]
    Show Custom Dialog [ Message: "Tags cannot be added or removed from locked learn records. EXCEPTIONS — Key (P and O), Brainstorm, and Test tags. Select this record's creator node — " & $$lockedMainLearnRecord & " — in the setup window and enter the password to unlock it."; Default Button: “OK”, Commit: “Yes” ]
    Halt Script
    End If
    End If
    #
    #Reference Section Only
    #Because I keep forgetting to press find mode, this
    #bit of script is to confirm that the user really wants
    #to add or change the tag of the first record instead of
    #finding records with selected tag.
    If [ Left (Get (LayoutName) ; 3 ) = "ref" and $$stopAdd = "" ]
    If [ //Other nodes and keys match tagMenus::_Ltag & "¶" = FilterValues ( $$key ; tagMenus::_Ltag & "¶" ) and $$citationMatch = "key" or tagMenus::_Ltag & "¶" = FilterValues ( $$node ; tagMenus::_Ltag & "¶" ) and $$citationMatch = "node" ]
    Show Custom Dialog [ Message: "Remove Tag?" & ¶ & "OR " & ¶ & "Find references tagged with it?"; Default Button: “remove”, Commit: “Yes”; Button 2: “find”, Commit: “No”; Button 3: “cancel”, Commit: “No” ]
    Else
    Show Custom Dialog [ Message: "Add Tag?" & ¶ & "OR " & ¶ & "Find references tagged with it?"; Default Button: “add”, Commit: “Yes”; Button 2: “find”, Commit: “No”; Button 3: “cancel”, Commit: “No” ]
    End If
    If [ Get ( LastMessageChoice ) = 2 ]
    #This variable is needed because message choice 2
    #gets carried over to the Find Mode Script, which then
    #activates tag instead of reference record find mode.
    Set Variable [ $$ClearMessageChoice; Value:1 ]
    Perform Script [ “findMode” ]
    Exit Script [ ]
    Else If [ Get ( LastMessageChoice ) = 3 ]
    Set Variable [ $$referenceRecordOne ]
    Exit Script [ ]
    Else If [ Get ( LastMessageChoice ) = 1 ]
    Set Variable [ $$referenceRecordOne ]
    #
    #If a primary key is being changed into an
    #other key, then user needs to be informed
    #that this will change its location in the
    #References window.
    If [ $$citationItem = tagMenus::_Ltag and $$referenceSort = "" ]
    Set Variable [ $removedPrimaryKey; Value:1 ]
    End If
    End If
    End If
    #
    #
    #Turn off the T scripts variable once the
    #user selectes or unselects a tag. This variable
    #is set when the user navigates to a reference
    #field that is blank and triggers a Tag Menu script.
    Set Variable [ $$TgotoCitationMenuWithBlankField ]
    #
    #Leave field so user can see
    #conditional formatting.
    Go to Field [ ]
    #
    #Determine if user is looking at nodes or keywords.
    If [ $$citationMatch = "key" ]
    #
    #Create this variable for use in the next script
    #addORremoveTagFromCitationStep2, to stop
    #resorting of OtherKey tags, which do not
    #effect sort order.
    Set Variable [ $$otherKeyDoNotLoop; Value:1 ]
    #
    #Finish key addition or removal.
    Perform Script [ “addORremoveOtherTagStep2_keyword” ]
    #
    Set Variable [ $$otherKeyDoNotLoop ]
    #
    #
    #
    #
    If [ $removedPrimaryKey = 1 ]
    Show Custom Dialog [ Message: "The reference record will now move to its new subject/keyword location."; Default Button: “OK”, Commit: “Yes” ]
    If [ Get (LastMessageChoice) = 1 ]
    Select Window [ Name: "References"; Current file ]
    Go to Layout [ “ReferenceStuffScriptLoops” (reference) ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagKeywordPrimary::orderOrLock; based on value list: “order Pulldown List” tagKeywordPrimary::tag; ascending reference::referenceForReferenceWindow; ascending ] [ Restore; No dialog ]
    #
    #Go to reference record layout.
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “ReferenceStuff” (reference) ]
    Else
    Go to Layout [ “Reference” (reference) ]
    End If
    Select Window [ Name: "Tag Menus"; Current file ]
    End If
    End If
    #
    #
    #
    #
    Else If [ $$citationMatch = "node" ]
    Perform Script [ “addORremoveOtherTagStep2_node” ]
    Close Window [ Name: "reorder"; Current file ]
    Set Variable [ $$stopLoadTagRecord ]
    #
    #Remove author copyright holder if there are
    #no authors.
    If [ reference::knodeOther = "" and reference::knodePrimary = "" and reference::referenceNodes = "" ]
    #Perform removal for items with and without a
    #paragraph mark, as the last item in checklist
    #has no paragraph mark after it.
    If [ Filter ( reference::kcopyrightHolder ; "1" ) = 1 ]
    Show Custom Dialog [ Message: "Author is currently checked in the copyright section for this reference as a copyright holder. Remove this check?"; Default Button: “No”, Commit: “Yes”; Button 2: “Yes”, Commit: “No” ]
    If [ Get ( LastMessageChoice ) = 2 ]
    Set Field [ reference::kcopyrightHolder; Substitute ( reference::kcopyrightHolder ; "1" & "¶" ; "" ) ]
    Set Field [ reference::kcopyrightHolder; Substitute ( reference::kcopyrightHolder ; "1" ; "" ) ]
    End If
    End If
    End If
    #
    Select Window [ Name: "Tag Menus Change Back When Done"; Current file ]
    If [ Get ( WindowName ) = "Tag Menus Change Back When Done" ]
    Close Window [ Name: "Tag Menus"; Current file ]
    Set Window Title [ Of Window: "Tag Menus Change Back When Done"; Current file; New Title: "Tag Menus" ]
    End If
    Refresh Window
    End If
    #

Fields used in this script

    tagMenus::_Ltag
    tagKeywordPrimary::orderOrLock
    tagKeywordPrimary::tag
    reference::referenceForReferenceWindow
    TEMP::InventoryLibraryYN
    reference::knodeOther
    reference::knodePrimary
    reference::referenceNodes
    reference::kcopyrightHolder

Scripts used in this script

    findMode
    addORremoveOtherTagStep2_keyword
    addORremoveOtherTagStep2_node

Layouts used in this script

    ReferenceStuffScriptLoops
    ReferenceStuff
    Reference

Tables used in this script

    TEMP
    reference
    tag
    tag

Table occurrences used by this script

    TEMP
    reference
    tagKeywordPrimary
    tagMenus

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [addORremoveOtherTagStep1]	Parent Folder: [tagMenu]	Next Script: [addORremoveOtherTagStep2_node]
Script Name	addORremoveOtherTagStep2_keyword
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    addORremoveOtherTagStep1
    addORremovePrimaryTag

Script Definition
Script Steps

    #
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    #
    #This script adds tags to main reference or learn
    #other tag fields.
    If [ $$skipFirstPartOfScript ≠ 1 ]
    #
    #Get current reference or learn record key.
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    Set Variable [ $$key; Value:testlearn::kcKeywordOther ]
    Else If [ Get (LastError) ≠ 112 ]
    Set Variable [ $$key; Value:reference::kkeywordOther ]
    End If
    #
    Select Window [ Name: "Tag Menus" ]
    #
    #Create a new window in order to perform the next part
    #without moving from the reccord in the tag window.
    #To do this, as this is being added after the script below
    #was written, a hack is needed (so not the best way to
    #accomplish this). Rename the current window and then
    #call the new window Tag Menus. Then when done undo
    #the renaming.
    Set Variable [ $currentSelectedTag; Value:tagMenus::_Ltag ]
    Set Variable [ $closeWindowWhenDone; Value:1 ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Set Window Title [ Current Window; New Title: "Tag Menus Change Back When Done" ]
    // New Window [ Name: "Tag Menus"; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    New Window [ Name: "Tag Menus"; Height: 1; Width: 1; Top: -1000; Left: -1000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    #
    #Make sure all tags are showing. User may be only
    #showing a few of the tags after performing a find.
    Enter Find Mode [ ]
    Set Field [ tagMenus::match; $$citationMatch ]
    Perform Find [ ]
    #
    #Now loop to user selected tag.
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ $currentSelectedTag = tagMenus::_Ltag ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #If tag user clicked has not been added, then add it.
    If [ tagMenus::_Ltag & "¶" ≠ FilterValues ( $$key ; tagMenus::_Ltag & "¶" ) ]
    #
    #
    #Check for duplicates, prior to adding to a record.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Set Variable [ $tagKey; Value:tagMenus::_Ltag ]
    Set Variable [ $tagName; Value:tagMenus::tag ]
    Set Variable [ $tagMatch; Value:tagMenus::match ]
    New Window [ Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Enter Find Mode [ ]
    Set Field [ tagMenus::match; $tagMatch ]
    Set Field [ tagMenus::tag; "==" & $tagName ]
    Perform Find [ ]
    Go to Record/Request/Page [ First ]
    If [ Get ( FoundCount ) > 1 ]
    Loop
    Exit Loop If [ tagMenus::_Ltag = $tagKey ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    Set Field [ tagMenus::tag; $tagName & tagMenus::_Ltag ]
    Set Field [ tagMenus::tagSpelling; $tagName & tagMenus::_Ltag ]
    #
    Close Window [ Current Window ]
    Show Custom Dialog [ Message: "Keywords must have different spellings. The ID number has been added to this keyword to make it different from its duplicate. Please do change it to something meaningful."; Default Button: “OK”, Commit: “Yes” ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Else If [ Get ( FoundCount ) ≤ 1 ]
    Close Window [ Current Window ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    End If
    #
    #
    #
    Set Variable [ $newKey; Value:tagMenus::_Ltag ]
    #
    #Set record number so can return user to it when done.
    Set Variable [ $recordNumber; Value:Get (RecordNumber) ]
    #
    #Add keyword in reference or observation window.
    #
    #
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    Set Field [ testlearn::kcKeywordOther; $newKey & "¶" & $$key ]
    Set Variable [ $$key; Value:testlearn::kcKeywordOther ]
    If [ testlearn::kKeywordPrimary = $newKey ]
    Set Field [ testlearn::kKeywordPrimary; "" ]
    Set Variable [ $$citationItem ]
    End If
    Go to Field [ ]
    Else If [ Get (LastError) ≠ 112 ]
    Set Field [ reference::kkeywordOther; $newKey & "¶" & $$key ]
    Set Variable [ $$key; Value:reference::kkeywordOther ]
    If [ reference::kkeywordPrimary = $newKey ]
    Set Field [ reference::kkeywordPrimary; "" ]
    Set Variable [ $$citationItem ]
    End If
    Go to Field [ ]
    End If
    #
    #
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    #
    #Now re-alphabetize and add new keyword to citation.
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenus::tag; ascending ] [ Restore; No dialog ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Go to Record/Request/Page [ First ]
    #
    #
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    Set Variable [ $otherKeys; Value:testlearn::OtherKeyWords ]
    Else If [ Get (LastError) ≠ 112 ]
    Set Variable [ $otherKeys; Value:reference::OtherKeyWords ]
    End If
    #
    #
    #Find and set first value in keyword list.
    #It will not have a comma in front like the other items.
    Select Window [ Name: "Tag Menus"; Current file ]
    Loop
    If [ tagMenus::_Ltag & "¶" = FilterValues ( $$key ; tagMenus::_Ltag & "¶" ) ]
    Set Variable [ $newKey; Value:tagMenus::tag ]
    #
    #
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    Set Field [ testlearn::OtherKeyWords; $newKey ]
    Set Variable [ $otherKeys; Value:testlearn::OtherKeyWords ]
    Else If [ Get (LastError) ≠ 112 ]
    Set Field [ reference::OtherKeyWords; $newKey ]
    Set Variable [ $otherKeys; Value:reference::OtherKeyWords ]
    End If
    End If
    #
    #
    Select Window [ Name: "Tag Menus"; Current file ]
    Exit Loop If [ tagMenus::_Ltag & "¶" = FilterValues ( $$key ; tagMenus::_Ltag & "¶" ) ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Now add remaining keywords to list.
    Loop
    Go to Record/Request/Page [ Next; Exit after last ]
    If [ tagMenus::_Ltag & "¶" = FilterValues ( $$key ; tagMenus::_Ltag & "¶" ) ]
    Set Variable [ $newKey; Value:tagMenus::tag ]
    #
    #
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    Set Field [ testlearn::OtherKeyWords; $otherKeys & ", " & $newKey ]
    Set Variable [ $otherKeys; Value:testlearn::OtherKeyWords ]
    Else If [ Get (LastError) ≠ 112 ]
    Set Field [ reference::OtherKeyWords; $otherKeys & ", " & $newKey ]
    Set Variable [ $otherKeys; Value:reference::OtherKeyWords ]
    End If
    End If
    #
    #
    Select Window [ Name: "Tag Menus"; Current file ]
    End Loop
    #
    #Commit records so user can change spelling.
    #Without commit records the system will not find
    #the newly added tag.
    Commit Records/Requests
    Go to Field [ ]
    #
    #Sort records according to users wishes.
    If [ TEMP::sortKey = "cat" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    Else If [ TEMP::sortKey = "abc" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenus::tag; ascending ] [ Restore; No dialog ]
    End If
    Set Variable [ $$stopLoadTagRecord ]
    Set Variable [ $$doNotHaltOtherScripts; Value:1 ]
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    Go to Record/Request/Page [ $recordNumber ] [ No dialog ]
    #
    #Now close working Tag Menus window and rename
    #users Tag Menus window to Tag Menus.
    Close Window [ Name: "Tag Menus"; Current file ]
    Set Window Title [ Of Window: "Tag Menus Change Back When Done"; Current file; New Title: "Tag Menus" ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    Set Variable [ $$doNotHaltOtherScripts ]
    Exit Script [ ]
    End If
    #
    #
    #
    #
    #If tag has been selected, then remove it.
    Set Variable [ $removeKey; Value:tagMenus::_Ltag ]
    #
    #Set record number so can return user to it when done.
    Set Variable [ $recordNumber; Value:Get (RecordNumber) ]
    #
    #
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    Set Field [ testlearn::kcKeywordOther; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used If ( ValueCount ( $$key ) ≠ ValueCount ( Substitute ( $$key ; $removekey & "¶" ; "" ) ) ; Substitute ( $$key ; $removekey & "¶" ; "" ) ; Substitute ( $$key ; $removekey ; "" ) ) ]
    Set Variable [ $$key; Value:testlearn::kcKeywordOther ]
    Go to Field [ ]
    Else If [ Get (LastError) ≠ 112 ]
    Set Field [ reference::kkeywordOther; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used If ( ValueCount ( $$key ) ≠ ValueCount ( Substitute ( $$key ; $removekey & "¶" ; "" ) ) ; Substitute ( $$key ; $removekey & "¶" ; "" ) ; Substitute ( $$key ; $removekey ; "" ) ) ]
    Set Variable [ $$key; Value:reference::kkeywordOther ]
    Go to Field [ ]
    End If
    End If
    #
    #
    #
    #
    #This next part of the script checks to see if
    #the otherKey field was affected.
    #
    If [ $$skipFirstPartOfScript = 1 ]
    #
    #
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    Set Variable [ $removeKey; Value:testlearn::kKeywordPrimary ]
    Else If [ Get (LastError) ≠ 112 ]
    Set Variable [ $removeKey; Value:reference::kkeywordPrimary ]
    End If
    #
    #
    Select Window [ Name: "Tag Menus"; Current file ]
    Set Variable [ $recordNumber; Value:Get (RecordNumber) ]
    Else If [ $$skipFirstPartOfScript ≠ 1 ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Set Variable [ $removeKey; Value:tagMenus::tag ]
    End If
    Refresh Window
    #
    #Now re-alphabetize after removing keyword.
    #
    #
    #
    If [ $$skipFirstPartOfScript = 1 ]
    Set Variable [ $$skipFirstPartOfScript ]
    #
    #
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    Set Variable [ $removeKey; Value:testlearn::kKeywordPrimary ]
    Else If [ Get (LastError) ≠ 112 ]
    Set Variable [ $removeKey; Value:reference::kkeywordPrimary ]
    End If
    #
    #
    Select Window [ Name: "Tag Menus"; Current file ]
    End If
    #
    #
    #
    #Order list alphabetically to re-construct otherKey
    #field belonging to the citation record.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    New Window [ Name: "reorder"; Height: 1; Width: 1; Top: -1000; Left: -1000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “ltagSCRIPTloops” (tagMenus) ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenus::tag; ascending ] [ Restore; No dialog ]
    Go to Record/Request/Page [ First ]
    #
    #
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    Set Variable [ $otherKeys; Value:testlearn::OtherKeyWords ]
    Set Variable [ $testLearnRecordKey; Value:testlearn::_Ltestlearn ]
    #
    #Clear the field now in case all tags have been de-selected.
    Set Field [ testlearn::OtherKeyWords; "" ]
    Go to Field [ ]
    Else If [ Get (LastError) ≠ 112 ]
    Set Variable [ $otherKeys; Value:reference::OtherKeyWords ]
    #
    #Clear the field now in case all tags have been de-selected.
    Set Field [ reference::OtherKeyWords; "" ]
    #
    #Re-sort records so library is back on the
    #selected record.
    If [ $$primaryKeyWord ≠ reference::kkeywordPrimary and $$citationMatch ≠ "cite" and $$stopAdd = "" and $$otherKeyDoNotLoop = "" and $$referenceSort = "" ]
    Set Variable [ $$primaryKeyWord ]
    Show Custom Dialog [ Message: "The reference record will now move to its new subject/keyword location."; Default Button: “OK”, Commit: “No” ]
    If [ Get (LastMessageChoice) = 1 ]
    Go to Layout [ “ReferenceStuffScriptLoops” (reference) ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagKeywordPrimary::orderOrLock; based on value list: “order Pulldown List” tagKeywordPrimary::tag; ascending reference::referenceForReferenceWindow; ascending ] [ Restore; No dialog ]
    #
    #Go to reference record layout.
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “ReferenceStuff” (reference) ]
    Else
    Go to Layout [ “Reference” (reference) ]
    End If
    End If
    End If
    End If
    #
    #
    #Find and set first value in keyword list.
    #It will not have a comma in front like the other items.
    Select Window [ Name: "reorder"; Current file ]
    Loop
    If [ tagMenus::_Ltag & "¶" = FilterValues ( $$key ; tagMenus::_Ltag & "¶" ) and tagMenus::tag ≠ $removeKey ]
    Set Variable [ $newKey; Value:tagMenus::tag ]
    #
    #
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    // Select Window [ Name: "Learn"; Current file ]
    Go to Layout [ “learnSCRIPTloops” (testlearn) ]
    If [ $testLearnRecordKey ≠ testlearn::_Ltestlearn ]
    Enter Find Mode [ ]
    Set Field [ testlearn::_Ltestlearn; $testLearnRecordKey ]
    Perform Find [ ]
    End If
    Set Field [ testlearn::OtherKeyWords; $newKey ]
    Set Variable [ $otherKeys; Value:testlearn::OtherKeyWords ]
    Else If [ Get (LastError) ≠ 112 ]
    Set Field [ reference::OtherKeyWords; $newKey ]
    Set Variable [ $otherKeys; Value:reference::OtherKeyWords ]
    End If
    End If
    #
    #
    Select Window [ Name: "reorder"; Current file ]
    Exit Loop If [ tagMenus::_Ltag & "¶" = FilterValues ( $$key ; tagMenus::_Ltag & "¶" ) and tagMenus::tag ≠ $removeKey ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Now add remaining keys to list.
    Go to Layout [ “ltagSCRIPTloops” (tagMenus) ]
    If [ Get (LastError) ≠ 101 ]
    Go to Record/Request/Page [ Next ]
    If [ Get (LastError) = 101 ]
    Set Variable [ $$stopLoadTagRecord ]
    Set Variable [ $$doNotHaltOtherScripts; Value:1 ]
    Close Window [ Name: "reorder"; Current file ]
    Set Variable [ $$skipFirstPartOfScript ]
    #
    #Now close working Tag Menus window and rename
    #users Tag Menus window to Tag Menus.
    If [ $closeWindowWhenDone = 1 ]
    Close Window [ Name: "Tag Menus"; Current file ]
    Set Window Title [ Of Window: "Tag Menus Change Back When Done"; Current file; New Title: "Tag Menus" ]
    End If
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    Set Variable [ $$doNotHaltOtherScripts ]
    Exit Script [ ]
    End If
    Loop
    If [ tagMenus::_Ltag & "¶" = FilterValues ( $$key ; tagMenus::_Ltag & "¶" ) and tagMenus::tag ≠ $removeKey ]
    Set Variable [ $newKey; Value:tagMenus::tag ]
    #
    #
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    // Select Window [ Name: "Learn"; Current file ]
    Go to Layout [ “learnSCRIPTloops” (testlearn) ]
    Set Field [ testlearn::OtherKeyWords; $otherKeys & ", " & $newKey ]
    Set Variable [ $otherKeys; Value:testlearn::OtherKeyWords ]
    Go to Layout [ “ltagSCRIPTloops” (tagMenus) ]
    Else If [ Get (LastError) ≠ 112 ]
    Set Field [ reference::OtherKeyWords; $otherKeys & ", " & $newKey ]
    Set Variable [ $otherKeys; Value:reference::OtherKeyWords ]
    End If
    End If
    #
    #
    Select Window [ Name: "reorder"; Current file ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    End If
    #
    Set Variable [ $$stopLoadTagRecord ]
    Close Window [ Name: "reorder"; Current file ]
    Set Variable [ $$skipFirstPartOfScript ]
    #
    #Now close working Tag Menus window and rename
    #users Tag Menus window to Tag Menus.
    If [ $closeWindowWhenDone = 1 ]
    Close Window [ Name: "Tag Menus"; Current file ]
    Set Window Title [ Of Window: "Tag Menus Change Back When Done"; Current file; New Title: "Tag Menus" ]
    End If
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    #

Fields used in this script

    testlearn::kcKeywordOther
    reference::kkeywordOther
    tagMenus::_Ltag
    tagMenus::match
    tagMenus::tag
    tagMenus::tagSpelling
    testlearn::kKeywordPrimary
    reference::kkeywordPrimary
    testlearn::OtherKeyWords
    reference::OtherKeyWords
    TEMP::sortKey
    tagMenuGroup::orderOrLibraryType
    tagMenuGroup::name
    tagMenus::orderOrLock
    testlearn::_Ltestlearn
    tagKeywordPrimary::orderOrLock
    tagKeywordPrimary::tag
    reference::referenceForReferenceWindow
    TEMP::InventoryLibraryYN

Scripts used in this script

Layouts used in this script

    ltagSCRIPTloops
    ReferenceStuffScriptLoops
    ReferenceStuff
    Reference
    learnSCRIPTloops

Tables used in this script

    TEMP
    reference
    tag
    tagGroup
    testlearn

Table occurrences used by this script

    TEMP
    reference
    tagKeywordPrimary
    tagMenuGroup
    tagMenus
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [addORremoveOtherTagStep2_keyword]	Parent Folder: [tagMenu]	Next Script: [addORremovePrimaryTag]
Script Name	addORremoveOtherTagStep2_node
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    addORremoveOtherTagStep1
    addORremovePrimaryTag

Script Definition
Script Steps

    #
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #This script adds tags to main reference or learn
    #other tag fields.
    If [ $$skipFirstPartOfScript ≠ 1 ]
    #
    #Get current record IDs in reference or
    #learn or setup window.
    #
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    If [ Get (LastError) = 112 ]
    // Select Window [ Name: "Setup"; Current file ]
    Set Variable [ $$node; Value:tempSetup::kdefaultNodeOther ]
    Else If [ Get (LastError) ≠ 112 ]
    Set Variable [ $$node; Value:testlearn::kNodeOther ]
    End If
    Else If [ Get (LastError) ≠ 112 ]
    Set Variable [ $$node; Value:reference::knodeOther ]
    End If
    #
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    #
    #Create a new window in order to perform the next part
    #without moving from the selected tag.
    #To do this, as this is being added after the script below
    #was written, a hack is needed (so not the best way to
    #accomplish this). Rename the current window and then
    #call the new window Tag Menus. Then when done undo
    #the renaming.
    Set Variable [ $currentSelectedTag; Value:tagMenus::_Ltag ]
    Set Variable [ $closeWindowWhenDone; Value:1 ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Set Window Title [ Current Window; New Title: "Tag Menus Change Back When Done" ]
    New Window [ Name: "Tag Menus"; Height: 1; Width: 1; Top: -10000; Left: -10000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    #
    #Make sure all tags are showing. User may be only
    #showing a few of the tags after performing a find.
    Enter Find Mode [ ]
    Set Field [ tagMenus::match; $$citationMatch ]
    Perform Find [ ]
    #
    #Now loop to user selected tag.
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ $currentSelectedTag = tagMenus::_Ltag ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #
    #If tag user clicked has not yet been selected, then add it.
    If [ tagMenus::_Ltag & "¶" ≠ FilterValues ( $$node ; tagMenus::_Ltag & "¶" ) ]
    #
    Set Variable [ $newNode; Value:tagMenus::_Ltag ]
    #
    #Set record number so can return user to it when done.
    Set Variable [ $recordNumber; Value:Get (RecordNumber) ]
    #
    #
    #Add node in reference or observation window.
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    If [ Get (LastError) = 112 ]
    // Select Window [ Name: "Setup"; Current file ]
    Set Field [ tempSetup::kdefaultNodeOther; $newNode & "¶" & $$Node ]
    Set Variable [ $$Node; Value:tempSetup::kdefaultNodeOther ]
    If [ tempSetup::kdefaultNodePrimary = $newNode ]
    Set Field [ tempSetup::kdefaultNodePrimary; "" ]
    Set Variable [ $$citationItem ]
    End If
    Go to Field [ ]
    Else If [ Get (LastError) ≠ 112 ]
    Set Field [ testlearn::kNodeOther; $newNode & "¶" & $$Node ]
    Set Variable [ $$Node; Value:testlearn::kNodeOther ]
    If [ testlearn::kNodePrimary = $newNode ]
    Set Field [ testlearn::kNodePrimary; "" ]
    Set Variable [ $$citationItem ]
    End If
    Go to Field [ ]
    End If
    Else If [ Get (LastError) ≠ 112 ]
    Set Field [ reference::knodeOther; $newNode & "¶" & $$Node ]
    Set Variable [ $$Node; Value:reference::knodeOther ]
    If [ reference::knodePrimary = $newNode ]
    Set Field [ reference::knodePrimary; "" ]
    Set Variable [ $$citationItem ]
    End If
    Go to Field [ ]
    End If
    #
    #
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    #
    #Now re-alphabetize and add new node to citation.
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenus::tag; ascending ] [ Restore; No dialog ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Go to Record/Request/Page [ First ]
    #
    #
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    If [ Get (LastError) = 112 ]
    // Select Window [ Name: "Setup"; Current file ]
    Set Variable [ $otherNodes; Value:tempSetup::DEFAULTNodeOtherNames ]
    Else If [ Get (LastError) ≠ 112 ]
    Set Variable [ $otherNodes; Value:testlearn::NodeOthers ]
    End If
    Else If [ Get (LastError) ≠ 112 ]
    Set Variable [ $otherNodes; Value:reference::NodeOthers ]
    End If
    #
    #
    #Find and set first value in node list.
    #It will not have a comma in front like the other items.
    Select Window [ Name: "Tag Menus"; Current file ]
    Loop
    If [ tagMenus::_Ltag & "¶" = FilterValues ( $$Node ; tagMenus::_Ltag & "¶" ) ]
    Set Variable [ $newNode; Value:tagMenus::tag ]
    #
    #
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    If [ Get (LastError) = 112 ]
    // Select Window [ Name: "Setup"; Current file ]
    Set Field [ tempSetup::DEFAULTNodeOtherNames; $newNode ]
    Set Variable [ $otherNodes; Value:tempSetup::DEFAULTNodeOtherNames ]
    Else If [ Get (LastError) ≠ 112 ]
    Set Field [ testlearn::NodeOthers; $newNode ]
    Set Variable [ $otherNodes; Value:testlearn::NodeOthers ]
    End If
    Else If [ Get (LastError) ≠ 112 ]
    Set Field [ reference::NodeOthers; $newNode ]
    Set Variable [ $otherNodes; Value:reference::NodeOthers ]
    #
    #If the user is adding a node tag to reference
    #record on the main reference layout, then
    #inform why they will not see it if the 'open
    #authors' field is filled in.
    If [ reference::referenceNodes ≠ "" and Get (LayoutName) = "Reference" ]
    Show Custom Dialog [ Message: "Because the open authors field is filled in, this node tag — while added to this reference — will not show up as a reference author. Click 'edit' to edit the open authors field and see this reference's node tags."; Default Button: “OK”, Commit: “Yes” ]
    End If
    End If
    End If
    #
    #
    Select Window [ Name: "Tag Menus"; Current file ]
    Exit Loop If [ tagMenus::_Ltag & "¶" = FilterValues ( $$Node ; tagMenus::_Ltag & "¶" ) ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Now add remaining nodes to list.
    Loop
    Go to Record/Request/Page [ Next; Exit after last ]
    If [ tagMenus::_Ltag & "¶" = FilterValues ( $$Node ; tagMenus::_Ltag & "¶" ) ]
    Set Variable [ $newNode; Value:tagMenus::tag ]
    #
    #
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    If [ Get (LastError) = 112 ]
    // Select Window [ Name: "Setup"; Current file ]
    Set Field [ tempSetup::DEFAULTNodeOtherNames; $otherNodes & "; " & $newNode ]
    Set Variable [ $otherNodes; Value:tempSetup::DEFAULTNodeOtherNames ]
    Set Variable [ $setup; Value:1 ]
    Else If [ Get (LastError) ≠ 112 ]
    Set Field [ testlearn::NodeOthers; $otherNodes & "; " & $newNode ]
    Set Variable [ $otherNodes; Value:testlearn::NodeOthers ]
    End If
    Else If [ Get (LastError) ≠ 112 ]
    Set Field [ reference::NodeOthers; $otherNodes & "; " & $newNode ]
    Set Variable [ $otherNodes; Value:reference::NodeOthers ]
    End If
    End If
    #
    #
    Select Window [ Name: "Tag Menus"; Current file ]
    // Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Commit records so user can change spelling.
    #Without commit, the system will not find
    #the newly added tag.
    Commit Records/Requests
    Go to Field [ ]
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    Set Variable [ $$stopLoadTagRecord ]
    Set Variable [ $$doNotHaltOtherScripts; Value:1 ]
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    Go to Record/Request/Page [ $recordNumber ] [ No dialog ]
    #
    #Now close working Tag Menus window and rename
    #users Tag Menus window to Tag Menus.
    Close Window [ Name: "Tag Menus"; Current file ]
    Set Window Title [ Of Window: "Tag Menus Change Back When Done"; Current file; New Title: "Tag Menus" ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    #
    #Select the default copyright for this node if blank.
    If [ tagMenus::notesOrCopyright = "" ]
    Set Field [ tagMenus::notesOrCopyright; TEMP::kdefaultCopyright ]
    Show Custom Dialog [ Message: "Because this node's copyright was blank it was given the library's default copyright."; Default Button: “OK”, Commit: “No” ]
    End If
    #
    Set Variable [ $$doNotHaltOtherScripts ]
    Exit Script [ ]
    End If
    End If
    #
    #
    #Give primary node the current copyright tag
    #for use when this node creates new test
    #sections, subsections, and items. It's OK if
    #the copyright has not yet been selected as
    #when first setting up a library. It will be
    #assigned to the primary node when the user
    #selects the default copyright or changes it.
    Select Window [ Name: "Tag Menus"; Current file ]
    If [ tagMenus::notesOrCopyright = "" ]
    Set Field [ tagMenus::notesOrCopyright; TEMP::kdefaultCopyright ]
    Refresh Window
    Show Custom Dialog [ Message: "This node's copyright has been updated to match the library's default copyright."; Default Button: “OK”, Commit: “Yes” ]
    Else If [ tagMenus::notesOrCopyright ≠ "" and tagMenus::notesOrCopyright ≠ tempSetup::kdefaultCopyright and tagMenus::_Ltag = tempSetup::kdefaultNodePrimary ]
    Set Variable [ $$copyright; Value:tagMenus::notesOrCopyright ]
    Set Field [ tempSetup::kdefaultCopyright; tagMenus::notesOrCopyright ]
    Refresh Window
    Show Custom Dialog [ Message: "The library's default copyright has been updated to match the default node's copyright."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #
    #If tag has been selected, then remove it from
    #the other node field if is there.
    Set Variable [ $removeNode; Value:tagMenus::_Ltag ]
    #
    #Set record number so can return user to it
    #when done checking the other node fields
    #containing other node names and keys.
    Set Variable [ $recordNumber; Value:Get (RecordNumber) ]
    #
    #
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    If [ Get (LastError) = 112 ]
    // Select Window [ Name: "Setup"; Current file ]
    Set Variable [ $$Node; Value:tempSetup::kdefaultNodeOther ]
    Set Field [ tempSetup::kdefaultNodeOther; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used If ( ValueCount ( $$Node ) ≠ ValueCount ( Substitute ( $$Node ; $removeNode & "¶" ; "" ) ) ; Substitute ( $$Node ; $removeNode & "¶" ; "" ) ; Substitute ( $$Node ; $removeNode ; "" ) ) ]
    Set Variable [ $$Node; Value:tempSetup::kdefaultNodeOther ]
    Go to Field [ ]
    Else If [ Get (LastError) ≠ 112 ]
    Set Field [ testlearn::kNodeOther; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used If ( ValueCount ( $$Node ) ≠ ValueCount ( Substitute ( $$Node ; $removeNode & "¶" ; "" ) ) ; Substitute ( $$Node ; $removeNode & "¶" ; "" ) ; Substitute ( $$Node ; $removeNode ; "" ) ) ]
    Set Variable [ $$Node; Value:testlearn::kNodeOther ]
    Go to Field [ ]
    End If
    Else If [ Get (LastError) ≠ 112 ]
    Set Field [ reference::knodeOther; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used If ( ValueCount ( $$Node ) ≠ ValueCount ( Substitute ( $$Node ; $removeNode & "¶" ; "" ) ) ; Substitute ( $$Node ; $removeNode & "¶" ; "" ) ; Substitute ( $$Node ; $removeNode ; "" ) ) ]
    Set Variable [ $$Node; Value:reference::knodeOther ]
    Go to Field [ ]
    End If
    #
    #
    #
    #
    #
    #
    #
    #This next part of the script checks to see if
    #the otherNode field was affected.
    If [ $$skipFirstPartOfScript = 1 ]
    #
    #
    #
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    If [ Get (LastError) = 112 ]
    // Select Window [ Name: "Setup"; Current file ]
    Set Variable [ $removeNode; Value:tempSetup::kdefaultNodePrimary ]
    Else If [ Get (LastError) ≠ 112 ]
    Set Variable [ $removeNode; Value:testlearn::kNodePrimary ]
    End If
    Else If [ Get (LastError) ≠ 112 ]
    Set Variable [ $removeNode; Value:reference::knodePrimary ]
    End If
    Select Window [ Name: "Tag Menus"; Current file ]
    Set Variable [ $recordNumber; Value:Get (RecordNumber) ]
    Else If [ $$skipFirstPartOfScript ≠ 1 ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Set Variable [ $removeNode; Value:tagMenus::tag ]
    End If
    Refresh Window
    #
    #
    #
    #
    #Now re-alphabetize after removing node.
    If [ $$skipFirstPartOfScript = 1 ]
    Set Variable [ $$skipFirstPartOfScript ]
    #
    #
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    If [ Get (LastError) = 112 ]
    // Select Window [ Name: "Setup"; Current file ]
    Set Variable [ $removeNode; Value:tempSetup::kdefaultNodePrimary ]
    Else If [ Get (LastError) ≠ 112 ]
    Set Variable [ $removeNode; Value:testlearn::kNodePrimary ]
    End If
    Else If [ Get (LastError) ≠ 112 ]
    Set Variable [ $removeNode; Value:reference::knodePrimary ]
    End If
    #
    #
    End If
    #
    #
    #Order list alphabetically to re-construct otherNode
    #field belonging to the citation record.
    // Sort Records [ ] [ No dialog ]
    // Set Variable [ $$stopLoadTagRecord; Value:1 ]
    // Go to Record/Request/Page [ First ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Select Window [ Name: "Tag Menus"; Current file ]
    New Window [ Name: "reorder"; Height: 1; Width: 1; Top: -1000; Left: -1000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “ltagSCRIPTloops” (tagMenus) ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenus::tag; ascending ] [ Restore; No dialog ]
    Go to Record/Request/Page [ First ]
    #
    #
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    If [ Get (LastError) = 112 ]
    // Select Window [ Name: "Setup"; Current file ]
    Set Variable [ $otherNodes; Value:tempSetup::DEFAULTNodeOtherNames ]
    #
    #Clear the field now in case all tags have been de-selected.
    Set Field [ tempSetup::DEFAULTNodeOtherNames; "" ]
    Else If [ Get (LastError) ≠ 112 ]
    Set Variable [ $otherNodes; Value:testlearn::NodeOthers ]
    #
    #Clear the field now in case all tags have been de-selected.
    Set Field [ testlearn::NodeOthers; "" ]
    End If
    Else If [ Get (LastError) ≠ 112 ]
    Set Variable [ $otherNodes; Value:reference::NodeOthers ]
    #
    #Clear the field now in case all tags have been de-selected.
    Set Field [ reference::NodeOthers; "" ]
    End If
    #
    #
    #Find and set first value in node list.
    #It will not have a comma in front like the other items.
    // Select Window [ Name: "Tag Menus"; Current file ]
    Select Window [ Name: "reorder"; Current file ]
    Go to Record/Request/Page [ First ]
    Loop
    If [ tagMenus::_Ltag & "¶" = FilterValues ( $$Node ; tagMenus::_Ltag & "¶" ) and tagMenus::tag ≠ $removeNode ]
    Set Variable [ $newNode; Value:tagMenus::tag ]
    #
    #
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Setup"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    // Go to Layout [ “learnSCRIPTloops” (testlearn) ]
    Set Field [ testlearn::NodeOthers; $newNode ]
    Set Variable [ $otherNodes; Value:testlearn::NodeOthers ]
    Else If [ Get (LastError) ≠ 112 ]
    Set Field [ tempSetup::DEFAULTNodeOtherNames; $newNode ]
    Set Variable [ $otherNodes; Value:tempSetup::DEFAULTNodeOtherNames ]
    End If
    Else If [ Get (LastError) ≠ 112 ]
    Set Field [ reference::NodeOthers; $newNode ]
    Set Variable [ $otherNodes; Value:reference::NodeOthers ]
    End If
    End If
    #
    #
    // Select Window [ Name: "Tag Menus"; Current file ]
    Select Window [ Name: "reorder"; Current file ]
    Exit Loop If [ tagMenus::_Ltag & "¶" = FilterValues ( $$Node ; tagMenus::_Ltag & "¶" ) and tagMenus::tag ≠ $removeNode ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Now add remaining nodes to alphabetical list.
    Go to Layout [ “ltagSCRIPTloops” (tagMenus) ]
    If [ Get (LastError) ≠ 101 ]
    Go to Record/Request/Page [ Next; Exit after last ]
    If [ Get (LastError) = 101 ]
    Set Variable [ $$stopLoadTagRecord ]
    Set Variable [ $$doNotHaltOtherScripts; Value:1 ]
    Close Window [ Name: "reorder"; Current file ]
    Set Variable [ $$skipFirstPartOfScript ]
    #
    #Now close working Tag Menus window and rename
    #users Tag Menus window to Tag Menus.
    If [ $closeWindowWhenDone = 1 ]
    Close Window [ Name: "Tag Menus"; Current file ]
    Set Window Title [ Of Window: "Tag Menus Change Back When Done"; Current file; New Title: "Tag Menus" ]
    End If
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    Set Variable [ $$doNotHaltOtherScripts ]
    Exit Script [ ]
    End If
    Loop
    If [ tagMenus::_Ltag & "¶" = FilterValues ( $$Node ; tagMenus::_Ltag & "¶" ) and tagMenus::tag ≠ $removeNode ]
    Set Variable [ $newNode; Value:tagMenus::tag ]
    #
    #
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Setup"; Current file ]
    Set Field [ tempSetup::DEFAULTNodeOtherNames; $otherNodes & "; " & $newNode ]
    Set Variable [ $otherNodes; Value:tempSetup::DEFAULTNodeOtherNames ]
    Else If [ Get (LastError) ≠ 112 ]
    // Go to Layout [ “learnSCRIPTloops” (testlearn) ]
    Set Field [ testlearn::NodeOthers; $otherNodes & "; " & $newNode ]
    Set Variable [ $otherNodes; Value:testlearn::NodeOthers ]
    End If
    Else If [ Get (LastError) ≠ 112 ]
    Set Field [ reference::NodeOthers; $otherNodes & "; " & $newNode ]
    Set Variable [ $otherNodes; Value:reference::NodeOthers ]
    End If
    End If
    #
    #
    // Select Window [ Name: "Tag Menus"; Current file ]
    Select Window [ Name: "reorder"; Current file ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    End If
    #
    Close Window [ Name: "reorder"; Current file ]
    Set Variable [ $$skipFirstPartOfScript ]
    #
    #Now close working Tag Menus window and rename
    #users Tag Menus window to Tag Menus.
    If [ $closeWindowWhenDone = 1 ]
    Close Window [ Name: "Tag Menus"; Current file ]
    Set Window Title [ Of Window: "Tag Menus Change Back When Done"; Current file; New Title: "Tag Menus" ]
    End If
    Select Window [ Name: "Tag Menus"; Current file ]
    Set Variable [ $$stopLoadTagRecord ]
    Refresh Window
    #

Fields used in this script

    tempSetup::kdefaultNodeOther
    testlearn::kNodeOther
    reference::knodeOther
    tagMenus::_Ltag
    tagMenus::match
    tempSetup::kdefaultNodePrimary
    testlearn::kNodePrimary
    reference::knodePrimary
    tagMenus::tag
    tempSetup::DEFAULTNodeOtherNames
    testlearn::NodeOthers
    reference::NodeOthers
    reference::referenceNodes
    tagMenus::notesOrCopyright
    TEMP::kdefaultCopyright
    tempSetup::kdefaultCopyright

Scripts used in this script

Layouts used in this script

    ltagSCRIPTloops
    learnSCRIPTloops

Tables used in this script

    TEMP
    TEMP
    reference
    tag
    testlearn

Table occurrences used by this script

    TEMP
    reference
    tagMenus
    tempSetup
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [addORremoveOtherTagStep2_node]	Parent Folder: [tagMenu]	Next Script: [addORremoveRefTagStep1]
Script Name	addORremovePrimaryTag
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultCopyright
    defaultNode1
    defaultNode2
    defaultNodeS2
    defaultNode3
    defaultNodeS3
    defaultNodeS4
    defaultNode4
    ReferenceMenu1
    ReferenceMenuCopyright
    ReferenceMenu3Cite
    ReferenceMenu3CiteNoPicture
    ReferenceMenu2keywordOrNode1
    ReferenceMenu2SkeywordOrNode1
    ReferenceMenu2keywordOrNode2
    ReferenceMenu2SkeywordOrNode2
    ReferenceMenu2keywordOrNode3
    ReferenceMenu2SkeywordOrNode3
    ReferenceMenu2keywordOrNode4
    ReferenceMenu2SkeywordOrNode4
    ReferenceMenu2keywordOrNode5
    ReferenceMenu2SkeywordOrNode5
    addMenu2
    addMenuTestItem
    ltagNK1
    ltagNKs1
    ltagNK2
    ltagNKs2
    ltagNK3
    ltagNKs3
    ltagNK4
    ltagNKs4
    ltagNK5
    ltagNKs5
    learnMenuBrainstorm
    learnMenuStuffBrainstorm
    learnTest
    learnSTest

Scripts that use this script

    newTagMenuTag
    newTagMenuTagGroup

Script Definition
Script Steps

    #
    #Admin tasks.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #
    #If this tag has a picture that is hidden, ask if
    #the user wants to see the picture or find
    #record's with this tag.
    If [ //There is a picture to show if... Get (LayoutName) = "ReferenceMenu3CiteNoPicture" and ( reference::picture ≠ "" or reference::showMedia ≠ "" and reference::URL ≠ "" or reference::showMedia[2] ≠ "" and reference::kfileLocation ≠ "" and reference::fileName ≠ "" ) ]
    If [ reference::_Lreference = $$citationItem and $$citationMatch = "cite" ]
    Show Custom Dialog [ Message: "Show this tag's picture or remove tag from the selected learn record?"; Default Button: “remove”, Commit: “Yes”; Button 2: “show”, Commit: “No”; Button 3: “cancel”, Commit: “No” ]
    Else
    Show Custom Dialog [ Message: "Show this tag's picture or add this tag to the selected learn record?"; Default Button: “add”, Commit: “Yes”; Button 2: “show”, Commit: “No”; Button 3: “cancel”, Commit: “No” ]
    End If
    If [ Get (LastMessageChoice) = 2 ]
    Set Variable [ $$stopOpenNewTextWindow ]
    Perform Script [ “showCitationPicture1inNewWindow” ]
    Exit Script [ ]
    End If
    If [ Get (LastMessageChoice) = 3 ]
    Exit Script [ ]
    End If
    End If
    #
    #
    #This prevents the system trademark tag (not
    #user created) being used improperly.
    If [ tagMenuGroup::_Lgroup = "92020171119521809" and $$RecordID = "" ]
    Show Custom Dialog [ Message: "Trademark tags can only be added to reference records, and then only if if the reference is for a trademark, logo, brand, etc."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #Subsection is locked by its creator node.
    If [ testSectionCreatorLock::orderOrLock ≠ "" ]
    Show Custom Dialog [ Message: "Locked Test tags cannot be added or removed from learn records. Select this record's creator node — " & testSectionCreatorLock::tag & " — in the setup window and enter the password to unlock it."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #Brainstorm tag is locked by its creator node.
    If [ tagCreatorLock::orderOrLock ≠ "" and $$citationMatch = "brainstorm" ]
    Show Custom Dialog [ Message: "Locked Brainstorm tags cannot be added or removed from learn records. Select this record's creator node — " & $$lockedMainLearnRecord & " — in the setup window and enter the password to unlock it."; Default Button: “OK”, Commit: “No” ]
    Halt Script
    End If
    #
    #If main record node is currenlty locked then
    #stop script and inform the user, unless the
    #user altering the key or path tag, which is
    #unique to the user's computer, for a locked
    #reference or learn record.
    If [ $$citationMatch ≠ "path" and $$citationMatch ≠ "key" and $$citationMatch ≠ "brainstorm" and $$citationMatch ≠ "test" ]
    If [ $$lockedMainRefRecord ≠ "" and Left ( Get (LayoutName) ; 1 ) = "r" ]
    Show Custom Dialog [ Message: "Tags cannot be added or removed from locked reference records (EXCEPTIONS — Key P and O tags and Path tags). Select this record's creator node — " & $$lockedMainRefRecord & " — in the setup window and enter the password to unlock it."; Default Button: “OK”, Commit: “Yes” ]
    Halt Script
    Else If [ $$lockedMainLearnRecord ≠ "" and Left ( Get (LayoutName) ; 1 ) = "l" ]
    Show Custom Dialog [ Message: "Tags cannot be added or removed from locked learn records. EXCEPTIONS — Key (P and O), Brainstorm, and Test tags. Select this record's creator node — " & $$lockedMainLearnRecord & " — in the setup window and enter the password to unlock it."; Default Button: “OK”, Commit: “Yes” ]
    Halt Script
    End If
    End If
    #
    #If primary node is currenlty locked then stop
    #user from changing the default copyright.
    If [ $$citationMatch = "copyright" ]
    If [ TEMP::primaryNodeIsLocked ≠ "" ]
    Show Custom Dialog [ Message: "The default copyright can be changed once the default primary node — " & TEMP::DEFAULTNodePrimaryName & " — is unlocked, or an unlocked node is selected as the primary node."; Default Button: “OK”, Commit: “Yes” ]
    Halt Script
    Else If [ TEMP::primaryNodesCreatorNodeIsLocked ≠ "" ]
    Show Custom Dialog [ Message: "The default copyright can be changed once the creator — " & TEMP::primaryNodesCreatorNodeIsLocked & " — of the default primary node — " & TEMP::DEFAULTNodePrimaryName & " — is unlocked, or an unlocked node is selected as the primary node."; Default Button: “OK”, Commit: “Yes” ]
    Halt Script
    End If
    End If
    #
    #
    #Reference Section Only
    #Because I keep forgetting to press find mode, this
    #bit of script is to confirm that the user really wants
    #to add or change the tag of the first record instead of
    #finding records with selected tag.
    If [ Left (Get (LayoutName) ; 3 ) = "ref" and $$stopAdd ≠ 1 ]
    If [ //Primary node and key match tagMenus::_Ltag = $$citationitem and $$citationMatch = "node" or tagMenus::_Ltag = $$citationitem and $$citationMatch = "key" or //Other tags match tagMenus::_Ltag = $$citationitem and $$citationMatch = "copyright" or tagMenus::_Ltag = $$citationitem and $$citationMatch = "publication" or tagMenus::_Ltag = $$citationitem and $$citationMatch = "path" or tagMenus::_Ltag = $$citationitem and $$citationMatch = "publisher" or reference::_Lreference = $$citationItem and $$citationMatch = "cite" ]
    Show Custom Dialog [ Message: "Remove Tag?" & ¶ & "OR " & ¶ & "Find references tagged with it?"; Default Button: “remove”, Commit: “Yes”; Button 2: “find”, Commit: “No”; Button 3: “cancel”, Commit: “No” ]
    Else
    Show Custom Dialog [ Message: "Add Tag?" & ¶ & "OR " & ¶ & "Find references tagged with it?"; Default Button: “add”, Commit: “Yes”; Button 2: “find”, Commit: “No”; Button 3: “cancel”, Commit: “No” ]
    End If
    If [ Get ( LastMessageChoice ) = 2 ]
    #This variable is needed becasue message choice 2
    #gets carried over to the Find Mode Script, which then
    #activates tag instead of reference record find mode.
    Set Variable [ $$ClearMessageChoice; Value:1 ]
    Perform Script [ “findMode” ]
    Exit Script [ ]
    Else If [ Get ( LastMessageChoice ) = 3 ]
    Set Variable [ $$referenceRecordOne ]
    Exit Script [ ]
    Else If [ Get ( LastMessageChoice ) = 1 ]
    Set Variable [ $$referenceRecordOne ]
    End If
    End If
    #
    #
    If [ $$stopAddTagToCitation = 1 ]
    Exit Script [ ]
    End If
    #
    #Stop script if user is looking at item/detail tags
    #in add mode, as these tags cannot be applied
    #to reference records.
    If [ $$add = 1 and $$citationMatch = "testSetup" ]
    Show Custom Dialog [ Message: "You cannot tag reference records with item tags. So why then are there buttons? The buttons show up because I have not made time to create a separate layout just for item tags. This issue has been logged as a minor irritation."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #
    #
    #Set key word if need to re-sort after
    #editing is completed (used in
    #finishReferenceEdit script).
    If [ $$citationMatch = "key" ]
    Set Variable [ $$primaryKeyWord; Value:$$citationItem ]
    End If
    #
    #
    #
    #Check main checkbox if record is not already
    #a main record. This is because when going to
    #edit cite or reference records, only main records
    #are shown by default.
    If [ Get ( LayoutTableName ) = "testlearn" or Get ( LayoutTableName ) = "reference" ]
    If [ "main" & ¶ ≠ FilterValues ( testlearn::filterFind ; "main" & ¶ ) and Get ( LayoutTableName ) = "testlearn" ]
    Set Variable [ $filterFind; Value:testlearn::filterFind ]
    Set Field [ testlearn::filterFind; "main" & ¶ & $filterFind ]
    Else If [ "main" & ¶ ≠ FilterValues ( reference::filterFind ; "main" & ¶ ) and Get ( LayoutTableName ) = "reference" ]
    Set Variable [ $filterFind; Value:reference::filterFind ]
    Set Field [ reference::filterFind; "main" & ¶ & $filterFind ]
    End If
    End If
    #
    #Set variable to note table name in case tag is from
    #testLearn table, in which case an 'L' will need to be
    #added to the tag to conditionally format the buttons
    #for Learn Ref and Learn citations in the Tag Menus window.
    Set Variable [ $tableName; Value:Get ( LayoutTableName ) ]
    #
    #
    #Get key for tag that is to be added to record.
    If [ Right ( Get (LayoutName) ; 4 ) = "test" ]
    Set Variable [ $tag; Value:testSubsectionTemplate::_LtestSubsection ]
    Set Variable [ $tagName; Value:testSubsectionTemplate::name ]
    Else If [ Middle ( Get ( LayoutName ) ; 14 ; 5 ) = "3cite" ]
    Set Variable [ $tag; Value:reference::_Lreference ]
    Set Variable [ $citeBug; Value:1 ]
    Else If [ Right ( Get (LayoutName) ; 7 ) = "refcite" ]
    Set Variable [ $tag; Value:testlearn::_Ltestlearn ]
    Else If [ Right ( Get (LayoutName) ; 8 ) = "sections" ]
    Set Variable [ $tag; Value:testSubsectionLibraryName::_Lgroup ]
    Set Variable [ $tagName; Value:testSubsectionLibraryName::name ]
    #
    #Stop check spelling script as this script is triggered
    #on section layout by record load trigger, and
    #so before user can change the spelling.
    Set Variable [ $$stopChangeSectionName; Value:1 ]
    Else If [ Right ( Get (LayoutName) ; 4 ) ≠ "cite" ]
    Set Variable [ $tag; Value:tagMenus::_Ltag ]
    #
    #If a node tag is being added in the setup
    #window this lock variable will be essential
    #below when this primary node is set as the
    #default node for the library. Locked nodes set
    #as default primary node turn off the users
    #ability to create new records with this locked
    #node.
    If [ $$createNewPrimary ≠ 1 ]
    Set Variable [ $lock; Value:tagMenus::orderOrLock ]
    End If
    #
    #Also need to know the node's name to
    #populate the primary node name field
    #if necessary.
    Set Variable [ $nodeName; Value:tagMenus::tag ]
    #
    #Also need to know the node's creator in case it
    #is locked, so this node can also be locked.
    Set Variable [ $nodescreatorKey; Value:tagMenus::kRecordCreatorNode ]
    Set Variable [ $nodescreatorName; Value:tagCreatorLock::tag ]
    End If
    #
    #Leave field user so can see
    #conditional formatting.
    Go to Field [ ]
    #
    #Turn off the T scripts variable once the
    #user selects or unselects a tag. This variable
    #is set when the user navigates to a reference
    #field that is blank and triggers a Tag Menu script.
    Set Variable [ $$TgotoCitationMenuWithBlankField ]
    #
    #If removing a test result record, the database
    #will jump to the next record's tag menu selection.
    #So to keep the library on the tag orginally
    #selected, the system must record this record's
    #number now. This will be be used below
    #for test records only.
    Set Variable [ $recordNumber; Value:Get (RecordNumber) ]
    #
    #Conditionally format selected tag.
    If [ Right ( Get (LayoutName) ; 4 ) ≠ "cite" ]
    Set Variable [ $$citationItem; Value:tagMenus::_Ltag ]
    Else If [ $citeBug = 1 ]
    Set Variable [ $$citationItem; Value:reference::_Lreference ]
    Set Variable [ $citeCopyright; Value:reference::kCopyright ]
    Set Variable [ $citeCopyrightDate; Value:reference::CopyrightYear ]
    Set Variable [ $citekeywordOther; Value:reference::kkeywordOther ]
    Set Variable [ $citekeywordOtherWords; Value:reference::OtherKeyWords ]
    Set Variable [ $citekeywordPrimary; Value:reference::kkeywordPrimary ]
    #
    Set Variable [ $filename; Value:reference::fileName ]
    Set Variable [ $fileLocation; Value:reference::kfileLocation ]
    Set Variable [ $folderpath; Value:reference::kfolderpath ]
    Set Variable [ $medium; Value:reference::kmedium ]
    Set Variable [ $URL; Value:reference::URL ]
    Set Variable [ $URLdate; Value:reference::URLdate ]
    Else If [ Right ( Get (LayoutName) ; 7 ) = "refcite" ]
    Set Variable [ $$citationItem; Value:testlearn::_Ltestlearn ]
    Set Variable [ $citeCopyright; Value:testlearn::kcopyright ]
    Set Variable [ $citekeywordOther; Value:testlearn::kcKeywordOther ]
    Set Variable [ $citekeywordOtherWords; Value:testlearn::OtherKeyWords ]
    Set Variable [ $citekeywordPrimary; Value:testlearn::kKeywordPrimary ]
    End If
    #
    If [ $citeBug = 1 ]
    Set Variable [ $$citationItem; Value:reference::_Lreference ]
    Set Variable [ $citeCopyright; Value:reference::kCopyright ]
    Set Variable [ $citeCopyrightDate; Value:reference::CopyrightYear ]
    Set Variable [ $citekeywordOther; Value:reference::kkeywordOther ]
    Set Variable [ $citekeywordOtherWords; Value:reference::OtherKeyWords ]
    Set Variable [ $citekeywordPrimary; Value:reference::kkeywordPrimary ]
    #
    Set Variable [ $filename; Value:reference::fileName ]
    Set Variable [ $fileLocation; Value:reference::kfileLocation ]
    Set Variable [ $folderpath; Value:reference::kfolderpath ]
    Set Variable [ $medium; Value:reference::kmedium ]
    Set Variable [ $URL; Value:reference::URL ]
    Set Variable [ $URLdate; Value:reference::URLdate ]
    End If
    #
    // New Window [ Name: "Add Tag"; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    #
    #Select reference, learn, or setup window.
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    If [ Get (LastError) = 112 ]
    #
    #
    #
    #BEGIN — SETUP WINDOW
    #
    #
    #
    // Select Window [ Name: "Setup"; Current file ]
    #
    #Check which tag user is looking at and then...
    If [ $$citationMatch = "node" ]
    #
    #If primary node is in use, then remove it,
    #and its creators key.
    If [ tempSetup::kdefaultNodePrimary = $tag ]
    Set Field [ tempSetup::kdefaultNodePrimary; "" ]
    Set Field [ tempSetup::DEFAULTNodePrimaryName; "" ]
    Set Field [ tempSetup::kdefaultNodePrimaryCreator; "" ]
    Set Field [ tempSetup::primaryNodesCreatorNodeIsLocked; "" ]
    #
    #Finish removing the key.
    Set Variable [ $$citationItem ]
    Set Variable [ $$PrimaryNode ]
    #
    #If primary node is not in use add it and set
    #variables to see if it was in the other node
    #field so it can be removed from there thus
    #preventing the same node showing up twice.
    Else If [ tempSetup::kdefaultNodePrimary ≠ $tag ]
    Set Field [ tempSetup::kdefaultNodePrimary; $tag ]
    Set Field [ tempSetup::DEFAULTNodePrimaryName; $nodeName ]
    #
    #Also add the key for its creator node, as if it is
    #locked, this primary node also needs to be locked.
    Set Field [ tempSetup::kdefaultNodePrimaryCreator; $nodescreatorKey ]
    If [ primaryNodesCreatorLock::orderOrLock ≠ "" ]
    Set Field [ tempSetup::primaryNodesCreatorNodeIsLocked; $nodescreatorName ]
    Else
    Set Field [ tempSetup::primaryNodesCreatorNodeIsLocked; "" ]
    End If
    #
    #Lock creation of new records if this node is
    #locked using the script
    #stopNewRecordsBeingCreatedByLockedNode.
    If [ $lock ≠ "" ]
    Set Field [ tempSetup::primaryNodeIsLocked; $lock ]
    Else
    Set Field [ tempSetup::primaryNodeIsLocked; "" ]
    End If
    Set Variable [ $$node; Value:tempSetup::kdefaultNodeOther ]
    Set Field [ tempSetup::kdefaultNodeOther; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used If ( ValueCount ( $$node ) ≠ ValueCount ( Substitute ( $$node ; $$citationItem & "¶" ; "" ) ) ; Substitute ( $$node ; $$citationItem & "¶" ; "" ) ; Substitute ( $$node ; $$citationItem ; "" ) ) ]
    Set Variable [ $$PrimaryNode; Value:testlearn::kNodePrimary ]
    Set Variable [ $$node; Value:tempSetup::kdefaultNodeOther ]
    Set Variable [ $$skipFirstPartOfScript; Value:1 ]
    #
    #Record must be committed if user decides to
    #perform a script on it right after this one or
    #perform a find requiring the newly added key.
    Commit Records/Requests
    Perform Script [ “addORremoveOtherTagStep2_node” ]
    Close Window [ Name: "reorder"; Current file ]
    #
    Exit Script [ ]
    End If
    #
    Else If [ $$citationMatch = "copyright" ]
    If [ tempSetup::kdefaultCopyright = $tag ]
    Set Field [ tempSetup::kdefaultCopyright; "" ]
    Set Variable [ $$citationItem ]
    Set Variable [ $$copyright ]
    Refresh Window
    #
    #goto Tag Menus window
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    Exit Script [ ]
    Else If [ testlearn::kcopyright ≠ $tag ]
    Set Variable [ $$copyright; Value:tempSetup::kdefaultCopyright ]
    Set Field [ tempSetup::kdefaultCopyright; $tag ]
    Refresh Window
    #
    #goto Tag Menus window
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    #
    #Update pimary node with this new copyright
    #information, so its test section, subsection,
    #and item records will reflect this copyright
    #selection. If the primary node is not selected
    #that is OK because the copyright tag will be
    #added when it is selected.
    If [ TEMP::kdefaultNodePrimary ≠ "" ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    New Window [ Height: 1; Width: 1; Top: -10000; Left: -10000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Enter Find Mode [ ]
    Set Field [ tagMenus::_Ltag; TEMP::kdefaultNodePrimary ]
    Perform Find [ ]
    Set Field [ tagMenus::notesOrCopyright; $tag ]
    Close Window [ Current Window ]
    Set Variable [ $$stopLoadTagRecord ]
    End If
    Show Custom Dialog [ Message: "The default node's copyright has been updated to match the library's default copyright."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    End If
    #
    #Record must be committed if user decides to
    #perform a script on it right after this one or
    #perform a find requiring the newly added key.
    Commit Records/Requests
    #
    #Refresh the windows so changed conditional formatting
    #will show up.
    Refresh Window
    #
    Set Variable [ $$stoploadCitation ]
    #
    #
    #
    #END — SETUP WINDOW
    #
    #
    #
    #BEGIN — LEARN WINDOW
    #
    #
    #
    Else If [ Get (LastError) ≠ 112 ]
    #
    #
    #
    #Check which tag user is looking at and then...
    If [ $$citationMatch = "node" ]
    #
    #If primary node is in use, then remove it.
    If [ testlearn::kNodePrimary = $tag ]
    Set Field [ testlearn::kNodePrimary; "" ]
    #
    #Finish removing the key.
    Set Variable [ $$citationItem ]
    Set Variable [ $$PrimaryNode ]
    #
    #If primary node is not in use add it and set
    #variables to see if it was in the other node
    #field so it can be removed from there thus
    #preventing the same node showing up twice.
    Else If [ testlearn::kNodePrimary ≠ $tag ]
    Set Field [ testlearn::kNodePrimary; $tag ]
    Set Field [ testlearn::kNodeOther; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used If ( ValueCount ( $$node ) ≠ ValueCount ( Substitute ( $$node ; $$citationItem & "¶" ; "" ) ) ; Substitute ( $$node ; $$citationItem & "¶" ; "" ) ; Substitute ( $$node ; $$citationItem ; "" ) ) ]
    Set Variable [ $$node; Value:testlearn::kNodeOther ]
    Set Variable [ $$PrimaryNode; Value:testlearn::kNodePrimary ]
    Set Variable [ $$skipFirstPartOfScript; Value:1 ]
    #
    #Record must be committed if user decides to
    #perform a script on it right after this one or
    #perform a find requiring the newly added key.
    Commit Records/Requests
    Perform Script [ “addORremoveOtherTagStep2_node” ]
    Close Window [ Name: "reorder"; Current file ]
    Set Variable [ $$stopLoadTagRecord ]
    #
    Exit Script [ ]
    End If
    #
    Else If [ $$citationMatch = "copyright" ]
    If [ testlearn::kcopyright = $tag ]
    Set Field [ testlearn::kcopyright; "" ]
    Set Variable [ $$citationItem ]
    Set Variable [ $$copyright ]
    Else If [ testlearn::kcopyright ≠ $tag ]
    Set Field [ testlearn::kcopyright; $tag ]
    Set Variable [ $$copyright; Value:testlearn::kcopyright ]
    End If
    #
    Else If [ $$citationMatch = "key" ]
    #
    #If primary keyword is in use, then remove it.
    If [ testlearn::kKeywordPrimary = $tag ]
    Set Field [ testlearn::kKeywordPrimary; "" ]
    Set Variable [ $$citationItem ]
    Set Variable [ $$PrimaryKey ]
    #
    #If primary keyword is not in use add it and set
    #variables to see if it was in the other keyword
    #field so it can be removed from there thus
    #preventing the same keyword showing up twice.
    Else If [ testlearn::kKeywordPrimary ≠ $tag ]
    Set Field [ testlearn::kKeywordPrimary; $tag ]
    Set Field [ testlearn::kcKeywordOther; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used If ( ValueCount ( $$key ) ≠ ValueCount ( Substitute ( $$key ; $$citationItem & "¶" ; "" ) ) ; Substitute ( $$key ; $$citationItem & "¶" ; "" ) ; Substitute ( $$key ; $$citationItem ; "" ) ) ]
    Set Variable [ $$key; Value:testlearn::kcKeywordOther ]
    Set Variable [ $$PrimaryKey; Value:$tag ]
    Set Variable [ $$skipFirstPartOfScript; Value:1 ]
    #
    #Record must be committed if user decides to
    #perform a script on it right after this one or
    #perform a find requiring the newly added key.
    Commit Records/Requests
    Perform Script [ “addORremoveOtherTagStep2_keyword” ]
    #
    Exit Script [ ]
    End If
    #
    Else If [ $$citationMatch = "test" ]
    #
    #If test tag is in use, then remove it.
    Set Variable [ $number; Value:1 ]
    Loop
    If [ Case ( Left ( testlearn::kctestSubsectionInfo ; 2 ) = "00" ; //If there two zeros in front of the order number, get the key using this calculation: FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; $number ) ; 4 ; 999 ) ; $tag & "¶" ) = $tag & ¶ ; //If there is only one zero in front of the order number, get the key using this calculation: FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; $number ) ; 3 ; 999 ) ; $tag & "¶" ) = $tag & ¶ ) ]
    #
    #
    #Check if Learn record is in use
    #on any reports.
    Set Variable [ $$stoploadCitation; Value:1 ]
    New Window [ Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “tableReport” (report) ]
    Set Variable [ $$stoploadCitation ]
    #
    #See if any picture 1 slots use
    #this Learn record,
    Enter Find Mode [ ]
    Set Field [ report::ktestSubsection; $tag ]
    Set Field [ report::kTag1; $$main ]
    Perform Find [ ]
    #Or picture 2 slots,
    Enter Find Mode [ ]
    Set Field [ report::ktestSubsection; $tag ]
    Set Field [ report::kTag2; $$main ]
    Extend Found Set [ ]
    #Or picture 3 slots,
    Enter Find Mode [ ]
    Set Field [ report::ktestSubsection; $tag ]
    Set Field [ report::kTag3; $$main ]
    Extend Found Set [ ]
    #Or picture 4 slots.
    Enter Find Mode [ ]
    Set Field [ report::ktestSubsection; $tag ]
    Set Field [ report::kTag4; $$main ]
    Extend Found Set [ ]
    #
    #If this record is in use on a report, this test
    #tag cannot be removed until it is removed
    #from these found reports. Tell the user this.
    If [ Get (FoundCount) > 0 ]
    Go to Layout [ “TEMP” (TEMP) ]
    Show All Records
    Delete All Records [ No dialog ]
    #
    Go to Layout [ “tableReport” (report) ]
    Loop
    Set Variable [ $useList; Value:ReportTestSubject::tag & " | report " & TextColor( TextStyleAdd ( report::kreportNumber; "" ) ;RGB(0;0;0)) & ¶ & "sub-section >> " & TextColor( TextStyleAdd ( reportSubsection::name; "" ) ;RGB(0;0;0)) ]
    Go to Layout [ “TEMP” (TEMP) ]
    New Record/Request
    Set Field [ TEMP::DeleteMessageInTempWindow1; $useList ]
    Go to Layout [ “tableReport” (report) ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    Go to Layout [ “TEMP” (TEMP) ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: TEMP::DeleteMessageInTempWindow1; ascending ] [ Restore; No dialog ]
    View As [ View as List ]
    #
    #Due to a bug in FM13, window must first be
    #moved back into the screen area before the
    #calculation of the current screen's
    #dimensions can be taken.
    Move/Resize Window [ Current Window; Top: 0; Left: 0 ]
    Move/Resize Window [ Current Window; Height: Get ( ScreenHeight ); Width: 360; Top: 0; Left: Get ( ScreenWidth ) - ( Get ( ScreenWidth )/2 + 360) ]
    Set Field [ TEMP::Message; "This Learn record is linked to sub-sections on the reports shown below, and must be unlinked from all them to unlink it from this test tag." ]
    Pause/Resume Script [ Indefinitely ]
    Close Window [ Current Window ]
    #
    #
    Set Variable [ $number; Value:"exit" ]
    #
    #Remove tag if Learn record is not in use on
    #any reports.
    Else
    Close Window [ Current Window ]
    Set Field [ testlearn::kctestSubsectionInfo; Substitute ( $$test ; GetValue ( testlearn::kctestSubsectionInfo ; $number ) & "¶" ; "" ) ]
    Set Field [ testlearn::orderTestInformation; "" ]
    #
    #
    Set Variable [ $$test; Value:testlearn::kctestSubsectionInfo ]
    Set Variable [ $$citationItem ]
    Set Variable [ $number; Value:"exit" ]
    End If
    End If
    Exit Loop If [ GetValue ( testlearn::kctestSubsectionInfo ; $number ) = "" //$number = exit will turn up a blank and so exit this loop. ]
    Exit Loop If [ $number = "" ]
    Set Variable [ $add; Value:$number ]
    Set Variable [ $number; Value:$add + 1 ]
    End Loop
    #
    #If test item is not in use add it.
    If [ $number ≠ "exit" ]
    Set Variable [ $number; Value:1 ]
    Loop
    If [ Case ( Left ( testlearn::kctestSubsectionInfo ; 2 ) = "00" ; //If there two zeros in front of the order number, get the key using this calculation: FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; $number ) ; 4 ; 999 ) ; $$test & "¶" ) ≠ $tag & ¶ ; //If there is only one zero in front of the order number, get the key using this calculation: FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; $number ) ; 3 ; 999 ) ; $$test & "¶" ) ≠ $tag & ¶ ) ]
    Set Field [ testlearn::kctestSubsectionInfo; "001" & $tag & ¶ & $$test ]
    Set Field [ testlearn::orderTestInformation; "001" ]
    Set Variable [ $$test; Value:testlearn::kctestSubsectionInfo ]
    Set Variable [ $number ]
    #
    #Record must be committed if user decides to
    #perform a script on it right after this one or
    #perform a find requiring the newly added key.
    Commit Records/Requests
    End If
    Exit Loop If [ FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; $number ) ; 4 ; 42 ) ; $$test & "¶" ) = "" ]
    Exit Loop If [ $number = "" ]
    Set Variable [ $add; Value:$number ]
    Set Variable [ $number; Value:$add + 1 ]
    End Loop
    #
    #Give this newly tagged record the order
    #number 001, and then sort all records
    #so that it shows up as part of the current
    #test tag's record set.
    Set Field [ testlearn::orderTestInformation; "001" ]
    Set Field [ TEMP::TLTestSort; "order" ]
    Perform Script [ “sortTestOrBrainstormTaggedLearnRecords” ]
    End If
    #
    Else If [ $$citationMatch = "brainstorm" ]
    #
    #If brainstorm item is in use, then remove it.
    Set Variable [ $number; Value:1 ]
    Loop
    If [ FilterValues ( Middle ( GetValue ( testlearn::kcbrainstorm ; $number ) ; 4 ; 42 ) ; $tag & "¶" ) = $tag & ¶ ]
    Set Field [ testlearn::kcbrainstorm; Substitute ( $$brainstorm ; GetValue ( testlearn::kcbrainstorm ; $number ) & "¶" ; "" ) ]
    Set Field [ testlearn::orderTestInformation; "" ]
    Set Variable [ $$brainstorm; Value:testlearn::kcbrainstorm ]
    Set Variable [ $$citationItem ]
    Set Variable [ $number; Value:"exit" ]
    End If
    Exit Loop If [ GetValue ( testlearn::kcbrainstorm ; $number ) = "" ]
    Exit Loop If [ $number = "" ]
    Set Variable [ $add; Value:$number ]
    Set Variable [ $number; Value:$add + 1 ]
    End Loop
    #
    If [ $number ≠ "exit" ]
    Set Variable [ $number; Value:1 ]
    Loop
    #If brainstorm item is not in use add it.
    If [ FilterValues ( Middle ( GetValue ( testlearn::kcbrainstorm ; $number ) ; 4 ; 42 ) ; $tagS & "¶" ) ≠ $tag & ¶ ]
    Set Field [ testlearn::kcbrainstorm; "001" & $tag & ¶ & $$brainstorm ]
    Set Variable [ $$brainstorm; Value:testlearn::kcbrainstorm ]
    Set Variable [ $number ]
    #
    #Record must be committed if user decides to
    #perform a script on it right after this one or
    #perform a find requiring the newly added key.
    Commit Records/Requests
    End If
    Exit Loop If [ FilterValues ( Middle ( GetValue ( testlearn::kcbrainstorm ; $number ) ; 4 ; 42 ) ; $tagS & "¶" ) = "" ]
    Exit Loop If [ $number = "" ]
    Set Variable [ $add; Value:$number ]
    Set Variable [ $number; Value:$add + 1 ]
    End Loop
    #
    #Give this newly tagged record the order
    #number 001, and then sort all records
    #so that it shows up as part of the current
    #test tag's record set.
    Set Field [ testlearn::orderTestInformation; "001" ]
    Set Field [ TEMP::TLTestSort; "order" ]
    Perform Script [ “sortTestOrBrainstormTaggedLearnRecords” ]
    End If
    End If
    #
    #Record must be committed if user decides to
    #perform a script on it right after this one or
    #perform a find requiring the newly added key.
    Commit Records/Requests
    #
    #Refresh the windows so changed conditional formatting
    #will show up.
    Refresh Window
    #
    Set Variable [ $$stoploadCitation ]
    End If
    #
    #
    #
    #END — LEARN WINDOW
    #
    #
    #
    #BEGIN — REFERENCE WINDOW
    #
    #
    #
    Else If [ Get (LastError) ≠ 112 ]
    #Check which tag user is looking at and then...
    If [ $$citationMatch = "node" ]
    #
    #If primary node is in use, then remove it.
    If [ reference::knodePrimary = $tag ]
    Set Field [ reference::knodePrimary; "" ]
    #
    #Remove author copyright holder if there are
    #no authors.
    If [ reference::knodeOther = "" and reference::knodePrimary = "" and reference::referenceNodes = "" ]
    #Perform removal for items with and without a
    #paragraph mark, as the last item in checklist
    #has no paragraph mark after it.
    If [ Filter ( reference::kcopyrightHolder ; "1" ) = 1 ]
    Show Custom Dialog [ Message: "Author is currently checked in the copyright section for this reference as a copyright holder. Remove this check?"; Default Button: “No”, Commit: “Yes”; Button 2: “Yes”, Commit: “No” ]
    If [ Get ( LastMessageChoice ) = 2 ]
    Set Field [ reference::kcopyrightHolder; Substitute ( reference::kcopyrightHolder ; "1" & "¶" ; "" ) ]
    Set Field [ reference::kcopyrightHolder; Substitute ( reference::kcopyrightHolder ; "1" ; "" ) ]
    End If
    End If
    End If
    #
    #Finish removing the key.
    Set Variable [ $$citationItem ]
    Set Variable [ $$PrimaryNode ]
    #
    #If primary node is not in use add it and set
    #variables to see if it was in the other node
    #field so it can be removed from there thus
    #preventing the same node showing up twice.
    Else If [ reference::knodePrimary ≠ $tag ]
    Set Field [ reference::knodePrimary; $tag ]
    Set Field [ reference::knodeOther; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used If ( ValueCount ( $$node ) ≠ ValueCount ( Substitute ( $$node ; $$citationItem & "¶" ; "" ) ) ; Substitute ( $$node ; $$citationItem & "¶" ; "" ) ; Substitute ( $$node ; $$citationItem ; "" ) ) ]
    Set Variable [ $$node; Value:reference::knodeOther ]
    Set Variable [ $$PrimaryNode; Value:reference::knodePrimary ]
    Set Variable [ $$skipFirstPartOfScript; Value:1 ]
    #
    #Record must be committed if user decides to
    #perform a script on it right after this one or
    #perform a find requiring the newly added key.
    Commit Records/Requests
    Perform Script [ “addORremoveOtherTagStep2_node” ]
    Close Window [ Name: "reorder"; Current file ]
    #
    #If the user is adding a node tag to reference
    #record on the main reference layout, then
    #inform why they will not see it if the 'open
    #authors' field is filled in.
    Select Window [ Name: "References"; Current file ]
    If [ reference::referenceNodes ≠ "" and Get (LayoutName) = "Reference" ]
    Show Custom Dialog [ Message: "Because the open authors field is filled in, this node tag — while added to this reference — will not show up as a reference author. Click 'edit' to edit the open authors field and see this reference's node tags."; Default Button: “OK”, Commit: “Yes” ]
    #
    #Return to the Tag Menus window.
    Select Window [ Name: "Tag Menus"; Current file ]
    Set Variable [ $$stopLoadTagRecord ]
    #
    #If the node tag was changed then see if it
    #affects the order of the current reference.
    Else If [ $$citationMatch = "node" ]
    #If this is the reference section and user is
    #looking at either author/node or keyword/
    #subject ordered records, check to see if this
    #order has changed as a result of re-ordering
    #the author/node or keyword/subject tags.
    Commit Records/Requests
    #
    #See if the edited record changed position in
    #the main reference window as a result of
    #alphabetical or order number changing edits.
    Set Variable [ $$stoploadCitation; Value:1 ]
    Set Variable [ $currentrecord; Value:Get (RecordNumber) ]
    New Window [ Name: "CheckDuplicateRecordPosition"; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagKeywordPrimary::orderOrLock; based on value list: “testPulldownListANDsortOrderList” tagKeywordPrimary::tag; ascending reference::publicationYearOrStuffOrderNumber; based on value list: “testPulldownListANDsortOrderList” reference::Title; ascending reference::thoughtsNotesEtc; ascending ] [ Restore; No dialog ]
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagKeywordPrimary::orderOrLock; based on value list: “order Pulldown List” tagKeywordPrimary::tag; ascending reference::referenceForReferenceWindow; ascending ] [ Restore; No dialog ]
    End If
    #
    #If the edited record moved then note this.
    If [ $currentrecord ≠ Get (RecordNumber) ]
    Set Variable [ $recordMoved; Value:Get (RecordNumber) ]
    End If
    Close Window [ Name: "CheckDuplicateRecordPosition"; Current file ]
    #
    #Re-sort to view edited record if it
    #was moved.
    If [ $recordMoved ≠ "" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagKeywordPrimary::orderOrLock; based on value list: “testPulldownListANDsortOrderList” tagKeywordPrimary::tag; ascending reference::publicationYearOrStuffOrderNumber; based on value list: “testPulldownListANDsortOrderList” reference::Title; ascending reference::thoughtsNotesEtc; ascending ] [ Restore; No dialog ]
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagKeywordPrimary::orderOrLock; based on value list: “order Pulldown List” tagKeywordPrimary::tag; ascending reference::referenceForReferenceWindow; ascending ] [ Restore; No dialog ]
    End If
    Go to Record/Request/Page [ $recordMoved ] [ No dialog ]
    End If
    End If
    Set Variable [ $$stoploadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    #
    #Return to the Tag Menus window.
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    Exit Script [ ]
    End If
    #
    Else If [ $$citationMatch = "medium" ]
    If [ reference::kmedium = $tag ]
    Set Field [ reference::kmedium; "" ]
    Set Variable [ $$citationItem ]
    Set Variable [ $$medium ]
    Else If [ reference::kmedium ≠ $tag ]
    Set Field [ reference::kmedium; $tag ]
    Set Variable [ $$medium; Value:reference::kmedium ]
    End If
    #
    Else If [ $$citationMatch = "copyright" ]
    If [ reference::kCopyright = $tag ]
    Set Field [ reference::kCopyright; "" ]
    Set Variable [ $$citationItem ]
    Set Variable [ $$copyright ]
    Else If [ reference::kCopyright ≠ $tag ]
    Set Field [ reference::kCopyright; $tag ]
    Set Variable [ $$copyright; Value:reference::kCopyright ]
    End If
    #
    Else If [ $$citationMatch = "cite" ]
    If [ reference::kcitation = $tag ]
    Set Field [ reference::kcitation; "" ]
    Set Variable [ $$citationItem ]
    Set Variable [ $$cite ]
    Else If [ reference::kcitation ≠ $tag ]
    Set Field [ reference::kcitation; $tag ]
    Set Variable [ $$cite; Value:reference::kcitation ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Perform Script [ “CHUNK_addReferenceNodeAndKeywordTagIDs” ]
    End If
    #
    Else If [ $$citationMatch = "publication" ]
    If [ reference::kpublication = $tag ]
    Set Field [ reference::kpublication; "" ]
    #
    #Remove publication copyright holder.
    #Perform removal for items with and without a
    #paragraph mark, as the last item in checklist
    #has no paragraph mark after it.
    If [ Filter ( reference::kcopyrightHolder ; "4" ) = 4 ]
    Show Custom Dialog [ Message: "Publication is currently checked in the copyright section for this reference as a copyright holder. Remove this check?"; Default Button: “No”, Commit: “Yes”; Button 2: “Yes”, Commit: “No” ]
    If [ Get ( LastMessageChoice ) = 2 ]
    Set Field [ reference::kcopyrightHolder; Substitute ( reference::kcopyrightHolder ; "4" & "¶" ; "" ) ]
    Set Field [ reference::kcopyrightHolder; Substitute ( reference::kcopyrightHolder ; "4" ; "" ) ]
    End If
    End If
    #
    #Finish removing the key.
    Set Variable [ $$citationItem ]
    Set Variable [ $$publication ]
    #
    Else If [ reference::kpublication ≠ $tag ]
    #
    #Add new key to reference.
    Set Field [ reference::kpublication; $tag ]
    Set Variable [ $$publication; Value:reference::kpublication ]
    End If
    #
    Else If [ $$citationMatch = "publisher" ]
    If [ reference::kpublisher = $tag ]
    Set Field [ reference::kpublisher; "" ]
    #
    #Remove publication copyright holder.
    #Perform removal for items with and without a
    #paragraph mark, as the last item in checklist
    #has no paragraph mark after it.
    If [ Filter ( reference::kcopyrightHolder ; "5" ) = 5 ]
    Show Custom Dialog [ Message: "Publisher is currently checked in the copyright section for this reference as a copyright holder. Remove this check?"; Default Button: “No”, Commit: “Yes”; Button 2: “Yes”, Commit: “No” ]
    If [ Get ( LastMessageChoice ) = 2 ]
    Set Field [ reference::kcopyrightHolder; Substitute ( reference::kcopyrightHolder ; "5" & "¶" ; "" ) ]
    Set Field [ reference::kcopyrightHolder; Substitute ( reference::kcopyrightHolder ; "5" ; "" ) ]
    End If
    End If
    #
    #Finish removing the key.
    Set Variable [ $$citationItem ]
    Set Variable [ $$publisher ]
    #
    Else If [ reference::kpublisher ≠ $tag ]
    #
    #Add key to reference.
    Set Field [ reference::kpublisher; $tag ]
    Set Variable [ $$publisher; Value:reference::kpublisher ]
    End If
    #
    Else If [ $$citationMatch = "Path" ]
    If [ reference::kfolderpath = $tag ]
    Set Field [ reference::kfolderpath; "" ]
    Set Variable [ $$citationItem ]
    Set Variable [ $$Path ]
    Else If [ reference::kfolderpath ≠ $tag ]
    Set Field [ reference::kfolderpath; $tag ]
    Set Variable [ $$Path; Value:reference::kfolderpath ]
    End If
    #
    Else If [ $$citationMatch = "key" ]
    #
    #If primary keyword is in use, then remove it.
    If [ reference::kkeywordPrimary = $tag ]
    Set Field [ reference::kkeywordPrimary; "" ]
    Set Variable [ $$citationItem ]
    Set Variable [ $$PrimaryKey ]
    #
    #If primary keyword is not in use add it and set
    #variables to see if it was in the other keyword
    #field so it can be removed from there thus
    #preventing the same keyword showing up twice.
    Else If [ reference::kkeywordPrimary ≠ $tag ]
    Set Field [ reference::kkeywordPrimary; $tag ]
    Set Field [ reference::kkeywordOther; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used If ( ValueCount ( $$key ) ≠ ValueCount ( Substitute ( $$key ; $$citationItem & "¶" ; "" ) ) ; Substitute ( $$key ; $$citationItem & "¶" ; "" ) ; Substitute ( $$key ; $$citationItem ; "" ) ) ]
    Set Variable [ $$key; Value:reference::kkeywordOther ]
    Set Variable [ $$PrimaryKey; Value:reference::kkeywordPrimary ]
    Set Variable [ $$skipFirstPartOfScript; Value:1 ]
    #
    #Record must be committed if user decides to
    #perform a script on it right after this one or
    #perform a find requiring the newly added key.
    Commit Records/Requests
    Perform Script [ “addORremoveOtherTagStep2_keyword” ]
    Exit Script [ ]
    End If
    #
    End If
    #
    #Record must be committed if user decides to
    #perform a script on it right after this one or
    #perform a find requiring the newly added key.
    Commit Records/Requests
    #
    #Refresh the windows so changed conditional formatting
    #will show up.
    Refresh Window
    #
    Set Variable [ $$stoploadCitation ]
    End If
    #
    #Only need to re-sort if primary key was
    #changed or primary author in reference mode.
    If [ $$primaryKeyWord ≠ reference::kkeywordPrimary and $$citationMatch = "key" and $$stopAdd = "" and $$referenceSort = "" and Left ( Get ( LayoutName ) ; 1 ) ≠ "l" ]
    Set Variable [ $$primaryKeyWord ]
    Show Custom Dialog [ Message: "Record will now move to new keyword location. Scroll window to this location?"; Default Button: “no”, Commit: “Yes”; Button 2: “yes”, Commit: “No” ]
    If [ Get (LastMessageChoice) = 2 ]
    Go to Layout [ “ReferenceStuffScriptLoops” (reference) ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagKeywordPrimary::orderOrLock; based on value list: “order Pulldown List” tagKeywordPrimary::tag; ascending reference::referenceForReferenceWindow; ascending ] [ Restore; No dialog ]
    #
    #Go to reference record layout.
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “ReferenceStuff” (reference) ]
    Else
    Go to Layout [ “Reference” (reference) ]
    End If
    End If
    Else If [ $$citationMatch = "node" and $$referenceSort = "" or $$citationMatch = "node" and $$referenceSort = "author" ]
    Sort Records [ ] [ No dialog ]
    End If
    #
    #
    #
    #END — REFERENCE WINDOW
    #
    #
    #
    #Return tag window and refresh to show newly
    #added or removed tag selection.
    Select Window [ Name: "Tag Menus"; Current file ]
    Go to Record/Request/Page [ $recordNumber ] [ No dialog ]
    #
    #Check if any Learn records are tagged with a
    #test item (if currently in test mode), or a
    #brainstorm item (if in brainstorm mode) and sort
    #by order and then date and time.
    If [ $$citationMatch = "test" ]
    Perform Script [ “loadTestTags” ]
    Else If [ $$citationMatch = "brainstorm" ]
    Perform Script [ “loadBrainstormTags” ]
    End If
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    #

Fields used in this script

    reference::picture
    reference::showMedia
    reference::URL
    reference::kfileLocation
    reference::fileName
    reference::_Lreference
    tagMenuGroup::_Lgroup
    testSectionCreatorLock::orderOrLock
    testSectionCreatorLock::tag
    tagCreatorLock::orderOrLock
    TEMP::primaryNodeIsLocked
    TEMP::DEFAULTNodePrimaryName
    TEMP::primaryNodesCreatorNodeIsLocked
    tagMenus::_Ltag
    testlearn::filterFind
    reference::filterFind
    testSubsectionTemplate::_LtestSubsection
    testSubsectionTemplate::name
    testlearn::_Ltestlearn
    testSubsectionLibraryName::_Lgroup
    testSubsectionLibraryName::name
    tagMenus::orderOrLock
    tagMenus::tag
    tagMenus::kRecordCreatorNode
    tagCreatorLock::tag
    reference::kCopyright
    reference::CopyrightYear
    reference::kkeywordOther
    reference::OtherKeyWords
    reference::kkeywordPrimary
    reference::kfolderpath
    reference::kmedium
    reference::URLdate
    testlearn::kcopyright
    testlearn::kcKeywordOther
    testlearn::OtherKeyWords
    testlearn::kKeywordPrimary
    tempSetup::kdefaultNodePrimary
    tempSetup::DEFAULTNodePrimaryName
    tempSetup::kdefaultNodePrimaryCreator
    tempSetup::primaryNodesCreatorNodeIsLocked
    primaryNodesCreatorLock::orderOrLock
    tempSetup::primaryNodeIsLocked
    tempSetup::kdefaultNodeOther
    testlearn::kNodePrimary
    tempSetup::kdefaultCopyright
    TEMP::kdefaultNodePrimary
    tagMenus::notesOrCopyright
    testlearn::kNodeOther
    testlearn::kctestSubsectionInfo
    report::ktestSubsection
    report::kTag1
    report::kTag2
    report::kTag3
    report::kTag4
    ReportTestSubject::tag
    report::kreportNumber
    reportSubsection::name
    TEMP::DeleteMessageInTempWindow1
    TEMP::Message
    testlearn::orderTestInformation
    TEMP::TLTestSort
    testlearn::kcbrainstorm
    reference::knodePrimary
    reference::knodeOther
    reference::referenceNodes
    reference::kcopyrightHolder
    TEMP::InventoryLibraryYN
    tagKeywordPrimary::orderOrLock
    tagKeywordPrimary::tag
    reference::publicationYearOrStuffOrderNumber
    reference::Title
    reference::thoughtsNotesEtc
    reference::referenceForReferenceWindow
    reference::kcitation
    reference::kpublication
    reference::kpublisher

Scripts used in this script

    showCitationPicture1inNewWindow
    findMode
    addORremoveOtherTagStep2_node
    addORremoveOtherTagStep2_keyword
    sortTestOrBrainstormTaggedLearnRecords
    CHUNK_addReferenceNodeAndKeywordTagIDs
    loadTestTags
    loadBrainstormTags

Layouts used in this script

    tableReport
    TEMP
    ReferenceStuffScriptLoops
    ReferenceStuff
    Reference

Tables used in this script

    TEMP
    TEMP
    reference
    report
    tag
    tag
    tagGroup
    testSubsectionTemplate
    testlearn

Table occurrences used by this script

    ReportTestSubject
    TEMP
    primaryNodesCreatorLock
    reference
    report
    reportSubsection
    tagCreatorLock
    tagKeywordPrimary
    tagMenuGroup
    tagMenus
    tempSetup
    testSectionCreatorLock
    testSubsectionLibraryName
    testSubsectionTemplate
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [addORremovePrimaryTag]	Parent Folder: [tagMenu]	Next Script: [addORremoveRefTagStep2_forRefRecord]
Script Name	addORremoveRefTagStep1
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    learnMenu3Cite
    learnMenu3CiteS
    learnMenuRefStuff
    learnMenu4RefCite
    learnMenu4noPicRefCite
    learnMenu4STUFFRefCite

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #
    #If this tag has a picture that is hidden, ask if
    #the user wants to see the picture or find
    #record's with this tag.
    If [ //There is a picture to show if... Get (LayoutName) = "learnMenu4noPicRefCite" and ( testlearn::picture ≠ "" or testlearn::kshowReferencedMedia ≠ "" ) or Get (LayoutName) = "learnMenu3CiteS" and ( reference::picture ≠ "" or reference::showMedia ≠ "" and reference::URL ≠ "" or reference::showMedia[2] ≠ "" and reference::kfileLocation ≠ "" and reference::fileName ≠ "" ) ]
    If [ testlearn::_Ltestlearn & "L" & ¶ = FilterValues ( $$ref & ¶ ; testlearn::_Ltestlearn & "L" & ¶ ) and $$citationMatch = "learn" or reference::_Lreference & "¶" = FilterValues ( $$ref ; reference::_Lreference & "¶" ) and $$citationMatch = "ref" ]
    Show Custom Dialog [ Message: "Show this tag's picture or remove tag from the selected learn record?"; Default Button: “remove”, Commit: “Yes”; Button 2: “show”, Commit: “No”; Button 3: “cancel”, Commit: “No” ]
    Else
    Show Custom Dialog [ Message: "Show this tag's picture or add this tag to the selected learn record?"; Default Button: “add”, Commit: “Yes”; Button 2: “show”, Commit: “No”; Button 3: “cancel”, Commit: “No” ]
    End If
    If [ Get (LastMessageChoice) = 2 ]
    Set Variable [ $$stopOpenNewTextWindow ]
    Perform Script [ “showCitationPicture1inNewWindow” ]
    Exit Script [ ]
    End If
    If [ Get (LastMessageChoice) = 3 ]
    Exit Script [ ]
    End If
    End If
    #
    #
    #
    #
    #If main record node is currenlty locked then
    #stop script and inform the user, unless the
    #user altering the path tag, which is unique to
    #the user's computer.
    If [ $$citationMatch ≠ "path" ]
    If [ $$lockedMainRefRecord ≠ "" and Left ( Get (LayoutName) ; 1 ) = "r" ]
    Show Custom Dialog [ Message: "Tags cannot be added or removed from locked reference records. Select this record's creator node — " & $$lockedMainRefRecord & " — in the setup window and enter the password to unlock it."; Default Button: “OK”, Commit: “No” ]
    Halt Script
    Else If [ $$lockedMainLearnRecord ≠ "" and Left ( Get (LayoutName) ; 1 ) = "l" ]
    Show Custom Dialog [ Message: "Tags cannot be added or removed from locked learn records. Select this record's creator node — " & $$lockedMainLearnRecord & " — in the setup window and enter the password to unlock it."; Default Button: “OK”, Commit: “No” ]
    Halt Script
    End If
    End If
    #
    #
    #Leave the field so the user can see
    #conditional formatting.
    Go to Field [ ]
    #
    #If user is looking at learn records do this.
    If [ Right ( Get (LayoutName) ; 7 ) = "RefCite" ]
    #
    #Check if tagging would cause record to reference itself.
    If [ testlearn::_Ltestlearn = $$main ]
    Show Custom Dialog [ Message: "Records cannot reference themselves."; Default Button: “OK”, Commit: “No” ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Halt Script
    End If
    #
    #Complete process.
    Perform Script [ “addORremoveRefTagStep2_forLearnRecord” ]
    Select Window [ Name: "Learn"; Current file ]
    Refresh Window
    Select Window [ Name: "Tag Menus"; Current file ]
    Exit Script [ ]
    End If
    #
    #If user is looking at reference records do this.
    Perform Script [ “addORremoveRefTagStep2_forRefRecord” ]
    #

Fields used in this script

    testlearn::picture
    testlearn::kshowReferencedMedia
    reference::picture
    reference::showMedia
    reference::URL
    reference::kfileLocation
    reference::fileName
    testlearn::_Ltestlearn
    reference::_Lreference

Scripts used in this script

    showCitationPicture1inNewWindow
    addORremoveRefTagStep2_forLearnRecord
    addORremoveRefTagStep2_forRefRecord

Layouts used in this script

Tables used in this script

    reference
    testlearn

Table occurrences used by this script

    reference
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [addORremoveRefTagStep1]	Parent Folder: [tagMenu]	Next Script: [addORremoveRefTagStep2_forLearnRecord]
Script Name	addORremoveRefTagStep2_forRefRecord
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    addORremoveRefTagStep1

Script Definition
Script Steps

    #
    #Get current record IDs in reference or
    #observation window.
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    #
    #Capture tagged location. If this is
    #changed while on the Qv layout it will effect
    #the record's sort location and require a resort
    #for the user to see the record in the Learn window.
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Set Variable [ $$QvLocation; Value:testlearn::orderInventoryGroupNumber ]
    End If
    #
    #Decided to not show learn tags, so this
    #next block of script makes no sense and
    #is disabled.
    // #Only allow user to have location tags for the
    // #item or for the container the item is in.
    // If [ TEMP::InventoryLibraryYN ≠ "" and Filter ( $$ref ; "L" ) ≠ "" ]
    // Select Window [ Name: "Tag Menus"; Current file ]
    // Show Custom Dialog [ Message: "This item is tagged with an in/on tag. Remove it before applying a location tag. 1) Click in/on. 2) Deslect the highlighted tag. 3) Click location. 4) Apply the tag."; Default Button: “OK”, Commit: “Yes” ]
    // Halt Script
    // End If
    #
    Set Variable [ $$ref; Value:testlearn::kcreference ]
    Else If [ Get (LastError) ≠ 112 ]
    Set Variable [ $$ref; Value:reference::lock ]
    End If
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    #
    #
    #
    #
    #If tag user clicked has not yet been selected, then add it.
    If [ reference::_Lreference & "¶" ≠ FilterValues ( $$ref ; reference::_Lreference & "¶" ) ]
    #
    #If the reference has media, then prepare to
    #ask user if they would like to show it.
    Set Variable [ $newRef; Value:reference::_Lreference ]
    If [ //There is a picture to show if... reference::picture ≠ "" or reference::showMedia ≠ "" and reference::URL ≠ "" or reference::kfileLocation ≠ "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "jpg" or reference::kfileLocation ≠ "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "gif" or reference::kfileLocation ≠ "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "eps" or reference::kfileLocation ≠ "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "jp2" or reference::kfileLocation ≠ "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "psd" or reference::kfileLocation ≠ "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "png" or reference::kfileLocation ≠ "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "pct" or reference::kfileLocation ≠ "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "pcs" or reference::kfileLocation ≠ "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = ".qt" or reference::kfileLocation ≠ "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "sgi" or reference::kfileLocation ≠ "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "tga" or reference::kfileLocation ≠ "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "tif" or reference::kfileLocation ≠ "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "bmp" or reference::kfileLocation ≠ "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "wmf" or reference::kfileLocation ≠ "" and reference::fileName ≠ "" and Right ( reference::fileName ; 3 ) = "emf" or reference::URL ≠ "" and Right ( reference::URL ; 3 )= "jpg" or reference::URL ≠ "" and Right ( reference::URL ; 3 )= "gif" or reference::URL ≠ "" and Right ( reference::URL ; 3 )= "eps" or reference::URL ≠ "" and Right ( reference::URL ; 3 )= "jp2" or reference::URL ≠ "" and Right ( reference::URL ; 3 )= "psd" or reference::URL ≠ "" and Right ( reference::URL ; 3 )= "png" or reference::URL ≠ "" and Right ( reference::URL ; 3 )= "pct" or reference::URL ≠ "" and Right ( reference::URL ; 3 )= "pcs" or reference::URL ≠ "" and Right ( reference::URL ; 3 )= ".qt" or reference::URL ≠ "" and Right ( reference::URL ; 3 )= "sgi" or reference::URL ≠ "" and Right ( reference::URL ; 3 )= "tga" or reference::URL ≠ "" and Right ( reference::URL ; 3 )= "tif" or reference::URL ≠ "" and Right ( reference::URL ; 3 )= "bmp" or reference::URL ≠ "" and Right ( reference::URL ; 3 )= "wmf" or reference::URL ≠ "" and Right ( reference::URL ; 3 )= "emf" ]
    Set Variable [ $media; Value:1 ]
    End If
    #
    #Set record number so can return user to it when done.
    Set Variable [ $recordNumber; Value:Get (RecordNumber) ]
    #
    #Add reference in reference or observation window.
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    Set Field [ testlearn::kcreference; $newRef & "¶" & $$ref ]
    Set Variable [ $$ref; Value:testlearn::kcreference ]
    Go to Field [ ]
    #
    #
    #
    #
    If [ $$QvLocation ≠ testlearn::orderInventoryGroupNumber ]
    Set Variable [ $$QvLocation ]
    Sort Records [ ] [ No dialog ]
    End If
    #
    #Ask user if they would like to show the
    #reference's media if there is any to show.
    If [ $media = 1 and testlearn::picture = "" ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Show Custom Dialog [ Message: "Display reference's media? Learn layouts with an unused picture area can display reference media. Click any Learn record's picture-selection button (in QV window) to show/not show reference media."; Default Button: “no”, Commit: “Yes”; Button 2: “yes”, Commit: “No” ]
    Else
    Show Custom Dialog [ Message: "Display location's media? Learn layouts with an unused picture area can display location media. Click any Learn record's picture-selection button (in QV window) to show/not show location media."; Default Button: “no”, Commit: “Yes”; Button 2: “yes”, Commit: “No” ]
    End If
    If [ Get (LastMessageChoice) = 2 ]
    Set Field [ testlearn::kshowReferencedMedia; $newRef ]
    Set Variable [ $$refMediaSelectedToShow; Value:$newRef ]
    End If
    End If
    #
    Else If [ Get (LastError) ≠ 112 ]
    Set Field [ reference::lock; $newRef & "¶" & $$ref ]
    Set Variable [ $$ref; Value:reference::lock ]
    Go to Field [ ]
    End If
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    #
    Freeze Window
    Go to Record/Request/Page [ $recordNumber ] [ No dialog ]
    #
    #Check main checkbox if record is not already
    #a main record. This is because when going to
    #edit cite or reference records, only main records
    #are shown by default.
    If [ "main" & ¶ ≠ FilterValues ( reference::filterFind ; "main" & ¶ ) and Get ( LayoutTableName ) = "reference" ]
    Set Variable [ $filterFind; Value:reference::filterFind ]
    Set Field [ reference::filterFind; "main" & ¶ & $filterFind ]
    End If
    #
    Set Variable [ $$stoploadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    Exit Script [ ]
    End If
    #
    #
    #
    #
    #
    #If tag has been selected, then remove it.
    Set Variable [ $removeRef; Value:reference::_Lreference ]
    Set Variable [ $$refMediaSelectedToShow ]
    #
    #Set record number so can return user to it when done.
    Set Variable [ $recordNumber; Value:Get (RecordNumber) ]
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    Set Field [ testlearn::kcreference; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used If ( ValueCount ( $$ref) ≠ ValueCount ( Substitute ( $$ref ; $removeRef & "¶" ; "" ) ) ; Substitute ( $$ref ; $removeRef & "¶" ; "" ) ; Substitute ( $$ref ; $removeRef; "" ) ) ]
    Set Variable [ $$ref; Value:testlearn::kcreference ]
    #
    #Make sure the reference being removed also
    #gets its picture removed from this learn
    #record if it is being used.
    If [ $removeRef = testlearn::kshowReferencedMedia ]
    Set Field [ testlearn::kshowReferencedMedia; "" ]
    End If
    #
    Go to Field [ ]
    #
    #
    #
    #
    If [ $$QvLocation ≠ testlearn::orderInventoryGroupNumber ]
    Set Variable [ $$QvLocation ]
    Sort Records [ ] [ No dialog ]
    End If
    #
    #
    Else If [ Get (LastError) ≠ 112 ]
    Set Field [ reference::lock; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used If ( ValueCount ( $$ref ) ≠ ValueCount ( Substitute ( $$ref ; $removeRef& "¶" ; "" ) ) ; Substitute ( $$ref ; $removeRef & "¶" ; "" ) ; Substitute ( $$ref ; $removeRef ; "" ) ) ]
    Set Variable [ $$ref; Value:reference::lock ]
    Go to Field [ ]
    End If
    #
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    #
    #NOTE: Further testing will reveal if these next
    #steps are necessary, but right now everything
    #seems to work fine without them.
    // #Sort records according to users wishes.
    // If [ TEMP::sortRef = "cat" ]
    // Sort Records [ Keep records in sorted order; Specified Sort Order: tagKeywordPrimary::orderOrLock; ascending tagKeywordPrimary::tag; ascending reference::referenceShort; ascending ] [ Restore; No dialog ]
    // Else If [ TEMP::sortRef = "abc" ]
    // Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenus::tag; ascending ] [ Restore; No dialog ]
    // End If
    Set Variable [ $$stopLoadTagRecord ]
    // Go to Record/Request/Page [ First ]
    // Scroll Window [ Home ]
    // Go to Record/Request/Page [ $recordNumber ] [ No dialog ]
    #
    #Turn of the skip part script variable.
    Set Variable [ $$skipFirstPartOfScript ]
    #

Fields used in this script

    TEMP::InventoryLibraryYN
    testlearn::orderInventoryGroupNumber
    testlearn::kcreference
    reference::lock
    reference::_Lreference
    reference::picture
    reference::showMedia
    reference::URL
    reference::kfileLocation
    reference::fileName
    testlearn::picture
    testlearn::kshowReferencedMedia
    reference::filterFind
    TEMP::sortRef
    tagKeywordPrimary::orderOrLock
    tagKeywordPrimary::tag
    reference::referenceShort
    tagMenus::tag

Scripts used in this script

Layouts used in this script

Tables used in this script

    TEMP
    reference
    tag
    testlearn

Table occurrences used by this script

    TEMP
    reference
    tagKeywordPrimary
    tagMenus
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [addORremoveRefTagStep2_forRefRecord]	Parent Folder: [tagMenu]	Next Script: [addRefsKeywordsToMainRecord]
Script Name	addORremoveRefTagStep2_forLearnRecord
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    addORremoveRefTagStep1

Script Definition
Script Steps

    #
    #Conditionally format field in learn or
    #observation window.
    Set Variable [ $$refTestLearn; Value:1 ]
    #
    #Check main checkbox if record is not already
    #a main record. This is because when going to
    #edit cite or reference records, only main records
    #are shown by default.
    If [ "main" & ¶ ≠ FilterValues ( testlearn::filterFind ; "main" & ¶ ) and Get ( LayoutTableName ) = "testlearn" ]
    Set Variable [ $filterFind; Value:testlearn::filterFind ]
    Set Field [ testlearn::filterFind; "main" & ¶ & $filterFind ]
    End If
    #
    #Get current record IDs in reference or
    #observation window.
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    Set Variable [ $$ref; Value:testlearn::kcreference ]
    #
    #Capture tagged location. If this is
    #changed while on the Qv layout it will effect
    #the record's sort location and require a resort
    #for the user to see the record in the Learn window.
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Set Variable [ $$QvLocation; Value:testlearn::orderInventoryGroupNumber ]
    End If
    Else If [ Get (LastError) ≠ 112 ]
    Set Variable [ $$ref; Value:reference::lock ]
    End If
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    #If tag user clicked has not yet been selected, then add it.
    #The 'L' is added to all Tag Menu to conditional format
    #the Learn menu button.
    If [ testlearn::_Ltestlearn & "L¶" ≠ FilterValues ( $$ref ; testlearn::_Ltestlearn & "L¶" ) ]
    #
    #If in inventory mode, only allow items
    #specified in learn records to be tagged as
    #being in one storage location at a time.
    If [ TEMP::InventoryLibraryYN ≠ "" and Filter ( $$ref ; "L" ) ≠ "" ]
    Show Custom Dialog [ Message: "This item is already tagged as being in a location (highlighted in the Tag Menus window). Untag it from this location before tagging it with a different one."; Default Button: “OK”, Commit: “Yes” ]
    Set Variable [ $$stopLoadTagRecord ]
    Halt Script
    End If
    #
    #Prevent user from tagging storage records
    #with other storage tags. I.E., No storage
    #inside of storage relationships allowed.
    Select Window [ Name: "Learn"; Current file ]
    If [ TEMP::InventoryLibraryYN ≠ "" and testlearn::brainstormCasePoint ≠ "" ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Show Custom Dialog [ Message: "This record is an in/onTag and cannot be tagged by another in/onTag. Example: To create a box on a shelf relationship make the shelf a location tag and the box an in/onTag."; Default Button: “OK”, Commit: “Yes” ]
    Halt Script
    End If
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    #
    Set Variable [ $newRef; Value:testlearn::_Ltestlearn & "L" ]
    #
    #Set record number so can return user to it when done.
    Set Variable [ $recordNumber; Value:Get (RecordNumber) ]
    #
    #Add reference in reference or observation window.
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    #
    #For reference libraries, add reference to list
    #of learn record's references.
    If [ TEMP::InventoryLibraryYN = "" ]
    Set Field [ testlearn::kcreference; $newRef & "¶" & $$ref ]
    #
    Else
    #For inventory libraries, only allow user to
    #have location tags for the item or for the
    #container the item is in.
    If [ $$ref ≠ "" ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Show Custom Dialog [ Message: "Remove the location tag currently applied to this item and replace it with this in/on tag? Items can be in locations (shed, kitchen, etc.) or in/on a box, shelf, etc. that is in a location."; Default Button: “OK”, Commit: “Yes”; Button 2: “cancel”, Commit: “No” ]
    If [ Get ( LastMessageChoice ) = 2 ]
    Set Variable [ $$stopLoadTagRecord ]
    Halt Script
    End If
    Select Window [ Name: "Learn"; Current file ]
    End If
    #
    #Set new reference and delete any
    #reference-location picture.
    Set Field [ testlearn::kcreference; $newRef & "¶" ]
    Set Field [ testlearn::kshowReferencedMedia; "" ]
    End If
    Set Variable [ $$ref; Value:testlearn::kcreference ]
    Go to Field [ ]
    #
    #
    #
    #
    If [ $$QvLocation ≠ testlearn::orderInventoryGroupNumber ]
    Sort Records [ ] [ No dialog ]
    #
    #Capture tagged location. If this is
    #changed while on the Qv layout it will effect
    #the record's sort location and require a resort
    #for the user to see the record in the Learn window.
    If [ Get ( LayoutName ) ≠ "learn4EDITstuff" ]
    Set Variable [ $$QvLocation ]
    End If
    #
    End If
    #
    Else If [ Get (LastError) ≠ 112 ]
    #If in the reference section, do this...
    Set Field [ reference::lock; $newRef & "¶" & $$ref ]
    Set Variable [ $$ref; Value:reference::lock ]
    Go to Field [ ]
    End If
    #
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    #
    #Sort records according to users wishes.
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::orderInventoryGroupNumber; ascending testlearn::note; ascending ] [ Restore; No dialog ]
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::date; descending testlearn::timestamp; descending ] [ Restore; No dialog ]
    End If
    #
    Set Variable [ $$stopLoadTagRecord ]
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    Go to Record/Request/Page [ $recordNumber ] [ No dialog ]
    Exit Script [ ]
    End If
    #
    #
    #
    #
    #
    #
    #
    #If tag has been selected, then remove it.
    Set Variable [ $removeRef; Value:testlearn::_Ltestlearn & "L" ]
    #
    #Set record number so can return user to it when done.
    Set Variable [ $recordNumber; Value:Get (RecordNumber) ]
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    Set Field [ testlearn::kcreference; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used If ( ValueCount ( $$ref) ≠ ValueCount ( Substitute ( $$ref ; $removeRef & "¶" ; "" ) ) ; Substitute ( $$ref ; $removeRef & "¶" ; "" ) ; Substitute ( $$ref ; $removeRef; "" ) ) ]
    Set Variable [ $$ref; Value:testlearn::kcreference ]
    Go to Field [ ]
    #
    #
    #
    #
    If [ $$QvLocation ≠ testlearn::orderInventoryGroupNumber ]
    If [ Get ( LayoutName ) ≠ "learn4EDITstuff" ]
    Set Variable [ $$QvLocation ]
    End If
    Sort Records [ ] [ No dialog ]
    End If
    Else If [ Get (LastError) ≠ 112 ]
    Set Field [ reference::lock; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used If ( ValueCount ( $$ref ) ≠ ValueCount ( Substitute ( $$ref ; $removeRef& "¶" ; "" ) ) ; Substitute ( $$ref ; $removeRef & "¶" ; "" ) ; Substitute ( $$ref ; $removeRef ; "" ) ) ]
    Set Variable [ $$ref; Value:reference::lock ]
    Go to Field [ ]
    End If
    #
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    #
    #Sort records according to users wishes.
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::orderInventoryGroupNumber; ascending testlearn::note; ascending ] [ Restore; No dialog ]
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::date; descending testlearn::timestamp; descending ] [ Restore; No dialog ]
    End If
    #
    Set Variable [ $$stopLoadTagRecord ]
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    Go to Record/Request/Page [ $recordNumber ] [ No dialog ]
    Set Variable [ $$skipFirstPartOfScript ]
    #
    #

Fields used in this script

    testlearn::filterFind
    testlearn::kcreference
    TEMP::InventoryLibraryYN
    testlearn::orderInventoryGroupNumber
    reference::lock
    testlearn::_Ltestlearn
    testlearn::brainstormCasePoint
    testlearn::kshowReferencedMedia
    testlearn::note
    testlearn::date
    testlearn::timestamp

Scripts used in this script

Layouts used in this script

Tables used in this script

    TEMP
    reference
    testlearn

Table occurrences used by this script

    TEMP
    reference
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [addORremoveRefTagStep2_forLearnRecord]	Parent Folder: [tagMenu]	Next Script: [archiveChecklist]
Script Name	addRefsKeywordsToMainRecord
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferenceMenu3Cite
    ReferenceMenu3CiteNoPicture
    learnMenu3Cite
    learnMenu3CiteS

Scripts that use this script

Script Definition
Script Steps

    #
    #Ask user if OK to replace keywords.
    Show Custom Dialog [ Message: "Add reference's keywords to current Learn record — " & //KEYWORDS tagKeywordPrimary::tag & ", " & reference::OtherKeyWords & " — ? (This will replace all keywords for this record, if there are any.)"; Default Button: “no”, Commit: “Yes”; Button 2: “yes”, Commit: “No” ]
    #
    #Copy tag's keywords and go to Learn window and
    #replace current record's keywords with them.
    If [ Get ( LastMessageChoice ) = 2 ]
    Set Variable [ $citekeywordOther; Value:reference::kkeywordOther ]
    Set Variable [ $citekeywordOtherWords; Value:reference::OtherKeyWords ]
    Set Variable [ $citekeywordPrimary; Value:reference::kkeywordPrimary ]
    Select Window [ Name: "Learn"; Current file ]
    Set Field [ testlearn::kKeywordPrimary; $citekeywordPrimary ]
    Set Field [ testlearn::kcKeywordOther; $citekeywordOther ]
    Set Field [ testlearn::OtherKeyWords; $citekeywordOtherWords ]
    End If
    #
    #Return to Tag Menus window.
    Select Window [ Name: "Tag Menus"; Current file ]

Fields used in this script

    tagKeywordPrimary::tag
    reference::OtherKeyWords
    reference::kkeywordOther
    reference::kkeywordPrimary
    testlearn::kKeywordPrimary
    testlearn::kcKeywordOther
    testlearn::OtherKeyWords

Scripts used in this script

Layouts used in this script

Tables used in this script

    reference
    tag
    testlearn

Table occurrences used by this script

    reference
    tagKeywordPrimary
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [addRefsKeywordsToMainRecord]	Parent Folder: [tagMenu]	Next Script: [backFromTagMenus]
Script Name	archiveChecklist
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    testMenuTestItem

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Exit any fields before beginnning just in
    #case the user changed the spelling of
    #anything that would require the spellcheck
    #script to run.
    Go to Field [ ]
    #
    #
    #BEGIN Stop this script checks.
    #
    #Test subject is locked.
    If [ $$testSubjectIsLocked ≠ "" and Get ( LayoutName ) ≠ "defaultTest" and Get ( LayoutName ) ≠ "learnTest" ]
    Show Custom Dialog [ Message: "The test subject — " & $$testSubjectIsLocked & " — is locked. To unlock, A) go back to the setup node tag menu. B) Select this test subject. C) Click 'lock' and enter the password."; Default Button: “OK”, Commit: “No” ]
    Set Variable [ $exit; Value:1 ]
    End If
    #
    #Primary node is locked.
    If [ TEMP::primaryNodeIsLocked ≠ "" ]
    If [ $exit = "" ]
    Show Custom Dialog [ Message: "The default primary node — " & TEMP::DEFAULTNodePrimaryName & " — is locked. Go to the Default Node Tag Menu and A) click 'lock' to unlock it, B) select an unlocked node for the primary node, or C) create a new primary node."; Default Button: “OK”, Commit: “No” ]
    Else
    Show Custom Dialog [ Message: "ALSO, the default primary node — " & TEMP::DEFAULTNodePrimaryName & " — is locked. Go to the Default Node Tag Menu and A) click 'lock' to unlock it, B) select an unlocked node for the primary node, or C) create a new primary node."; Default Button: “OK”, Commit: “No” ]
    End If
    Set Variable [ $exit; Value:1 ]
    End If
    #
    #If any of the above are true, then
    #exit this script.
    If [ $exit = 1 ]
    Exit Script [ ]
    End If
    #
    #END Stop this script checks.
    #
    #
    #
    #If there are for items, tell the user they will not
    #be archived using this script, and how to
    #archive them.
    If [ $$noFT_ItemsFound = "" ]
    Show Custom Dialog [ Message: "Now archiving check and text items, not form items. Click the +form button to add form items."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #
    #
    #BEGIN See where to insert form.
    #
    #
    #If the user clicks the V button on the setup
    #test-item layout, skip this bit, otherwise see
    #where the user wants to put the form this
    #script will create on a Test or Report field.
    If [ Left (Get (LayoutName) ; 5 ) ≠ "setup" ]
    #
    #Select the test window and copy the contents
    #of the note field and see if it is active.
    Select Window [ Name: "Test"; Current file ]
    #
    #If library is in the report section ...
    If [ Get ( LastError )= 112 ]
    Select Window [ Name: "Report"; Current file ]
    Set Variable [ $report; Value:1 ]
    #
    #If the user has not clicked into a field, into
    #which to insert the form let them know they
    #need to do this before the form can be inserted.
    If [ Get ( ActiveFieldName ) = "" ]
    Show Custom Dialog [ Message: "Enter the field where you want the form to go. It will be placed below any text currently in that field."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    #
    #
    Else
    #If a field has been selected then capture
    #its contents if any.
    Set Variable [ $note; Value:Get ( ActiveFieldContents ) ]
    End If
    #
    #
    #If library is in the learn section ...
    Else
    #
    #Capture the contents of the active field.
    Set Variable [ $note; Value:testlearn::note ]
    End If
    #
    #Return to the Tag Menus window.
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    #If the note field is not blank ...
    If [ $note ≠ "" ]
    #
    #Tell the user that a form will be added below
    #the current text in the note text box, AND if
    #the user hiding the test FT items that make up
    #a form, tell the user how to reveal them.
    If [ TEMP::testHideFormTextItemsFTs = 1 ]
    Show Custom Dialog [ Message: "The archive will be added below the current text. You may need to scroll down to see it."; Default Button: “OK”, Commit: “Yes”; Button 2: “cancel”, Commit: “No” ]
    Else
    Show Custom Dialog [ Message: "The archive will be added below the current text. You may need to scroll down to see it."; Default Button: “OK”, Commit: “Yes”; Button 2: “cancel”, Commit: “No” ]
    End If
    End If
    #
    #
    #If the user is on the setup layout, note this.
    Else If [ Left (Get (LayoutName) ; 5 ) = "setup" ]
    Set Variable [ $insertFormInPreviewWindow; Value:1 ]
    End If
    #
    #
    #END See where to insert form.
    #
    #
    #
    #
    #
    #BEGIN Create form.
    #
    #
    #Create the form, unless the user
    #clicked cancel in a new window.
    If [ Get (LastMessageChoice) ≠ 2 or $$addFormToNewTestResult ≠ "" ]
    Set Variable [ $$userClickedVButton; Value:1 ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    #
    New Window [ Name: "Form Preview"; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “ltagSCRIPTloops” (tagMenus) ]
    Adjust Window [ Resize to Fit ]
    #
    Set Variable [ $$userClickedVButton ]
    Set Variable [ $$stopLoadTagRecord ]
    #
    #Find all test items for this subsection.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Enter Find Mode [ ]
    Set Field [ tagMenuTestItemGroup::match; TEMP::ktestItemSubsection & ¶ ]
    Perform Find [ ]
    #
    #To insure the 'sort' button will next sort
    #alphabetically, note that the current sort is
    #by category/group.
    Set Field [ TEMP::sortTestItem; "cat" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuTestItemGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuTestItemGroup::name; ascending tagMenuTestItemGroup::_Lgroup; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    Scroll Window [ Home ]
    Go to Record/Request/Page [ First ]
    #
    #Set the group variable to 1 so this first group
    #will be captured by the loop below.
    Set Variable [ $groupName; Value:1 ]
    #
    Loop
    #
    #Stop any find error messages as there may be
    #no test items.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    Go to Field [ ]
    #
    #If the item is an FT item then add it to the
    #form.
    If [ tagMenus::notesOrCopyright ≠ "FT" ]
    #
    #If the style of the FT item is main header style ...
    If [ tagMenus::textStyleOrCreatorNodeFlag = "" or tagMenus::textStyleOrCreatorNodeFlag = "1" or tagMenus::textStyleOrCreatorNodeFlag = "2" ]
    Set Variable [ $tag; Value:tagMenus::tag ]
    Else
    #
    #and it is not the first form item ...
    If [ $tag = "" ]
    Set Variable [ $tag; Value:tagMenus::tag ]
    #
    #then include a paragraph between it and
    #the last FT item added.
    Else
    Set Variable [ $tag; Value:¶ & tagMenus::tag ]
    End If
    End If
    #
    #Include the checkmark symbol for checklist
    #items, and color it grey if unchecked and black
    #if checked.
    If [ tagMenus::notesOrCopyright = "✓" ]
    If [ tagMenus::_Ltag & "¶" = FilterValues ( $$checkedTestItem ; tagMenus::_Ltag & "¶" ) ]
    Set Variable [ $tag; Value://TextStyleAdd ( "✓ " ; Bold ) & tagMenus::tag "✓ " & tagMenus::tag ]
    Else
    Set Variable [ $tag; Value:TextColor ( "✓ " ; RGB ( 150 ; 150 ; 150 ) ) & tagMenus::tag ]
    End If
    End If
    #
    #If the items group name does not match the
    #last captured group ID, then we know this
    #item belongs to a new group, and its group
    #name needs to be captured and added to
    #the archive.
    If [ tagMenus::kGroupOrTest ≠ $groupName ]
    Set Variable [ $tag; Value:¶ & TextColor ( TextSize ( TextFont ( tagMenuTestItemGroup::name ; "Arial" ) ; 18 ) ; RGB ( 125 ; 125 ; 125 ) ) & ¶ & $tag ]
    End If
    #
    #Now set the group ID, so when the loop
    #restarts on the next item its group name will
    #be added to the archive only if it is different
    #from the last items group.
    Set Variable [ $groupName; Value:tagMenus::kGroupOrTest ]
    #
    #If this the first item on this form,
    #then just added it.
    If [ $form = "" ]
    Set Variable [ $form; Value:TextColor ( TextSize ( "Checklist Archived " & Get ( CurrentTimeStamp ) ; 16 ) ; RGB ( 125 ; 125 ; 125 ) ) & ¶ & $tag ]
    #
    #BUT, if the form already has items in it, then
    #add this next item a paragraph below the last
    #item in the form.
    Else
    Set Variable [ $form; Value:$form & ¶ & $tag ]
    End If
    End If
    #
    Go to Record/Request/Page [ Next; Exit after last ]
    #
    End Loop
    End If
    #
    #
    #END Create form.
    #
    #
    #
    #
    #
    #
    #BEGIN Insert form in designated field.
    #
    #
    #If it turns out there are no FT items, then tell
    #the user this and exit the script.
    If [ $form = "" ]
    Close Window [ Current Window ]
    Show Custom Dialog [ Message: "There are no form test (FT) items."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #
    #Create a clear formatting variable to insure
    #anything typed after the newly inserted form
    #will be in the default format.
    Set Variable [ $clearFormatting; Value:TextFont ( " " ; "Georgia" ) ]
    Set Variable [ $clearFormatting; Value:TextColor ( $clearFormatting ; RGB ( 34 ; 34 ; 34 ) ) ]
    Set Variable [ $clearFormatting; Value:TextSize ( $clearFormatting ; 16 ) ]
    Set Variable [ $clearFormatting; Value:TextStyleAdd ( $clearFormatting ; Plain ) ]
    #
    #
    #If the user is in the Test Template section,
    #then go to the preview form layout and
    #insert the form.
    If [ $insertFormInPreviewWindow ≠ "" ]
    Go to Layout [ “testItemFormPreview” (TEMP) ]
    Set Field [ TEMP::Message; $form ]
    Adjust Window [ Resize to Fit ]
    Move/Resize Window [ Current Window; Height: Get (ScreenHeight) ]
    Pause/Resume Script [ Indefinitely ]
    Exit Script [ ]
    End If
    #
    #If the user is NOT in the Test Template
    #section, then close the window used to
    #create the form and proceed to insert it
    #where the user wants it to go.
    If [ $insertFormInPreviewWindow = "" ]
    Close Window [ Current Window ]
    End If
    #
    #If the user is in the test section, then go the
    #Test window to add the form to the current
    #result.
    If [ Left (Get (LayoutName) ; 5 ) ≠ "setup" ]
    If [ $report = 1 ]
    Select Window [ Name: "Report"; Current file ]
    Else
    Select Window [ Name: "Test"; Current file ]
    End If
    End If
    #
    #If the note field is blank, then add the form to it.
    If [ $note = "" ]
    If [ $report = 1 ]
    Set Field [ $form & $clearFormatting & ¶ & ¶ & $clearFormatting ]
    Else
    Set Field [ testlearn::note; $form & $clearFormatting & ¶ & ¶ & $clearFormatting ]
    End If
    #
    #If it is not blank, then add the form below
    #the curren text.
    Else
    If [ $report = 1 ]
    Set Field [ $note & ¶ & $form & $clearFormatting & ¶ & ¶ & $clearFormatting ]
    Else
    Set Field [ testlearn::note; $note & ¶ & $form & $clearFormatting & ¶ & ¶ & $clearFormatting ]
    End If
    End If
    #
    #
    #END Insert form in designated field.
    #
    #

Fields used in this script

    TEMP::primaryNodeIsLocked
    TEMP::DEFAULTNodePrimaryName
    testlearn::note
    TEMP::testHideFormTextItemsFTs
    TEMP::ktestItemSubsection
    tagMenuTestItemGroup::match
    TEMP::sortTestItem
    tagMenuTestItemGroup::orderOrLibraryType
    tagMenuTestItemGroup::name
    tagMenuTestItemGroup::_Lgroup
    tagMenus::orderOrLock
    tagMenus::tag
    tagMenus::notesOrCopyright
    tagMenus::textStyleOrCreatorNodeFlag
    tagMenus::_Ltag
    tagMenus::kGroupOrTest
    TEMP::Message

Scripts used in this script

Layouts used in this script

    ltagSCRIPTloops
    testItemFormPreview

Tables used in this script

    TEMP
    tag
    tagGroup
    testlearn

Table occurrences used by this script

    TEMP
    tagMenuTestItemGroup
    tagMenus
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [archiveChecklist]	Parent Folder: [tagMenu]	Next Script: [brainstormExit]
Script Name	backFromTagMenus
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    If [ Left ( $$openedFrom ; 4 ) = "step" ]
    Close Window [ Current Window ]
    Else If [ Get (WindowName) = "Tag Menus" ]
    Select Window [ Name: "Setup"; Current file ]
    Else If [ Get (WindowName) = "Recommendations" ]
    Select Window [ Name: "Report"; Current file ]
    End If

Fields used in this script

Scripts used in this script

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [backFromTagMenus]	Parent Folder: [tagMenu]	Next Script: [checkActiveFieldForChangesAndTellUserIfItIsLocked]
Script Name	brainstormExit
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    If [ $$citationMatch = "brainstorm" and $$findMode = "" or $$citationmatch = "test" and $$findMode = "" ]
    Set Variable [ $$stopTgotoCitationMenu ]
    Go to Field [ ]
    Exit Script [ ]
    End If
    If [ Get (WindowName) = "Tag Menus" ]
    Set Field [ testlearnReportTags::orderTestInformation; "" ]
    Else
    Set Field [ testlearn::orderTestInformation; "" ]
    End If
    Set Variable [ $$orderNumbersNotAllowed; Value:1 ]
    Go to Field [ ]

Fields used in this script

    testlearnReportTags::orderTestInformation
    testlearn::orderTestInformation

Scripts used in this script

Layouts used in this script

Tables used in this script

    testlearn

Table occurrences used by this script

    testlearn
    testlearnReportTags

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [brainstormExit]	Parent Folder: [tagMenu]	Next Script: [checkIfLockedOnLearnTagMenus]
Script Name	checkActiveFieldForChangesAndTellUserIfItIsLocked
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Exit script if user is clicked V button to view a form.
    If [ $$userClickedVButton ≠ "" ]
    Exit Script [ ]
    End If
    #
    #
    #Used on test setup layouts to revert any locked fields
    #back to the original text.
    If [ //Test setup window testSectionCreatorLock::orderOrLock ≠ "" or testSubsectionGroupNodeLock::orderOrLock ≠ "" and Get ( ActiveFieldName ) = "name" ]
    If [ Get ( ActiveFieldTableName ) = "testSubsectionGroup" ]
    Set Variable [ $lockedGroupName; Value:1 ]
    End If
    #
    #If locked, show the locked message
    #one time per session.
    If [ testSectionCreatorLock::orderOrLock ≠ "" ]
    If [ $$stopShowingTestItemLockMessage ≠ 1 ]
    Show Custom Dialog [ Message: "Changes made to records locked by the node — " & testSectionCreatorLock::tag & " — like this one, will be reverted upon exiting. This message appears once per session. Restart library to see it again."; Default Button: “OK”, Commit: “Yes” ]
    Set Variable [ $$stopShowingTestItemLockMessage; Value:1 ]
    End If
    Exit Script [ ]
    End If
    #
    If [ $lockedGroupName = 1 ]
    Show Custom Dialog [ Message: "This group name is locked. Go the node that created it — " & testSubsectionGroupNodeLock::tag & " — and enter the password to unlock it."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    Else If [ //Tag menus window tagMenuGroup::orderOrLibraryType ≠ "" and tagMenuGroup::match = "copyright" or tagMenus::orderOrLock = "lock" ]
    #
    #If record is locked by system...
    If [ tagMenuGroup::orderOrLibraryType ≠ "" and tagMenuGroup::match = "copyright" and Get ( ActiveFieldName ) = "name" or tagMenus::orderOrLock = "lock" ]
    Show Custom Dialog [ Message: "Record is locked by the system. So you can look and copy text but any changes will be undone by the system."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    Else If [ //Tag menus window nodeLockTestTagItemGroup::orderOrLock ≠ "" and Get ( ActiveFieldName ) = "name" and $$citationMatch ≠ "path" //or nodeLockTagMenus::orderOrLock ≠ "" and Get ( ActiveFieldName ) = "tag" and $$citationMatch = "copyright" or tagCreatorLock::orderOrLock ≠ "" and Get ( ActiveFieldName ) = "tag" and $$citationMatch = "node" or tagCreatorLock::orderOrLock ≠ "" and Get ( ActiveFieldName ) = "tag" and $$citationMatch = "publisher" or tagCreatorLock::orderOrLock ≠ "" and Get ( ActiveFieldName ) = "tag" and $$citationMatch = "brainstorm" or tagCreatorLock::orderOrLock ≠ "" and Get ( ActiveFieldName ) = "tag" and $$citationMatch = "publication" or tagCreatorLock::orderOrLock ≠ "" and Get ( ActiveFieldName ) = "tag" and $$citationMatch = "testItem" or tagCreatorLock::orderOrLock ≠ "" and Get ( ActiveFieldName ) = "tag" and $$citationMatch = "key" ]
    Set Variable [ $lockedGroupName; Value:1 ]
    #
    #If locked, show the locked message
    #one time per session.
    If [ tagCreatorLock::orderOrLock ≠ "" ]
    If [ $$stopShowingTestItemLockMessage ≠ 1 ]
    Show Custom Dialog [ Message: "Changes made to records locked by the node — " & tagCreatorLock::tag & " like this one, will be reverted upon exiting. This message appears once per session. Restart library to see it again. "; Default Button: “OK”, Commit: “Yes” ]
    Set Variable [ $$stopShowingTestItemLockMessage; Value:1 ]
    End If
    Exit Script [ ]
    End If
    #
    If [ $lockedGroupName = 1 ]
    Show Custom Dialog [ Message: "This group name is locked. Go the node that created it -- " & nodeLockTestTagItemGroup::tag & " -- and enter the password to unlock it."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    Go to Field [ ]
    End If
    Refresh Window

Fields used in this script

    testSectionCreatorLock::orderOrLock
    testSubsectionGroupNodeLock::orderOrLock
    testSectionCreatorLock::tag
    testSubsectionGroupNodeLock::tag
    tagMenuGroup::orderOrLibraryType
    tagMenuGroup::match
    tagMenus::orderOrLock
    nodeLockTestTagItemGroup::orderOrLock
    tagCreatorLock::orderOrLock
    tagCreatorLock::tag
    nodeLockTestTagItemGroup::tag

Scripts used in this script

Layouts used in this script

Tables used in this script

    tag
    tagGroup

Table occurrences used by this script

    nodeLockTestTagItemGroup
    tagCreatorLock
    tagMenuGroup
    tagMenus
    testSectionCreatorLock
    testSubsectionGroupNodeLock

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [checkActiveFieldForChangesAndTellUserIfItIsLocked]	Parent Folder: [tagMenu]	Next Script: [checkKeyANDNodeTagNames]
Script Name	checkIfLockedOnLearnTagMenus
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    If [ $$stopLockCheck = 1 or $$citationMatch = "key" //or $$citationMatch = "node" or $$citationMatch = "copyright" or $$citationMatch = "medium" or $$citationMatch = "path" ]
    Exit Script [ ]
    End If
    #Used on learn tag menus to keep user out of any
    #locked fields.
    If [ tagCreatorLock::orderOrLock ≠ "" and Get ( ActiveFieldName ) = "tag" ]
    Set Field [ tagMenus::tag; tagMenus::tagSpelling ]
    Go to Field [ ]
    Show Custom Dialog [ Message: "This record is locked. Go the node that created it — " & tagCreatorLock::tag & " — and enter the password to unlock it."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    If [ nodeLockTagGroupCreatorLock::orderOrLock ≠ "" and Get ( ActiveFieldName ) = "name" ]
    // Set Variable [ $$stopChangeSpellingOfTagCategory; Value:1 ]
    Set Field [ tagMenuGroup::name; tagMenuGroup::nameSpellingEXCEPTForTestItemGroup ]
    Go to Field [ ]
    Show Custom Dialog [ Message: "This group name is locked. Go the node that created it — " & nodeLockTestTagItemGroup::tag & " — and enter the password to unlock it."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If

Fields used in this script

    tagCreatorLock::orderOrLock
    tagMenus::tagSpelling
    tagMenus::tag
    tagCreatorLock::tag
    nodeLockTagGroupCreatorLock::orderOrLock
    tagMenuGroup::nameSpellingEXCEPTForTestItemGroup
    tagMenuGroup::name
    nodeLockTestTagItemGroup::tag

Scripts used in this script

Layouts used in this script

Tables used in this script

    tag
    tag
    tagGroup

Table occurrences used by this script

    nodeLockTagGroupCreatorLock
    nodeLockTestTagItemGroup
    tagCreatorLock
    tagMenuGroup
    tagMenus

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [checkIfLockedOnLearnTagMenus]	Parent Folder: [tagMenu]	Next Script: [checkORaddTestItem]
Script Name	checkKeyANDNodeTagNames
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    checkKeyANDNodeTagNames
    noCommasAllowed

Script Definition
Script Steps

    #
    #
    #Admin task.
    Allow User Abort [ Off ]
    #
    #Stop script if this script will slow down
    #other scripts.
    If [ $$stopTest = 1 //or $$citationMatch = "key" //or $$citationMatch = "node" //or $$citationMatch = "copyright" or $$citationMatch = "path" or $$citationMatch = "brainstorm" ]
    Exit Script [ ]
    End If
    #
    #First turn back any spelling changes made by dragging
    #text into other records.
    If [ Get ( ActiveFieldName ) = "tag" ]
    #
    #Set this tag variable to keep any changes
    #user made to the current record, so it can be
    #checked for duplication later in this script.
    Set Variable [ $$tag; Value:tagMenus::_Ltag ]
    End If
    Set Variable [ $tagSpelling; Value:tagMenus::tagSpelling ]
    Perform Script [ “CHUNK_checkForDraggedPasteChanges” ]
    Set Variable [ $$tag ]
    Set Field [ tagMenus::tagSpelling; $tagSpelling ]
    #
    #If user approved spelling for this tag and no
    #changes have been made then cancel the script.
    If [ tagMenus::tag = tagMenus::tagSpelling and tagMenus::tag ≠ "" ]
    Exit Script [ ]
    End If
    #
    #If blank, put in ID number.
    If [ tagMenus::tag = "" ]
    If [ $$citationMatch = "key" ]
    #
    #If spelling field is blank, put in ID number.
    If [ tagMenus::tagSpelling = "" ]
    Set Field [ tagMenus::tagSpelling; "keyword" & tagMenus::_Ltag ]
    Set Field [ tagMenus::tag; "keyword" & tagMenus::_Ltag ]
    Else
    Set Field [ tagMenus::tag; tagMenus::tagSpelling ]
    End If
    #
    #
    Else If [ $$citationMatch = "node" ]
    #
    #If spelling field is blank, put in ID number.
    If [ tagMenus::tagSpelling = "" ]
    Set Field [ tagMenus::tagSpelling; "node" & tagMenus::_Ltag ]
    Set Field [ tagMenus::tag; "node" & tagMenus::_Ltag ]
    Else
    Set Field [ tagMenus::tag; tagMenus::tagSpelling ]
    End If
    End If
    #
    Show Custom Dialog [ Message: "Blank tag records are not allowed."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    Perform Script [ “removeTextFormattingAndCommas” ]
    #
    #The $$key variable is set by main record load
    #scripts, so remember it, and change it back
    #to this setting when script is done.
    Set Variable [ $RememberKey; Value:$$Key ]
    #
    #Get the key for this record for later in script
    #when it will be used to change the spelling in
    #any records tagged with this key, but of course
    #showing the old spelling of the tag. The spellling
    #unlike the key is belongs to the tagged record
    #not the tag, and so the spelling must be changed
    #in every record tagged.
    Set Variable [ $$key; Value:tagMenus::_Ltag ]
    #
    #
    #Commit changes to the spellling.
    Commit Records/Requests
    Set Variable [ $newSpelling; Value:tagMenus::tag ]
    #
    #If the this node is the primary node, then
    #update the temp field with the name change.
    If [ tagMenus::_Ltag = TEMP::kdefaultNodePrimary ]
    Set Field [ TEMP::DEFAULTNodePrimaryName; tagMenus::tag ]
    End If
    #
    #If the this node is the test subject node, then
    #update the temp field with the name change.
    If [ tagMenus::_Ltag = TEMP::kdefaultNodeTestSubject ]
    Set Field [ TEMP::DEFAULTNodeTestSubjectName; tagMenus::tag ]
    End If
    #
    #If the this node is an other node, then
    #inform user that they need to remove and
    #add it back to see the change take place.
    If [ FilterValues ( TEMP::kdefaultNodeOther ; tagMenus::_Ltag & "¶" ) ]
    Show Custom Dialog [ Message: "On the Setup's Node Tag Menus' window, click the O button twice: 1) to remove and then 2) to add it back. This forces an update of its spelling in all temporary fields."; Default Button: “OK”, Commit: “Yes” ]
    Show Custom Dialog [ Message: "This manual requirement is on the list for automation in a future version of the library app."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #Get library name for use in comment below.
    Set Variable [ $libraryName; Value:TEMP::userLibraryName ]
    #
    #
    #
    #
    #
    #
    #BEGIN A - Check if a tag with this spelling
    #already exists in this library.
    #
    #
    #This loop will first identitfy any duplicate
    #tags. If the user changes the spelling, it will
    #then repeat to see if the changed spelling is
    #a duplicate, and so on, until the user either
    #creates a unique tag, reverts the tag in
    #question back to its original spelling, OR if
    #this a node tag, the loop will end after telling
    #the user that duplicate nodes spellings are
    #OK, but can create problems.
    Loop
    #Stop tag record load script.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    #
    #Open a new window find any duplicate tags.
    #This keeps the current window's scroll
    #position static for the user.
    New Window [ Name: "Duplicate Check"; Height: 1; Width: 1; Top: -10000; Left: -10000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Enter Find Mode [ ]
    Set Field [ tagMenus::tag; "==" & $newSpelling ]
    Set Field [ tagMenus::match; $$citationMatch ]
    Perform Find [ ]
    #
    #Turn on tag record load script.
    Set Variable [ $$stopLoadTagRecord ]
    #
    #If a tag with this spelling is found,
    #inform the user.
    Exit Loop If [ Get (FoundCount) ≤ 1 ]
    If [ Get (FoundCount) > 1 ]
    #
    #Close the duplicate check window, and
    #highlight the duplicates and orginal tag.
    Close Window [ Current Window ]
    Set Variable [ $turnRed; Value:$newSpelling ]
    Refresh Window
    #
    #This first 'if...' I don't think is in use, as a
    #blank tag field is always filled in by an above
    #section of this script that must have been
    #added later, and then I failed to see that this
    #check was no longer necessary? Anyway,
    #leaving this check in for now, until I've got
    #more brain resources to feel confident that it
    #can be removed!
    If [ tagMenus::tagSpelling = "" ]
    If [ $$citationMatch = "node" ]
    Show Custom Dialog [ Message: "A node with this exact spelling already exists (FYI: it may only show up in the Reference section). Nodes can have the same name, though for your sake, add an initial, number, or a picture to help you tell these nodes apart."; Default Button: “OK”, Commit: “Yes” ]
    Else If [ $$citationMatch = "key" ]
    Show Custom Dialog [ Message: "Every keyword in this library must have a unique name. Change the spelling of this duplicate keyword or delete it."; Default Button: “change”, Commit: “Yes”; Button 2: “delete”, Commit: “No”; Input #1: tagMenus::tag, "change spelling" ]
    End If
    #
    #On the first time thru the loop where a
    #duplicate is found, and all future times thru
    #this loop where a duplicate is found, inform
    #the user like this...
    Else If [ tagMenus::tagSpelling ≠ "" ]
    If [ $$citationMatch = "node" ]
    Show Custom Dialog [ Message: "A node with this exact spelling already exists (FYI: it may only show up in the Reference section). Nodes can have the same name, though for your sake, add an initial, number, or a picture to help you tell these nodes apart."; Default Button: “OK”, Commit: “Yes” ]
    Else If [ $$citationMatch = "key" ]
    Show Custom Dialog [ Message: "Every keyword in this library must have a unique name. Change this keyword's spelling or revert it back to its old spelling = " & tagMenus::tagSpelling & "."; Default Button: “change”, Commit: “Yes”; Button 2: “revert”, Commit: “No”; Input #1: tagMenus::tag, "change spelling" ]
    Commit Records/Requests
    End If
    End If
    Set Variable [ $turnRed ]
    #
    #Choice 2 (only applies to key tags)
    If [ Get ( LastMessageChoice ) = 2 ]
    #
    #Choice 2: key
    If [ $$citationMatch = "key" ]
    #
    #If user decided to delete new tag then delete it.
    If [ tagMenus::tagSpelling = "" ]
    Delete Record/Request [ No dialog ]
    #
    #Reset $$key variable.
    Set Variable [ $$Key; Value:$RememberKey ]
    Refresh Window
    Exit Script [ ]
    #
    #If change is made to an existing tag, then go
    #to part B.
    Else If [ tagMenus::tagSpelling ≠ "" ]
    Set Field [ tagMenus::tag; tagMenus::tagSpelling ]
    #
    #Reset $$key variable.
    Set Variable [ $$Key; Value:$RememberKey ]
    Refresh Window
    Exit Script [ ]
    End If
    End If
    #
    #Choice 1
    Else If [ Get ( LastMessageChoice ) = 1 ]
    #
    If [ $$citationMatch = "node" ]
    #
    #If new tag, user has been informed and we can exit.
    If [ tagMenus::tagSpelling = "" ]
    Set Field [ tagMenus::tagSpelling; tagMenus::tag ]
    #
    #Reset $$key variable.
    Set Variable [ $$Key; Value:$RememberKey ]
    Refresh Window
    Exit Script [ ]
    #
    #If change is made to an existing tag, then go
    #to part B.
    Else If [ tagMenus::tagSpelling ≠ "" ]
    Set Variable [ $exit; Value:1 ]
    End If
    #
    Else If [ $$citationMatch = "key" ]
    #If change was made to a new tag check if spelling
    #is already in use.
    Set Variable [ $newSpelling; Value:tagMenus::tag ]
    Refresh Window
    #
    #Set this tag variable to keep any changes
    #user made to the current record, so it can be
    #checked for duplication when this script is
    #run all over again right now.
    Set Variable [ $$tag; Value:tagMenus::_Ltag ]
    Perform Script [ “checkKeyANDNodeTagNames” ]
    #
    #Reset $$key variable.
    Set Variable [ $$Key; Value:$RememberKey ]
    Refresh Window
    Exit Script [ ]
    #
    End If
    End If
    End If
    Exit Loop If [ $exit = 1 ]
    End Loop
    #
    #Close the duplicate check window of still
    #open, and clear the exit variable in
    #preparation for part B.
    Close Window [ Name: "Duplicate Check"; Current file ]
    Set Variable [ $exit ]
    #
    #
    #
    #END A - Check if a tag with this spelling
    #already exists in this section of the library.
    #
    #
    #
    #
    #
    #
    #BEGIN B - Complete spelling change or adding of new tag.
    #
    #
    #
    #
    Set Variable [ $recordNumber; Value:Get (RecordNumber) ]
    #
    #If the spellling of the tag has changed or if tag
    #is new do the following.
    If [ tagMenus::tag ≠ tagMenus::tagSpelling and tagMenus::tagSpelling ≠ "" ]
    #
    #(See disabled code not below.)
    // Set Variable [ $$key; Value:tagMenus::_Ltag ]
    #
    #Commit records so user can change spelling.
    #Without commit records the system will not find
    #a newly added tag during the find part script.
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Setup"; Current file ]
    Commit Records/Requests
    Else If [ Get (LastError) ≠ 112 ]
    Commit Records/Requests
    #
    #
    #This block of code is the unfinished start of
    #informing the user when they change the
    #spelling of a keyword that is in use as a
    #reference header that its alphabetical position
    #might be altered. I thought this is important
    #information for keyword order number
    #changes, which can actually un-alphabetize
    #the order the reference group headers.
    #However, I thought such information would be
    #pointing-out-the-obvious when it comes to
    #spelling changes changing the alphabetical
    #position, and, so, stopped work on this code
    #and disabled it.
    Set Variable [ $$stoploadCitation; Value:1 ]
    // New Window [ Name: "CheckDuplicateRecordPosition"; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    // Go to Layout [ “ReferenceScriptLoops” (reference) ]
    // Enter Find Mode [ ]
    // Set Field [ tagKeywordPrimary::_Ltag; $$key ]
    // Perform Find [ ]
    // #
    // #If the edited record moved then note this.
    // If [ Get ( FoundCount ) ≠ 0 ]
    // Show Custom Dialog [ Message: "lkjlk"; Default Button: “OK”, Commit: “Yes” ]
    // End If
    // Close Window [ Current Window ]
    #
    End If
    Else If [ Get (LastError) ≠ 112 ]
    Commit Records/Requests
    #
    #
    #See if the edited record changed position in
    #the main reference window as a result of
    #alphabetical changing edits.
    Set Variable [ $$stoploadCitation; Value:1 ]
    Set Variable [ $currentrecord; Value:Get (RecordNumber) ]
    New Window [ Name: "CheckDuplicateRecordPosition"; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    If [ $$citationMatch = "key" and $$referenceSort = "" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagKeywordPrimary::orderOrLock; based on value list: “testPulldownListANDsortOrderList” tagKeywordPrimary::tag; ascending reference::publicationYearOrStuffOrderNumber; based on value list: “testPulldownListANDsortOrderList” reference::Title; ascending reference::thoughtsNotesEtc; ascending ] [ Restore; No dialog ]
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagKeywordPrimary::orderOrLock; based on value list: “order Pulldown List” tagKeywordPrimary::tag; ascending reference::referenceShort; ascending ] [ Restore; No dialog ]
    End If
    Else If [ $$citationMatch = "node" and $$referenceSort = "author" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: reference::sortByAuthor; ascending reference::referenceForReferenceWindow; ascending ] [ Restore; No dialog ]
    End If
    #
    #If the edited record move then note this.
    If [ $currentrecord ≠ Get (RecordNumber) ]
    Set Variable [ $recordMoved; Value:Get (RecordNumber) ]
    #
    #
    Else
    #This block of code is the unfinished start of
    #informing the user when they change the
    #spelling of a keyword that is in use as a
    #reference header that its alphabetical position
    #might be altered. I thought this is important
    #information for keyword order number
    #changes, which can actually un-alphabetize
    #the order the reference group headers.
    #However, I thought such information would be
    #pointing-out-the-obvious when it comes to
    #spelling changes changing the alphabetical
    #position, and, so, stopped work on this code
    #and disabled it.
    // Set Variable [ $$stoploadCitation; Value:1 ]
    // New Window [ Name: "CheckDuplicateRecordPosition"; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    // Go to Layout [ “ReferenceScriptLoops” (reference) ]
    // Enter Find Mode [ ]
    // Set Field [ tagKeywordPrimary::_Ltag; $$key ]
    // Perform Find [ ]
    // #
    // #If the edited record moved then note this.
    // If [ Get ( FoundCount ) ≠ 0 ]
    // Show Custom Dialog [ Message: "lkjlk"; Default Button: “OK”, Commit: “Yes” ]
    // Set Variable [ ]
    // End If
    // Close Window [ Current Window ]
    End If
    #
    Close Window [ Name: "CheckDuplicateRecordPosition"; Current file ]
    #
    #
    #Re-sort and return to edited record if it
    #was moved.
    If [ $recordMoved ≠ "" ]
    If [ $$citationMatch = "key" and $$referenceSort = "" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagKeywordPrimary::orderOrLock; based on value list: “testPulldownListANDsortOrderList” tagKeywordPrimary::tag; ascending reference::publicationYearOrStuffOrderNumber; based on value list: “testPulldownListANDsortOrderList” reference::Title; ascending reference::thoughtsNotesEtc; ascending ] [ Restore; No dialog ]
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagKeywordPrimary::orderOrLock; based on value list: “order Pulldown List” tagKeywordPrimary::tag; ascending reference::referenceShort; ascending ] [ Restore; No dialog ]
    End If
    Else If [ $$citationMatch = "node" and $$referenceSort = "author" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: reference::sortByAuthor; ascending reference::referenceForReferenceWindow; ascending ] [ Restore; No dialog ]
    End If
    Go to Record/Request/Page [ $recordMoved ] [ No dialog ]
    End If
    #
    #
    #
    End If
    #
    #Replace the old spelling with the new one.
    Select Window [ Name: "Tag Menus"; Current file ]
    Set Variable [ $oldSpelling; Value:tagMenus::tagSpelling ]
    Set Variable [ $$key; Value:tagMenus::_Ltag ]
    #
    #Update spelling of word in case of future changes
    Set Field [ tagMenus::tagSpelling; $newSpelling ]
    #
    #Replace in Reference table.
    #
    #Turn off reference load script.
    Set Variable [ $$stoploadCitation; Value:1 ]
    Go to Layout [ “Reference” (reference) ]
    #
    #Error notification needs to be turned off in case
    #a tag that has never been used has its spelling
    #changed, in which case this unused tag will
    #will not be found and give the user a notification
    #to that effect.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    Enter Find Mode [ ]
    If [ $$citationMatch = "key" ]
    Set Field [ reference::kkeywordOther; $$key & ¶ ]
    Else If [ $$citationMatch = "node" ]
    Set Field [ reference::knodeOther; $$key & ¶ ]
    End If
    Perform Find [ ]
    Loop
    #
    #Add comma to last item and before first item
    #in list for spelling changes script which has
    #to find words separated by commas.
    If [ $$citationMatch = "key" ]
    #
    #Replace changed spelling of other key words
    #but do not re-alphabatize.
    // Set Variable [ $tags; Value:reference::OtherKeyWords ]
    // Set Field [ reference::OtherKeyWords; ", ,, " & $tags & ", ,, " ]
    // Set Variable [ $tags; Value:reference::OtherKeyWords ]
    #
    #Replace changed spelling of other key words
    #and re-alphabatize.
    #
    #Create list of values.
    Set Variable [ $tags; Value:reference::OtherKeyWords ]
    Set Field [ reference::OtherKeyWords; Substitute ( $tags ; ", " ; "¶" ) ]
    Set Variable [ $tags; Value:reference::OtherKeyWords ]
    #
    #Transfer list from variable to temporary list of records.
    #This list will be used next to change the spelling
    #of only one item. If there are two or more items
    #in this list with the same spelling, these other
    #items will not be affected. The user after all
    #only changed the spellling of one tag, not all the
    #tags spelled the same way.
    Go to Layout [ “TEMPnodeList” (TEMP) ]
    Set Variable [ $numberOfNodes; Value:ValueCount ( $tags ) ]
    Delete All Records [ No dialog ]
    Loop
    Exit Loop If [ $numberOfNodes = 0 ]
    New Record/Request
    Set Field [ TEMP::tempListNode; GetValue ( $tags ; $numberOfNodes ) ]
    Set Variable [ $numberOfNodes; Value:$numberOfNodes - 1 ]
    End Loop
    #
    Else If [ $$citationMatch = "node" ]
    #
    #Create list of values.
    Set Variable [ $tags; Value:reference::NodeOthers ]
    Set Field [ reference::NodeOthers; Substitute ( $tags ; "; " ; "¶" ) ]
    Set Variable [ $tags; Value:reference::NodeOthers ]
    #
    #Transfer list from variable to temporary list of records.
    #This list will be used next to change the spelling
    #of only one item. If there are two or more items
    #in this list with the same spelling, these other
    #items will not be affected. The user after all
    #only changed the spellling of one tag, not all the
    #tags spelled the same way.
    Go to Layout [ “TEMPnodeList” (TEMP) ]
    Set Variable [ $numberOfNodes; Value:ValueCount ( $tags ) ]
    Delete All Records [ No dialog ]
    Loop
    Exit Loop If [ $numberOfNodes = 0 ]
    New Record/Request
    Set Field [ TEMP::tempListNode; GetValue ( $tags ; $numberOfNodes ) ]
    Set Variable [ $numberOfNodes; Value:$numberOfNodes - 1 ]
    End Loop
    End If
    #
    #Change spelling of only one tag.
    If [ $$citationMatch = "key" ]
    #
    #OLD
    // Set Field [ reference::OtherKeyWords; Substitute ( $tags ; ", " & $oldSpelling & ", " ; ", " & $newSpelling & ", " ) ]
    #
    #New
    #
    #Change spelling of one node. If two or more
    #nodes' spelling is identical leave others alone.
    #Reason: nodes can have same spelling and when
    #change spelling of one need to leave others alone
    #until user specfically changes their spelling too.
    Go to Record/Request/Page [ First ]
    Loop
    If [ TEMP::tempListNode = $oldSpelling ]
    Set Field [ TEMP::tempListNode; $newSpelling ]
    Set Variable [ $exit; Value:1 ]
    End If
    Exit Loop If [ $exit = 1 ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    Set Variable [ $exit ]
    #
    #Sort list alphabetically and recreate otherNode
    #field from list.
    Sort Records [ Keep records in sorted order; Specified Sort Order: TEMP::tempListNode; ascending ] [ Restore; No dialog ]
    Go to Record/Request/Page [ Last ]
    Set Variable [ $tags; Value:TEMP::tempListNode ]
    Loop
    Delete Record/Request [ No dialog ]
    Exit Loop If [ Get ( FoundCount ) = 0 ]
    Set Variable [ $list; Value:$tags ]
    Set Variable [ $tags; Value:TEMP::tempListNode & ", " & $list ]
    End Loop
    #
    #Now create one temp record. This is done because
    #the Setup window shows one temp record that
    #contains the current global default node, section, etc.
    #information. The system just deleted all temp
    #records, so unless one is now created, the user
    #will see a blank setup screen.
    New Record/Request
    #
    #Set the nodeOther field with new alphabetized list.
    Go to Layout [ “Reference” (reference) ]
    Set Field [ reference::OtherKeyWords; $tags ]
    #
    Else If [ $$citationMatch = "node" ]
    #
    #Change spelling of one node. If two or more
    #nodes' spelling is identical leave others alone.
    #Reason: nodes can have same spelling and when
    #change spelling of one need to leave others alone
    #until user specfically changes their spelling too.
    Go to Record/Request/Page [ First ]
    Loop
    If [ TEMP::tempListNode = $oldSpelling ]
    Set Field [ TEMP::tempListNode; $newSpelling ]
    Set Variable [ $exit; Value:1 ]
    End If
    Exit Loop If [ $exit = 1 ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    Set Variable [ $exit ]
    #
    #Sort list alphabetically and recreate otherNode
    #field from list.
    Sort Records [ Keep records in sorted order; Specified Sort Order: TEMP::tempListNode; ascending ] [ Restore; No dialog ]
    Go to Record/Request/Page [ Last ]
    Set Variable [ $tags; Value:TEMP::tempListNode ]
    Loop
    Delete Record/Request [ No dialog ]
    Exit Loop If [ Get ( FoundCount ) = 0 ]
    Set Variable [ $list; Value:$tags ]
    Set Variable [ $tags; Value:TEMP::tempListNode & "; " & $list ]
    End Loop
    #
    #Now create one temp record. This is done because
    #the Setup window shows one temp record that
    #contains the current global default node, section, etc.
    #information. The system just deleted all temp
    #records, so unless one is now created, the user
    #will see a blank setup screen.
    New Record/Request
    #
    #Set the nodeOther field with new alphabetized list.
    Go to Layout [ “Reference” (reference) ]
    Set Field [ reference::NodeOthers; $tags ]
    End If
    #
    #Remove comma from front and back of list so it
    #looks nice.
    If [ $$citationMatch = "key" ]
    Set Variable [ $otherKeys; Value:reference::OtherKeyWords ]
    Set Field [ reference::OtherKeyWords; Substitute ( $otherKeys ; ", ,, " ; "" ) ]
    End If
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Turn on reference load script.
    Set Variable [ $$stoploadCitation ]
    #
    #
    #Replace in TestLearn table, but turn off Learn
    #record load script before looping thru them.
    Set Variable [ $$stoploadCitation; Value:1 ]
    Go to Layout [ “learn4” (testlearn) ]
    #
    #Error notification needs to be turned off in case
    #a tag that has never been used has its spelling
    #changed, in which case this unused tag will
    #will not be found and give the user a notification
    #to that effect.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    Enter Find Mode [ ]
    If [ $$citationMatch = "key" ]
    Set Field [ testlearn::kcKeywordOther; $$key & ¶ ]
    Else If [ $$citationMatch = "node" ]
    Set Field [ testlearn::kNodeOther; $$key & ¶ ]
    End If
    Perform Find [ ]
    Loop
    #
    #Add comma to last item and before first item
    #in list for spelling changes script which has
    #to find words separated by commas.
    If [ $$citationMatch = "key" ]
    Set Variable [ $tags; Value:testlearn::OtherKeyWords ]
    Set Field [ testlearn::OtherKeyWords; ", ,, " & $tags & ", ,, " ]
    Set Variable [ $tags; Value:testlearn::OtherKeyWords ]
    Else If [ $$citationMatch = "node" ]
    #
    #Create list of values.
    Set Variable [ $tags; Value:testlearn::NodeOthers ]
    Set Field [ testlearn::NodeOthers; Substitute ( $tags ; "; " ; "¶" ) ]
    Set Variable [ $tags; Value:testlearn::NodeOthers ]
    #
    #Transfer list from variable to temporary list of records.
    #This list will be used next to change the spelling
    #of only one item. If there are two or more items
    #in this list with the same spelling, these other
    #items will not be affected. The user after all
    #only changed the spellling of one tag, not all the
    #tags spelled the same way.
    Go to Layout [ “TEMPnodeList” (TEMP) ]
    Set Variable [ $numberOfNodes; Value:ValueCount ( $tags ) ]
    Delete All Records [ No dialog ]
    Loop
    Exit Loop If [ $numberOfNodes = 0 ]
    New Record/Request
    Set Field [ TEMP::tempListNode; GetValue ( $tags ; $numberOfNodes ) ]
    Set Variable [ $numberOfNodes; Value:$numberOfNodes - 1 ]
    End Loop
    End If
    #
    #Change spelling.
    If [ $$citationMatch = "key" ]
    Set Field [ testlearn::OtherKeyWords; Substitute ( $tags ; ", " & $oldSpelling & ", " ; ", " & $newSpelling & ", " ) ]
    Else If [ $$citationMatch = "node" ]
    #
    #Change spelling of one node. If two or more
    #nodes spelling is identical leave others alone.
    #Reason: nodes can have same spelling and when
    #change spelling of one need to leave others alone
    #until user specfically changes their spelling too.
    Go to Record/Request/Page [ First ]
    Loop
    If [ TEMP::tempListNode = $oldSpelling ]
    Set Field [ TEMP::tempListNode; $newSpelling ]
    Set Variable [ $exit; Value:1 ]
    End If
    Exit Loop If [ $exit = 1 ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    Set Variable [ $exit ]
    #
    #Sort list alphabetically and recreate otherNode
    #field from list.
    Sort Records [ Keep records in sorted order; Specified Sort Order: TEMP::tempListNode; ascending ] [ Restore; No dialog ]
    Go to Record/Request/Page [ Last ]
    Set Variable [ $tags; Value:TEMP::tempListNode ]
    Loop
    Delete Record/Request [ No dialog ]
    Exit Loop If [ Get ( FoundCount ) = 0 ]
    Set Variable [ $list; Value:$tags ]
    Set Variable [ $tags; Value:TEMP::tempListNode & "; " & $list ]
    End Loop
    #
    #Now create one temp record. This is done because
    #the Setup window shows one temp record that
    #contains the current global default node, section, etc.
    #information. The system just deleted all temp
    #records, so unless one is now created, the user
    #will see a blank setup screen.
    New Record/Request
    #
    #Set the nodeOther field with new alphabetized list.
    Go to Layout [ “learn4” (testlearn) ]
    Set Field [ testlearn::NodeOthers; $tags ]
    End If
    #
    #Remove comma from front and back of list so it
    #looks nice.
    If [ $$citationMatch = "key" ]
    Set Variable [ $otherKeys; Value:testlearn::OtherKeyWords ]
    Set Field [ testlearn::OtherKeyWords; Substitute ( $otherKeys ; ", ,, " ; "" ) ]
    End If
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Prevent halting in loadTagRecord script.
    Set Variable [ $$doNotHaltOtherScripts; Value:1 ]
    Go to Layout [ original layout ]
    Set Variable [ $$doNotHaltOtherScripts ]
    #
    #Turn back on Learn record load script.
    Set Variable [ $$stoploadCitation ]
    #
    #
    #Decided not to re-alaphabetize list as would
    #bog down system. User can do so by taking item
    #away and adding it back using the O button on
    #the Tag Menus window.
    // #Set record number so can return user to it when done.
    // Set Variable [ $recordNumber; Value:Get (RecordNumber) ]
    // #Now re-alphabetize and add new keyword to citation.
    // Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenus::tag; ascending ] [ Restore; No dialog ]
    // Go to Record/Request/Page [ First ]
    // Select Window [ Name: "References"; Current file ]
    // If [ Get (LastError) = 112 ]
    // Select Window [ Name: "Learn"; Current file ]
    // Set Variable [ $otherKeys; Value:testlearn::OtherKeyWords ]
    // Else If [ Get (LastError) ≠ 112 ]
    // Set Variable [ $otherKeys; Value:reference::OtherKeyWords ]
    // End If
    // #
    // #Find and set first value in keyword list.
    // #It will not have a comma in front like the other items.
    // Select Window [ Name: "Tag Menus"; Current file ]
    // Loop
    // If [ tagMenus::_Ltag & "¶" = FilterValues ( $$key ; tagMenus::_Ltag & "¶" ) ]
    // Set Variable [ $newKey; Value:tagMenus::tag ]
    // #
    // Select Window [ Name: "References"; Current file ]
    // If [ Get (LastError) = 112 ]
    // Select Window [ Name: "Learn"; Current file ]
    // Set Field [ testlearn::OtherKeyWords; $newKey ]
    // Set Variable [ $otherKeys; Value:testlearn::OtherKeyWords ]
    // Else If [ Get (LastError) ≠ 112 ]
    // Set Field [ reference::OtherKeyWords; $newKey ]
    // Set Variable [ $otherKeys; Value:reference::OtherKeyWords ]
    // End If
    // End If
    // #
    // Select Window [ Name: "Tag Menus"; Current file ]
    // Exit Loop If [ tagMenus::_Ltag & "¶" = FilterValues ( $$key ; tagMenus::_Ltag & "¶" ) ]
    // Go to Record/Request/Page [ Next; Exit after last ]
    // End Loop
    // #
    // #Now add remaining keywords to list.
    // Go to Record/Request/Page [ Next; Exit after last ]
    // Loop
    // If [ tagMenus::_Ltag & "¶" = FilterValues ( $$key ; tagMenus::_Ltag & "¶" ) ]
    // Set Variable [ $newKey; Value:tagMenus::tag ]
    // #
    Select Window [ Name: "References"; Current file ]
    // If [ Get (LastError) = 112 ]
    // Select Window [ Name: "Learn"; Current file ]
    // Set Field [ testlearn::OtherKeyWords; $otherKeys & ", " & $newKey ]
    // Set Variable [ $otherKeys; Value:testlearn::OtherKeyWords ]
    // Else If [ Get (LastError) ≠ 112 ]
    // Set Field [ reference::OtherKeyWords; $otherKeys & ", " & $newKey ]
    // Set Variable [ $otherKeys; Value:reference::OtherKeyWords ]
    // End If
    // End If
    // #
    // Select Window [ Name: "Tag Menus"; Current file ]
    // Go to Record/Request/Page [ Next; Exit after last ]
    // End Loop
    #
    #Not sure why this update fails at this point.
    #The variable is correct, but the field fails to take
    #it, so I moved this step up to right after old
    #spelling variable is created from tagSpelling field.
    // #Update spelling of word in case of future changes
    // #to its spelling that would then trigger the first
    // #part of this scirpt to udpate the spelling in the
    // #tag list.
    // Go to Record/Request/Page [ $recordNumber ] [ No dialog ]
    // Set Field [ tagMenus::tagSpelling; $newSpelling ]
    #
    #Return to Tag Menus window and sort records
    #according to users wishes.
    Select Window [ Name: "Tag Menus"; Current file ]
    If [ $$citationMatch = "key" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::tag; ascending ] [ Restore; No dialog ]
    End If
    Set Variable [ $$stoploadCitation ]
    #
    #Reset $$key variable.
    Set Variable [ $$Key; Value:$RememberKey ]
    #
    End If
    #
    #END B - Complete spelling change or adding of new tag.
    #
    #

Fields used in this script

    tagMenus::_Ltag
    tagMenus::tagSpelling
    tagMenus::tag
    TEMP::kdefaultNodePrimary
    TEMP::DEFAULTNodePrimaryName
    TEMP::kdefaultNodeTestSubject
    TEMP::DEFAULTNodeTestSubjectName
    TEMP::kdefaultNodeOther
    TEMP::userLibraryName
    tagMenus::match
    <Missing Field>
    tagKeywordPrimary::_Ltag
    TEMP::InventoryLibraryYN
    tagKeywordPrimary::orderOrLock
    tagKeywordPrimary::tag
    reference::publicationYearOrStuffOrderNumber
    reference::Title
    reference::thoughtsNotesEtc
    reference::referenceShort
    reference::sortByAuthor
    reference::referenceForReferenceWindow
    reference::kkeywordOther
    reference::knodeOther
    reference::OtherKeyWords
    TEMP::tempListNode
    reference::NodeOthers
    testlearn::kcKeywordOther
    testlearn::kNodeOther
    testlearn::OtherKeyWords
    testlearn::NodeOthers
    tagMenuGroup::orderOrLibraryType
    tagMenuGroup::name
    tagMenus::orderOrLock

Scripts used in this script

    CHUNK_checkForDraggedPasteChanges
    removeTextFormattingAndCommas
    checkKeyANDNodeTagNames

Layouts used in this script

    ReferenceScriptLoops
    Reference
    TEMPnodeList
    learn4

Tables used in this script

    TEMP
    reference
    tag
    tagGroup
    testlearn

Table occurrences used by this script

    TEMP
    reference
    tagKeywordPrimary
    tagMenuGroup
    tagMenus
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [checkKeyANDNodeTagNames]	Parent Folder: [tagMenu]	Next Script: [checkSpellingOfCPPPTags]
Script Name	checkORaddTestItem
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    reportTagItem

Scripts that use this script

    testItemCheckButton
    testItemTextButton

Script Definition
Script Steps

    #
    #
    #
    #If check button was clicked and this is a text
    #item, then go to the text field.
    If [ $$checkButton ≠ "" and tagMenus::notesOrCopyright = "T" or $$checkButton ≠ "" and tagMenus::notesOrCopyright = "FT" ]
    Set Variable [ $$checkButton ]
    Go to Field [ tagMenus::tagLocked ]
    Exit Script [ ]
    Else
    Set Variable [ $$checkButton ]
    End If
    #
    #
    #
    #If text button was clicked and this is a check
    #item, then go to the text field.
    If [ $$textButton ≠ "" and tagMenus::notesOrCopyright ≠ "T" and tagMenus::notesOrCopyright ≠ "FT" ]
    Set Variable [ $$textButton ]
    Go to Field [ tagMenus::tagLocked ]
    Exit Script [ ]
    Else
    Set Variable [ $$textButton ]
    End If
    #
    #
    #
    #On the test-item layout, set this stop check
    #or text variable to allows the user to click into
    #this field for the purpose of navigating to a
    #new record without changing the check or
    #text mark status.
    If [ $$stopCheckOrTest = 1 ]
    Set Variable [ $$stopCheckOrTest ]
    Exit Script [ ]
    End If
    #
    #
    #
    #Stop this script if any of the following are true:
    #
    #Test subject is locked.
    If [ $$testSubjectIsLocked ≠ "" and Get ( LayoutName ) ≠ "defaultTest" and Get ( LayoutName ) ≠ "learnTest" ]
    Show Custom Dialog [ Message: "The test subject — " & $$testSubjectIsLocked & " — is locked. To unlock, A) go back to the setup node tag menu. B) Select this test subject. C) Click 'lock' and enter the password."; Default Button: “OK”, Commit: “No” ]
    Set Variable [ $exit; Value:1 ]
    End If
    #
    #Primary node is locked.
    If [ TEMP::primaryNodeIsLocked ≠ "" ]
    If [ $exit = "" ]
    Show Custom Dialog [ Message: "The default primary node — " & TEMP::DEFAULTNodePrimaryName & " — is locked. Go to the Default Node Tag Menu and A) click 'lock' to unlock it, B) select an unlocked node for the primary node, or C) create a new primary node."; Default Button: “OK”, Commit: “No” ]
    Else
    Show Custom Dialog [ Message: "ALSO, the default primary node — " & TEMP::DEFAULTNodePrimaryName & " — is locked. Go to the Default Node Tag Menu and A) click 'lock' to unlock it, B) select an unlocked node for the primary node, or C) create a new primary node."; Default Button: “OK”, Commit: “No” ]
    End If
    Set Variable [ $exit; Value:1 ]
    End If
    #
    #If any of the above are true, then
    #exit this script.
    If [ $exit = 1 ]
    Exit Script [ ]
    End If
    #
    #
    #
    #Admin tags.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    Go to Field [ ]
    #
    #
    #
    #
    #
    #BEGIN Text Item
    #
    #
    #
    #
    #
    #If a text T item is selected then the user wants to
    #add the text of the test item to the note field.
    #
    #Add text T item to the selected field
    #or note field.
    If [ tagMenus::notesOrCopyright = "T" or tagMenus::notesOrCopyright = "FT" or Left (Get ( LayoutName ) ; 6 ) = "report" ]
    #
    #
    #Format text to be inserted.
    #
    #IMPORTANT: Leave the order of the variables
    #abelow as is! Changes to the order result in
    #formatting failures!!!
    If [ tagMenus::textStyleOrCreatorNodeFlag = "" or tagMenus::textStyleOrCreatorNodeFlag ≠ 1 and tagMenus::textStyleOrCreatorNodeFlag ≠ 2 and tagMenus::textStyleOrCreatorNodeFlag ≠ 3 ]
    Set Variable [ $tag; Value:TextFont ( tagMenus::tag ; "Georgia" ) ]
    Set Variable [ $tag; Value:TextColor ( $tag ; RGB ( 34 ; 34 ; 34 ) ) ]
    Set Variable [ $tag; Value:TextSize ( $tag ; 16 ) ]
    Set Variable [ $tag; Value:TextStyleAdd ( $tag ; Plain ) ]
    Else If [ tagMenus::textStyleOrCreatorNodeFlag = "1" ]
    Set Variable [ $tag; Value:TextFont ( tagMenus::tag ; "Georgia" ) ]
    Set Field [ tagMenus::tag; TextColor ( tagMenus::tag ; RGB ( 99 ; 99 ; 99 ) ) ]
    Set Variable [ $tag; Value:TextSize ( $tag ; 16 ) ]
    Set Variable [ $tag; Value:TextStyleAdd ( $tag ; Plain ) ]
    Else If [ tagMenus::textStyleOrCreatorNodeFlag = "2" ]
    Set Variable [ $tag; Value:TextFont ( tagMenus::tag ; "Arial" ) ]
    Set Variable [ $tag; Value:TextColor ( $tag ; RGB ( 34 ; 34 ; 34 ) ) ]
    Set Variable [ $tag; Value:TextSize ( $tag ; 16 ) ]
    Set Variable [ $tag; Value:TextStyleAdd ( $tag ; Plain ) ]
    Else If [ tagMenus::textStyleOrCreatorNodeFlag = "3" ]
    Set Variable [ $tag; Value:TextFont ( tagMenus::tag ; "Arial" ) ]
    Set Field [ tagMenus::tag; TextColor ( tagMenus::tag ; RGB ( 99 ; 99 ; 99 ) ) ]
    Set Variable [ $tag; Value:TextSize ( $tag ; 20 ) ]
    Set Variable [ $tag; Value:TextStyleAdd ( $tag ; Bold ) ]
    End If
    #
    #Create a clear formatting variable to insure
    #anything typed after the newly inserted text
    #will be in the default format.
    Set Variable [ $clearFormatting; Value:TextFont ( " " ; "Georgia" ) ]
    Set Variable [ $clearFormatting; Value:TextColor ( $clearFormatting ; RGB ( 34 ; 34 ; 34 ) ) ]
    Set Variable [ $clearFormatting; Value:TextSize ( $clearFormatting ; 16 ) ]
    Set Variable [ $clearFormatting; Value:TextStyleAdd ( $clearFormatting ; Plain ) ]
    #
    #
    #See if the user in the test section
    #or report section of the library.
    Select Window [ Name: "Test"; Current file ]
    If [ Get ( LastError )= 112 ]
    Select Window [ Name: "Report"; Current file ]
    Set Variable [ $note; Value:report::note ]
    Else
    Set Variable [ $note; Value:testlearn::note ]
    End If
    #
    #If the user is not in a field, then add the text
    #to the note field.
    If [ Get ( ActiveFieldName ) = "" ]
    #
    #If there is nothing in the field, then enter
    #the new text at the top of the field.
    If [ $note = "" ]
    #There is a bug in FMGO16 where the format of
    #the first character defines the format for the
    #textbox. The only way around this is to put in
    #several blank lines between to default
    #formatted spaces, and then enter new text on
    #one of these lines.
    Set Field [ testlearn::note; $tag & $clearFormatting & ¶ & ¶ & ¶ & ¶ & ¶ & ¶ & ¶ & ¶ & ¶ & ¶ & ¶ & ¶ & $clearFormatting ]
    Set Field [ report::note; $tag & $clearFormatting & ¶ & ¶ & ¶ & ¶ & ¶ & ¶ & ¶ & ¶ & ¶ & ¶ & ¶ & ¶ & $clearFormatting ]
    #
    #
    Else
    #If there is text in the field, it is possible any
    #new text will be inserted out of sight, unless
    #the field is entered and then scrolled to
    #the bottom.
    #
    #SO, first enter the field and insert the current
    #contents to activate it, which will then allow for
    #the insert command, next.
    If [ Get (LayoutTableName) = "testlearn" ]
    Go to Field [ testlearn::note ]
    Set Field [ testlearn::note; $note & $clearFormatting ]
    Else
    Go to Field [ report::note ]
    Set Field [ report::note; $note & $clearFormatting ]
    End If
    #
    #Insert the new T item, and the field will
    #scroll to the bottom and insert the item
    #allowing the user to see the insert.
    Insert Calculated Result [ ¶ & $tag & $clearFormatting & ¶ & ¶ & ¶ & ¶ & ¶ & ¶ & ¶ & ¶ & ¶ & ¶ & ¶ & ¶ & $clearFormatting ]
    End If
    #
    #
    #If the field is active then insert the text block.
    Else If [ Get ( ActiveFieldName ) ≠ "" ]
    If [ Get ( ActiveFieldContents ) = "" ]
    #There is a bug in FMGO16 where the format of
    #the first character defines the format for the
    #textbox. The only way around this is to put in
    #several blank lines between to default
    #formatted spaces, and then enter new text on
    #one of these lines.
    Set Field [ testlearn::note; $tag & $clearFormatting & ¶ & ¶ & ¶ & ¶ & ¶ & ¶ & ¶ & ¶ & ¶ & ¶ & ¶ & ¶ & $clearFormatting ]
    Else
    Insert Calculated Result [ $tag & $clearFormatting ]
    End If
    End If
    #
    #
    Exit Script [ ]
    End If
    #
    #
    #
    #
    #
    #END Text Item
    #
    #
    #
    #
    #
    #BEGIN Check Item
    #
    #
    #
    #
    #
    #If check is selected then the user wants
    #this tag's key added or removed from
    #the test result.
    #
    #Get key for tag that is to be added or removed.
    Set Variable [ $tag; Value:tagMenus::_Ltag ]
    #
    #Go the Test window.
    Select Window [ Name: "Test"; Current file ]
    #
    #First, see if the test item has already
    #been added.
    #
    #Set the number variable to 1, so the loop
    #below will check the first key in the test
    #result's test-item keychain, and the proceed to
    #check all the rest for the currently selecte item.
    Set Variable [ $number; Value:1 ]
    Loop
    #
    #If the item's tag is found in this keychain,
    #then remove it.
    If [ FilterValues ( GetValue ( testlearn::kctestResultCheckedItems ; $number ) ; $tag & "¶" ) = $tag & ¶ ]
    Set Field [ testlearn::kctestResultCheckedItems; Substitute ( $$checkedTestItem ; GetValue ( testlearn::kctestResultCheckedItems ; $number ) & "¶" ; "" ) ]
    #
    #Reset this result's test-item keychain variable.
    Set Variable [ $$checkedTestItem; Value:testlearn::kctestResultCheckedItems ]
    #
    #Set the number variable to 'found' which
    #will stop this loop.
    Set Variable [ $number; Value:"found" ]
    End If
    #
    #If number variable was set to exit or if no keys
    #exist, then exit this loop.
    Exit Loop If [ GetValue ( testlearn::kctestResultCheckedItems ; $number ) = "" or $number = "found" ]
    #
    #If variable looked at did not match the selected
    #item's key then raise the number variable by 1
    #to look at the next item key in this result's
    #keychain.
    Set Variable [ $add; Value:$number ]
    Set Variable [ $number; Value:$add + 1 ]
    End Loop
    #
    #
    #If this item's key was not found in the
    #keychain-loop check above, then proceed
    #to add it to this result's test-item keychain.
    If [ $number ≠ "found" ]
    Set Field [ testlearn::kctestResultCheckedItems; $tag & ¶ & $$checkedTestItem ]
    #
    #Reset this result's test-item keychain variable.
    Set Variable [ $$checkedTestItem; Value:testlearn::kctestResultCheckedItems ]
    End If
    #
    #
    #Return to the Tag Menus window and
    #update the conditional formatting
    #of the now unchecked
    #or checked item.
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    Go to Field [ ]
    #
    #
    #END Check item
    #
    #

Fields used in this script

    tagMenus::notesOrCopyright
    tagMenus::tagLocked
    TEMP::primaryNodeIsLocked
    TEMP::DEFAULTNodePrimaryName
    tagMenus::textStyleOrCreatorNodeFlag
    tagMenus::tag
    report::note
    testlearn::note
    tagMenus::_Ltag
    testlearn::kctestResultCheckedItems

Scripts used in this script

Layouts used in this script

Tables used in this script

    TEMP
    report
    tag
    testlearn

Table occurrences used by this script

    TEMP
    report
    tagMenus
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [checkORaddTestItem]	Parent Folder: [tagMenu]	Next Script: [checkTagGroupNamesEXCEPTtestItemGroups]
Script Name	checkSpellingOfCPPPTags
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #This script used to do what the disabled comment
    #below says. But then I realized it was great
    #at backing up spelling of entered tags and
    #stopping user from changing spelling of
    #locked tags, SO I repuprosed it to do just
    #that for copyright (well no longer for those,
    #cause user cannot get to an edit layout when
    #they are locked), publication, publisher,
    #and path tags.
    // #Insure accidental running of spelling script
    // #will not erase path name. FYI: In normal
    // #operation this will not happen, but when
    // #coding it is possible to stop a script and then
    // #trigger the replace spelling script, which if
    // #this field is blank will replace the path with a
    // #blank = delete the path.
    #
    #IMPORTANT!!! Do not lock out user's ability
    #to change path tags. These are unique to
    #each user's computer, and so to enable
    #better sharing, the path tags need to
    #remain editable.
    If [ tagCreatorLock::orderOrLock ≠ "" and $$citationMatch ≠ "path" ]
    Set Field [ tagMenus::tag; tagMenus::tagSpelling ]
    Else If [ tagCreatorLock::orderOrLock = "" or $$citationMatch = "path" ]
    Set Field [ tagMenus::tagSpelling; tagMenus::tag ]
    End If

Fields used in this script

    tagCreatorLock::orderOrLock
    tagMenus::tagSpelling
    tagMenus::tag

Scripts used in this script

Layouts used in this script

Tables used in this script

    tag
    tag

Table occurrences used by this script

    tagCreatorLock
    tagMenus

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [checkSpellingOfCPPPTags]	Parent Folder: [tagMenu]	Next Script: [checkTestItemGroupNames]
Script Name	checkTagGroupNamesEXCEPTtestItemGroups
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    closeWindow
    checkTagGroupNamesEXCEPTtestItemGroups

Script Definition
Script Steps

    #
    #Stop script to speed up other scripts.
    If [ $$stopChangeSpellingOfTagCategory ≠ "" ]
    Set Variable [ $$stopChangeSpellingOfTagCategory ]
    Exit Script [ ]
    End If
    #
    #Copyright locked group name? Change back.
    If [ tagMenuGroup::name ≠ tagMenuGroup::nameSpellingEXCEPTForTestItemGroup and tagMenuGroup::orderOrLibraryType ≠ "" and tagMenuGroup::match = "copyright" or tagMenuGroup::name ≠ tagMenuGroup::nameSpellingEXCEPTForTestItemGroup and Get (ActiveFieldName) ≠ "name" and tagMenuGroup::match = "copyright" ]
    Set Field [ tagMenuGroup::name; tagMenuGroup::nameSpellingEXCEPTForTestItemGroup ]
    If [ Get (ActiveFieldName) = "name" ]
    Show Custom Dialog [ Message: "Group name locked by system admin. "; Default Button: “OK”, Commit: “Yes” ]
    End If
    Exit Script [ ]
    End If
    #
    #First turn back any spelling changes made by dragging
    #text into field.
    If [ $$citationMatch ≠ "copyright" ]
    Set Variable [ $$tag; Value:tagMenuGroup::_Lgroup ]
    Perform Script [ “CHUNK_checkForDraggedPasteChanges” ]
    Set Variable [ $$tag ]
    End If
    #
    #If node is currenlty locked then stop script, inform user.
    If [ nodeLockTagGroupCreatorLock::orderOrLock ≠ "" ]
    Set Field [ tagMenuGroup::name; tagMenuGroup::nameSpellingEXCEPTForTestItemGroup ]
    Go to Field [ ]
    If [ $$citationMatch ≠ "copyright" ]
    Show Custom Dialog [ Message: "The node that created this — " & nodeLockTagGroupCreatorLock::tag & " — is locked. Select this node in the setup window and enter the password to unlock it, then you will able to edit records assigned to it."; Default Button: “OK”, Commit: “Yes” ]
    End If
    Exit Script [ ]
    End If
    #
    #If user approved spelling for this tag and no
    #changes have been made then cancel the script.
    If [ tagMenuGroup::name = tagMenuGroup::nameSpellingEXCEPTForTestItemGroup ]
    Exit Script [ ]
    End If
    #
    #Commit changes to the spellling.
    Commit Records/Requests
    Set Variable [ $newSpelling; Value:tagMenuGroup::name ]
    #
    #Check if a tag with this spelling already exists
    #in the library. Stop error capture in case spelling
    #is unique and thus no records will be found.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    New Window [ Height: 1; Width: 1; Top: -10000; Left: -10000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “tableTagGroup” (testSubsectionGroup) ]
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    #
    Enter Find Mode [ ]
    Set Field [ testSubsectionGroup::name; "==" & $newSpelling ]
    Set Field [ testSubsectionGroup::match; $$citationMatch ]
    Perform Find [ ]
    Set Variable [ $$stopLoadTagRecord ]
    #
    #If a duplicate is found...
    If [ Get (FoundCount) > 1 ]
    #
    #Ask question.
    Close Window [ Current Window ]
    Set Field [ tagMenuGroup::name; tagMenuGroup::nameSpellingEXCEPTForTestItemGroup ]
    Show Custom Dialog [ Message: "The '" & $newSpelling & "' group already exists. Except for test-item groups, all other groups must have unique names. Type a different name or cancel this change."; Default Button: “OK”, Commit: “Yes”; Button 2: “cancel”, Commit: “No”; Input #1: tagMenuGroup::name ]
    #
    #Choice 1, user wants to change
    #duplicate's spelling.
    If [ Get ( LastMessageChoice ) = 1 ]
    Commit Records/Requests
    #
    #If change was made to a new tag check
    #if spelling is already in use.
    Set Variable [ $newSpelling; Value:tagMenus::tag ]
    Perform Script [ “checkTagGroupNamesEXCEPTtestItemGroups” ]
    #
    #Exit script, otherwise main and tag
    #menu windows will be closed.
    Exit Script [ ]
    #
    #Choice 2 ...
    Else If [ Get ( LastMessageChoice ) = 2 ]
    #Exit script as no changes are being made,
    #and to prevent the tag menus window
    #being closed.
    Exit Script [ ]
    End If
    End If
    #
    #If the spellling of the tag has changed or if new tag
    #update spelling of word in case of future changes
    #to its spelling that would then trigger the first
    #part of this scirpt to udpate the spelling in the
    #tag list.
    Close Window [ Current Window ]
    #
    #All tests pasted? Accept user's change.
    If [ $$citationMatch = "testItem" ]
    Set Field [ tagMenuGroup::nameSpellingFORTestItemGroup; $newSpelling ]
    Else
    Set Field [ tagMenuGroup::nameSpellingEXCEPTForTestItemGroup; $newSpelling ]
    End If
    #
    #

Fields used in this script

    tagMenuGroup::name
    tagMenuGroup::nameSpellingEXCEPTForTestItemGroup
    tagMenuGroup::orderOrLibraryType
    tagMenuGroup::match
    tagMenuGroup::_Lgroup
    nodeLockTagGroupCreatorLock::orderOrLock
    nodeLockTagGroupCreatorLock::tag
    testSubsectionGroup::name
    testSubsectionGroup::match
    <Missing Field>
    tagMenus::tag
    tagMenuGroup::nameSpellingFORTestItemGroup

Scripts used in this script

    CHUNK_checkForDraggedPasteChanges
    checkTagGroupNamesEXCEPTtestItemGroups

Layouts used in this script

    tableTagGroup

Tables used in this script

    tag
    tagGroup

Table occurrences used by this script

    nodeLockTagGroupCreatorLock
    tagMenuGroup
    tagMenus
    testSubsectionGroup

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [checkTagGroupNamesEXCEPTtestItemGroups]	Parent Folder: [tagMenu]	Next Script: [checkTestSectionSubsectionAndItemRecordSpellings]
Script Name	checkTestItemGroupNames
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    checkTestItemGroupNames

Script Definition
Script Steps

    #
    #If user approved spelling for this tag and no
    #changes have been made then cancel the script.
    If [ tagMenuTestItemGroup::name = tagMenuTestItemGroup::nameSpellingFORTestItemGroup ]
    Perform Script [ “CHUNK_checkForDraggedPasteChanges” ]
    Exit Script [ ]
    End If
    #
    #changes have been made then cancel the script.
    If [ nodeLockTestTagItemGroup::orderOrLock ≠ "" ]
    Set Field [ tagMenuTestItemGroup::name; tagMenuTestItemGroup::nameSpellingFORTestItemGroup ]
    Perform Script [ “CHUNK_checkForDraggedPasteChanges” ]
    Exit Script [ ]
    End If
    #
    #Commit changes to the spellling.
    Commit Records/Requests
    Set Variable [ $newSpelling; Value:tagMenuTestItemGroup::name ]
    #
    #Check if a tag with this spelling already exists
    #in the library.
    New Window [ Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “tableTagGroup” (testSubsectionGroup) ]
    #
    Enter Find Mode [ ]
    Set Field [ testSubsectionGroup::name; "==" & $newSpelling ]
    Set Field [ testSubsectionGroup::nameSpellingEXCEPTForTestItemGroup; "testItemGroup" ]
    Perform Find [ ]
    Set Variable [ $foundCount; Value:Get (FoundCount) ]
    Close Window [ Current Window ]
    #
    If [ $foundCount > 1 ]
    #Ask question.
    Show Custom Dialog [ Message: "Click OK to approve the duplicate group spelling below. NOTE: When clicking the link button, you will see " & $foundCount & " groups with this same name. To modify this group's name, make changes below, and click change."; Default Button: “change”, Commit: “Yes”; Button 2: “OK”, Commit: “No”; Button 3: “cancel”, Commit: “No”; Input #1: tagMenuTestItemGroup::name ]
    #
    #
    #Choice 1, user wants to change spelling.
    If [ Get ( LastMessageChoice ) = 1 ]
    Set Variable [ $newSpelling ]
    Perform Script [ “checkTestItemGroupNames” ]
    Exit Script [ ]
    Else If [ Get ( LastMessageChoice ) = 3 ]
    Set Field [ tagMenuTestItemGroup::name; tagMenuTestItemGroup::nameSpellingFORTestItemGroup ]
    Perform Script [ “CHUNK_checkForDraggedPasteChanges” ]
    Exit Script [ ]
    End If
    End If
    #
    #If the spellling of the tag has changed or if new tag
    #update spelling of word in case of future changes
    #to its spelling that would then trigger the first
    #part of this scirpt to udpate the spelling in the
    #tag list.
    Set Field [ tagMenuTestItemGroup::nameSpellingFORTestItemGroup; $newSpelling ]
    #
    Perform Script [ “CHUNK_checkForDraggedPasteChanges” ]
    #

Fields used in this script

    tagMenuTestItemGroup::name
    tagMenuTestItemGroup::nameSpellingFORTestItemGroup
    nodeLockTestTagItemGroup::orderOrLock
    testSubsectionGroup::name
    testSubsectionGroup::nameSpellingEXCEPTForTestItemGroup
    <Missing Field>

Scripts used in this script

    CHUNK_checkForDraggedPasteChanges
    checkTestItemGroupNames

Layouts used in this script

    tableTagGroup

Tables used in this script

    tag
    tagGroup

Table occurrences used by this script

    nodeLockTestTagItemGroup
    tagMenuTestItemGroup
    testSubsectionGroup

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [checkTestItemGroupNames]	Parent Folder: [tagMenu]	Next Script: [CHUNK_addLinkToTag]
Script Name	checkTestSectionSubsectionAndItemRecordSpellings
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    backFromTemplateEditor
    menuTestSection
    testTemplatesItemButton

Script Definition
Script Steps

    #
    #
    #Stop this script if any of the following
    #are true.
    If [ $$stopTest = 1 or $$userClickedVButton ≠ "" ]
    Exit Script [ ]
    End If
    #
    #
    #BEGIN Tag menus layout check
    #
    #
    If [ Get (LayoutTableName) = "tagMenus" ]
    #
    If [ $$tag = "" ]
    Set Variable [ $otherTypeOfTag; Value:tagMenus::_Ltag ]
    End If
    #
    #Exit any fields so do not get can't modify error message
    #because record is in use in another window.
    Go to Field [ ]
    #
    #Speed up script by stopping record load script.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Set Variable [ $$stopTest; Value:1 ]
    #
    #New window so user's window is not changed.
    New Window [ Height: 1; Width: 1; Top: -1000; Left: -1000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    // New Window [ Top: 1; Left: 1; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    #
    #Loop thru all records and make sure their spelling
    #has not been changed, and if it has then change it back
    #to the way it was, unless the change was made in the
    #field the user was just working on.
    Go to Record/Request/Page [ First ]
    Loop
    #Test item group name.
    If [ tagMenuTestItemGroup::name ≠ tagMenuTestItemGroup::nameSpellingFORTestItemGroup and tagMenuTestItemGroup::nameSpellingEXCEPTForTestItemGroup = "testItemGroup" ]
    Set Field [ tagMenuTestItemGroup::name; tagMenuTestItemGroup::nameSpellingFORTestItemGroup ]
    End If
    #Brainstorm, copyright, node, key, publisher, publication, testItem locked group name.
    If [ $$tag ≠ "" and $$tag ≠ tagMenuGroup::_Lgroup and tagMenuGroup::name ≠ tagMenuGroup::nameSpellingEXCEPTForTestItemGroup ]
    Set Field [ tagMenuGroup::name; tagMenuGroup::nameSpellingEXCEPTForTestItemGroup ]
    End If
    #Brainstorm, copyright, node, key, publisher, publication, testItem tag names.
    If [ $$tag ≠ "" and $$tag ≠ tagMenus::_Ltag or $$tag = "" and $otherTypeOfTag ≠ tagMenus::_Ltag or tagCreatorLock::orderOrLock ≠ "" ]
    If [ tagMenus::tag ≠ tagMenus::tagSpelling and tagMenus::match = "testItem" or tagMenus::tag ≠ tagMenus::tagSpelling and tagMenus::match = "brainstorm" or tagMenus::tag ≠ tagMenus::tagSpelling and tagMenus::match = "copyright" or tagMenus::tag ≠ tagMenus::tagSpelling and tagMenus::match = "publication" or tagMenus::tag ≠ tagMenus::tagSpelling and tagMenus::match = "node" or tagMenus::tag ≠ tagMenus::tagSpelling and tagMenus::match = "publisher" or tagMenus::tag ≠ tagMenus::tagSpelling and tagMenus::match = "key" ]
    Set Field [ tagMenus::tag; tagMenus::tagSpelling ]
    End If
    End If
    #Locked by system copyright tags.
    If [ tagMenus::orderOrLock ≠ "" and tagMenus::match = "copyright" ]
    Set Field [ tagMenus::tag; tagMenus::tagSpelling ]
    End If
    #
    #
    #
    #
    #But if node is not locked and this is the tag
    #the user just updated, then apply changes
    #to tag.
    #Group name.
    If [ $$tag ≠ "" and $$tag = tagMenuGroup::_Lgroup and tagMenuGroup::name ≠ tagMenuGroup::nameSpellingFORTestItemGroup and Get (LayoutTableName) = "testSubsection" and tagCreatorLock::orderOrLock = "" and tagMenuGroup::match = "testSubsection" ]
    Set Field [ tagMenuGroup::nameSpellingFORTestItemGroup; tagMenuGroup::name ]
    End If
    #Test item group name.
    If [ $$tag ≠ "" and $$tag = tagMenuTestItemGroup::_Lgroup and tagMenuTestItemGroup::name ≠ tagMenuTestItemGroup::nameSpellingFORTestItemGroup and Get (LayoutTableName) ≠ "subsectionFromTemplate" and tagMenuTestItemGroup::nameSpellingEXCEPTForTestItemGroup = "testItemGroup" ]
    If [ $$citationMatch = "testItem" ]
    Set Field [ tagMenuTestItemGroup::nameSpellingFORTestItemGroup; tagMenuTestItemGroup::name ]
    End If
    End If
    #Brainstorm group name.
    If [ $$tag ≠ "" and $$tag = tagMenuGroup::_Lgroup and tagMenuGroup::name ≠ tagMenuGroup::nameSpellingEXCEPTForTestItemGroup and tagMenuTestItemGroup::nameSpellingEXCEPTForTestItemGroup ≠ "testItemGroup" ]
    If [ $$citationMatch ≠ "testItem" ]
    Set Field [ tagMenuGroup::nameSpellingEXCEPTForTestItemGroup; tagMenuGroup::name ]
    End If
    End If
    #Brainstorm, copyright, node, publisher, publication, testItem, key, tag names.
    If [ $$tag = tagMenus::_Ltag or $$tag = "" and $otherTypeOfTag = tagMenus::_Ltag ]
    If [ tagMenus::tag ≠ tagMenus::tagSpelling and tagCreatorLock::orderOrLock = "" and tagMenus::match = "testItem" or tagMenus::tag ≠ tagMenus::tagSpelling and tagCreatorLock::orderOrLock = "" and tagMenus::match = "brainstorm" or tagMenus::tag ≠ tagMenus::tagSpelling and tagCreatorLock::orderOrLock = "" and tagMenus::match = "copyright" or tagMenus::tag ≠ tagMenus::tagSpelling and tagCreatorLock::orderOrLock = "" and tagMenus::match = "publication" or tagMenus::tag ≠ tagMenus::tagSpelling and tagCreatorLock::orderOrLock = "" and tagMenus::match = "publisher" or tagMenus::tag ≠ tagMenus::tagSpelling and tagCreatorLock::orderOrLock = "" and tagMenus::match = "node" or tagMenus::tag ≠ tagMenus::tagSpelling and tagCreatorLock::orderOrLock = "" and tagMenus::match = "key" or tagMenus::tag ≠ tagMenus::tagSpelling and tagCreatorLock::orderOrLock = "" and tagMenus::match = "path" ]
    Set Field [ tagMenus::tagSpelling; tagMenus::tag ]
    End If
    End If
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Start up record load script and close the window.
    Set Variable [ $$stopLoadTagRecord ]
    Set Variable [ $$stopTest ]
    Close Window [ Current Window ]
    #
    #
    #END Tag menus layout check
    #
    #
    #
    #
    #
    #BEGIN Test subsection template layout check
    #
    #
    Else If [ Get (LayoutTableName) = "testSubsectionTemplate" ]
    #
    #Get current group's record key.
    If [ Get ( ActiveFieldTableName ) = "testSubsectionGroup" ]
    Set Variable [ $subsectionGroupKey; Value:testSubsectionGroup::_Lgroup ]
    #
    #Also get subsection group's name if it has
    #been changed, because below, this script will
    #need to insure it is not a duplicate name.
    If [ testSubsectionGroup::name ≠ testSubsectionGroup::nameSpellingEXCEPTForTestItemGroup and testSubsectionGroupNodeLock::orderOrLock = "" ]
    Set Variable [ $subsectionGroupName; Value:testSubsectionGroup::name ]
    End If
    #
    #...OR...
    #
    #Get current subsection's record key.
    Else If [ Get ( ActiveFieldTableName ) = "testSubsectionTemplate" ]
    Set Variable [ $testSubsectionTemplateKey; Value:testSubsectionTemplate::_LtestSubsection ]
    End If
    #
    #Exit any fields so we do not get a
    #"can't modify" error message.
    Set Variable [ $$stopChangeName; Value:1 ]
    Go to Field [ ]
    #
    #Speed up script by stopping record load script.
    Set Variable [ $$ID; Value:"ignore" ]
    Set Variable [ $$stopTest; Value:1 ]
    #
    #New window so user's window is not changed.
    New Window [ Height: 1; Width: 1; Top: -1000; Left: -1000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    #
    #Loop thru all records and make sure their spelling
    #has not been changed, and if it has change it back
    #to the way it was, unless the change was made to the
    #record the user was just working on.
    Go to Record/Request/Page [ First ]
    Loop
    #
    #Undo changes to locked and not updated
    #subsection group names.
    If [ //Is group record's creator node locked? testSubsectionGroup::name ≠ testSubsectionGroup::nameSpellingEXCEPTForTestItemGroup and testSubsectionGroupNodeLock::orderOrLock ≠ "" and testSubsectionGroup::match = "testSubsection" or //Is this subsection group's name NOT being actively edited? $subsectionGroupKey ≠ testSubsectionGroup::_Lgroup and testSubsectionGroup::match = "testSubsection" ]
    Set Field [ testSubsectionGroup::name; testSubsectionGroup::nameSpellingEXCEPTForTestItemGroup ]
    End If
    #
    #Undo changes to locked and not updated
    #subsection names.
    If [ //Is subsection record's creator node locked? testSubsectionTemplate::name ≠ testSubsectionTemplate::nameSpelling and testSectionCreatorLock::orderOrLock ≠ "" or //Is this subsection's name NOT being actively edited? testSubsectionTemplate::name ≠ testSubsectionTemplate::nameSpelling and $testSubsectionTemplateKey ≠ testSubsectionTemplate::_LtestSubsection ]
    Set Field [ testSubsectionTemplate::name; testSubsectionTemplate::nameSpelling ]
    End If
    #
    #Update just updated subsection's name.
    If [ //Is this subsection's name being actively edited? testSubsectionTemplate::name ≠ testSubsectionTemplate::nameSpelling and testSectionCreatorLock::orderOrLock = "" and $testSubsectionTemplateKey = testSubsectionTemplate::_LtestSubsection ]
    Set Field [ testSubsectionTemplate::nameSpelling; testSubsectionTemplate::name ]
    End If
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #If a subsection's group name was changed,
    #make sure it is not a duplicate spelling.
    If [ $subsectionGroupName ≠ "" ]
    Go to Layout [ “tableTagGroup” (testSubsectionGroup) ]
    Enter Find Mode [ ]
    Set Field [ testSubsectionGroup::match; "testSubsection" ]
    Set Field [ testSubsectionGroup::name; "==" & $subsectionGroupName ]
    Perform Find [ ]
    Set Variable [ $count; Value:Get (FoundCount) ]
    End If
    #
    Close Window [ Current Window ]
    #
    #If subsection group is a duplicate then make
    #it unique.
    If [ $count > 1 ]
    Set Field [ testSubsectionGroup::name; $subsectionGroupName & " " & testSubsectionGroup::_Lgroup ]
    Set Field [ testSubsectionGroup::nameSpellingEXCEPTForTestItemGroup; $subsectionGroupName & " " & testSubsectionGroup::_Lgroup ]
    Commit Records/Requests
    Show Custom Dialog [ Message: "Subsection groups must have unique names."; Default Button: “OK”, Commit: “Yes” ]
    Go to Field [ ]
    Scroll Window [ Home ]
    Sort Records [ ] [ No dialog ]
    #
    #If subsection's group name is unique,
    #then updage its spelling field.
    Else If [ $count = 1 ]
    Set Field [ testSubsectionGroup::nameSpellingEXCEPTForTestItemGroup; $subsectionGroupName ]
    Go to Field [ ]
    Scroll Window [ Home ]
    Sort Records [ ] [ No dialog ]
    End If
    #
    #Start up record load script.
    Set Variable [ $$ID ]
    Set Variable [ $$stopTest ]
    Set Variable [ $$stopLoadTagRecord ]
    Perform Script [ “loadSetupTestSubsection” ]
    #
    #
    #END Test subsection template layout check
    #
    #
    #
    #
    #
    #BEGIN Test section template layout check
    #
    #
    Else If [ Get (LayoutTableName) = "testSection" ]
    #
    #Get current section's record key.
    Set Variable [ $testSectionTemplateKey; Value:testSection::_Ltag ]
    #
    #Exit any fields so do not get can't modify error message
    #because record is in use in another window.
    Go to Field [ ]
    #
    #Speed up script by stopping record load script.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Set Variable [ $$stopTest; Value:1 ]
    #
    #New window so user's window is not changed.
    New Window [ Height: 1; Width: 1; Top: -1000; Left: -1000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    // New Window [ Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    #
    #Loop thru all records and make sure their spelling
    #has not been changed, and if it has then change it back
    #to the way it was, unless the change was made to the
    #record the user was just working on.
    Go to Record/Request/Page [ First ]
    Loop
    #
    #If the record's creator node is locked, or is
    #not being actively updated, then revert any
    #spelling changes.
    If [ testSectionCreatorLock::orderOrLock ≠ "" or $testSectionTemplateKey ≠ testSection::_Ltag ]
    Set Field [ testSection::tag; testSection::tagSpelling ]
    End If
    #
    #But if node is not locked, then apply changes to
    #field user was just in if any changes where made.
    If [ testSectionCreatorLock::orderOrLock = "" and $testSectionTemplateKey = testSection::_Ltag ]
    Set Field [ testSection::tagSpelling; testSection::tag ]
    End If
    #
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Start up record load script and close the window.
    Set Variable [ $$stopLoadTagRecord ]
    Close Window [ Current Window ]
    Set Variable [ $$stopTest ]
    Set Variable [ $$ID ]
    Exit Script [ ]
    #
    End If
    #
    #
    #END Test section template layout check
    #
    #

Fields used in this script

    tagMenus::_Ltag
    tagMenuTestItemGroup::name
    tagMenuTestItemGroup::nameSpellingFORTestItemGroup
    tagMenuTestItemGroup::nameSpellingEXCEPTForTestItemGroup
    tagMenuGroup::_Lgroup
    tagMenuGroup::name
    tagMenuGroup::nameSpellingEXCEPTForTestItemGroup
    tagCreatorLock::orderOrLock
    tagMenus::tag
    tagMenus::tagSpelling
    tagMenus::match
    tagMenus::orderOrLock
    tagMenuGroup::nameSpellingFORTestItemGroup
    tagMenuGroup::match
    tagMenuTestItemGroup::_Lgroup
    testSubsectionGroup::_Lgroup
    testSubsectionGroup::name
    testSubsectionGroup::nameSpellingEXCEPTForTestItemGroup
    testSubsectionGroupNodeLock::orderOrLock
    testSubsectionTemplate::_LtestSubsection
    testSubsectionGroup::match
    testSubsectionTemplate::name
    testSubsectionTemplate::nameSpelling
    testSectionCreatorLock::orderOrLock
    testSection::_Ltag
    testSection::tagSpelling
    testSection::tag

Scripts used in this script

    loadSetupTestSubsection

Layouts used in this script

    tableTagGroup

Tables used in this script

    tag
    tag
    tagGroup
    tagGroup
    testSubsectionTemplate

Table occurrences used by this script

    tagCreatorLock
    tagMenuGroup
    tagMenuTestItemGroup
    tagMenus
    testSection
    testSectionCreatorLock
    testSubsectionGroup
    testSubsectionGroupNodeLock
    testSubsectionTemplate

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [checkTestSectionSubsectionAndItemRecordSpellings]	Parent Folder: [tagMenu]	Next Script: [CHUNK_addReferenceNodeAndKeywordTagIDs]
Script Name	CHUNK_addLinkToTag
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    addFileLink4ToTag
    addFileLink6ToTag
    addFileLink5ToTag

Script Definition
Script Steps

    #
    #Get key for link that is to be added to tag.
    If [ Get ( LayoutTableName ) = "reference" ]
    Set Variable [ $tag; Value:reference::_Lreference ]
    Set Variable [ $number; Value:$$number ]
    Set Variable [ $$number ]
    Set Variable [ $name; Value:$$name ]
    Set Variable [ $$name ]
    Set Variable [ $window; Value:Get (WindowName) ]
    Else If [ Get ( LayoutTableName ) = "testlearn" ]
    Set Variable [ $tag; Value:testlearn::_Ltestlearn ]
    Set Variable [ $number; Value:$$number ]
    Set Variable [ $$number ]
    Set Variable [ $name; Value:$$name ]
    Set Variable [ $$name ]
    Set Variable [ $window; Value:Get (WindowName) ]
    End If
    #
    #Now add all the added record’s node and keyword
    #tags to any newly added sections.
    Perform Script [ “CHUNK_addReferenceNodeAndKeywordTagIDs” ]
    #
    #Complete process of adding link to tag.
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    #Leave field so user can see
    #conditional formatting.
    Go to Field [ ]
    #
    #Remove key from other slots in may be in, to
    #prevent duplicates showing up.
    If [ tagMenus::Ktitle1 = $tag and $number ≠ 1 ]
    Set Field [ tagMenus::Ktitle1; "" ]
    Else If [ tagMenus::Ktitle2 = $tag and $number ≠ 2 ]
    Set Field [ tagMenus::Ktitle2; "" ]
    Else If [ tagMenus::Ktitle3= $tag and $number ≠ 3 ]
    Set Field [ tagMenus::Ktitle3; "" ]
    End If
    #
    #Place key in selected slot.
    If [ tagMenus::Ktitle1 ≠ $tag and $number = 1 ]
    Set Field [ tagMenus::Ktitle1; $tag ]
    Select Window [ Name: $window; Current file ]
    Exit Script [ ]
    Else If [ tagMenus::Ktitle2 ≠ $tag and $number = 2 ]
    Set Field [ tagMenus::Ktitle2; $tag ]
    Select Window [ Name: $window; Current file ]
    Exit Script [ ]
    Else If [ tagMenus::Ktitle3 ≠ $tag and $number = 3 ]
    Set Field [ tagMenus::Ktitle3; $tag ]
    Select Window [ Name: $window; Current file ]
    Exit Script [ ]
    End If
    #
    #Remove it key if it is already in use.
    If [ tagMenus::Ktitle1 = $tag and $number = 1 ]
    Set Field [ tagMenus::Ktitle1; "" ]
    Else If [ tagMenus::Ktitle2 = $tag and $number = 2 ]
    Set Field [ tagMenus::Ktitle2; "" ]
    Else If [ tagMenus::Ktitle3 = $tag and $number = 3 ]
    Set Field [ tagMenus::Ktitle3; "" ]
    End If
    Select Window [ Name: $window; Current file ]

Fields used in this script

    reference::_Lreference
    testlearn::_Ltestlearn
    tagMenus::Ktitle1
    tagMenus::Ktitle2
    tagMenus::Ktitle3

Scripts used in this script

    CHUNK_addReferenceNodeAndKeywordTagIDs

Layouts used in this script

Tables used in this script

    reference
    tag
    testlearn

Table occurrences used by this script

    reference
    tagMenus
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [CHUNK_addLinkToTag]	Parent Folder: [tagMenu]	Next Script: [CHUNK_checkForDraggedPasteChanges]
Script Name	CHUNK_addReferenceNodeAndKeywordTagIDs
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    CHUNK_addPictureToTag
    addORremovePrimaryTag
    CHUNK_addLinkToTag

Script Definition
Script Steps

    #
    #Admin tasks.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #Stop load tag record script to speed up this script.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Set Variable [ $$stopLoadCitation; Value:1 ]
    #
    #Leave field so user can see
    #conditional formatting.
    Go to Field [ ]
    #
    #Get node and keyword tags linked to this
    #main record.
    If [ Get ( LayoutTableName ) = "reference" ]
    Set Variable [ $nodePrimary; Value:reference::knodePrimary ]
    Set Variable [ $nodeOther; Value:reference::knodeOther ]
    Set Variable [ $keywordPrimary; Value:reference::kkeywordPrimary ]
    Set Variable [ $keywordOther; Value:reference::kkeywordOther ]
    Else If [ Get ( LayoutTableName ) = "testlearn" ]
    Set Variable [ $nodePrimary; Value:testlearn::kNodePrimary ]
    Set Variable [ $nodeOther; Value:testlearn::kNodeOther ]
    Set Variable [ $keywordPrimary; Value:testlearn::kKeywordPrimary ]
    Set Variable [ $keywordOther; Value:testlearn::kcKeywordOther ]
    Else If [ Get ( LayoutTableName ) = "tagMenus" ]
    Set Variable [ $nodePrimary; Value:TEMP::kdefaultNodePrimary ]
    Set Variable [ $nodeOther; Value:TEMP::kdefaultNodeOther ]
    Else If [ Get ( LayoutTableName ) = "tempSetup" ]
    Set Variable [ $nodePrimary; Value:tempSetup::kdefaultNodePrimary ]
    Set Variable [ $nodeOther; Value:tempSetup::kdefaultNodeOther ]
    End If
    #
    #Perform the rest of the script in a new window so
    #users place is not lost in current window.
    New Window [ Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “ltagNK1” (tagMenus) ]
    #
    #PRIMARY NODE
    #Find primary node if there is one.
    If [ $nodePrimary ≠ "" ]
    Enter Find Mode [ ]
    Set Field [ tagMenus::_Ltag; $nodePrimary ]
    Perform Find [ ]
    End If
    #
    #OTHER NODES
    #Find other nodes if there are any.
    If [ $nodeOther ≠ "" ]
    #
    #Determine how many keys there are to find for
    #on the other nodes' keychain.
    Set Variable [ $numberOfNodes; Value:ValueCount ( $nodeOther ) ]
    #
    #Loop thru each node record, with every key
    #in the keychain.
    Loop
    #
    #Exit the loop when there are no more keys to check.
    Exit Loop If [ $numberOfNodes = 0 ]
    #
    #Find node.
    Set Variable [ $$stopLoadCitation ]
    Go to Layout [ “ltagNK1” (tagMenus) ]
    Enter Find Mode [ ]
    Set Field [ tagMenus::_Ltag; GetValue ( $nodeOther ; $numberOfNodes ) ]
    Perform Find [ ]
    #
    #Go the next key up from the bottom of the list
    #of keys on this section's keychain.
    Set Variable [ $numberOfNodes; Value:$numberOfNodes - 1 ]
    End Loop
    End If
    #
    #
    #
    #
    #PRIMARY KEYWORD
    #Find all keywords assigned if there are any.
    If [ $keywordPrimary ≠ "" ]
    #Find in a new window so user's place is not lost
    #on Tag Menus window.
    Enter Find Mode [ ]
    Set Field [ tagMenus::_Ltag; $keywordPrimary ]
    Perform Find [ ]
    #
    End If
    #
    #OTHER KEYWORDS
    #Find all keywords assigned if there are any.
    If [ $keywordOther ≠ "" ]
    #
    #Determine how many keys there are to find for
    #on the other keywords' keychain.
    Set Variable [ $numberOfKeywords; Value:ValueCount ( $keywordOther ) ]
    #
    #Loop thru each keyword record, with every key
    #in the keychain.
    Loop
    #Exit the loop when there are no more keys to check.
    Exit Loop If [ $numberOfKeywords = 0 ]
    #
    #Find keyword.
    Enter Find Mode [ ]
    Set Field [ tagMenus::_Ltag; GetValue ( $keywordOther ; $numberOfKeywords ) ]
    Perform Find [ ]
    #
    #Go the next key up from the bottom of the list
    #of keys on this section's keychain.
    Set Variable [ $numberOfKeywords; Value:$numberOfKeywords - 1 ]
    End Loop
    End If
    #
    #Turn top load tag record script back on.
    Set Variable [ $$stopLoadTagRecord ]
    Set Variable [ $$stopLoadCitation ]
    #
    Set Variable [ $$mainKeychain ]
    Close Window [ Current Window ]
    #

Fields used in this script

    reference::knodePrimary
    reference::knodeOther
    reference::kkeywordPrimary
    reference::kkeywordOther
    testlearn::kNodePrimary
    testlearn::kNodeOther
    testlearn::kKeywordPrimary
    testlearn::kcKeywordOther
    TEMP::kdefaultNodePrimary
    TEMP::kdefaultNodeOther
    tempSetup::kdefaultNodePrimary
    tempSetup::kdefaultNodeOther
    tagMenus::_Ltag

Scripts used in this script

Layouts used in this script

    ltagNK1

Tables used in this script

    TEMP
    reference
    tag
    testlearn

Table occurrences used by this script

    TEMP
    reference
    tagMenus
    tempSetup
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [CHUNK_addReferenceNodeAndKeywordTagIDs]	Parent Folder: [tagMenu]	Next Script: [createFormOutOf_FT_TestItems]
Script Name	CHUNK_checkForDraggedPasteChanges
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    removeTextFormattingAndCommas
    backToLearnOrDefaultSetup
    startDatabase
    checkKeyANDNodeTagNames
    checkTagGroupNamesEXCEPTtestItemGroups
    checkTestItemGroupNames
    testTemplatesSectionButton
    gotoDefaultsOrReport

Script Definition
Script Steps

    #
    #
    #Used by script changeSpellingOfKeywordOrNodeTag
    #removeTextFormattingAndCommas
    If [ Get (LayoutTableName) = "tagMenus" ]
    #
    #Exit any fields so do not get can't modify error message
    #because record is in use in another window.
    Go to Field [ ]
    #
    #Speed up script by stopping record load script.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    #
    #New window so user's window is not changed.
    New Window [ Height: 1; Width: 1; Top: -1000; Left: -1000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    #
    #Loop thru all records and make sure their spelling
    #has not been changed, and if it has change it back
    #to the way it was, unless the change was made in the
    #field the user was just working on.
    Go to Record/Request/Page [ First ]
    Loop
    #
    #Group name check EXCEPT for
    #test item group names.
    If [ Get (LayoutName) ≠ "setupTestItem" ]
    If [ tagMenuGroup::nameSpellingEXCEPTForTestItemGroup ≠ "testItemGroup" ]
    If [ tagMenuGroup::nameSpellingEXCEPTForTestItemGroup ≠ tagMenuGroup::name and $$Tag ≠ tagMenuGroup::_Lgroup and $$citationMatch ≠ "testItem" ]
    Set Field [ tagMenuGroup::name; tagMenuGroup::nameSpellingEXCEPTForTestItemGroup ]
    End If
    End If
    End If
    #
    #Test item group name check.
    If [ Get (LayoutName) = "setupTestItem" or tagMenuGroup::nameSpellingEXCEPTForTestItemGroup = "testItemGroup" ]
    If [ tagMenuTestItemGroup::name ≠ tagMenuTestItemGroup::nameSpellingFORTestItemGroup and $$Tag ≠ tagMenuTestItemGroup::_Lgroup and //Test item group match field is the name spelling check field for other tag groups. tagMenuTestItemGroup::nameSpellingEXCEPTForTestItemGroup = "testItemGroup" ]
    Set Field [ tagMenuTestItemGroup::name; tagMenuTestItemGroup::nameSpellingFORTestItemGroup ]
    End If
    End If
    #
    #Tag name check.
    If [ tagMenus::tag ≠ tagMenus::tagSpelling ]
    If [ $$tag ≠ "" and $$tag ≠ tagMenus::_Ltag or $$tag = "" or tagCreatorLock::orderOrLock ≠ "" ]
    Set Field [ tagMenus::tag; tagMenus::tagSpelling ]
    End If
    End If
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Start up record load script and close the window.
    Set Variable [ $$stopLoadTagRecord ]
    Close Window [ Current Window ]
    #
    #
    End If

Fields used in this script

    tagMenuGroup::nameSpellingEXCEPTForTestItemGroup
    tagMenuGroup::name
    tagMenuGroup::_Lgroup
    tagMenuTestItemGroup::name
    tagMenuTestItemGroup::nameSpellingFORTestItemGroup
    tagMenuTestItemGroup::_Lgroup
    tagMenuTestItemGroup::nameSpellingEXCEPTForTestItemGroup
    tagMenus::tag
    tagMenus::tagSpelling
    tagMenus::_Ltag
    tagCreatorLock::orderOrLock

Scripts used in this script

Layouts used in this script

Tables used in this script

    tag
    tag
    tagGroup

Table occurrences used by this script

    tagCreatorLock
    tagMenuGroup
    tagMenuTestItemGroup
    tagMenus

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [CHUNK_checkForDraggedPasteChanges]	Parent Folder: [tagMenu]	Next Script: [defaultCopyrightMenu]
Script Name	createFormOutOf_FT_TestItems
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    setupTestItem
    setupTestItemLOCKED
    testMenuTestItem
    reportTagItem

Scripts that use this script

    loadTestResultRecord

Script Definition
Script Steps

    #
    #
    #Exit any fields before beginnning just in
    #case the user changed the spelling of
    #anything that would require the spellcheck
    #script to run.
    Go to Field [ ]
    #
    #
    #
    #If it turns out there are no FT items, then tell
    #the user this and exit the script.
    If [ $$noFT_ItemsFound = 1 ]
    Show Custom Dialog [ Message: "There are no form (FT) items for this subsection."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #
    #
    #BEGIN Stop this script checks.
    #
    #Test subject is locked.
    If [ $$testSubjectIsLocked ≠ "" and Get ( LayoutName ) ≠ "defaultTest" and Get ( LayoutName ) ≠ "learnTest" ]
    Show Custom Dialog [ Message: "The test subject — " & $$testSubjectIsLocked & " — is locked. To unlock, A) go back to the setup node tag menu. B) Select this test subject. C) Click 'lock' and enter the password."; Default Button: “OK”, Commit: “No” ]
    Set Variable [ $exit; Value:1 ]
    End If
    #
    #Primary node is locked.
    If [ TEMP::primaryNodeIsLocked ≠ "" ]
    If [ $exit = "" ]
    Show Custom Dialog [ Message: "The default primary node — " & TEMP::DEFAULTNodePrimaryName & " — is locked. Go to the Default Node Tag Menu and A) click 'lock' to unlock it, B) select an unlocked node for the primary node, or C) create a new primary node."; Default Button: “OK”, Commit: “No” ]
    Else
    Show Custom Dialog [ Message: "ALSO, the default primary node — " & TEMP::DEFAULTNodePrimaryName & " — is locked. Go to the Default Node Tag Menu and A) click 'lock' to unlock it, B) select an unlocked node for the primary node, or C) create a new primary node."; Default Button: “OK”, Commit: “No” ]
    End If
    Set Variable [ $exit; Value:1 ]
    End If
    #
    #If any of the above are true, then
    #exit this script.
    If [ $exit = 1 ]
    Exit Script [ ]
    End If
    #
    #END Stop this script checks.
    #
    #
    #
    #
    #
    #BEGIN See where to insert form.
    #
    #
    #If the user clicks the V button on the setup
    #test-item layout, skip this bit, otherwise see
    #where the user wants to put the form this
    #script will create on a Test or Report field.
    If [ Left (Get (LayoutName) ; 5 ) ≠ "setup" ]
    #
    #Select the test window and copy the contents
    #of the note field and see if it is active.
    Select Window [ Name: "Test"; Current file ]
    #
    #If library is in the report section ...
    If [ Get ( LastError )= 112 ]
    Select Window [ Name: "Report"; Current file ]
    Set Variable [ $report; Value:1 ]
    #
    #If the user has not clicked into a field, into
    #which to insert the form let them know they
    #need to do this before the form can be inserted.
    If [ Get ( ActiveFieldName ) = "" ]
    Show Custom Dialog [ Message: "Enter the field where you want the form to go. It will be placed below any text currently in that field."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    #
    #
    Else
    #If a field has been selected then capture
    #its contents if any.
    Set Variable [ $note; Value:Get ( ActiveFieldContents ) ]
    End If
    #
    #
    #If library is in the learn section ...
    Else
    #
    #Capture the contents of the active field.
    Set Variable [ $note; Value:testlearn::note ]
    End If
    #
    #Return to the Tag Menus window.
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    #If the note field is not blank ...
    If [ $note ≠ "" ]
    #
    #Tell the user that a form will be added below
    #the current text in the note text box, AND if
    #the user hiding the test FT items that make up
    #a form, tell the user how to reveal them.
    If [ TEMP::testHideFormTextItemsFTs = 1 ]
    Show Custom Dialog [ Message: "A form will be added below the current text. You may need to scroll down to see it. To view test items used to make this form, click the 'hideFTs' button."; Default Button: “OK”, Commit: “Yes”; Button 2: “cancel”, Commit: “No” ]
    Else
    Show Custom Dialog [ Message: "A form will be added below the current text. You may need to scroll down to see it."; Default Button: “OK”, Commit: “Yes”; Button 2: “cancel”, Commit: “No” ]
    End If
    #Stop the script if the user clicks cancel.
    If [ Get (LastMessageChoice) = 2 ]
    Exit Script [ ]
    End If
    #
    End If
    End If
    #
    #
    #If the user is on the setup layout, note this.
    If [ Left (Get (LayoutName) ; 5 ) = "setup" ]
    Set Variable [ $insertFormInPreviewWindow; Value:1 ]
    End If
    #
    #
    #END See where to insert form.
    #
    #
    #
    #
    #
    #BEGIN Create form.
    #
    #
    #Create the form, unless the user
    #clicked cancel in a new window.
    If [ Get (LastMessageChoice) ≠ 2 or $$addFormToNewTestResult ≠ "" ]
    Set Variable [ $$userClickedVButton; Value:1 ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    #
    New Window [ Name: "Form Preview"; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “ltagSCRIPTloops” (tagMenus) ]
    Adjust Window [ Resize to Fit ]
    #
    Set Variable [ $$userClickedVButton ]
    Set Variable [ $$stopLoadTagRecord ]
    #
    #Find all test items for this subsection.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Enter Find Mode [ ]
    Set Field [ tagMenuTestItemGroup::match; TEMP::ktestItemSubsection & ¶ ]
    Set Field [ tagMenus::copyrightTextLockedORtextTitem; "FT" ]
    Perform Find [ ]
    #
    #To insure the 'sort' button will next sort
    #alphabetically, note that the current sort is
    #by category/group.
    Set Field [ TEMP::sortTestItem; "cat" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuTestItemGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuTestItemGroup::name; ascending tagMenuTestItemGroup::_Lgroup; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    Scroll Window [ Home ]
    Go to Record/Request/Page [ First ]
    #
    #Now, get all FT text items = build the form.
    Go to Record/Request/Page [ First ]
    Loop
    #
    #Stop any find error messages as there may be
    #no test items.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    Go to Field [ ]
    #
    #If the item is an FT item then add it to the
    #form.
    If [ tagMenus::notesOrCopyright = "FT" ]
    #
    #If the style of the FT item is main header style ...
    If [ tagMenus::textStyleOrCreatorNodeFlag = "" or tagMenus::textStyleOrCreatorNodeFlag = "1" or tagMenus::textStyleOrCreatorNodeFlag = "2" ]
    Set Variable [ $tag; Value:tagMenus::tag ]
    Else
    #
    #and it is not the first form item ...
    If [ $tag = "" ]
    Set Variable [ $tag; Value:tagMenus::tag ]
    #
    #then include a paragraph between it and
    #the last FT item added.
    Else
    Set Variable [ $tag; Value:¶ & tagMenus::tag ]
    End If
    End If
    #
    #If this the first item on this form,
    #then just added it.
    If [ $form = "" ]
    Set Variable [ $form; Value:$tag ]
    #
    #BUT, if the form already has items in it, then
    #add this next item a paragraph below the last
    #item in the form.
    Else
    Set Variable [ $form; Value:$form & ¶ & $tag ]
    End If
    End If
    #
    Go to Record/Request/Page [ Next; Exit after last ]
    #
    End Loop
    End If
    #
    #
    #END Create form.
    #
    #
    #
    #
    #
    #
    #BEGIN Insert form in designated field.
    #
    #
    #Create a clear formatting variable to insure
    #anything typed after the newly inserted form
    #will be in the default format.
    Set Variable [ $clearFormatting; Value:TextFont ( " " ; "Georgia" ) ]
    Set Variable [ $clearFormatting; Value:TextColor ( $clearFormatting ; RGB ( 34 ; 34 ; 34 ) ) ]
    Set Variable [ $clearFormatting; Value:TextSize ( $clearFormatting ; 16 ) ]
    Set Variable [ $clearFormatting; Value:TextStyleAdd ( $clearFormatting ; Plain ) ]
    #
    #
    #If the user is in the Test Template section,
    #then go to the preview form layout and
    #insert the form.
    If [ $insertFormInPreviewWindow ≠ "" ]
    Go to Layout [ “testItemFormPreview” (TEMP) ]
    Set Field [ TEMP::Message; $form ]
    Adjust Window [ Resize to Fit ]
    Move/Resize Window [ Current Window; Height: Get (ScreenHeight) ]
    Pause/Resume Script [ Indefinitely ]
    Exit Script [ ]
    End If
    #
    #If the user is NOT in the Test Template
    #section, then close the window used to
    #create the form and proceed to insert it
    #where the user wants it to go.
    If [ $insertFormInPreviewWindow = "" ]
    Close Window [ Current Window ]
    End If
    #
    #If the user is in the test section, then go the
    #Test window to add the form to the current
    #result.
    If [ Left (Get (LayoutName) ; 5 ) ≠ "setup" ]
    If [ $report = 1 ]
    Select Window [ Name: "Report"; Current file ]
    Else
    Select Window [ Name: "Test"; Current file ]
    End If
    End If
    #
    #If the note field is blank, then add the form to it.
    If [ $note = "" ]
    If [ $report = 1 ]
    Set Field [ $form & $clearFormatting & ¶ & ¶ & $clearFormatting ]
    Else
    Set Field [ testlearn::note; $form & $clearFormatting & ¶ & ¶ & $clearFormatting ]
    End If
    #
    #If it is not blank, then add the form below
    #the curren text.
    Else
    If [ $report = 1 ]
    Set Field [ $note & ¶ & $form & $clearFormatting & ¶ & ¶ & $clearFormatting ]
    Else
    Set Field [ testlearn::note; $note & ¶ & $form & $clearFormatting & ¶ & ¶ & $clearFormatting ]
    End If
    End If
    #
    #
    #END Insert form in designated field.
    #
    #

Fields used in this script

    TEMP::primaryNodeIsLocked
    TEMP::DEFAULTNodePrimaryName
    testlearn::note
    TEMP::testHideFormTextItemsFTs
    TEMP::ktestItemSubsection
    tagMenuTestItemGroup::match
    tagMenus::copyrightTextLockedORtextTitem
    TEMP::sortTestItem
    tagMenuTestItemGroup::orderOrLibraryType
    tagMenuTestItemGroup::name
    tagMenuTestItemGroup::_Lgroup
    tagMenus::orderOrLock
    tagMenus::tag
    tagMenus::notesOrCopyright
    tagMenus::textStyleOrCreatorNodeFlag
    TEMP::Message

Scripts used in this script

Layouts used in this script

    ltagSCRIPTloops
    testItemFormPreview

Tables used in this script

    TEMP
    tag
    tagGroup
    testlearn

Table occurrences used by this script

    TEMP
    tagMenuTestItemGroup
    tagMenus
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [createFormOutOf_FT_TestItems]	Parent Folder: [tagMenu]	Next Script: [defaultLibraryButton]
Script Name	defaultCopyrightMenu
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultsAll
    defaultCopyright
    defaultNode1
    defaultNode2
    defaultNodeS2
    defaultNode3
    defaultNodeS3
    defaultNodeS4
    defaultNode4

Scripts that use this script

Script Definition
Script Steps

    #
    #Insure user selects a default node first, so
    #they get credit if they want to create any
    #copyright records, as the default node
    #is the creator of all new records.
    If [ tempSetup::kdefaultNodePrimary = "" ]
    Show Custom Dialog [ Message: "Select yourself (the node responsible for creating new records) by clicking the node button."; Default Button: “OK”, Commit: “No” ]
    Halt Script
    End If
    #
    #Set citationMatch to color menu button with inUse color.
    Set Variable [ $$citationMatch; Value:"copyright" ]
    Select Window [ Name: "Setup"; Current file ]
    Set Variable [ $$citationitem; Value:tempSetup::kdefaultCopyright ]
    Set Field [ TEMP::mTag; "copyright" ]
    Refresh Window
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    #Turn off the loadtagrecord script to speed up the
    #loop portion of the script.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Set Variable [ $$stopTest; Value:1 ]
    #
    #Speed up script by going to layout with no
    #pictures to load.
    Go to Layout [ “ltagNK1” (tagMenus) ]
    #
    #Find all node records.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    Enter Find Mode [ ]
    Set Field [ tagMenus::match; $$citationMatch ]
    Perform Find [ ]
    #
    #Sort to group, textstyle, and then tag,
    #so that the 3.0 ND tag comes before the
    #4.0 ND tag as it does for all the other Creative
    #Commons tags.
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::name; ascending tagMenus::textStyleOrCreatorNodeFlag; ascending tagMenus::tag; ascending ] [ Restore; No dialog ]
    #
    #
    #Go to citation record's current selection or to first record.
    #Because user may click anywhere to go to a record
    #all keys for all menu items must uploaded
    #until one is found that matches and then the
    #$$citationItem variable can be set.
    #Like when the user clicks in a non field area
    #a space between fields that then tells filemaker
    #to go that record but not to field belonging to
    #that record.
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ $$citationitem = tagMenus::_Ltag ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    If [ $$citationitem ≠ tagMenus::_Ltag ]
    Go to Record/Request/Page [ First ]
    End If
    #
    #Goto correct layout.
    Go to Layout [ “defaultCopyright” (tagMenus) ]
    #
    #Turn loadtagrecord script back on.
    Set Variable [ $$stopLoadTagRecord ]
    Set Variable [ $$stopTest ]
    #
    #Inform user of items use on both screens.
    Perform Script [ “loadTagRecord” ]
    Refresh Window
    #
    #
    #Just in case user was in nonTag field on this
    #window when user clicked a menu button on
    #the other window, exit all fields.
    Select Window [ Name: "Setup"; Current file ]
    Refresh Window
    #
    #goto Tag Menus window
    Select Window [ Name: "Tag Menus"; Current file ]
    #

Fields used in this script

    tempSetup::kdefaultNodePrimary
    tempSetup::kdefaultCopyright
    TEMP::mTag
    tagMenus::match
    tagMenuGroup::name
    tagMenus::textStyleOrCreatorNodeFlag
    tagMenus::tag
    tagMenus::_Ltag

Scripts used in this script

    loadTagRecord

Layouts used in this script

    ltagNK1
    defaultCopyright

Tables used in this script

    TEMP
    TEMP
    tag
    tagGroup

Table occurrences used by this script

    TEMP
    tagMenuGroup
    tagMenus
    tempSetup

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [defaultCopyrightMenu]	Parent Folder: [tagMenu]	Next Script: [defaultNodeMenu]
Script Name	defaultLibraryButton
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultSetup
    defaultTest
    defaultTestNewSection

Scripts that use this script

    startDatabase
    returnToSetup

Script Definition
Script Steps

    #
    #Set citationMatch to color menu button with inUse color.
    Go to Layout [ “defaultSetup” (librarySetupReferenceMain) ]
    Refresh Window
    #

Fields used in this script

Scripts used in this script

Layouts used in this script

    defaultSetup

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [defaultLibraryButton]	Parent Folder: [tagMenu]	Next Script: [defaultsAll]
Script Name	defaultNodeMenu
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultsAll
    defaultCopyright
    defaultNode1
    defaultNode2
    defaultNodeS2
    defaultNode3
    defaultNodeS3
    defaultNodeS4
    defaultNode4

Scripts that use this script

    addLinksPicturesToTagsMode
    startDatabase

Script Definition
Script Steps

    #
    #Do not load tag records until the end of script
    #to prevent flashing of window and to speed up
    #script.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    #
    #Make sure library's creator node and the
    #creator node's group exists.
    Perform Script [ “CHUNK_checkCreatorNodeAndPrimaryNode” ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    #
    #Set citationMatch to color menu button with inUse color.
    Set Variable [ $$citationMatch; Value:"node" ]
    Select Window [ Name: "Setup"; Current file ]
    Set Variable [ $$citationitem; Value:tempSetup::kdefaultNodePrimary ]
    Set Variable [ $$testSubject; Value:tempSetup::kdefaultNodeTestSubject ]
    Set Variable [ $$node; Value:tempSetup::kdefaultNodeOther ]
    Set Field [ TEMP::mTag; "node" ]
    Refresh Window
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    #Find all node records.
    Go to Layout [ “defaultNode1” (tagMenus) ]
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    Enter Find Mode [ ]
    Set Field [ tagMenus::match; $$citationMatch ]
    #
    #In Seupt section only show creator nodes,
    #as these are the only nodes that can create
    #or edit library records.
    Set Field [ tagMenus::textStyleOrCreatorNodeFlag; 123456789 ]
    Perform Find [ ]
    #
    #Sort according to current users wishes.
    If [ TEMP::sortNode = "cat" or TEMP::sortNode = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::tag; ascending ] [ Restore; No dialog ]
    Set Field [ TEMP::sortNode; "cat" ]
    Else If [ TEMP::sortNode = "abc" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenus::tag; ascending ] [ Restore; No dialog ]
    End If
    #
    #
    #Go to citation record's current selection or to first record.
    #Because user may click anywhere to go to a record
    #all keys for all menu items must uploaded
    #until one is found that matches and then the
    #$$citationItem variable can be set.
    #Like when the user clicks in a non field area
    #a space between fields that then tells filemaker
    #to go that record but not to field belonging to
    #that record.
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ $$citationitem = tagMenus::_Ltag ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    If [ $$citationitem ≠ tagMenus::_Ltag ]
    Go to Record/Request/Page [ First ]
    End If
    #
    #Go to user's selected menu view.
    If [ tempSetup::DefaultmoreORLessLayoutNode = "" ]
    Go to Layout [ “defaultNode1” (tagMenus) ]
    Set Field [ TEMP::DefaultmoreORLessLayoutNode; "more" & Get (LayoutName) ]
    Else If [ tempSetup::DefaultmoreORLessLayoutNode ≠ "" ]
    Go to Layout [ Middle ( TEMP::DefaultmoreORLessLayoutNode ; 5 ; 42 ) ]
    End If
    #
    #Inform user of items use on both screens.
    Set Variable [ $$stopLoadTagRecord ]
    Perform Script [ “loadTagRecord” ]
    Refresh Window
    #
    #
    #Just in case user was in nonTag field on this
    #window when user clicked a menu button on
    #the other window, exit all fields.
    Select Window [ Name: "Setup"; Current file ]
    Refresh Window
    #
    #goto Tag Menus window
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    #Inform user node was added back.
    If [ $$creatorNodeAddedBack = 1 ]
    Show Custom Dialog [ Message: "The creator node for this library was added back. You may change the name but not delete this node."; Default Button: “OK”, Commit: “Yes” ]
    Show Custom Dialog [ Message: "A newly created group was created for this node. Rename this group, or move the node to a group of your choice."; Default Button: “OK”, Commit: “Yes” ]
    Set Variable [ $$creatorNodeAddedBack ]
    End If
    #
    #Show creator node explanation
    #once per session.
    If [ $$showCreatorNodemessageOnlyOnce = "" ]
    Show Custom Dialog [ Message: "Node's created in this Setup section, and in the Learn section of this library, are used to create and edit all records in this library, while node/author tags created in the Reference section can only be used to tag Referenced works."; Default Button: “OK”, Commit: “Yes” ]
    Show Custom Dialog [ Message: "NOTE: Setup and Learn record creator nodes will also show up in the Reference section, where they can be used to tag a Reference if it is for a work authored by one or more of this library's creators."; Default Button: “OK”, Commit: “Yes” ]
    Show Custom Dialog [ Message: "This message appears only per session. Restart this library to see it again."; Default Button: “OK”, Commit: “Yes” ]
    Set Variable [ $$showCreatorNodemessageOnlyOnce; Value:1 ]
    End If
    #

Fields used in this script

    tempSetup::kdefaultNodePrimary
    tempSetup::kdefaultNodeTestSubject
    tempSetup::kdefaultNodeOther
    TEMP::mTag
    tagMenus::match
    tagMenus::textStyleOrCreatorNodeFlag
    TEMP::sortNode
    tagMenuGroup::orderOrLibraryType
    tagMenuGroup::name
    tagMenus::tag
    tagMenus::_Ltag
    tempSetup::DefaultmoreORLessLayoutNode
    TEMP::DefaultmoreORLessLayoutNode

Scripts used in this script

    CHUNK_checkCreatorNodeAndPrimaryNode
    loadTagRecord

Layouts used in this script

    defaultNode1
    <Missing Layout>

Tables used in this script

    TEMP
    TEMP
    tag
    tagGroup

Table occurrences used by this script

    TEMP
    tagMenuGroup
    tagMenus
    tempSetup

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [defaultNodeMenu]	Parent Folder: [tagMenu]	Next Script: [deleteCPPPBtags]
Script Name	defaultsAll
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultCopyright
    defaultNode1
    defaultNode2
    defaultNodeS2
    defaultNode3
    defaultNodeS3
    defaultNodeS4
    defaultNode4

Scripts that use this script

    backToLearnOrDefaultSetup
    gotoDefaultsOrReport
    returnToTestSetup

Script Definition
Script Steps

    #
    #Make sure window to fills half of the screen.
    Move/Resize Window [ Current Window; Height: Get (ScreenHeight); Width: Get (ScreenWidth) / 2; Top: 0; Left: Get (ScreenWidth) / 2 ]
    #
    #Go the defaults layout.
    Set Variable [ $$stopAddTagToCitation; Value:1 ]
    Go to Layout [ “defaultsAll” (tempSetup) ]
    Set Variable [ $$stopAddTagToCitation ]
    #
    #Delete all records as user could have
    #performed some scripts that created multiple
    #temporary records to show them information
    #about records that require attention.
    Show All Records
    Delete All Records [ No dialog ]
    #
    #Create a new default record to show current
    #selected default tags and library information.
    New Record/Request
    #
    #Insure that correct filename is shown.
    #For some reason, FileMaker will not calculate
    #accurate filename unless a second new
    #record is created and then the previous
    #record is deleted.
    New Record/Request
    Go to Record/Request/Page [ Previous ]
    Delete Record/Request [ No dialog ]
    #
    Set Variable [ $$citationMatch ]
    Refresh Window
    #

Fields used in this script

Scripts used in this script

Layouts used in this script

    defaultsAll

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [defaultsAll]	Parent Folder: [tagMenu]	Next Script: [deleteKeywordTag]
Script Name	deleteCPPPBtags
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultCopyright
    ReferenceMenu1
    ReferenceMenuCopyright
    learnMenuBrainstorm
    learnMenuStuffBrainstorm

Scripts that use this script

Script Definition
Script Steps

    #Delete copyright, publication, publisher,
    #path, and brainstorm tags.
    #
    If [ tagCreatorLock::orderOrLock ≠ "" and tagMenus::orderOrLock ≠ "lock" and tagMenus::match = "brainstorm" or tagCreatorLock::orderOrLock ≠ "" and tagMenus::orderOrLock ≠ "lock" and tagMenus::match = "copyright" or tagCreatorLock::orderOrLock ≠ "" and tagMenus::orderOrLock ≠ "lock" and tagMenus::match = "test" ]
    Show Custom Dialog [ Message: "This record is locked. Go the node that created it — " & tagCreatorLock::tag & " — in the setup tag window and enter the password to unlock it."; Default Button: “OK”, Commit: “No” ]
    Exit Script [ ]
    Else If [ tagMenus::orderOrLock ≠ "" and tagMenus::orderOrLock = "lock" and tagMenus::match = "copyright" ]
    If [ tagMenuGroup::_Lgroup = "92020171119521809" ]
    Show Custom Dialog [ Message: "This is the Library " & TEMP::versionNumber & " trademark tag. It cannot be deleted. Click the 'web' button to see the source of information used to create this tag."; Default Button: “OK”, Commit: “Yes” ]
    Else
    Show Custom Dialog [ Message: "This is a Library " & TEMP::versionNumber & " copy of a copyright and cannot be deleted. Click the 'web' button to see the original."; Default Button: “OK”, Commit: “Yes” ]
    End If
    Exit Script [ ]
    End If
    #
    #If the copyright being checked for deletion is in use
    #as a default copyright then stop the script and inform
    #the user of this fact.
    If [ FilterValues ( TEMP::kdefaultCopyright ; tagMenus::_Ltag & "¶" ) ]
    Show Custom Dialog [ Message: "This copyright is currently selected as the default and cannot be deleted."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    If [ $$citationMatch = "brainstorm" and $$atLeastOneRecord ≠ "" ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Show Custom Dialog [ Message: "You can delete this brainstom after you untag it from each record using it (highlighted blue) in the Learn window."; Default Button: “OK”, Commit: “Yes” ]
    Else
    Show Custom Dialog [ Message: "You can delete this inventory list after you untag it from each record using it (highlighted blue) in the Learn window."; Default Button: “OK”, Commit: “Yes” ]
    End If
    Exit Script [ ]
    End If
    #
    #Prevent all record load scripts (they slow down
    #this script and are uneccessary).
    Set Variable [ $$stoploadCitation; Value:1 ]
    #
    #Exit field so user can see red delete
    #formatting later on.
    Go to Field [ ]
    #
    #Get all variables needed to preform script.
    Set Variable [ $tag; Value:tagMenus::_Ltag ]
    Set Variable [ $name; Value:tagMenus::tag ]
    #
    #Open a new window and look for tag in both
    #primary and other keyword fields.
    If [ $$citationMatch ≠ "brainstorm" ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    // New Window [ Name: "Delete Tag"; Height: 1; Width: 1; Top: -10000; Left: -10000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    New Window [ Name: "Delete Tag"; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    #
    #Find tagged Reference records.
    Go to Layout [ “Reference” (reference) ]
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Enter Find Mode [ ]
    #
    #
    If [ $$citationMatch = "medium" ]
    Set Field [ reference::kmedium; $tag ]
    Else If [ $$citationMatch = "path" ]
    Set Field [ reference::kfolderpath; $tag ]
    Else If [ $$citationMatch = "publisher" ]
    Set Field [ reference::kpublisher; $tag ]
    Else If [ $$citationMatch = "publication" ]
    Set Field [ reference::kpublication; $tag ]
    Else If [ $$citationMatch = "copyright" ]
    Set Field [ reference::kCopyright; $tag ]
    End If
    #
    #
    Perform Find [ ]
    Set Variable [ $refLastError; Value:Get (LastError) ]
    #
    #
    #Find copyright tagged node records. Node
    #records when used to to create new records,
    #are given a copyright applied to all such
    #records, which the user can change.
    If [ $$citationMatch = "copyright" ]
    Go to Layout [ “tableTag” (tagTable) ]
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Enter Find Mode [ ]
    #
    #
    Set Field [ tagTable::notesOrCopyright; $tag ]
    Set Field [ tagTable::match; "node" ]
    #
    #
    Perform Find [ ]
    Set Variable [ $nodeCopyright; Value:Get (LastError) ]
    #
    #
    Go to Record/Request/Page [ First ]
    Loop
    Set Variable [ $nodeNames; Value:Case ( $nodeNamesPlus = "" ; tagTable::tag ; $nodeNamesPlus & "; " & tagTable::tag) ]
    Go to Record/Request/Page [ Next; Exit after last ]
    Set Variable [ $nodeNamesPlus; Value:$nodeNames ]
    End Loop
    #
    #
    #
    End If
    #
    Set Variable [ $$stopLoadTagRecord ]
    End If
    #
    #If records are found using this tag tell user
    #that it must be removed from all records
    #before it can be deleted.
    If [ $nodeCopyright ≠ 401 and $nodeCopyright ≠ 400 and $nodeCopyright ≠ "" and $$citationMatch ≠ "brainstorm" or $refLastError ≠ 401 and $refLastError ≠ 400 and $refLastError ≠ "" and $$citationMatch ≠ "brainstorm" ]
    Close Window [ Name: "Delete Tag"; Current file ]
    If [ $refLastError = 0 ]
    Show Custom Dialog [ Message: "In use by Reference records. Must be removed before deleting. Click the 'find' button and then the square button next to '" & Left ( $name ; 20 ) & If ( Length ( $name ) > 20 ; "..." ; "" ) & "' to find all records using this tag."; Default Button: “OK”, Commit: “Yes” ]
    Else If [ $nodeCopyright = 0 ]
    Show Custom Dialog [ Message: "In use by node records: " & $nodeNames & ". Select a new copryight for them, then you can delete this copyright."; Default Button: “OK”, Commit: “Yes” ]
    End If
    Set Variable [ $delete ]
    Refresh Window
    Set Variable [ $$stoploadCitation ]
    Exit Script [ ]
    #
    #If records are not found using this tag make
    #sure user wants to delete it.
    Else If [ $TLLastError = 401 and $refLastError ≠ 0 or $TLLastError ≠ 0 and $refLastError = 401 or $TLLastError = 401 and $refLastError = 401 or $$citationMatch = "brainstorm" ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Set Variable [ $delete; Value:tagMenus::_Ltag ]
    Refresh Window
    Set Variable [ $group; Value:tagMenus::kGroupOrTest ]
    Show Custom Dialog [ Message: "Delete " & $name & "?"; Default Button: “Cancel”, Commit: “Yes”; Button 2: “Delete”, Commit: “No” ]
    #
    #If the user says yes, first make sure the record
    #is not the last record in a group. If it is and
    #the system deleted the record without deleting
    #the group too, this group would become
    #an orphan as only groups that have records
    #attached to them show up for the user to add
    #more records under them. So the group
    #record must also be deleted if this is the last
    #record under it.
    If [ Get ( LastMessageChoice ) = 2 ]
    #
    If [ $$citationMatch = "brainstorm" ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    New Window [ Name: "Delete Tag"; Top: -10000; Left: -10000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Else
    Select Window [ Name: "delete tag"; Current file ]
    End If
    #
    Go to Layout [ “tableTag” (tagTable) ]
    Enter Find Mode [ ]
    Set Field [ tagTable::kGroupOrTest; $group ]
    Perform Find [ ]
    #
    #If there are more records under this cateogry
    #then the system deletes the current record without
    #any more user input.
    If [ Get (FoundCount) ≠ 1 ]
    Close Window [ Name: "Delete Tag"; Current file ]
    Set Variable [ $$stopLoadTagRecord ]
    Delete Record/Request [ No dialog ]
    Set Variable [ $delete ]
    Set Variable [ $group ]
    Refresh Window
    Set Variable [ $$stoploadCitation ]
    Exit Script [ ]
    #
    #BUT if only one record is found user is asked
    #if they want to delete the category too.
    Else If [ Get (FoundCount) = 1 ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    #
    #
    #The records are sorted by category to show
    #the user which category is going to be deleted.
    If [ TEMP::sortMedium ≠ "cat" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    Else If [ TEMP::sortPath ≠ "cat" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    Else If [ TEMP::sortPublisher ≠ "cat" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    Else If [ TEMP::sortCopyright ≠ "cat" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    Else If [ TEMP::sortPublication ≠ "cat" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    End If
    #
    #
    Show Custom Dialog [ Message: "Deleting " & Left ( $name ; 20 ) & If ( Length ( $name ) > 20 ; "..." ; "" ) & " will also delete its group as it is the last item in this group."; Default Button: “Cancel”, Commit: “Yes”; Button 2: “Delete”, Commit: “No” ]
    #
    #If the user says yes, then delete both the tag and
    #the category record.
    If [ Get ( LastMessageChoice ) = 2 ]
    Delete Record/Request [ No dialog ]
    Select Window [ Name: "delete tag"; Current file ]
    Go to Layout [ “tableTagGroup” (testSubsectionGroup) ]
    Enter Find Mode [ ]
    Set Field [ testSubsectionGroup::_Lgroup; $group ]
    Perform Find [ ]
    Delete Record/Request [ No dialog ]
    End If
    End If
    End If
    End If
    #
    #No matter what the user decides (delete or cancel)
    #return the user to the window they where looking
    #at and restore the sort to what the user orginally
    #had selected.
    Close Window [ Name: "Delete Tag"; Current file ]
    Set Variable [ $delete ]
    Set Variable [ $group ]
    #
    #Turn back on record load variables.
    Set Variable [ $$stoploadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    #
    If [ $$citationMatch = "brainstorm" ]
    Perform Script [ “loadBrainstormTags” ]
    Else
    Refresh Window
    End If

Fields used in this script

    tagCreatorLock::orderOrLock
    tagMenus::orderOrLock
    tagMenus::match
    tagCreatorLock::tag
    tagMenuGroup::_Lgroup
    TEMP::versionNumber
    TEMP::kdefaultCopyright
    tagMenus::_Ltag
    TEMP::InventoryLibraryYN
    tagMenus::tag
    reference::kmedium
    reference::kfolderpath
    reference::kpublisher
    reference::kpublication
    reference::kCopyright
    tagTable::notesOrCopyright
    tagTable::match
    tagTable::tag
    tagMenus::kGroupOrTest
    tagTable::kGroupOrTest
    TEMP::sortMedium
    tagMenuGroup::orderOrLibraryType
    tagMenuGroup::name
    TEMP::sortPath
    TEMP::sortPublisher
    TEMP::sortCopyright
    TEMP::sortPublication
    testSubsectionGroup::_Lgroup

Scripts used in this script

    loadBrainstormTags

Layouts used in this script

    Reference
    tableTag
    tableTagGroup

Tables used in this script

    TEMP
    reference
    tag
    tag
    tagGroup

Table occurrences used by this script

    TEMP
    reference
    tagCreatorLock
    tagMenuGroup
    tagMenus
    tagTable
    testSubsectionGroup

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [deleteCPPPBtags]	Parent Folder: [tagMenu]	Next Script: [deleteNodeTag]
Script Name	deleteKeywordTag
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultNode1
    defaultNode2
    defaultNodeS2
    defaultNode3
    defaultNodeS3
    defaultNodeS4
    defaultNode4
    ReferenceMenu2keywordOrNode1
    ReferenceMenu2SkeywordOrNode1
    ReferenceMenu2keywordOrNode2
    ReferenceMenu2SkeywordOrNode2
    ReferenceMenu2keywordOrNode3
    ReferenceMenu2SkeywordOrNode3
    ReferenceMenu2keywordOrNode4
    ReferenceMenu2SkeywordOrNode4
    ReferenceMenu2keywordOrNode5
    ReferenceMenu2SkeywordOrNode5
    ltagNK1
    ltagNKs1
    ltagNK2
    ltagNKs2
    ltagNK3
    ltagNKs3
    ltagNK4
    ltagNKs4
    ltagNK5
    ltagNKs5

Scripts that use this script

    deleteNodeTag

Script Definition
Script Steps

    #
    #
    #If user is looking at Node switch to that script.
    If [ $$citationMatch = "node" ]
    Perform Script [ “deleteNodeTag” ]
    Exit Script [ ]
    End If
    #
    #If record is locked, explain to user how to
    #unlock and delete it.
    If [ tagMenus::orderOrLock[2] ≠ "" ]
    Show Custom Dialog [ Message: "This node is locked. Click the lock button above, and enter its password to unlock it."; Default Button: “OK”, Commit: “No” ]
    Halt Script
    Else If [ tagCreatorLock::orderOrLock ≠ "" ]
    If [ tagMenus::orderOrLock[2] = "" ]
    Show Custom Dialog [ Message: "This record is locked. Go the node that created it — " & tagCreatorLock::tag & " — in the setup tag window and enter the password to unlock it."; Default Button: “OK”, Commit: “No” ]
    Else
    Show Custom Dialog [ Message: "This node is locked. Click the lock button above, and enter its password to unlock it."; Default Button: “OK”, Commit: “No” ]
    End If
    Halt Script
    End If
    #
    #
    #If node is currenlty locked then stop script,
    #and inform the user.
    If [ tempSetup::kdefaultNodePrimary ≠ "self" ]
    Perform Script [ “stopLockedNodesRecordsBeingDeleted” ]
    End If
    #
    #Exit field so user can see red delete
    #formatting later on.
    Go to Field [ ]
    #
    #Prevent all record load scripts (they slow down
    #this script and are uneccessary).
    Set Variable [ $$stoploadCitation; Value:1 ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    #
    #Set variables to conditionally format selection to
    #be deleted, and its record number so if the
    #user cancels the delete, the system can return
    #to this record.
    Set Variable [ $delete; Value:tagMenus::_Ltag ]
    Set Variable [ $deleteName; Value:tagMenus::tag ]
    Set Variable [ $recordNumber; Value:Get (RecordNumber) ]
    Set Variable [ $$addTagToCitation; Value:1 ]
    Set Variable [ $group; Value:tagMenus::kGroupOrTest ]
    #
    #The check variable duplicates the $delete
    #variable, and when there is time I'll remove it.
    Set Variable [ $check; Value:tagMenus::_Ltag ]
    #
    #Because there may be no records found, stop
    #the system from informing the user of this.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #Open a new window and look for tag in both
    #primary and other keyword fields.
    New Window [ Height: 1; Width: 1; Top: -10000; Left: -10000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    #
    #See if keyword is used by any learn records.
    #Look in main kprimary...
    Go to Layout [ “tableTestLearn” (testlearn) ]
    Enter Find Mode [ ]
    Set Field [ testlearn::kKeywordPrimary; $check ]
    Set Field [ testlearn::filterFind; "main" & ¶ ]
    Perform Find [ ]
    #
    #Look in main kother...
    Enter Find Mode [ ]
    Set Field [ testlearn::kcKeywordOther; $check & ¶ ]
    Set Field [ testlearn::filterFind; "main" & ¶ ]
    Extend Found Set [ ]
    If [ Get (FoundCount) ≠ 0 ]
    Set Variable [ $inUse; Value:"Learn " & Get (FoundCount) ]
    Set Variable [ $learn; Value:1 ]
    End If
    #
    #See if keyword is used by any discovery records.
    #Check in discovery primary...
    Enter Find Mode [ ]
    Set Field [ testlearn::kKeywordPrimary; $check ]
    Set Field [ testlearn::ktestSubsection; "*" ]
    Perform Find [ ]
    #
    #Check in other...
    Enter Find Mode [ ]
    Set Field [ testlearn::kcKeywordOther; $check ]
    Set Field [ testlearn::ktestSubsection; "*" ]
    Extend Found Set [ ]
    #
    #See if keyword is used by any reference records.
    #Check in primary...
    Go to Layout [ “Reference” (reference) ]
    Enter Find Mode [ ]
    Set Field [ reference::kkeywordPrimary; $check ]
    Perform Find [ ]
    #
    #Check in other...
    Enter Find Mode [ ]
    Set Field [ reference::kkeywordOther; $check ]
    Extend Found Set [ ]
    If [ Get (FoundCount) ≠ 0 ]
    If [ $inUse ≠ "" ]
    Set Variable [ $addToInUse; Value:$inUse ]
    Set Variable [ $inUse; Value:$addToInUse & ", " & "Reference " & Get (FoundCount) ]
    Else If [ $inUse = "" ]
    Set Variable [ $inUse; Value:"Reference " & Get (FoundCount) ]
    End If
    Set Variable [ $reference; Value:1 ]
    End If
    #
    #Close window used to find records using tag.
    Close Window [ Current Window ]
    #
    #If the keyword being deleted was not found in
    #use in make sure the user really wants
    #it deleted.
    If [ $inUse = "" ]
    #
    #If the keyword being deleted was not found in
    #use in any sections of the database then before
    #deleting it make sure the user really wants it deleted.
    Set Variable [ $group ]
    Refresh Window
    Show Custom Dialog [ Message: "Delete current keyword?"; Default Button: “cancel”, Commit: “No”; Button 2: “delete”, Commit: “No” ]
    Set Variable [ $group; Value:tagMenus::kGroupOrTest ]
    Set Variable [ $deleteGroup; Value:tagMenuGroup::name ]
    #
    #If the user cancels, stop the delete.
    If [ Get ( LastMessageChoice ) = 1 ]
    Go to Field [ ]
    Set Variable [ $delete ]
    Set Variable [ $group ]
    Refresh Window
    Refresh Window
    Set Variable [ $$addTagToCitation ]
    Set Variable [ $$stopLoadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    Exit Script [ ]
    #
    #If the user says yes, first make sure the record
    #is not the last record in a group. If it is and
    #the system deleted the record without deleting
    #the group too, this group would become
    #an orphan as only categories that have records
    #attached to them show up for the user to add
    #more records uner them. So the group
    #record must also be deleted if this is the last
    #record under it.
    Else If [ Get ( LastMessageChoice ) = 2 ]
    New Window [ Name: "delete tag"; Height: 1; Width: 1; Top: -10000; Left: -10000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “tableTag” (tagTable) ]
    Enter Find Mode [ ]
    Set Field [ tagTable::kGroupOrTest; $group ]
    Perform Find [ ]
    #
    #If there are more records under this cateogry
    #then the system deletes the current record without
    #any more user input.
    If [ Get (FoundCount) ≠ 1 ]
    Close Window [ Name: "Delete Tag"; Current file ]
    Delete Record/Request [ No dialog ]
    Set Variable [ $delete ]
    Set Variable [ $group ]
    Refresh Window
    Set Variable [ $$addTagToCitation ]
    Set Variable [ $$stopLoadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    Exit Script [ ]
    #
    #BUT if only one record is found user is asked
    #if they want to delete the group too.
    Else If [ Get (FoundCount) = 1 ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    #
    #The records are sorted by group to show
    #the user which group is going to be deleted.
    If [ TEMP::sortKey ≠ "cat" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    End If
    Show Custom Dialog [ Message: "Deleting " & $deleteName & " will also delete its group — " & $deleteGroup & " — as it is the last tag in this group."; Default Button: “Cancel”, Commit: “Yes”; Button 2: “Delete”, Commit: “No” ]
    #
    #If the user says yes, then delete both the tag and
    #the group record.
    If [ Get ( LastMessageChoice ) = 2 ]
    #
    #Delete tag.
    Delete Record/Request [ No dialog ]
    #
    #Delete group.
    Select Window [ Name: "delete tag"; Current file ]
    Go to Layout [ “tableTagGroup” (testSubsectionGroup) ]
    Enter Find Mode [ ]
    Set Field [ testSubsectionGroup::_Lgroup; $group ]
    Perform Find [ ]
    Delete Record/Request [ No dialog ]
    End If
    End If
    End If
    Close Window [ Name: "Delete Tag"; Current file ]
    Set Variable [ $delete ]
    Set Variable [ $group ]
    Refresh Window
    Set Variable [ $$addTagToCitation ]
    Set Variable [ $$stopLoadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    #
    #Load keys for tag focus is now on.
    Perform Script [ “loadTagRecord” ]
    End If
    #
    #If the keyword is found in use then tell user
    #where and that it cannot be deleted.
    If [ $inUse ≠ "" ]
    Set Variable [ $delete ]
    Set Variable [ $group ]
    Refresh Window
    Show Custom Dialog [ Message: Case ( $learn ≠ "" and $reference ≠ "" ; "This keyword is in use in 2 library sections: " & $inUse & ". It cannot be deleted. Use the Tag Menus find feature in each section to find the records using it." ; "This keyword is in use in 1 library section: " & $inUse & ". It cannot be deleted. Use the Tag Menus find feature in this section to find the records using it." ); Default Button: “OK”, Commit: “Yes” ]
    Set Variable [ $$addTagToCitation ]
    Set Variable [ $$stopLoadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    End If
    #

Fields used in this script

    tagMenus::orderOrLock
    tagCreatorLock::orderOrLock
    tagCreatorLock::tag
    tempSetup::kdefaultNodePrimary
    tagMenus::_Ltag
    tagMenus::tag
    tagMenus::kGroupOrTest
    testlearn::kKeywordPrimary
    testlearn::filterFind
    testlearn::kcKeywordOther
    testlearn::ktestSubsection
    reference::kkeywordPrimary
    reference::kkeywordOther
    tagMenuGroup::name
    tagTable::kGroupOrTest
    TEMP::sortKey
    tagMenuGroup::orderOrLibraryType
    testSubsectionGroup::_Lgroup

Scripts used in this script

    deleteNodeTag
    stopLockedNodesRecordsBeingDeleted
    loadTagRecord

Layouts used in this script

    tableTestLearn
    Reference
    tableTag
    tableTagGroup

Tables used in this script

    TEMP
    TEMP
    reference
    tag
    tagGroup
    tagGroup
    testlearn

Table occurrences used by this script

    TEMP
    reference
    tagCreatorLock
    tagMenuGroup
    tagMenus
    tagTable
    tempSetup
    testSubsectionGroup
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [deleteKeywordTag]	Parent Folder: [tagMenu]	Next Script: [duplicateBrainstorm]
Script Name	deleteNodeTag
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    deleteKeywordTag

Script Definition
Script Steps

    #
    #
    #If user is looking at keyword switch to that script.
    If [ $$citationMatch = "key" ]
    Perform Script [ “deleteKeywordTag” ]
    Exit Script [ ]
    End If
    #
    #Exit field so user can see red delete
    #formatting later on.
    Go to Field [ ]
    #
    #Prevent all record load scripts (they slow down
    #this script and are uneccessary).
    Set Variable [ $$stoploadCitation; Value:1 ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    #
    #Set variables to conditionally format section to
    #be deleted, and its record number so if the
    #user cancels the delete, the system can return
    #to this record.
    Set Variable [ $delete; Value:tagMenus::_Ltag ]
    Set Variable [ $deleteName; Value:tagMenus::tag ]
    Set Variable [ $recordNumber; Value:Get (RecordNumber) ]
    Set Variable [ $$addTagToCitation; Value:1 ]
    Set Variable [ $group; Value:tagMenus::kGroupOrTest ]
    Set Variable [ $groupName; Value:tagMenuGroup::name ]
    #
    #The check variable duplicates the $delete
    #variable, and when there is time I'll remove it.
    Set Variable [ $check; Value:tagMenus::_Ltag ]
    #
    #Because there may be no records found, stop
    #the system from informing the user of this.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #Open a new window and look for tag in both
    #primary and other node fields.
    New Window [ Height: 1; Width: 1; Top: -10000; Left: -10000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    // New Window [ Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    #
    #See if this node is this library's creator.
    Go to Layout [ “tableTagGroup” (testSubsectionGroup) ]
    Enter Find Mode [ ]
    Set Field [ testSubsectionGroup::match; "library" ]
    Perform Find [ ]
    #
    #If the current node is the library's creator
    #note this.
    If [ testSubsectionGroup::kRecordCreatorNode = $delete ]
    Set Variable [ $lastSectionCreatorNode; Value:1 ]
    Set Field [ testSubsectionGroup::ReportCaptionORLibraryCreatorName; $deleteName ]
    Set Field [ testSubsectionGroup::nameSpellingFORTestItemGroup; $groupName ]
    End If
    #
    #
    #
    #
    #SETUP REFERENCE
    #See if node is used by any setup
    #reference records.
    Go to Layout [ “tableSetupReference” (librarySetupReferenceMain) ]
    Enter Find Mode [ ]
    Set Field [ librarySetupReferenceMain::kcreatorNode; $check ]
    Perform Find [ ]
    If [ Get (FoundCount) ≠ 0 ]
    Set Variable [ $setupReference; Value:Case ( Length ( librarySetupReferenceMain::name & " by " & librarySetupReferenceMain::creatorName ) < 56 ; Left ( librarySetupReferenceMain::name & " by " & librarySetupReferenceMain::creatorName ; 55 ) & "... |" ; librarySetupReferenceMain::name & " by " & librarySetupReferenceMain::creatorName & " |" ) ]
    Set Variable [ $foundCount; Value:Get (FoundCount) ]
    End If
    #
    #
    #
    #
    #LEARN
    #See if node is used by any learn records.
    #Look in main kprimary...
    Go to Layout [ “tableTestLearn” (testlearn) ]
    Enter Find Mode [ ]
    Set Field [ testlearn::kNodePrimary; $check ]
    Set Field [ testlearn::filterFind; "main" & ¶ ]
    Perform Find [ ]
    #
    #Look in main kother...
    Enter Find Mode [ ]
    Set Field [ testlearn::kNodeOther; $check & ¶ ]
    Set Field [ testlearn::filterFind; "main" & ¶ ]
    Extend Found Set [ ]
    If [ Get (FoundCount) ≠ 0 ]
    If [ $inUse ≠ "" ]
    Set Variable [ $addToInUse; Value:$inUse ]
    Set Variable [ $inUse; Value:$addToInUse & "; Learn " & Get (FoundCount) ]
    Else If [ $inUse = "" ]
    Set Variable [ $inUse; Value:"Learn " & Get (FoundCount) ]
    End If
    End If
    #
    #
    #
    #
    #REFERENCE
    #See if node is used by any reference records.
    #Check in primary...
    Go to Layout [ “Reference” (reference) ]
    Enter Find Mode [ ]
    Set Field [ reference::knodePrimary; $check ]
    Perform Find [ ]
    #
    #Check in other...
    Enter Find Mode [ ]
    Set Field [ reference::knodeOther; $check ]
    Extend Found Set [ ]
    If [ Get (FoundCount) ≠ 0 ]
    If [ $inUse ≠ "" ]
    Set Variable [ $addToInUse; Value:$inUse ]
    Set Variable [ $inUse; Value:$addToInUse & "; Reference " & Get (FoundCount) ]
    Else If [ $inUse = "" ]
    Set Variable [ $inUse; Value:"Reference " & Get (FoundCount) ]
    End If
    End If
    #
    #
    #
    #
    #
    #TEST SUBJECT — SECTION
    #See if node is the creator of any
    #test section records.
    Go to Layout [ “tableTestSectionFromTemplate” (testSectionCreatedFromATemplate) ]
    Enter Find Mode [ ]
    Set Field [ testSectionCreatedFromATemplate::kcreatorNode; $check ]
    Perform Find [ ]
    #
    If [ Get (FoundCount) ≠ 0 ]
    If [ $inUse ≠ "" ]
    Set Variable [ $addToInUse; Value:$inUse ]
    Set Variable [ $inUse; Value:$addToInUse & "; Setup Test " & Get (FoundCount) ]
    Else If [ $inUse = "" ]
    Set Variable [ $inUse; Value:"Setup Test " & Get (FoundCount) ]
    End If
    End If
    #
    #
    #
    #
    #TEST SUBJECT — RESULT
    #See if node is the creator of any
    #test result records.
    Go to Layout [ “tableTestLearn” (testlearn) ]
    Enter Find Mode [ ]
    Set Field [ testlearn::kRecordCreatorNode; $check ]
    Set Field [ testlearn::filterFind; "=" ]
    Perform Find [ ]
    #
    If [ Get (FoundCount) ≠ 0 ]
    If [ $inUse ≠ "" ]
    Set Variable [ $addToInUse; Value:$inUse ]
    Set Variable [ $inUse; Value:$addToInUse & "; Test Result " & Get (FoundCount) ]
    Else If [ $inUse = "" ]
    Set Variable [ $inUse; Value:"Test Result " & Get (FoundCount) ]
    End If
    End If
    #
    #
    #
    #
    #TEST SUBJECT — REPORT
    #See if node is the test subject in any
    #report records.
    #NOT NECESSARY to check on report, as
    #Report records are deleted when all test
    #results for a report section are deleted.
    #
    #
    #
    #
    #TEST TEMPLATE — SECTION
    #See if node is used by any test result records.
    #Check in primary...
    Go to Layout [ “tableTag” (tagTable) ]
    Enter Find Mode [ ]
    Set Field [ tagTable::kRecordCreatorNode; $check ]
    Set Field [ tagTable::match; "testSection" ]
    Perform Find [ ]
    #
    If [ Get (FoundCount) ≠ 0 ]
    If [ $inUse ≠ "" ]
    Set Variable [ $addToInUse; Value:$inUse ]
    Set Variable [ $inUse; Value:$addToInUse & "; Test Templates — section " & Get (FoundCount) ]
    Else If [ $inUse = "" ]
    Set Variable [ $inUse; Value:"testtemplate-section " & Get (FoundCount) ]
    End If
    Set Variable [ $TestTemplateHeader; Value:1 ]
    End If
    #
    #
    #
    #
    #TEST TEMPLATE — SUBSECTION
    #See if node is used by any test result records.
    #Check in primary...
    Go to Layout [ “tableTestSubsectionTemplates” (testSubsectionTemplate) ]
    Enter Find Mode [ ]
    Set Field [ testSubsectionTemplate::kcreatorNode; $check ]
    Perform Find [ ]
    #
    If [ Get (FoundCount) ≠ 0 ]
    If [ $inUse ≠ "" ]
    Set Variable [ $addToInUse; Value:$inUse ]
    If [ $TestTemplateHeader ≠ "" ]
    Set Variable [ $inUse; Value:$addToInUse & ", subsection " & Get (FoundCount) ]
    Else
    Set Variable [ $inUse; Value:$addToInUse & "; Test Template — subsection " & Get (FoundCount) ]
    End If
    Else If [ $inUse = "" ]
    Set Variable [ $inUse; Value:"Test Template — subsection " & Get (FoundCount) ]
    End If
    Set Variable [ $TestTemplateHeader; Value:1 ]
    End If
    #
    #
    #
    #
    #TEST TEMPLATE — ITEM
    #See if node is used by any test result records.
    #Check in primary...
    Go to Layout [ “tableTag” (tagTable) ]
    Enter Find Mode [ ]
    Set Field [ tagTable::kRecordCreatorNode; $check ]
    Set Field [ tagTable::match; "testItem" ]
    Perform Find [ ]
    #
    If [ Get (FoundCount) ≠ 0 ]
    If [ $inUse ≠ "" ]
    Set Variable [ $addToInUse; Value:$inUse ]
    If [ $TestTemplateHeader ≠ "" ]
    Set Variable [ $inUse; Value:$addToInUse & ", item " & Get (FoundCount) ]
    Else
    Set Variable [ $inUse; Value:$addToInUse & "; Test Template — item " & Get (FoundCount) ]
    End If
    Else If [ $inUse = "" ]
    Set Variable [ $inUse; Value:"Test Template — item " & Get (FoundCount) ]
    End If
    End If
    #
    #
    #
    #
    #
    #TAG BRAINSTORM
    #See if node is used by any test result records.
    #Check in primary...
    Go to Layout [ “tableTag” (tagTable) ]
    Enter Find Mode [ ]
    Set Field [ tagTable::kRecordCreatorNode; $check ]
    Set Field [ tagTable::match; "brainstorm" ]
    Perform Find [ ]
    #
    If [ Get (FoundCount) ≠ 0 ]
    If [ $inUse ≠ "" ]
    Set Variable [ $addToInUse; Value:$inUse ]
    Set Variable [ $inUse; Value:$addToInUse & "; Tags — brainstorm " & Get (FoundCount) ]
    Else If [ $inUse = "" ]
    Set Variable [ $inUse; Value:"Tags — brainstorm " & Get (FoundCount) ]
    End If
    Set Variable [ $TagsHeader; Value:1 ]
    Set Variable [ $inuseTags; Value:1 ]
    End If
    #
    #
    #
    #
    #
    #TAG COPYRIGHT
    #See if node is used by any test result records.
    #Check in primary...
    Go to Layout [ “tableTag” (tagTable) ]
    Enter Find Mode [ ]
    Set Field [ tagTable::kRecordCreatorNode; $check ]
    Set Field [ tagTable::match; "copyright" ]
    Perform Find [ ]
    #
    If [ Get (FoundCount) ≠ 0 ]
    If [ $inUse ≠ "" ]
    Set Variable [ $addToInUse; Value:$inUse ]
    If [ $TagsHeader ≠ "" ]
    Set Variable [ $inUse; Value:$addToInUse & ", copyright " & Get (FoundCount) ]
    Else
    Set Variable [ $inUse; Value:$addToInUse & "; Tags — copyright " & Get (FoundCount) ]
    End If
    Else If [ $inUse = "" ]
    Set Variable [ $inUse; Value:"Tags — copyright " & Get (FoundCount) ]
    End If
    Set Variable [ $TagsHeader; Value:1 ]
    Set Variable [ $inuseTags; Value:$inuseTags + 1 ]
    End If
    #
    #
    #
    #
    #
    #TAG KEYWORD
    #See if node is used by any test result records.
    #Check in primary...
    Go to Layout [ “tableTag” (tagTable) ]
    Enter Find Mode [ ]
    Set Field [ tagTable::kRecordCreatorNode; $check ]
    Set Field [ tagTable::match; "key" ]
    Perform Find [ ]
    #
    If [ Get (FoundCount) ≠ 0 ]
    If [ $inUse ≠ "" ]
    Set Variable [ $addToInUse; Value:$inUse ]
    If [ $TagsHeader ≠ "" ]
    Set Variable [ $inUse; Value:$addToInUse & ", key " & Get (FoundCount) ]
    Else
    Set Variable [ $inUse; Value:$addToInUse & "; Tags — key " & Get (FoundCount) ]
    End If
    Else If [ $inUse = "" ]
    Set Variable [ $inUse; Value:"Tags — key " & Get (FoundCount) ]
    End If
    Set Variable [ $TagsHeader; Value:1 ]
    Set Variable [ $inuseTags; Value:$inuseTags + 1 ]
    End If
    #
    #
    #
    #
    #
    #TAG NODE
    #See if node is used by any test result records.
    #Check in primary...
    Go to Layout [ “tableTag” (tagTable) ]
    Enter Find Mode [ ]
    Set Field [ tagTable::kRecordCreatorNode; $check ]
    Set Field [ tagTable::match; "node" ]
    #Omit creator nodes.
    Set Field [ tagTable::textStyleOrCreatorNodeFlag; "=" ]
    Perform Find [ ]
    #
    If [ Get (FoundCount) ≠ 0 ]
    If [ $inUse ≠ "" ]
    Set Variable [ $addToInUse; Value:$inUse ]
    If [ $TagsHeader ≠ "" ]
    Set Variable [ $inUse; Value:$addToInUse & ", node " & Get (FoundCount) ]
    Else
    Set Variable [ $inUse; Value:$addToInUse & "; Tags — node " & Get (FoundCount) ]
    End If
    Else If [ $inUse = "" ]
    Set Variable [ $inUse; Value:"Tags — node " & Get (FoundCount) ]
    End If
    Set Variable [ $TagsHeader; Value:1 ]
    Set Variable [ $inuseTags; Value:$inuseTags + 1 ]
    End If
    #
    #
    #
    #
    #
    #TAG PATH
    #See if node is used by any test result records.
    #Check in primary...
    Go to Layout [ “tableTag” (tagTable) ]
    Enter Find Mode [ ]
    Set Field [ tagTable::kRecordCreatorNode; $check ]
    Set Field [ tagTable::match; "path" ]
    Perform Find [ ]
    #
    If [ Get (FoundCount) ≠ 0 ]
    If [ $inUse ≠ "" ]
    Set Variable [ $addToInUse; Value:$inUse ]
    If [ $TagsHeader ≠ "" ]
    Set Variable [ $inUse; Value:$addToInUse & ", path " & Get (FoundCount) ]
    Else
    Set Variable [ $inUse; Value:$addToInUse & "; Tags — path " & Get (FoundCount) ]
    End If
    Else If [ $inUse = "" ]
    Set Variable [ $inUse; Value:"Tags — path " & Get (FoundCount) ]
    End If
    Set Variable [ $TagsHeader; Value:1 ]
    Set Variable [ $inuseTags; Value:$inuseTags + 1 ]
    End If
    #
    #
    #
    #
    #
    #TAG PUBLICATION
    #See if node is used by any test result records.
    #Check in primary...
    Go to Layout [ “tableTag” (tagTable) ]
    Enter Find Mode [ ]
    Set Field [ tagTable::kRecordCreatorNode; $check ]
    Set Field [ tagTable::match; "publication" ]
    Perform Find [ ]
    #
    If [ Get (FoundCount) ≠ 0 ]
    If [ $inUse ≠ "" ]
    Set Variable [ $addToInUse; Value:$inUse ]
    If [ $TagsHeader ≠ "" ]
    Set Variable [ $inUse; Value:$addToInUse & ", publication " & Get (FoundCount) ]
    Else
    Set Variable [ $inUse; Value:$addToInUse & "; Tags — publication " & Get (FoundCount) ]
    End If
    Else If [ $inUse = "" ]
    Set Variable [ $inUse; Value:"Tags — publication " & Get (FoundCount) ]
    End If
    Set Variable [ $TagsHeader; Value:1 ]
    Set Variable [ $inuseTags; Value:$inuseTags + 1 ]
    End If
    #
    #
    #
    #
    #
    #TAG PUBLISHER
    #See if node is used by any test result records.
    #Check in primary...
    Go to Layout [ “tableTag” (tagTable) ]
    Enter Find Mode [ ]
    Set Field [ tagTable::kRecordCreatorNode; $check ]
    Set Field [ tagTable::match; "publisher" ]
    Perform Find [ ]
    #
    If [ Get (FoundCount) ≠ 0 ]
    If [ $inUse ≠ "" ]
    Set Variable [ $addToInUse; Value:$inUse ]
    If [ $TagsHeader ≠ "" ]
    Set Variable [ $inUse; Value:$addToInUse & ", publisher " & Get (FoundCount) ]
    Else
    Set Variable [ $inUse; Value:$addToInUse & "; Tags — publisher " & Get (FoundCount) ]
    End If
    Else If [ $inUse = "" ]
    Set Variable [ $inUse; Value:"Tags — publisher " & Get (FoundCount) ]
    End If
    Set Variable [ $inuseTags; Value:$inuseTags + 1 ]
    End If
    #
    #
    #
    #
    #TEST SUBJECT — SECTION
    #See if node is the test subject for any
    #test section records created to test it.
    Go to Layout [ “tableTestSectionFromTemplate” (testSectionCreatedFromATemplate) ]
    Enter Find Mode [ ]
    Set Field [ testSectionCreatedFromATemplate::ktestSubjectNode; $check ]
    Perform Find [ ]
    If [ Get (FoundCount) ≠ 0 ]
    Set Variable [ $inUseTestSubject; Value:"Setup Test " & Get (FoundCount) ]
    End If
    #
    #
    #
    #
    #
    #TEST SUBJECT — RESULT
    #See if node is the test subject in any
    #test result records.
    Go to Layout [ “tableTestLearn” (testlearn) ]
    Enter Find Mode [ ]
    Set Field [ testlearn::ktestSubject; $check ]
    Perform Find [ ]
    If [ Get (FoundCount) ≠ 0 ]
    If [ $inUseTestSubject ≠ "" ]
    Set Variable [ $addToInUseTestSubject; Value:$inUseTestSubject ]
    Set Variable [ $inUseTestSubject; Value:$addToInUseTestSubject & ", Test Result " & Get (FoundCount) ]
    Else If [ $inUseTestSubject = "" ]
    Set Variable [ $inUseTestSubject; Value:"Test Result " & Get (FoundCount) ]
    End If
    End If
    #
    #
    #
    #
    #TEST SUBJECT — REPORT
    #See if node is the test subject in any
    #report records.
    #NOT NECESSARY to check on report, as
    #Report records are deleted when all test
    #results for a report section are deleted.
    // Go to Layout [ “tableReport” (report) ]
    // Enter Find Mode [ ]
    // Set Field [ report::ktestSubject; $check ]
    // Perform Find [ ]
    // If [ Get (FoundCount) ≠ 0 ]
    // If [ $inUseTestSubject ≠ "" ]
    // Set Variable [ $addToInUseTestSubject; Value:$inUseTestSubject ]
    // Set Variable [ $inUseTestSubject; Value:$addToInUseTestSubject & ", Report " & Get (FoundCount) ]
    // Else If [ $inUseTestSubject = "" ]
    // Set Variable [ $inUseTestSubject; Value:"Report " & Get (FoundCount) ]
    // End If
    // End If
    #
    #
    #
    #
    #Report on findings and if none delete node.
    Close Window [ Current Window ]
    #
    #
    #
    #
    #If the node being checked for deletion is in use
    #as a default node then stop the script and inform
    #the user of this fact.
    If [ TEMP::kdefaultNodePrimary = tagMenus::_Ltag ]
    Show Custom Dialog [ Message: "This node is currently selected as the default node (creator of all new records in this library ) and cannot be deleted."; Default Button: “OK”, Commit: “No” ]
    #In use as the primary node.
    Set Variable [ $primaryOtherOrTestSubjectNode; Value:1 ]
    Else If [ FilterValues ( TEMP::kdefaultNodeOther ; tagMenus::_Ltag & "¶" ) ]
    Show Custom Dialog [ Message: "This node is currently selected as a default other node (a co-creator of all new records in this library ) and cannot be deleted."; Default Button: “OK”, Commit: “No” ]
    #In use as an other node.
    Set Variable [ $primaryOtherOrTestSubjectNode; Value:1 ]
    Else If [ TEMP::kdefaultNodeTestSubject = tagMenus::_Ltag ]
    Show Custom Dialog [ Message: "This node is currently selected as the default test subject and cannot be deleted."; Default Button: “OK”, Commit: “No” ]
    #In use as the test subject node.
    Set Variable [ $primaryOtherOrTestSubjectNode; Value:1 ]
    End If
    #
    #
    #If the node is locked, tell the user, and include
    #all the other reasons the node might not be
    #able to be deleted, rather than making the user
    #fulfill one delete requirement only to learn of
    #another, and then another. Show all the
    #delete requirements at once!
    #
    #Check creator nodes, to see if they are
    #locked. NOTE: Creator nodes are created
    #themselves only on Setup Tag Menus
    #Node layouts.
    If [ tagMenus::orderOrLock[2] ≠ "" ]
    If [ $primaryOtherOrTestSubjectNode = "" ]
    #
    #NOT in use as a P, O, or TS node.
    Show Custom Dialog [ Message: "This node is locked. Click the lock button above, and enter its password to unlock it."; Default Button: “OK”, Commit: “No” ]
    Else
    #
    #IN USE as a P, O, or TS node.
    Show Custom Dialog [ Message: "And, this node cannot be deleted because it is locked. Click the lock button above, and enter its password to unlock it."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #This node is locked.
    Set Variable [ $locked; Value:1 ]
    #
    #Check nodes created by creator nodes
    #to see if their creator node is locked.
    Else If [ tagCreatorLock::orderOrLock ≠ "" ]
    Show Custom Dialog [ Message: "This record is locked. Go the node that created it — " & tagCreatorLock::tag & " — in the setup tag window and enter the password to unlock it."; Default Button: “OK”, Commit: “No” ]
    #
    #This node is locked because its creator node
    #is locked. NOTE: This locked variable just
    #tells the script below that the user has
    #already seen a locked message and so the
    #next message they see needs to begin with,
    #"Also, ...."
    Set Variable [ $locked; Value:1 ]
    End If
    #
    #
    #
    #If the node is found to have created records,
    #tell the user where they are, and that this
    #node cannot be deleted while records it
    #created remain in the library.
    If [ $inUse ≠ "" or $inUseTestSubject ≠ "" or $setupReference ≠ "" ]
    #
    #
    #Conditionally format the node record the
    #user is trying to delete to highlight which
    #node the following messages apply to.
    Set Variable [ $delete; Value:tagMenus::_Ltag ]
    Set Variable [ $group ]
    Refresh Window
    #
    #
    #
    #
    #NOT locked.
    #NOT in use as a P, O, or TS node.
    #So this will be the first "you cannot delete..."
    #message the user since this script started.
    If [ $primaryOtherOrTestSubjectNode = "" and $locked = "" ]
    #
    #
    #Node created library records.
    If [ $inUse ≠ "" ]
    Show Custom Dialog [ Message: Case ( $inuseTags = "" ; "This node tag is in use in " & Case ( Length ( Filter ( $inUse ; ";" ) ) = 0 ; "1 library section: " & $inUse & ". It cannot be deleted." ; Length ( Filter ( $inUse ; ";" ) ) & " library sections: " & $inUse & ". It cannot be deleted." ) ; "This node tag is in use in " & Case ( Length ( Filter ( $inUse ; ";" ) ) = 1 ; "1 library section and " & Case ( $inuseTags = 1 ; "1 tag menu: " & $inUse & "." ; $inuseTags & " tag menus:" & $inUse & ". It cannot be deleted." ) ; Length ( Filter ( $inUse ; ";" ) ) & " library sections and " & Case ( $inuseTags = 1 ; "1 tag menu: " & $inUse & "." ; $inuseTags & " tag menus: " & $inUse & ". It cannot be deleted." ) ) ); Default Button: “OK”, Commit: “Yes” ]
    #
    #AND test subject records where created
    #for this node.
    If [ $inUseTestSubject ≠ "" ]
    Show Custom Dialog [ Message: "And, test subject records created for this node must also be deleted: " & $inUseTestSubject & "."; Default Button: “OK”, Commit: “Yes” ]
    End If
    End If
    #
    #
    #ONLY test subject records where created
    #for this node.
    If [ $inUse = "" and $inUseTestSubject ≠ "" ]
    Show Custom Dialog [ Message: "Test subject records created for this node must be deleted before it can be deleted: " & $inUseTestSubject & "."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #
    End If
    #
    #
    #
    #
    #Locked, AND/OR,
    #IN USE as a P, O, or TS node.
    #So this will NOT be the first "you cannot
    #delete..." message the user since this
    #script started.
    If [ $primaryOtherOrTestSubjectNode ≠ "" or $locked ≠ "" ]
    #
    #
    #Node created library records.
    If [ $inUse ≠ "" ]
    Show Custom Dialog [ Message: Case ( $inuseTags = "" ; "Also, this node tag is in use in " & Case ( Length ( Filter ( $inUse ; ";" ) ) = 0 ; "1 library section: " & $inUse & "." ; Length ( Filter ( $inUse ; ";" ) ) & " library sections: " & $inUse & "." ) ; "Also, this node tag is in use in " & Case ( Length ( Filter ( $inUse ; ";" ) ) = 1 ; "1 library section and " & Case ( $inuseTags = 1 ; "1 tag menu: " & $inUse & "." ; $inuseTags & " tag menus:" & $inUse & "." ) ; Length ( Filter ( $inUse ; ";" ) ) & " library sections and " & Case ( $inuseTags = 1 ; "1 tag menu: " & $inUse & "." ; $inuseTags & " tag menus: " & $inUse & "." ) ) ); Default Button: “OK”, Commit: “Yes” ]
    #
    #AND test subject records where created
    #for this node.
    If [ $inUseTestSubject ≠ "" ]
    Show Custom Dialog [ Message: "And, test subject records created for this node must also be deleted: " & $inUseTestSubject & "."; Default Button: “OK”, Commit: “Yes” ]
    End If
    End If
    #
    #
    #ONLY test subject records where created
    #for this node.
    If [ $inUse = "" and $inUseTestSubject ≠ "" ]
    Show Custom Dialog [ Message: "Also, test subject records created for this node must be deleted before it can be deleted: " & $inUseTestSubject & "."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #
    End If
    #
    #
    #
    #
    #If the node was used to create one or
    #more library setup reference records
    #tell the user this:
    If [ $setupReference ≠ "" ]
    #
    #
    #NOT locked.
    #NOT in use as a P, O, or TS node.
    #Creator of ZERO records.
    #This will be the first "you cannot delete..."
    #message the user since this script started.
    If [ $primaryOtherOrTestSubjectNode = "" and $locked = "" and $inUse = "" and $inUseTestSubject = "" ]
    If [ $foundCount = 1 ]
    Show Custom Dialog [ Message: "This node has been used to create the following library setup reference in the Setup window, which must deleted before deleting this node: " & $setupReference; Default Button: “OK”, Commit: “Yes” ]
    Show Custom Dialog [ Message: "This reference giving it credit for setting up this library should definitially be deleted since this node hasn't created any records in this library."; Default Button: “OK”, Commit: “Yes” ]
    Else If [ $foundCount = 2 ]
    Show Custom Dialog [ Message: "This node has been used to create the following library setup reference, and 1 other, in the Setup window. Both must deleted before deleting this node: " & $setupReference; Default Button: “OK”, Commit: “No” ]
    Show Custom Dialog [ Message: "This reference giving it credit for setting up this library should definitially be deleted since this node hasn't created any records in this library."; Default Button: “OK”, Commit: “Yes” ]
    Else If [ $foundCount > 2 ]
    Show Custom Dialog [ Message: "This node has been used to create the following library setup reference, and " & $foundCount & " others, in the Setup window. They must deleted before deleting this node: " & $setupReference; Default Button: “OK”, Commit: “No” ]
    Show Custom Dialog [ Message: "This reference giving it credit for setting up this library should definitially be deleted since this node hasn't created any records in this library."; Default Button: “OK”, Commit: “Yes” ]
    End If
    End If
    #
    #
    #Locked, AND/OR,
    #IN USE as a P, O, or TS node, AND/OR,
    #Creator of SOME library records.
    #So this will NOT be the first "you cannot
    #delete..." message the user since this
    #script started.
    If [ $primaryOtherOrTestSubjectNode ≠ "" or $locked ≠ "" or $inUse ≠ "" or $inUseTestSubject ≠ "" ]
    If [ $foundCount = 1 ]
    #
    #
    Show Custom Dialog [ Message: "And finally, this node has been used to create the following library setup reference in the Setup window, which must deleted before deleting this node: " & $setupReference; Default Button: “OK”, Commit: “Yes” ]
    #Creator of ZERO records (so node is locked
    #and/or a P, 0, or TS node).
    If [ $inUse = "" and $inUseTestSubject = "" ]
    Show Custom Dialog [ Message: "This reference giving it credit for setting up this library should definitially be deleted since this node hasn't created any records in this library."; Default Button: “OK”, Commit: “No” ]
    End If
    #
    #
    Else If [ $foundCount = 2 ]
    #
    #
    Show Custom Dialog [ Message: "And finally, this node has been used to create the following library setup reference, and 1 other, in the Setup window. Both must deleted before deleting this node: " & $setupReference; Default Button: “OK”, Commit: “Yes” ]
    #Creator of ZERO records (so node is locked
    #and/or a P, 0, or TS node).
    If [ $inUse = "" and $inUseTestSubject = "" ]
    Show Custom Dialog [ Message: "This reference giving it credit for setting up this library should definitially be deleted since this node hasn't created any records in this library."; Default Button: “OK”, Commit: “No” ]
    End If
    #
    #
    Else If [ $foundCount > 2 ]
    #
    #
    Show Custom Dialog [ Message: "And finally, this node has been used to create the following library setup reference, and " & $foundCount & " others, in the Setup window. They must deleted before deleting this node: " & $setupReference; Default Button: “OK”, Commit: “Yes” ]
    #Creator of ZERO records (so node is locked
    #and/or a P, 0, or TS node).
    If [ $inUse = "" and $inUseTestSubject = "" ]
    Show Custom Dialog [ Message: "This reference giving it credit for setting up this library should definitially be deleted since this node hasn't created any records in this library."; Default Button: “OK”, Commit: “No” ]
    End If
    #
    #
    End If
    End If
    #
    #
    End If
    #
    #
    #
    #
    #Remove conditional formatting highlight of
    #the node record the user was trying to delete.
    Set Variable [ $delete ]
    Set Variable [ $$addTagToCitation ]
    Set Variable [ $$stopLoadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    Refresh Window
    #
    #
    End If
    #
    #
    #
    If [ $primaryOtherOrTestSubjectNode ≠ "" or $locked ≠ "" or $inUse ≠ "" or $inUseTestSubject ≠ "" or $setupReference ≠ "" ]
    Halt Script
    End If
    #
    #
    #If the node being deleted was not found in
    #use then make sure the user really wants
    #it deleted.
    If [ $inUse = "" ]
    #
    #If node is this library's creator
    #tell user this and exit the script.
    If [ $lastSectionCreatorNode = 1 ]
    Show Custom Dialog [ Message: "This node is the creator of this library. It cannot be deleted."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #If the node being deleted was not found in
    #use in any sections of the database then before
    #deleting it make sure the user really wants it deleted.
    Set Variable [ $group ]
    Refresh Window
    Show Custom Dialog [ Message: "Delete current node?"; Default Button: “cancel”, Commit: “No”; Button 2: “delete”, Commit: “No” ]
    Set Variable [ $group; Value:tagMenus::kGroupOrTest ]
    Set Variable [ $deleteGroup; Value:tagMenuGroup::name ]
    #
    #If the user cancels, stop the delete.
    If [ Get ( LastMessageChoice ) = 1 ]
    Go to Field [ ]
    Set Variable [ $delete ]
    Set Variable [ $group ]
    Refresh Window
    Set Variable [ $$addTagToCitation ]
    Set Variable [ $$stopLoadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    Exit Script [ ]
    #
    #If the user says yes, first make sure the record
    #is not the last record in a group. If it is and
    #the system deleted the record without deleting
    #the group too, this group would become
    #an orphan as only categories that have records
    #attached to them show up for the user to add
    #more records uner them. So the group
    #record must also be deleted if this is the last
    #record under it.
    Else If [ Get ( LastMessageChoice ) = 2 ]
    New Window [ Name: "delete tag"; Height: 1; Width: 1; Top: -10000; Left: -10000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “tableTag” (tagTable) ]
    Enter Find Mode [ ]
    Set Field [ tagTable::kGroupOrTest; $group ]
    Perform Find [ ]
    #
    #If there are more records under this cateogry
    #then the system deletes the current record without
    #any more user input.
    If [ Get (FoundCount) ≠ 1 ]
    Close Window [ Name: "Delete Tag"; Current file ]
    Delete Record/Request [ No dialog ]
    Set Variable [ $delete ]
    Set Variable [ $group ]
    #
    #Capture recordID to conditionally format current record.
    Set Variable [ $$tagRecordID; Value:Get (RecordID) ]
    #
    #Get reference groups and references order
    #number in case user changes it.
    Set Variable [ $$refGroupOrderNumber; Value:tagKeywordPrimary::orderOrLock ]
    Set Variable [ $$refOrderNumber; Value:reference::publicationYearOrStuffOrderNumber ]
    #
    #Get tag's copyright key for 'select' button
    #in case this node is locked, and the copyright
    #has to be put back to the orginal after the
    #user is informed they cannot change a locked
    #record's copyright.
    Set Variable [ $$oldCopyright; Value:tagMenus::notesOrCopyright ]
    #
    Refresh Window
    Set Variable [ $$addTagToCitation ]
    Set Variable [ $$stopLoadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    Exit Script [ ]
    #
    #BUT if only one record is found user is asked
    #if they want to delete the group too.
    Else If [ Get (FoundCount) = 1 ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    #
    #The records are sorted by group to show
    #the user which group is going to be deleted.
    If [ TEMP::sortKey ≠ "cat" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    End If
    Show Custom Dialog [ Message: "Deleting " & $deleteName & " will also delete its group — " & $deleteGroup & " — as it is the last tag in this group."; Default Button: “Cancel”, Commit: “Yes”; Button 2: “Delete”, Commit: “No” ]
    #
    #If the user says yes, then delete both the tag and
    #the group record.
    If [ Get ( LastMessageChoice ) = 2 ]
    #
    #Delete tag.
    Delete Record/Request [ No dialog ]
    #
    #Delete group.
    Select Window [ Name: "delete tag"; Current file ]
    Go to Layout [ “tableTagGroup” (testSubsectionGroup) ]
    Enter Find Mode [ ]
    Set Field [ testSubsectionGroup::_Lgroup; $group ]
    Perform Find [ ]
    Delete Record/Request [ No dialog ]
    End If
    End If
    End If
    Close Window [ Name: "Delete Tag"; Current file ]
    Set Variable [ $delete ]
    Set Variable [ $group ]
    #
    #Capture recordID to conditionally format current record.
    Set Variable [ $$tagRecordID; Value:Get (RecordID) ]
    #
    #Get group ID for 'move' button script.
    Set Variable [ $$groupOLD; Value:tagMenus::kGroupOrTest ]
    #
    #Get reference groups and references order
    #number in case user changes it.
    Set Variable [ $$refGroupOrderNumber; Value:tagKeywordPrimary::orderOrLock ]
    Set Variable [ $$refOrderNumber; Value:reference::publicationYearOrStuffOrderNumber ]
    #
    #Get tag's copyright key for 'select' button
    #in case this node is locked, and the copyright
    #has to be put back to the orginal after the
    #user is informed they cannot change a locked
    #record's copyright.
    Set Variable [ $$oldCopyright; Value:tagMenus::notesOrCopyright ]
    #
    Refresh Window
    Set Variable [ $$addTagToCitation ]
    Set Variable [ $$stopLoadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    End If
    #
    #

Fields used in this script

    tagMenus::_Ltag
    tagMenus::tag
    tagMenus::kGroupOrTest
    tagMenuGroup::name
    testSubsectionGroup::match
    testSubsectionGroup::kRecordCreatorNode
    testSubsectionGroup::ReportCaptionORLibraryCreatorName
    testSubsectionGroup::nameSpellingFORTestItemGroup
    librarySetupReferenceMain::kcreatorNode
    librarySetupReferenceMain::name
    librarySetupReferenceMain::creatorName
    testlearn::kNodePrimary
    testlearn::filterFind
    testlearn::kNodeOther
    reference::knodePrimary
    reference::knodeOther
    testSectionCreatedFromATemplate::kcreatorNode
    testlearn::kRecordCreatorNode
    tagTable::kRecordCreatorNode
    tagTable::match
    testSubsectionTemplate::kcreatorNode
    tagTable::textStyleOrCreatorNodeFlag
    testSectionCreatedFromATemplate::ktestSubjectNode
    testlearn::ktestSubject
    report::ktestSubject
    TEMP::kdefaultNodePrimary
    TEMP::kdefaultNodeOther
    TEMP::kdefaultNodeTestSubject
    tagMenus::orderOrLock
    tagCreatorLock::orderOrLock
    tagCreatorLock::tag
    tagTable::kGroupOrTest
    tagKeywordPrimary::orderOrLock
    reference::publicationYearOrStuffOrderNumber
    tagMenus::notesOrCopyright
    TEMP::sortKey
    tagMenuGroup::orderOrLibraryType
    testSubsectionGroup::_Lgroup

Scripts used in this script

    deleteKeywordTag

Layouts used in this script

    tableTagGroup
    tableSetupReference
    tableTestLearn
    Reference
    tableTestSectionFromTemplate
    tableTag
    tableTestSubsectionTemplates
    tableReport

Tables used in this script

    TEMP
    reference
    report
    setupReference
    tag
    tag
    tagGroup
    tagGroup
    testSectionCreatedFromATemplate
    testSubsectionTemplate
    testlearn

Table occurrences used by this script

    TEMP
    librarySetupReferenceMain
    reference
    report
    tagCreatorLock
    tagKeywordPrimary
    tagMenuGroup
    tagMenus
    tagTable
    testSectionCreatedFromATemplate
    testSubsectionGroup
    testSubsectionTemplate
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [deleteNodeTag]	Parent Folder: [tagMenu]	Next Script: [findKeyOtherRef]
Script Name	duplicateBrainstorm
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    learnMenuBrainstorm
    learnMenuStuffBrainstorm

Scripts that use this script

Script Definition
Script Steps

    #
    #If node is currenlty locked then stop script,
    #and inform the user.
    Go to Field [ ]
    Perform Script [ “stopNewRecordsBeingCreatedByLockedNode” ]
    #
    If [ tempSetup::kdefaultNodePrimary = "" ]
    Show Custom Dialog [ Message: "Select yourself (the node responsible) from Tag Menus window."; Default Button: “OK”, Commit: “No” ]
    Halt Script
    End If
    #
    #So instead of asking the user if they really
    #want to duplicate a tag, which makes a user
    #seem stupid, this question performs the
    #same function (are you sure) by asking them
    #if they want to include a version number or
    #not in their duplicate or cancel this script.
    If [ TEMP::InventoryLibraryYN = "" ]
    Show Custom Dialog [ Message: "Add verson number (v2, v3, v4, etc.) placeholder ' v# ' for you to help tell duplicate brainstorms apart? NOTE: If there is already a version# click 'no' and update the existing #."; Default Button: “yes”, Commit: “Yes”; Button 2: “no”, Commit: “No”; Button 3: “cancel”, Commit: “No” ]
    Else
    Show Custom Dialog [ Message: "Add verson number (v2, v3, v4, etc.) placeholder ' v# ' for you to help tell duplicate inventory lists apart? NOTE: If there is already a version# click 'no' and update the existing #."; Default Button: “yes”, Commit: “Yes”; Button 2: “no”, Commit: “No”; Button 3: “cancel”, Commit: “No” ]
    End If
    #
    #Exit script if user clicks cancel.
    If [ Get ( LastMessageChoice ) = 3 ]
    Exit Script [ ]
    End If
    #
    #Either get just the current brainstorm's name
    #or get the name plus add a v# to the end of it
    #for the duplicate record.
    If [ Get ( LastMessageChoice ) = 2 ]
    Set Variable [ $brainstormName; Value:tagMenus::tag ]
    Else
    Set Variable [ $brainstormName; Value:tagMenus::tag & ", v?" ]
    End If
    #
    Set Variable [ $brainstormCopyright; Value:tagMenus::notesOrCopyright ]
    #
    #Prepare to find old tags at bottom of script.
    Set Variable [ $brainstormOld; Value:tagMenus::_Ltag ]
    #
    #Stop spelling check script.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    New Record/Request
    Set Field [ tagMenus::kGroupOrTest; GetNthRecord ( tagMenus::kGroupOrTest ; Get (RecordNumber) - 1 ) ]
    Set Field [ tagMenus::kRecordCreatorNode; TEMP::kdefaultNodePrimary ]
    Set Field [ tagMenus::tag; $brainstormName ]
    Set Field [ tagMenus::tagSpelling; $brainstormName ]
    Set Field [ tagMenus::notesOrCopyright; $brainstormCopyright ]
    #
    #Prepare to add new brainstorm key to orignal
    #brainstorms tagged learn records.
    Set Variable [ $brainstormNew; Value:tagMenus::_Ltag ]
    Set Field [ tagMenus::match; "brainstorm" ]
    #
    #Open a new window to now add the key to
    #tagged learn records.
    New Window [ Height: 3; Width: 3; Top: -1000; Left: -1000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Set Variable [ $$stoploadCitation; Value:1 ]
    Go to Layout [ “learn2” (testlearn) ]
    #
    #Find tagged learn records if there are any.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    Enter Find Mode [ ]
    Set Field [ testlearn::kcbrainstorm; "*" & $brainstormOld & ¶ ]
    Perform Find [ ]
    #
    #Add new brainstorm key to original brainstorm's
    #tagged learn records.
    Go to Record/Request/Page [ First ]
    Loop
    Set Variable [ $allPointsEvidence; Value:testlearn::kcbrainstorm ]
    Set Field [ testlearn::kcbrainstorm; testlearn::orderTestInformation & $brainstormNew & ¶ & $allPointsEvidence ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    Set Variable [ $$stoploadCitation ]
    Set Variable [ $$brainstorm; Value:testlearn::kcbrainstorm ]
    Close Window [ Current Window ]
    #
    #Load new brainstorm.
    Set Variable [ $$tagbrainstorm; Value:tagMenus::_Ltag ]
    Set Field [ TEMP::kcbrainstorm; tagMenus::_Ltag ]
    If [ $$atLeastOneRecord ≠ "" ]
    Set Variable [ $$atLeastOneRecord; Value:tagMenus::_Ltag ]
    End If
    Set Variable [ $$BrainstormOrTestID; Value:Get (RecordID) ]
    Commit Records/Requests
    Refresh Window
    Set Variable [ $$stopLoadTagRecord ]
    Scroll Window [ Home ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::name; ascending tagMenus::tag; ascending ] [ Restore; No dialog ]
    Go to Field [ tagMenus::tag ]
    #

Fields used in this script

    tempSetup::kdefaultNodePrimary
    TEMP::InventoryLibraryYN
    tagMenus::tag
    tagMenus::notesOrCopyright
    tagMenus::_Ltag
    tagMenus::kGroupOrTest
    TEMP::kdefaultNodePrimary
    tagMenus::kRecordCreatorNode
    tagMenus::tagSpelling
    tagMenus::match
    testlearn::kcbrainstorm
    testlearn::orderTestInformation
    TEMP::kcbrainstorm
    tagMenuGroup::name

Scripts used in this script

    stopNewRecordsBeingCreatedByLockedNode

Layouts used in this script

    learn2

Tables used in this script

    TEMP
    TEMP
    tag
    tagGroup
    testlearn

Table occurrences used by this script

    TEMP
    tagMenuGroup
    tagMenus
    tempSetup
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [duplicateBrainstorm]	Parent Folder: [tagMenu]	Next Script: [findKeyOtherTL]
Script Name	findKeyOtherRef
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferenceMenu2keywordOrNodeFind

Scripts that use this script

Script Definition
Script Steps

    #Select tag to be found.
    Set Variable [ $tag; Value:tagMenus::_Ltag ]
    #
    #
    #Select the kind of tag to be found. We grab
    #only the first three letters because the shortest
    #menu item 'key' has only three letters, and because
    #we need the same number of characters/letters
    #to make up this variable so when it is added to
    #the first part of an item in the found list below
    #it can be removed by the system which only
    #can be told how many characters to remove.
    #This variable is thus a meta tag added to an
    #ID number to tell the system from which menu
    #did this item come. This meta tag or tag allows
    #us to make a list of ID numbers from various
    #tag menus: key, node, medium, etc.
    Set Variable [ $menu; Value:Left ( $$citationMatch ; 1 ) ]
    #
    #Get the name of the tag for error message
    #at bottom of this script if needed.
    Set Variable [ $name; Value:tagMenus::tag ]
    #
    #As going to the other window will be involved
    #stop the record load script on that window until
    #this script is finished to speed things up and
    #stop flashing effect.
    Set Variable [ $$stoploadCitation; Value:1 ]
    #
    #Go to the other window and start the find process.
    Select Window [ Name: "References"; Current file ]
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    Enter Find Mode [ ]
    // Set Field [ reference::filterFind; "main" & ¶ ]
    #
    #
    If [ $$citationMatch = "key" ]
    Set Field [ reference::kkeywordOther; $tag ]
    Else If [ $$citationMatch = "node" ]
    Set Field [ reference::knodeOther; $tag ]
    End If
    #
    #
    #If this is the first find, note this and perform
    #the find.
    If [ $$firstFindOther = "" ]
    Set Variable [ $$firstFindOther; Value:1 ]
    Set Variable [ $$foundOther; Value:$menu & $tag & ¶ ]
    Perform Find [ ]
    #
    #If nothing was found capture the error message
    #as steps before showing the error message will
    #delete it from the system and we need it to
    #activate the error message below if there was
    #an error.
    Set Variable [ $error; Value:Get (LastError) ]
    #
    #If this is not the first find and the item that
    #the user clicked on to start this script has
    #not already been found, then add items tagged
    #with it to the current set of found records.
    Else If [ $$firstFindOther = 1 ]
    If [ $menu & $tag & ¶ ≠ FilterValues ( $$foundOther ; $menu & $tag) ]
    Extend Found Set [ ]
    #
    #If nothing was found capture the error message
    #as steps before showing the error message will
    #delete it from the system and we need it to
    #activate the error message below if there was
    #an error.
    Set Variable [ $error; Value:Get (LastError) ]
    #
    #Add the tag from the list of found tagged records.
    Set Variable [ $found; Value:$$foundOther ]
    Set Variable [ $$foundOther; Value:$menu & $tag & ¶ & $found ]
    #
    #If this is not the first find and the item that
    #the user clicked on to start this script has
    #already been found, then remove tag from the
    #the list of found other tagged records.
    Else If [ $menu & $tag & ¶= FilterValues ( $$foundOther ; $menu & $tag & ¶) ]
    Set Variable [ $found; Value:$$foundOther ]
    Set Variable [ $$foundOther; Value:Substitute ( $found ; $menu & $tag & ¶ ; "" ) ]
    #
    #Enter browse mode to clear the find selections
    #set at the beginning of this script.
    Enter Browse Mode
    #
    #If after removing this item from the list of found other
    #tagged records the list is empty, perform a find
    #that will result in zero records being found
    #to reflect the fact that the user currently has
    #an empty found other list.
    If [ $$foundOther = "" ]
    Set Variable [ $$firstFindOther ]
    Enter Find Mode [ ]
    #
    #
    #Since ID numbers are numbers, the text
    #'findnoRecords' entered in the ID field will result
    #in zero records being found.
    Set Field [ reference::kkeywordPrimary; "findNoRecords" & ¶ ]
    #
    #
    Perform Find [ ]
    #
    #If after removing this item from the $$foundOther
    #list, the list is not empty, refind all records
    #still on the list one tag at a time.
    Else If [ $$foundOther ≠ "" ]
    #
    #Create a copy of the found list. Items will be
    #removed from this one at a time as they are found.
    Set Variable [ $findList; Value:$$foundOther ]
    #
    #Get the menu item name so system will know
    #what field to put the ID number into to find
    #records tagged with this item.
    Set Variable [ $menu; Value:Left ( ( GetValue ( $findList ; 1 ) ) ; 1 ) ]
    #
    #Get the ID number of the tag to be found.
    #(the number 42 is a joke, essentially the number
    #needs to be big enough to capture the full ID number
    #which is much shorter, but overkill doesn't hurt)
    #FYI: joke is from Hitchhiker's Guide to the Galaxy
    Set Variable [ $find; Value:Middle ( ( GetValue ( $findList ; 1 ) ) ; 2 ; 42 ) ]
    #
    #Remove it from the list of tags to be found.
    Set Variable [ $subtract; Value:$findList ]
    Set Variable [ $findList; Value:Substitute ( $subtract ; $menu & $find & ¶ ; "" ) ]
    #
    #Find main window records tagged with it.
    Enter Find Mode [ ]
    // Set Field [ reference::filterFind; "main" & ¶ ]
    #
    #
    If [ $menu = "k" ]
    Set Field [ reference::kkeywordOther; $find ]
    Else If [ $menu = "n" ]
    Set Field [ reference::knodeOther; $find ]
    End If
    #
    #
    #If there is more than one item on the $$found
    #list, then find the rest of records tagged with
    #this items/tags.
    Perform Find [ ]
    Loop
    #
    #When the list is empty stop finding stuff.
    Exit Loop If [ ValueCount ( $findList ) = 0 ]
    #
    #Get the menu item name so system will know
    #what field to put the ID number into to find
    #records tagged with this item.
    Set Variable [ $menu; Value:Left ( ( GetValue ( $findList ; 1 ) ) ; 1 ) ]
    #
    #Get the ID number of the tag to be found.
    Set Variable [ $find; Value:Middle ( ( GetValue ( $findList ; 1 ) ) ; 2; 42 ) ]
    #
    #Remove it from the list of tags to be found.
    Set Variable [ $subtract; Value:$findList ]
    Set Variable [ $findList; Value:Substitute ( $subtract ; $menu & $find & ¶ ; "" ) ]
    #
    #Find main window records tagged with it.
    Enter Find Mode [ ]
    // Set Field [ reference::filterFind; "main" & ¶ ]
    #
    #
    If [ $menu = "k" ]
    Set Field [ reference::kkeywordOther; $find ]
    Else If [ $menu = "n" ]
    Set Field [ reference::knodeOther; $find ]
    End If
    #
    #
    Extend Found Set [ ]
    End Loop
    End If
    End If
    End If
    #
    #Refind primary items.
    If [ $$found ≠ "" ]
    #
    #Create a copy of the found list. Items will be
    #removed from this one at a time as they are found.
    Set Variable [ $findList; Value:$$found ]
    #
    #Get the menu item name so system will know
    #what field to put the ID number into to find
    #records tagged with this item.
    Set Variable [ $menu; Value:Left ( ( GetValue ( $findList ; 1 ) ) ; 1 ) ]
    #
    #Get the ID number of the tag to be found.
    #(the number 42 is a joke, essentially the number
    #needs to be big enough to capture the full ID number
    #which is much shorter, but overkill doesn't hurt)
    #FYI: joke is from Hitchhiker's Guide to the Galaxy
    Set Variable [ $find; Value:Middle ( ( GetValue ( $findList ; 1 ) ) ; 2 ; 42 ) ]
    #
    #Remove it from the list of tags to be found.
    Set Variable [ $subtract; Value:$findList ]
    Set Variable [ $findList; Value:Substitute ( $subtract ; $menu & $find & ¶ ; "" ) ]
    #
    #Find main window records tagged with it.
    Enter Find Mode [ ]
    // Set Field [ reference::filterFind; "main" & ¶ ]
    #
    #
    If [ $menu = "k" ]
    Set Field [ reference::kkeywordPrimary; $find ]
    Else If [ $menu = "n" ]
    Set Field [ reference::knodePrimary; $find ]
    End If
    #
    #
    Extend Found Set [ ]
    #
    #If there is more than one item on the $$found
    #list, then find the rest of records tagged with
    #this items/tags.
    Loop
    #
    #When the list is empty stop finding stuff.
    Exit Loop If [ ValueCount ( $findList ) = 0 ]
    #
    #Get the menu item name so system will know
    #what field to put the ID number into to find
    #records tagged with this item.
    Set Variable [ $menu; Value:Left ( ( GetValue ( $findList ; 1 ) ) ; 1 ) ]
    #
    #Get the ID number of the tag to be found.
    Set Variable [ $find; Value:Middle ( ( GetValue ( $findList ; 1 ) ) ; 2 ; 42 ) ]
    #
    #Remove it from the list of tags to be found.
    Set Variable [ $subtract; Value:$findList ]
    Set Variable [ $findList; Value:Substitute ( $subtract ; $menu & $find & ¶ ; "" ) ]
    #
    #Find main window records tagged with it.
    Enter Find Mode [ ]
    // Set Field [ reference::filterFind; "main" & ¶ ]
    #
    #
    If [ $menu = "k" ]
    Set Field [ reference::kkeywordPrimary; $find ]
    Else If [ $menu = "n" ]
    Set Field [ reference::knodePrimary; $find ]
    End If
    #
    #
    Extend Found Set [ ]
    End Loop
    End If
    #
    #Sort according to current sort in Main window.
    Sort Records [ ] [ No dialog ]
    #
    #Go to first record and preform record load script.
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    Set Variable [ $$stoploadCitation ]
    Perform Script [ “loadLearnOrRefMainRecord” ]
    #
    #Return to Tag Menus window.
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    #If no records where found tell user why and
    #remove tag ID from list of tags attached to records
    #in the main window.
    If [ $error = 401 ]
    If [ $$firstFind = "" ]
    Set Variable [ $$foundOther ]
    Else If [ $$firstFind ≠ "" ]
    Set Variable [ $$foundOther; Value:Substitute ( $found ; $menu & $tag & ¶ ; "" ) ]
    End If
    Refresh Window
    #
    #
    If [ $$citationMatch = "key" ]
    Show Custom Dialog [ Message: "'" & $name & "'" & " is not in use as an other keyword."; Default Button: “OK”, Commit: “Yes” ]
    Else If [ $$citationMatch = "node" ]
    Show Custom Dialog [ Message: "'" & $name & "'" & " is not in use as an other node."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #
    End If

Fields used in this script

    tagMenus::_Ltag
    tagMenus::tag
    reference::filterFind
    reference::kkeywordOther
    reference::knodeOther
    reference::kkeywordPrimary
    reference::knodePrimary

Scripts used in this script

    loadLearnOrRefMainRecord

Layouts used in this script

Tables used in this script

    reference
    tag

Table occurrences used by this script

    reference
    tagMenus

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [findKeyOtherRef]	Parent Folder: [tagMenu]	Next Script: [findMode]
Script Name	findKeyOtherTL
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    learnKeywordOrNodeFind
    learnKeywordOrNodeSFind

Scripts that use this script

Script Definition
Script Steps

    #Select tag to be found.
    Set Variable [ $tag; Value:tagMenus::_Ltag ]
    #
    #
    #Select the kind of tag to be found. We grab
    #only the first three letters because the shortest
    #menu item 'key' has only three letters, and because
    #we need the same number of characters/letters
    #to make up this variable so when it is added to
    #the first part of an item in the found list below
    #it can be removed by the system which only
    #can be told how many characters to remove.
    #This variable is thus a meta tag added to an
    #ID number to tell the system from which menu
    #did this item come. This meta tag or tag allows
    #us to make a list of ID numbers from various
    #tag menus: key, node, medium, etc.
    Set Variable [ $menu; Value:Left ( $$citationMatch ; 1 ) ]
    #
    #Get the name of the tag for error message
    #at bottom of this script if needed.
    Set Variable [ $name; Value:tagMenus::tag ]
    #
    #As going to the other window will be involved
    #stop the record load script on that window until
    #this script is finished to speed things up and
    #stop flashing effect.
    Set Variable [ $$stoploadCitation; Value:1 ]
    #
    #Go to the other window and start the find process.
    Select Window [ Name: "Learn"; Current file ]
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    Enter Find Mode [ ]
    // Set Field [ testlearn::filterFind; "main" & ¶ ]
    #
    #
    If [ $$citationMatch = "key" ]
    Set Field [ testlearn::kcKeywordOther; $tag ]
    Else If [ $$citationMatch = "node" ]
    Set Field [ testlearn::kNodeOther; $tag ]
    End If
    #
    #
    #If this is the first find, note this and perform
    #the find.
    If [ $$firstFindOther = "" ]
    Set Variable [ $$firstFindOther; Value:1 ]
    Set Variable [ $$foundOther; Value:$menu & $tag & ¶ ]
    Perform Find [ ]
    #
    #If nothing was found capture the error message
    #as steps before showing the error message will
    #delete it from the system and we need it to
    #activate the error message below if there was
    #an error.
    Set Variable [ $error; Value:Get (LastError) ]
    #
    #If this is not the first find and the item that
    #the user clicked on to start this script has
    #not already been found, then add items tagged
    #with it to the current set of found records.
    Else If [ $$firstFindOther = 1 ]
    If [ $menu & $tag & ¶ ≠ FilterValues ( $$foundOther ; $menu & $tag) ]
    Extend Found Set [ ]
    #
    #If nothing was found capture the error message
    #as steps before showing the error message will
    #delete it from the system and we need it to
    #activate the error message below if there was
    #an error.
    Set Variable [ $error; Value:Get (LastError) ]
    #
    #Add the tag from the list of found tagged records.
    Set Variable [ $found; Value:$$foundOther ]
    Set Variable [ $$foundOther; Value:$menu & $tag & ¶ & $found ]
    #
    #If this is not the first find and the item that
    #the user clicked on to start this script has
    #already been found, then remove tag from the
    #the list of found other tagged records.
    Else If [ $menu & $tag & ¶= FilterValues ( $$foundOther ; $menu & $tag & ¶) ]
    Set Variable [ $found; Value:$$foundOther ]
    Set Variable [ $$foundOther; Value:Substitute ( $found ; $menu & $tag & ¶ ; "" ) ]
    #
    #Enter browse mode to clear the find selections
    #set at the beginning of this script.
    Enter Browse Mode
    #
    #If after removing this item from the list of found other
    #tagged records the list is empty, perform a find
    #that will result in zero records being found
    #to reflect the fact that the user currently has
    #an empty found other list.
    If [ $$foundOther = "" ]
    Set Variable [ $$firstFindOther ]
    Enter Find Mode [ ]
    #
    #
    #Since ID numbers are numbers, the text
    #'findnoRecords' entered in the ID field will result
    #in zero records being found.
    If [ $$citationMatch = "key" ]
    Set Field [ testlearn::kcKeywordOther; "findNoRecords" & ¶ ]
    Else If [ $$citationMatch = "node" ]
    Set Field [ testlearn::kNodeOther; "findNoRecords" & ¶ ]
    End If
    #
    #
    Perform Find [ ]
    #
    #If after removing this item from the $$foundOther
    #list, the list is not empty, refind all records
    #still on the list one tag at a time.
    Else If [ $$foundOther ≠ "" ]
    #
    #Create a copy of the found list. Items will be
    #removed from this one at a time as they are found.
    Set Variable [ $findList; Value:$$foundOther ]
    #
    #Get the menu item name so system will know
    #what field to put the ID number into to find
    #records tagged with this item.
    Set Variable [ $menu; Value:Left ( ( GetValue ( $findList ; 1 ) ) ; 1 ) ]
    #
    #Get the ID number of the tag to be found.
    #(the number 42 is a joke, essentially the number
    #needs to be big enough to capture the full ID number
    #which is much shorter, but overkill doesn't hurt)
    #FYI: joke is from Hitchhiker's Guide to the Galaxy
    Set Variable [ $find; Value:Middle ( ( GetValue ( $findList ; 1 ) ) ; 2 ; 42 ) ]
    #
    #Remove it from the list of tags to be found.
    Set Variable [ $subtract; Value:$findList ]
    Set Variable [ $findList; Value:Substitute ( $subtract ; $menu & $find & ¶ ; "" ) ]
    #
    #Find main window records tagged with it.
    Enter Find Mode [ ]
    Set Field [ testlearn::filterFind; "main" & ¶ ]
    #
    #
    If [ $menu = "k" ]
    Set Field [ testlearn::kcKeywordOther; $find ]
    Else If [ $menu = "n" ]
    Set Field [ testlearn::kNodeOther; $find ]
    End If
    #
    #
    #If there is more than one item on the $$found
    #list, then find the rest of records tagged with
    #this items/tags.
    Perform Find [ ]
    Loop
    #
    #When the list is empty stop finding stuff.
    Exit Loop If [ ValueCount ( $findList ) = 0 ]
    #
    #Get the menu item name so system will know
    #what field to put the ID number into to find
    #records tagged with this item.
    Set Variable [ $menu; Value:Left ( ( GetValue ( $findList ; 1 ) ) ; 1 ) ]
    #
    #Get the ID number of the tag to be found.
    Set Variable [ $find; Value:Middle ( ( GetValue ( $findList ; 1 ) ) ; 2; 42 ) ]
    #
    #Remove it from the list of tags to be found.
    Set Variable [ $subtract; Value:$findList ]
    Set Variable [ $findList; Value:Substitute ( $subtract ; $menu & $find & ¶ ; "" ) ]
    #
    #Find main window records tagged with it.
    Enter Find Mode [ ]
    Set Field [ testlearn::filterFind; "main" & ¶ ]
    #
    #
    If [ $menu = "k" ]
    Set Field [ testlearn::kcKeywordOther; $find ]
    Else If [ $menu = "n" ]
    Set Field [ testlearn::kNodeOther; $find ]
    End If
    #
    #
    Extend Found Set [ ]
    End Loop
    End If
    End If
    End If
    #
    #Refind primary items.
    If [ $$found ≠ "" ]
    #
    #Create a copy of the found list. Items will be
    #removed from this one at a time as they are found.
    Set Variable [ $findList; Value:$$found ]
    #
    #Get the menu item name so system will know
    #what field to put the ID number into to find
    #records tagged with this item.
    Set Variable [ $menu; Value:Left ( ( GetValue ( $findList ; 1 ) ) ; 1 ) ]
    #
    #Get the ID number of the tag to be found.
    #(the number 42 is a joke, essentially the number
    #needs to be big enough to capture the full ID number
    #which is much shorter, but overkill doesn't hurt)
    #FYI: joke is from Hitchhiker's Guide to the Galaxy
    Set Variable [ $find; Value:Middle ( ( GetValue ( $findList ; 1 ) ) ; 2 ; 42 ) ]
    #
    #Remove it from the list of tags to be found.
    Set Variable [ $subtract; Value:$findList ]
    Set Variable [ $findList; Value:Substitute ( $subtract ; $menu & $find & ¶ ; "" ) ]
    #
    #Find main window records tagged with it.
    Enter Find Mode [ ]
    Set Field [ testlearn::filterFind; "main" & ¶ ]
    #
    #
    If [ $menu = "k" ]
    Set Field [ testlearn::kKeywordPrimary; $find ]
    Else If [ $menu = "n" ]
    Set Field [ testlearn::kNodePrimary; $find ]
    Else If [ $menu = "r" ]
    Set Field [ testlearn::kcreference; $find ]
    Else If [ $menu = "t" ]
    Set Field [ testlearn::kctestSubsectionInfo; "*" & $find & ¶ ]
    Else If [ $menu = "b" ]
    Set Field [ testlearn::kcbrainstorm; "*" & $find & ¶ ]
    End If
    #
    #
    Extend Found Set [ ]
    #
    #If there is more than one item on the $$found
    #list, then find the rest of records tagged with
    #this items/tags.
    Loop
    #
    #When the list is empty stop finding stuff.
    Exit Loop If [ ValueCount ( $findList ) = 0 ]
    #
    #Get the menu item name so system will know
    #what field to put the ID number into to find
    #records tagged with this item.
    Set Variable [ $menu; Value:Left ( ( GetValue ( $findList ; 1 ) ) ; 1 ) ]
    #
    #Get the ID number of the tag to be found.
    Set Variable [ $find; Value:Middle ( ( GetValue ( $findList ; 1 ) ) ; 2 ; 42 ) ]
    #
    #Remove it from the list of tags to be found.
    Set Variable [ $subtract; Value:$findList ]
    Set Variable [ $findList; Value:Substitute ( $subtract ; $menu & $find & ¶ ; "" ) ]
    #
    #Find main window records tagged with it.
    Enter Find Mode [ ]
    Set Field [ testlearn::filterFind; "main" & ¶ ]
    #
    #
    If [ $menu = "k" ]
    Set Field [ testlearn::kKeywordPrimary; $find ]
    Else If [ $menu = "n" ]
    Set Field [ testlearn::kNodePrimary; $find ]
    Else If [ $menu = "r" ]
    Set Field [ testlearn::kcreference; $find ]
    Else If [ $menu = "t" ]
    Set Field [ testlearn::ktestSubsection; $find ]
    Else If [ $menu = "b" ]
    Set Field [ testlearn::kcbrainstorm; $find ]
    End If
    #
    #
    Extend Found Set [ ]
    End Loop
    End If
    #
    #Sort according to current sort in Main window.
    Sort Records [ ] [ No dialog ]
    #
    #Go to first record and preform record load script.
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    Set Variable [ $$stoploadCitation ]
    Perform Script [ “loadLearnOrRefMainRecord” ]
    #
    #Return to Tag Menus window.
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    #If no records where found tell user why and
    #remove tag ID from list of tags attached to records
    #in the main window.
    If [ $error = 401 ]
    If [ $$firstFind = "" ]
    Set Variable [ $$foundOther ]
    Else If [ $$firstFind ≠ "" ]
    Set Variable [ $$foundOther; Value:Substitute ( $found ; $menu & $tag & ¶ ; "" ) ]
    End If
    Refresh Window
    #
    #
    If [ $$citationMatch = "key" ]
    Show Custom Dialog [ Message: "'" & $name & "'" & " is not in use as an other keyword."; Default Button: “OK”, Commit: “Yes” ]
    Else If [ $$citationMatch = "node" ]
    Show Custom Dialog [ Message: "'" & $name & "'" & " is not in use as an other node."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #
    End If

Fields used in this script

    tagMenus::_Ltag
    tagMenus::tag
    testlearn::filterFind
    testlearn::kcKeywordOther
    testlearn::kNodeOther
    testlearn::kKeywordPrimary
    testlearn::kNodePrimary
    testlearn::kcreference
    testlearn::kctestSubsectionInfo
    testlearn::kcbrainstorm
    testlearn::ktestSubsection

Scripts used in this script

    loadLearnOrRefMainRecord

Layouts used in this script

Tables used in this script

    tag
    testlearn

Table occurrences used by this script

    tagMenus
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [findKeyOtherTL]	Parent Folder: [tagMenu]	Next Script: [findModeCancel]
Script Name	findMode
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferenceMenu1
    ReferenceMenuCopyright
    ReferenceMenu3Cite
    ReferenceMenu3CiteNoPicture
    ReferenceMenu2keywordOrNode1
    ReferenceMenu2SkeywordOrNode1
    ReferenceMenu2keywordOrNode2
    ReferenceMenu2SkeywordOrNode2
    ReferenceMenu2keywordOrNode3
    ReferenceMenu2SkeywordOrNode3
    ReferenceMenu2keywordOrNode4
    ReferenceMenu2SkeywordOrNode4
    ReferenceMenu2keywordOrNode5
    ReferenceMenu2SkeywordOrNode5
    ReferenceMenuFind
    ReferenceMenu3CiteFind
    ReferenceMenu3CiteFindS
    ReferenceMenu2keywordOrNodeFind
    ReferenceMenu2SkeywordOrNodeFind
    referenceMenuFINDref
    referenceFINDNK
    referenceSFINDNK
    ltagNK1
    ltagNKs1
    ltagNK2
    ltagNKs2
    ltagNK3
    ltagNKs3
    ltagNK4
    ltagNKs4
    ltagNK5
    ltagNKs5
    learnMenu3Cite
    learnMenu3CiteS
    learnMenuRefStuff
    learnMenu4RefCite
    learnMenu4noPicRefCite
    learnMenu4STUFFRefCite
    learnMenuBrainstorm
    learnMenuStuffBrainstorm
    learnTest
    learnSTest
    learnFind
    learnSFind
    learnKeywordOrNodeFind
    learnKeywordOrNodeSFind
    learnFindTest
    learnFindSTest
    learnFindBrainstorm
    learnFindStuffBrainstorm
    learnFindCite
    learnFindCiteS
    learnFindStuffCite
    learnMenu4NoPicRefCiteFindTL
    learnMenu4RefCiteFindTL
    learnMenu4RefStuffCiteFindTL
    learnMenuFINDref
    learnMenuFINDrefLearn
    learnMenuFINDstuffRef
    learnMenuFINDstuffRefLearn
    ltagFINDNK
    ltagFINDstuffNK

Scripts that use this script

    addORremoveOtherTagStep1
    addORremovePrimaryTag

Script Definition
Script Steps

    #
    #
    #Admin tasks.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #
    #If not in find mode because user just clicked
    #the find button in the Tag Menus window...
    If [ $$findMode= "" ]
    #
    #
    #Clear brainstorm and test tags so there conditional
    #formatting in the Learn window is removed.
    If [ $$citationMatch = "brainstorm" or $$citationMatch = "test" ]
    Select Window [ Name: "Learn"; Current file ]
    Go to Field [ ]
    Set Variable [ $$tagBrainstorm ]
    Set Variable [ $$tagtest ]
    Set Variable [ $$tagRecordID ]
    Set Variable [ $$tagEdit ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::date; descending testlearn::timestamp; descending ] [ Restore; No dialog ]
    End If
    #
    #Return to Tag Menus.
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    #
    #If find mode is active then return to browse mode.
    If [ Get ( WindowMode ) = 1 ]
    #
    #If user presses enter find button then perform the
    #steps below to complete the find.
    #
    #Load found tag as a last step.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    #
    Perform Find [ ]
    #
    Go to Layout [ $$findLayout ]
    Set Variable [ $$findLayout ]
    #
    #Sort reference or tag records depending on which
    #records user is viewing.
    If [ Get (LayoutTableName) = "reference" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagKeywordPrimary::orderOrLock; based on value list: “order Pulldown List” tagKeywordPrimary::tag; ascending reference::referenceShort; ascending ] [ Restore; No dialog ]
    #
    #If performing a find for reference tags insure
    #that the locked tags are removed.
    Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: reference::lock: “lock” ] [ Restore ]
    Set Variable [ $$stopLoadTagRecord ]
    Perform Script [ “loadTagRecord” ]
    Halt Script
    Else
    #
    If [ $$citationMatch = "learn" ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::date; descending testlearn::timestamp; descending ] [ Restore; No dialog ]
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::orderInventoryGroupNumber; ascending testlearn::note; ascending ] [ Restore; No dialog ]
    End If
    #
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    End If
    #
    Set Variable [ $$stopLoadTagRecord ]
    Perform Script [ “loadTagRecord” ]
    Halt Script
    End If
    #
    #If user presses enter find button then perform the
    #steps below to complete the find.
    End If
    #
    #If user is not looking at test subjection tags...
    If [ Get (LayoutTableName) ≠ "testSubsection" ]
    #Ask user if they want to find a tag or find learn items
    #tagged with specific tags (except if they are
    #on the test Tag Menu layout).
    #
    #Test subsection tags need to always be shown
    #as issues arise if user came from the test
    #module and will be going back.
    #
    #Show different message for learn and reference sections.
    If [ Left (Get (LayoutName) ; 9 ) ≠ "reference" ]
    Show Custom Dialog [ Message: "Find learn records tagged with these tags?" & ¶ & "OR" & ¶ & "Find tag(s)?"; Default Button: “tag(s)”, Commit: “Yes”; Button 2: “learn”, Commit: “No”; Button 3: “cancel”, Commit: “No” ]
    #
    Else If [ Left (Get (LayoutName) ; 9 ) = "reference" and $$referenceRecordOne ≠ 2 ]
    #
    #Eliminate find reference option for citation menu.
    If [ $$citationMatch ≠ "cite" and $$stopAdd ≠ 1 ]
    Show Custom Dialog [ Message: "Find references tagged with these tags?" & ¶ & "OR" & ¶ & "Find tag(s)?"; Default Button: “tag(s)”, Commit: “Yes”; Button 2: “reference”, Commit: “No”; Button 3: “cancel”, Commit: “No” ]
    Else If [ $$stopAdd ≠ 1 ]
    Show Custom Dialog [ Message: "Find references tagged with these tags?" & ¶ & "OR" & ¶ & "Find tag(s)?"; Default Button: “tag(s)”, Commit: “Yes”; Button 2: “reference”, Commit: “No”; Button 3: “cancel”, Commit: “No” ]
    // Show Custom Dialog [ Message: "Find tag(s)? "; Default Button: “cancel”, Commit: “Yes”; Button 2: “tag(s)”, Commit: “No” ]
    End If
    End If
    #
    #If user selects to find tags enter find mode first.
    If [ Get ( LastMessageChoice ) = 1 and $$ClearMessageChoice ≠ 2 or $$stopAdd = 1 ]
    Enter Find Mode [ ]
    #
    #Determine if user is looking tag or reference records.
    If [ Get (LayoutTableName) = "reference" ]
    #
    #Get the layout name for the return trip after find is done.
    Set Variable [ $$findLayout; Value:Get (LayoutName) ]
    #
    #Show different layouts for learn and reference tag
    #menu items.
    If [ Left (Get (LayoutName) ; 9 ) ≠ "reference" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “learnMenuFINDstuffRef” (reference) ]
    Else
    Go to Layout [ “learnMenuFINDref” (reference) ]
    End If
    Else
    Go to Layout [ “referenceMenuFINDref” (reference) ]
    End If
    #
    #Limit search to only items user selected to show in
    #learn mode if in learn mode.
    If [ Left (Get (LayoutName) ; 9 ) ≠ "reference" ]
    Set Field [ reference::showInLearn; "show in learn" ]
    End If
    #
    #Select the field where the user needs to enter the
    #find information.
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    // Go to Field [ reference::referenceSTUFF ]
    Else
    // Go to Field [ reference::referenceForReferenceWindow ]
    End If
    #
    #Pause and wait until user is ready to perform find.
    Pause/Resume Script [ Indefinitely ]
    #
    #Load found tag as a last step.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    #
    #If user presses enter key then perform the steps below
    #to complete the find.
    Perform Find [ ]
    #
    Go to Layout [ $$findLayout ]
    Set Variable [ $$findLayout ]
    #
    #If performing a find for reference tags insure
    #that the locked tags are removed.
    Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: reference::lock: “lock” ] [ Restore ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagKeywordPrimary::orderOrLock; based on value list: “order Pulldown List” tagKeywordPrimary::tag; ascending reference::referenceShort; ascending ] [ Restore; No dialog ]
    Set Variable [ $$stopLoadTagRecord ]
    Perform Script [ “loadTagRecord” ]
    Halt Script
    Exit Script [ ]
    #
    Else
    #Limit search to only items user selected to show in
    #learn mode if in learn mode.
    Set Field [ tagMenus::match; $$citationMatch ]
    Set Variable [ $$findLayout; Value:Get (LayoutName) ]
    If [ Left (Get (LayoutName) ; 9 ) ≠ "reference" ]
    If [ Left (Get (LayoutName) ; 9 ) = "learnmenu" and Right ( Get (LayoutName) ; 9 ) ≠ "Copyright" and Right ( Get (LayoutName) ; 10 ) ≠ "Brainstorm" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “learnMenuFINDstuffRefLearn” (testlearn) ]
    #Insure that only storage records will be found.
    Set Field [ testlearn::brainstormCasePoint; "1" ]
    Else
    Go to Layout [ “learnMenuFINDrefLearn” (testlearn) ]
    End If
    #Clear these variables so find will work.
    Set Field [ tagMenus::match; "" ]
    Else
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “ltagFINDstuffNK” (tagMenus) ]
    Else
    Go to Layout [ “ltagFINDNK” (tagMenus) ]
    End If
    End If
    #
    Else
    #Show all reference items for a section if in
    #reference mode.
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “referenceSFINDNK” (tagMenus) ]
    Else
    Go to Layout [ “referenceFINDNK” (tagMenus) ]
    End If
    End If
    #
    #Select the field where the user needs to enter the
    #find information.
    If [ Left (Get (LayoutName) ; 5 ) = "learn" ]
    // Go to Field [ testlearn::note ]
    Else
    // Go to Field [ tagMenus::tag ]
    End If
    #
    #Pause and wait until user is ready to perform find.
    Pause/Resume Script [ Indefinitely ]
    #
    #Load found tag as a last step.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    #
    #If user presses enter key then perform the steps below
    #to complete the find.
    Perform Find [ ]
    #
    Go to Layout [ $$findLayout ]
    Set Variable [ $$findLayout ]
    #
    If [ $$citationMatch = "learn" ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::date; descending testlearn::timestamp; descending ] [ Restore; No dialog ]
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::orderInventoryGroupNumber; ascending testlearn::note; ascending ] [ Restore; No dialog ]
    End If
    #
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    End If
    #
    Set Variable [ $$stopLoadTagRecord ]
    Perform Script [ “loadTagRecord” ]
    Exit Script [ ]
    End If
    #
    Else If [ Get ( LastMessageChoice ) = 3 ]
    #If user cancels then exit exit.
    Exit Script [ ]
    End If
    End If
    #
    #
    #
    #
    #So if user wants to find learn records, then go into
    #menu for finding learn records by green button tags.
    #
    #Find must be done for tags, so if user is showing no
    #tags when find is activitated then take user to keywords
    #tag menu.
    If [ Get (LayoutName) = "ReferenceMenuNoTags" ]
    Go to Layout [ “ReferenceMenu2keywordOrNode2” (tagMenus) ]
    End If
    #
    Set Variable [ $$findMode; Value:1 ]
    Set Variable [ $$findLayout; Value:Get (LayoutName) ]
    #
    #FIND FOR LEARN MODULE
    #
    If [ Right ( Get (LayoutName) ; 7 ) = "refcite" and Left ( Get (LayoutName) ; 1 ) = "l" ]
    #
    If [ TEMP::InventoryLibraryYN = "" ]
    #Idea Mode
    #
    If [ TEMP::layoutLtagLFIND = "" ]
    #If no layout preference is set, then on iDevices
    #go the layout with no pictures, and to the
    #layout with pictures on desktop computers.
    If [ Get (SystemPlatform) = 3 ]
    Go to Layout [ “learnMenu4NoPicRefCiteFindTL” (testlearn) ]
    Set Field [ TEMP::layoutLtagLFIND; "more" & Get (LayoutName) ]
    Else
    Go to Layout [ “learnMenu4RefCiteFindTL” (testlearn) ]
    Set Field [ TEMP::layoutLtagLFIND; "less" & Get (LayoutName) ]
    End If
    #
    Else
    #
    #Go the layout the user has selected.
    Go to Layout [ Middle ( TEMP::layoutLtagLFIND ; 5 ; 42 ) ]
    End If
    #
    Else
    #Inventory Mode
    #
    #Go the layout the user has selected.
    Go to Layout [ “learnMenu4RefStuffCiteFindTL” (testlearn) ]
    End If
    #
    Else If [ Right ( Get (LayoutName) ; 9 ) = "Copyright" and Left ( Get (LayoutName) ; 1 ) = "l" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “learnSFind” (tagMenus) ]
    Else
    Go to Layout [ “learnFind” (tagMenus) ]
    End If
    Else If [ Right ( Get (LayoutName) ; 10 ) = "Brainstorm" and Left ( Get (LayoutName) ; 1 ) = "l" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “learnFindStuffBrainstorm” (tagMenus) ]
    Else
    Go to Layout [ “learnFindBrainstorm” (tagMenus) ]
    End If
    Else If [ Left ( Get (LayoutName) ; 6 ) = "ltagNK" and Left ( Get (LayoutName) ; 1 ) = "l" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “learnKeywordOrNodeSFind” (tagMenus) ]
    Else
    Go to Layout [ “learnKeywordOrNodeFind” (tagMenus) ]
    End If
    Else If [ Right ( Get (LayoutName) ; 1 ) = "3" and Left ( Get (LayoutName) ; 1 ) = "l" ]
    Go to Layout [ “learnKeywordOrNodeFind” (tagMenus) ]
    Else If [ Right ( Get (LayoutName) ; 4 ) = "test" and Left ( Get (LayoutName) ; 1 ) = "l" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “learnFindSTest” (testSubsectionTemplate) ]
    Else
    Go to Layout [ “learnFindTest” (testSubsectionTemplate) ]
    End If
    #
    #
    #
    #
    Else If [ Right ( Get (LayoutName) ; 5 ) = "3cite" and Left ( Get (LayoutName) ; 1 ) = "l" or Right ( Get (LayoutName) ; 6 ) = "3citeS" and Left ( Get (LayoutName) ; 1 ) = "l" ]
    #
    #
    #If no layout preference is set, then on iDevices
    #go the layout with no pictures, and to the
    #layout with pictures on desktop computers.
    If [ TEMP::layoutLtagRFIND = "" ]
    If [ Get (SystemPlatform) = 3 ]
    Go to Layout [ “learnFindCiteS” (reference) ]
    Set Field [ TEMP::layoutLtagRFIND; "more" & Get (LayoutName) ]
    Else
    Go to Layout [ “learnFindCite” (reference) ]
    Set Field [ TEMP::layoutLtagRFIND; "less" & Get (LayoutName) ]
    End If
    Else
    #
    #Go the layout the user has selected.
    Go to Layout [ Middle ( TEMP::layoutLtagRFIND ; 5 ; 42 ) ]
    End If
    #
    Else If [ Right ( Get (LayoutName) ; 8 ) = "RefStuff" and Left ( Get (LayoutName) ; 1 ) = "l" ]
    Go to Layout [ “learnFindStuffCite” (reference) ]
    #
    #
    #FIND FOR REFERENCE MODULE
    #
    Else If [ Right ( Get (LayoutName) ; 5 ) = "menu1" and Left ( Get (LayoutName) ; 1 ) = "r" ]
    Go to Layout [ “ReferenceMenuFind” (tagMenus) ]
    Else If [ Right ( Get (LayoutName) ; 5 ) = "node1" and Left ( Get (LayoutName) ; 1 ) = "r" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “ReferenceMenu2SkeywordOrNodeFind” (tagMenus) ]
    Else
    Go to Layout [ “ReferenceMenu2keywordOrNodeFind” (tagMenus) ]
    End If
    Else If [ Right ( Get (LayoutName) ; 5 ) = "node2" and Left ( Get (LayoutName) ; 1 ) = "r" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “ReferenceMenu2SkeywordOrNodeFind” (tagMenus) ]
    Else
    Go to Layout [ “ReferenceMenu2keywordOrNodeFind” (tagMenus) ]
    End If
    Else If [ Right ( Get (LayoutName) ; 1 ) = "3" and Left ( Get (LayoutName) ; 1 ) = "r" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “ReferenceMenu2SkeywordOrNodeFind” (tagMenus) ]
    Else
    Go to Layout [ “ReferenceMenu2keywordOrNodeFind” (tagMenus) ]
    End If
    Else If [ Middle ( Get ( LayoutName ) ; 14 ; 5 ) = "3cite" and Left ( Get (LayoutName) ; 1 ) = "r" ]
    #
    #
    #If no layout preference is set, then on iDevices
    #go the layout with no pictures, and to the
    #layout with pictures on desktop computers.
    If [ TEMP::layoutRtagCiteFIND = "" ]
    If [ Get (SystemPlatform) = 3 ]
    Go to Layout [ “ReferenceMenu3CiteFindS” (reference) ]
    Set Field [ TEMP::layoutRtagCiteFIND; "more" & Get (LayoutName) ]
    Else
    Go to Layout [ “ReferenceMenu3CiteFind” (reference) ]
    Set Field [ TEMP::layoutRtagCiteFIND; "less" & Get (LayoutName) ]
    End If
    Else
    #
    #Go the layout the user has selected.
    Go to Layout [ Middle ( TEMP::layoutRtagCiteFIND ; 5 ; 42 ) ]
    End If
    #
    #
    Else If [ Right ( Get (LayoutName) ; 9 ) = "Copyright" and Left ( Get (LayoutName) ; 1 ) = "r" ]
    Go to Layout [ “ReferenceMenuFind” (tagMenus) ]
    End If
    #
    #Clear the first record question variable so user will
    #not be asked if they wish to find or tag reference records.
    Set Variable [ $$referenceRecordOne ]
    Set Variable [ $$ClearMessageChoice ]
    #
    #As going to the other window will be involved
    #stop the record load script on that window until
    #this script is finished to speed things up and
    #stop flashing effect.
    // Set Variable [ $$stoploadCitation; Value:1 ]
    Select Window [ Name: "References"; Current file ]
    If [ Get (LayoutName) = "ReferenceEDIT" ]
    Go to Layout [ “Reference” (reference) ]
    End If
    Select Window [ Name: "Learn"; Current file ]
    If [ Get (LayoutName) = "Learn4Edit" ]
    Go to Layout [ “learn4” (testlearn) ]
    End If
    Refresh Window
    Select Window [ Name: "Tag Menus"; Current file ]
    If [ Get ( LayoutTableName ) = "testlearn" and TEMP::InventoryLibraryYN ≠ "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::orderInventoryGroupNumber; ascending testlearn::note; ascending ] [ Restore; No dialog ]
    End If
    If [ Get ( LayoutTableName ) = "testlearn" and TEMP::InventoryLibraryYN = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::date; descending testlearn::timestamp; descending ] [ Restore; No dialog ]
    End If
    Exit Script [ ]
    Else If [ $$findMode= 1 ]
    Set Variable [ $$findMode ]
    Set Variable [ $$firstFind ]
    Set Variable [ $$firstFindOther ]
    Set Variable [ $$found ]
    Set Variable [ $$foundOther ]
    Set Variable [ $$findLayout ]
    If [ $$citationmatch = "cite" ]
    Perform Script [ “menuCitation” ]
    Else If [ $$citationmatch = "key" ]
    Perform Script [ “menuKey” ]
    Else If [ $$citationMatch = "node" ]
    Perform Script [ “menuNode” ]
    Else If [ $$citationMatch = "medium" ]
    Perform Script [ “menuMedium” ]
    Else If [ $$citationMatch = "copyright" ]
    Perform Script [ “menuCopyright” ]
    Else If [ $$citationMatch = "path" ]
    Perform Script [ “menuPath” ]
    Else If [ $$citationMatch = "publication" ]
    Perform Script [ “menuPublication” ]
    Else If [ $$citationMatch = "publisher" ]
    Perform Script [ “menuPublisher” ]
    Else If [ $$citationMatch = "brainstorm" ]
    Perform Script [ “menuBrainstorm” ]
    Else If [ $$citationMatch = "test" ]
    Perform Script [ “menuTest” ]
    Else If [ $$citationMatch = "learn" ]
    Perform Script [ “menuLearn” ]
    Else If [ $$citationMatch = "ref" ]
    Perform Script [ “menuReference” ]
    End If
    Set Variable [ $$stoploadCitation ]
    Exit Script [ ]
    End If
    #

Fields used in this script

    testlearn::date
    testlearn::timestamp
    tagKeywordPrimary::orderOrLock
    tagKeywordPrimary::tag
    reference::referenceShort
    reference::lock
    TEMP::InventoryLibraryYN
    testlearn::orderInventoryGroupNumber
    testlearn::note
    tagMenuGroup::orderOrLibraryType
    tagMenuGroup::name
    tagMenus::orderOrLock
    tagMenus::tag
    reference::showInLearn
    reference::referenceSTUFF
    reference::referenceForReferenceWindow
    tagMenus::match
    testlearn::brainstormCasePoint
    TEMP::layoutLtagLFIND
    TEMP::layoutLtagRFIND
    TEMP::layoutRtagCiteFIND

Scripts used in this script

    loadTagRecord
    menuCitation
    menuKey
    menuNode
    menuMedium
    menuCopyright
    menuPath
    menuPublication
    menuPublisher
    menuBrainstorm
    menuTest
    menuLearn
    menuReference

Layouts used in this script

    <Missing Layout>
    learnMenuFINDstuffRef
    learnMenuFINDref
    referenceMenuFINDref
    learnMenuFINDstuffRefLearn
    learnMenuFINDrefLearn
    ltagFINDstuffNK
    ltagFINDNK
    referenceSFINDNK
    referenceFINDNK
    ReferenceMenu2keywordOrNode2
    learnMenu4NoPicRefCiteFindTL
    learnMenu4RefCiteFindTL
    learnMenu4RefStuffCiteFindTL
    learnSFind
    learnFind
    learnFindStuffBrainstorm
    learnFindBrainstorm
    learnKeywordOrNodeSFind
    learnKeywordOrNodeFind
    learnFindSTest
    learnFindTest
    learnFindCiteS
    learnFindCite
    learnFindStuffCite
    ReferenceMenuFind
    ReferenceMenu2SkeywordOrNodeFind
    ReferenceMenu2keywordOrNodeFind
    ReferenceMenu3CiteFindS
    ReferenceMenu3CiteFind
    Reference
    learn4

Tables used in this script

    TEMP
    reference
    tag
    tagGroup
    testlearn

Table occurrences used by this script

    TEMP
    reference
    tagKeywordPrimary
    tagMenuGroup
    tagMenus
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [findMode]	Parent Folder: [tagMenu]	Next Script: [findPrimaryRef]
Script Name	findModeCancel
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #Script activitated if user cancels find and returns user
    #to layout they were viewing.
    Go to Layout [ $$findLayout ]
    Set Variable [ $$findLayout ]
    #

Fields used in this script

Scripts used in this script

Layouts used in this script

    <Missing Layout>

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [findModeCancel]	Parent Folder: [tagMenu]	Next Script: [findPrimaryTL]
Script Name	findPrimaryRef
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferenceMenuFind
    ReferenceMenu3CiteFind
    ReferenceMenu3CiteFindS
    ReferenceMenu2keywordOrNodeFind
    ReferenceMenu2SkeywordOrNodeFind

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #If this tag has a picture that is hidden, ask if
    #the user wants to see the picture or find
    #record's with this tag.
    If [ //There is a picture to show if... Get (LayoutName) = "ReferenceMenu3CiteNoPicture" and ( reference::picture ≠ "" or reference::showMedia ≠ "" and reference::URL ≠ "" or reference::showMedia[2] ≠ "" and reference::kfileLocation ≠ "" and reference::fileName ≠ "" ) or Get (LayoutName) = "ReferenceMenu3CiteFindS" and ( reference::picture ≠ "" or reference::showMedia ≠ "" and reference::URL ≠ "" or reference::showMedia[2] ≠ "" and reference::kfileLocation ≠ "" and reference::fileName ≠ "" ) ]
    If [ reference::_Lreference = $$citationItem and $$citationMatch = "cite" ]
    Show Custom Dialog [ Message: "Show this tag's picture or hide reference records tagged only with it?"; Default Button: “hide”, Commit: “Yes”; Button 2: “show”, Commit: “No”; Button 3: “cancel”, Commit: “No” ]
    Else
    Show Custom Dialog [ Message: "Show this tag's picture or find references tagged with it?"; Default Button: “find”, Commit: “Yes”; Button 2: “show”, Commit: “No”; Button 3: “cancel”, Commit: “No” ]
    End If
    If [ Get (LastMessageChoice) = 2 ]
    Set Variable [ $$stopOpenNewTextWindow ]
    Perform Script [ “showCitationPicture1inNewWindow” ]
    Exit Script [ ]
    End If
    If [ Get (LastMessageChoice) = 3 ]
    Exit Script [ ]
    End If
    End If
    #
    #
    #Select tag to be found.
    Set Variable [ $tag; Value:tagMenus::_Ltag ]
    If [ $$citationMatch = "cite" ]
    Set Variable [ $tag; Value:reference::_Lreference ]
    End If
    #
    #Select the kind of tag to be found. We grab
    #only the first three letters because the shortest
    #menu item 'key' has only three letters, and because
    #we need the same number of characters/letters
    #to make up this variable so when it is added to
    #the first part of an item in the found list below
    #it can be removed by the system which only
    #can be told how many characters to remove.
    #This variable is thus a meta tag added to an
    #ID number to tell the system from which menu
    #did this item come. This meta tag or tag allows
    #us to make a list of ID numbers from various
    #tag menus: key, node, medium, etc.
    Set Variable [ $menu; Value:Left ( $$citationMatch ; 1 ) ]
    If [ $menu = "c" and $$citationMatch = "cite" ]
    Set Variable [ $menu; Value:"r" ]
    Else If [ $menu = "p" and $$citationMatch = "publisher" ]
    Set Variable [ $menu; Value:"x" ]
    Else If [ $menu = "p" and $$citationMatch = "publication" ]
    Set Variable [ $menu; Value:"y" ]
    End If
    #
    #Get the name of the tag for error message
    #at bottom of this script if needed.
    Set Variable [ $name; Value:tagMenus::tag ]
    If [ $$citationMatch = "cite" ]
    Set Variable [ $name; Value:reference::Title ]
    End If
    #
    #As going to the other window will be involved
    #stop the record load script on that window until
    #this script is finished to speed things up and
    #stop flashing effect.
    Set Variable [ $$stoploadCitation; Value:1 ]
    #
    #Go to the other window and start the find process.
    Select Window [ Name: "References"; Current file ]
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    Enter Find Mode [ ]
    // Set Field [ reference::filterFind; "main" & ¶ ]
    #
    #
    If [ $menu = "k" ]
    Set Field [ reference::kkeywordPrimary; $tag ]
    Else If [ $menu = "n" ]
    Set Field [ reference::knodePrimary; $tag ]
    Else If [ $menu = "m" ]
    Set Field [ reference::kmedium; $tag ]
    Else If [ $menu = "c" and $$citationMatch ≠ "cite" ]
    Set Field [ reference::kCopyright; $tag ]
    Else If [ $menu = "p" ]
    Set Field [ reference::kfolderpath; $tag ]
    Else If [ $menu = "x" ]
    Set Field [ reference::kpublisher; $tag ]
    Else If [ $menu = "y" ]
    Set Field [ reference::kpublication; $tag ]
    Else If [ $menu = "r" ]
    Set Field [ reference::kcitation; $tag ]
    End If
    #
    #
    #If this is the first find, note this and perform
    #the find.
    If [ $$firstFind = "" ]
    Set Variable [ $$firstFind; Value:1 ]
    Set Variable [ $$found; Value:$menu & $tag & ¶ ]
    Perform Find [ ]
    #
    #If nothing was found capture the error message
    #as steps before showing the error message will
    #delete it from the system and we need it to
    #activate the error message below if there was
    #an error.
    Set Variable [ $error; Value:Get (LastError) ]
    #
    #If this is not the first find and the item that
    #the user clicked on to start this script has
    #not already been found, then add items tagged
    #with it to the current set of found records.
    Else If [ $$firstFind = 1 ]
    If [ $menu & $tag & ¶ ≠ FilterValues ( $$found ; $menu & $tag) ]
    Extend Found Set [ ]
    #
    #If nothing was found capture the error message
    #as steps before showing the error message will
    #delete it from the system and we need it to
    #activate the error message below if there was
    #an error.
    Set Variable [ $error; Value:Get (LastError) ]
    #
    #Add the tag from the list of found tagged records.
    Set Variable [ $found; Value:$$found ]
    Set Variable [ $$found; Value:$menu & $tag & ¶ & $found ]
    #
    #If this is not the first find and the item that
    #the user clicked on to start this script has
    #already been found, then remove tag from the
    #the list of found tagged records.
    Else If [ $menu & $tag & ¶= FilterValues ( $$found ; $menu & $tag & ¶) ]
    Set Variable [ $found; Value:$$found ]
    Set Variable [ $$found; Value:Substitute ( $found ; $menu & $tag & ¶ ; "" ) ]
    #
    #Enter browse mode to clear the find selections
    #set at the beginning of this script.
    Enter Browse Mode
    #
    #If after removing this item from the list of found
    #tagged records the list is empty, perform a find
    #that will result in zero records being found
    #to reflect the fact that the user currently has
    #an empty found list.
    If [ $$found = "" ]
    Set Variable [ $$firstFind ]
    Enter Find Mode [ ]
    #
    #
    #Since ID numbers are numbers, the text
    #'findnoRecords' entered in the ID field will result
    #in zero records being found.
    Set Field [ reference::kkeywordPrimary; "findNoRecords" ]
    #
    #
    Perform Find [ ]
    #
    #If after removing this item from the $$found list,
    #the list is not empty, refind all records still on
    #the list one tag at a time.
    Else If [ $$found ≠ "" ]
    #
    #Create a copy of the found list. Items will be
    #removed from this one at a time as they are found.
    Set Variable [ $findList; Value:$$found ]
    #
    #Get the menu item name so system will know
    #what field to put the ID number into to find
    #records tagged with this item.
    Set Variable [ $menu; Value:Left ( ( GetValue ( $findList ; 1 ) ) ; 1 ) ]
    #
    #Get the ID number of the tag to be found.
    #(the number 42 is a joke, essentially the number
    #needs to be big enough to capture the full ID number
    #which is much shorter, but overkill doesn't hurt)
    #FYI: joke is from Hitchhiker's Guide to the Galaxy
    Set Variable [ $find; Value:Middle ( ( GetValue ( $findList ; 1 ) ) ; 2 ; 42 ) ]
    #
    #Remove it from the list of tags to be found.
    Set Variable [ $subtract; Value:$findList ]
    Set Variable [ $findList; Value:Substitute ( $subtract ; $menu & $find & ¶ ; "" ) ]
    #
    #Find main window records tagged with it.
    Enter Find Mode [ ]
    // Set Field [ reference::filterFind; "main" & ¶ ]
    #
    #
    If [ $menu = "k" ]
    Set Field [ reference::kkeywordPrimary; $find ]
    Else If [ $menu = "n" ]
    Set Field [ reference::knodePrimary; $find ]
    Else If [ $menu = "m" ]
    Set Field [ reference::kmedium; $find ]
    Else If [ $menu = "c" ]
    Set Field [ reference::kCopyright; $find ]
    Else If [ $menu = "p" ]
    Set Field [ reference::kfolderpath; $find ]
    Else If [ $menu = "x" ]
    Set Field [ reference::kpublisher; $find ]
    Else If [ $menu = "y" ]
    Set Field [ reference::kpublication; $find ]
    End If
    #
    #
    #If there is more than one item on the $$found
    #list, then find the rest of records tagged with
    #this items/tags.
    Perform Find [ ]
    Loop
    #
    #When the list is empty stop finding stuff.
    Exit Loop If [ ValueCount ( $findList ) = 0 ]
    #
    #Get the menu item name so system will know
    #what field to put the ID number into to find
    #records tagged with this item.
    Set Variable [ $menu; Value:Left ( ( GetValue ( $findList ; 1 ) ) ; 1 ) ]
    #
    #Get the ID number of the tag to be found.
    Set Variable [ $find; Value:Middle ( ( GetValue ( $findList ; 1 ) ) ; 2 ; 42 ) ]
    #
    #Remove it from the list of tags to be found.
    Set Variable [ $subtract; Value:$findList ]
    Set Variable [ $findList; Value:Substitute ( $subtract ; $menu & $find & ¶ ; "" ) ]
    #
    #Find main window records tagged with it.
    Enter Find Mode [ ]
    // Set Field [ reference::filterFind; "main" & ¶ ]
    #
    #
    If [ $menu = "k" ]
    Set Field [ reference::kkeywordPrimary; $find ]
    Else If [ $menu = "n" ]
    Set Field [ reference::knodePrimary; $find ]
    Else If [ $menu = "m" ]
    Set Field [ reference::kmedium; $find ]
    Else If [ $menu = "c" ]
    Set Field [ reference::kCopyright; $find ]
    Else If [ $menu = "p" ]
    Set Field [ reference::kfolderpath; $find ]
    Else If [ $menu = "x" ]
    Set Field [ reference::kpublisher; $find ]
    Else If [ $menu = "y" ]
    Set Field [ reference::kpublication; $find ]
    End If
    #
    #
    Extend Found Set [ ]
    End Loop
    End If
    End If
    End If
    #
    #Refind any Other Keyword items.
    If [ $$foundOther ≠ "" ]
    #
    #Create a copy of the found list. Items will be
    #removed from this one at a time as they are found.
    Set Variable [ $findList; Value:$$foundOther ]
    #
    #Get the menu item name so system will know
    #what field to put the ID number into to find
    #records tagged with this item.
    Set Variable [ $menu; Value:Left ( ( GetValue ( $findList ; 1 ) ) ; 1 ) ]
    #
    #Get the ID number of the tag to be found.
    Set Variable [ $find; Value:Middle ( ( GetValue ( $findList ; 1 ) ) ; 2 ; 42 ) ]
    #
    #Remove it from the list of tags to be found.
    Set Variable [ $subtract; Value:$findList ]
    Set Variable [ $findList; Value:Substitute ( $subtract ; $menu & $find & ¶ ; "" ) ]
    #
    #Find main window records tagged with it.
    Enter Find Mode [ ]
    // Set Field [ reference::filterFind; "main" & ¶ ]
    #
    #
    If [ $menu = "k" ]
    Set Field [ reference::kkeywordOther; $find ]
    Else If [ $menu = "n" ]
    Set Field [ reference::knodeOther; $find ]
    End If
    #
    #
    Extend Found Set [ ]
    #
    #If there is more than one item on the $$foundOther
    #list, then find the rest of records tagged with
    #this items/tags.
    Loop
    #
    #When the list is empty stop finding stuff.
    Exit Loop If [ ValueCount ( $findList ) = 0 ]
    #
    #Get the menu item name so system will know
    #what field to put the ID number into to find
    #records tagged with this item.
    Set Variable [ $menu; Value:Left ( ( GetValue ( $findList ; 1 ) ) ; 1 ) ]
    #
    #Get the ID number of the tag to be found.
    Set Variable [ $find; Value:Middle ( ( GetValue ( $findList ; 1 ) ) ; 2 ; 42 ) ]
    #
    #Remove it from the list of tags to be found.
    Set Variable [ $subtract; Value:$findList ]
    Set Variable [ $findList; Value:Substitute ( $subtract ; $menu & $find & ¶ ; "" ) ]
    #
    #Find main window records tagged with it.
    Enter Find Mode [ ]
    // Set Field [ reference::filterFind; "main" & ¶ ]
    #
    #
    If [ $menu = "k" ]
    Set Field [ reference::kkeywordOther; $find ]
    Else If [ $menu = "n" ]
    Set Field [ reference::knodeOther; $find ]
    End If
    #
    #
    Extend Found Set [ ]
    End Loop
    End If
    #
    #Sort according to current sort in Main window.
    Sort Records [ ] [ No dialog ]
    #
    #Go to first record and preform record load script.
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    Set Variable [ $$stoploadCitation ]
    Perform Script [ “loadLearnOrRefMainRecord” ]
    #
    #Return to Tag Menus window.
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    #If no records where found tell user why and
    #remove tag ID from list of tags attached to records
    #in the main window.
    If [ $error = 401 ]
    If [ $$firstFind = "" ]
    Set Variable [ $$found ]
    Else If [ $$firstFind ≠ "" ]
    Set Variable [ $$found; Value:Substitute ( $found ; $menu & $tag & ¶ ; "" ) ]
    End If
    Refresh Window
    #
    #
    If [ $$citationMatch = "key" ]
    Show Custom Dialog [ Message: "'" & $name & "'" & " is not in use as a primary keyword."; Default Button: “OK”, Commit: “No” ]
    Else If [ $$citationMatch = "node" ]
    Show Custom Dialog [ Message: "'" & $name & "'" & " is not in use as a primary node."; Default Button: “OK”, Commit: “No” ]
    Else If [ $$citationMatch = "medium" ]
    Show Custom Dialog [ Message: "'" & $name & "'" & " is not in use."; Default Button: “OK”, Commit: “No” ]
    Else If [ $$citationMatch = "copyright" ]
    Show Custom Dialog [ Message: "'" & $name & "'" & " is not in use."; Default Button: “OK”, Commit: “No” ]
    Else If [ $$citationMatch = "path" ]
    Show Custom Dialog [ Message: "'" & $name & "'" & " is not in use."; Default Button: “OK”, Commit: “No” ]
    Else If [ $$citationMatch = "publication" ]
    Show Custom Dialog [ Message: "'" & $name & "'" & " is not in use."; Default Button: “OK”, Commit: “No” ]
    Else If [ $$citationMatch = "publisher" ]
    Show Custom Dialog [ Message: "'" & $name & "'" & " is not in use."; Default Button: “OK”, Commit: “No” ]
    Else If [ $$citationMatch = "cite" ]
    Show Custom Dialog [ Message: "'" & $name & "'" & " is not in use."; Default Button: “OK”, Commit: “No” ]
    End If
    #
    #
    End If

Fields used in this script

    reference::picture
    reference::showMedia
    reference::URL
    reference::kfileLocation
    reference::fileName
    reference::_Lreference
    tagMenus::_Ltag
    tagMenus::tag
    reference::Title
    reference::filterFind
    reference::kkeywordPrimary
    reference::knodePrimary
    reference::kmedium
    reference::kCopyright
    reference::kfolderpath
    reference::kpublisher
    reference::kpublication
    reference::kcitation
    reference::kkeywordOther
    reference::knodeOther

Scripts used in this script

    showCitationPicture1inNewWindow
    loadLearnOrRefMainRecord

Layouts used in this script

Tables used in this script

    reference
    tag

Table occurrences used by this script

    reference
    tagMenus

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [findPrimaryRef]	Parent Folder: [tagMenu]	Next Script: [gotoLessDetailLayout]
Script Name	findPrimaryTL
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    learnFind
    learnSFind
    learnKeywordOrNodeFind
    learnKeywordOrNodeSFind
    learnFindTest
    learnFindSTest
    learnFindBrainstorm
    learnFindStuffBrainstorm
    learnFindCite
    learnFindCiteS
    learnFindStuffCite
    learnMenu4NoPicRefCiteFindTL
    learnMenu4RefCiteFindTL
    learnMenu4RefStuffCiteFindTL

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #If this tag has a picture that is hidden, ask if
    #the user wants to see the picture or find
    #record's with this tag.
    If [ //There is a picture to show if... Get (LayoutName) = "learnMenu4NoPicRefCiteFindTL" and ( testlearn::picture ≠ "" or testlearn::kshowReferencedMedia ≠ "" ) or Get (LayoutName) = "learnFindCiteS" and ( reference::picture ≠ "" or reference::showMedia ≠ "" and reference::URL ≠ "" or reference::showMedia[2] ≠ "" and reference::kfileLocation ≠ "" and reference::fileName ≠ "" ) ]
    If [ "L"& testlearn::_Ltestlearn & ¶ = FilterValues ( $$Found ; "L" & testlearn::_Ltestlearn ) or "r" & reference::_Lreference & ¶ = FilterValues ( $$Found ; "r" & reference::_Lreference ) ]
    Show Custom Dialog [ Message: "Show this tag's picture or hide learn records tagged only this tag?"; Default Button: “hide”, Commit: “Yes”; Button 2: “show”, Commit: “No”; Button 3: “cancel”, Commit: “No” ]
    Else
    Show Custom Dialog [ Message: "Show this tag's picture or find learn records tagged with it?"; Default Button: “find”, Commit: “Yes”; Button 2: “show”, Commit: “No”; Button 3: “cancel”, Commit: “No” ]
    End If
    If [ Get (LastMessageChoice) = 2 ]
    Set Variable [ $$stopOpenNewTextWindow ]
    Perform Script [ “showCitationPicture1inNewWindow” ]
    Exit Script [ ]
    End If
    If [ Get (LastMessageChoice) = 3 ]
    Exit Script [ ]
    End If
    End If
    #
    #
    #Select tag to be found.
    If [ Right ( Get (LayoutName) ; 4 ) = "cite" or Right ( Get (LayoutName) ; 5 ) = "citeS" ]
    Set Variable [ $tag; Value:reference::_Lreference ]
    Else If [ Right ( Get (LayoutName) ; 4 ) = "find" or Get (LayoutTableName) = "tagMenus" ]
    Set Variable [ $tag; Value:tagMenus::_Ltag ]
    Else If [ Right ( Get (LayoutName) ; 4 ) = "test" ]
    Set Variable [ $tag; Value:testSubsectionTemplate::_LtestSubsection ]
    Else If [ Right ( Get (LayoutName) ; 2 ) = "tl" ]
    Set Variable [ $tag; Value:testlearn::_Ltestlearn ]
    #
    #After finding learn records tagged with this
    #learn record, find this learn record too so user
    #can see full context of linked/tagged
    #records/thoughts/notes/etc..
    Set Variable [ $findSelfAlso; Value:testlearn::_Ltestlearn ]
    End If
    #
    #Select the kind of tag to be found. We grab
    #only the first three letters because the shortest
    #menu item 'key' has only three letters, and because
    #we need the same number of characters/letters
    #to make up this variable so when it is added to
    #the first part of an item in the found list below
    #it can be removed by the system which only
    #can be told how many characters to remove.
    #This variable is thus a meta tag added to an
    #ID number to tell the system from which menu
    #did this item come. This meta tag or tag allows
    #us to make a list of ID numbers from various
    #tag menus: key, node, medium, etc.
    If [ $findSelfAlso = "" ]
    Set Variable [ $menu; Value:Left ( $$citationMatch ; 1 ) ]
    Else
    Set Variable [ $menu; Value:"L" ]
    End If
    #
    #Get the name of the tag for error message
    #at bottom of this script if needed.
    If [ Right ( Get (LayoutName) ; 4 ) = "cite" ]
    Set Variable [ $name; Value:reference::referenceShort ]
    Else If [ Right ( Get (LayoutName) ; 4 ) = "find" or Get (LayoutTableName) = "tagMenus" ]
    Set Variable [ $name; Value:tagMenus::tag ]
    Else If [ Right ( Get (LayoutName) ; 4 ) = "test" ]
    Set Variable [ $name; Value:testSubsectionTemplate::name ]
    Else If [ Right ( Get (LayoutName) ; 2 ) = "tl" ]
    Set Variable [ $name; Value:testlearn::note ]
    End If
    #
    #As going to the other window will be involved
    #stop the record load script on that window until
    #this script is finished to speed things up and
    #stop flashing effect.
    Set Variable [ $$stoploadCitation; Value:1 ]
    #
    #Go to the other window and start the find process.
    Select Window [ Name: "Learn"; Current file ]
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    Enter Find Mode [ ]
    // Set Field [ testlearn::filterFind; "main" & ¶ ]
    #
    #
    If [ $menu = "k" ]
    Set Field [ testlearn::kKeywordPrimary; $tag ]
    Else If [ $menu = "n" ]
    Set Field [ testlearn::kNodePrimary; $tag ]
    Else If [ $menu = "r" or $menu = "L" ]
    Set Field [ testlearn::kcreference; $tag ]
    Else If [ $menu = "t" ]
    Set Field [ testlearn::kctestSubsectionInfo; "*" & $tag & ¶ ]
    Else If [ $menu = "b" ]
    Set Field [ testlearn::kcbrainstorm; "*" & $tag & ¶ ]
    End If
    #
    #
    #If this is the first find, note this and perform
    #the find.
    If [ $$firstFind = "" ]
    Set Variable [ $$firstFind; Value:1 ]
    Set Variable [ $$found; Value:$menu & $tag & ¶ ]
    Perform Find [ ]
    #
    #If nothing was found capture the error message
    #as steps before showing the error message will
    #delete it from the system and we need it to
    #activate the error message below if there was
    #an error.
    Set Variable [ $error; Value:Get (LastError) ]
    #
    #If this is not the first find and the item that
    #the user clicked on to start this script has
    #not already been found, then add items tagged
    #with it to the current set of found records.
    Else If [ $$firstFind = 1 ]
    If [ $menu & $tag & ¶ ≠ FilterValues ( $$found ; $menu & $tag) ]
    Extend Found Set [ ]
    #
    #If nothing was found capture the error message
    #as steps before showing the error message will
    #delete it from the system and we need it to
    #activate the error message below if there was
    #an error.
    Set Variable [ $error; Value:Get (LastError) ]
    #
    #Add the tag from the list of found tagged records.
    Set Variable [ $found; Value:$$found ]
    Set Variable [ $$found; Value:$menu & $tag & ¶ & $found ]
    #
    #If this is not the first find and the item that
    #the user clicked on to start this script has
    #already been found, then remove tag from the
    #the list of found tagged records.
    Else If [ $menu & $tag & ¶= FilterValues ( $$found ; $menu & $tag & ¶) ]
    Set Variable [ $found; Value:$$found ]
    Set Variable [ $$found; Value:Substitute ( $found ; $menu & $tag & ¶ ; "" ) ]
    #
    #Enter browse mode to clear the find selections
    #set at the beginning of this script.
    Enter Browse Mode
    #
    #If after removing this item from the list of found
    #tagged records the list is empty, perform a find
    #that will result in zero records being found
    #to reflect the fact that the user currently has
    #an empty found list.
    If [ $$found = "" ]
    Set Variable [ $$firstFind ]
    Enter Find Mode [ ]
    #
    #
    #Since ID numbers are numbers, the text
    #'findnoRecords' entered in the ID field will result
    #in zero records being found.
    Set Field [ testlearn::kKeywordPrimary; "findNoRecords" ]
    #
    #
    Perform Find [ ]
    #
    #If after removing this item from the $$found list,
    #the list is not empty, refind all records still on
    #the list one tag at a time.
    Else If [ $$found ≠ "" ]
    #
    #Create a copy of the found list. Items will be
    #removed from this one at a time as they are found.
    Set Variable [ $findList; Value:$$found ]
    #
    #Get the menu item name so system will know
    #what field to put the ID number into to find
    #records tagged with this item.
    Set Variable [ $menu; Value:Left ( ( GetValue ( $findList ; 1 ) ) ; 1 ) ]
    #
    #Get the ID number of the tag to be found.
    #(the number 42 is a joke, essentially the number
    #needs to be big enough to capture the full ID number
    #which is much shorter, but overkill doesn't hurt)
    #FYI: joke is from Hitchhiker's Guide to the Galaxy
    Set Variable [ $find; Value:Middle ( ( GetValue ( $findList ; 1 ) ) ; 2 ; 42 ) ]
    #
    #Remove it from the list of tags to be found.
    Set Variable [ $subtract; Value:$findList ]
    Set Variable [ $findList; Value:Substitute ( $subtract ; $menu & $find & ¶ ; "" ) ]
    #
    #Find main window records tagged with it.
    Enter Find Mode [ ]
    Set Field [ testlearn::filterFind; "main" & ¶ ]
    #
    #
    If [ $menu = "k" ]
    Set Field [ testlearn::kKeywordPrimary; $find ]
    Else If [ $menu = "n" ]
    Set Field [ testlearn::kNodePrimary; $find ]
    Else If [ $menu = "r" or $menu = "L" ]
    Set Field [ testlearn::kcreference; $find ]
    Else If [ $menu = "t" ]
    Set Field [ testlearn::kctestSubsectionInfo; "*" & $find & ¶ ]
    Else If [ $menu = "b" ]
    Set Field [ testlearn::kcbrainstorm; "*" & $find & ¶ ]
    End If
    #
    #
    #If there is more than one item on the $$found
    #list, then find the rest of records tagged with
    #this items/tags.
    Perform Find [ ]
    Loop
    #
    #When the list is empty stop finding stuff.
    Exit Loop If [ ValueCount ( $findList ) = 0 ]
    #
    #Get the menu item name so system will know
    #what field to put the ID number into to find
    #records tagged with this item.
    Set Variable [ $menu; Value:Left ( ( GetValue ( $findList ; 1 ) ) ; 1 ) ]
    #
    #Get the ID number of the tag to be found.
    Set Variable [ $find; Value:Middle ( ( GetValue ( $findList ; 1 ) ) ; 2 ; 42 ) ]
    #
    #Remove it from the list of tags to be found.
    Set Variable [ $subtract; Value:$findList ]
    Set Variable [ $findList; Value:Substitute ( $subtract ; $menu & $find & ¶ ; "" ) ]
    #
    #Find main window records tagged with it.
    Enter Find Mode [ ]
    Set Field [ testlearn::filterFind; "main" & ¶ ]
    #
    #
    If [ $menu = "k" ]
    Set Field [ testlearn::kKeywordPrimary; $find ]
    Else If [ $menu = "n" ]
    Set Field [ testlearn::kNodePrimary; $find ]
    Else If [ $menu = "r" or $menu = "L" ]
    Set Field [ testlearn::kcreference; $find ]
    Else If [ $menu = "t" ]
    Set Field [ testlearn::ktestSubsection; $find ]
    Else If [ $menu = "b" ]
    Set Field [ testlearn::kcbrainstorm; $find ]
    End If
    #
    #
    Extend Found Set [ ]
    End Loop
    End If
    End If
    End If
    #
    #Refind any Other Keyword items.
    If [ $$foundOther ≠ "" ]
    #
    #Create a copy of the found list. Items will be
    #removed from this one at a time as they are found.
    Set Variable [ $findList; Value:$$foundOther ]
    #
    #Get the menu item name so system will know
    #what field to put the ID number into to find
    #records tagged with this item.
    Set Variable [ $menu; Value:Left ( ( GetValue ( $findList ; 1 ) ) ; 1 ) ]
    #
    #Get the ID number of the tag to be found.
    Set Variable [ $find; Value:Middle ( ( GetValue ( $findList ; 1 ) ) ; 2 ; 42 ) ]
    #
    #Remove it from the list of tags to be found.
    Set Variable [ $subtract; Value:$findList ]
    Set Variable [ $findList; Value:Substitute ( $subtract ; $menu & $find & ¶ ; "" ) ]
    #
    #Find main window records tagged with it.
    Enter Find Mode [ ]
    Set Field [ testlearn::filterFind; "main" & ¶ ]
    #
    #
    If [ $menu = "k" ]
    Set Field [ testlearn::kcKeywordOther; $find ]
    Else If [ $menu = "n" ]
    Set Field [ testlearn::kNodeOther; $find ]
    End If
    #
    #
    Extend Found Set [ ]
    #
    #If there is more than one item on the $$foundOther
    #list, then find the rest of records tagged with
    #this items/tags.
    Loop
    #
    #When the list is empty stop finding stuff.
    Exit Loop If [ ValueCount ( $findList ) = 0 ]
    #
    #Get the menu item name so system will know
    #what field to put the ID number into to find
    #records tagged with this item.
    Set Variable [ $menu; Value:Left ( ( GetValue ( $findList ; 1 ) ) ; 1 ) ]
    #
    #Get the ID number of the tag to be found.
    Set Variable [ $find; Value:Middle ( ( GetValue ( $findList ; 1 ) ) ; 2 ; 42 ) ]
    #
    #Remove it from the list of tags to be found.
    Set Variable [ $subtract; Value:$findList ]
    Set Variable [ $findList; Value:Substitute ( $subtract ; $menu & $find & ¶ ; "" ) ]
    #
    #Find main window records tagged with it.
    Enter Find Mode [ ]
    Set Field [ testlearn::filterFind; "main" & ¶ ]
    #
    #
    If [ $menu = "k" ]
    Set Field [ testlearn::kcKeywordOther; $find ]
    Else If [ $menu = "n" ]
    Set Field [ testlearn::kNodeOther; $find ]
    End If
    #
    #
    Extend Found Set [ ]
    End Loop
    End If
    #
    #After finding learn records tagged with this
    #learn record, find this learn record too so user
    #can see full context of linked/tagged
    #records/thoughts/notes/etc..
    If [ TEMP::InventoryLibraryYN = "" and $error = 0 ]
    If [ Filter ( $$found ; "L" ) = "L" ]
    #
    #Create a copy of the found list. Items will be
    #removed from this one at a time as they are found.
    Set Variable [ $LearnTagList; Value:$$found ]
    Loop
    #
    #Get the menu item name so system will know
    #what field to put the ID number into to find
    #records tagged with this item.
    Set Variable [ $menu; Value:Left ( ( GetValue ( $LearnTagList ; 1 ) ) ; 1 ) ]
    #
    #Get the ID number of the tag to be found.
    #(the number 42 is a joke, essentially the number
    #needs to be big enough to capture the full ID number
    #which is much shorter, but overkill doesn't hurt)
    #FYI: joke is from Hitchhiker's Guide to the Galaxy
    Set Variable [ $find; Value:Middle ( ( GetValue ( $LearnTagList ; 1 ) ) ; 2 ; 42 ) ]
    #
    #Remove it from the list of tags to be found.
    Set Variable [ $subtract; Value:$LearnTagList ]
    Set Variable [ $LearnTagList; Value:Substitute ( $subtract ; $menu & $find & ¶ ; "" ) ]
    #
    If [ $menu = "L" ]
    Enter Find Mode [ ]
    Set Field [ testlearn::_Ltestlearn; $find ]
    Extend Found Set [ ]
    End If
    #
    #When the list is empty stop finding stuff.
    Exit Loop If [ ValueCount ( $LearnTagList ) = 0 ]
    #
    End Loop
    End If
    End If
    #
    #Sort according to current sort in Main window.
    Sort Records [ ] [ No dialog ]
    #
    #Go to first record and preform record load script.
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    Set Variable [ $$stoploadCitation ]
    Perform Script [ “loadLearnOrRefMainRecord” ]
    #
    #Return to Tag Menus window.
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    #If no records where found tell user why and
    #remove tag ID from list of tags attached to records
    #in the main window.
    If [ $error = 401 ]
    If [ $$firstFind = "" ]
    Set Variable [ $$found ]
    Else If [ $$firstFind ≠ "" ]
    Set Variable [ $$found; Value:Substitute ( $found ; $menu & $tag & ¶ ; "" ) ]
    End If
    Refresh Window
    #
    #
    If [ $$citationMatch = "key" ]
    Show Custom Dialog [ Message: "'" & $name & "'" & " is not in use as a primary keyword."; Default Button: “OK”, Commit: “No” ]
    Else If [ $$citationMatch = "node" ]
    Show Custom Dialog [ Message: "'" & $name & "'" & " is not in use as a primary node."; Default Button: “OK”, Commit: “No” ]
    Else If [ $$citationMatch = "ref" ]
    Show Custom Dialog [ Message: "'" & Left ( $name ; 65 ) & "..." & "'" & " is not in use."; Default Button: “OK”, Commit: “No” ]
    Else If [ $$citationMatch = "learn" ]
    Show Custom Dialog [ Message: "'" & Left ( $name ; 65 ) & "..." & "'" & " is not in use."; Default Button: “OK”, Commit: “No” ]
    Else If [ $$citationMatch = "test" ]
    Show Custom Dialog [ Message: "'" & $name & "'" & " is not in use."; Default Button: “OK”, Commit: “No” ]
    Else If [ $$citationMatch = "brainstorm" ]
    Show Custom Dialog [ Message: "'" & $name & "'" & " is not in use."; Default Button: “OK”, Commit: “No” ]
    End If
    #
    #
    End If

Fields used in this script

    testlearn::picture
    testlearn::kshowReferencedMedia
    reference::picture
    reference::showMedia
    reference::URL
    reference::kfileLocation
    reference::fileName
    testlearn::_Ltestlearn
    reference::_Lreference
    tagMenus::_Ltag
    testSubsectionTemplate::_LtestSubsection
    reference::referenceShort
    tagMenus::tag
    testSubsectionTemplate::name
    testlearn::note
    testlearn::filterFind
    testlearn::kKeywordPrimary
    testlearn::kNodePrimary
    testlearn::kcreference
    testlearn::kctestSubsectionInfo
    testlearn::kcbrainstorm
    testlearn::ktestSubsection
    testlearn::kcKeywordOther
    testlearn::kNodeOther
    TEMP::InventoryLibraryYN

Scripts used in this script

    showCitationPicture1inNewWindow
    loadLearnOrRefMainRecord

Layouts used in this script

Tables used in this script

    TEMP
    reference
    tag
    testSubsectionTemplate
    testlearn

Table occurrences used by this script

    TEMP
    reference
    tagMenus
    testSubsectionTemplate
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [findPrimaryTL]	Parent Folder: [tagMenu]	Next Script: [gotoLessLayoutsTag]
Script Name	gotoLessDetailLayout
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    testMenuTestItemMORE

Scripts that use this script

Script Definition
Script Steps

    #
    #If in add mode, keep user on the evenMore layout.
    If [ $$add = 1 ]
    Show Custom Dialog [ Message: "Turn off add mode (click 'add' button) to reduce number of pictures shown and full link names."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #Reveal more or fewer pictures and links for tag.
    If [ Right ( Get (LayoutName) ; 8 ) = "evenmore" ]
    Go to Layout [ “testMenuTestItemMORE” (tagMenus) ]
    Else If [ Right ( Get (LayoutName) ; 4 ) = "more" ]
    Go to Layout [ “setupTestItem” (tagMenus) ]
    End If
    #
    #Remember layout user is on so they can be
    #returned to correct view.
    Set Field [ TEMP::DetailmoreORLessLayout; Get (LayoutName) ]

Fields used in this script

    TEMP::DetailmoreORLessLayout

Scripts used in this script

Layouts used in this script

    testMenuTestItemMORE
    setupTestItem

Tables used in this script

    TEMP

Table occurrences used by this script

    TEMP

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [gotoLessDetailLayout]	Parent Folder: [tagMenu]	Next Script: [gotoLessLayoutsTL]
Script Name	gotoLessLayoutsTag
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #If in add mode, keep user on the evenMore layout.
    If [ $$add = 1 ]
    Show Custom Dialog [ Message: "Turn off add mode (click 'add' button) to reduce number of pictures shown and full link names."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #Reveal more or fewer pictures and links for tag.
    If [ Right ( Get (LayoutName) ; 8 ) = "evenmore" ]
    If [ Left (Get (LayoutName) ; 1) = "l" ]
    Go to Layout [ “ltagNK4” (tagMenus) ]
    Else If [ Left (Get (LayoutName) ; 1) = "r" ]
    Go to Layout [ “ReferenceMenu2keywordOrNode4” (tagMenus) ]
    Else If [ Left (Get (LayoutName) ; 1) = "d" ]
    Go to Layout [ “defaultNode3” (tagMenus) ]
    End If
    Else If [ Right ( Get (LayoutName) ; 4 ) = "more" ]
    If [ Left (Get (LayoutName) ; 1) = "l" ]
    Go to Layout [ “ltagNK3” (tagMenus) ]
    Else If [ Left (Get (LayoutName) ; 1) = "r" ]
    Go to Layout [ “ReferenceMenu2keywordOrNode2” (tagMenus) ]
    Else If [ Left (Get (LayoutName) ; 1) = "d" ]
    Go to Layout [ “defaultNode2” (tagMenus) ]
    End If
    End If
    #
    #Remember layout user is on so they can be
    #returned to correct view.
    If [ $$citationMatch = "node" ]
    If [ Left (Get (LayoutName) ; 1) = "l" ]
    Set Field [ TEMP::layoutLtagN; Get (LayoutName) ]
    Else If [ Left (Get (LayoutName) ; 1) = "r" ]
    Set Field [ TEMP::layoutRtagN; Get (LayoutName) ]
    Else If [ Left (Get (LayoutName) ; 1) = "d" ]
    Set Field [ TEMP::DefaultmoreORLessLayoutNode; Get (LayoutName) ]
    End If
    Else If [ $$citationMatch = "key" ]
    If [ Left (Get (LayoutName) ; 1) = "l" ]
    Set Field [ TEMP::layoutLtagK; Get (LayoutName) ]
    Else If [ Left (Get (LayoutName) ; 1) = "r" ]
    Set Field [ TEMP::layoutRtagK; Get (LayoutName) ]
    End If
    End If

Fields used in this script

    TEMP::layoutLtagN
    TEMP::layoutRtagN
    TEMP::DefaultmoreORLessLayoutNode
    TEMP::layoutLtagK
    TEMP::layoutRtagK

Scripts used in this script

Layouts used in this script

    ltagNK4
    ReferenceMenu2keywordOrNode4
    defaultNode3
    ltagNK3
    ReferenceMenu2keywordOrNode2
    defaultNode2

Tables used in this script

    TEMP

Table occurrences used by this script

    TEMP

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [gotoLessLayoutsTag]	Parent Folder: [tagMenu]	Next Script: [gotoMainFromTestTagMenus]
Script Name	gotoLessLayoutsTL
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #Reveal more or fewer pictures and links for tag.
    If [ Right ( Get (LayoutName) ; 8 ) = "evenmore" ]
    If [ Left (Get (LayoutName) ; 1) = "l" ]
    Go to Layout [ “learn5” (testlearn) ]
    Else If [ Left (Get (LayoutName) ; 1) = "t" ]
    End If
    Else If [ Get (LayoutName) = "learnBigPicture" ]
    If [ Left (Get (LayoutName) ; 1) = "l" ]
    Go to Layout [ “learn3” (testlearn) ]
    Else If [ Left (Get (LayoutName) ; 1) = "t" ]
    End If
    Else If [ Right ( Get (LayoutName) ; 4 ) = "more" and Right ( Get (LayoutName) ; 8 ) ≠ "evenmore" and Right ( Get (LayoutName) ; 10 ) ≠ "BigPicture" ]
    If [ Left (Get (LayoutName) ; 1) = "l" ]
    Go to Layout [ “learn2” (testlearn) ]
    Else If [ Left (Get (LayoutName) ; 1) = "t" ]
    End If
    End If
    #
    #Remember layout user is on so they can be
    #returned to correct view.
    If [ Left (Get (LayoutName) ; 1) = "l" ]
    Set Field [ TEMP::layoutLmain; Get (LayoutName) ]
    Else If [ Left (Get (LayoutName) ; 1) = "t" ]
    End If

Fields used in this script

    TEMP::layoutLmain

Scripts used in this script

Layouts used in this script

    learn5
    learn3
    learn2

Tables used in this script

    TEMP

Table occurrences used by this script

    TEMP

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [gotoLessLayoutsTL]	Parent Folder: [tagMenu]	Next Script: [gotoMoreDetailLayout]
Script Name	gotoMainFromTestTagMenus
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    testInfo
    TestInfoReference
    testMenuTestItem
    testMenuNoTag
    reportTestResult
    reportTestResultLocked
    reportTagItem
    reportTagInfo

Scripts that use this script

Script Definition
Script Steps

    Go to Field [ ]
    Select Window [ Name: "Test"; Current file ]
    Select Window [ Name: "Setup"; Current file ]
    Select Window [ Name: "Report"; Current file ]

Fields used in this script

Scripts used in this script

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [gotoMainFromTestTagMenus]	Parent Folder: [tagMenu]	Next Script: [gotoSetupReport]
Script Name	gotoMoreDetailLayout
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    testMenuTestItemEdit
    testMenuTestItemMORE

Scripts that use this script

Script Definition
Script Steps

    #
    #If in add mode, keep user on the evenMore layout.
    If [ $$add = 1 ]
    Show Custom Dialog [ Message: "Turn off add mode (click 'add' button) to reduce number of pictures shown and full link names."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #Reveal more or fewer pictures and links for tag.
    If [ Right ( Get (LayoutName) ; 8 ) = "testItem" ]
    Go to Layout [ “testMenuTestItemMORE” (tagMenus) ]
    Else If [ Right ( Get (LayoutName) ; 4 ) = "more" ]
    Go to Layout [ “addMenuTestItem” (tagMenus) ]
    End If
    #
    #Remember layout user is on so they can be
    #returned to correct view.
    Set Field [ TEMP::DetailmoreORLessLayout; Get (LayoutName) ]

Fields used in this script

    TEMP::DetailmoreORLessLayout

Scripts used in this script

Layouts used in this script

    testMenuTestItemMORE
    addMenuTestItem

Tables used in this script

    TEMP

Table occurrences used by this script

    TEMP

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [gotoMoreDetailLayout]	Parent Folder: [tagMenu]	Next Script: [hideFormTextTestItemsFTs]
Script Name	gotoSetupReport
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    Close Window [ Name: "Cover Page"; Current file ]
    New Window [ Name: "Cover Page"; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “setupReport” (testSubsectionTemplate) ]

Fields used in this script

Scripts used in this script

Layouts used in this script

    setupReport

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [gotoSetupReport]	Parent Folder: [tagMenu]	Next Script: [insertGenericNumberOrTimeReference]
Script Name	hideFormTextTestItemsFTs
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    testMenuTestItem
    reportTagItem

Scripts that use this script

Script Definition
Script Steps

    #
    #Prevent test item variables being loaded as this
    #script moves thru them.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    #
    #
    #
    #If the hideFT preference was to hide them,
    #then switch the preference to show them.
    If [ TEMP::testHideFormTextItemsFTs = 1 ]
    Set Field [ TEMP::testHideFormTextItemsFTs; "" ]
    #
    #If this list has FT items, then find them.
    If [ $$noFT_ItemsFound = "" ]
    #
    #Find test items for section.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Enter Find Mode [ ]
    Set Field [ tagMenuTestItemGroup::match; TEMP::ktestItemSubsection & ¶ ]
    Perform Find [ ]
    #
    #To insure the 'sort' button will next sort
    #alphabetically, note that the current sort is
    #by category/group.
    Set Field [ TEMP::sortTestItem; "cat" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuTestItemGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuTestItemGroup::name; ascending tagMenuTestItemGroup::_Lgroup; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    Scroll Window [ Home ]
    #
    #
    #If this list has no FT items, then inform user.
    Else
    Show Custom Dialog [ Message: "Your preference to now show FT items (if there are any to show) has been saved. This list has no FT items to show."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #
    #
    #If the hideFT preference was to show them,
    #then switch the preference to hide them.
    Else
    Set Field [ TEMP::testHideFormTextItemsFTs; 1 ]
    #
    #Now go to each test item and omit
    #the FT items.
    Go to Record/Request/Page [ First ]
    Loop
    Go to Field [ ]
    If [ tagMenus::notesOrCopyright = "FT" ]
    Omit Record
    Else
    Go to Record/Request/Page [ Next; Exit after last ]
    End If
    End Loop
    End If
    #
    #Now go the first record and scroll
    #the window to the top.
    Go to Record/Request/Page [ First ]
    Set Variable [ $$stopLoadTagRecord ]
    Scroll Window [ Home ]
    #
    #Load this records variables.
    Perform Script [ “loadTagRecord” ]
    #
    #

Fields used in this script

    TEMP::testHideFormTextItemsFTs
    TEMP::ktestItemSubsection
    tagMenuTestItemGroup::match
    TEMP::sortTestItem
    tagMenuTestItemGroup::orderOrLibraryType
    tagMenuTestItemGroup::name
    tagMenuTestItemGroup::_Lgroup
    tagMenus::orderOrLock
    tagMenus::tag
    tagMenus::notesOrCopyright

Scripts used in this script

    loadTagRecord

Layouts used in this script

Tables used in this script

    TEMP
    tag
    tagGroup

Table occurrences used by this script

    TEMP
    tagMenuTestItemGroup
    tagMenus

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [hideFormTextTestItemsFTs]	Parent Folder: [tagMenu]	Next Script: [insertGenericTimeReference]
Script Name	insertGenericNumberOrTimeReference
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    LearnTextWindow
    LearnTextWindow_iDevice

Scripts that use this script

    insertGenericTimeReference

Script Definition
Script Steps

    #
    #
    #Admin tasks.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #Figure out which template the user wants
    #to insert.
    If [ $$andTime ≠ "" ]
    Set Variable [ $template; Value:"00:00:00" ]
    Set Variable [ $$andTime ]
    Else
    Set Variable [ $template; Value:"pdf #, pp#" ]
    End If
    #
    #Figure out if they are using it in their
    #own words or in a quote.
    Show Custom Dialog [ Message: "In your own words (" & $template & ") ?" & ¶ & " OR" & ¶ & " In a quote [" & $template & "] ?"; Default Button: “(own)”, Commit: “Yes”; Button 2: “[quote]”, Commit: “No”; Button 3: “cancel”, Commit: “No” ]
    If [ Get (LastMessageChoice) = 3 ]
    Exit Script [ ]
    End If
    If [ Get (LastMessageChoice) = 2 ]
    Set Variable [ $template; Value:"[" & $template & "]" ]
    End If
    If [ Get (LastMessageChoice) = 1 ]
    Set Variable [ $template; Value:"(" & $template & ")" ]
    End If
    #
    #Select the Edit window.
    Select Window [ Name: "Edit"; Current file ]
    #
    #Make sure the cursor is in active field and if
    #not tell them to click in one.
    If [ Get ( ActiveFieldName ) = "" ]
    Show Custom Dialog [ Message: "Click into the text field, and then click exactly where you want — " & Trim ($template) & " — inserted."; Default Button: “OK”, Commit: “Yes” ]
    #
    #
    Else
    #Insert template.
    Insert Calculated Result [ $template ]
    End If
    #
    #

Fields used in this script

Scripts used in this script

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [insertGenericNumberOrTimeReference]	Parent Folder: [tagMenu]	Next Script: [insertRefenceToRefenceAndPageNumber]
Script Name	insertGenericTimeReference
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    LearnTextWindow
    LearnTextWindow_iDevice

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Note that user clicked the time template
    #button, and pass that on to the next script
    #to peform this insert.
    Set Variable [ $$andTime; Value:1 ]
    Perform Script [ “insertGenericNumberOrTimeReference” ]
    #
    #

Fields used in this script

Scripts used in this script

    insertGenericNumberOrTimeReference

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [insertGenericTimeReference]	Parent Folder: [tagMenu]	Next Script: [insertRefenceToRefenceAndTime]
Script Name	insertRefenceToRefenceAndPageNumber
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    learnMenu3CitePickAReference

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Note that user clicked the page # template
    #button, and pass that on to the next script
    #to peform this insert.
    Set Variable [ $$andPageNumber; Value:1 ]
    Perform Script [ “insertReferenceToReference” ]
    #
    #

Fields used in this script

Scripts used in this script

    insertReferenceToReference

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [insertRefenceToRefenceAndPageNumber]	Parent Folder: [tagMenu]	Next Script: [insertReferenceToReference]
Script Name	insertRefenceToRefenceAndTime
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    learnMenu3CitePickAReference

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Note that user clicked the time template
    #button, and pass that on to the next script
    #to peform this insert.
    Set Variable [ $$andTime; Value:1 ]
    Perform Script [ “insertReferenceToReference” ]
    #
    #

Fields used in this script

Scripts used in this script

    insertReferenceToReference

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [insertRefenceToRefenceAndTime]	Parent Folder: [tagMenu]	Next Script: [loadBrainstormTags]
Script Name	insertReferenceToReference
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    learnMenu3CitePickAReference

Scripts that use this script

    insertRefenceToRefenceAndPageNumber
    insertRefenceToRefenceAndTime

Script Definition
Script Steps

    #
    #
    #Admin tasks.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    Go to Field [ ]
    #
    #Figure out which template the user wants
    #to insert.
    If [ $$referenceToInsert = "" ]
    Set Variable [ $$referenceToInsert; Value:Case ( $$andPageNumber ≠ "" ; TEMP::referenceInsertAndPage ; Case ( $$andTime ≠ "" ; TEMP::referenceInsertAndTime ; TEMP::referenceInsert ) ) ]
    Else
    Set Variable [ $referenceToAddToInsert; Value:Case ( $$andPageNumber ≠ "" ; TEMP::referenceInsertAndPage ; Case ( $$andTime ≠ "" ; TEMP::referenceInsertAndTime ; TEMP::referenceInsert ) ) ]
    Set Variable [ $$referenceToInsert; Value:$$referenceToInsert & "; " & $referenceToAddToInsert ]
    End If
    Set Variable [ $$andPageNumber ]
    Set Variable [ $$andTime ]
    #
    #Ask user if they would like to continue adding
    #refernces or close the window to continue
    #working on their note if there is more than one
    #record.
    If [ Get (FoundCount) ≠ 1 ]
    Show Custom Dialog [ Message: "Your reference so far >> " & Case ( TEMP::referenceInsertBeforeOrAfterPeriod = 1 or TEMP::referenceInsertBeforeOrAfterPeriod = "" ; "(" & $$referenceToInsert & ")" ; "[" & $$referenceToInsert & "]" ); Default Button: “OK”, Commit: “Yes” ]
    Show Custom Dialog [ Message: "Close this window and insert it?" & ¶ & " or" & ¶ & "Add more references to it?"; Default Button: “close”, Commit: “Yes”; Button 2: “more”, Commit: “No”; Button 3: “cancel”, Commit: “No” ]
    If [ Get (LastMessageChoice) = 2 or Get (LastMessageChoice) = 3 ]
    Pause/Resume Script [ Indefinitely ]
    Exit Script [ ]
    End If
    End If
    #
    #Clear this variable to reveal the edit note controls.
    Set Variable [ $$hideEditNoteControls ]
    #
    #Determine if punctuation for reference.
    If [ TEMP::referenceInsertBeforeOrAfterPeriod = 1 or TEMP::referenceInsertBeforeOrAfterPeriod = "" ]
    Set Variable [ $$referenceToInsert; Value:"(" & $$referenceToInsert & ")" ]
    Else
    Set Variable [ $$referenceToInsert; Value:"[" & $$referenceToInsert & "]" ]
    End If
    #
    #Close window and restart the pause, so the
    #user cannot leave the selected window until
    #they are finished using it.
    Close Window [ Name: "Insert Reference"; Current file ]
    #
    #Insert the text block.
    If [ Length ( $$referenceToInsert ) ≠ 2 ]
    Insert Calculated Result [ $$referenceToInsert ]
    End If
    Set Variable [ $$referenceToInsert ]
    Refresh Window
    #
    Pause/Resume Script [ Indefinitely ]
    #
    #

Fields used in this script

    TEMP::referenceInsertAndPage
    TEMP::referenceInsertAndTime
    TEMP::referenceInsert
    TEMP::referenceInsertBeforeOrAfterPeriod

Scripts used in this script

Layouts used in this script

Tables used in this script

    TEMP

Table occurrences used by this script

    TEMP

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [insertReferenceToReference]	Parent Folder: [tagMenu]	Next Script: [loadLearnTagRecord]
Script Name	loadBrainstormTags
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    addORremovePrimaryTag
    deleteCPPPBtags
    menuBrainstorm
    newTagMenuTagGroup

Script Definition
Script Steps

    #
    #
    #Capture recordID to conditionally format current record.
    If [ $$stopLoadTagRecord ≠ 1 ]
    Go to Field [ ]
    #
    #Get tag's group key for 'move' button script.
    Set Variable [ $$groupOLD; Value:tagMenus::kGroupOrTest ]
    #
    #Get tag's copyright key for 'select' button
    #in case this node is locked, and the copyright
    #has to be put back to the orginal after the
    #user is informed they cannot change a locked
    #record's copyright.
    Set Variable [ $$oldCopyright; Value:tagMenus::notesOrCopyright ]
    #
    #The 'brainstorm' variable may have more than one
    #key in it. So we need a variable with just this
    #record's keys in it to conditionally format all
    #learn window records tagged with it.
    Set Variable [ $$tagBrainstorm; Value:tagMenus::_Ltag ]
    Set Field [ TEMP::kcbrainstorm; tagMenus::_Ltag ]
    Set Variable [ $$BrainstormOrTestID; Value:Get (RecordID) ]
    #
    #The next conditional formatting variable needs
    #to be cleared in case there are no records in
    #the learn window tagged with this tag record.
    #It might contain a tag ID from the selecting
    #the previous record which did have at least 1
    #learn record tagged with it. (See the end of
    #this script where it is actually created.)
    Set Variable [ $$atLeastOneRecord ]
    #
    Set Variable [ $$stopLoadCitation; Value:1 ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    New Window [ Height: 3; Width: 3; Top: -1000; Left: -1000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “learn2” (testlearn) ]
    #
    #Prepare system to stop error message about no
    #records being found as the user may not have
    #yet tagged any learn records with this brainstorm tag.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    Enter Find Mode [ ]
    Set Field [ testlearn::kcbrainstorm; "*" & $$tagBrainstorm ]
    Perform Find [ ]
    Set Variable [ $atLeastOneRecord; Value:If ( Get ( FoundCount ) = 0 ; "" ; 1) ]
    Close Window [ Current Window ]
    Set Variable [ $$stopLoadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    #
    #This won't work without going through every
    #record on the main window to check if it is tagged
    #with this record, and that could take a really long
    #time.
    #So if there are no records tagged with this brainstorm
    #then make sure the Main window is sorted by
    #date and not by brainstorm item sort order.
    If [ $atLeastOneRecord ≠ 1 ]
    #
    #The 'brainstorm' variable may have more than one
    #key in it. So we need a variable with just this
    #records keys in it to conditionally format all
    #learn window records tagged with it.
    Set Variable [ $$tagBrainstorm; Value:tagMenus::_Ltag ]
    #
    Select Window [ Name: "Learn"; Current file ]
    Refresh Window
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::orderInventoryGroupNumber; ascending testlearn::note; ascending ] [ Restore; No dialog ]
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::date; descending testlearn::timestamp; descending ] [ Restore; No dialog ]
    End If
    Set Field [ TEMP::TLBrainstormSort; "" ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    #
    Else If [ $atLeastOneRecord = 1 ]
    #
    #The formatting of brainstorm tagged records in
    #the Learn window is linked to the current
    #record in the tag window. THE ONLY WAY to
    #know this in the Tag window (that there are
    #tagged records in the learn window) is to
    #make a $$ variable. This way the system will
    #remember it is conditionally formatting learn
    #records when the active learn record is not
    #tagged with the current record in the tag window.
    Set Variable [ $$atLeastOneRecord; Value:$$tagBrainstorm ]
    #
    #The 'brainstorm' variable may have more than one
    #key in it. So we need a variable with just this
    #record's keys in it to conditionally format all
    #learn window records tagged with it.
    Set Variable [ $$tagBrainstorm; Value:tagMenus::_Ltag ]
    Set Field [ TEMP::kcbrainstorm; tagMenus::_Ltag ]
    Set Variable [ $$BrainstormOrTestID; Value:Get (RecordID) ]
    If [ $$add = 1 and $$citationMatch = $$addCitationMatch ]
    Else If [ $$add = "" ]
    End If
    Refresh Window
    #
    #Just in case user was in nonTag field on this
    #window when user clicked a menu button on
    #the other window, exit all fields.
    Set Field [ TEMP::TLBrainstormSort; 1 ]
    Set Variable [ $recordNumber; Value:Get (RecordNumber) ]
    Select Window [ Name: "Learn"; Current file ]
    #
    #Insure user can be returned to their Learn
    #record selection at the end of this script.
    Set Variable [ $$returnFocusToThisRecord; Value:testlearn::_Ltestlearn ]
    #
    #Stop citation load script for the following find.
    Set Variable [ $$stoploadCitation; Value:1 ]
    #
    #In case the user is not show all records, find
    #this brainstorm tag's learn records.
    Enter Find Mode [ ]
    Set Field [ testlearn::kcbrainstorm; "*" & $$tagBrainstorm ]
    Extend Found Set [ ]
    #
    #Return user to seleteced learn record if they
    #are not already on it.
    If [ $$returnFocusToThisRecord ≠ testlearn::_Ltestlearn and $$returnFocusToThisRecord ≠ "" ]
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ $$returnFocusToThisRecord = testlearn::_Ltestlearn ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    Set Variable [ $$stoploadCitation ]
    Set Variable [ $$returnFocusToThisRecord ]
    End If
    Perform Script [ “loadLearnOrRefMainRecord” ]
    #
    Perform Script [ “sortTestOrBrainstormTaggedLearnRecords” ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Go to Record/Request/Page [ $recordNumber ] [ No dialog ]
    Set Variable [ $$tagBrainstorm; Value:tagMenus::_Ltag ]
    Select Window [ Name: "Learn"; Current file ]
    Go to Field [ ]
    Refresh Window
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    End If
    #
    #Unlike 'exit script', 'halt script' will halt all scripts
    #currently active. So if user was on another tag
    #record and then clicked on the add tag button
    #for another record, this script will launch.
    #Problem is, because the user may really
    #want to add this tag to the current item in the
    #Learn window, after this script runs and finds
    #zero records for example (which could happen)
    #the add to tag script will run right after it, but
    #it will fail to sort the records in the Learn window
    #by order number, which this script
    #(loadITemRecrodForTestTagMenu) is supposed to
    #do everytime. The problem is a record for this
    #tag record will exist after the addtotag script has
    #run, but this script will not know that having run
    #first. So the user will be left wondering, "how is
    #that everytime I click on a new test or brainstorm tag
    #record that has record tagged with it in the Learn
    #window, the Learn window is sorted by order number
    #except for this time? How did this fail to happen?"
    #Well, it failed for the reason given above and
    #the sollution below is to use the 'Halt Script"
    #command, which will force the user to click
    #the add to tag button a second time to add the
    #tag (the first time being when the user clicked
    #it to move the system to this record, which
    #triggered this loadItem... script.
    Halt Script
    End If

Fields used in this script

    tagMenus::kGroupOrTest
    tagMenus::notesOrCopyright
    tagMenus::_Ltag
    TEMP::kcbrainstorm
    testlearn::kcbrainstorm
    TEMP::InventoryLibraryYN
    testlearn::orderInventoryGroupNumber
    testlearn::note
    testlearn::date
    testlearn::timestamp
    TEMP::TLBrainstormSort
    testlearn::_Ltestlearn

Scripts used in this script

    loadLearnOrRefMainRecord
    sortTestOrBrainstormTaggedLearnRecords

Layouts used in this script

    learn2

Tables used in this script

    TEMP
    tag
    testlearn

Table occurrences used by this script

    TEMP
    tagMenus
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [loadBrainstormTags]	Parent Folder: [tagMenu]	Next Script: [loadRefCiteTag]
Script Name	loadLearnTagRecord
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #NOTE: this script is used on the Tag Menus window
    #for Learn records to exit field when a record is
    #is first entered, which is a real problem on the
    #iPhone as the text edit box opens when the user
    #may have clicked only to select the record rather
    #than edit it.
    #
    #Admin tasks.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #Clear these variables and then load them.
    Set Variable [ $$refIDForMainLearnRecord ]
    Set Variable [ $$learnIDForMainLearnRecord; Value:reference::_Lreference ]
    Set Variable [ $$learnIDForMainLearnRecord; Value:testlearn::_Ltestlearn ]
    #
    If [ TEMP::layoutLmain = "lesslearn4" or TEMP::layoutLmain = "morelearn4" or $$testLearnLayoutName ≠ "" ]
    Select Window [ Name: "Learn"; Current file ]
    Refresh Window
    Select Window [ Name: "Tag Menus"; Current file ]
    End If
    #
    #
    Go to Field [ ]
    Go to Field [ ]
    #
    #

Fields used in this script

    reference::_Lreference
    testlearn::_Ltestlearn
    TEMP::layoutLmain

Scripts used in this script

Layouts used in this script

Tables used in this script

    TEMP
    reference
    testlearn

Table occurrences used by this script

    TEMP
    reference
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [loadLearnTagRecord]	Parent Folder: [tagMenu]	Next Script: [loadReferenceForInsertIntoText]
Script Name	loadRefCiteTag
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    menuCitation

Script Definition
Script Steps

    #
    #
    #If in the Test or Report section, stop this
    #script when first loading up an info record's
    #references.
    If [ $$stopWhenLoadingInfoRecordReferences ≠ "" or $$stopLoadTagRecord ≠ "" ]
    Exit Script [ ]
    End If
    #
    #
    #This script insures the user is exited from
    #text fields when first navigated to a record.
    Set Variable [ $$stopGoToKeyTag; Value:1 ]
    #
    Perform Script [ “enterShortOrLongTagField” ]
    // Show Custom Dialog [ Title: "halt"; Message: "halt"; Default Button: “OK”, Commit: “No” ]
    Halt Script
    #
    #

Fields used in this script

Scripts used in this script

    enterShortOrLongTagField

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [loadRefCiteTag]	Parent Folder: [tagMenu]	Next Script: [loadReportTestResultRecord]
Script Name	loadReferenceForInsertIntoText
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    learnInsertReferenceIntoNote

Script Definition
Script Steps

    #
    #
    #Stop the script if the user is just loading up
    #the references.
    If [ $$STOPloadReferenceForInsertIntoText = 1 ]
    Exit Script [ ]
    End If
    #
    #Set the reference template selections shown
    #in the top menu section.
    Set Field [ TEMP::referenceInsertText; reference::referenceUsedInTextToRefReference ]
    #
    #Exit the field the user just clicked into.
    Go to Field [ ]
    #
    #

Fields used in this script

    reference::referenceUsedInTextToRefReference
    TEMP::referenceInsertText

Scripts used in this script

Layouts used in this script

Tables used in this script

    TEMP
    reference

Table occurrences used by this script

    TEMP
    reference

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [loadReferenceForInsertIntoText]	Parent Folder: [tagMenu]	Next Script: [loadTagRecord]
Script Name	loadReportTestResultRecord
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    removeTestResultOrInfoRecordFromReport
    reportCopyPastPart3
    reportTestResult

Script Definition
Script Steps

    #
    #Stop loading record if other script is running.
    If [ $$stopLoadTestResultRecord = 1 ]
    Exit Script [ ]
    End If
    #
    #Conditionally format record if used in
    #main Report window.
    #
    #This key effects the conditional formatting
    Set Variable [ $$RecordID; Value:Get (RecordID) ]
    Set Variable [ $$main; Value:testlearnReportTags::_Ltestlearn ]
    Go to Field [ ]
    #
    #Refresh conditional formatting in both
    #windows and return to Tag Menus window.
    Select Window [ Name: "Report"; Current file ]
    Refresh Window
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    #
    #
    #Close any open test item reference windows.
    #NOTE: This is next loop is a work around to
    #deal with the Reference window issue.
    #Basically, there are several scripts that may
    #open Reference windows for Info records that
    #have references. Rather than try to figure out all
    #the ways this occurs (easy with time), this loop
    #just closes as many Reference windows as are
    #currently open. Not the best solution, but it
    #works and I really want to close out work on this
    #4.0beta version and move on.
    Loop
    If [ ValueCount ( FilterValues ( WindowNames ( Get ( FileName ) ) ; "Reference" ) ) > 0 ]
    Close Window [ Name: "Reference"; Current file ]
    Set Variable [ $resizeTagMenusWindow; Value:1 ]
    End If
    Exit Loop If [ ValueCount ( FilterValues ( WindowNames ( Get ( FileName ) ) ; "Reference" ) ) = 0 ]
    End Loop
    #
    #
    #Resize the Tag Menus window. Resize the Test
    #window if currently in the Test Section.
    If [ $resizeTagMenusWindow ≠ "" ]
    If [ $$pictureWindowColor = "test" ]
    Move/Resize Window [ Name: "Test"; Current file; Width: Get ( ScreenWidth ) / 2; Left: 0 ]
    Move/Resize Window [ Name: "Tag Menus"; Current file; Width: Get ( ScreenWidth ) / 2; Left: Get ( ScreenWidth ) / 2 ]
    #
    #The size of the Tag Menus window in the Report
    #section can be larger than half the window width.
    Else
    Move/Resize Window [ Name: "Tag Menus"; Current file; Width: Get (ScreenWidth) - 594; Left: 594 ]
    End If
    #
    Select Window [ Name: "Tag Menus"; Current file ]
    End If
    #
    #

Fields used in this script

    testlearnReportTags::_Ltestlearn

Scripts used in this script

Layouts used in this script

Tables used in this script

    testlearn

Table occurrences used by this script

    testlearnReportTags

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [loadReportTestResultRecord]	Parent Folder: [tagMenu]	Next Script: [loadTestTagMenu]
Script Name	loadTagRecord
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    deleteReference
    newLocationRecord
    returnToAddRecordPUTONHOLD!!!!
    defaultCopyrightMenu
    defaultNodeMenu
    deleteKeywordTag
    findMode
    hideFormTextTestItemsFTs
    menuCopyright
    menuKey
    menuNode
    menuPublication
    menuPublisher
    menuReference
    menuTestItem
    linkOrUnlinkTestItemGroupToTestItemList
    newTestItemGroup
    CHUNK_findLearnRecordsReferences

Script Definition
Script Steps

    #
    #NOTE: this script is used on the Tag Menus window
    #for Learn records to exit field when a record is
    #is first entered, which is a real problem on the
    #iPhone as the text edit box opens when the user
    #may have clicked only to select the record rather
    #than edit it.
    # The 'Go to field' exit command is in the citation load
    #script along with a lot of other commands which
    #are not needed for Tag records. I chose this
    #smaller script, which also has conditional formatting
    #step which is not used here, but is needed on
    #on other layouts.
    # SO...light script with unused command instead
    #of heavy script orginally written for loading these
    #records when they are main records (here they
    #are just tag records).
    #
    If [ $$stopLoadTagRecord ≠ "" or $$goBackToSetup ≠ "" or $$returnToSetup ≠ "" ]
    Exit Script [ ]
    End If
    #
    #Admin tasks.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #When user has navigated to a key tag menu
    #record by clicking on the order-number
    #popup menu, set this variable to insure the
    #order number selection process is completed.
    If [ Get ( ActiveFieldName ) = "orderOrLock" and $$citationMatch = "key" ]
    Set Variable [ $$keyOrderNumberPossibleChanged; Value:1 ]
    End If
    #
    #On the test-item layout, set this stop check
    #or text variable to allow the user to click into
    #this field for the purpose of navigating to a
    #new record without changing the check or
    #text mark status.
    If [ $$citationMatch = "testItem" and Get ( ActiveFieldName ) ≠ "tag" ]
    Set Variable [ $$stopCheckOrTest; Value:1 ]
    Else
    Set Variable [ $$stopCheckOrTest ]
    End If
    #
    #Stop warning message on file path tag menu.
    Set Variable [ $$stopFilePathWarning; Value:1 ]
    #
    #Exit the field. This allows user to just
    #navigate the record without the text box
    #staying opening, unless they want that to
    #happen BUT ONLY on test item layouts.
    Set Variable [ $$stopTest; Value:1 ]
    If [ tagMenus::match = "testItem" ]
    If [ $$showAll ≠ 1 ]
    Go to Field [ ]
    End If
    Else If [ tagMenus::match ≠ "testItem" ]
    Go to Field [ ]
    Set Variable [ $$stopGoToKeyTag; Value:1 ]
    End If
    Set Variable [ $$stopTest ]
    #
    #Start warning message on file path tag menu.
    Set Variable [ $$stopFilePathWarning ]
    #
    #Capture recordID to conditionally format current record.
    Set Variable [ $$tagRecordID; Value:Get (RecordID) ]
    #
    #Clear the old record's ID so its hidden edit
    #fields do not get revealed during navigation.
    Set Variable [ $$editLocation ]
    #
    #Get tag's group key for 'move' button script.
    Set Variable [ $$groupOLD; Value:tagMenus::kGroupOrTest ]
    #
    #Delete tag group order number if user selects
    #delete order number option when they
    #navigated to this record.
    If [ $$citationMatch = "key" and tagMenuGroup::orderOrLibraryType = "delete number" or $$citationMatch = "node" and tagMenuGroup::orderOrLibraryType = "delete number" ]
    Set Field [ tagMenuGroup::orderOrLibraryType; "" ]
    End If
    #
    #Delete tag order number if user selects
    #delete order number option.
    If [ $$citationMatch = "key" and tagMenus::orderOrLock = "delete number" or $$citationMatch = "testItem" and tagMenus::orderOrLock = "delete number" or Get (LayoutTableName) and tagKeywordPrimary::orderOrLock = "delete number" ]
    If [ Get (LayoutTableName) and tagKeywordPrimary::orderOrLock = "delete number" ]
    Set Field [ tagKeywordPrimary::orderOrLock; "" ]
    Else
    Set Field [ tagMenus::orderOrLock; "" ]
    End If
    End If
    #
    #Get reference groups and references order
    #number in case user changes it.
    Set Variable [ $$refGroupOrderNumber; Value:tagKeywordPrimary::orderOrLock ]
    Set Variable [ $$refOrderNumber; Value:reference::publicationYearOrStuffOrderNumber ]
    Set Variable [ $$refOrderNumber; Value:reference::publicationYearOrStuffOrderNumber ]
    Set Variable [ $$refIDForMainLearnRecord; Value:reference::_Lreference ]
    #
    #Refresh the window so hidden fields that must
    #match the ID variable just updated will now
    #show up.
    Refresh Window
    #
    #
    #Clear these variables and then load them.
    Set Variable [ $$refIDForMainLearnRecord ]
    Set Variable [ $$learnIDForMainLearnRecord; Value:reference::_Lreference ]
    Set Variable [ $$refIDForMainLearnRecord; Value:reference::_Lreference ]
    If [ TEMP::layoutLmain = "lesslearn4" or TEMP::layoutLmain = "morelearn4" or $$testLearnLayoutName ≠ "" ]
    Select Window [ Name: "Learn"; Current file ]
    Refresh Window
    Select Window [ Name: "Tag Menus"; Current file ]
    End If
    #
    #Get tag's copyright key for 'select' button
    #in case this node is locked, and the copyright
    #has to be put back to the orginal after the
    #user is informed they cannot change a locked
    #record's copyright.
    Set Variable [ $$oldCopyright; Value:tagMenus::notesOrCopyright ]
    #
    #When going the Learn or the Reference
    #section, this script is run towards the end,
    #and this Halt Script bit needs to be stopped
    #from proceeding until these sections are
    #completely loaded. Otherwise, when going
    #to them the user ends up focused on the Tag
    #Menus key menu, instead of on the main
    #Learn or Reference window.
    If [ $$doNotHaltOtherScripts = "" ]
    #
    #When going to a new tag covered by this next
    #bit of script, SOMETIMES FileMaker will launch
    #the enterShortOrLongTagField script*, which
    #allows empty picture fields to be hidden, and
    #the tag's text box to appear longer, basically
    #covering up the unused picture field. *(When
    #a user is NOT in a text field prior to clicking
    #on a different tag record, FileMaker launches
    #that script.)
    # Now, upon loading a new tag record the
    #launching of this script MUST happen, in
    #order to allow the user to navigate without
    #opening a text field. So first step below does
    #that. But if FileMaker also starts up this
    #script, it will run twice cause problems, so the
    #Halt command will stop this script for
    #running twice by cancelling all scripts that are
    #set to run.
    If [ $$citationMatch = "ref" or $$citationMatch = "key" or $$citationMatch = "node" ]
    Perform Script [ “enterShortOrLongTagField” ]
    // Show Custom Dialog [ Title: "halt"; Message: "halt"; Default Button: “OK”, Commit: “Yes” ]
    Halt Script
    End If
    #
    End If
    #
    #Clear the order number check variable.
    Set Variable [ $$keyOrderNumberPossibleChanged ]
    #
    #

Fields used in this script

    tagMenus::match
    tagMenus::kGroupOrTest
    tagMenuGroup::orderOrLibraryType
    tagMenus::orderOrLock
    tagKeywordPrimary::orderOrLock
    reference::publicationYearOrStuffOrderNumber
    reference::_Lreference
    TEMP::layoutLmain
    tagMenus::notesOrCopyright

Scripts used in this script

    enterShortOrLongTagField

Layouts used in this script

Tables used in this script

    TEMP
    reference
    tag
    tagGroup

Table occurrences used by this script

    TEMP
    reference
    tagKeywordPrimary
    tagMenuGroup
    tagMenus

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [loadTagRecord]	Parent Folder: [tagMenu]	Next Script: [loadTestTags]
Script Name	loadTestTagMenu
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    If [ $$ID = testSubsectionTemplate::_LtestSubsection or $$ID = "ignore" ]
    Exit Script [ ]
    End If
    Go to Field [ ]
    Set Variable [ $$ID; Value:testSubsectionTemplate::_LtestSubsection ]
    Set Variable [ $subsectionName; Value:testSubsectionTemplate::name ]
    Set Field [ TEMP::ktestSubsection; testSubsectionTemplate::_LtestSubsection ]
    Set Field [ TEMP::testSubsectionName; testSubsectionTemplate::name ]

Fields used in this script

    testSubsectionTemplate::_LtestSubsection
    testSubsectionTemplate::name
    TEMP::ktestSubsection
    TEMP::testSubsectionName

Scripts used in this script

Layouts used in this script

Tables used in this script

    TEMP
    testSubsectionTemplate

Table occurrences used by this script

    TEMP
    testSubsectionTemplate

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [loadTestTagMenu]	Parent Folder: [tagMenu]	Next Script: [lock]
Script Name	loadTestTags
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    addORremovePrimaryTag
    menuTest

Script Definition
Script Steps

    #
    #Capture recordID to conditionally format current record.
    If [ $$stopLoadTagRecord ≠ 1 ]
    Go to Field [ ]
    #
    #The 'test' variable may have more than one
    #key in it. So we need a variable with just this
    #records keys in it to conditionally format all
    #learn window records tagged with it.
    Set Variable [ $$tagtest; Value:testSubsectionTemplate::_LtestSubsection ]
    Set Field [ TEMP::kctagTest; testSubsectionTemplate::_LtestSubsection ]
    Set Variable [ $$BrainstormOrTestID; Value:Get (RecordID) ]
    #
    #The next conditional formatting variable needs
    #to be cleared in case there are no records in
    #the learn window tagged with this tag record.
    #It might contain a tag ID from the selecting
    #the previous record which did have at least 1
    #learn record tagged with it. (See the end of
    #this script where it is actually created.)
    Set Variable [ $$atLeastOneRecord ]
    #
    Set Variable [ $$stopLoadCitation; Value:1 ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    New Window [ Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Move/Resize Window [ Current Window; Height: 3; Width: 3; Top: -1000; Left: -1000 ]
    Go to Layout [ “learn2” (testlearn) ]
    #Prepare system to stop error message about no
    #records being found as the user may not have
    #yet tagged any learn records with this test tag.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    Enter Find Mode [ ]
    Set Field [ testlearn::filterFind; "main" ]
    Perform Find [ ]
    Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: testlearn::kctestSubsectionInfo: “=” ] [ Restore ]
    Go to Record/Request/Page [ First ]
    Set Variable [ $number; Value:1 ]
    Loop
    Exit Loop If [ Case ( Left ( testlearn::kctestSubsectionInfo ; 2 ) = "00" ; //If there two zeros in front of the order number, get the key using these calculations: (FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 1 ) ; 4 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ or FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 2 ) ; 4 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ or FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 3 ) ; 4 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ or FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 4 ) ; 4 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ or FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 5 ) ; 4 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ or FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 6 ) ; 4 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ or FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 7 ) ; 4 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ or FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 8 ) ; 4 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ or FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 9 ) ; 4 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ or FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 10 ) ; 4 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ ) = 1 ; //If there is only one zero in front of the order number, get the key using this calculation: (FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 1 ) ; 3 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ or FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 2 ) ; 3 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ or FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 3 ) ; 3 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ or FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 4 ) ; 3 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ or FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 5 ) ; 3 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ or FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 6 ) ; 3 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ or FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 7 ) ; 3 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ or FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 8 ) ; 3 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ or FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 9 ) ; 3 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ or FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 10 ) ; 3 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ ) = 1 ) ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    Set Variable [ $atLeastOneRecord; Value:Case ( Left ( testlearn::kctestSubsectionInfo ; 2 ) = "00" ; //If there two zeros in front of the order number, get the key using this calculation: If ( (FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 1 ) ; 4 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ or FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 2 ) ; 4 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ or FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 3 ) ; 4 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ or FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 4 ) ; 4 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ or FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 5 ) ; 4 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ or FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 6 ) ; 4 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ or FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 7 ) ; 4 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ or FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 8 ) ; 4 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ or FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 9 ) ; 4 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ or FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 10 ) ; 4 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ ) = 1 ; 1 ; "" ) ; //If there is only one zero in front of the order number, get the key using this calculation: If ( (FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 1 ) ; 3 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ or FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 2 ) ; 3 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ or FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 3 ) ; 3 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ or FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 4 ) ; 3 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ or FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 5 ) ; 3 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ or FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 6 ) ; 3 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ or FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 7 ) ; 3 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ or FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 8 ) ; 3 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ or FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 9 ) ; 3 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ or FilterValues ( Middle ( GetValue ( testlearn::kctestSubsectionInfo ; 10 ) ; 3 ; 42 ) ; $$tagtest & "¶" ) = $$tagtest & ¶ ) = 1 ; 1 ; "" ) ) ]
    Go to Layout [ original layout ]
    Close Window [ Current Window ]
    Set Variable [ $$stopLoadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    #
    #This won't work without going through every
    #record on the main window to check if it is tagged
    #with this record, and that could take a really long
    #time.
    #So if there are no records tagged with this test item
    #then make sure the Main window is sorted by
    #date and not by test item sort order.
    If [ $atLeastOneRecord ≠ 1 ]
    #
    #The 'test' variable may have more than one
    #key in it. So we need a variable with just this
    #records keys in it to conditionally format all
    #learn window records tagged with it.
    Set Variable [ $$tagtest; Value:testSubsectionTemplate::_LtestSubsection ]
    #
    Select Window [ Name: "Learn"; Current file ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::orderInventoryGroupNumber; ascending testlearn::note; ascending ] [ Restore; No dialog ]
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::date; descending testlearn::timestamp; descending ] [ Restore; No dialog ]
    End If
    Scroll Window [ Home ]
    Set Field [ TEMP::TLTestSort; "" ]
    Set Variable [ $$stopLoadCitation ]
    Perform Script [ “loadLearnOrRefMainRecord” ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    #
    Else If [ $atLeastOneRecord = 1 ]
    #
    #The formatting of test tagged records in
    #the Learn window is linked to the current
    #record in the tag window. THE ONLY WAY to
    #know this in the Tag window (that there are
    #tagged records in the learn window) is to
    #make a $$ variable. This way the system will
    #remember it is conditionally formatting learn
    #records when the active learn record is not
    #tagged with the current record in the tag window.
    Set Variable [ $$atLeastOneRecord; Value:$$tagtest ]
    #
    #The 'test' variable may have more than one
    #key in it. So we need a variable with just this
    #records keys in it to conditionally format all
    #learn window records tagged with it.
    Set Variable [ $$tagtest; Value:testSubsectionTemplate::_LtestSubsection ]
    Set Field [ TEMP::kctagTest; testSubsectionTemplate::_LtestSubsection ]
    Set Variable [ $$BrainstormOrTestID; Value:Get (RecordID) ]
    If [ $$add = 1 and $$citationMatch = $$addCitationMatch ]
    Else If [ $$add = "" ]
    End If
    Refresh Window
    #
    #Just in case user was in nonTag field on this
    #window when user clicked a menu button on
    #the other window, exit all fields.
    // If [ TEMP::TLTestSort = "" ]
    Set Field [ TEMP::TLTestSort; 1 ]
    Set Variable [ $recordNumber; Value:Get (RecordNumber) ]
    Select Window [ Name: "Learn"; Current file ]
    Perform Script [ “sortTestOrBrainstormTaggedLearnRecords” ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Go to Record/Request/Page [ $recordNumber ] [ No dialog ]
    Set Variable [ $$tagtest; Value:testSubsectionTemplate::_LtestSubsection ]
    // End If
    Select Window [ Name: "Learn"; Current file ]
    Go to Field [ ]
    Refresh Window
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    End If
    #
    #If the user is coming from a test info screen,
    #go to the testlearn record they are
    #interested in editing and clear the
    #$$editTestInfo variable.
    If [ $$editTestInfo = 1 ]
    Set Variable [ $$editTestInfo ]
    Select Window [ Name: "Learn"; Current file ]
    End If
    #
    #Unlike 'exit script', 'halt script' will halt all scripts
    #currently active. So if user was on another tag
    #record and then clicked on the add tag button
    #for another record, this script will launch.
    #Problem is, because the user may really
    #want to add this tag to the current item in the
    #Learn window, after this script runs and finds
    #zero records for example (which could happen)
    #the add to tag script will run right after it, but
    #it will fail to sort the records in the Learn window
    #by order number, which this script
    #(loadITemRecrodForTestTagMenu) is supposed to
    #do everytime. The problem is a record for this
    #tag record will exist after the addtotag script has
    #run, but this script will not know that having run
    #first. So the user will be left wondering, "how is
    #that everytime I click on a new test or brainstorm tag
    #record that has record tagged with it in the Learn
    #window, the Learn window is sorted by order number
    #except for this time? How did this fail to happen?"
    #Well, it failed for the reason given above and
    #the sollution below is to use the 'Halt Script"
    #command, which will force the user to click
    #the add to tag button a second time to add the
    #tag (the first time being when the user clicked
    #it to move the system to this record, which
    #triggered this loadItem... script.
    Halt Script
    End If
    #

Fields used in this script

    testSubsectionTemplate::_LtestSubsection
    TEMP::kctagTest
    testlearn::filterFind
    testlearn::kctestSubsectionInfo
    TEMP::InventoryLibraryYN
    testlearn::orderInventoryGroupNumber
    testlearn::note
    testlearn::date
    testlearn::timestamp
    TEMP::TLTestSort

Scripts used in this script

    loadLearnOrRefMainRecord
    sortTestOrBrainstormTaggedLearnRecords

Layouts used in this script

    learn2

Tables used in this script

    TEMP
    testSubsectionTemplate
    testlearn

Table occurrences used by this script

    TEMP
    testSubsectionTemplate
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [loadTestTags]	Parent Folder: [tagMenu]	Next Script: [lockNodesRecords]
Script Name	lock
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    If [ nodeLockTagGroupCreatorLock::orderOrLock = "lock" ]
    Go to Field [ ]
    Show Custom Dialog [ Message: "Type the following into the box below to unlock all content created by " & nodeLockTagGroupCreatorLock::tag; Default Button: “OK”, Commit: “Yes”; Button 2: “Cancel”, Commit: “No” ]
    Halt Script
    End If

Fields used in this script

    nodeLockTagGroupCreatorLock::orderOrLock
    nodeLockTagGroupCreatorLock::tag

Scripts used in this script

Layouts used in this script

Tables used in this script

    tag

Table occurrences used by this script

    nodeLockTagGroupCreatorLock

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [lock]	Parent Folder: [tagMenu]	Next Script: [menuBrainstorm]
Script Name	lockNodesRecords
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultNode1
    defaultNode2
    defaultNodeS2
    defaultNode3
    defaultNodeS3
    defaultNodeS4
    defaultNode4

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Capture the password for comparrison and to return
    #the password field back to if the user fails to get the
    #password right.
    Set Variable [ $password; Value:tagMenus::orderOrLock[2] ]
    Set Variable [ $tagKey; Value:tagMenus::_Ltag ]
    Set Field [ TEMP::passwordCheck; "" ]
    Go to Field [ ]
    #
    #Use the halt instead of exit script step as the
    #user can sometimes click the lock button
    #twice. The halt stops the second click's
    #calling up of this script.
    #
    #If there is a password, ask user to enter it.
    If [ tagMenus::orderOrLock[2] ≠ "" ]
    Loop
    Show Custom Dialog [ Message: "Enter the password to unlock " & tagMenus::tag & " records."; Default Button: “enter”, Commit: “Yes”; Button 2: “cancel”, Commit: “No”; Input #1: TEMP::passwordCheck, Password ]
    If [ Get ( LastMessageChoice ) = 2 ]
    Set Field [ TEMP::passwordCheck; "" ]
    Halt Script
    End If
    #
    #Unlock node if password is correct.
    If [ $password = TEMP::passwordCheck ]
    Show Custom Dialog [ Message: "unlocked"; Default Button: “OK”, Commit: “Yes” ]
    Set Field [ TEMP::passwordCheck; "" ]
    Set Field [ tagMenus::orderOrLock; "" ]
    Set Field [ tagMenus::orderOrLock[2]; "" ]
    #
    #Allow creation of new records by this node if
    #it is the primary default node.
    If [ tagMenus::_Ltag = TEMP::kdefaultNodePrimary ]
    Set Field [ tempSetup::primaryNodeIsLocked; "" ]
    End If
    #
    #Allow new records to be created by the
    #primary node if it was created by this node.
    If [ tagMenus::_Ltag = TEMP::kdefaultNodePrimaryCreator ]
    Set Field [ tempSetup::primaryNodesCreatorNodeIsLocked; "" ]
    End If
    #
    #Allow new records to be created for this
    #node if it is the default test subject.
    If [ tagMenus::_Ltag = TEMP::kdefaultNodeTestSubject ]
    Set Variable [ $$testSubjectIsLocked ]
    Set Field [ tempSetup::testSubjectNodeIsLocked; "" ]
    End If
    #
    #
    #Check if node created a setup reference
    #record, and if so and if locked, let user
    #know this unlocking will not affect this
    #setup reference.
    #
    #Prevent tagLoad script from running and
    #open a new window to go to the setup
    #reference table layout.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    New Window [ Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “tableSetupReference” (librarySetupReferenceMain) ]
    #
    #Find any records created by this node.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    Enter Find Mode [ ]
    Set Field [ librarySetupReferenceMain::kcreatorNode; $tagKey ]
    Set Field [ librarySetupReferenceMain::password; 0 ]
    Perform Find [ ]
    #
    #If there are locked setup references, tell the
    #user that they the must be locked separately.
    If [ librarySetupReferenceMain::password ≠ "" ]
    Set Variable [ $setupReference; Value:Case ( Length ( librarySetupReferenceMain::name & " by " & librarySetupReferenceMain::creatorName ) < 56 ; Left ( librarySetupReferenceMain::name & " by " & librarySetupReferenceMain::creatorName ; 55 ) & "...." ; librarySetupReferenceMain::name & " by " & librarySetupReferenceMain::creatorName & "." ) ]
    Set Variable [ $foundCount; Value:Get (FoundCount) ]
    Close Window [ Current Window ]
    If [ $foundCount = 1 ]
    Show Custom Dialog [ Message: "NOTE: Setup references must locked separately. The following setup reference created by this node remains locked until you unlock it in the Setup window: " & $setupReference; Default Button: “OK”, Commit: “Yes” ]
    Else If [ $foundCount = 2 ]
    Show Custom Dialog [ Message: "NOTE: Setup references must locked separately. The following setup reference, and 1 other, created by this node remain locked until you unlock them in the Setup window: " & $setupReference; Default Button: “OK”, Commit: “Yes” ]
    Else If [ $foundCount > 2 ]
    Show Custom Dialog [ Message: "NOTE: Setup references must locked separately. The following setup reference, and " & $foundCount & " others, created by this node remain locked until you unlock them in the Setup window: " & $setupReference; Default Button: “OK”, Commit: “Yes” ]
    End If
    Else
    Close Window [ Current Window ]
    End If
    Set Variable [ $$stopLoadTagRecord ]
    #
    #
    Halt Script
    End If
    End Loop
    #
    #If there is no password, ask user to create one.
    Else If [ tagMenus::orderOrLock[2] = "" ]
    Set Field [ TEMP::passwordCheck; "" ]
    Show Custom Dialog [ Message: "Lock " & tagMenus::tag & "'s Primary Node [learn, reference, all tag, and test template] records, and Test Subject Node [test and report] records. Reference setup records locked separately. WARNING: Password lost = Forever locked, sort of... (Click ?)"; Default Button: “enter”, Commit: “Yes”; Button 2: “cancel”, Commit: “No”; Input #1: tagMenus::orderOrLock, Password, "password"; Input #2: TEMP::passwordCheck, Password, "confirm password" ]
    If [ Get ( LastMessageChoice ) = 2 ]
    Set Field [ tagMenus::orderOrLock; "" ]
    Exit Script [ ]
    End If
    #
    #Check validity of password entered.
    #
    #If they don't match, ask user to try again.
    Loop
    If [ tagMenus::orderOrLock ≠ TEMP::passwordCheck ]
    Show Custom Dialog [ Message: "Passwords did not match."; Default Button: “enter”, Commit: “Yes”; Button 2: “cancel”, Commit: “No”; Input #1: tagMenus::orderOrLock, Password, "password"; Input #2: TEMP::passwordCheck, Password, "confirm password" ]
    If [ Get ( LastMessageChoice ) = 2 ]
    Set Field [ tagMenus::orderOrLock; "" ]
    Halt Script
    End If
    End If
    #
    #If the user picks 0, then make them choose
    #another and explain why the must do so.
    If [ TEMP::passwordCheck = 0 ]
    Show Custom Dialog [ Message: "Zero is not allowed. Try again."; Default Button: “enter”, Commit: “Yes”; Button 2: “cancel”, Commit: “No”; Input #1: tagMenus::orderOrLock, Password, "password"; Input #2: TEMP::passwordCheck, Password, "confirm password" ]
    If [ Get ( LastMessageChoice ) = 2 ]
    Set Field [ tagMenus::orderOrLock; "" ]
    Halt Script
    End If
    End If
    #
    #If the password is valid exit the
    #password check loop.
    Exit Loop If [ tagMenus::orderOrLock = TEMP::passwordCheck and TEMP::passwordCheck ≠ 0 ]
    End Loop
    #
    #Move the user entered password into the
    #second field, and replace it with 0, which will
    #tell the system that this node is locked, but
    #will not reveal to any user what the actual
    #password is, as the second field appears on
    #zero layouts.
    Set Field [ tagMenus::orderOrLock[2]; TEMP::passwordCheck ]
    If [ TEMP::passwordCheck ≠ "" ]
    Set Field [ tagMenus::orderOrLock; 0 ]
    End If
    #
    #Prevent creation of new records by this node
    #if it is the primary default node.
    If [ tagMenus::_Ltag = TEMP::kdefaultNodePrimary ]
    Set Field [ tempSetup::primaryNodeIsLocked; 0 ]
    End If
    #
    #Prevent new records being created by the
    #primary node if it was created by this node.
    If [ tagMenus::_Ltag = TEMP::kdefaultNodePrimaryCreator ]
    Set Field [ tempSetup::primaryNodesCreatorNodeIsLocked; tagMenus::tag ]
    End If
    #
    #Prevent new records being created by the
    #node if it is the default test subject.
    If [ tagMenus::_Ltag = TEMP::kdefaultNodeTestSubject ]
    Set Variable [ $$testSubjectIsLocked; Value:tagMenus::tag ]
    Set Field [ tempSetup::testSubjectNodeIsLocked; 1 ]
    End If
    #
    #Turn on show locked records if the box is
    #not already checked.
    Set Field [ tempSetup::nodeLockedShow; "1" ]
    #
    #
    #Check if node created a setup reference
    #record, and if so and if locked, let user
    #know this unlocking will not affect this
    #setup reference.
    #
    #Prevent tagLoad script from running and
    #open a new window to go to the setup
    #reference table layout.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    New Window [ Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “tableSetupReference” (librarySetupReferenceMain) ]
    #
    #Find any records created by this node.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    Enter Find Mode [ ]
    Set Field [ librarySetupReferenceMain::kcreatorNode; $tagKey ]
    Set Field [ librarySetupReferenceMain::password; "=" ]
    Perform Find [ ]
    #
    #
    #If there are any unlocked, tell the user that
    #they the must be locked separately.
    If [ librarySetupReferenceMain::password = "" ]
    Set Variable [ $setupReference; Value:Case ( Length ( librarySetupReferenceMain::name & " by " & librarySetupReferenceMain::creatorName ) < 56 ; Left ( librarySetupReferenceMain::name & " by " & librarySetupReferenceMain::creatorName ; 55 ) & "... |" ; librarySetupReferenceMain::name & " by " & librarySetupReferenceMain::creatorName & " |" ) ]
    Set Variable [ $foundCount; Value:Get (FoundCount) ]
    Close Window [ Current Window ]
    If [ $foundCount = 1 ]
    Show Custom Dialog [ Message: "NOTE: Setup references must locked separately. The following setup reference created by this node remain unlocked in the Setup window: " & $setupReference; Default Button: “OK”, Commit: “Yes” ]
    Else If [ $foundCount = 2 ]
    Show Custom Dialog [ Message: "NOTE: Setup references must locked separately. The following setup reference, and 1 other, created by this node remain unlocked in the Setup window: " & $setupReference; Default Button: “OK”, Commit: “Yes” ]
    Else If [ $foundCount > 2 ]
    Show Custom Dialog [ Message: "NOTE: Setup references must locked separately. The following setup reference, and " & $foundCount & " others, created by this node remain unlocked in the Setup window: " & $setupReference; Default Button: “OK”, Commit: “Yes” ]
    End If
    Else
    Close Window [ Current Window ]
    End If
    Set Variable [ $$stopLoadTagRecord ]
    #
    #
    End If
    Halt Script
    #
    #

Fields used in this script

    tagMenus::orderOrLock
    tagMenus::_Ltag
    TEMP::passwordCheck
    tagMenus::tag
    <Missing Field>
    TEMP::kdefaultNodePrimary
    tempSetup::primaryNodeIsLocked
    TEMP::kdefaultNodePrimaryCreator
    tempSetup::primaryNodesCreatorNodeIsLocked
    TEMP::kdefaultNodeTestSubject
    tempSetup::testSubjectNodeIsLocked
    librarySetupReferenceMain::kcreatorNode
    librarySetupReferenceMain::password
    librarySetupReferenceMain::name
    librarySetupReferenceMain::creatorName
    tempSetup::nodeLockedShow

Scripts used in this script

Layouts used in this script

    tableSetupReference

Tables used in this script

    TEMP
    TEMP
    setupReference
    tag

Table occurrences used by this script

    TEMP
    librarySetupReferenceMain
    tagMenus
    tempSetup

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [lockNodesRecords]	Parent Folder: [tagMenu]	Next Script: [menuCitation]
Script Name	menuBrainstorm
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ltagNK1
    ltagNKs1
    ltagNK2
    ltagNKs2
    ltagNK3
    ltagNKs3
    ltagNK4
    ltagNKs4
    ltagNK5
    ltagNKs5
    learnMenu3Cite
    learnMenu3CiteS
    learnMenuRefStuff
    learnMenu4RefCite
    learnMenu4noPicRefCite
    learnMenu4STUFFRefCite
    learnTagWindowNoTags
    learnMenuBrainstorm
    learnMenuStuffBrainstorm
    learnTest
    learnSTest

Scripts that use this script

    findMode

Script Definition
Script Steps

    #
    #Admin tasks.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #
    #Prevent halting of script.
    Set Variable [ $$doNotHaltOtherScripts; Value:1 ]
    #
    #If user is in tag field and has changed spelling
    #exit this tag record, otherwise current reference record
    #will get deleted by the spelling check script.
    Go to Field [ ]
    #
    #If user was viewing test tags then do this.
    If [ $$citationMatch = "test" ]
    #
    #Go to Learn window.
    Select Window [ Name: "Learn"; Current file ]
    #
    #Clear brainstorm and test tags.
    Go to Field [ ]
    Set Variable [ $$citationItem; Value:testlearn::kNodePrimary ]
    Set Variable [ $$tagBrainstorm ]
    Set Variable [ $$tagtest ]
    Set Variable [ $$tagRecordID ]
    Set Variable [ $$tagEdit ]
    #
    #Return to Tag Menus window.
    Select Window [ Name: "Tag Menus"; Current file ]
    End If
    #
    #Clear order numbers.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    New Window [ Height: 1; Width: 1; Top: -100000; Left: -100000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “learnSCRIPTloops” (testlearn) ]
    Perform Find [ Specified Find Requests: Find Records; Criteria: testlearn::orderTestInformation: “###” ] [ Restore ]
    Loop
    Set Field [ testlearn::orderTestInformation; "" ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    Close Window [ Current Window ]
    Set Variable [ $$stopLoadTagRecord ]
    Set Variable [ $$doNotHaltOtherScripts ]
    #
    #Set citationMatch to color menu button with inUse color.
    Set Variable [ $$citationMatch; Value:"brainstorm" ]
    #
    #Set match temp tag field to limit move pulldown
    #to just the groups for this section and item type.
    #( if you're wondering why this temp field is a
    # a dupllicate of the citation match variable it
    # is because I didn't need it until a year into
    # writing this database. At some point, it would
    # probably be good to get rid of the variable. )
    Set Field [ TEMP::mTag; $$citationMatch ]
    #
    #Turn off the loadtagrecord script to speed up the
    #loop portion of the script.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Set Variable [ $$stopLoadCitation; Value:1 ]
    #
    #Goto correct layout.
    Go to Layout [ “learnMenuBrainstorm” (tagMenus) ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “learnMenuStuffBrainstorm” (tagMenus) ]
    End If
    #
    #Find brainstorm tags.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Enter Find Mode [ ]
    Set Field [ tagMenus::match; $$citationMatch ]
    Perform Find [ ]
    #
    #Sort into groups.
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::tag; ascending ] [ Restore; No dialog ]
    #
    #Go to citation record's current selection or to first record.
    Go to Record/Request/Page [ First ]
    Loop
    Set Variable [ $number; Value:1 ]
    Go to Field [ ]
    Loop
    Exit Loop If [ Middle ( GetValue ( $$brainstorm ; $number ) ; 4 ; 42 ) & "¶" = tagMenus::_Ltag & ¶ ]
    Exit Loop If [ Middle ( GetValue ( $$brainstorm ; $number ) ; 4 ; 42 ) = "" ]
    Set Variable [ $add; Value:$number ]
    Set Variable [ $number; Value:$add + 1 ]
    End Loop
    Exit Loop If [ Middle ( GetValue ( $$brainstorm ; $number ) ; 4 ; 42 ) & "¶" = tagMenus::_Ltag & ¶ ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Turn loadtagrecord script back on.
    Set Variable [ $$stopLoadTagRecord ]
    #
    #Turn loadtagrecord script back on and perform
    #loadtag... script to highlight any Learn records
    #tagged with the current tag record.
    Set Variable [ $$stopLoadTagRecord ]
    Perform Script [ “loadBrainstormTags” ]
    #

Fields used in this script

    testlearn::kNodePrimary
    testlearn::orderTestInformation
    TEMP::mTag
    TEMP::InventoryLibraryYN
    tagMenus::match
    tagMenuGroup::orderOrLibraryType
    tagMenuGroup::name
    tagMenus::tag
    tagMenus::_Ltag

Scripts used in this script

    loadBrainstormTags

Layouts used in this script

    learnSCRIPTloops
    learnMenuBrainstorm
    learnMenuStuffBrainstorm

Tables used in this script

    TEMP
    tag
    tagGroup
    testlearn

Table occurrences used by this script

    TEMP
    tagMenuGroup
    tagMenus
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [menuBrainstorm]	Parent Folder: [tagMenu]	Next Script: [menuCopyright]
Script Name	menuCitation
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferenceMenuNoTags
    ReferenceMenu1
    ReferenceMenuCopyright
    ReferenceMenu3Cite
    ReferenceMenu3CiteNoPicture
    ReferenceMenu2keywordOrNode1
    ReferenceMenu2keywordOrNode2
    ReferenceMenu2keywordOrNode3
    ReferenceMenu2keywordOrNode4
    ReferenceMenu2keywordOrNode5

Scripts that use this script

    findMode
    TgotoCitationMenu

Script Definition
Script Steps

    #
    #
    #Prevent halting of script.
    Set Variable [ $$doNotHaltOtherScripts; Value:1 ]
    #
    #If user is in tag field and has changed spelling
    #exit this tag record, otherwise current reference record
    #will get deleted by the spelling check script.
    Go to Field [ ]
    #
    #Clear brainstorm and test tags so there conditional
    #formatting in the Learn window is removed.
    If [ $$citationMatch = "brainstorm" or $$citationMatch = "test" ]
    Select Window [ Name: "Learn"; Current file ]
    Go to Field [ ]
    Set Variable [ $$tagBrainstorm ]
    Set Variable [ $$tagtest ]
    Set Variable [ $$tagRecordID ]
    Set Variable [ $$tagEdit ]
    End If
    #
    #Set testlearn internal reference field conditional
    #formatting to tan.
    Set Variable [ $$internal ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::date; descending testlearn::timestamp; descending ] [ Restore; No dialog ]
    #
    Select Window [ Name: "Tag Menus"; Current file ]
    Set Variable [ $$doNotHaltOtherScripts ]
    #
    #
    #Set citationMatch to color menu button with inUse color.
    Set Variable [ $$citationMatch; Value:"cite" ]
    #
    Set Variable [ $$stoploadCitation; Value:1 ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Freeze Window
    #
    #Goto correct layout.
    If [ Left (Get (LayoutName) ; 1) = "l" ]
    Go to Layout [ “learnMenu3CiteS” (reference) ]
    Else If [ Left (Get (LayoutName) ; 1) = "r" ]
    Go to Layout [ “ReferenceMenu3CiteNoPicture” (reference) ]
    End If
    #
    #Find references for reference module.
    Show All Records
    #
    #Omit locked records, which are the copyright
    #images used by default copyright tags.
    Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: reference::lock: “lock” ] [ Restore ]
    #
    #Sort and go to the first record. Due to bugs,
    #two sorts are required to get to the first record.
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::date; descending testlearn::timestamp; descending ] [ Restore; No dialog ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagKeywordPrimary::orderOrLock; based on value list: “order Pulldown List” tagKeywordPrimary::tag; ascending reference::referenceShort; ascending ] [ Restore; No dialog ]
    Else
    #There is no cite menu for inventory libraries,
    #so no need to perform a sort.
    End If
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    #
    #If current reference record in the main window
    #is tagged with a citation, find it.
    If [ $$cite ≠ "" ]
    Loop
    Exit Loop If [ $$cite = reference::_Lreference ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Set main reference window's reference record's
    #citationItem variable to this citation menu's
    #current record.
    Set Variable [ $$citationItem; Value:reference::_Lreference ]
    Refresh Window
    End If
    #
    #
    #If no layout preference is set, then on iDevices
    #go the layout with no pictures, and to the
    #layout with pictures on desktop computers.
    If [ TEMP::layoutRtagCite = "" ]
    If [ Get (SystemPlatform) = 3 ]
    Go to Layout [ “ReferenceMenu3CiteNoPicture” (reference) ]
    Set Field [ TEMP::layoutRtagCite; "more" & Get (LayoutName) ]
    Else
    Go to Layout [ “ReferenceMenu3Cite” (reference) ]
    Set Field [ TEMP::layoutRtagCite; "less" & Get (LayoutName) ]
    End If
    Else
    #
    #Go the layout the user has selected.
    Go to Layout [ Middle ( TEMP::layoutRtagCite ; 5 ; 42 ) ]
    End If
    #
    #
    #Now that looping thru records is comlete,
    #turn back on record load scripts.
    Set Variable [ $$stoploadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    #
    #Just in case user was in nonTag field on this
    #window when user clicked a menu button on
    #the other window, exit all fields.
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    Go to Field [ ]
    Else If [ Get (LastError) ≠ 112 ]
    Go to Field [ ]
    End If
    Refresh Window
    Select Window [ Name: "Tag Menus"; Current file ]
    Perform Script [ “loadRefCiteTag” ]
    #

Fields used in this script

    testlearn::date
    testlearn::timestamp
    reference::lock
    TEMP::InventoryLibraryYN
    tagKeywordPrimary::orderOrLock
    tagKeywordPrimary::tag
    reference::referenceShort
    reference::_Lreference
    TEMP::layoutRtagCite

Scripts used in this script

    loadRefCiteTag

Layouts used in this script

    learnMenu3CiteS
    ReferenceMenu3CiteNoPicture
    ReferenceMenu3Cite

Tables used in this script

    TEMP
    reference
    tag
    testlearn

Table occurrences used by this script

    TEMP
    reference
    tagKeywordPrimary
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [menuCitation]	Parent Folder: [tagMenu]	Next Script: [menuKey]
Script Name	menuCopyright
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferenceMenuNoTags
    ReferenceMenu1
    ReferenceMenuCopyright
    ReferenceMenu3Cite
    ReferenceMenu3CiteNoPicture
    ReferenceMenu2keywordOrNode1
    ReferenceMenu2keywordOrNode2
    ReferenceMenu2keywordOrNode3
    ReferenceMenu2keywordOrNode4
    ReferenceMenu2keywordOrNode5

Scripts that use this script

    findMode
    TgotoCitationMenu

Script Definition
Script Steps

    #
    #Admin tasks.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #Prevent halting of script.
    Set Variable [ $$doNotHaltOtherScripts; Value:1 ]
    #
    #If user is in tag field and has changed spelling
    #exit this tag record, otherwise current reference record
    #will get deleted by the spelling check script.
    Go to Field [ ]
    #
    #Clear brainstorm and test tags so there conditional
    #formatting in the Learn window is removed.
    If [ $$citationMatch = "brainstorm" or $$citationMatch = "test" ]
    Select Window [ Name: "Learn"; Current file ]
    Go to Field [ ]
    Set Variable [ $$tagBrainstorm ]
    Set Variable [ $$tagtest ]
    Set Variable [ $$tagRecordID ]
    Set Variable [ $$tagEdit ]
    End If
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::date; descending testlearn::timestamp; descending ] [ Restore; No dialog ]
    #
    #Conditionally format Tag Menu button.
    Select Window [ Name: "Tag Menus"; Current file ]
    Set Variable [ $$doNotHaltOtherScripts ]
    Set Variable [ $$citationMatch; Value:"copyright" ]
    #
    #Set match temp tag field to limit move pulldown
    #to just the groups for this section and item type.
    #( if you're wondering why this temp field is a
    # a dupllicate of the citation match variable it
    # is because I didn't need it until a year into
    # writing this database. At some point, it would
    # probably be good to get rid of the variable. )
    Set Field [ TEMP::mTag; $$citationMatch ]
    #
    #Turn off the loadtagrecord script to speed up the
    #loop portion of the script.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Set Variable [ $$stopTest; Value:1 ]
    #
    #Speed up script by going to layout with no
    #pictures to load.
    If [ Left (Get (LayoutName) ; 1) = "l" ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Go to Layout [ “ltagNK1” (tagMenus) ]
    Else
    Go to Layout [ “ltagNKs1” (tagMenus) ]
    End If
    Else
    If [ TEMP::InventoryLibraryYN = "" ]
    Go to Layout [ “ReferenceMenu2keywordOrNode2” (tagMenus) ]
    Else
    End If
    End If
    #
    #
    #Find Permission tags. Permission tags are available to all library sections.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Enter Find Mode [ ]
    Set Field [ tagMenus::match; $$citationMatch ]
    Perform Find [ ]
    #
    #Sort to group, textstyle, and then tag,
    #so that the 3.0 ND tag comes before the
    #4.0 ND tag as it does for all the other Creative
    #Commons tags.
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::name; ascending tagMenus::textStyleOrCreatorNodeFlag; ascending tagMenus::tag; ascending ] [ Restore; No dialog ]
    #
    #Go to citation record's current selection or to first record.
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ $$copyright = tagMenus::_Ltag ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Goto correct layout.
    #If in add mode ...
    If [ $$add = 1 ]
    Go to Layout [ “addMenu1” (tagMenus) ]
    #
    #If in learn mode ...
    Else If [ Left (Get (LayoutName) ; 1) = "l" ]
    Go to Layout [ “learnMenuCopyright” (tagMenus) ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “learnMenuSCopyright” (tagMenus) ]
    End If
    #
    #If in reference mode ...
    Else If [ Left (Get (LayoutName) ; 1) = "r" ]
    Go to Layout [ “ReferenceMenuCopyright” (tagMenus) ]
    End If
    #
    If [ $$copyright ≠ tagMenus::_Ltag ]
    Go to Record/Request/Page [ First ]
    #
    #Turn loadtagrecord script back on.
    Set Variable [ $$stopLoadTagRecord ]
    Set Variable [ $$stopTest ]
    Perform Script [ “loadTagRecord” ]
    Exit Script [ ]
    End If
    #
    #Turn loadtagrecord script back on.
    Set Variable [ $$stopLoadTagRecord ]
    Set Variable [ $$stopTest ]
    #
    #Inform user of items use on both screens.
    Set Variable [ $$citationItem; Value:tagMenus::_Ltag ]
    Perform Script [ “loadTagRecord” ]
    Refresh Window
    #
    #Just in case user was in nonTag field on this
    #window when user clicked a menu button on
    #the other window, exit all fields.
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    Go to Field [ ]
    Else If [ Get (LastError) ≠ 112 ]
    #
    #If in add mode, find only records tagged with
    #current $$citationmatch.
    If [ $$add = 1 ]
    #But, give user option to keep the records currently
    #showing in the main window.
    Show Custom Dialog [ Message: "In the main window, show only records with pictures and links added to copyright tags, or keep the current records shown?"; Default Button: “keep”, Commit: “Yes”; Button 2: “show”, Commit: “No” ]
    If [ Get ( LastMessageChoice ) = 1 ]
    Refresh Window
    Select Window [ Name: "Tag Menus"; Current file ]
    Exit Script [ ]
    End If
    #
    #find on reference layout ...
    If [ Left (Get (LayoutName) ; 1) = "r" ]
    Enter Find Mode [ ]
    Set Field [ reference::filterFind; "copyright" ]
    Perform Find [ ]
    #
    #find on learn layout ...
    Else If [ Left (Get (LayoutName) ; 1) = "l" ]
    Enter Find Mode [ ]
    Set Field [ testlearn::filterFind; "copyright" ]
    Perform Find [ ]
    End If
    End If
    End If
    #
    Refresh Window
    Select Window [ Name: "Tag Menus"; Current file ]
    #

Fields used in this script

    testlearn::date
    testlearn::timestamp
    TEMP::mTag
    TEMP::InventoryLibraryYN
    tagMenus::match
    tagMenuGroup::name
    tagMenus::textStyleOrCreatorNodeFlag
    tagMenus::tag
    tagMenus::_Ltag
    reference::filterFind
    testlearn::filterFind

Scripts used in this script

    loadTagRecord

Layouts used in this script

    ltagNK1
    ltagNKs1
    ReferenceMenu2keywordOrNode2
    addMenu1
    learnMenuCopyright
    learnMenuSCopyright
    ReferenceMenuCopyright

Tables used in this script

    TEMP
    reference
    tag
    tagGroup
    testlearn

Table occurrences used by this script

    TEMP
    reference
    tagMenuGroup
    tagMenus
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [menuCopyright]	Parent Folder: [tagMenu]	Next Script: [menuMedium]
Script Name	menuKey
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferenceMenuNoTags
    ReferenceMenu1
    ReferenceMenuCopyright
    ReferenceMenu3Cite
    ReferenceMenu3CiteNoPicture
    ReferenceMenu2keywordOrNode1
    ReferenceMenu2keywordOrNode2
    ReferenceMenu2keywordOrNode3
    ReferenceMenu2keywordOrNode4
    ReferenceMenu2keywordOrNode5
    ltagNK1
    ltagNK2
    ltagNK3
    ltagNK4
    ltagNK5
    learnMenu3Cite
    learnMenu3CiteS
    learnMenu4RefCite
    learnMenu4noPicRefCite
    learnTagWindowNoTags
    learnMenuBrainstorm
    learnTest

Scripts that use this script

    gotoLearn
    gotoReference
    findMode
    TgotoCitationMenu

Script Definition
Script Steps

    #
    #Prevent halting of script.
    Set Variable [ $$doNotHaltOtherScripts; Value:1 ]
    #
    #Clear brainstorm and test tags so there conditional
    #formatting in the Learn window is removed.
    Select Window [ Name: "Learn"; Current file ]
    Go to Field [ ]
    Set Variable [ $$tagBrainstorm ]
    Set Variable [ $$tagtest ]
    Set Variable [ $$tagRecordID ]
    Set Variable [ $$tagEdit ]
    If [ $$primaryKey = "" ]
    Set Variable [ $firstOtherKeyword; Value:Case ( Middle ( testlearn::OtherKeyWords ; Length ( LeftWords ( testlearn::OtherKeyWords ; 1 ) ) + 1 ; 1 ) = "," ; LeftWords ( testlearn::OtherKeyWords ; 1 ) ; Middle ( testlearn::OtherKeyWords ; Length ( LeftWords ( testlearn::OtherKeyWords ; 2 ) ) + 1 ; 1 ) = "," ; LeftWords ( testlearn::OtherKeyWords ; 2 ) ; Middle ( testlearn::OtherKeyWords ; Length ( LeftWords ( testlearn::OtherKeyWords ; 3 ) ) + 1 ; 1 ) = "," ; LeftWords ( testlearn::OtherKeyWords ; 3 ) ; Middle ( testlearn::OtherKeyWords ; Length ( LeftWords ( testlearn::OtherKeyWords ; 4 ) ) + 1 ; 1 ) = "," ; LeftWords ( testlearn::OtherKeyWords ; 4 ) ; LeftWords ( testlearn::OtherKeyWords ; 5 ) ) ]
    End If
    #
    #Sort the records by date field, if current sort is
    #by brainstorm or test order numbers.
    If [ $$citationMatch = "brainstorm" or $$citationMatch = "test" ]
    If [ TEMP::TLTestSort = 1 or TEMP::TLBrainstormSort = 1 ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::date; descending testlearn::timestamp; descending ] [ Restore; No dialog ]
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::note; ascending ] [ Restore; No dialog ]
    End If
    #
    #Set the sort preference field to date.
    If [ $$citationMatch = "brainstorm" ]
    Set Field [ TEMP::TLBrainstormSort; "" ]
    Else If [ $$citationMatch = "test" ]
    Set Field [ TEMP::TLTestSort; "" ]
    End If
    End If
    End If
    #
    #Exit fields in current tag menu to run
    #neccessary scripts.
    Select Window [ Name: "Tag Menus"; Current file ]
    Go to Field [ ]
    #
    #Conditionally format Tag Menu button.
    Set Variable [ $$citationMatch; Value:"key" ]
    #
    #Set match temp tag field to limit move pulldown
    #to just the groups for this section and item type.
    #( if you're wondering why this temp field is a
    # a dupllicate of the citation match variable it
    # is because I didn't need it until a year into
    # writing this database. At some point, it would
    # probably be good to get rid of the variable. )
    Set Field [ TEMP::mTag; $$citationMatch ]
    #
    #Do not load tag records until the end of script
    #to prevent flashing of window and to speed up
    #script.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    #
    #Speed up script by going to layout with no
    #pictures to load.
    If [ Left (Get (LayoutName) ; 1) = "l" ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Go to Layout [ “ltagNK1” (tagMenus) ]
    Else
    Go to Layout [ “ltagNKs1” (tagMenus) ]
    End If
    Else
    If [ TEMP::InventoryLibraryYN = "" ]
    Go to Layout [ “ReferenceMenu2keywordOrNode2” (tagMenus) ]
    Else
    Go to Layout [ “ReferenceMenu2SkeywordOrNode3” (tagMenus) ]
    End If
    End If
    #
    #Find key tags for library section if not found.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Enter Find Mode [ ]
    Set Field [ tagMenus::match; $$citationMatch ]
    Perform Find [ ]
    #
    // #If no records exist then create one.
    // If [ Get (FoundCount)=0 ]
    // Perform Script [ “newTagMenuTagGroup” ]
    // End If
    #
    #Sort according to current users wishes.
    If [ TEMP::sortKey = "cat" or TEMP::sortKey = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    Else If [ TEMP::sortKey = "abc" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenus::tag; ascending ] [ Restore; No dialog ]
    End If
    #
    #Decided not do this as user may be going to
    #node menus to add an node tag to a citation
    #the user is planning on adding to a tag
    #which means the user may want to remain in
    #add to tag mode when clicking on the node menu
    #item. In the first phase of developement
    #I thought if the user activitated the add mode
    #in either the keyword or node menu that the
    #user would not want to see the add button showing
    #green in the other window (keyword or node).
    #I was trying to keep the add button's on state
    #associated only with the menu item where it
    #was activitated. This in testing did not seem
    #useful at limited access to node or keyword
    #in this mode when both might be needed.
    // #If user was in Add mode for keyword, then reset
    // #mode back to citation mode (or adding node
    // #tags to citations instead of the other way around).
    // If [ $$add = 1 and $$addcitationMatch = "node" ]
    // Perform Script [ “addLinksPicturesToTagsMode” ]
    // End If
    #
    #Go to citation record's current selection or to first record.
    #Because user may click anywhere to go to a record
    #all keys for all menu items must uploaded
    #until one is found that matches and then the
    #$$citationItem variable can be set.
    #Like when the user clicks in a non field area
    #a space between fields that then tells filemaker
    #to go that record but not to field belonging to
    #that record.
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    If [ $$primaryKey ≠ "" ]
    Loop
    Exit Loop If [ $$primaryKey = tagMenus::_Ltag ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    Else If [ $firstOtherKeyword ≠ "" ]
    Loop
    Exit Loop If [ $firstOtherKeyword = LeftWords ( tagMenus::tag ; 5 ) ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    End If
    #
    #Goto correct layout.
    #If in add mode ...
    If [ $$add = 1 ]
    Go to Layout [ “addMenuNodeKeyword” (tagMenus) ]
    #
    #If user has elected to show only the tag ...
    Else If [ TEMP::layoutRtagK = "" and Left (Get (LayoutName) ; 1) = "r" or TEMP::layoutLtagK = "" and Left (Get (LayoutName) ; 1) = "l" ]
    If [ Left (Get (LayoutName) ; 1) = "l" ]
    Go to Layout [ “ltagNK2” (tagMenus) ]
    Set Field [ TEMP::layoutLtagK; "less" & Get (LayoutName) ]
    Else If [ Left (Get (LayoutName) ; 1) = "r" ]
    Go to Layout [ “ReferenceMenu2keywordOrNode2” (tagMenus) ]
    Set Field [ TEMP::layoutRtagK; "less" & Get (LayoutName) ]
    End If
    #
    #If user has elected to show some pictures ...
    Else If [ TEMP::layoutRtagK ≠ "" and Left (Get (LayoutName) ; 1) = "r" or TEMP::layoutLtagK ≠ "" and Left (Get (LayoutName) ; 1) = "l" ]
    If [ Left (Get (LayoutName) ; 1) = "l" ]
    Go to Layout [ Middle ( TEMP::layoutLtagK ; 5 ; 42 ) ]
    Else If [ Left (Get (LayoutName) ; 1) = "r" ]
    Go to Layout [ Middle ( TEMP::layoutRtagK ; 5 ; 42 ) ]
    End If
    End If
    #
    #Inform user of items use on both screens.
    Set Variable [ $$stopLoadTagRecord ]
    #
    #Prevent halting to loadTagRecord script.
    Set Variable [ $$doNotHaltOtherScripts; Value:1 ]
    Perform Script [ “loadTagRecord” ]
    Set Variable [ $$doNotHaltOtherScripts ]
    #
    #Just in case user was in nonTag field on this
    #window when user clicked a menu button on
    #the other window, exit all fields.
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    Go to Field [ ]
    Set Variable [ $$citationItem; Value:testlearn::kKeywordPrimary ]
    Else If [ Get (LastError) ≠ 112 ]
    Go to Field [ ]
    Set Variable [ $$citationItem; Value:reference::kkeywordPrimary ]
    #
    #If in add mode, find only records tagged with
    #current $$citationmatch.
    If [ $$add = 1 ]
    #
    #But, give user option to keep the records currently
    #showing in the main window.
    Show Custom Dialog [ Message: "In the main window, show only records with pictures and links added to keyword tags, or keep the current records shown?"; Default Button: “keep”, Commit: “Yes”; Button 2: “show”, Commit: “No” ]
    If [ Get ( LastMessageChoice ) = 1 ]
    Refresh Window
    Select Window [ Name: "Tag Menus"; Current file ]
    Exit Script [ ]
    End If
    #
    #find on learn layout ...
    If [ Left (Get (LayoutName) ; 1) = "l" ]
    Enter Find Mode [ ]
    Set Field [ testlearn::filterFind; "key" ]
    Perform Find [ ]
    #
    #find on reference layout ...
    Else If [ Left (Get (LayoutName) ; 1) = "r" ]
    Enter Find Mode [ ]
    Set Field [ reference::filterFind; "key" ]
    Perform Find [ ]
    End If
    End If
    #
    End If
    Refresh Window
    #
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    #
    #

Fields used in this script

    testlearn::OtherKeyWords
    TEMP::TLTestSort
    TEMP::TLBrainstormSort
    TEMP::InventoryLibraryYN
    testlearn::date
    testlearn::timestamp
    testlearn::note
    TEMP::mTag
    tagMenus::match
    TEMP::sortKey
    tagMenuGroup::orderOrLibraryType
    tagMenuGroup::name
    tagMenus::orderOrLock
    tagMenus::tag
    tagMenus::_Ltag
    TEMP::layoutRtagK
    TEMP::layoutLtagK
    testlearn::kKeywordPrimary
    reference::kkeywordPrimary
    testlearn::filterFind
    reference::filterFind

Scripts used in this script

    newTagMenuTagGroup
    addLinksPicturesToTagsMode
    loadTagRecord

Layouts used in this script

    ltagNK1
    ltagNKs1
    ReferenceMenu2keywordOrNode2
    ReferenceMenu2SkeywordOrNode3
    addMenuNodeKeyword
    ltagNK2
    <Missing Layout>

Tables used in this script

    TEMP
    reference
    tag
    tagGroup
    testlearn

Table occurrences used by this script

    TEMP
    reference
    tagMenuGroup
    tagMenus
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [menuKey]	Parent Folder: [tagMenu]	Next Script: [menuNode]
Script Name	menuMedium
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    findMode
    TgotoCitationMenu

Script Definition
Script Steps

    #
    #
    #Clear brainstorm and test tags so there conditional
    #formatting in the Learn window is removed.
    If [ $$citationMatch = "brainstorm" or $$citationMatch = "test" ]
    Select Window [ Name: "Learn"; Current file ]
    Go to Field [ ]
    Set Variable [ $$tagBrainstorm ]
    Set Variable [ $$tagtest ]
    Set Variable [ $$tagRecordID ]
    Set Variable [ $$tagEdit ]
    End If
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::date; descending testlearn::timestamp; descending ] [ Restore; No dialog ]
    #
    #Conditionally format Tag Menu button.
    Select Window [ Name: "Tag Menus"; Current file ]
    Set Variable [ $$citationMatch; Value:"medium" ]
    #
    #Set match temp tag field to limit move pulldown
    #to just the groups for this section and item type.
    #( if you're wondering why this temp field is a
    # a dupllicate of the citation match variable it
    # is because I didn't need it until a year into
    # writing this database. At some point, it would
    # probably be good to get rid of the variable. )
    Set Field [ TEMP::mTag; $$citationMatch ]
    #
    #Turn off the loadtagrecord script to speed up the
    #loop portion of the script.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    #
    #Goto correct layout.
    #If in add mode ...
    If [ $$add = 1 ]
    Go to Layout [ “addMenu1” (tagMenus) ]
    #
    #If in learn mode ...
    Else If [ Left (Get (LayoutName) ; 1) = "l" ]
    Go to Layout [ “learnMenu1” (tagMenus) ]
    #
    #If in reference mode ...
    Else If [ Left (Get (LayoutName) ; 1) = "r" ]
    Go to Layout [ “ReferenceMenu1” (tagMenus) ]
    End If
    #
    #Find medium tags. Medium tags are available to all library sections.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Enter Find Mode [ ]
    Set Field [ tagMenus::match; $$citationMatch ]
    Perform Find [ ]
    #
    // #If no records exist then create one.
    // If [ Get (FoundCount)=0 ]
    // Perform Script [ “newTagMenuTagGroup” ]
    // End If
    #
    #Sort according to current users wishes.
    If [ TEMP::sortMedium = "cat" or TEMP::sortMedium = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    Else If [ TEMP::sortMedium = "abc" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenus::tag; ascending ] [ Restore; No dialog ]
    End If
    #
    #Go to citation record's current selection or to first record.
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ $$medium = tagMenus::_Ltag ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Turn loadtagrecord script back on.
    Set Variable [ $$stopLoadTagRecord ]
    #
    If [ $$medium ≠ tagMenus::_Ltag ]
    Go to Record/Request/Page [ First ]
    // Exit Script [ ]
    End If
    #
    #Inform user of items use on both screens.
    Set Variable [ $$citationItem; Value:tagMenus::_Ltag ]
    Refresh Window
    #
    #Just in case user was in nonTag field on this
    #window when user clicked a menu button on
    #the other window, exit all fields.
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    Go to Field [ ]
    Else If [ Get (LastError) ≠ 112 ]
    Go to Field [ ]
    #
    #If in add mode, find only records tagged with
    #current $$citationmatch.
    If [ $$add = 1 ]
    #
    #But, give user option to keep the records currently
    #showing in the main window.
    Show Custom Dialog [ Message: "In the main window, show only records with pictures and links added to medium tags, or keep the current records shown?"; Default Button: “keep”, Commit: “Yes”; Button 2: “show”, Commit: “No” ]
    If [ Get ( LastMessageChoice ) = 1 ]
    Refresh Window
    Select Window [ Name: "Tag Menus"; Current file ]
    Exit Script [ ]
    End If
    #
    #find on reference layout ...
    If [ Left (Get (LayoutName) ; 1) = "r" ]
    Enter Find Mode [ ]
    Set Field [ reference::filterFind; "medium" ]
    Perform Find [ ]
    #
    #find on learn layout ...
    Else If [ Left (Get (LayoutName) ; 1) = "l" ]
    Enter Find Mode [ ]
    Set Field [ testlearn::filterFind; "medium" ]
    Perform Find [ ]
    End If
    End If
    End If
    Refresh Window
    Select Window [ Name: "Tag Menus"; Current file ]

Fields used in this script

    testlearn::date
    testlearn::timestamp
    TEMP::mTag
    tagMenus::match
    TEMP::sortMedium
    tagMenuGroup::orderOrLibraryType
    tagMenuGroup::name
    tagMenus::orderOrLock
    tagMenus::tag
    tagMenus::_Ltag
    reference::filterFind
    testlearn::filterFind

Scripts used in this script

    newTagMenuTagGroup

Layouts used in this script

    addMenu1
    learnMenu1
    ReferenceMenu1

Tables used in this script

    TEMP
    reference
    tag
    tagGroup
    testlearn

Table occurrences used by this script

    TEMP
    reference
    tagMenuGroup
    tagMenus
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [menuMedium]	Parent Folder: [tagMenu]	Next Script: [menuPath]
Script Name	menuNode
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferenceMenuNoTags
    ReferenceMenu1
    ReferenceMenuCopyright
    ReferenceMenu3Cite
    ReferenceMenu3CiteNoPicture
    ReferenceMenu2keywordOrNode1
    ReferenceMenu2SkeywordOrNode1
    ReferenceMenu2keywordOrNode2
    ReferenceMenu2SkeywordOrNode2
    ReferenceMenu2keywordOrNode3
    ReferenceMenu2SkeywordOrNode3
    ReferenceMenu2keywordOrNode4
    ReferenceMenu2SkeywordOrNode4
    ReferenceMenu2keywordOrNode5
    ReferenceMenu2SkeywordOrNode5
    ltagNK1
    ltagNKs1
    ltagNK2
    ltagNKs2
    ltagNK3
    ltagNKs3
    ltagNK4
    ltagNKs4
    ltagNK5
    ltagNKs5
    learnMenu3Cite
    learnMenu3CiteS
    learnMenuRefStuff
    learnMenu4RefCite
    learnMenu4noPicRefCite
    learnMenu4STUFFRefCite
    learnTagWindowNoTags
    learnMenuBrainstorm
    learnMenuStuffBrainstorm
    learnTest
    learnSTest

Scripts that use this script

    findMode
    TgotoCitationMenu

Script Definition
Script Steps

    #
    #Prevent halting of script.
    Set Variable [ $$doNotHaltOtherScripts; Value:1 ]
    #
    #If user is in tag field and has changed spelling
    #exit this tag record, otherwise current reference record
    #will get deleted by the spelling check script.
    Go to Field [ ]
    #
    #Clear brainstorm and test tags so there conditional
    #formatting in the Learn window is removed.
    If [ $$citationMatch = "brainstorm" or $$citationMatch = "test" ]
    Select Window [ Name: "Learn"; Current file ]
    Go to Field [ ]
    Set Variable [ $$citationItem; Value:testlearn::kNodePrimary ]
    Set Variable [ $$tagBrainstorm ]
    Set Variable [ $$tagtest ]
    Set Variable [ $$tagRecordID ]
    Set Variable [ $$tagEdit ]
    #
    #Sort the records by date field, if current sort is
    #by order number.
    If [ TEMP::TLTestSort = 1 or TEMP::TLBrainstormSort = 1 ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::date; descending testlearn::timestamp; descending ] [ Restore; No dialog ]
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::orderInventoryGroupNumber; ascending testlearn::note; ascending ] [ Restore; No dialog ]
    End If
    #
    #Set the sort preference field to date.
    If [ $$citationMatch = "brainstorm" ]
    Set Field [ TEMP::TLBrainstormSort; "" ]
    Else If [ $$citationMatch = "test" ]
    Set Field [ TEMP::TLTestSort; "" ]
    End If
    #
    End If
    End If
    #
    #Conditionally format Tag Menu button.
    Select Window [ Name: "Tag Menus"; Current file ]
    Set Variable [ $$citationMatch; Value:"node" ]
    #
    #Set match temp tag field to limit move pulldown
    #to just the groups for this section and item type.
    #( if you're wondering why this temp field is a
    # a dupllicate of the citation match variable it
    # is because I didn't need it until a year into
    # writing this database. At some point, it would
    # probably be good to get rid of the variable. )
    Set Field [ TEMP::mTag; $$citationMatch ]
    #
    #Do not load tag records until the end of script
    #to prevent flashing of window and to speed up
    #script.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    #
    #Speed up script by going to layout with no
    #pictures to load.
    If [ Left (Get (LayoutName) ; 1) = "l" ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Go to Layout [ “ltagNK1” (tagMenus) ]
    Else
    Go to Layout [ “ltagNKs1” (tagMenus) ]
    End If
    Else
    If [ TEMP::InventoryLibraryYN = "" ]
    Go to Layout [ “ReferenceMenu2keywordOrNode2” (tagMenus) ]
    Else
    End If
    End If
    #
    #Find node tags.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Enter Find Mode [ ]
    Set Field [ tagMenus::match; $$citationMatch ]
    #
    #In Learn section only show creator nodes,
    #as these are the only nodes that can create
    #or edit learn records.
    If [ Left (Get (LayoutName) ; 1) = "l" ]
    Set Field [ tagMenus::textStyleOrCreatorNodeFlag; 123456789 ]
    End If
    Perform Find [ ]
    #
    #Sort according to current users wishes.
    If [ TEMP::sortNode = "cat" or TEMP::sortNode = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::tag; ascending ] [ Restore; No dialog ]
    Else If [ TEMP::sortNode = "abc" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenus::tag; ascending ] [ Restore; No dialog ]
    End If
    #
    #Decided not do this as user may be going to
    #node menus to add an node tag to a citation
    #the user is planning on adding to a tag
    #which means the user may want to remain in
    #add to tag mode when clicking on the node menu
    #item. In the first phase of developement
    #I thought if the user activitated the add mode
    #in either the keyword or node menu that the
    #user would not want to see the add button showing
    #green in the other window (keyword or node).
    #I was trying to keep the add button's on state
    #associated only with the menu item where it
    #was activitated. This in testing did not seem
    #useful at limited access to node or keyword
    #in this mode when both might be needed.
    // #If user was in Add mode for keyword, then reset
    // #mode back to citation mode (or adding node
    // #tags to citations instead of the other way around).
    // If [ $$add = 1 and $$addcitationMatch = "key" ]
    // Perform Script [ “addLinksPicturesToTagsMode” ]
    // End If
    #
    #Go to citation record's current selection or to first record.
    #Because user may click anywhere to go to a record
    #all keys for all menu items must uploaded
    #until one is found that matches and then the
    #$$citationItem variable can be set.
    #Like when the user clicks in a non field area
    #a space between fields that then tells filemaker
    #to go that record but not to field belonging to
    #that record.
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ $$primaryNode = tagMenus::_Ltag ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    If [ $$primaryNode ≠ tagMenus::_Ltag ]
    Go to Record/Request/Page [ First ]
    End If
    #
    #Goto correct layout.
    #If in add mode ...
    If [ $$add = 1 ]
    Go to Layout [ “addMenuNodeKeyword” (tagMenus) ]
    #
    #If user has elected to show only the tag ...
    Else If [ TEMP::layoutRtagN = "" and Left (Get (LayoutName) ; 1) = "r" or TEMP::layoutLtagN = "" and Left (Get (LayoutName) ; 1) = "l" ]
    If [ Left (Get (LayoutName) ; 1) = "l" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “ltagNKs2” (tagMenus) ]
    Else
    Go to Layout [ “ltagNK2” (tagMenus) ]
    End If
    Set Field [ TEMP::layoutLtagN; "less" & Get (LayoutName) ]
    Else If [ Left (Get (LayoutName) ; 1) = "r" ]
    Go to Layout [ “ReferenceMenu2keywordOrNode2” (tagMenus) ]
    Set Field [ TEMP::layoutRtagN; "less" & Get (LayoutName) ]
    End If
    #
    #If user has elected to show some pictures ...
    Else If [ TEMP::layoutRtagN ≠ "" and Left (Get (LayoutName) ; 1) = "r" or TEMP::layoutLtagN ≠ "" and Left (Get (LayoutName) ; 1) = "l" ]
    If [ Left (Get (LayoutName) ; 1) = "l" ]
    Go to Layout [ Middle ( TEMP::layoutLtagN ; 5 ; 42 ) ]
    Else If [ Left (Get (LayoutName) ; 1) = "r" ]
    Go to Layout [ Middle ( TEMP::layoutRtagN ; 5 ; 42 ) ]
    End If
    End If
    #
    #Inform user of items use on both screens.
    Set Variable [ $$stopLoadTagRecord ]
    Set Variable [ $$doNotHaltOtherScripts; Value:1 ]
    Perform Script [ “loadTagRecord” ]
    Set Variable [ $$doNotHaltOtherScripts ]
    #
    #Just in case user was in nonTag field on this
    #window when user clicked a menu button on
    #the other window, exit all fields.
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    Go to Field [ ]
    Set Variable [ $$citationItem; Value:testlearn::kNodePrimary ]
    Set Variable [ $$tagBrainstorm ]
    Set Variable [ $$tagRecordID ]
    Set Variable [ $$tagEdit ]
    Else If [ Get (LastError) ≠ 112 ]
    #
    #If in add mode, find only records tagged with
    #current $$citationmatch.
    If [ $$add = 1 ]
    #
    #But, give user option to keep the records currently
    #showing in the main window.
    Show Custom Dialog [ Message: "In the main window, show only records with pictures and links added to node tags, or keep the current records shown?"; Default Button: “keep”, Commit: “Yes”; Button 2: “show”, Commit: “No” ]
    If [ Get ( LastMessageChoice ) = 1 ]
    Refresh Window
    Select Window [ Name: "Tag Menus"; Current file ]
    Exit Script [ ]
    End If
    #
    #find on reference layout ...
    If [ Left (Get (LayoutName) ; 1) = "r" ]
    Enter Find Mode [ ]
    Set Field [ reference::filterFind; "node" ]
    Perform Find [ ]
    #
    #find on learn layout ...
    Else If [ Left (Get (LayoutName) ; 1) = "l" ]
    Enter Find Mode [ ]
    Set Field [ testlearn::filterFind; "node" ]
    Perform Find [ ]
    End If
    End If
    Set Variable [ $$citationItem; Value:reference::knodePrimary ]
    End If
    Refresh Window
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    #
    #Show creator node explanation
    #once per session in idea mode only.
    If [ TEMP::InventoryLibraryYN = "" ]
    If [ $$showCreatorNodemessageOnlyOnce = "" ]
    Show Custom Dialog [ Message: "Library setup and learn sections require creator nodes to create and edit records in this library and to be the subjects of tests. Author nodes are used in the reference section to tag referenced works as their authors."; Default Button: “OK”, Commit: “Yes” ]
    Show Custom Dialog [ Message: "NOTE: Creator nodes are listed in the reference section, where they can be used to tag a reference as an author. Author nodes are never listed in the setup or learn sections."; Default Button: “OK”, Commit: “Yes” ]
    Show Custom Dialog [ Message: "These messages appear only per session. Restart this library to see them again."; Default Button: “OK”, Commit: “Yes” ]
    Set Variable [ $$showCreatorNodemessageOnlyOnce; Value:1 ]
    End If
    End If
    #

Fields used in this script

    testlearn::kNodePrimary
    TEMP::TLTestSort
    TEMP::TLBrainstormSort
    TEMP::InventoryLibraryYN
    testlearn::date
    testlearn::timestamp
    testlearn::orderInventoryGroupNumber
    testlearn::note
    TEMP::mTag
    tagMenus::match
    tagMenus::textStyleOrCreatorNodeFlag
    TEMP::sortNode
    tagMenuGroup::orderOrLibraryType
    tagMenuGroup::name
    tagMenus::tag
    tagMenus::_Ltag
    TEMP::layoutRtagN
    TEMP::layoutLtagN
    reference::filterFind
    testlearn::filterFind

Scripts used in this script

    addLinksPicturesToTagsMode
    loadTagRecord

Layouts used in this script

    ltagNK1
    ltagNKs1
    ReferenceMenu2keywordOrNode2
    addMenuNodeKeyword
    ltagNKs2
    ltagNK2
    <Missing Layout>

Tables used in this script

    TEMP
    reference
    tag
    tagGroup
    testlearn

Table occurrences used by this script

    TEMP
    reference
    tagMenuGroup
    tagMenus
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [menuNode]	Parent Folder: [tagMenu]	Next Script: [menuPublication]
Script Name	menuPath
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferenceMenuNoTags
    ReferenceMenu1
    ReferenceMenuCopyright
    ReferenceMenu3Cite
    ReferenceMenu3CiteNoPicture
    ReferenceMenu2keywordOrNode1
    ReferenceMenu2keywordOrNode2
    ReferenceMenu2keywordOrNode3
    ReferenceMenu2keywordOrNode4
    ReferenceMenu2keywordOrNode5

Scripts that use this script

    addFileLink4ToTag
    addFileLink6ToTag
    addFileLink5ToTag
    findMode
    TgotoCitationMenu

Script Definition
Script Steps

    #
    #
    #Prevent halting of script.
    Set Variable [ $$doNotHaltOtherScripts; Value:1 ]
    #
    #If user is in tag field and has changed spelling
    #exit this tag record, otherwise current reference record
    #will get deleted by the spelling check script.
    Go to Field [ ]
    #
    #Clear brainstorm and test tags so there conditional
    #formatting in the Learn window is removed.
    If [ $$citationMatch = "brainstorm" or $$citationMatch = "test" ]
    Select Window [ Name: "Learn"; Current file ]
    Go to Field [ ]
    Set Variable [ $$tagBrainstorm ]
    Set Variable [ $$tagtest ]
    Set Variable [ $$tagRecordID ]
    Set Variable [ $$tagEdit ]
    End If
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::date; descending testlearn::timestamp; descending ] [ Restore; No dialog ]
    #
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    #Set citationMatch to color menu button with inUse color.
    Set Variable [ $$citationMatch; Value:"path" ]
    Set Variable [ $$doNotHaltOtherScripts ]
    #
    #Set match temp tag field to limit move pulldown
    #to just the groups for this section and item type.
    #( if you're wondering why this temp field is a
    # a dupllicate of the citation match variable it
    # is because I didn't need it until a year into
    # writing this database. At some point, it would
    # probably be good to get rid of the variable. )
    Set Field [ TEMP::mTag; $$citationMatch ]
    #
    #Turn off the loadtagrecord script to speed up the
    #loop portion of the script.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    #
    #Goto correct layout.
    #If in add mode ...
    If [ $$add = 1 ]
    Go to Layout [ “addMenu1” (tagMenus) ]
    #
    #If in learn mode ...
    Else If [ Left (Get (LayoutName) ; 1) = "l" ]
    Go to Layout [ “learnMenu1” (tagMenus) ]
    #
    #If in reference mode ...
    Else If [ Left (Get (LayoutName) ; 1) = "r" ]
    Go to Layout [ “ReferenceMenu1” (tagMenus) ]
    End If
    #
    #Find Path tags. Path tags are available to all library sections.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Enter Find Mode [ ]
    Set Field [ tagMenus::match; "Path" ]
    Perform Find [ ]
    #
    #If no records exist then create one.
    If [ Get (FoundCount)=0 ]
    Perform Script [ “newTagMenuTagGroup” ]
    End If
    #
    #Sort according to current users wishes.
    Sort Records [ ] [ No dialog ]
    #
    #Sort according to current users wishes.
    If [ TEMP::sortPath = "cat" or TEMP::sortPath = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    Else If [ TEMP::sortPath = "abc" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenus::tag; ascending ] [ Restore; No dialog ]
    End If
    #
    #Go to citation record's current selection or to first record.
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ $$Path = tagMenus::_Ltag ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Turn loadtagrecord script back on.
    Set Variable [ $$stopLoadTagRecord ]
    #
    If [ $$Path ≠ tagMenus::_Ltag ]
    Go to Record/Request/Page [ First ]
    // Exit Script [ ]
    End If
    #
    #Inform user of items use on both screens.
    Set Variable [ $$citationItem; Value:tagMenus::_Ltag ]
    Refresh Window
    #
    #Just in case user was in nonTag field on this
    #window when user clicked a menu button on
    #the other window, exit all fields.
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    Go to Field [ ]
    Else If [ Get (LastError) ≠ 112 ]
    #
    #If in add mode, find only records tagged with
    #current $$citationmatch.
    If [ $$add = 1 ]
    #
    #But, give user option to keep the records currently
    #showing in the main window.
    Show Custom Dialog [ Message: "In the main window, show only records with pictures and links added to file path tags, or keep the current records shown?"; Default Button: “keep”, Commit: “Yes”; Button 2: “show”, Commit: “No” ]
    If [ Get ( LastMessageChoice ) = 1 ]
    Refresh Window
    Select Window [ Name: "Tag Menus"; Current file ]
    Exit Script [ ]
    End If
    #
    #find on reference layout ...
    If [ Left (Get (LayoutName) ; 1) = "r" ]
    Enter Find Mode [ ]
    Set Field [ reference::filterFind; "path" ]
    Perform Find [ ]
    #
    #find on learn layout ...
    Else If [ Left (Get (LayoutName) ; 1) = "l" ]
    Enter Find Mode [ ]
    Set Field [ testlearn::filterFind; "path" ]
    Perform Find [ ]
    End If
    End If
    End If
    Refresh Window
    Select Window [ Name: "Tag Menus"; Current file ]

Fields used in this script

    testlearn::date
    testlearn::timestamp
    TEMP::mTag
    tagMenus::match
    TEMP::sortPath
    tagMenus::_Ltag
    reference::filterFind
    testlearn::filterFind

Scripts used in this script

    newTagMenuTagGroup

Layouts used in this script

    addMenu1
    learnMenu1
    ReferenceMenu1

Tables used in this script

    TEMP
    reference
    tag
    testlearn

Table occurrences used by this script

    TEMP
    reference
    tagMenus
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [menuPath]	Parent Folder: [tagMenu]	Next Script: [menuPublisher]
Script Name	menuPublication
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferenceMenuNoTags
    ReferenceMenu1
    ReferenceMenuCopyright
    ReferenceMenu3Cite
    ReferenceMenu3CiteNoPicture
    ReferenceMenu2keywordOrNode1
    ReferenceMenu2keywordOrNode2
    ReferenceMenu2keywordOrNode3
    ReferenceMenu2keywordOrNode4
    ReferenceMenu2keywordOrNode5

Scripts that use this script

    findMode
    TgotoCitationMenu

Script Definition
Script Steps

    #
    #
    #Prevent halting of script.
    Set Variable [ $$doNotHaltOtherScripts; Value:1 ]
    #
    #If user is in tag field and has changed spelling
    #exit this tag record, otherwise current reference record
    #will get deleted by the spelling check script.
    Go to Field [ ]
    #
    #Set citationMatch to color menu button with inUse color.
    Set Variable [ $$citationMatch; Value:"publication" ]
    Set Variable [ $$doNotHaltOtherScripts ]
    #
    #Turn off loading tag record script until end.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    #
    #Set match temp tag field to limit move pulldown
    #to just the groups for this section and item type.
    #( if you're wondering why this temp field is a
    # a dupllicate of the citation match variable it
    # is because I didn't need it until a year into
    # writing this database. At some point, it would
    # probably be good to get rid of the variable. )
    Set Field [ TEMP::mTag; $$citationMatch ]
    #
    #Goto correct layout.
    #If in add mode ...
    If [ $$add = 1 ]
    Go to Layout [ “addMenu1” (tagMenus) ]
    #
    #If in reference mode ...
    Else If [ Left (Get (LayoutName) ; 1) = "r" ]
    Go to Layout [ “ReferenceMenu1” (tagMenus) ]
    End If
    #
    #Find publication tags.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Enter Find Mode [ ]
    Set Field [ tagMenus::match; "publication" ]
    Perform Find [ ]
    #
    #If no records exist then create one.
    If [ Get (FoundCount)=0 ]
    Perform Script [ “newTagMenuTagGroup” ]
    End If
    #
    #Sort according to current users wishes.
    Sort Records [ ] [ No dialog ]
    #
    #Sort according to current users wishes.
    If [ TEMP::sortPublication = "cat" or TEMP::sortPublication = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    Else If [ TEMP::sortPublication = "abc" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenus::tag; ascending ] [ Restore; No dialog ]
    End If
    #
    #Go to citation record's current selection or to first record.
    #Because user may click anywhere to go to a record
    #all keys for all menu items must uploaded
    #until one is found that matches and then the
    #$$citationItem variable can be set.
    #Like when the user clicks in a non field area
    #a space between fields that then tells filemaker
    #to go that record but not to field belonging to
    #that record.
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ $$publication = tagMenus::_Ltag ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    If [ $$publication ≠ tagMenus::_Ltag ]
    Go to Record/Request/Page [ First ]
    #
    #Set this variable to stop conditional formatting
    #of unselected first Tag Menus record.
    Set Variable [ $$TgotoCitationMenuWithBlankField; Value:1 ]
    Else
    Set Variable [ $$TgotoCitationMenuWithBlankField ]
    End If
    #
    #Turn on loading tag record script.
    Set Variable [ $$stopLoadTagRecord ]
    Perform Script [ “loadTagRecord” ]
    #
    #Inform user of items use on both screens.
    Set Variable [ $$citationItem; Value:tagMenus::_Ltag ]
    Refresh Window
    Select Window [ Name: "References"; Current file ]
    #Just in case user was in nonTag field on this
    #window when user clicked a menu button on
    #the other window, exit all fields.
    Go to Field [ ]
    #
    #If in add mode, find only records tagged with
    #current $$citationmatch on reference layout.
    #The learn record is never changed.
    If [ Left (Get (LayoutName) ; 1) = "r" ]
    If [ $$add = 1 ]
    #
    #But, give user option to keep the records currently
    #showing in the main window.
    Show Custom Dialog [ Message: "In the main window, show only records with pictures and links added to publication tags, or keep the current records shown?"; Default Button: “keep”, Commit: “Yes”; Button 2: “show”, Commit: “No” ]
    If [ Get ( LastMessageChoice ) = 1 ]
    Refresh Window
    Select Window [ Name: "Tag Menus"; Current file ]
    Exit Script [ ]
    End If
    #
    #find on reference layout ...
    Enter Find Mode [ ]
    Set Field [ reference::filterFind; "publication" ]
    Perform Find [ ]
    End If
    End If
    #
    Refresh Window
    Select Window [ Name: "Tag Menus"; Current file ]
    #

Fields used in this script

    TEMP::mTag
    tagMenus::match
    TEMP::sortPublication
    tagMenus::_Ltag
    reference::filterFind

Scripts used in this script

    newTagMenuTagGroup
    loadTagRecord

Layouts used in this script

    addMenu1
    ReferenceMenu1

Tables used in this script

    TEMP
    reference
    tag

Table occurrences used by this script

    TEMP
    reference
    tagMenus

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [menuPublication]	Parent Folder: [tagMenu]	Next Script: [menuReference]
Script Name	menuPublisher
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferenceMenuNoTags
    ReferenceMenu1
    ReferenceMenuCopyright
    ReferenceMenu3Cite
    ReferenceMenu3CiteNoPicture
    ReferenceMenu2keywordOrNode1
    ReferenceMenu2keywordOrNode2
    ReferenceMenu2keywordOrNode3
    ReferenceMenu2keywordOrNode4
    ReferenceMenu2keywordOrNode5

Scripts that use this script

    findMode
    TgotoCitationMenu

Script Definition
Script Steps

    #
    #
    #Prevent halting of script.
    Set Variable [ $$doNotHaltOtherScripts; Value:1 ]
    #
    #If user is in tag field and has changed spelling
    #exit this tag record, otherwise current reference record
    #will get deleted by the spelling check script.
    Go to Field [ ]
    #
    #Set citationMatch to color menu button with inUse color.
    Set Variable [ $$citationMatch; Value:"publisher" ]
    Set Variable [ $$doNotHaltOtherScripts ]
    #
    #Turn off loading tag record script until end.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    #
    #Set match temp tag field to limit move pulldown
    #to just the groups for this section and item type.
    #( if you're wondering why this temp field is a
    # a dupllicate of the citation match variable it
    # is because I didn't need it until a year into
    # writing this database. At some point, it would
    # probably be good to get rid of the variable. )
    Set Field [ TEMP::mTag; $$citationMatch ]
    #
    #Goto correct layout.
    #If in add mode ...
    If [ $$add = 1 ]
    Go to Layout [ “addMenu1” (tagMenus) ]
    #
    #If not in add mode ...
    Else If [ $$add ≠ 1 ]
    Go to Layout [ “ReferenceMenu1” (tagMenus) ]
    End If
    #
    #Find publisher's tags.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Enter Find Mode [ ]
    Set Field [ tagMenus::match; $$citationMatch ]
    Perform Find [ ]
    #
    #Sort according to current users wishes.
    If [ TEMP::sortPublisher = "cat" or TEMP::sortPublisher = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    Else If [ TEMP::sortPublisher = "abc" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenus::tag; ascending ] [ Restore; No dialog ]
    End If
    #
    #Go to citation record's current selection or to first record.
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ $$publisher = tagMenus::_Ltag ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    If [ $$publisher ≠ tagMenus::_Ltag ]
    Go to Record/Request/Page [ First ]
    #
    #Set this variable to stop conditional formatting
    #of unselected first Tag Menus record.
    Set Variable [ $$TgotoCitationMenuWithBlankField; Value:1 ]
    Else
    Set Variable [ $$TgotoCitationMenuWithBlankField ]
    End If
    #
    #Turn on loading tag record script.
    Set Variable [ $$stopLoadTagRecord ]
    Perform Script [ “loadTagRecord” ]
    #
    #Inform user of items use on both screens.
    Set Variable [ $$citationItem; Value:tagMenus::_Ltag ]
    Refresh Window
    Select Window [ Name: "References"; Current file ]
    #
    #If in add mode, find only records tagged with
    #current $$citationmatch on reference layout.
    #The learn record is never changed.
    If [ Left (Get (LayoutName) ; 1) = "r" ]
    If [ $$add = 1 ]
    #
    #But, give user option to keep the records currently
    #showing in the main window.
    Show Custom Dialog [ Message: "In the main window, show only records with pictures and links added to publisher tags, or keep the current records shown?"; Default Button: “keep”, Commit: “Yes”; Button 2: “show”, Commit: “No” ]
    If [ Get ( LastMessageChoice ) = 1 ]
    Refresh Window
    Select Window [ Name: "Tag Menus"; Current file ]
    Exit Script [ ]
    End If
    #
    #find on reference layout ...
    Enter Find Mode [ ]
    Set Field [ reference::filterFind; "publisher" ]
    Perform Find [ ]
    End If
    End If
    #
    #Just in case user was in nonTag field on this
    #window when user clicked a menu button on
    #the other window, exit all fields.
    Go to Field [ ]
    Refresh Window
    Select Window [ Name: "Tag Menus"; Current file ]
    #

Fields used in this script

    TEMP::mTag
    tagMenus::match
    TEMP::sortPublisher
    tagMenuGroup::orderOrLibraryType
    tagMenuGroup::name
    tagMenus::orderOrLock
    tagMenus::tag
    tagMenus::_Ltag
    reference::filterFind

Scripts used in this script

    loadTagRecord

Layouts used in this script

    addMenu1
    ReferenceMenu1

Tables used in this script

    TEMP
    reference
    tag
    tagGroup

Table occurrences used by this script

    TEMP
    reference
    tagMenuGroup
    tagMenus

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [menuPublisher]	Parent Folder: [tagMenu]	Next Script: [menuTest]
Script Name	menuReference
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ltagNK1
    ltagNKs1
    ltagNK2
    ltagNKs2
    ltagNK3
    ltagNKs3
    ltagNK4
    ltagNKs4
    ltagNK5
    ltagNKs5
    learnMenu3Cite
    learnMenu3CiteS
    learnMenuRefStuff
    learnMenu4RefCite
    learnMenu4noPicRefCite
    learnMenu4STUFFRefCite
    learnTagWindowNoTags
    learnMenuBrainstorm
    learnMenuStuffBrainstorm
    learnTest
    learnSTest

Scripts that use this script

    gotoLearn
    backToLearnOrDefaultSetup
    findMode
    TgotoCitationMenu

Script Definition
Script Steps

    #
    #
    #Prevent halting of script.
    Set Variable [ $$doNotHaltOtherScripts; Value:1 ]
    #
    #If user is in tag field and has changed spelling
    #exit this tag record, otherwise current reference record
    #will get deleted by the spelling check script.
    Go to Field [ ]
    #
    #Clear brainstorm and test tags so there conditional
    #formatting in the Learn window is removed.
    If [ $$citationMatch = "brainstorm" or $$citationMatch = "test" ]
    Select Window [ Name: "Learn"; Current file ]
    Go to Field [ ]
    Set Variable [ $$tagBrainstorm ]
    Set Variable [ $$tagtest ]
    Set Variable [ $$tagRecordID ]
    Set Variable [ $$tagEdit ]
    #
    #Sort the records by date field, if current sort is
    #by order number.
    If [ TEMP::TLTestSort = 1 or TEMP::TLBrainstormSort = 1 ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::date; descending testlearn::timestamp; descending ] [ Restore; No dialog ]
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::orderInventoryGroupNumber; ascending testlearn::note; ascending ] [ Restore; No dialog ]
    End If
    #
    #Set the sort preference field to date.
    If [ $$citationMatch = "brainstorm" ]
    Set Field [ TEMP::TLBrainstormSort; "" ]
    Else If [ $$citationMatch = "test" ]
    Set Field [ TEMP::TLTestSort; "" ]
    End If
    End If
    #
    End If
    #
    #Admin tasks.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    #
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    #Set citationMatch to color menu button with inUse color.
    Set Variable [ $$citationMatch; Value:"ref" ]
    #
    Set Variable [ $$doNotHaltOtherScripts ]
    #
    Set Variable [ $$stoploadCitation; Value:1 ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    #
    #Set testlearn internal reference field conditional
    #formatting to transparent.
    Set Variable [ $$internal ]
    #
    #Speed up script by going to layout with no
    #pictures to load.
    If [ Left (Get (LayoutName) ; 1) = "l" ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Go to Layout [ “learnMenu3CiteS” (reference) ]
    Else
    Go to Layout [ “learnMenu3CiteS” (reference) ]
    // Go to Layout [ “learnMenuRefStuff” (reference) ]
    End If
    Else
    If [ TEMP::InventoryLibraryYN = "" ]
    Go to Layout [ “ReferenceMenu3Cite” (reference) ]
    Else
    End If
    End If
    #
    #Find References for the Learn module.
    If [ TEMP::InventoryLibraryYN = "" ]
    #
    #If in idea mode then show only references user
    #has selected to show in the Learn module.
    Enter Find Mode [ ]
    Set Field [ reference::showInLearn; "show in learn" ]
    Perform Find [ ]
    #
    Else
    #
    #If in inventory mode then show all references
    #(except the locked references).
    Enter Find Mode [ ]
    Set Field [ tagInventoryLocation::match; "location" ]
    Perform Find [ ]
    #
    End If
    #
    #Sort records.
    If [ TEMP::InventoryLibraryYN = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagKeywordPrimary::orderOrLock; based on value list: “order Pulldown List” tagKeywordPrimary::tag; ascending reference::referenceShort; ascending ] [ Restore; No dialog ]
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagKeywordPrimary::orderOrLock; based on value list: “order Pulldown List” tagKeywordPrimary::tag; ascending reference::publicationYearOrStuffOrderNumber; based on value list: “order Pulldown List” reference::Title; ascending ] [ Restore; No dialog ]
    End If
    #
    #Go to citation record's current selection or to first record.
    Go to Record/Request/Page [ First ]
    #
    #If current learn record is tagged with a
    #reference, find it.
    If [ Length ( Filter ( $$ref ; "L" ) ) ≠ ValueCount ( $$ref ) ]
    Loop
    Exit Loop If [ FilterValues ( $$ref ; reference::_Lreference ) = reference::_Lreference & ¶ ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    End If
    #
    #Clear these variables and then load them.
    Set Variable [ $$refIDForMainLearnRecord ]
    Set Variable [ $$learnIDForMainLearnRecord; Value:reference::_Lreference ]
    Set Variable [ $$refIDForMainLearnRecord; Value:reference::_Lreference ]
    #
    #Goto correct layout.
    If [ TEMP::InventoryLibraryYN = "" ]
    #Idea Mode
    #
    #If no layout preference is set, then on iDevices
    #go the layout with no pictures, and to the
    #layout with pictures on desktop computers.
    If [ TEMP::layoutLtagR = "" ]
    If [ Get (SystemPlatform) = 3 ]
    Go to Layout [ “learnMenu3CiteS” (reference) ]
    Set Field [ TEMP::layoutLtagR; "more" & Get (LayoutName) ]
    Else
    Go to Layout [ “learnMenu3Cite” (reference) ]
    Set Field [ TEMP::layoutLtagR; "less" & Get (LayoutName) ]
    End If
    Else
    #
    #Go the layout the user has selected.
    Go to Layout [ Middle ( TEMP::layoutLtagR ; 5 ; 42 ) ]
    End If
    #
    Else
    #Inventory Mode
    #
    #Go the location tag layout.
    Go to Layout [ “learnMenuRefStuff” (reference) ]
    Set Variable [ $$editLocation; Value:reference::_Lreference ]
    End If
    #
    If [ FilterValues ( $$ref ; reference::_Lreference ) ≠ reference::_Lreference & ¶ ]
    #
    #Decided below was too much help. User can look
    #on main screen to see where cite or reference is located.
    // #Clear reference location variable that conditionally
    // #formatts buttons to tell user where reference is located.
    // Set Variable [ $$refIsRefRecord ]
    #
    Scroll Window [ Home ]
    Go to Record/Request/Page [ First ]
    Set Variable [ $$stoploadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    #
    #
    #In inventory mode prevent the showing of
    #hidden edit fields.
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Perform Script [ “loadTagRecord” ]
    Exit Script [ ]
    End If
    #
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    Go to Field [ ]
    Else If [ Get (LastError) ≠ 112 ]
    Go to Field [ ]
    End If
    Refresh Window
    Select Window [ Name: "Tag Menus"; Current file ]
    Set Variable [ $stopref ]
    Exit Script [ ]
    End If
    #
    #
    #
    #
    #
    #Decided below was too much help. User can look
    #on main screen to see where cite or reference is located.
    #
    #
    #
    #
    #
    // #Turn on reference location variable that conditionally
    // #formatts buttons to tell user where reference is located.
    // Set Variable [ $$refIsRefRecord; Value:1 ]
    #
    Set Variable [ $$stoploadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    #
    #Inform user of items use on both screens.
    Set Variable [ $$citationItem; Value:reference::_Lreference ]
    Refresh Window
    #Just in case user was in nonTag field on this
    #window when user clicked a menu button on
    #the other window, exit all fields.
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    Go to Field [ ]
    Else If [ Get (LastError) ≠ 112 ]
    Go to Field [ ]
    End If
    Refresh Window
    Select Window [ Name: "Tag Menus"; Current file ]

Fields used in this script

    TEMP::TLTestSort
    TEMP::TLBrainstormSort
    TEMP::InventoryLibraryYN
    testlearn::date
    testlearn::timestamp
    testlearn::orderInventoryGroupNumber
    testlearn::note
    reference::showInLearn
    tagInventoryLocation::match
    tagKeywordPrimary::orderOrLock
    tagKeywordPrimary::tag
    reference::referenceShort
    reference::publicationYearOrStuffOrderNumber
    reference::_Lreference
    TEMP::layoutLtagR
    TEMP::layoutLtagRFIND

Scripts used in this script

    loadTagRecord

Layouts used in this script

    learnMenu3CiteS
    learnMenuRefStuff
    ReferenceMenu3Cite
    learnMenu3Cite
    <Missing Layout>

Tables used in this script

    TEMP
    reference
    tag
    tag
    testlearn

Table occurrences used by this script

    TEMP
    reference
    tagInventoryLocation
    tagKeywordPrimary
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [menuReference]	Parent Folder: [tagMenu]	Next Script: [menuTestItem]
Script Name	menuTest
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ltagNK1
    ltagNK2
    ltagNK3
    ltagNK4
    ltagNK5
    learnMenu3Cite
    learnMenu3CiteS
    learnMenu4RefCite
    learnMenu4noPicRefCite
    learnMenu4STUFFRefCite
    learnTagWindowNoTags
    learnMenuBrainstorm
    learnTest
    learnSTest

Scripts that use this script

    editLearn
    backToLearnOrDefaultSetup
    findMode

Script Definition
Script Steps

    #
    #Admin tasks.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #Prevent halting of script.
    Set Variable [ $$doNotHaltOtherScripts; Value:1 ]
    #
    #If user is in tag field and has changed spelling
    #exit this tag record, otherwise current reference record
    #will get deleted by the spelling check script.
    Go to Field [ ]
    #
    #Clear brainstorm and test tags.
    If [ $$citationMatch = "brainstorm" ]
    Select Window [ Name: "Learn"; Current file ]
    Go to Field [ ]
    Set Variable [ $$citationItem; Value:testlearn::kNodePrimary ]
    Set Variable [ $$tagBrainstorm ]
    Set Variable [ $$tagtest ]
    Set Field [ TEMP::ktestSubsection; "" ]
    Set Variable [ $$tagRecordID ]
    Set Variable [ $$tagEdit ]
    Select Window [ Name: "Tag Menus"; Current file ]
    End If
    #
    #Clear testlearn records' order numbers.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    New Window [ Height: 1; Width: 1; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “learnSCRIPTloops” (testlearn) ]
    Perform Find [ Specified Find Requests: Find Records; Criteria: testlearn::orderTestInformation: “###” ] [ Restore ]
    Loop
    Set Field [ testlearn::orderTestInformation; "" ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    Close Window [ Current Window ]
    Set Variable [ $$stopLoadTagRecord ]
    Set Variable [ $$doNotHaltOtherScripts ]
    #
    #Conditionally format Tag Menu button.
    Set Variable [ $$citationMatch; Value:"test" ]
    #
    #Turn off the loadtagrecord script to speed up the
    #loop portion of the script.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    #
    #Goto correct layout.
    If [ Left (Get (LayoutName) ; 1) = "l" ]
    Go to Layout [ “learnTest” (testSubsectionTemplate) ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “learnSTest” (testSubsectionTemplate) ]
    End If
    Else If [ Left (Get (LayoutName) ; 1) = "r" ]
    Go to Layout [ “learnTest” (testSubsectionTemplate) ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “learnSTest” (testSubsectionTemplate) ]
    End If
    Else If [ Left (Get (LayoutName) ; 1) = "t" ]
    Go to Layout [ “learnTest” (testSubsectionTemplate) ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “learnSTest” (testSubsectionTemplate) ]
    End If
    End If
    #
    #Find test subsection tags.
    If [ $$testSubsection = "" ]
    Show All Records
    Else
    Enter Find Mode [ ]
    Set Field [ testSubsectionTemplate::_LtestSubsection; $$testSubsection ]
    Perform Find [ ]
    Show Custom Dialog [ Message: "Learn records can ONLY be added and removed from the subsection being edited. To edit ALL subsections' info, 1) click the back buttons until you return to Library Setup. 2) Click Learn, and 3) in the Tag Menus window, click test."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #Sort into groups.
    Sort Records [ Keep records in sorted order; Specified Sort Order: testSubsectionGroup::orderOrLibraryType; based on value list: “order Pulldown List” testSubsectionGroup::name; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” testSubsectionTemplate::order; ascending testSubsectionTemplate::name; ascending ] [ Restore; No dialog ]
    #
    #If user did not just come from the test
    #module, go to current learn record's first
    #listed test or the first test record.
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    #
    If [ $$editTestInfo ≠ 1 ]
    Loop
    Set Variable [ $number; Value:1 ]
    Go to Field [ ]
    Loop
    Exit Loop If [ Middle ( GetValue ( $$test ; $number ) ; 4 ; 42 ) & "¶" = testSubsectionTemplate::_LtestSubsection & ¶ ]
    Exit Loop If [ Middle ( GetValue ( $$test ; $number ) ; 4 ; 42 ) = "" ]
    Set Variable [ $add; Value:$number ]
    Set Variable [ $number; Value:$add + 1 ]
    End Loop
    Exit Loop If [ Middle ( GetValue ( $$test ; $number ) ; 4 ; 42 ) & "¶" = testSubsectionTemplate::_LtestSubsection & ¶ ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    If [ Middle ( GetValue ( $$test ; $number ) ; 4 ; 42 ) & "¶" ≠ testSubsectionTemplate::_LtestSubsection & ¶ ]
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    End If
    #
    #If user just came from test module then loop
    #to the test the user was interested in editing.
    Else
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    Loop
    Exit Loop If [ $$testSubsection = testSubsectionTemplate::_LtestSubsection ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    End If
    #
    #Turn loadtagrecord script back on and perform
    #load-test-tag script to highlight any Learn records
    #tagged with the current tag record.
    Set Variable [ $$stopLoadTagRecord ]
    Perform Script [ “loadTestTags” ]
    #

Fields used in this script

    testlearn::kNodePrimary
    TEMP::ktestSubsection
    testlearn::orderTestInformation
    TEMP::InventoryLibraryYN
    testSubsectionTemplate::_LtestSubsection
    testSubsectionGroup::orderOrLibraryType
    testSubsectionGroup::name
    tagMenus::orderOrLock
    testSubsectionTemplate::order
    testSubsectionTemplate::name

Scripts used in this script

    loadTestTags

Layouts used in this script

    learnSCRIPTloops
    learnTest
    learnSTest

Tables used in this script

    TEMP
    tag
    tagGroup
    testSubsectionTemplate
    testlearn

Table occurrences used by this script

    TEMP
    tagMenus
    testSubsectionGroup
    testSubsectionTemplate
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [menuTest]	Parent Folder: [tagMenu]	Next Script: [menuTestSection]
Script Name	menuTestItem
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    testInfo
    reportTestResult
    reportTestResultLocked
    reportTagItem
    reportTagInfo

Scripts that use this script

    addLinksPicturesToTagsMode
    returnToSetup
    testTemplatesItemButton
    gotoSetupTest_Template
    linkOrUnlinkTestItemGroupToTestItemList
    gotoTestResults

Script Definition
Script Steps

    #
    #
    #If there are no test subsections,
    #then exit this script.
    If [ TEMP::ktestSubsection = "" ]
    Exit Script [ ]
    Show Custom Dialog [ Message: "There are no test subsections."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #
    #Close any open test item reference windows.
    #NOTE: This is next loop is a work around to
    #deal with the Reference window issue.
    #Basically, there are several scripts that may
    #open Reference windows for Info records that
    #have references. Rather than try to figure out all
    #the ways this occurs (easy with time), this loop
    #just closes as many Reference windows as are
    #currently open. Not the best solution, but it
    #works and I really want to close out work on this
    #4.0beta version and move on.
    Loop
    If [ ValueCount ( FilterValues ( WindowNames ( Get ( FileName ) ) ; "Reference" ) ) > 0 ]
    Close Window [ Name: "Reference"; Current file ]
    Set Variable [ $resizeTagMenusWindow; Value:1 ]
    End If
    Exit Loop If [ ValueCount ( FilterValues ( WindowNames ( Get ( FileName ) ) ; "Reference" ) ) = 0 ]
    End Loop
    #
    If [ Left ( Get (LayoutName) ; 5 ) ≠ "setup" ]
    If [ $$pictureWindowColor = "test" ]
    Move/Resize Window [ Name: "Test"; Current file; Width: Get ( ScreenWidth ) / 2; Left: 0 ]
    Move/Resize Window [ Name: "Tag Menus"; Current file; Width: Get ( ScreenWidth ) / 2; Left: Get ( ScreenWidth ) / 2 ]
    Else
    Move/Resize Window [ Name: "Tag Menus"; Current file; Width: Get (ScreenWidth) - 594; Left: 594 ]
    End If
    End If
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    #
    #If there are information records, then set this
    #variable below to inform the user of this fact
    #by highlighting the info button on the
    #Test Menus layout, but only if user is on the
    #testInfo layout.
    If [ Get(LayoutName) = "testInfo" or Get(LayoutName) = "reportTagInfo" ]
    If [ Get (FoundCount) ≠ 0 ]
    Set Variable [ $$thereIsInfoForThisSubsection; Value:1 ]
    Else
    Set Variable [ $$thereIsInfoForThisSubsection ]
    End If
    End If
    #
    #Goto correct layout, and don't load tag
    #record or check spelling.
    Set Variable [ $$stopTest; Value:1 ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    #
    #If in add mode ...
    If [ $$add = 1 ]
    Go to Layout [ “addMenuTestItem” (tagMenus) ]
    #
    #If user has elected to show only the tag ...
    Else If [ TEMP::DetailmoreORLessLayout = "" and Left ( Get ( LayoutName ) ; 5 ) = "setup" ]
    #If subsection is locked stop its test item list
    If [ $$lockedMainSubsectionRecord ≠ "" ]
    Go to Layout [ “setupTestItemLOCKED” (tagMenus) ]
    Else
    Go to Layout [ “setupTestItem” (tagMenus) ]
    End If
    Else If [ TEMP::DetailmoreORLessLayout ≠ "" and Left ( Get ( LayoutName ) ; 5 ) = "setup" ]
    #If subsection is locked stop its test item list
    If [ $$lockedMainSubsectionRecord ≠ "" ]
    Go to Layout [ “setupTestItemLOCKED” (tagMenus) ]
    Else
    Go to Layout [ “setupTestItem” (tagMenus) ]
    End If
    #
    #If user has elected to show some pictures ...
    Else If [ TEMP::DetailmoreORLessLayout = "" and Left ( Get ( LayoutName ) ; 4 ) = "test" ]
    Go to Layout [ “testMenuTestItem” (tagMenus) ]
    Else If [ TEMP::DetailmoreORLessLayout ≠ "" and Left ( Get ( LayoutName ) ; 4 ) = "test" ]
    Go to Layout [ “testMenuTestItem” (tagMenus) ]
    #
    Else If [ Left ( Get (LayoutName) ; 6 ) = "report" ]
    Go to Layout [ “reportTagItem” (tagMenus) ]
    Set Variable [ $reportTestItemComment; Value:1 ]
    #
    End If
    Set Variable [ $$citationMatch; Value:"testItem" ]
    Set Field [ TEMP::mTag; TEMP::ktestSubsection ]
    #
    #Find test items for subsection.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Enter Find Mode [ ]
    Set Field [ tagMenuTestItemGroup::match; TEMP::ktestItemSubsection & ¶ ]
    Perform Find [ ]
    #
    #Don't hide FT items in template setup section.
    If [ Left (Get (LayoutName) ; 5 ) ≠ "setup" ]
    #
    #This variable insures that if the hideFTs button
    #is on, a message informing the user that this
    #specific subsection's test item list has no FT
    #items to show or hide will appear if the user
    #clicks it and, indeed, there are no FT items
    #to show.
    #SO before the loop below goes looking for
    #them, this variable needs to be turned on, just
    #in case for the last list shown, it was turned off
    #because it had FT items.
    # In other words, the message is only
    #turned on if there are no FT's found below, but
    #before it can be turned off, we have to make
    #sure it starts out being on.
    Set Variable [ $$noFT_ItemsFound; Value:1 ]
    #
    #See if there are any FT items.
    Go to Record/Request/Page [ First ]
    Loop
    Go to Field [ ]
    If [ tagMenus::notesOrCopyright = "FT" ]
    #
    #
    #Turn off this variable which tells the library
    #that this list has no FT items to show, because
    #one was just found.
    Set Variable [ $$noFT_ItemsFound ]
    #
    #
    #If user has elected to hide form FT items, then
    #omit the item from the current list.
    If [ TEMP::testHideFormTextItemsFTs = 1 ]
    Omit Record
    #
    #
    #If the user wants to show FT times, then move
    #on to the next item. NOTE: If the user was
    #hidding them, then omiting them would move
    #the script to the next item.
    Else
    Go to Record/Request/Page [ Next; Exit after last ]
    End If
    #
    #
    #If this record is not an FT item, then move on
    #to the next item. NOTE: If this item was an FT
    #item, omitting it would advance the script
    #to the next item.
    Else
    Go to Record/Request/Page [ Next; Exit after last ]
    End If
    End Loop
    End If
    #
    #To insure the 'sort' button will next sort
    #alphabetically when clicked, note that the
    #current sort is by category/group and then
    #sort it by group.
    Set Field [ TEMP::sortTestItem; "cat" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuTestItemGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuTestItemGroup::name; ascending tagMenuTestItemGroup::_Lgroup; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    #
    #Now go the first record and scroll
    #the window to the top.
    Go to Record/Request/Page [ First ]
    Set Variable [ $$stopLoadTagRecord ]
    Scroll Window [ Home ]
    #
    #
    #Ask the user if they would like to see the
    #whole test item when they click on one or not
    #(they just want to go to that tag record).
    If [ $$rememberTestItemChoice ≠ 1 and Get(FoundCount) ≠ 0 ]
    Show Custom Dialog [ Message: "1) Enter and stay in text fields, or 2) exit them, when clicking on one to navigate to a test-item record?"; Default Button: “exit”, Commit: “Yes”; Button 2: “enter”, Commit: “No” ]
    #
    If [ Get (LastMessageChoice) = 1 ]
    Set Variable [ $$showAll ]
    #
    Else If [ Get (LastMessageChoice) = 2 ]
    Set Variable [ $$showAll; Value:1 ]
    End If
    #
    #
    #Ask if user would like their choice to be
    #remembered for this session (until the library
    #is restarted).
    Show Custom Dialog [ Message: "Remember this enter (or exit) decision? If yes, you will not be asked again until you restart the library."; Default Button: “Yes”, Commit: “Yes”; Button 2: “No”, Commit: “No” ]
    #
    If [ Get (LastMessageChoice) = 1 ]
    Set Variable [ $$rememberTestItemChoice; Value:1 ]
    End If
    End If
    #
    #
    #Tell the user if FT items are currently hidden,
    #and then set variable so this message is not
    #shown again, unless this library is restarted.
    #
    #Don't hide FT items in template setup section.
    If [ Left (Get (LayoutName) ; 5 ) ≠ "setup" ]
    If [ TEMP::testHideFormTextItemsFTs = 1 and $$showFTmessageOnlyOnce = "" and $$noFT_ItemsFound = "" ]
    Set Variable [ $$showFTmessageOnlyOnce; Value:1 ]
    Refresh Window
    Show Custom Dialog [ Message: "NOTE: Form items (FT items) are hidden. To show them, click the hideFTs button. This message is shown only once per session. To see it again, restart this library."; Default Button: “OK”, Commit: “Yes” ]
    End If
    End If
    #
    #
    If [ Left ( Get (LayoutName) ; 6 ) ≠ "report" ]
    #Just in case user was in nonTag field on this
    #window when user clicked a menu button on
    #the other window, exit all fields.
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    Go to Field [ ]
    Else If [ Get (LastError) ≠ 112 ]
    #
    #If in add mode, find only records tagged with
    #current $$citationmatch.
    If [ $$add = 1 ]
    #
    #But, give user option to keep the records currently
    #showing in the main window.
    Show Custom Dialog [ Message: "In the main window, show only records with pictures and links added to test item tags, or keep the current records shown?"; Default Button: “keep”, Commit: “Yes”; Button 2: “show”, Commit: “No” ]
    If [ Get ( LastMessageChoice ) = 1 ]
    Refresh Window
    Select Window [ Name: "Tag Menus"; Current file ]
    Exit Script [ ]
    End If
    #
    #find on learn layout ...
    If [ Left (Get (LayoutName) ; 1) = "l" ]
    Enter Find Mode [ ]
    Set Field [ testlearn::filterFind; "testItem" ]
    Perform Find [ ]
    #
    #find on reference layout ...
    Else If [ Left (Get (LayoutName) ; 1) = "r" ]
    Enter Find Mode [ ]
    Set Field [ reference::filterFind; "testItem" ]
    Perform Find [ ]
    End If
    End If
    #
    End If
    Refresh Window
    Select Window [ Name: "Tag Menus"; Current file ]
    End If
    #
    #Now load the tag record and turn on
    #spell check script.
    Set Variable [ $$stopTest ]
    Set Variable [ $$stopLoadTagRecord ]
    Perform Script [ “loadTagRecord” ]
    #
    #If on the Report item layout then tell user
    #that all check items will be treated as text
    #items.
    If [ $reportTestItemComment = 1 and $$showReportItemCommentOnce ≠ 1 ]
    Show Custom Dialog [ Message: "NOTE: All check-list items become useful as highlighted copy/paste 'T' (text) buttons in this Report section. (This message only shows once per session. Restart the library to see it again.)"; Default Button: “OK”, Commit: “Yes” ]
    Set Variable [ $$showReportItemCommentOnce; Value:1 ]
    End If
    #

Fields used in this script

    TEMP::ktestSubsection
    TEMP::DetailmoreORLessLayout
    TEMP::mTag
    TEMP::ktestItemSubsection
    tagMenuTestItemGroup::match
    tagMenus::notesOrCopyright
    TEMP::testHideFormTextItemsFTs
    TEMP::sortTestItem
    tagMenuTestItemGroup::orderOrLibraryType
    tagMenuTestItemGroup::name
    tagMenuTestItemGroup::_Lgroup
    tagMenus::orderOrLock
    tagMenus::tag
    testlearn::filterFind
    reference::filterFind

Scripts used in this script

    loadTagRecord

Layouts used in this script

    addMenuTestItem
    setupTestItemLOCKED
    setupTestItem
    testMenuTestItem
    reportTagItem

Tables used in this script

    TEMP
    tag
    tagGroup
    testlearn

Table occurrences used by this script

    TEMP
    tagMenuTestItemGroup
    tagMenus
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [menuTestItem]	Parent Folder: [tagMenu]	Next Script: [moveTagToNewGroup]
Script Name	menuTestSection
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    testMenuTestItemMORE

Scripts that use this script

    testTemplatesSectionButton
    newSubsection
    newSubsectionGroup

Script Definition
Script Steps

    #
    #Go to the test section layout.
    Go to Layout [ “setupTestSection” (testSection) ]
    #
    #Clear the citation match variable.
    Set Variable [ $$citationMatch ]
    #
    #Find all test sections for this library.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    View As [ View as List ]
    Enter Find Mode [ ]
    Set Field [ testSection::match; "testSection" ]
    Perform Find [ ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testSection::tag; ascending ] [ Restore; No dialog ]
    Go to Record/Request/Page [ First ]
    Perform Script [ “checkTestSectionSubsectionAndItemRecordSpellings” ]
    #

Fields used in this script

    testSection::match
    testSection::tag

Scripts used in this script

    checkTestSectionSubsectionAndItemRecordSpellings

Layouts used in this script

    setupTestSection

Tables used in this script

    tag

Table occurrences used by this script

    testSection

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [menuTestSection]	Parent Folder: [tagMenu]	Next Script: [newTagMenuTag]
Script Name	moveTagToNewGroup
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #Admin tasks.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #
    #A list of all layouts using this script and so
    #requiring testing after changes is located here:
    #https://github.com/HelpGiveThanks/Library/layouts/buttons/move_Layout_List_Scripts.md
    #
    #
    #If user clicked on the group the tag is already
    #in then exit this script.
    If [ tagMenus::kGroupOrTest = $$groupOLD ]
    Go to Field [ ]
    Exit Script [ ]
    End If
    #
    #
    #BEGIN check if tag can be moved.
    #
    #If there is only one group, exit script.
    If [ //Test for keyword and node tag layouts. ValueCount ( ValueListItems ( Get ( FileName ) ; "tagGroup" ) ) = 1 and ( $$citationMatch = "key" or $$citationMatch = "node" ) = 1 or //Test for copyright, publication, and publisher tag layouts. ValueCount ( ValueListItems ( Get ( FileName ) ; "tagGroupNoSectionTagsLikePath" ) ) = 1 ]
    Set Field [ tagMenus::kGroupOrTest; $$groupOLD ]
    Go to Field [ ]
    Exit Script [ ]
    End If
    #
    #Check field contents for changes to keys
    #made by user typing or dragging text into
    #key field. If altered, put back actual key
    #(group's ID#) and exit.
    If [ FilterValues ( ValueListItems ( Get ( FileName ) ; "tagGroup" ) ; tagMenus::kGroupOrTest & ¶ ) ≠ tagMenus::kGroupOrTest & ¶ ]
    Set Field [ tagMenus::kGroupOrTest; $$groupOLD ]
    Go to Field [ ]
    Exit Script [ ]
    End If
    #
    #Get the newly selected tag group's ID number,
    #and then replace it with the tag's old group ID
    #until the script can determine if this tag can
    #indeed be moved, which will be determined
    #next.
    Set Variable [ $newGroup; Value:tagMenus::kGroupOrTest ]
    Set Field [ tagMenus::kGroupOrTest; $$groupOLD ]
    Go to Field [ ]
    #
    #If the test item's tag-group creator node is
    #currenlty locked then stop script, inform user.
    If [ nodeLockTestTagItemGroup::orderOrLock ≠ "" and Get(LayoutName) = "setupTestItem" ]
    Show Custom Dialog [ Message: "This group is locked. To move any of its items, go the node that created it — " & nodeLockTestTagItemGroup::tag & " — in the setup tag window, click 'lock' and enter the password."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    #
    #If a regular tag's creator node is currenlty
    #locked then stop script, inform user.
    Else If [ tagCreatorLock::orderOrLock ≠ "" ]
    Show Custom Dialog [ Message: "This tag is locked. To move any of its items, go the node that created it — " & tagCreatorLock::tag & " — in the setup tag window, click 'lock' and enter the password."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    #
    #If the tag's creator node is unlocked, then
    #replace the old tag-group key with the newly
    #selected one, so the tag will move into it new
    #tag group.
    Else
    Set Field [ tagMenus::kGroupOrTest; $newGroup ]
    End If
    #
    #If this is a system admin locked record, exit script.
    If [ tagMenus::orderOrLock = "lock" ]
    Set Field [ tagMenus::kGroupOrTest; $$groupOLD ]
    Go to Field [ ]
    Show Custom Dialog [ Message: "This copyright is locked by the system admin, and cannot be moved."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #END check if tag can be moved.
    #
    #
    #Stop test record load script to speed up script.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    #
    #Get the newly selected group's ID number.
    Set Variable [ $newGroup; Value:tagMenus::kGroupOrTest ]
    Set Variable [ $$moveItem; Value:tagMenus::_Ltag ]
    Refresh Window
    #
    #Reset the tag's group ID with its old group ID
    #number grabbed by the system in part 1 of
    #this script, just in case the user decides to cancel
    #move and the test needs to stay put.
    Set Field [ tagMenus::kGroupOrTest; $$groupOLD ]
    Sort Records [ ] [ No dialog ]
    Go to Field [ ]
    #
    #Check if this is the last test in the test group.
    // New Window [ Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    New Window [ Height: 1; Width: 1; Top: -10000; Left: -10000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “tableTag” (tagTable) ]
    Enter Find Mode [ ]
    Set Field [ tagTable::kGroupOrTest; $$groupOLD ]
    Perform Find [ ]
    If [ Get (FoundCount) = 1 ]
    Close Window [ Current Window ]
    Set Variable [ $group; Value:$$groupOLD ]
    Set Variable [ $deleteGroup; Value:$$groupOLD ]
    Refresh Window
    #
    #If it is the last item inform user that after the move
    #the old group will be deleted unless the user
    #creates a new item for this group before moving
    #the old item.
    Show Custom Dialog [ Message: "After — " & tagMenus::tag & " — is moved its old group will be deleted. If you want to keep the old group, create a new tag under it before performing this move."; Default Button: “Cancel”, Commit: “Yes”; Button 2: “move”, Commit: “No” ]
    If [ Get ( LastMessageChoice ) = 1 ]
    Set Variable [ $newGroup ]
    Set Variable [ $$moveItem ]
    Refresh Window
    #
    #Turn back on the loadrecord script. The current
    #record's info does not need to be reloaded of course
    #because it is still the current record.
    Set Variable [ $$stopLoadTagRecord ]
    Halt Script
    End If
    #
    #If the user decides to go ahead with the move,
    #first delete the old group.
    New Window [ Height: 1; Width: 1; Top: -10000; Left: -10000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    #
    Go to Layout [ “tableTagGroup” (testSubsectionGroup) ]
    Enter Find Mode [ ]
    Set Field [ testSubsectionGroup::_Lgroup; $$groupOLD ]
    Perform Find [ ]
    Delete Record/Request [ No dialog ]
    #
    End If
    #
    #Close window opened to perform find, and then
    #set group ID of test with the new groups ID number.
    Close Window [ Current Window ]
    Set Field [ tagMenus::kGroupOrTest; $newGroup ]
    Set Variable [ $$groupOLD; Value:$newGroup ]
    Set Variable [ $$moveItem ]
    Set Variable [ $group ]
    Refresh Window
    Go to Field [ ]
    #
    #Scroll to selected record.
    Scroll Window [ Home ]
    If [ $$citationMatch = "testItem" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuTestItemGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuTestItemGroup::name; ascending tagMenuTestItemGroup::_Lgroup; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    Else
    Sort Records [ ] [ No dialog ]
    End If
    #
    #Turn back on the loadrecord script. The current
    #record's info does not need to be reloaded of course
    #because it is still the current record.
    Set Variable [ $$stopLoadTagRecord ]
    #
    Halt Script
    #

Fields used in this script

    tagMenus::kGroupOrTest
    nodeLockTestTagItemGroup::orderOrLock
    nodeLockTestTagItemGroup::tag
    tagCreatorLock::orderOrLock
    tagCreatorLock::tag
    tagMenus::orderOrLock
    tagMenus::_Ltag
    tagTable::kGroupOrTest
    tagMenus::tag
    testSubsectionGroup::_Lgroup
    tagMenuTestItemGroup::orderOrLibraryType
    tagMenuTestItemGroup::name
    tagMenuTestItemGroup::_Lgroup

Scripts used in this script

Layouts used in this script

    tableTag
    tableTagGroup

Tables used in this script

    tag
    tag
    tagGroup
    tagGroup

Table occurrences used by this script

    nodeLockTestTagItemGroup
    tagCreatorLock
    tagMenuTestItemGroup
    tagMenus
    tagTable
    testSubsectionGroup

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [moveTagToNewGroup]	Parent Folder: [tagMenu]	Next Script: [newTagMenuTagGroup]
Script Name	newTagMenuTag
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultCopyright
    defaultNode1
    defaultNode2
    defaultNodeS2
    defaultNode3
    defaultNodeS3
    defaultNodeS4
    defaultNode4
    ReferenceMenu1
    ReferenceMenuCopyright
    ReferenceMenu2keywordOrNode1
    ReferenceMenu2SkeywordOrNode1
    ReferenceMenu2keywordOrNode2
    ReferenceMenu2SkeywordOrNode2
    ReferenceMenu2keywordOrNode3
    ReferenceMenu2SkeywordOrNode3
    ReferenceMenu2keywordOrNode4
    ReferenceMenu2SkeywordOrNode4
    ReferenceMenu2keywordOrNode5
    ReferenceMenu2SkeywordOrNode5
    ltagNK1
    ltagNKs1
    ltagNK2
    ltagNKs2
    ltagNK3
    ltagNKs3
    ltagNK4
    ltagNKs4
    ltagNK5
    ltagNKs5
    learnMenuBrainstorm
    learnMenuStuffBrainstorm

Scripts that use this script

Script Definition
Script Steps

    #
    #Admin tasks.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Go to Field [ ]
    #
    #If the user has not selected a primary node,
    #then prevent this script from creating new
    #records. All records must be created by the
    #primary node.
    If [ tempSetup::kdefaultNodePrimary = "" ]
    Show Custom Dialog [ Message: "Select yourself (the node responsible for creating and editing records) from the nodes listed below, OR create a new node record for yourself."; Default Button: “select”, Commit: “Yes”; Button 2: “create”, Commit: “No” ]
    If [ Get ( LastMessageChoice ) = 1 ]
    Halt Script
    Else
    Set Field [ tempSetup::kdefaultNodePrimary; "self" ]
    End If
    End If
    #
    #
    #If no tags exist, then create a group of tags for
    #this first tag to belong to. All tags must belong
    #to a tag group.
    If [ Get (FoundCount) = 0 ]
    Perform Script [ “newTagMenuTagGroup” ]
    Exit Script [ ]
    End If
    #
    #If node is currenlty locked then stop script,
    #and inform the user.
    If [ tempSetup::kdefaultNodePrimary ≠ "self" ]
    Perform Script [ “stopNewRecordsBeingCreatedByLockedNode” ]
    End If
    #
    #Stop spelling check script.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    #
    #
    #Create new tag.
    New Record/Request
    #
    #
    #In Learn and Setup sections make node tag
    #into a creator node = a node that can create
    #and edit library records.
    If [ $$citationMatch = "node" and Left (Get (LayoutName) ; 1) = "l" or $$citationMatch = "node" and Left (Get (LayoutName) ; 1) = "d" ]
    Set Field [ tagMenus::kRecordCreatorNode; tagMenus::_Ltag ]
    Set Field [ tagMenus::textStyleOrCreatorNodeFlag; 123456789 ]
    #
    #
    #For all other tags, and for Reference Section
    #node tags, assign the default node/author as
    #the tag's creator.
    Else
    Set Field [ tagMenus::kRecordCreatorNode; TEMP::kdefaultNodePrimary ]
    End If
    #
    #
    #Give this new tag the group ID number underwhich
    #it was created.
    Set Field [ tagMenus::kGroupOrTest; GetNthRecord ( tagMenus::kGroupOrTest ; Get (RecordNumber) - 1 ) ]
    #
    #Get group ID for 'move' button script.
    Set Variable [ $$groupOLD; Value:tagMenus::kGroupOrTest ]
    #
    #Capture recordID to conditionally format current record.
    Set Variable [ $$tagRecordID; Value:Get (RecordID) ]
    #
    #
    #Setup as the new primary node.
    If [ tempSetup::kdefaultNodePrimary = "self" or $$createNewPrimary = 1 ]
    Set Field [ TEMP::kdefaultNodePrimary; tagMenus::_Ltag ]
    Set Field [ tagMenus::tag; "LastName, FirstName" ]
    Set Field [ tagMenus::tagSpelling; "LastName, FirstName" ]
    Set Variable [ $$createNewPrimary; Value:1 ]
    Set Field [ tempSetup::kdefaultNodePrimary; "" ]
    Set Field [ tempSetup::DEFAULTNodePrimaryName; "" ]
    Set Field [ tempSetup::kdefaultNodePrimaryCreator; "" ]
    Set Field [ tempSetup::primaryNodesCreatorNodeIsLocked; "" ]
    End If
    #
    #Finish assigning new tag to the current menu item.
    If [ $$citationMatch = "key" ]
    Set Field [ tagMenus::match; "key" ]
    #
    #Leave key name field blank so user can enter
    #a new name into a blank field, but create a
    #tagSpelling unique name should the user
    #leave this field blank, which will then become
    #the record's unique name upon leaving the
    #record, as key and node records cannot be
    #blank records.
    Set Field [ tagMenus::tagSpelling; "keyword " & tagMenus::_Ltag ]
    Go to Field [ tagMenus::tag ]
    Set Variable [ $$stopLoadTagRecord ]
    Exit Script [ ]
    #
    Else If [ $$citationMatch = "node" ]
    Set Field [ tagMenus::match; "node" ]
    #
    #Set default copyright for tag.
    Set Field [ tagMenus::notesOrCopyright; TEMP::kdefaultCopyright ]
    #
    #Leave key name field blank so user can enter
    #a new name into a blank field, but create a
    #tagSpelling unique name should the user
    #leave this field blank, which will then become
    #the record's unique name upon leaving the
    #record, as key and node records cannot be
    #blank records.
    Set Field [ tagMenus::tagSpelling; "node " & tagMenus::_Ltag ]
    #
    Go to Field [ tagMenus::tag ]
    #
    Else If [ $$citationMatch = "brainstorm" ]
    #
    Set Field [ tagMenus::match; "brainstorm" ]
    #
    #Tag is new so it has no learn records tagged with it.
    #So, clear this variable.
    Set Variable [ $$atLeastOneRecord ]
    #
    #Set default copyright for tag.
    Set Field [ tagMenus::notesOrCopyright; TEMP::kdefaultCopyright ]
    #
    #Set the other three variables that would normally
    #be set by the load tag record script.
    Set Variable [ $$tagBrainstorm; Value:tagMenus::_Ltag ]
    Set Field [ TEMP::kcbrainstorm; tagMenus::_Ltag ]
    Set Variable [ $$BrainstormOrTestID; Value:Get (RecordID) ]
    #
    #Refresh conditional formatting in the learn window
    #in case the previous tag did have learn records
    #tagged with it.
    Select Window [ Name: "Learn"; Current file ]
    Refresh Window
    #
    #Sort these learn records in case they where ordered
    #for the previous brainstorm tag.
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::date; descending testlearn::timestamp; descending ] [ Restore; No dialog ]
    #
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    Go to Field [ tagMenus::tag ]
    Set Variable [ $$stopLoadTagRecord ]
    Exit Script [ ]
    #
    Else If [ $$citationMatch ≠ "key" or $$citationMatch ≠ "node" ]
    Set Field [ tagMenus::match; $$citationMatch ]
    #
    #If a path tag, ask user if this path is to a shelf.
    If [ $$citationMatch = "path" ]
    Show Custom Dialog [ Message: "Is this computer path OR a path to a real place (example: living room bookcase)?"; Default Button: “computer”, Commit: “Yes”; Button 2: “real place”, Commit: “No” ]
    If [ Get ( LastMessageChoice ) = 2 ]
    Set Field [ tagMenus::kfileORkTestItemCreatorNode; 1 ]
    End If
    End If
    #
    Go to Field [ tagMenus::tag ]
    End If
    #
    Set Variable [ $$stopLoadTagRecord ]
    #
    #If this is a new copyright tag then open up
    #the edit copyright tag window.
    If [ $$citationMatch = "copyright" ]
    Set Field [ tagMenus::tag; "Copyright Abbreviation — Full copyright name or brief description" ]
    Set Field [ tagMenus::tagSpelling; "Copyright Abbreviation — Full copyright name or brief description" ]
    Set Field [ tagMenus::notesOrCopyright; TextSize ( TextFont ( "[NOTE: Click the 'web' button above to view the most current and complete source of the text below, copied on " & MonthName ( Get ( CurrentDate ) ) & " " & Day ( Get ( CurrentDate ) ) & ", " & Year ( Get ( CurrentDate ) ) & " from https://website.org for your convenience.]" ; "Arial" ) & ¶ ; 16 ) & TextSize ( ¶ & "Description of copyright from the webpage you copied it from (copy and paste it here)." & ¶ & ¶ & "Create a reference record for this copyright that includes the web address." & ¶ & ¶ & "Use the add button to add the reference with the website link to this copyright record and a copyright image, which you may pick from those included in this library." ; 18 ) ]
    Commit Records/Requests [ Skip data entry validation; No dialog ]
    Perform Script [ “reviewCopyright” ]
    Go to Field [ tagMenus::tag ]
    End If
    #
    #Run primary node script if user is creating a
    #new primary node.
    If [ $$createNewPrimary = 1 ]
    Perform Script [ “addORremovePrimaryTag” ]
    Set Variable [ $$createNewPrimary ]
    Go to Field [ tagMenus::tag ] [ Select/perform ]
    End If
    #
    #

Fields used in this script

    tempSetup::kdefaultNodePrimary
    tagMenus::_Ltag
    tagMenus::kRecordCreatorNode
    tagMenus::textStyleOrCreatorNodeFlag
    TEMP::kdefaultNodePrimary
    tagMenus::kGroupOrTest
    tagMenus::tag
    tagMenus::tagSpelling
    tempSetup::DEFAULTNodePrimaryName
    tempSetup::kdefaultNodePrimaryCreator
    tempSetup::primaryNodesCreatorNodeIsLocked
    tagMenus::match
    TEMP::kdefaultCopyright
    tagMenus::notesOrCopyright
    TEMP::kcbrainstorm
    testlearn::date
    testlearn::timestamp
    tagMenus::kfileORkTestItemCreatorNode

Scripts used in this script

    newTagMenuTagGroup
    stopNewRecordsBeingCreatedByLockedNode
    reviewCopyright
    addORremovePrimaryTag

Layouts used in this script

Tables used in this script

    TEMP
    tag
    testlearn

Table occurrences used by this script

    TEMP
    tagMenus
    tempSetup
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [newTagMenuTag]	Parent Folder: [tagMenu]	Next Script: [noCommasAllowed]
Script Name	newTagMenuTagGroup
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultNode1
    defaultNode2
    defaultNodeS2
    defaultNode3
    defaultNodeS3
    defaultNodeS4
    defaultNode4
    ReferenceMenu1
    ReferenceMenu2keywordOrNode1
    ReferenceMenu2SkeywordOrNode1
    ReferenceMenu2keywordOrNode2
    ReferenceMenu2SkeywordOrNode2
    ReferenceMenu2keywordOrNode3
    ReferenceMenu2SkeywordOrNode3
    ReferenceMenu2keywordOrNode4
    ReferenceMenu2SkeywordOrNode4
    ReferenceMenu2keywordOrNode5
    ReferenceMenu2SkeywordOrNode5
    ltagNK1
    ltagNKs1
    ltagNK2
    ltagNKs2
    ltagNK3
    ltagNKs3
    ltagNK4
    ltagNKs4
    ltagNK5
    ltagNKs5
    learnMenuBrainstorm
    learnMenuStuffBrainstorm

Scripts that use this script

    returnToAddRecordPUTONHOLD!!!!
    menuKey
    menuMedium
    menuPath
    menuPublication
    newTagMenuTag
    openDetailWindow !!! FINISH LATER !!!

Script Definition
Script Steps

    #
    #Admin tasks.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    Go to Field [ ]
    #
    #Users need to use existing copyright groups.
    If [ $$citationMatch = "copyright" ]
    Exit Script [ ]
    End If
    #
    #If node is currenlty locked then stop script,
    #and inform the user.
    Perform Script [ “stopNewRecordsBeingCreatedByLockedNode” ]
    #
    #If the user has not selected a primary node,
    #then prevent this script from creating new
    #records. All records must be created by the
    #primary node.
    If [ tempSetup::kdefaultNodePrimary = "" and $$stopAddBack ≠ 1 ]
    #Make sure all creator nodes are showing
    #before asking the user to select one or
    #create one.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Enter Find Mode [ ]
    Set Field [ tagMenus::match; $$citationMatch ]
    Set Field [ tagMenus::textStyleOrCreatorNodeFlag; 123456789 ]
    Perform Find [ ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::tag; ascending ] [ Restore; No dialog ]
    Show Custom Dialog [ Message: "Select yourself (the node responsible for creating and editing records) from the nodes listed below, OR create a new node record for yourself."; Default Button: “select”, Commit: “Yes”; Button 2: “create”, Commit: “No” ]
    If [ Get ( LastMessageChoice ) = 1 ]
    Halt Script
    Else
    Set Field [ tempSetup::kdefaultNodePrimary; "self" ]
    End If
    End If
    #
    #Create new tag group.
    Go to Layout [ “tableTagGroup” (testSubsectionGroup) ]
    New Record/Request
    Set Field [ testSubsectionGroup::kRecordCreatorNode; TEMP::kdefaultNodePrimary ]
    #
    #Note the type of tag this group is for.
    If [ $$citationMatch = "otherkey" or $$citationMatch = "primarykey" ]
    Set Field [ testSubsectionGroup::match; "key" ]
    Else If [ $$citationMatch ≠ "otherkey" ]
    Set Field [ testSubsectionGroup::match; $$citationMatch ]
    End If
    #
    #Set the groups identification fields.
    Set Field [ testSubsectionGroup::name; "group" & testSubsectionGroup::_Lgroup ]
    Set Field [ testSubsectionGroup::nameSpellingEXCEPTForTestItemGroup; "group" & testSubsectionGroup::_Lgroup ]
    Set Variable [ $group; Value:testSubsectionGroup::_Lgroup ]
    #(Further testing required. This group is
    #created by the new library script, so it does
    #not need to be created here.)
    // If [ tempSetup::kdefaultNodePrimary = "self" ]
    // Set Field [ testSubsectionGroup::orderOrLibraryType; "001" ]
    // End If
    #
    #
    #Create new tag for this group so it will show up.
    If [ $$citationMatch = "brainstorm" ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Else
    Set Variable [ $$doNotHaltOtherScripts; Value:1 ]
    End If
    Go to Layout [ original layout ]
    New Record/Request
    #
    #In Learn and Setup sections make node tag
    #into a creator node = a node that can create
    #and edit library records.
    If [ $$citationMatch = "node" and Left (Get (LayoutName) ; 1) = "l" or $$citationMatch = "node" and Left (Get (LayoutName) ; 1) = "d" ]
    Set Field [ tagMenus::kRecordCreatorNode; tagMenus::_Ltag ]
    Set Field [ tagMenus::textStyleOrCreatorNodeFlag; 123456789 ]
    #
    #
    #For all other tags, and for Reference Section
    #node tags, assign the default node/author as
    #the tag's creator.
    Else
    Set Field [ tagMenus::kRecordCreatorNode; TEMP::kdefaultNodePrimary ]
    End If
    #
    #Give this new tag the group ID number underwhich
    #it was created.
    Set Field [ tagMenus::kGroupOrTest; $group ]
    #
    #Setup as the new primary node.
    If [ tempSetup::kdefaultNodePrimary = "self" ]
    Set Field [ TEMP::kdefaultNodePrimary; tagMenus::_Ltag ]
    Set Field [ tagMenus::tag; "LastName, FirstName" ]
    Set Field [ tagMenus::tagSpelling; "LastName, FirstName" ]
    Set Variable [ $$createNewPrimary; Value:1 ]
    Set Field [ tempSetup::kdefaultNodePrimary; "" ]
    Set Field [ tempSetup::DEFAULTNodePrimaryName; "" ]
    Set Field [ tempSetup::kdefaultNodePrimaryCreator; "" ]
    Set Field [ tempSetup::primaryNodesCreatorNodeIsLocked; "" ]
    End If
    #
    #Finish assigning new tag to the current menu item.
    If [ $$citationMatch = "key" ]
    Set Field [ tagMenus::match; "key" ]
    #
    #Leave key name field blank so user can enter
    #a new name into a blank field, but create a
    #tagSpelling unique name should the user
    #leave this field blank, which will then become
    #the record's unique name upon leaving the
    #record, as key and node records cannot be
    #blank records.
    Set Field [ tagMenus::tagSpelling; "keyword " & tagMenus::_Ltag ]
    Else If [ $$citationMatch = "node" ]
    Set Field [ tagMenus::match; "node" ]
    #
    #Set default copyright for tag.
    Set Field [ tagMenus::notesOrCopyright; TEMP::kdefaultCopyright ]
    #
    #Leave key name field blank so user can enter
    #a new name into a blank field, but create a
    #tagSpelling unique name should the user
    #leave this field blank, which will then become
    #the record's unique name upon leaving the
    #record, as key and node records cannot be
    #blank records.
    Set Field [ tagMenus::tagSpelling; "node " & tagMenus::_Ltag ]
    Else If [ $$citationMatch ≠ "key" or $$citationMatch ≠ "node" ]
    Set Field [ tagMenus::match; $$citationMatch ]
    #
    #If a path tag, ask user if this path is to a shelf.
    If [ $$citationMatch = "path" ]
    Show Custom Dialog [ Message: "Is this computer path OR a path to a real place (example: living room bookcase)?"; Default Button: “computer”, Commit: “Yes”; Button 2: “real place”, Commit: “No” ]
    If [ Get ( LastMessageChoice ) = 2 ]
    Set Field [ tagMenus::kfileORkTestItemCreatorNode; 1 ]
    End If
    End If
    #
    End If
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::tag; ascending ] [ Restore; No dialog ]
    If [ $$citationMatch = "brainstorm" ]
    #
    #Set default copyright for tag.
    Set Field [ tagMenus::notesOrCopyright; TEMP::kdefaultCopyright ]
    Perform Script [ “loadBrainstormTags” ]
    Else
    Set Variable [ $$doNotHaltOtherScripts ]
    End If
    #
    #Capture recordID to conditionally format current record.
    Set Variable [ $$tagRecordID; Value:Get (RecordID) ]
    #
    #Get group ID for 'move' button script.
    Set Variable [ $$groupOLD; Value:tagMenus::kGroupOrTest ]
    #
    If [ $$citationMatch = "copyright" ]
    Set Field [ tagMenus::tag; "Copyright Abbreviation — Full copyright name or brief description" ]
    Set Field [ tagMenus::tagSpelling; "Copyright Abbreviation — Full copyright name or brief description" ]
    Set Field [ tagMenus::notesOrCopyright; TextFont ( "[NOTE: Click the 'web' button above to view the most current and complete source of the text excerpts below, copied on " & MonthName ( Get ( CurrentDate ) ) & " " & Day ( Get ( CurrentDate ) ) & ", " & Year ( Get ( CurrentDate ) ) & " from https://website.org for your convenience.]" ; "Arial" ) & ¶ & ¶ & "Description of copyright from the webpage you copied it from (copy and paste it here)." & ¶ & ¶ & "Create a reference record for this copyright that includes the web address." & ¶ & ¶ & "Use the add button to add the reference with the website link to this copyright record and a copyright image, which you may pick from those included in this library." ]
    Commit Records/Requests [ Skip data entry validation; No dialog ]
    Perform Script [ “reviewCopyright” ]
    Go to Field [ tagMenus::tag ] [ Select/perform ]
    End If
    #
    #Run primary node script if user is creating a
    #new primary node.
    If [ $$createNewPrimary = 1 ]
    Perform Script [ “addORremovePrimaryTag” ]
    Set Variable [ $$createNewPrimary ]
    Go to Field [ tagMenus::tag ] [ Select/perform ]
    End If
    #
    #If not already in the field, then go to it now.
    Go to Field [ tagMenus::tag ]
    #

Fields used in this script

    tempSetup::kdefaultNodePrimary
    tagMenus::match
    tagMenus::textStyleOrCreatorNodeFlag
    tagMenuGroup::orderOrLibraryType
    tagMenuGroup::name
    tagMenus::tag
    TEMP::kdefaultNodePrimary
    testSubsectionGroup::kRecordCreatorNode
    testSubsectionGroup::match
    testSubsectionGroup::_Lgroup
    testSubsectionGroup::name
    testSubsectionGroup::nameSpellingEXCEPTForTestItemGroup
    testSubsectionGroup::orderOrLibraryType
    tagMenus::_Ltag
    tagMenus::kRecordCreatorNode
    tagMenus::kGroupOrTest
    tagMenus::tagSpelling
    tempSetup::DEFAULTNodePrimaryName
    tempSetup::kdefaultNodePrimaryCreator
    tempSetup::primaryNodesCreatorNodeIsLocked
    TEMP::kdefaultCopyright
    tagMenus::notesOrCopyright
    tagMenus::kfileORkTestItemCreatorNode

Scripts used in this script

    stopNewRecordsBeingCreatedByLockedNode
    loadBrainstormTags
    reviewCopyright
    addORremovePrimaryTag

Layouts used in this script

    tableTagGroup

Tables used in this script

    TEMP
    tag
    tagGroup
    tagGroup

Table occurrences used by this script

    TEMP
    tagMenuGroup
    tagMenus
    tempSetup
    testSubsectionGroup

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [newTagMenuTagGroup]	Parent Folder: [tagMenu]	Next Script: [returnToSetup]
Script Name	noCommasAllowed
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    If [ Filter ( tagMenus::tag ; "," ) = "," and $$citationMatch = "key" ]
    Set Variable [ $tag; Value:tagMenus::tag ]
    Show Custom Dialog [ Message: "commas prevent system from keeping track of this item"; Default Button: “OK”, Commit: “Yes” ]
    Set Field [ tagMenus::tag; Substitute ( $tag ; "," ; "" ) ]
    Else If [ Filter ( tagMenus::tag ; ";" ) = ";" and $$citationMatch = "node" ]
    Set Variable [ $tag; Value:tagMenus::tag ]
    Show Custom Dialog [ Message: "semicolons prevent system from keeping track of this item"; Default Button: “OK”, Commit: “Yes” ]
    Set Field [ tagMenus::tag; Substitute ( $tag ; ";" ; "" ) ]
    End If
    If [ $$changeSpelling = 1 ]
    Set Variable [ $$changeSpelling; Value:2 ]
    Perform Script [ “checkKeyANDNodeTagNames” ]
    End If

Fields used in this script

    tagMenus::tag

Scripts used in this script

    checkKeyANDNodeTagNames

Layouts used in this script

Tables used in this script

    tag

Table occurrences used by this script

    tagMenus

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [noCommasAllowed]	Parent Folder: [tagMenu]	Next Script: [reviewCopyright]
Script Name	returnToSetup
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    backFromTemplateEditor

Script Definition
Script Steps

    #
    #
    #Return to last library module.
    If [ $$module = "testmenudetail" ]
    #
    #Go to testlearn layout and loop back to record.
    Set Window Title [ Current Window; New Title: "Test" ]
    Go to Layout [ Middle ( TEMP::layoutTmain ; 5 ; 99 ) ]
    #
    #Go to Learn tag menu layout and loop back to record.
    Select Window [ Name: "Tag Menus"; Current file ]
    Go to Layout [ “testMenuTestItem” (tagMenus) ]
    #
    #Reset temp item ID and clear variable holding
    #ID while editing item information.
    Set Field [ TEMP::ktestSubsection; $$itemID ]
    Set Field [ TEMP::ktestItemSubsection; $$detailID ]
    Set Variable [ $$itemID ]
    #
    #Load up all test items for this subsection.
    Perform Script [ “menuTestItem” ]
    #
    Exit Script [ ]
    Else If [ $$module = "reportTagItem" ]
    #
    #Go to testlearn layout and loop back to record.
    Set Window Title [ Current Window; New Title: "Report" ]
    Go to Layout [ “PrintReportEdit” (report) ]
    #
    #Go to Learn tag menu layout and loop back to record.
    Select Window [ Name: "Tag Menus"; Current file ]
    Go to Layout [ “reportTagItem” (tagMenus) ]
    #
    #Reset temp item ID and clear variable holding
    #ID while editing item information.
    Set Field [ TEMP::ktestSubsection; $$itemID ]
    Set Field [ TEMP::ktestItemSubsection; $$detailID ]
    Set Variable [ $$itemID ]
    #
    Perform Script [ “menuTestItem” ]
    #
    Exit Script [ ]
    Else If [ $$module = "defaultSections" ]
    Go to Layout [ “defaultSetup” (librarySetupReferenceMain) ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Go to Layout [ $$module ]
    If [ $$module = "defaultSections" ]
    Perform Script [ “defaultLibraryButton” ]
    End If
    Go to Record/Request/Page [ $$recordNumber ] [ No dialog ]
    Set Variable [ $$recordNumber ]
    #
    Set Field [ TEMP::ktestSubsection; "" ]
    #
    #
    Exit Script [ ]
    End If
    #
    #Go to testlearn layout and loop back to record.
    Set Window Title [ Current Window; New Title: "Test" ]
    #
    #Stop load tag script until the end.
    Set Variable [ $$returnToSetup; Value:1 ]
    #
    #Go to unlocked or locked layout depending
    #lock status of the test subject.
    If [ testSubsectionTestSubjectLock::orderOrLock = "0" ]
    Go to Layout [ "testResultLOCKED" & Right ( TEMP::layoutTmain ; 1) ]
    Else
    Go to Layout [ "testResult" & Right ( TEMP::layoutTmain ; 1) ]
    End If
    #
    #Go to test item tag menu layout and go to
    #record user was on before editing test items.
    Select Window [ Name: "Tag Menus"; Current file ]
    Go to Layout [ “testMenuTestItem” (tagMenus) ]
    #
    #Load up all test items for this subsection.
    Perform Script [ “menuTestItem” ]
    #
    #Turn back on load tag script and go
    #to selected tag.
    Set Variable [ $$returnToSetup ]
    Go to Record/Request/Page [ $$recordNumber ] [ No dialog ]
    Set Variable [ $$recordNumber ]
    #
    Exit Script [ ]

Fields used in this script

    TEMP::layoutTmain
    TEMP::ktestSubsection
    TEMP::ktestItemSubsection
    testSubsectionTestSubjectLock::orderOrLock

Scripts used in this script

    menuTestItem
    defaultLibraryButton

Layouts used in this script

    testMenuTestItem
    PrintReportEdit
    reportTagItem
    defaultSetup
    <Missing Layout>

Tables used in this script

    TEMP
    tag

Table occurrences used by this script

    TEMP
    testSubsectionTestSubjectLock

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [returnToSetup]	Parent Folder: [tagMenu]	Next Script: [reviewPrimaryNodeCopyright]
Script Name	reviewCopyright
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultsAll
    defaultCopyright
    defaultNode1
    defaultNode2
    defaultNodeS2
    defaultNode3
    defaultNodeS3
    defaultNodeS4
    defaultNode4
    ReferenceMenuCopyright
    learn0
    learnStuff0
    learn1
    learnStuff1
    learn2
    learnStuff2
    learn3
    learnStuff3
    learn4
    learnStuff4
    learn5
    learnStuff5
    learn4EDIT
    learn4EDITLocked
    learn4EDITstuff
    learn4EDITstuffLocked
    LearnTextWindow
    LearnTextWindow_iDevice
    LearnTextWindowStuff
    LearnTextWindowStuff_iDevice
    LearnTextWindowLocked
    LearnTextWindowLocked_iDevice
    learnMenuBrainstorm
    setupTestSection
    setupTestSubsection
    setupTestItem
    setupTestItemLOCKED
    testResult0
    testResultLOCKED0
    testResult1
    testResultLOCKED1
    testResult2
    testResultLOCKED2
    testResult3
    testResultLOCKED3
    testResult4
    testResultLOCKED4
    testResult5
    testResultLOCKED5
    PrintReportEdit
    PrintReportLock
    reportTestResult
    reportTestResultLocked

Scripts that use this script

    addLinksPicturesToTagsMode
    newTagMenuTag
    newTagMenuTagGroup

Script Definition
Script Steps

    #
    #
    #Clear all add mode variables just in case user
    #just ran the add pictures and links script.
    Set Variable [ $$tagLayout ]
    Set Variable [ $$returnLayout ]
    Set Variable [ $$returnRecord ]
    Set Variable [ $$returnWindow ]
    Set Variable [ $$userInCopyrightWindow ]
    #
    #Essential to show user a copyright versus test
    #item lock message when this script is triggered
    #informUserHowToEditLockedLayoutText.
    Set Variable [ $$showCopyrightLockMessage; Value:1 ]
    #
    #
    #
    #BEGIN Get copyright key
    #
    #
    #
    #If the copyright tag's creator is a locked node,
    #the creator node's orderOrLock field will have
    #zero — 0 — in it.
    #
    #Capture the copyright's key for finding it
    #in the copyright review window in every
    #section.
    #
    #
    #
    #1) Default Section (A, B, and C) ...
    # and Reference Section ( B ) ...
    # A
    #... tag menus window — alldefaults
    If [ Get (LayoutTableName) = "tempSetup" ]
    #
    #Get copyright's key for finding it below.
    Set Variable [ $copyright; Value:TEMP::kdefaultCopyright ]
    #
    #Now capture locked/unlocked status and
    #who created it from 3 possibilities:
    If [ defaultNodesCopyright::kRecordCreatorNode = "defaultCopyright" ]
    #a) Locked library default copyright, get library version
    #to display as copyright creator.
    Set Field [ TEMP::copyrightCreatorsName; "Library " & tempSetup::versionNumber ]
    #
    Else If [ defaultNodeCopyrightsCreatorLock::orderOrLock ≠ "" ]
    #b) Locked user copyright, get creator's name
    #to display as copyright creator.
    Set Field [ TEMP::copyrightCreatorsName; defaultNodeCopyrightsCreatorLock::tag ]
    #
    Else If [ defaultNodesCopyright::kRecordCreatorNode ≠ "defaultCopyright" and defaultNodeCopyrightsCreatorLock::orderOrLock = "" ]
    #c) Unlocked user copyright, get creator's name
    #to display as copyright creator, and set unlock
    #variable so unlocked review layout is shown.
    Set Field [ TEMP::copyrightCreatorsName; defaultNodeCopyrightsCreatorLock::tag ]
    Set Variable [ $unlocked; Value:1 ]
    End If
    #
    End If
    #
    #
    # B
    #... tag menus window — copyright
    If [ Get (LayoutTableName) = "tagMenus" and $$citationMatch = "copyright" ]
    #
    #Get copyright's key for finding it below.
    Set Variable [ $copyright; Value:tagMenus::_Ltag ]
    #
    #Now capture locked/unlocked status and
    #who created it from 3 possibilities:
    If [ tagMenus::kRecordCreatorNode = "defaultCopyright" ]
    #a) Locked library default copyright, get library version
    #to display as copyright creator.
    Set Field [ TEMP::copyrightCreatorsName; "Library " & tempSetup::versionNumber ]
    #
    Else If [ tagCreatorLock::orderOrLock ≠ "" ]
    #b) Locked user copyright, get creator's name
    #to display as copyright creator.
    Set Field [ TEMP::copyrightCreatorsName; tagCreatorLock::tag ]
    #
    Else If [ tagMenus::kRecordCreatorNode ≠ "defaultCopyright" and tagCreatorLock::orderOrLock = "" ]
    #c) Unlocked user copyright, get creator's name
    #to display as copyright creator, and set unlock
    #variable so unlocked review layout is shown.
    Set Field [ TEMP::copyrightCreatorsName; tagCreatorLock::tag ]
    Set Variable [ $unlocked; Value:1 ]
    End If
    #
    End If
    #
    #
    # C
    #... tag menus window — node
    If [ Get (LayoutTableName) = "tagMenus" and $$citationMatch = "node" ]
    #
    #Get copyright's key for finding it below.
    Set Variable [ $copyright; Value:tagsCopyright::_Ltag ]
    #
    #Now capture locked/unlocked status and
    #who created it from 3 possibilities:
    If [ tagsCopyright::kRecordCreatorNode = "defaultCopyright" ]
    #a) Locked library default copyright, get library version
    #to display as copyright creator.
    Set Field [ TEMP::copyrightCreatorsName; "Library " & tempSetup::versionNumber ]
    #
    Else If [ tagCopyrightsCreatorLock::orderOrLock ≠ "" ]
    #b) Locked user copyright, get creator's name
    #to display as copyright creator.
    Set Field [ TEMP::copyrightCreatorsName; tagCopyrightsCreatorLock::tag ]
    #
    Else If [ tagsCopyright::kRecordCreatorNode ≠ "defaultCopyright" and tagCopyrightsCreatorLock::orderOrLock = "" ]
    #c) Unlocked user copyright, get creator's name
    #to display as copyright creator, and set unlock
    #variable so unlocked review layout is shown.
    Set Field [ TEMP::copyrightCreatorsName; tagCopyrightsCreatorLock::tag ]
    Set Variable [ $unlocked; Value:1 ]
    End If
    #
    End If
    #
    #
    #
    #2) Learn Section (A and B) ...
    # A
    #... main learn window
    If [ Get (LayoutTableName) = "testlearn" and Get (WindowName) = "Learn" or Get (LayoutTableName) = "testlearn" and Get (WindowName) = "Edit" ]
    #
    #Get copyright's key for finding it below.
    Set Variable [ $copyright; Value:learnCreatorsCopyright::_Ltag ]
    #
    #Now capture locked/unlocked status and
    #who created it from 3 possibilities:
    If [ learnCreatorsCopyright::kRecordCreatorNode = "defaultCopyright" ]
    #a) Locked library default copyright, get library version
    #to display as copyright creator.
    Set Field [ TEMP::copyrightCreatorsName; "Library " & tempSetup::versionNumber ]
    #
    Else If [ learnCopyrightCreatorsCopyrightLock::orderOrLock ≠ "" ]
    #b) Locked user copyright, get creator's name
    #to display as copyright creator.
    Set Field [ TEMP::copyrightCreatorsName; learnCopyrightCreatorsCopyrightLock::tag ]
    #
    Else If [ learnCreatorsCopyright::kRecordCreatorNode ≠ "defaultCopyright" and learnCopyrightCreatorsCopyrightLock::orderOrLock = "" ]
    #c) Unlocked user copyright, get creator's name
    #to display as copyright creator, and set unlock
    #variable so unlocked review layout is shown.
    Set Field [ TEMP::copyrightCreatorsName; learnCopyrightCreatorsCopyrightLock::tag ]
    Set Variable [ $unlocked; Value:1 ]
    End If
    #
    End If
    #
    #
    # B
    #... tag menus window — brainstorm
    If [ Get (LayoutTableName) = "tagMenus" and $$citationMatch = "brainstorm" ]
    #
    #Get copyright's key for finding it below.
    Set Variable [ $copyright; Value:tagsCopyright::_Ltag ]
    #
    #Now capture locked/unlocked status and
    #who created it from 3 possibilities:
    If [ tagsCopyright::kRecordCreatorNode = "defaultCopyright" ]
    #a) Locked library default copyright, get library version
    #to display as copyright creator.
    Set Field [ TEMP::copyrightCreatorsName; "Library " & tempSetup::versionNumber ]
    #
    Else If [ tagCopyrightsCreatorLock::orderOrLock ≠ "" ]
    #b) Locked user copyright, get creator's name
    #to display as copyright creator.
    Set Field [ TEMP::copyrightCreatorsName; tagCopyrightsCreatorLock::tag ]
    #
    Else If [ tagsCopyright::kRecordCreatorNode ≠ "defaultCopyright" and tagCopyrightsCreatorLock::orderOrLock = "" ]
    #c) Unlocked user copyright, get creator's name
    #to display as copyright creator, and set unlock
    #variable so unlocked review layout is shown.
    Set Field [ TEMP::copyrightCreatorsName; tagCopyrightsCreatorLock::tag ]
    Set Variable [ $unlocked; Value:1 ]
    End If
    #
    End If
    #
    #
    #
    #3) Setup Test Section (A, B, and C) ...
    # A
    #... main setup window
    If [ Get (LayoutTableName) = "testSubsectionTemplate" ]
    #
    #Get copyright's key for finding it below.
    Set Variable [ $copyright; Value:testSectionCreatorsCopyright::_Ltag ]
    #
    #Now capture locked/unlocked status and
    #who created it from 3 possibilities:
    If [ testSectionCreatorsCopyright::kRecordCreatorNode = "defaultCopyright" ]
    #a) Locked library default copyright, get library version
    #to display as copyright creator.
    Set Field [ TEMP::copyrightCreatorsName; "Library " & tempSetup::versionNumber ]
    #
    Else If [ testSectionCopyrightsCreatorLock::orderOrLock ≠ "" ]
    #b) Locked user copyright, get creator's name
    #to display as copyright creator.
    Set Field [ TEMP::copyrightCreatorsName; testSectionCopyrightsCreatorLock::tag ]
    #
    Else If [ testSectionCreatorsCopyright::kRecordCreatorNode ≠ "defaultCopyright" and testSectionCopyrightsCreatorLock::orderOrLock = "" ]
    #c) Unlocked user copyright, get creator's name
    #to display as copyright creator, and set unlock
    #variable so unlocked review layout is shown.
    Set Field [ TEMP::copyrightCreatorsName; testSectionCopyrightsCreatorLock::tag ]
    Set Variable [ $unlocked; Value:1 ]
    End If
    #
    End If
    #
    #
    # B
    #... tag menus window — section
    If [ Get (LayoutTableName) = "testSection" ]
    #
    #Get copyright's key for finding it below.
    Set Variable [ $copyright; Value:testSectionCreatorsCopyright::_Ltag ]
    #
    #Now capture locked/unlocked status and
    #who created it from 3 possibilities:
    If [ testSectionCreatorsCopyright::kRecordCreatorNode = "defaultCopyright" ]
    #a) Locked library default copyright, get library version
    #to display as copyright creator.
    Set Field [ TEMP::copyrightCreatorsName; "Library " & tempSetup::versionNumber ]
    #
    Else If [ testSectionCopyrightsCreatorLock::orderOrLock ≠ "" ]
    #b) Locked user copyright, get creator's name
    #to display as copyright creator.
    Set Field [ TEMP::copyrightCreatorsName; testSectionCopyrightsCreatorLock::tag ]
    #
    Else If [ testSectionCreatorsCopyright::kRecordCreatorNode ≠ "defaultCopyright" and testSectionCopyrightsCreatorLock::orderOrLock = "" ]
    #c) Unlocked user copyright, get creator's name
    #to display as copyright creator, and set unlock
    #variable so unlocked review layout is shown.
    Set Field [ TEMP::copyrightCreatorsName; testSectionCopyrightsCreatorLock::tag ]
    Set Variable [ $unlocked; Value:1 ]
    End If
    #
    End If
    #
    #
    # C
    #... tag menus window — item
    If [ Get (LayoutTableName) = "tagMenus" and $$citationMatch = "testItem" ]
    #
    #Get copyright's key for finding it below.
    Set Variable [ $copyright; Value:tagCreatorsCopyright::_Ltag ]
    #
    #Now capture locked/unlocked status and
    #who created it from 3 possibilities:
    If [ tagCreatorsCopyright::kRecordCreatorNode = "defaultCopyright" ]
    #a) Locked library default copyright, get library version
    #to display as copyright creator.
    Set Field [ TEMP::copyrightCreatorsName; "Library " & tempSetup::versionNumber ]
    #
    Else If [ tagCreatorsCopyrightsCreatorLock::orderOrLock ≠ "" ]
    #b) Locked user copyright, get creator's name
    #to display as copyright creator.
    Set Field [ TEMP::copyrightCreatorsName; tagCreatorsCopyrightsCreatorLock::tag ]
    #
    Else If [ tagCreatorsCopyright::kRecordCreatorNode ≠ "defaultCopyright" and tagCreatorsCopyrightsCreatorLock::orderOrLock = "" ]
    #c) Unlocked user copyright, get creator's name
    #to display as copyright creator, and set unlock
    #variable so unlocked review layout is shown.
    Set Field [ TEMP::copyrightCreatorsName; tagCreatorsCopyrightsCreatorLock::tag ]
    Set Variable [ $unlocked; Value:1 ]
    End If
    #
    End If
    #
    #
    #
    #4) Test Section ( A ) ...
    # A
    #... main test window
    If [ Get (LayoutTableName) = "testlearn" and Get (WindowName) = "Test" ]
    #
    #Get copyright's key for finding it below.
    Set Variable [ $copyright; Value:learnTestSubjectCopyright::_Ltag ]
    #
    #Now capture locked/unlocked status and
    #who created it from 3 possibilities:
    If [ learnTestSubjectCopyright::kRecordCreatorNode = "defaultCopyright" ]
    #a) Locked library default copyright, get library version
    #to display as copyright creator.
    Set Field [ TEMP::copyrightCreatorsName; "Library " & tempSetup::versionNumber ]
    #
    Else If [ learnTestSubjectCopyrightCreatorsCopyrightLock::orderOrLock ≠ "" ]
    #b) Locked user copyright, get creator's name
    #to display as copyright creator.
    Set Field [ TEMP::copyrightCreatorsName; learnTestSubjectCopyrightCreatorsCopyrightLock::tag ]
    #
    Else If [ learnTestSubjectCopyright::kRecordCreatorNode ≠ "defaultCopyright" and learnTestSubjectCopyrightCreatorsCopyrightLock::orderOrLock = "" ]
    #c) Unlocked user copyright, get creator's name
    #to display as copyright creator, and set unlock
    #variable so unlocked review layout is shown.
    Set Field [ TEMP::copyrightCreatorsName; learnTestSubjectCopyrightCreatorsCopyrightLock::tag ]
    Set Variable [ $unlocked; Value:1 ]
    End If
    #
    End If
    #
    #
    #
    #5) Report Section (A and B) ...
    # A
    #... main report window
    If [ Get (LayoutTableName) = "report" ]
    #
    #Get copyright's key for finding it below.
    Set Variable [ $copyright; Value:reportTestSubjectCopyright::_Ltag ]
    #
    #Now capture locked/unlocked status and
    #who created it from 3 possibilities:
    If [ reportTestSubjectCopyright::kRecordCreatorNode = "defaultCopyright" ]
    #a) Locked library default copyright, get library version
    #to display as copyright creator.
    Set Field [ TEMP::copyrightCreatorsName; "Library " & tempSetup::versionNumber ]
    #
    Else If [ reportTestSubjectCreatorCopyrightLock::orderOrLock ≠ "" ]
    #b) Locked user copyright, get creator's name
    #to display as copyright creator.
    Set Field [ TEMP::copyrightCreatorsName; reportTestSubjectCreatorCopyrightLock::tag ]
    #
    Else If [ reportTestSubjectCopyright::kRecordCreatorNode ≠ "defaultCopyright" and reportTestSubjectCreatorCopyrightLock::orderOrLock = "" ]
    #c) Unlocked user copyright, get creator's name
    #to display as copyright creator, and set unlock
    #variable so unlocked review layout is shown.
    Set Field [ TEMP::copyrightCreatorsName; reportTestSubjectCreatorCopyrightLock::tag ]
    Set Variable [ $unlocked; Value:1 ]
    End If
    #
    End If
    #
    #
    # B
    #... tag menus window — result
    If [ Get (LayoutTableName) = "testlearnReportTags" ]
    #
    #Get copyright's key for finding it below.
    Set Variable [ $copyright; Value:reportResultTestSubjectCopyright::_Ltag ]
    #
    #Now capture locked/unlocked status and
    #who created it from 3 possibilities:
    If [ reportResultTestSubjectCopyright::kRecordCreatorNode = "defaultCopyright" ]
    #a) Locked library default copyright, get library version
    #to display as copyright creator.
    Set Field [ TEMP::copyrightCreatorsName; "Library " & tempSetup::versionNumber ]
    #
    Else If [ reportResultTestSubjectCreatorCopyrightLock::orderOrLock ≠ "" ]
    #b) Locked user copyright, get creator's name
    #to display as copyright creator.
    Set Field [ TEMP::copyrightCreatorsName; reportResultTestSubjectCreatorCopyrightLock::tag ]
    #
    Else If [ reportResultTestSubjectCopyright::kRecordCreatorNode ≠ "defaultCopyright" and reportResultTestSubjectCreatorCopyrightLock::orderOrLock = "" ]
    #c) Unlocked user copyright, get creator's name
    #to display as copyright creator, and set unlock
    #variable so unlocked review layout is shown.
    Set Field [ TEMP::copyrightCreatorsName; reportResultTestSubjectCreatorCopyrightLock::tag ]
    Set Variable [ $unlocked; Value:1 ]
    End If
    #
    End If
    #
    #
    #
    #END Get copyright key
    #
    #
    #
    #
    #
    #
    #BEGIN Find copyright and review it
    #
    #
    #
    #If the user hasn't selected a copyright,
    #then exit the script.
    If [ $copyright = "" ]
    Close Window [ Name: "Copyright"; Current file ]
    Exit Script [ ]
    End If
    #
    #Stop record loading scripts.
    Set Variable [ $$stopTest; Value:1 ]
    Set Variable [ $$stoploadCitation; Value:1 ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    #
    #Closer this window just in case a copy of it
    #is open, and then open a new one.
    Close Window [ Name: "Copyright"; Current file ]
    New Window [ Name: "Copyright"; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    #
    #Show just the copyright of interest in the
    #locked or unlocked window.
    If [ $unlocked = "" ]
    Go to Layout [ “CopyrightVIEW” (tagMenus) ]
    Else
    Go to Layout [ “CopyrightEDIT” (tagMenus) ]
    End If
    Enter Find Mode [ ]
    Set Field [ tagMenus::_Ltag; $copyright ]
    Perform Find [ ]
    #
    #Start record loading scripts.
    Set Variable [ $$stopTest ]
    Set Variable [ $$stoploadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    #
    #If this is a new tag then enter the tag field so
    #user knows where to start entering information
    #for their new tag.
    If [ $unlocked ≠ "" and tagMenus::tag = "" ]
    Go to Field [ tagMenus::tag ]
    End If
    #
    #Prevent the user doing anything else until
    #they leave this window.
    Pause/Resume Script [ Indefinitely ]
    #
    Exit Script [ ]
    #
    #
    #
    #END Find copyright and review it
    #
    #

Fields used in this script

    TEMP::kdefaultCopyright
    defaultNodesCopyright::kRecordCreatorNode
    tempSetup::versionNumber
    TEMP::copyrightCreatorsName
    defaultNodeCopyrightsCreatorLock::orderOrLock
    defaultNodeCopyrightsCreatorLock::tag
    tagMenus::_Ltag
    tagMenus::kRecordCreatorNode
    tagCreatorLock::orderOrLock
    tagCreatorLock::tag
    tagsCopyright::_Ltag
    tagsCopyright::kRecordCreatorNode
    tagCopyrightsCreatorLock::orderOrLock
    tagCopyrightsCreatorLock::tag
    learnCreatorsCopyright::_Ltag
    learnCreatorsCopyright::kRecordCreatorNode
    learnCopyrightCreatorsCopyrightLock::orderOrLock
    learnCopyrightCreatorsCopyrightLock::tag
    testSectionCreatorsCopyright::_Ltag
    testSectionCreatorsCopyright::kRecordCreatorNode
    testSectionCopyrightsCreatorLock::orderOrLock
    testSectionCopyrightsCreatorLock::tag
    tagCreatorsCopyright::_Ltag
    tagCreatorsCopyright::kRecordCreatorNode
    tagCreatorsCopyrightsCreatorLock::orderOrLock
    tagCreatorsCopyrightsCreatorLock::tag
    learnTestSubjectCopyright::_Ltag
    learnTestSubjectCopyright::kRecordCreatorNode
    learnTestSubjectCopyrightCreatorsCopyrightLock::orderOrLock
    learnTestSubjectCopyrightCreatorsCopyrightLock::tag
    reportTestSubjectCopyright::_Ltag
    reportTestSubjectCopyright::kRecordCreatorNode
    reportTestSubjectCreatorCopyrightLock::orderOrLock
    reportTestSubjectCreatorCopyrightLock::tag
    reportResultTestSubjectCopyright::_Ltag
    reportResultTestSubjectCopyright::kRecordCreatorNode
    reportResultTestSubjectCreatorCopyrightLock::orderOrLock
    reportResultTestSubjectCreatorCopyrightLock::tag
    tagMenus::tag

Scripts used in this script

Layouts used in this script

    CopyrightVIEW
    CopyrightEDIT

Tables used in this script

    TEMP
    TEMP
    tag
    tag
    tag

Table occurrences used by this script

    TEMP
    defaultNodeCopyrightsCreatorLock
    defaultNodesCopyright
    learnCopyrightCreatorsCopyrightLock
    learnCreatorsCopyright
    learnTestSubjectCopyright
    learnTestSubjectCopyrightCreatorsCopyrightLock
    reportResultTestSubjectCopyright
    reportResultTestSubjectCreatorCopyrightLock
    reportTestSubjectCopyright
    reportTestSubjectCreatorCopyrightLock
    tagCopyrightsCreatorLock
    tagCreatorLock
    tagCreatorsCopyright
    tagCreatorsCopyrightsCreatorLock
    tagMenus
    tagsCopyright
    tempSetup
    testSectionCopyrightsCreatorLock
    testSectionCreatorsCopyright

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [reviewCopyright]	Parent Folder: [tagMenu]	Next Script: [selectTestSection]
Script Name	reviewPrimaryNodeCopyright
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Might not be in use. Testing required before deleting.
    #
    #
    #Stop record loading scripts.
    Set Variable [ $$stopTest; Value:1 ]
    Set Variable [ $$stoploadCitation; Value:1 ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    #
    #Closer this window just in case a copy of it
    #is open, and then open a new one.
    Close Window [ Name: "Copyright"; Current file ]
    New Window [ Name: "Copyright"; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    #
    #Start record loading scripts.
    Set Variable [ $$stopTest ]
    Set Variable [ $$stoploadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    #
    #Essential to show user a copyright versus test
    #item lock message when this script is triggered
    #informUserHowToEditLockedLayoutText.
    Set Variable [ $$showCopyrightLockMessage; Value:1 ]
    #
    #

Fields used in this script

Scripts used in this script

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [reviewPrimaryNodeCopyright]	Parent Folder: [tagMenu]	Next Script: [selectTestSubject]
Script Name	selectTestSection
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #If user deleted field contents,
    #then exit this script.
    Commit Records/Requests
    If [ TEMP::kdefaultSectionTemplate = "" ]
    Set Field [ TEMP::DEFAULTSectionName; "" ]
    Exit Script [ ]
    End If
    #
    #The pulldown menu action selects the ID number,
    #but not the name. To put the name into the TEMP
    #global field we will need to find it, which is what the
    #rest of the script does.
    Set Variable [ $$stopLoadTestRecord; Value:1 ]
    New Window [ Height: 1; Width: 1; Top: -1000; Left: -1000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Set Variable [ $tag; Value:TEMP::kdefaultSectionTemplate ]
    #
    #Remove highlight telling user
    #to select a section.
    Set Variable [ $$highlightTestSection ]
    #
    Go to Layout [ “tableTag” (tagTable) ]
    Enter Find Mode [ ]
    Set Field [ tagTable::_Ltag; $tag ]
    Perform Find [ ]
    #
    Set Variable [ $name; Value:tagTable::tag ]
    #
    Go to Layout [ original layout ]
    Set Field [ TEMP::DEFAULTSectionName; $name ]
    #
    Close Window [ Current Window ]
    Set Variable [ $$stopLoadTestRecord ]
    #
    Go to Field [ ]
    #

Fields used in this script

    TEMP::kdefaultSectionTemplate
    TEMP::DEFAULTSectionName
    tagTable::_Ltag
    tagTable::tag

Scripts used in this script

Layouts used in this script

    tableTag

Tables used in this script

    TEMP
    tag

Table occurrences used by this script

    TEMP
    tagTable

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [selectTestSection]	Parent Folder: [tagMenu]	Next Script: [showCited]
Script Name	selectTestSubject
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultNode1
    defaultNode2
    defaultNodeS2
    defaultNode3
    defaultNodeS3
    defaultNodeS4
    defaultNode4

Scripts that use this script

Script Definition
Script Steps

    #
    #Get selected node's key.
    Set Variable [ $tag; Value:tagMenus::_Ltag ]
    Set Variable [ $TSname; Value:tagMenus::tag ]
    #
    #Leave field so user can see
    #conditional formatting.
    Go to Field [ ]
    #
    #Conditionally format selected node.
    Set Variable [ $$testSubject; Value:tagMenus::_Ltag ]
    #
    #If node is the selected test subject,
    #then unselect it.
    If [ tempSetup::kdefaultNodeTestSubject = $tag ]
    Set Field [ tempSetup::kdefaultNodeTestSubject; "" ]
    Set Field [ tempSetup::DEFAULTNodeTestSubjectName; "" ]
    Set Field [ tempSetup::testSubjectNodeIsLocked; "" ]
    #
    #Finish removing the key.
    Set Variable [ $$testSubject ]
    #
    #If the selected node is not the selected test
    #subject, then select it.
    Else If [ tempSetup::kdefaultNodeTestSubject ≠ $tag ]
    Set Field [ tempSetup::kdefaultNodeTestSubject; $tag ]
    Set Variable [ $$testSubject; Value:tempSetup::kdefaultNodeTestSubject ]
    Set Field [ tempSetup::DEFAULTNodeTestSubjectName; $TSname ]
    If [ tagMenus::orderOrLock ≠ "" ]
    Set Field [ tempSetup::testSubjectNodeIsLocked; 1 ]
    Else
    Set Field [ tempSetup::testSubjectNodeIsLocked; "" ]
    End If
    #
    #Record must be committed if user decides to
    #perform a script on it right after this one or
    #perform a find requiring the newly added key.
    Commit Records/Requests
    #
    #Select the default copyright for this node if blank.
    If [ tagMenus::notesOrCopyright = "" ]
    Set Field [ tagMenus::notesOrCopyright; TEMP::kdefaultCopyright ]
    Show Custom Dialog [ Message: "Because this node's copyright was blank it was given the library's default copyright."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    Refresh Window
    Exit Script [ ]
    End If
    #
    #Apply conditional formatting.
    Refresh Window
    #

Fields used in this script

    tagMenus::_Ltag
    tagMenus::tag
    tempSetup::kdefaultNodeTestSubject
    tempSetup::DEFAULTNodeTestSubjectName
    tempSetup::testSubjectNodeIsLocked
    tagMenus::orderOrLock
    tagMenus::notesOrCopyright
    TEMP::kdefaultCopyright

Scripts used in this script

Layouts used in this script

Tables used in this script

    TEMP
    TEMP
    tag

Table occurrences used by this script

    TEMP
    tagMenus
    tempSetup

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [selectTestSubject]	Parent Folder: [tagMenu]	Next Script: [sortButtonLearnLayouts]
Script Name	showCited
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #If user is not in add mode then inform user they
    #must be before the database will show them reference
    #data. The reason for this is because the layout
    #in the reference or learn window changes to the
    #add tag from these windows to the Tag Menu
    #item selected. So instead of having the system
    #automatically go into add mode, the user must
    #decide they want to do this and thus be expecting
    #a change in the layouts. Otherwise this change
    #could confuse a user. So at the cost of minor
    #inconvience I have chosen not to have the system
    #guess the user wants to go into add mode and is
    #expecting the system to do that when they click
    #one of these numbered buttons on the showEvenMore
    #layouts.
    #
    #
    Select Window [ Name: "References"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Learn"; Current file ]
    End If
    Set Window Title [ Current Window; New Title: "References" ]
    Go to Layout [ $$citeLayout ]
    #
    #Prevent record loading script during loops to
    #find wanted record, which would slow down system.
    Set Variable [ $$stoploadCitation; Value:1 ]
    #
    #Now loop thru all the records until the record
    #that fits the key is found.
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ reference::_Lreference = $$cited ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Allow the record load script to run and run it.
    Set Variable [ $$stoploadCitation ]
    Perform Script [ “loadLearnOrRefMainRecord” ]
    #
    #Reselect record in Tag Menus window and conditionally
    #format any items that may be linked to record
    #in the other window.
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window

Fields used in this script

    reference::_Lreference

Scripts used in this script

    loadLearnOrRefMainRecord

Layouts used in this script

Tables used in this script

    reference

Table occurrences used by this script

    reference

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [showCited]	Parent Folder: [tagMenu]	Next Script: [sortOrderNumberPulldownLearnLayouts]
Script Name	sortButtonLearnLayouts
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    learn0
    learnStuff0
    learn1
    learnStuff1
    learn2
    learnStuff2
    learn3
    learnStuff3
    learn4
    learnStuff4
    learn5
    learnStuff5
    testInfo
    reportTestResult
    reportTestResultLocked
    reportTagInfo

Scripts that use this script

Script Definition
Script Steps

    #
    #Perform script for brainstorm and test tags only.
    If [ $$citationMatch = "brainstorm" and $$findMode = "" or $$citationmatch = "test" and $$findMode = "" or $$citationmatch = "testResult" and $$findMode = "" or Right ( Get (LayoutName) ; 4 ) = "Info" ]
    #
    #If current sort is by date, then sort records by
    #order number.
    If [ TEMP::TLTestSort = "" and $$citationMatch = "test" or TEMP::TLTestSort = "" and $$citationMatch = "testResult" or TEMP::TLTestSort = "" and Right ( Get (LayoutName) ; 4 ) = "Info" ]
    #
    #Sort button script uses 1 to tell
    #it to perform the next sort by date instead of
    #by order number which is the default sort.
    Set Field [ TEMP::TLTestSort; 1 ]
    If [ Right ( Get (LayoutName) ; 4 ) = "info" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearnReportTags::orderTestInformation; based on value list: “testPulldownListANDsortOrderList” testlearnReportTags::timestamp; descending ] [ Restore; No dialog ]
    Exit Script [ ]
    Else If [ $$citationMatch = "testResult" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearnReportTags::orderTestResult; based on value list: “testPulldownListANDsortOrderList” testlearnReportTags::timestamp; descending ] [ Restore; No dialog ]
    Exit Script [ ]
    End If
    Perform Script [ “sortTestOrBrainstormTaggedLearnRecords” ]
    Exit Script [ ]
    Else If [ TEMP::TLBrainstormSort = "" and $$citationMatch = "brainstorm" ]
    Set Field [ TEMP::TLBrainstormSort; 1 ]
    Perform Script [ “sortTestOrBrainstormTaggedLearnRecords” ]
    Exit Script [ ]
    End If
    Set Field [ TEMP::TLTestSort; "" ]
    #
    #Sort the records by date field, if current sort is
    #by order number.
    If [ Right ( Get (LayoutName) ; 4 ) = "info" or $$citationMatch = "brainstorm" or $$citationMatch = "test" or $$citationMatch = "testResult" ]
    #
    #Sort the records by order field.
    If [ Get (LayoutTableName ) = "testLearnReportTags" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearnReportTags::date; descending testlearnReportTags::timestamp; descending ] [ Restore; No dialog ]
    Else
    If [ TEMP::InventoryLibraryYN = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::date; descending testlearn::timestamp; descending ] [ Restore; No dialog ]
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::orderInventoryGroupNumber; based on value list: “testPulldownListANDsortOrderList” testlearn::note; ascending ] [ Restore; No dialog ]
    End If
    End If
    End If
    #
    #Set the sort preference field to date.
    If [ $$citationMatch = "brainstorm" ]
    Set Field [ TEMP::TLBrainstormSort; "" ]
    Else If [ $$citationMatch = "test" or $$citationMatch = "testResult" ]
    Set Field [ TEMP::TLTestSort; "" ]
    End If
    #
    End If

Fields used in this script

    TEMP::TLTestSort
    testlearnReportTags::orderTestInformation
    testlearnReportTags::timestamp
    testlearnReportTags::orderTestResult
    TEMP::TLBrainstormSort
    testlearnReportTags::date
    TEMP::InventoryLibraryYN
    testlearn::date
    testlearn::timestamp
    testlearn::orderInventoryGroupNumber
    testlearn::note

Scripts used in this script

    sortTestOrBrainstormTaggedLearnRecords

Layouts used in this script

Tables used in this script

    TEMP
    testlearn

Table occurrences used by this script

    TEMP
    testlearn
    testlearnReportTags

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [sortButtonLearnLayouts]	Parent Folder: [tagMenu]	Next Script: [sortTags]
Script Name	sortOrderNumberPulldownLearnLayouts
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #Exit order number field.
    Go to Field [ ]
    #
    #If in find mode, exit this script.
    If [ $$findMode = 1 ]
    Exit Script [ ]
    End If
    #
    #If in find mode, exit this script.
    If [ $$orderNumbersNotAllowed = 1 ]
    Show Custom Dialog [ Message: "Sorry, order numbers are allowed only when brainstorm and test tags are selected in the Tag Menus window. When time permits this pulldown will be made inaccessable when you cannot use it, for now it is just hidden."; Default Button: “OK”, Commit: “Yes” ]
    Set Variable [ $$orderNumbersNotAllowed ]
    Exit Script [ ]
    End If
    #
    #Decided to allow user to sort by numbers, but
    #because a number header adds too much
    #distraction, the inventory views do not show it.
    // If [ TEMP::InventoryLibraryYN ≠ "" ]
    // Show Custom Dialog [ Message: "Inventory records are organized by location, and then alphabetically."; Default Button: “OK”, Commit: “Yes” ]
    // Exit Script [ ]
    // End If
    #
    #Get order number user has selected.
    If [ Right ( Get (LayoutName) ; 4 ) = "info" ]
    Set Variable [ $order; Value:testlearnReportTags::orderTestInformation ]
    Else
    Set Variable [ $order; Value:testlearn::orderTestInformation ]
    End If
    #
    #If record is not part of a brainstorm or test exit script.
    If [ $$citationMatch = "brainstorm" and testlearn::kcbrainstorm = "" ]
    Set Field [ testlearn::orderTestInformation; "" ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Show Custom Dialog [ Message: "You can apply an order number to this record when you make it part of the selected brainstorm in the Tag Menus window."; Default Button: “OK”, Commit: “Yes” ]
    Else
    Show Custom Dialog [ Message: "You can apply an order number to this record when you make it part of the selected inventory list in the Tag Menus window."; Default Button: “OK”, Commit: “Yes” ]
    End If
    Exit Script [ ]
    Else If [ $$citationMatch = "test" and testlearn::kctestSubsectionInfo = "" and Right ( Get (LayoutName) ; 4 ) ≠ "info" ]
    Set Field [ testlearn::orderTestInformation; "" ]
    Show Custom Dialog [ Message: "You can apply an order number to this record when you make it part of a test by clicking any square button in the Tag Menus window next to a test tag."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #The order number is the left three digits of a
    #brainstorm or test record lock number. ( Remember
    #each record in the database has lock number or
    #ID number. To open the lock and see any record's
    #contents requires a key number that fits the lock.
    #So if a lock number is 123, then the key that will
    #fit this lock is 123 too. ) Because the brainstorm
    #and test key fields (think of key chains) may
    #have several keys, because any one learn record
    #may be part of more than one brainstorm or test.
    #the system must check each learn record's keys
    #one at a time to see if any fit the current brainstorm
    #or test's lock. So beginning with number one
    #the system checks each key. The left most 3 numbers
    #are order numbers so below you will note that
    #they system starts the check on the 4th number
    #from the left.
    # Once the key whose order number has
    #been changed, the old order number is
    #replaced with the new one.
    Set Variable [ $number; Value:1 ]
    If [ $$citationMatch = "brainstorm" ]
    Loop
    If [ Middle ( GetValue ( testlearn::kcbrainstorm ; $number ) ; 4 ; 42 ) & "¶" = $$tagBrainstorm & ¶ ]
    Set Variable [ $replacementValue; Value:Replace ( GetValue ( testlearn::kcbrainstorm ; $number ) ; 1 ; 3 ; $order ) ]
    #
    #When and if a key is found that fits the current
    #brainstorm or test record's lock, the order number
    #the user has selected overwrites the left most
    #3 digits which by default are 999.
    Set Field [ testlearn::kcbrainstorm; Substitute ( $$brainstorm ; GetValue ( testlearn::kcbrainstorm ; $number ) & "¶" ; $replacementValue & ¶) ]
    #
    #The 'brainstorm' variable is resset to reflect this change
    Set Variable [ $$brainstorm; Value:testlearn::kcbrainstorm ]
    Set Variable [ $$citationItem ]
    #
    #The 'number' variable is made blank to trigger
    #the exit from this loop, the key having been found.
    Set Variable [ $number ]
    End If
    Exit Loop If [ $number = "" ]
    #
    #Exit the script if the current record is not part
    #of the selected brainstorm or test after checking
    #all of its keys.
    If [ GetValue ( testlearn::kcbrainstorm ; $number ) = "" ]
    Set Field [ testlearn::orderTestInformation; "" ]
    Show Custom Dialog [ Message: "You can apply an order number to this record when you make it part of the selected brainstorm by clicking the square button in the Tag Menus window next to it."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #Add 1 to the 'number' varaible after each key
    #in the key field is checked, to direct the system
    #to check the next key.
    Set Variable [ $add; Value:$number ]
    Set Variable [ $number; Value:$add + 1 ]
    End Loop
    #
    Else If [ $$citationMatch = "test" ]
    If [ Right ( Get (LayoutName) ; 4 ) = "info" ]
    Loop
    If [ Middle ( GetValue ( testlearnReportTags::kctestSubsectionInfo ; $number ) ; 4 ; 42 ) & "¶" = $$testSubsection & ¶ ]
    Set Variable [ $replacementValue; Value:Replace ( GetValue ( testlearnReportTags::kctestSubsectionInfo ; $number ) ; 1 ; 3 ; $order ) ]
    #
    #When and if a key is found that fits the current
    #brainstorm or test record's lock, the order number
    #the user has selected overwrites the left most
    #3 digits which by default are 999.
    Set Field [ testlearnReportTags::kctestSubsectionInfo; Substitute ( $$test ; GetValue ( testlearnReportTags::kctestSubsectionInfo ; $number ) & "¶" ; $replacementValue & ¶) ]
    #
    #The 'test' variable is reset to reflect this change
    Set Variable [ $$test; Value:testlearnReportTags::kctestSubsectionInfo ]
    Set Variable [ $$citationItem ]
    #
    #The 'number' variable is made blank to trigger
    #the exit from this loop, the key having been found.
    Set Variable [ $number ]
    End If
    Exit Loop If [ $number = "" ]
    #
    #Add 1 to the 'number' varaible after each key
    #in the key field is checked, to direct the system
    #to check the next key.
    Set Variable [ $add; Value:$number ]
    Set Variable [ $number; Value:$add + 1 ]
    End Loop
    Else
    Loop
    If [ Middle ( GetValue ( testlearn::kctestSubsectionInfo ; $number ) ; 4 ; 42 ) & "¶" = $$tagtest & ¶ ]
    Set Variable [ $replacementValue; Value:Replace ( GetValue ( testlearn::kctestSubsectionInfo ; $number ) ; 1 ; 3 ; $order ) ]
    #
    #When and if a key is found that fits the current
    #brainstorm or test record's lock, the order number
    #the user has selected overwrites the left most
    #3 digits which by default are 999.
    Set Field [ testlearn::kctestSubsectionInfo; Substitute ( $$test ; GetValue ( testlearn::kctestSubsectionInfo ; $number ) & "¶" ; $replacementValue & ¶) ]
    #
    #The 'test' variable is resset to reflect this change
    Set Variable [ $$test; Value:testlearn::kctestSubsectionInfo ]
    Set Variable [ $$citationItem ]
    #
    #The 'number' variable is made blank to trigger
    #the exit from this loop, the key having been found.
    Set Variable [ $number ]
    End If
    Exit Loop If [ $number = "" ]
    #
    #Exit the script if the current record is not part
    #of the selected brainstorm or test after checking
    #all of its keys.
    If [ GetValue ( testlearn::kctestSubsectionInfo ; $number ) = "" ]
    Set Field [ testlearn::orderTestInformation; "" ]
    Show Custom Dialog [ Message: "You can apply an order number to this record when you make it part of the selected test by clicking the square button in the Tag Menus window next to it."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #Add 1 to the 'number' varaible after each key
    #in the key field is checked, to direct the system
    #to check the next key.
    Set Variable [ $add; Value:$number ]
    Set Variable [ $number; Value:$add + 1 ]
    End Loop
    End If
    End If
    #
    #Sort the records by order field.
    If [ Right ( Get (LayoutName) ; 4 ) = "info" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearnReportTags::orderTestInformation; based on value list: “testPulldownListANDsortOrderList” testlearnReportTags::timestamp; descending ] [ Restore; No dialog ]
    Else
    If [ TEMP::InventoryLibraryYN = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::orderInventoryList; based on value list: “testPulldownListANDsortOrderList” testlearn::orderTestInformation; based on value list: “testPulldownListANDsortOrderList” testlearn::timestamp; descending ] [ Restore; No dialog ]
    #
    #User might have been looking at records
    #sorted by date. Now that they are being
    #sorted by number, inform the library that this
    #is the new view so that when the user clicks
    #the sort button again it will switch to the date
    #sort view, instead of remaining on the number
    #sort view (which is already on).
    Set Field [ TEMP::TLBrainstormSort; 1 ]
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::orderInventoryList; based on value list: “testPulldownListANDsortOrderList” testlearn::orderInventoryGroupNumber; ascending testlearn::orderTestInformation; based on value list: “testPulldownListANDsortOrderList” testlearn::note; ascending ] [ Restore; No dialog ]
    End If
    End If
    #
    #
    #Stop TgotoCitationMenu script.
    Set Variable [ $$stopTgotoCitationMenu; Value:1 ]
    #

Fields used in this script

    TEMP::InventoryLibraryYN
    testlearnReportTags::orderTestInformation
    testlearn::orderTestInformation
    testlearn::kcbrainstorm
    testlearn::kctestSubsectionInfo
    testlearnReportTags::kctestSubsectionInfo
    testlearnReportTags::timestamp
    testlearn::orderInventoryList
    testlearn::timestamp
    TEMP::TLBrainstormSort
    testlearn::orderInventoryGroupNumber
    testlearn::note

Scripts used in this script

Layouts used in this script

Tables used in this script

    TEMP
    testlearn

Table occurrences used by this script

    TEMP
    testlearn
    testlearnReportTags

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [sortOrderNumberPulldownLearnLayouts]	Parent Folder: [tagMenu]	Next Script: [sortTestOrBrainstormTaggedLearnRecords]
Script Name	sortTags
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultNode1
    defaultNode2
    defaultNodeS2
    defaultNode3
    defaultNodeS3
    defaultNodeS4
    defaultNode4
    ReferenceMenu1
    ReferenceMenuCopyright
    ReferenceMenu3Cite
    ReferenceMenu3CiteNoPicture
    ReferenceMenu2keywordOrNode1
    ReferenceMenu2SkeywordOrNode1
    ReferenceMenu2keywordOrNode2
    ReferenceMenu2SkeywordOrNode2
    ReferenceMenu2keywordOrNode3
    ReferenceMenu2SkeywordOrNode3
    ReferenceMenu2keywordOrNode4
    ReferenceMenu2SkeywordOrNode4
    ReferenceMenu2keywordOrNode5
    ReferenceMenu2SkeywordOrNode5
    ReferenceMenuFind
    ReferenceMenu3CiteFind
    ReferenceMenu3CiteFindS
    ReferenceMenu2keywordOrNodeFind
    ReferenceMenu2SkeywordOrNodeFind
    referenceSFINDNK
    ltagNK1
    ltagNKs1
    ltagNK2
    ltagNKs2
    ltagNK3
    ltagNKs3
    ltagNK4
    ltagNKs4
    ltagNK5
    ltagNKs5
    learnMenu3Cite
    learnMenu3CiteS
    learnMenu3CitePickAReference
    learnMenuRefStuff
    learnMenuBrainstorm
    learnMenuStuffBrainstorm
    learnTest
    learnSTest
    learnFind
    learnSFind
    learnKeywordOrNodeFind
    learnKeywordOrNodeSFind
    learnFindTest
    learnFindSTest
    learnFindBrainstorm
    learnFindStuffBrainstorm
    learnFindCite
    learnFindCiteS
    learnFindStuffCite
    setupTestItem
    setupTestItemLOCKED
    testMenuTestItemEdit
    testMenuTestItem
    reportTagItem

Scripts that use this script

    learnInsertReferenceIntoNote

Script Definition
Script Steps

    #
    #Sort Insert Reference window references.
    If [ Get (WindowName) = "Insert Reference" ]
    If [ TEMP::sortInsertRef = "cat" or TEMP::sortInsertRef = "" ]
    Set Field [ TEMP::sortInsertRef; "abc" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: reference::referenceShort; ascending ] [ Restore; No dialog ]
    Else If [ TEMP::sortInsertRef = "abc" ]
    Set Field [ TEMP::sortInsertRef; "cat" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagKeywordPrimary::orderOrLock; based on value list: “order Pulldown List” tagKeywordPrimary::tag; ascending reference::referenceShort; ascending ] [ Restore; No dialog ]
    End If
    Exit Script [ ]
    End If
    #
    #Sort records and save sort state for future visits.
    If [ $$citationMatch = "key" and TEMP::sortKey = "abc" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    Set Field [ TEMP::sortKey; "cat" ]
    Exit Script [ ]
    #
    Else If [ $$citationMatch = "node" and TEMP::sortNode = "abc" ]
    Set Field [ TEMP::sortNode; "cat" ]
    #Disabled this sort because the order lock puts the
    #creator node when lock is active at bottom of list
    #in alpha order within category list.
    // Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::tag; ascending ] [ Restore; No dialog ]
    Exit Script [ ]
    #
    Else If [ $$citationMatch = "medium" and TEMP::sortMedium = "abc" ]
    Set Field [ TEMP::sortMedium; "cat" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    Exit Script [ ]
    #
    Else If [ $$citationMatch = "publisher" and TEMP::sortPublisher = "abc" ]
    Set Field [ TEMP::sortPublisher; "cat" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    Exit Script [ ]
    #
    Else If [ $$citationMatch = "path" and TEMP::sortPath = "abc" ]
    Set Field [ TEMP::sortPath; "cat" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    Exit Script [ ]
    #
    Else If [ $$citationMatch = "copyright" and TEMP::sortCopyright = "abc" ]
    Set Field [ TEMP::sortCopyright; "cat" ]
    #
    #Sort to group, textstyle, and then tag,
    #so that the 3.0 ND tag comes before the
    #4.0 ND tag as it does for all the other Creative
    #Commons tags.
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::name; ascending tagMenus::textStyleOrCreatorNodeFlag; ascending tagMenus::tag; ascending ] [ Restore; No dialog ]
    Exit Script [ ]
    #
    Else If [ $$citationMatch = "publication" and TEMP::sortPublication = "abc" ]
    Set Field [ TEMP::sortPublication; "cat" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    Exit Script [ ]
    #
    Else If [ $$citationMatch = "brainstorm" and TEMP::sortBrainstorm = "abc" ]
    Set Field [ TEMP::sortBrainstorm; "cat" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    Exit Script [ ]
    #
    Else If [ $$citationMatch = "testSection" and TEMP::sortTestSection = "abc" ]
    Set Field [ TEMP::sortTestSection; "cat" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    Exit Script [ ]
    #
    Else If [ $$citationMatch = "testSubsection" and TEMP::sortTestSubsection = "abc" or Left ( Get ( LayoutName ) ; 4 ) = "test" and TEMP::sortTestSubsection = "abc" ]
    Set Field [ TEMP::sortTestSubsection; "cat" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testSubsectionGroup::orderOrLibraryType; based on value list: “order Pulldown List” testSubsectionGroup::name; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” testSubsectionTemplate::order; ascending testSubsectionTemplate::name; ascending ] [ Restore; No dialog ]
    Exit Script [ ]
    #
    Else If [ $$citationMatch = "cite" and TEMP::sortCite = "abc" ]
    Set Field [ TEMP::sortCite; "cat" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagKeywordPrimary::orderOrLock; ascending tagKeywordPrimary::tag; ascending reference::referenceShort; ascending ] [ Restore; No dialog ]
    Exit Script [ ]
    #
    Else If [ $$citationMatch = "ref" and TEMP::sortRef = "abc" ]
    Set Field [ TEMP::sortRef; "cat" ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagKeywordPrimary::orderOrLock; based on value list: “order Pulldown List” tagKeywordPrimary::tag; ascending reference::referenceShort; ascending ] [ Restore; No dialog ]
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagKeywordPrimary::orderOrLock; based on value list: “order Pulldown List” tagKeywordPrimary::tag; ascending reference::publicationYearOrStuffOrderNumber; based on value list: “order Pulldown List” reference::Title; ascending ] [ Restore; No dialog ]
    End If
    Exit Script [ ]
    #
    Else If [ $$citationMatch = "testItem" and TEMP::sortTestItem = "abc" ]
    Set Field [ TEMP::sortTestItem; "cat" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuTestItemGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuTestItemGroup::name; ascending tagMenuTestItemGroup::_Lgroup; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    Exit Script [ ]
    End If
    #
    #
    #
    #Sort records and save sort state for future visits.
    If [ $$citationMatch = "key" ]
    Set Field [ TEMP::sortKey; "abc" ]
    #
    Else If [ $$citationMatch = "node" ]
    Set Field [ TEMP::sortNode; "abc" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenus::tag; ascending ] [ Restore; No dialog ]
    Exit Script [ ]
    #
    Else If [ $$citationMatch = "medium" ]
    Set Field [ TEMP::sortMedium; "abc" ]
    #
    Else If [ $$citationMatch = "publisher" ]
    Set Field [ TEMP::sortPublisher; "abc" ]
    #
    Else If [ $$citationMatch = "path" ]
    Set Field [ TEMP::sortPath; "abc" ]
    #
    Else If [ $$citationMatch = "copyright" ]
    Set Field [ TEMP::sortCopyright; "abc" ]
    #
    Else If [ $$citationMatch = "publication" ]
    Set Field [ TEMP::sortPublication; "abc" ]
    #
    Else If [ $$citationMatch = "brainstorm" ]
    Set Field [ TEMP::sortBrainstorm; "abc" ]
    #
    Else If [ $$citationMatch = "testSection" ]
    Set Field [ TEMP::sortTestSection; "abc" ]
    #
    Else If [ $$citationMatch = "testItem" ]
    Set Field [ TEMP::sortTestItem; "abc" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenus::tag; ascending ] [ Restore; No dialog ]
    Exit Script [ ]
    #
    Else If [ $$citationMatch = "test" or Left ( Get ( LayoutName ) ; 4 ) = "test" ]
    Set Field [ TEMP::sortTestSubsection; "abc" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testSubsectionTemplate::name; ascending ] [ Restore; No dialog ]
    Exit Script [ ]
    #
    Else If [ $$citationMatch = "cite" ]
    Set Field [ TEMP::sortCite; "abc" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: reference::referenceShort; ascending ] [ Restore; No dialog ]
    Exit Script [ ]
    #
    Else If [ $$citationMatch = "ref" ]
    Set Field [ TEMP::sortRef; "abc" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: reference::referenceShort; ascending ] [ Restore; No dialog ]
    Exit Script [ ]
    End If
    #
    #Sort records.
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenus::tag; ascending ] [ Restore; No dialog ]
    #

Fields used in this script

    TEMP::sortInsertRef
    reference::referenceShort
    tagKeywordPrimary::orderOrLock
    tagKeywordPrimary::tag
    TEMP::sortKey
    tagMenuGroup::orderOrLibraryType
    tagMenuGroup::name
    tagMenus::orderOrLock
    tagMenus::tag
    TEMP::sortNode
    TEMP::sortMedium
    TEMP::sortPublisher
    TEMP::sortPath
    TEMP::sortCopyright
    tagMenus::textStyleOrCreatorNodeFlag
    TEMP::sortPublication
    TEMP::sortBrainstorm
    TEMP::sortTestSection
    TEMP::sortTestSubsection
    testSubsectionGroup::orderOrLibraryType
    testSubsectionGroup::name
    testSubsectionTemplate::order
    testSubsectionTemplate::name
    TEMP::sortCite
    TEMP::sortRef
    TEMP::InventoryLibraryYN
    reference::publicationYearOrStuffOrderNumber
    reference::Title
    TEMP::sortTestItem
    tagMenuTestItemGroup::orderOrLibraryType
    tagMenuTestItemGroup::name
    tagMenuTestItemGroup::_Lgroup

Scripts used in this script

Layouts used in this script

Tables used in this script

    TEMP
    reference
    tag
    tagGroup
    testSubsectionTemplate

Table occurrences used by this script

    TEMP
    reference
    tagKeywordPrimary
    tagMenuGroup
    tagMenuTestItemGroup
    tagMenus
    testSubsectionGroup
    testSubsectionTemplate

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [sortTags]	Parent Folder: [tagMenu]	Next Script: [templateTestSectionMenu]
Script Name	sortTestOrBrainstormTaggedLearnRecords
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    addORremovePrimaryTag
    loadBrainstormTags
    loadTestTags
    sortButtonLearnLayouts
    reportTagInfo

Script Definition
Script Steps

    #
    #Used by the following scripts:
    #reportTagInfo
    #addTagToMainRecord
    #sortButtonLearnLayouts
    #loadItemRecordForBrainstormTagMenu
    #loadTestSectionAndTaggedLearnRecords
    #
    #Perform script for brainstorm and test tags only.
    If [ $$citationMatch = "brainstorm" or $$citationMatch = "test" or Left ( Get (LayoutName) ; 4 ) = "test" ]
    #
    #Make a key for the current record's lock so after
    #this sort is complete the system can go back to
    #this record.
    Set Variable [ $recordKey; Value:testlearn::_Ltestlearn ]
    #
    #Turn off the loadcitation script to speed up the
    #loop portion of the script.
    Set Variable [ $$stoploadCitation; Value:1 ]
    #
    #Check if the user does or does not want brainstorm
    #test learn table records sorted by order number.
    #If they do (the tlbrainstormsort is blank) then sort
    #by order number.
    If [ TEMP::TLBrainstormSort =1 and $$citationMatch = "brainstorm" ]
    #
    #Set the TLBrainstormSort field with a 1. Now if user
    #clicks the sort button it will be because they
    #now want the records sorted by date.
    Set Field [ TEMP::TLBrainstormSort; 1 ]
    #
    #To speed up the process, sort to the top the records
    #that have ksample numbers. Do not loop thru
    #records whose ksample records are blank.
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::kcbrainstorm; descending ] [ Restore; No dialog ]
    #
    #Go the first record.
    Go to Record/Request/Page [ First ]
    #
    #Check the brainstorm key fields if in
    #brainstorm mode.
    If [ $$citationMatch = "brainstorm" ]
    Loop
    #The first step is to blank or clear each record's
    #order field, so only those records that are part
    #of the current brainstorm or test will have order numbers
    #and be part of the sort coming right after this
    #assignment of sort order numbers.
    Set Field [ testlearn::orderTestInformation; "" ]
    Exit Loop If [ testlearn::kcbrainstorm = "" ]
    #
    #The order number is the left three digits of a
    #brainstorm or test record lock number. ( Remember
    #each record in the database has lock number or
    #ID number. To open the lock and see any record's
    #contents requires a key number that fits the lock.
    #So if a lock number is 123, then the key that will
    #fit this lock is 123 too. ) Because the brainstorm
    #and test key fields (think of key chains) may
    #have several keys, because any one learn record
    #may be part of more than one brainstorm or test.
    #the system must check each learn record's keys
    #one at a time to see if any fit the current brainstorm
    #or test's lock. So beginning with number one
    #the system checks each key. The left most 3 numbers
    #are order numbers so below you will note that
    #they system starts the check on the 4th number
    #from the left.
    Set Variable [ $number; Value:1 ]
    Go to Field [ ]
    Loop
    #
    If [ Middle ( GetValue ( testlearn::kcbrainstorm ; $number ) ; 4 ; 42 ) & "¶" = $$tagBrainstorm & "¶" ]
    #
    #When and if a key is found that fits the current
    #brainstorm or test record's lock, the order number
    #( left most 3 digits ) is caputred and placed in
    #in the order field.
    Set Field [ testlearn::orderTestInformation; Left ( GetValue ( testlearn::kcbrainstorm ; $number ) ; 3 ) ]
    #
    #The 'number' variable is made blank to trigger
    #the exit from this loop, the order number having
    #been assigned.
    Set Variable [ $number ]
    // Else If [ Middle ( GetValue ( testlearn::kcbrainstorm ; $number ) ; 4 ; 42 ) & "¶" ≠ $$tagBrainstorm ]
    // Set Field [ testlearn::orderTestInformation; "" ]
    End If
    Exit Loop If [ $number = "" ]
    #
    #Exit loop if the current record is not part
    #of the selected brainstorm or test after checking
    #all of its keys.
    Exit Loop If [ GetValue ( testlearn::kcbrainstorm ; $number ) = "" ]
    #
    #Add 1 to the 'number' varaible after each key
    #in the key field is checked, to direct the system
    #to check the next key.
    Set Variable [ $add; Value:$number ]
    Set Variable [ $number; Value:$add + 1 ]
    End Loop
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    End If
    #
    #Sort the records by order field.
    If [ TEMP::InventoryLibraryYN = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::orderInventoryList; based on value list: “testPulldownListANDsortOrderList” testlearn::orderTestInformation; based on value list: “testPulldownListANDsortOrderList” testlearn::timestamp; descending ] [ Restore; No dialog ]
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::orderInventoryList; based on value list: “testPulldownListANDsortOrderList” testlearn::orderInventoryGroupNumber; ascending testlearn::orderTestInformation; based on value list: “testPulldownListANDsortOrderList” testlearn::note; ascending ] [ Restore; No dialog ]
    End If
    #
    #Return to record user was on at
    #the start of this script.
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    Loop
    Exit Loop If [ $recordkey = testlearn::_Ltestlearn ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Turn loadcitation script back on and exit script.
    Set Variable [ $$stoploadCitation ]
    Exit Script [ ]
    End If
    #
    #
    #
    #
    #Check if the user does or does not want
    #learn records sorted by order number.
    #If they do (the TLTestSort is blank) then sort
    #by order number.
    If [ TEMP::TLTestSort = 1 and $$citationMatch = "test" ]
    #
    #To speed up the process, sort to the top the records
    #that have kbrainstorm numbers. Do not loop thru
    #records whose kbrainstorm records are blank.
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::kctestSubsectionInfo; descending ] [ Restore; No dialog ]
    #
    #Go the first record.
    Go to Record/Request/Page [ First ]
    #
    #Check the test key fields if in brainstorm mode.
    If [ $$citationMatch = "test" ]
    Loop
    #
    #The first step is to blank or clear each record's
    #order field, so only those records that are part
    #of the current brainstorm or test will have order numbers
    #and be part of the sort coming right after this
    #assignment of sort order numbers.
    Set Field [ testlearn::orderTestInformation; "" ]
    Exit Loop If [ testlearn::kctestSubsectionInfo = "" ]
    #
    #The order number is the left three digits of a
    #brainstorm or test record lock number. ( Remember
    #each record in the database has lock number or
    #ID number. To open the lock and see any record's
    #contents requires a key number that fits the lock.
    #So if a lock number is 123, then the key that will
    #fit this lock is 123 too. ) Because the brainstorm
    #and test key fields (think of key chains) may
    #have several keys, because any one learn record
    #may be part of more than one brainstorm or test,
    #the system must check each learn record's keys
    #one at a time to see if any fit the current brainstorm
    #or test's lock. So beginning with number one
    #the system checks each key. The left most 3 numbers
    #are order numbers so below you will note that
    #they system starts the check on the 4th number
    #from the left.
    Set Variable [ $number; Value:1 ]
    Go to Field [ ]
    Loop
    If [ Middle ( GetValue ( testlearn::kctestSubsectionInfo ; $number ) ; 4 ; 42 ) & "¶" = $$tagtest & ¶ ]
    #
    #When and if a key is found that fits the current
    #brainstorm or test record's lock, the order number
    #( left most 3 digits ) is caputred and placed in
    #in the order field.
    Set Field [ testlearn::orderTestInformation; Left ( GetValue ( testlearn::kctestSubsectionInfo ; $number ) ; 3 ) ]
    #
    #The 'number' variable is made blank to trigger
    #the exit from this loop, the order number having
    #been assigned.
    Set Variable [ $number ]
    End If
    Exit Loop If [ $number = "" ]
    #
    #Exit loop if the current record is not part
    #of the selected brainstorm or test after checking
    #all of its keys.
    Exit Loop If [ GetValue ( testlearn::kctestSubsectionInfo ; $number ) = "" ]
    #
    #Add 1 to the 'number' varaible after each key
    #in the key field is checked, to direct the system
    #to check the next key.
    Set Variable [ $add; Value:$number ]
    Set Variable [ $number; Value:$add + 1 ]
    End Loop
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    End If
    #
    #Sort the records by order field.
    If [ Right ( Get (LayoutName) ; 4 ) = "info" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearnReportTags::orderTestInformation; based on value list: “testPulldownListANDsortOrderList” testlearnReportTags::timestamp; descending ] [ Restore; No dialog ]
    Else
    If [ TEMP::InventoryLibraryYN = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::orderInventoryList; based on value list: “testPulldownListANDsortOrderList” testlearn::orderTestInformation; based on value list: “testPulldownListANDsortOrderList” testlearn::timestamp; descending ] [ Restore; No dialog ]
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::orderInventoryList; based on value list: “testPulldownListANDsortOrderList” testlearn::orderInventoryGroupNumber; ascending testlearn::orderTestInformation; based on value list: “testPulldownListANDsortOrderList” testlearn::note; ascending ] [ Restore; No dialog ]
    End If
    End If
    #
    #Return to record user was on at
    #the start of this script.
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    Loop
    Exit Loop If [ $recordkey = testlearn::_Ltestlearn ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Turn loadcitation script back on, load up the
    #selected Learn records variables (just in case
    #the user came here via the edit/new button in
    #the test module), and exit script.
    Set Variable [ $$stoploadCitation ]
    #
    Set Variable [ $$citationRecord; Value:testlearn::_Ltestlearn ]
    Set Variable [ $$node; Value:testlearn::kNodeOther ]
    Set Variable [ $$primaryNode; Value:testlearn::kNodePrimary ]
    Set Variable [ $$copyright; Value:testlearn::kcopyright ]
    Set Variable [ $$ref; Value:testlearn::kcreference ]
    Set Variable [ $$PrimaryKey; Value:testlearn::kKeywordPrimary ]
    Set Variable [ $$Key; Value:testlearn::kcKeywordOther ]
    Set Variable [ $$OtherKey; Value:testlearn::kcKeywordOther ]
    Set Variable [ $$test; Value:testlearn::kctestSubsectionInfo ]
    Set Variable [ $$brainstorm; Value:testlearn::kcbrainstorm ]
    Set Variable [ $$RecordID; Value:Get (RecordID) ]
    #
    #Note if record is locked to protect its tags.
    If [ tagTLNodePrimary::orderOrLock ≠ "" ]
    Set Variable [ $$lockedMainLearnRecord; Value:tagTLNodePrimary::tag ]
    Else
    Set Variable [ $$lockedMainLearnRecord ]
    End If
    Exit Script [ ]
    End If
    #
    End If

Fields used in this script

    testlearn::_Ltestlearn
    TEMP::TLBrainstormSort
    testlearn::kcbrainstorm
    testlearn::orderTestInformation
    TEMP::InventoryLibraryYN
    testlearn::orderInventoryList
    testlearn::timestamp
    testlearn::orderInventoryGroupNumber
    testlearn::note
    TEMP::TLTestSort
    testlearn::kctestSubsectionInfo
    testlearnReportTags::orderTestInformation
    testlearnReportTags::timestamp
    testlearn::kNodeOther
    testlearn::kNodePrimary
    testlearn::kcopyright
    testlearn::kcreference
    testlearn::kKeywordPrimary
    testlearn::kcKeywordOther
    tagTLNodePrimary::orderOrLock
    tagTLNodePrimary::tag

Scripts used in this script

Layouts used in this script

Tables used in this script

    TEMP
    tag
    testlearn

Table occurrences used by this script

    TEMP
    tagTLNodePrimary
    testlearn
    testlearnReportTags

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [sortTestOrBrainstormTaggedLearnRecords]	Parent Folder: [tagMenu]	Next Script: [testItemCheckButton]
Script Name	templateTestSectionMenu
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultSetup

Scripts that use this script

    printThingReport

Script Definition
Script Steps

    #
    #
    #Don't go to the test module if the user has
    #not selected a primary node, or a copyright.
    If [ tempSetup::kdefaultNodePrimary = "" ]
    Show Custom Dialog [ Message: "Select yourself (the node responsible for creating new records) by clicking the node button."; Default Button: “OK”, Commit: “Yes” ]
    Halt Script
    Else If [ tempSetup::kdefaultCopyright = "" ]
    Show Custom Dialog [ Message: "Select the default copyright for any new records that you create by clicking the copyright button (you can always change your mind)."; Default Button: “OK”, Commit: “No” ]
    Halt Script
    End If
    #
    #Sections shown are the template sections
    #for a test. This tag window will be used to create
    #specific sections from a template for test subjects.
    #So in the Setup window the system highlights
    #the test subject for whom the sections are going
    #to be created, and who are going to be tested.
    Select Window [ Name: "Setup"; Current file ]
    Set Variable [ $$citationitem ]
    Set Variable [ $$testSubject; Value:tempSetup::kdefaultNodeTestSubject ]
    Set Field [ TEMP::DEFAULTNodeTestSubjectName; testSubject::tag ]
    Refresh Window
    #
    #Find all created test section records.
    Go to Layout [ “defaultTest” (testSectionCreatedFromATemplate) ]
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    Show All Records
    #
    #Sort
    Sort Records [ Keep records in sorted order; Specified Sort Order: testSubjectName::tag; ascending testSectionCreatedFromATemplate::reportNumber; descending testSectionCreatedFromATemplate::order; based on value list: “order Pulldown List” testSectionCreatedFromATemplate::name; ascending ] [ Restore; No dialog ]
    Scroll Window [ Home ]
    Go to Record/Request/Page [ First ]
    #

Fields used in this script

    tempSetup::kdefaultNodePrimary
    tempSetup::kdefaultCopyright
    tempSetup::kdefaultNodeTestSubject
    testSubject::tag
    TEMP::DEFAULTNodeTestSubjectName
    testSubjectName::tag
    testSectionCreatedFromATemplate::reportNumber
    testSectionCreatedFromATemplate::order
    testSectionCreatedFromATemplate::name

Scripts used in this script

Layouts used in this script

    defaultTest

Tables used in this script

    TEMP
    TEMP
    tag
    testSectionCreatedFromATemplate

Table occurrences used by this script

    TEMP
    tempSetup
    testSectionCreatedFromATemplate
    testSubject
    testSubjectName

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [templateTestSectionMenu]	Parent Folder: [tagMenu]	Next Script: [testItemTextButton]
Script Name	testItemCheckButton
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    testMenuTestItem

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #On the test-item layout, set this stop check
    #or text variable to allows the user to click into
    #this field for the purpose of navigating to a
    #new record without changing the check or
    #text mark status.
    If [ $$stopCheckOrTest = 1 ]
    Set Variable [ $$stopCheckOrTest ]
    Exit Script [ ]
    End If
    #
    #
    #Inform the checkORaddTestItem that the
    #check button was clicked as it may be hidden
    #if the user clicked on a text T item, in which
    #case the user expects to go to the text field.
    Set Variable [ $$checkButton; Value:1 ]
    #
    Perform Script [ “checkORaddTestItem” ]
    #
    #

Fields used in this script

Scripts used in this script

    checkORaddTestItem

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [testItemCheckButton]	Parent Folder: [tagMenu]	Next Script: [testTemplatesItemButton]
Script Name	testItemTextButton
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    testMenuTestItem

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #On the test-item layout, set this stop check
    #or text variable to allows the user to click into
    #this field for the purpose of navigating to a
    #new record without changing the check or
    #text mark status.
    If [ $$stopCheckOrTest = 1 ]
    Set Variable [ $$stopCheckOrTest ]
    Exit Script [ ]
    End If
    #
    #
    #Inform the checkORaddTestItem that the
    #text button was clicked as it may be hidden
    #if the user clicked on a check item, in which
    #case the user expects to go to the text field.
    Set Variable [ $$textButton; Value:1 ]
    #
    Perform Script [ “checkORaddTestItem” ]
    #
    #

Fields used in this script

Scripts used in this script

    checkORaddTestItem

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [testItemTextButton]	Parent Folder: [tagMenu]	Next Script: [testTemplatesSectionButton]
Script Name	testTemplatesItemButton
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    setupTestSection
    setupTestSubsection

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #If the user clicked the show tagged
    #subsections button, turn off this conditional
    #formatting variable and reset the conditional
    #formatting in the Test Templates window.
    If [ $$setupTestSection ≠ "" ]
    Set Variable [ $$setupTestSection ]
    Select Window [ Name: "Test Templates"; Current file ]
    Refresh Window
    End If
    #
    #
    #When user leaves this menu, revert all
    #spellings that where changed by dragging
    #text into them.
    If [ Get (LayoutName) = "setupTestSection" ]
    Perform Script [ “checkTestSectionSubsectionAndItemRecordSpellings” ]
    End If
    #
    #
    #Go to the test section window from
    #the test item window.
    Select Window [ Name: "Tag Menus"; Current file ]
    If [ $$citationMatch ≠ "testItem" ]
    Perform Script [ “menuTestItem” ]
    End If
    #
    #

Fields used in this script

Scripts used in this script

    checkTestSectionSubsectionAndItemRecordSpellings
    menuTestItem

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [testTemplatesItemButton]	Parent Folder: [tagMenu]	Next Script: [testTemplatesTestButton]
Script Name	testTemplatesSectionButton
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    setupTestSubsection
    setupTestItem
    setupTestItemLOCKED

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #When user leaves this menu, revert all
    #spellings that where changed by dragging
    #text into them.
    If [ Get (LayoutName) = "setupTestItem" ]
    Perform Script [ “CHUNK_checkForDraggedPasteChanges” ]
    End If
    #
    #
    #Go to the test Item window from the
    #test section window.
    Select Window [ Name: "Tag Menus"; Current file ]
    If [ $$citationMatch = "testItem" ]
    Perform Script [ “menuTestSection” ]
    End If
    #
    #

Fields used in this script

Scripts used in this script

    CHUNK_checkForDraggedPasteChanges
    menuTestSection

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [testTemplatesSectionButton]	Parent Folder: [tagMenu]	Next Script: [TgotoCitationMenu]
Script Name	testTemplatesTestButton
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    setupTestSection
    setupTestSubsection
    setupTestItem
    setupTestItemLOCKED

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Don't go to the test module if the user has
    #not selected a primary node, or a copyright.
    Show Custom Dialog [ Message: "Tests consist of 1 or more section templates. Each of these must have 1 or more subsections. Test items can be created, and shared (via the 'link' button), among subsections as needed. Test items are not required."; Default Button: “OK”, Commit: “Yes” ]
    Show Custom Dialog [ Message: "Tests are built for test subjects in the Setup window out of section templates. Clicking a section's test button, opens its subsection menu. Click on subsection names to record test results in each subsection."; Default Button: “OK”, Commit: “Yes” ]
    #
    #

Fields used in this script

Scripts used in this script

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [testTemplatesTestButton]	Parent Folder: [tagMenu]	Next Script: [toggleTagMenuWindowView]
Script Name	TgotoCitationMenu
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    loadLearnOrRefMainRecord

Script Definition
Script Steps

    #
    // If [ Get ( ActiveFieldContents ) = "" ]
    // Go to Field [ ]
    // Exit Script [ ]
    // End If
    #
    If [ $$findMode ≠ "" or $$stopTgotoCitationMenu = 1 ]
    Go to Field [ ]
    Set Variable [ $$stopTgotoCitationMenu ]
    Exit Script [ ]
    End If
    #Admin tasks
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    #
    #Conditionally format selected item and button on menu screen.
    Set Variable [ $$citationItem; Value:Get (ActiveFieldContents) ]
    Set Variable [ $$citationMatch; Value:Get (ActiveFieldName) ]
    #
    If [ Filter ( Get ( ActiveFieldTableName ) ; "refLearn" ) = "refLearn" ]
    Set Variable [ $$citationMatch; Value:"ref" ]
    Set Variable [ $learnRef; Value:refLearn::_Lreference ]
    Set Variable [ $$refIDForMainLearnRecord; Value:refLearn::_Lreference ]
    End If
    #
    If [ Filter ( Get ( ActiveFieldTableName ) ; "refTestLearn" ) = "refTestLearn" ]
    Set Variable [ $$citationMatch; Value:"learn" ]
    Set Variable [ $learnRef; Value:refTestLearn::_Ltestlearn ]
    Set Variable [ $$learnIDForMainLearnRecord; Value:refTestLearn::_Ltestlearn ]
    End If
    #
    If [ Left (Get (ActiveFieldName); 4) = "kkey" or Left (Get (ActiveFieldName); 5) = "kckey" or Get (ActiveFieldName) = "" ]
    Set Variable [ $$citationMatch; Value:"key" ]
    Set Variable [ $$citationItem; Value:tagTLKeywordPrimary::_Ltag ]
    If [ $$primaryKey = "" ]
    Set Variable [ $firstOtherKeyword; Value:Case ( Middle ( testlearn::OtherKeyWords ; Length ( LeftWords ( testlearn::OtherKeyWords ; 1 ) ) + 1 ; 1 ) = "," ; LeftWords ( testlearn::OtherKeyWords ; 1 ) ; Middle ( testlearn::OtherKeyWords ; Length ( LeftWords ( testlearn::OtherKeyWords ; 2 ) ) + 1 ; 1 ) = "," ; LeftWords ( testlearn::OtherKeyWords ; 2 ) ; Middle ( testlearn::OtherKeyWords ; Length ( LeftWords ( testlearn::OtherKeyWords ; 3 ) ) + 1 ; 1 ) = "," ; LeftWords ( testlearn::OtherKeyWords ; 3 ) ; Middle ( testlearn::OtherKeyWords ; Length ( LeftWords ( testlearn::OtherKeyWords ; 4 ) ) + 1 ; 1 ) = "," ; LeftWords ( testlearn::OtherKeyWords ; 4 ) ; LeftWords ( testlearn::OtherKeyWords ; 5 ) ) ]
    End If
    End If
    #
    If [ Left ( Get ( ActiveFieldName ) ; 5 ) = "knode" or Filter ( Get (ActiveFieldTableName) ; "Node" ) = "Node" ]
    Set Variable [ $$citationMatch; Value:"node" ]
    Set Variable [ $$citationItem; Value:tagTLNodePrimary::_Ltag ]
    End If
    #
    If [ Filter ( Get ( ActiveFieldName ) ; "node" ) = "node" ]
    Set Variable [ $$citationMatch; Value:"node" ]
    Set Variable [ $$citationItem; Value:reference::knodePrimary ]
    End If
    #
    Refresh Window
    #
    #Exit field so blinking cursor doesn't show up in empty field.
    Go to Field [ ]
    Set Variable [ $window; Value:Get (WindowName) ]
    #
    #goto Tag Menus window
    Select Window [ Name: "Tag Menus"; Current file ]
    If [ Get (LastError) = 112 ]
    New Window [ Name: "Tag Menus"; Height: Get (ScreenHeight); Width: Get (ScreenWidth) / 2; Top: 0; Left: Get (ScreenWidth) / 2; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    End If
    #
    #
    #
    #
    #
    #LEARN WINDOW
    If [ $window = "Learn" ]
    #
    If [ $$citationMatch = "kfolderpath" ]
    Go to Layout [ “learnMenu1” (tagMenus) ]
    Perform Script [ “menuPath” ]
    #
    Else If [ $$citationMatch = "kmedium" ]
    Set Variable [ $$medium; Value:reference::kmedium ]
    Go to Layout [ “learnMenu1” (tagMenus) ]
    Perform Script [ “menuMedium” ]
    #
    Else If [ $$citationMatch = "khealth" ]
    Go to Layout [ “learnMenuCopyright” (tagMenus) ]
    Perform Script [ “menuCopyright” ]
    #
    Else If [ $$citationMatch = "key" ]
    #KEY MENU
    #
    #See if user has selected requested menu.
    If [ tagMenus::match ≠ "key" ]
    #
    #Menu NOT selected.
    Perform Script [ “menuKey” ]
    #
    Else
    #Menu IS selected.
    #
    #Record not selected and there is only a
    #primary key, do this:
    If [ $$primaryKey ≠ tagMenus::_Ltag or $$PrimaryKey ≠ "" ]
    #
    #Go to a layout with no pictures
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Set Variable [ $reflayoutname; Value:Get (LayoutName) ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Go to Layout [ “ltagNK1” (tagMenus) ]
    Else
    Go to Layout [ “ltagNKs1” (tagMenus) ]
    End If
    #
    #Make sure records are showing.
    Enter Find Mode [ ]
    Set Field [ tagMenus::_Ltag; $$primaryKey ]
    Extend Found Set [ ]
    If [ $$otherKey ≠ "" ]
    Set Variable [ $numberOfkeys; Value:1 ]
    Loop
    Enter Find Mode [ ]
    Set Field [ tagMenus::_Ltag; GetValue ( $$OtherKey ; $numberOfkeys ) ]
    Extend Found Set [ ]
    Set Variable [ $numberOfkeys; Value:$numberOfkeys + 1 ]
    Exit Loop If [ $numberOfkeys = ValueCount ( $$OtherKey ) + 1 ]
    End Loop
    End If
    #
    #Loop thru records to find user's selection.
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    If [ $$primaryKey ≠ "" ]
    Loop
    Exit Loop If [ $$primaryKey = tagMenus::_Ltag ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    Else If [ $firstOtherKeyword ≠ "" ]
    Loop
    Exit Loop If [ $firstOtherKeyword = LeftWords ( tagMenus::tag ; 5 ) ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    End If
    #
    #Finish.
    Go to Layout [ $reflayoutname ]
    Set Variable [ $$stoploadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    End If
    End If
    #
    #
    Else If [ $$citationMatch = "node" ]
    #NODE MENU
    #
    #See if user has selected requested menu.
    If [ tagMenus::match ≠ "node" ]
    #
    #Menu NOT selected.
    Perform Script [ “menuNode” ]
    #
    Else
    #Menu IS selected.
    #
    #Record not selected and there is only a
    #primary node, do this:
    If [ $$primaryNode ≠ tagMenus::_Ltag or $$Node ≠ "" ]
    #
    #Go to a layout with no pictures
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Set Variable [ $reflayoutname; Value:Get (LayoutName) ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Go to Layout [ “ltagNK1” (tagMenus) ]
    Else
    Go to Layout [ “ltagNKs1” (tagMenus) ]
    End If
    #
    #Make sure records are showing.
    Enter Find Mode [ ]
    Set Field [ tagMenus::_Ltag; $$primaryNode ]
    Extend Found Set [ ]
    If [ $$Node ≠ "" ]
    Set Variable [ $numberOfkeys; Value:1 ]
    Loop
    Enter Find Mode [ ]
    Set Field [ tagMenus::_Ltag; GetValue ( $$Node ; $numberOfkeys ) ]
    Extend Found Set [ ]
    Set Variable [ $numberOfkeys; Value:$numberOfkeys + 1 ]
    Exit Loop If [ $numberOfkeys = ValueCount ( $$Node ) + 1 ]
    End Loop
    End If
    #
    #Loop thru records to find user's selection.
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    If [ $$primaryNode ≠ "" ]
    Loop
    Exit Loop If [ $$primaryNode = tagMenus::_Ltag ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    End If
    #
    #Finish.
    Go to Layout [ $reflayoutname ]
    Set Variable [ $$stoploadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    End If
    End If
    #
    #
    Else If [ $$citationMatch = "ref" ]
    #REFERENCE MENU
    #
    #See if user has selected requested menu.
    If [ Get (LayoutTableName) ≠ "reference" ]
    #
    #Menu NOT selected.
    Perform Script [ “menuReference” ]
    #
    #Reset this variable which is changed
    #by the menuReference script.
    Set Variable [ $$refIDForMainLearnRecord; Value:$learnRef ]
    If [ TEMP::layoutLmain = "lesslearn4" or TEMP::layoutLmain = "morelearn4" or $$testLearnLayoutName ≠ "" ]
    Select Window [ Name: "Learn"; Current file ]
    Refresh Window
    Select Window [ Name: "Tag Menus"; Current file ]
    End If
    End If
    #
    #Menu IS selected.
    #
    #Record not selected, do this:
    If [ $learnRef ≠ reference::_Lreference ]
    #
    #Go to a layout with no pictures
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Set Variable [ $reflayoutname; Value:Get (LayoutName) ]
    Go to Layout [ “learnMenu3CiteS” (reference) ]
    #
    #Make sure record is showing.
    Enter Find Mode [ ]
    Set Field [ reference::_Lreference; $learnRef ]
    Extend Found Set [ ]
    #
    #Loop thru records to find user's selection.
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ $learnRef = reference::_Lreference ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Finish.
    Go to Layout [ $reflayoutname ]
    Set Variable [ $$stoploadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    End If
    #
    #
    #
    Else If [ $$citationMatch = "learn" ]
    #LEARN MENU
    #
    #See if user has selected requested menu.
    If [ Get (LayoutTableName) ≠ "testlearn" ]
    #
    #Menu NOT selected.
    Perform Script [ “menuLearn” ]
    End If
    #
    #Menu IS selected.
    #
    #Record not selected, do this:
    If [ $learnRef ≠ testlearn::_Ltestlearn ]
    #
    #Go to a layout with no pictures
    Set Variable [ $reflayoutname; Value:Get (LayoutName) ]
    Go to Layout [ “learnSCRIPTloops” (testlearn) ]
    #
    #Make sure record is showing.
    Enter Find Mode [ ]
    Set Field [ testlearn::_Ltestlearn; $learnRef ]
    Extend Found Set [ ]
    #
    #Loop thru records to find user's selection.
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ $learnRef = testlearn::_Ltestlearn ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Finish.
    Go to Layout [ $reflayoutname ]
    Set Variable [ $$stoploadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    End If
    #
    #
    #
    End If
    #
    #
    #
    #
    #REFERENCE OR SETUP WINDOW
    Else If [ $window = "References" or $window = "Setup" ]
    #
    #If in add mode, prevent menu scripts from changing
    #the main window's set of records.
    #Unlike learn records, reference records are created
    #for specific uses such as providing a picture
    #or link for a specific set of tags, say keyword tags.
    #So, in add mode, when clicking on a menu item
    #the system finds all the records in the main
    #reference window for that menu item. This
    #is not helpful when the user is trying to create
    #a new record to add to a tag. So this next script
    #step stops the records shown, including and most
    #importantly the record the user is working on
    #from disappearing when the system finds only
    #records assigned to that menu item. This then
    #allows the user to add tags to the item neccessary
    #to make it addable to the the tag menu item the
    #user is creating it for!
    If [ $$add = 1 ]
    Set Variable [ $$add; Value:2 ]
    End If
    #
    #Set this variable to stop conditional formatting
    #of unselected first Tag Menus record.
    If [ $$citationitem = "" ]
    Set Variable [ $$TgotoCitationMenuWithBlankField; Value:1 ]
    Else
    Set Variable [ $$TgotoCitationMenuWithBlankField ]
    End If
    #
    If [ $$citationMatch = "kfolderpath" ]
    Perform Script [ “menuPath” ]
    Else If [ $$citationMatch = "kmedium" ]
    Set Variable [ $$medium; Value:reference::kmedium ]
    Perform Script [ “menuMedium” ]
    Else If [ $$citationMatch = "kcopyright" ]
    Perform Script [ “menuCopyright” ]
    Else If [ $$citationMatch = "kpublication" ]
    Perform Script [ “menuPublication” ]
    Else If [ $$citationMatch = "kpublisher" ]
    Perform Script [ “menuPublisher” ]
    Else If [ $$citationMatch = "key" ]
    Perform Script [ “menuKey” ]
    Else If [ $$citationMatch = "node" ]
    Perform Script [ “menuNode” ]
    Else If [ $$citationMatch = "kcitation" ]
    Perform Script [ “menuCitation” ]
    End If
    #
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    #If in add mode, allow menu scripts to once again
    #change main window records.
    If [ $$add = 2 ]
    Set Variable [ $$add; Value:1 ]
    End If
    End If
    #

Fields used in this script

    refLearn::_Lreference
    refTestLearn::_Ltestlearn
    tagTLKeywordPrimary::_Ltag
    testlearn::OtherKeyWords
    tagTLNodePrimary::_Ltag
    reference::knodePrimary
    reference::kmedium
    tagMenus::match
    tagMenus::_Ltag
    TEMP::InventoryLibraryYN
    tagMenus::tag
    TEMP::layoutLmain
    reference::_Lreference
    testlearn::_Ltestlearn

Scripts used in this script

    menuPath
    menuMedium
    menuCopyright
    menuKey
    menuNode
    menuReference
    menuLearn
    menuPublication
    menuPublisher
    menuCitation

Layouts used in this script

    learnMenu1
    learnMenuCopyright
    ltagNK1
    ltagNKs1
    <Missing Layout>
    learnMenu3CiteS
    learnSCRIPTloops

Tables used in this script

    TEMP
    reference
    reference
    tag
    tag
    testlearn
    testlearn

Table occurrences used by this script

    TEMP
    refLearn
    refTestLearn
    reference
    tagMenus
    tagTLKeywordPrimary
    tagTLNodePrimary
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [TgotoCitationMenu]	Parent Folder: [tagMenu]	Next Script: [unzoomSetup]
Script Name	toggleTagMenuWindowView
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultNode1
    defaultNode2
    defaultNodeS2
    defaultNode3
    defaultNodeS3
    defaultNodeS4
    defaultNode4
    ReferenceMenu3Cite
    ReferenceMenu3CiteNoPicture
    ReferenceMenu2keywordOrNode1
    ReferenceMenu2SkeywordOrNode1
    ReferenceMenu2keywordOrNode2
    ReferenceMenu2SkeywordOrNode2
    ReferenceMenu2keywordOrNode3
    ReferenceMenu2SkeywordOrNode3
    ReferenceMenu2keywordOrNode4
    ReferenceMenu2SkeywordOrNode4
    ReferenceMenu2keywordOrNode5
    ReferenceMenu2SkeywordOrNode5
    ReferenceMenu3CiteFind
    ReferenceMenu3CiteFindS
    ltagNK1
    ltagNKs1
    ltagNK2
    ltagNKs2
    ltagNK3
    ltagNKs3
    ltagNK4
    ltagNKs4
    ltagNK5
    ltagNKs5
    learnMenu3Cite
    learnMenu3CiteS
    learnMenu4RefCite
    learnMenu4noPicRefCite
    learnFindCite
    learnFindCiteS
    learnMenu4NoPicRefCiteFindTL
    learnMenu4RefCiteFindTL

Scripts that use this script

Script Definition
Script Steps

    #
    #Reveal more or fewer pictures and links for tag.
    #
    #Speed up script.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Set Variable [ $$stopLockCheck; Value:1 ]
    #
    #First toggle from current view to next view.
    If [ Left (Get (LayoutName) ; 1) = "l" and $$citationMatch = "key" ]
    #from 1 to 2
    If [ Right ( Get (LayoutName) ; 1) = 1 and Left ( TEMP::layoutLtagK ; 4 ) = "more" ]
    Go to Layout [ “ltagNK2” (tagMenus) ]
    #from 2 to 3
    Else If [ Right ( Get (LayoutName) ; 1) = 2 and Left ( TEMP::layoutLtagK ; 4 ) = "more" ]
    Go to Layout [ “ltagNK3” (tagMenus) ]
    Show Custom Dialog [ Message: "This view shows media (if there is any to show), and can slow down scrolling and other menu processes on slower computers and mobile devices."; Default Button: “OK”, Commit: “Yes” ]
    #from 3 to 4
    Else If [ Right ( Get (LayoutName) ; 1) = 3 and Left ( TEMP::layoutLtagK ; 4 ) = "more" ]
    Go to Layout [ “ltagNK4” (tagMenus) ]
    #from 4 to 5
    Else If [ Right ( Get (LayoutName) ; 1) = 4 and Left ( TEMP::layoutLtagK ; 4 ) = "more" ]
    Go to Layout [ “ltagNK5” (tagMenus) ]
    #from 5 to 4
    Else If [ Right ( Get (LayoutName) ; 1) = 5 and Left ( TEMP::layoutLtagK ; 4 ) = "less" ]
    Go to Layout [ “ltagNK4” (tagMenus) ]
    #from 4 to 3
    Else If [ Right ( Get (LayoutName) ; 1) = 4 and Left ( TEMP::layoutLtagK ; 4 ) = "less" ]
    Go to Layout [ “ltagNK3” (tagMenus) ]
    #from 3 to 2
    Else If [ Right ( Get (LayoutName) ; 1) = 3 and Left ( TEMP::layoutLtagK ; 4 ) = "less" ]
    Go to Layout [ “ltagNK2” (tagMenus) ]
    Show Custom Dialog [ Message: "This view hides any media (if there is any to hide), speeding up scrolling and other menu processes on slower computers and mobile devices."; Default Button: “OK”, Commit: “Yes” ]
    #from 2 to 1
    Else If [ Right ( Get (LayoutName) ; 1) = 2 and Left ( TEMP::layoutLtagK ; 4 ) = "less" ]
    Go to Layout [ “ltagNK1” (tagMenus) ]
    End If
    #
    Else If [ Left (Get (LayoutName) ; 1) = "l" and $$citationMatch = "node" ]
    #from 1 to 2
    If [ Right ( Get (LayoutName) ; 1) = 1 and Left ( TEMP::layoutLtagN ; 4 ) = "more" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “ltagNKs2” (tagMenus) ]
    Else
    Go to Layout [ “ltagNK2” (tagMenus) ]
    End If
    #from 2 to 3
    Else If [ Right ( Get (LayoutName) ; 1) = 2 and Left ( TEMP::layoutLtagN ; 4 ) = "more" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “ltagNKs3” (tagMenus) ]
    // Show Custom Dialog [ Message: "This view shows media (if there is any to show), and can slow down scrolling and other menu processes on slower computers and mobile devices."; Default Button: “OK”, Commit: “Yes” ]
    Else
    Go to Layout [ “ltagNK3” (tagMenus) ]
    Show Custom Dialog [ Message: "This view shows media (if there is any to show), and can slow down scrolling and other menu processes on slower computers and mobile devices."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #from 4 to 5
    Else If [ Right ( Get (LayoutName) ; 1) = 4 and Left ( TEMP::layoutLtagN ; 4 ) = "more" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “ltagNKs5” (tagMenus) ]
    Else
    Go to Layout [ “ltagNK5” (tagMenus) ]
    End If
    #from 3 to 4
    Else If [ Right ( Get (LayoutName) ; 1) = 3 and Left ( TEMP::layoutLtagN ; 4 ) = "more" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “ltagNKs4” (tagMenus) ]
    Else
    Go to Layout [ “ltagNK4” (tagMenus) ]
    End If
    #from 5 to 4
    Else If [ Right ( Get (LayoutName) ; 1) = 5 and Left ( TEMP::layoutLtagN ; 4 ) = "less" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “ltagNKs4” (tagMenus) ]
    Else
    Go to Layout [ “ltagNK4” (tagMenus) ]
    End If
    #from 4 to 3
    Else If [ Right ( Get (LayoutName) ; 1) = 4 and Left ( TEMP::layoutLtagN ; 4 ) = "less" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “ltagNKs3” (tagMenus) ]
    Else
    Go to Layout [ “ltagNK3” (tagMenus) ]
    End If
    #from 3 to 2
    Else If [ Right ( Get (LayoutName) ; 1) = 3 and Left ( TEMP::layoutLtagN ; 4 ) = "less" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “ltagNKs2” (tagMenus) ]
    // Show Custom Dialog [ Message: "This view hides any media (if there is any to hide), speeding up scrolling and other menu processes on slower computers and mobile devices."; Default Button: “OK”, Commit: “Yes” ]
    Else
    Go to Layout [ “ltagNK2” (tagMenus) ]
    Show Custom Dialog [ Message: "This view hides any media (if there is any to hide), speeding up scrolling and other menu processes on slower computers and mobile devices."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #from 2 to 1
    Else If [ Right ( Get (LayoutName) ; 1) = 2 and Left ( TEMP::layoutLtagN ; 4 ) = "less" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “ltagNKs1” (tagMenus) ]
    Else
    Go to Layout [ “ltagNK1” (tagMenus) ]
    End If
    End If
    #
    Else If [ Left (Get (LayoutName) ; 1) = "l" and $$citationMatch = "learn" and Get (LayoutTableName) = "testLearn" ]
    #
    #If not in find mode, so on regular tag layout...
    If [ $$findMode = "" ]
    #from 1 to 2
    If [ Left ( TEMP::layoutLtagL ; 4 ) = "more" ]
    Go to Layout [ “learnMenu4RefCite” (testlearn) ]
    Show Custom Dialog [ Message: "This view shows learn media (if there is any to show), and can slow down scrolling and other learn menu processes on slower computers and mobile devices."; Default Button: “OK”, Commit: “Yes” ]
    #from 2 to 1
    Else
    Go to Layout [ “learnMenu4noPicRefCite” (testlearn) ]
    Show Custom Dialog [ Message: "This view hides any media (if there is any to hide), speeding up scrolling and other learn menu processes on slower computers and mobile devices."; Default Button: “OK”, Commit: “Yes” ]
    End If
    End If
    #
    #If in find mode, so on a find layout...
    If [ $$findMode ≠ "" ]
    #from 1 to 2
    If [ Left ( TEMP::layoutLtagLFIND ; 4 ) = "more" ]
    Go to Layout [ “learnMenu4RefCiteFindTL” (testlearn) ]
    Show Custom Dialog [ Message: "This view shows learn media (if there is any to show), and can slow down scrolling and other learn menu processes on slower computers and mobile devices."; Default Button: “OK”, Commit: “Yes” ]
    #from 2 to 1
    Else
    Go to Layout [ “learnMenu4NoPicRefCiteFindTL” (testlearn) ]
    Show Custom Dialog [ Message: "This view hides any media (if there is any to hide), speeding up scrolling and other learn menu processes on slower computers and mobile devices."; Default Button: “OK”, Commit: “Yes” ]
    End If
    End If
    #
    Else If [ Left (Get (LayoutName) ; 1) = "l" and $$citationMatch = "ref" ]
    #
    #If not in find mode, so on regular tag layout...
    If [ $$findMode = "" ]
    #from 1 to 2
    If [ Left ( TEMP::layoutLtagR ; 4 ) = "more" ]
    Go to Layout [ “learnMenu3Cite” (reference) ]
    Show Custom Dialog [ Message: "This view shows reference media (if there is any to show), and can slow down scrolling and other reference menu processes on slower computers and mobile devices."; Default Button: “OK”, Commit: “Yes” ]
    #from 2 to 1
    Else
    Go to Layout [ “learnMenu3CiteS” (reference) ]
    Show Custom Dialog [ Message: "This view hides any media (if there is any to hide), speeding up scrolling and other reference menu processes on slower computers and mobile devices."; Default Button: “OK”, Commit: “Yes” ]
    End If
    End If
    #
    #If in find mode, so on a find layout...
    If [ $$findMode ≠ "" ]
    #from 1 to 2
    If [ Left ( TEMP::layoutLtagRFIND ; 4 ) = "more" ]
    Go to Layout [ “learnFindCite” (reference) ]
    Show Custom Dialog [ Message: "This view shows reference media (if there is any to show), and can slow down scrolling and other reference menu processes on slower computers and mobile devices."; Default Button: “OK”, Commit: “Yes” ]
    #from 2 to 1
    Else
    Go to Layout [ “learnFindCiteS” (reference) ]
    Show Custom Dialog [ Message: "This view hides any media (if there is any to hide), speeding up scrolling and other reference menu processes on slower computers and mobile devices."; Default Button: “OK”, Commit: “Yes” ]
    End If
    End If
    #
    Else If [ Left (Get (LayoutName) ; 1) = "r" and $$citationMatch = "key" ]
    #from 1 to 2
    If [ Right ( Get (LayoutName) ; 1) = 1 and Left ( TEMP::layoutRtagK ; 4 ) = "more" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “ReferenceMenu2SkeywordOrNode2” (tagMenus) ]
    Else
    Go to Layout [ “ReferenceMenu2keywordOrNode2” (tagMenus) ]
    End If
    #from 2 to 3
    Else If [ Right ( Get (LayoutName) ; 1) = 2 and Left ( TEMP::layoutRtagK ; 4 ) = "more" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “ReferenceMenu2SkeywordOrNode3” (tagMenus) ]
    Show Custom Dialog [ Message: "This view shows media (if there is any to show), and can slow down scrolling and other menu processes on slower computers and mobile devices."; Default Button: “OK”, Commit: “Yes” ]
    Else
    Go to Layout [ “ReferenceMenu2keywordOrNode3” (tagMenus) ]
    Show Custom Dialog [ Message: "This view shows media (if there is any to show), and can slow down scrolling and other menu processes on slower computers and mobile devices."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #from 3 to 4
    Else If [ Right ( Get (LayoutName) ; 1) = 3 and Left ( TEMP::layoutRtagK ; 4 ) = "more" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “ReferenceMenu2SkeywordOrNode4” (tagMenus) ]
    Else
    Go to Layout [ “ReferenceMenu2keywordOrNode4” (tagMenus) ]
    End If
    #from 4 to 5
    Else If [ Right ( Get (LayoutName) ; 1) = 4 and Left ( TEMP::layoutRtagK ; 4 ) = "more" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “ReferenceMenu2SkeywordOrNode5” (tagMenus) ]
    Else
    Go to Layout [ “ReferenceMenu2keywordOrNode5” (tagMenus) ]
    End If
    #from 5 to 4
    Else If [ Right ( Get (LayoutName) ; 1) = 5 and Left ( TEMP::layoutRtagK ; 4 ) = "less" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “ReferenceMenu2SkeywordOrNode4” (tagMenus) ]
    Else
    Go to Layout [ “ReferenceMenu2keywordOrNode4” (tagMenus) ]
    End If
    #from 4 to 3
    Else If [ Right ( Get (LayoutName) ; 1) = 4 and Left ( TEMP::layoutRtagK ; 4 ) = "less" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “ReferenceMenu2SkeywordOrNode3” (tagMenus) ]
    Else
    Go to Layout [ “ReferenceMenu2keywordOrNode3” (tagMenus) ]
    End If
    #from 3 to 2
    Else If [ Right ( Get (LayoutName) ; 1) = 3 and Left ( TEMP::layoutRtagK ; 4 ) = "less" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “ReferenceMenu2SkeywordOrNode2” (tagMenus) ]
    Show Custom Dialog [ Message: "This view hides media (if there is any to hide), and can speed up scrolling and other menu processes on slower computers and mobile devices."; Default Button: “OK”, Commit: “Yes” ]
    Else
    Go to Layout [ “ReferenceMenu2keywordOrNode2” (tagMenus) ]
    Show Custom Dialog [ Message: "This view hides media (if there is any to hide), and can speed up scrolling and other menu processes on slower computers and mobile devices."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #from 2 to 1
    Else If [ Right ( Get (LayoutName) ; 1) = 2 and Left ( TEMP::layoutRtagK ; 4 ) = "less" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “ReferenceMenu2SkeywordOrNode1” (tagMenus) ]
    Else
    Go to Layout [ “ReferenceMenu2keywordOrNode1” (tagMenus) ]
    End If
    End If
    #
    Else If [ Left (Get (LayoutName) ; 1) = "r" and $$citationMatch = "node" ]
    #from 1 to 2
    If [ Right ( Get (LayoutName) ; 1) = 1 and Left ( TEMP::layoutRtagN ; 4 ) = "more" ]
    Go to Layout [ “ReferenceMenu2keywordOrNode2” (tagMenus) ]
    #from 2 to 3
    Else If [ Right ( Get (LayoutName) ; 1) = 2 and Left ( TEMP::layoutRtagN ; 4 ) = "more" ]
    Go to Layout [ “ReferenceMenu2keywordOrNode3” (tagMenus) ]
    Show Custom Dialog [ Message: "This view shows media (if there is any to show), and can slow down scrolling and other menu processes on slower computers and mobile devices."; Default Button: “OK”, Commit: “Yes” ]
    #from 3 to 4
    Else If [ Right ( Get (LayoutName) ; 1) = 3 and Left ( TEMP::layoutRtagN ; 4 ) = "more" ]
    Go to Layout [ “ReferenceMenu2keywordOrNode4” (tagMenus) ]
    #from 4 to 5
    Else If [ Right ( Get (LayoutName) ; 1) = 4 and Left ( TEMP::layoutRtagN ; 4 ) = "more" ]
    Go to Layout [ “ReferenceMenu2keywordOrNode5” (tagMenus) ]
    #from 5 to 4
    Else If [ Right ( Get (LayoutName) ; 1) = 5 and Left ( TEMP::layoutRtagN ; 4 ) = "less" ]
    Go to Layout [ “ReferenceMenu2keywordOrNode4” (tagMenus) ]
    #from 4 to 3
    Else If [ Right ( Get (LayoutName) ; 1) = 4 and Left ( TEMP::layoutRtagN ; 4 ) = "less" ]
    Go to Layout [ “ReferenceMenu2keywordOrNode3” (tagMenus) ]
    #from 3 to 2
    Else If [ Right ( Get (LayoutName) ; 1) = 3 and Left ( TEMP::layoutRtagN ; 4 ) = "less" ]
    Go to Layout [ “ReferenceMenu2keywordOrNode2” (tagMenus) ]
    Show Custom Dialog [ Message: "This view hides media (if there is any to hide), and can speed up scrolling and other menu processes on slower computers and mobile devices."; Default Button: “OK”, Commit: “Yes” ]
    #from 2 to 1
    Else If [ Right ( Get (LayoutName) ; 1) = 2 and Left ( TEMP::layoutRtagN ; 4 ) = "less" ]
    Go to Layout [ “ReferenceMenu2keywordOrNode1” (tagMenus) ]
    End If
    #
    Else If [ Left (Get (LayoutName) ; 1) = "d" ]
    #from 1 to 2
    If [ Right ( Get (LayoutName) ; 1) = 1 and Left ( TEMP::DefaultmoreORLessLayoutNode ; 4 ) = "more" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “defaultNodeS2” (tagMenus) ]
    Else
    Go to Layout [ “defaultNode2” (tagMenus) ]
    End If
    If [ TEMP::InventoryLibraryYN = "" ]
    Show Custom Dialog [ Message: "This view shows media (if there is any to show), and can slow down scrolling and other menu processes on slower computers and mobile devices."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #from 2 to 3
    Else If [ Left (Get (LayoutName) ; 1) = "d" and Right ( Get (LayoutName) ; 1) = 2 and Left ( TEMP::DefaultmoreORLessLayoutNode ; 4 ) = "more" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “defaultNodeS3” (tagMenus) ]
    Else
    Go to Layout [ “defaultNode3” (tagMenus) ]
    End If
    #from 3 to 4
    Else If [ Left (Get (LayoutName) ; 1) = "d" and Right ( Get (LayoutName) ; 1) = 3 and Left ( TEMP::DefaultmoreORLessLayoutNode ; 4 ) = "more" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “defaultNodeS4” (tagMenus) ]
    Else
    Go to Layout [ “defaultNode4” (tagMenus) ]
    End If
    #from 4 to 3
    Else If [ Left (Get (LayoutName) ; 1) = "d" and Right ( Get (LayoutName) ; 1) = 4 and Left ( TEMP::DefaultmoreORLessLayoutNode ; 4 ) = "less" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “defaultNodeS3” (tagMenus) ]
    Else
    Go to Layout [ “defaultNode3” (tagMenus) ]
    End If
    #from 3 to 2
    Else If [ Left (Get (LayoutName) ; 1) = "d" and Right ( Get (LayoutName) ; 1) = 3 and Left ( TEMP::DefaultmoreORLessLayoutNode ; 4 ) = "less" ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “defaultNodeS2” (tagMenus) ]
    Else
    Go to Layout [ “defaultNode2” (tagMenus) ]
    End If
    #from 2 to 1
    Else If [ Left (Get (LayoutName) ; 1) = "d" and Right ( Get (LayoutName) ; 1) = 2 and Left ( TEMP::DefaultmoreORLessLayoutNode ; 4 ) = "less" ]
    Go to Layout [ “defaultNode1” (tagMenus) ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Show Custom Dialog [ Message: "This view hides media (if there is any to hide), and can speed up scrolling and other menu processes on slower computers and mobile devices."; Default Button: “OK”, Commit: “Yes” ]
    End If
    End If
    #
    #
    Else If [ $$citationMatch = "cite" and Get (LayoutTableName) = "reference" ]
    #
    #If not in find mode, so on regular tag layout...
    If [ $$findMode = "" ]
    #from 1 to 2
    If [ Get (LayoutName) = "ReferenceMenu3CiteNoPicture" ]
    Go to Layout [ “ReferenceMenu3Cite” (reference) ]
    Show Custom Dialog [ Message: "This view shows media (if there is any to show), and can slow down scrolling and other menu processes on slower computers and mobile devices."; Default Button: “OK”, Commit: “Yes” ]
    #from 2 to 1
    Else
    Set Field [ TEMP::layoutLtagL; Get (LayoutName) = "ReferenceMenu3CiteNoPicture" ]
    Go to Layout [ “ReferenceMenu3CiteNoPicture” (reference) ]
    Show Custom Dialog [ Message: "This view hides media (if there is any to hide), and can speed up scrolling and other menu processes on slower computers and mobile devices."; Default Button: “OK”, Commit: “Yes” ]
    End If
    End If
    #
    #If in find mode, so on a find layout...
    If [ $$findMode ≠ "" ]
    #from 1 to 2
    If [ Left ( TEMP::layoutRtagCiteFIND ; 4 ) = "more" ]
    Go to Layout [ “ReferenceMenu3CiteFind” (reference) ]
    Show Custom Dialog [ Message: "This view shows reference media (if there is any to show), and can slow down scrolling and other reference menu processes on slower computers and mobile devices."; Default Button: “OK”, Commit: “Yes” ]
    #from 2 to 1
    Else
    Go to Layout [ “ReferenceMenu3CiteFindS” (reference) ]
    Show Custom Dialog [ Message: "This view hides any media (if there is any to hide), speeding up scrolling and other reference menu processes on slower computers and mobile devices."; Default Button: “OK”, Commit: “Yes” ]
    End If
    End If
    End If
    #
    #
    #
    #
    #Remember layout user is on so they can be
    #returned to correct view.
    If [ $$citationMatch = "node" ]
    If [ Left (Get (LayoutName) ; 1) = "l" ]
    #
    #from 1 to 2
    If [ Right ( Get (LayoutName) ; 1) = 2 and Left ( TEMP::layoutLtagN ; 4 ) = "more" ]
    Set Field [ TEMP::layoutLtagN; "more" & Get (LayoutName) ]
    #from 2 to 3
    Else If [ Right ( Get (LayoutName) ; 1) = 3 and Left ( TEMP::layoutLtagN ; 4 ) = "more" ]
    Set Field [ TEMP::layoutLtagN; "more" & Get (LayoutName) ]
    #from 3 to 4
    Else If [ Right ( Get (LayoutName) ; 1) = 4 and Left ( TEMP::layoutLtagN ; 4 ) = "more" ]
    Set Field [ TEMP::layoutLtagN; "more" & Get (LayoutName) ]
    #from 4 to 5
    Else If [ Right ( Get (LayoutName) ; 1) = 5 and Left ( TEMP::layoutLtagN ; 4 ) = "more" ]
    Set Field [ TEMP::layoutLtagN; "less" & Get (LayoutName) ]
    #from 5 to 4
    Else If [ Right ( Get (LayoutName) ; 1) = 4 and Left ( TEMP::layoutLtagN ; 4 ) = "less" ]
    Set Field [ TEMP::layoutLtagN; "less" & Get (LayoutName) ]
    #from 4 to 3
    Else If [ Right ( Get (LayoutName) ; 1) = 3 and Left ( TEMP::layoutLtagN ; 4 ) = "less" ]
    Set Field [ TEMP::layoutLtagN; "less" & Get (LayoutName) ]
    #from 3 to 2
    Else If [ Right ( Get (LayoutName) ; 1) = 2 and Left ( TEMP::layoutLtagN ; 4 ) = "less" ]
    Set Field [ TEMP::layoutLtagN; "less" & Get (LayoutName) ]
    #from 2 to 1
    Else If [ Right ( Get (LayoutName) ; 1) = 1 and Left ( TEMP::layoutLtagN ; 4 ) = "less" ]
    Set Field [ TEMP::layoutLtagN; "more" & Get (LayoutName) ]
    End If
    #
    Else If [ Left (Get (LayoutName) ; 1) = "r" ]
    #
    #from 1 to 2
    If [ Right ( Get (LayoutName) ; 1) = 2 and Left ( TEMP::layoutRtagN ; 4 ) = "more" ]
    Set Field [ TEMP::layoutRtagN; "more" & Get (LayoutName) ]
    #from 2 to 3
    Else If [ Right ( Get (LayoutName) ; 1) = 3 and Left ( TEMP::layoutRtagN ; 4 ) = "more" ]
    Set Field [ TEMP::layoutRtagN; "more" & Get (LayoutName) ]
    #from 3 to 4
    Else If [ Right ( Get (LayoutName) ; 1) = 4 and Left ( TEMP::layoutRtagN ; 4 ) = "more" ]
    Set Field [ TEMP::layoutRtagN; "more" & Get (LayoutName) ]
    #from 4 to 5
    Else If [ Right ( Get (LayoutName) ; 1) = 5 and Left ( TEMP::layoutRtagN ; 4 ) = "more" ]
    Set Field [ TEMP::layoutRtagN; "less" & Get (LayoutName) ]
    #from 5 to 4
    Else If [ Right ( Get (LayoutName) ; 1) = 4 and Left ( TEMP::layoutRtagN ; 4 ) = "less" ]
    Set Field [ TEMP::layoutRtagN; "less" & Get (LayoutName) ]
    #from 4 to 3
    Else If [ Right ( Get (LayoutName) ; 1) = 3 and Left ( TEMP::layoutRtagN ; 4 ) = "less" ]
    Set Field [ TEMP::layoutRtagN; "less" & Get (LayoutName) ]
    #from 3 to 2
    Else If [ Right ( Get (LayoutName) ; 1) = 2 and Left ( TEMP::layoutRtagN ; 4 ) = "less" ]
    Set Field [ TEMP::layoutRtagN; "less" & Get (LayoutName) ]
    #from 2 to 1
    Else If [ Right ( Get (LayoutName) ; 1) = 1 and Left ( TEMP::layoutRtagN ; 4 ) = "less" ]
    Set Field [ TEMP::layoutRtagN; "more" & Get (LayoutName) ]
    End If
    #
    Else If [ Left (Get (LayoutName) ; 1) = "d" ]
    #from 1 to 2
    If [ Right ( Get (LayoutName) ; 1) = 2 and Left ( TEMP::DefaultmoreORLessLayoutNode ; 4 ) = "more" ]
    Set Field [ TEMP::DefaultmoreORLessLayoutNode; "more" & Get (LayoutName) ]
    #from 2 to 3
    Else If [ Right ( Get (LayoutName) ; 1) = 3 and Left ( TEMP::DefaultmoreORLessLayoutNode ; 4 ) = "more" ]
    Set Field [ TEMP::DefaultmoreORLessLayoutNode; "more" & Get (LayoutName) ]
    #from 3 to 4
    Else If [ Right ( Get (LayoutName) ; 1) = 4 and Left ( TEMP::DefaultmoreORLessLayoutNode ; 4 ) = "more" ]
    Set Field [ TEMP::DefaultmoreORLessLayoutNode; "less" & Get (LayoutName) ]
    #from 4 to 3
    Else If [ Right ( Get (LayoutName) ; 1) = 3 and Left ( TEMP::DefaultmoreORLessLayoutNode ; 4 ) = "less" ]
    Set Field [ TEMP::DefaultmoreORLessLayoutNode; "less" & Get (LayoutName) ]
    #from 3 to 2
    Else If [ Right ( Get (LayoutName) ; 1) = 2 and Left ( TEMP::DefaultmoreORLessLayoutNode ; 4 ) = "less" ]
    Set Field [ TEMP::DefaultmoreORLessLayoutNode; "less" & Get (LayoutName) ]
    #from 2 to 1
    Else If [ Right ( Get (LayoutName) ; 1) = 1 and Left ( TEMP::DefaultmoreORLessLayoutNode ; 4 ) = "less" ]
    Set Field [ TEMP::DefaultmoreORLessLayoutNode; "more" & Get (LayoutName) ]
    End If
    End If
    #
    #
    Else If [ $$citationMatch = "key" ]
    If [ Left (Get (LayoutName) ; 1) = "l" ]
    #
    #from 1 to 2
    If [ Right ( Get (LayoutName) ; 1) = 2 and Left ( TEMP::layoutLtagK ; 4 ) = "more" ]
    Set Field [ TEMP::layoutLtagK; "more" & Get (LayoutName) ]
    #from 2 to 3
    Else If [ Right ( Get (LayoutName) ; 1) = 3 and Left ( TEMP::layoutLtagK ; 4 ) = "more" ]
    Set Field [ TEMP::layoutLtagK; "more" & Get (LayoutName) ]
    #from 3 to 4
    Else If [ Right ( Get (LayoutName) ; 1) = 4 and Left ( TEMP::layoutLtagK ; 4 ) = "more" ]
    Set Field [ TEMP::layoutLtagK; "more" & Get (LayoutName) ]
    #from 4 to 5
    Else If [ Right ( Get (LayoutName) ; 1) = 5 and Left ( TEMP::layoutLtagK ; 4 ) = "more" ]
    Set Field [ TEMP::layoutLtagK; "less" & Get (LayoutName) ]
    #from 5 to 4
    Else If [ Right ( Get (LayoutName) ; 1) = 4 and Left ( TEMP::layoutLtagK ; 4 ) = "less" ]
    Set Field [ TEMP::layoutLtagK; "less" & Get (LayoutName) ]
    #from 4 to 3
    Else If [ Right ( Get (LayoutName) ; 1) = 3 and Left ( TEMP::layoutLtagK ; 4 ) = "less" ]
    Set Field [ TEMP::layoutLtagK; "less" & Get (LayoutName) ]
    #from 3 to 2
    Else If [ Right ( Get (LayoutName) ; 1) = 2 and Left ( TEMP::layoutLtagK ; 4 ) = "less" ]
    Set Field [ TEMP::layoutLtagK; "less" & Get (LayoutName) ]
    #from 2 to 1
    Else If [ Right ( Get (LayoutName) ; 1) = 1 and Left ( TEMP::layoutLtagK ; 4 ) = "less" ]
    Set Field [ TEMP::layoutLtagK; "more" & Get (LayoutName) ]
    End If
    #
    Else If [ Left (Get (LayoutName) ; 1) = "r" ]
    #
    #from 1 to 2
    If [ Right ( Get (LayoutName) ; 1) = 2 and Left ( TEMP::layoutRtagK ; 4 ) = "more" ]
    Set Field [ TEMP::layoutRtagK; "more" & Get (LayoutName) ]
    #from 2 to 3
    Else If [ Right ( Get (LayoutName) ; 1) = 3 and Left ( TEMP::layoutRtagK ; 4 ) = "more" ]
    Set Field [ TEMP::layoutRtagK; "more" & Get (LayoutName) ]
    #from 3 to 4
    Else If [ Right ( Get (LayoutName) ; 1) = 4 and Left ( TEMP::layoutRtagK ; 4 ) = "more" ]
    Set Field [ TEMP::layoutRtagK; "more" & Get (LayoutName) ]
    #from 4 to 5
    Else If [ Right ( Get (LayoutName) ; 1) = 5 and Left ( TEMP::layoutRtagK ; 4 ) = "more" ]
    Set Field [ TEMP::layoutRtagK; "less" & Get (LayoutName) ]
    #from 5 to 4
    Else If [ Right ( Get (LayoutName) ; 1) = 4 and Left ( TEMP::layoutRtagK ; 4 ) = "less" ]
    Set Field [ TEMP::layoutRtagK; "less" & Get (LayoutName) ]
    #from 4 to 3
    Else If [ Right ( Get (LayoutName) ; 1) = 3 and Left ( TEMP::layoutRtagK ; 4 ) = "less" ]
    Set Field [ TEMP::layoutRtagK; "less" & Get (LayoutName) ]
    #from 3 to 2
    Else If [ Right ( Get (LayoutName) ; 1) = 2 and Left ( TEMP::layoutRtagK ; 4 ) = "less" ]
    Set Field [ TEMP::layoutRtagK; "less" & Get (LayoutName) ]
    #from 2 to 1
    Else If [ Right ( Get (LayoutName) ; 1) = 1 and Left ( TEMP::layoutRtagK ; 4 ) = "less" ]
    Set Field [ TEMP::layoutRtagK; "more" & Get (LayoutName) ]
    End If
    #
    End If
    #
    #
    Else If [ $$citationMatch = "learn" and Get (LayoutTableName) = "testLearn" ]
    If [ Left (Get (LayoutName) ; 1) = "l" ]
    #
    #If not in find mode, so on regular tag layout...
    If [ $$findMode = "" ]
    #from 1 to 2
    If [ Left ( TEMP::layoutLtagL ; 4 ) = "more" ]
    Set Field [ TEMP::layoutLtagL; "less" & Get (LayoutName) ]
    #from 2 to 1
    Else
    Set Field [ TEMP::layoutLtagL; "more" & Get (LayoutName) ]
    End If
    End If
    #
    #
    #If in find mode, so on a find layout...
    If [ $$findMode ≠ "" ]
    #from 1 to 2
    If [ Left ( TEMP::layoutLtagLFIND ; 4 ) = "more" ]
    Set Field [ TEMP::layoutLtagLFIND; "less" & Get (LayoutName) ]
    #from 2 to 1
    Else
    Set Field [ TEMP::layoutLtagLFIND; "more" & Get (LayoutName) ]
    End If
    End If
    #
    End If
    #
    #
    Else If [ $$citationMatch = "ref" ]
    If [ Left (Get (LayoutName) ; 1) = "l" ]
    #
    #If not in find mode, so on regular tag layout...
    If [ $$findMode = "" ]
    #from 1 to 2
    If [ Left ( TEMP::layoutLtagR ; 4 ) = "more" ]
    Set Field [ TEMP::layoutLtagR; "less" & Get (LayoutName) ]
    #from 2 to 1
    Else
    Set Field [ TEMP::layoutLtagR; "more" & Get (LayoutName) ]
    End If
    End If
    #
    #If in find mode, so on a find layout...
    If [ $$findMode ≠ "" ]
    #from 1 to 2
    If [ Left ( TEMP::layoutLtagRFIND ; 4 ) = "more" ]
    Set Field [ TEMP::layoutLtagRFIND; "less" & Get (LayoutName) ]
    #from 2 to 1
    Else
    Set Field [ TEMP::layoutLtagRFIND; "more" & Get (LayoutName) ]
    End If
    End If
    #
    End If
    #
    #
    Else If [ $$citationMatch = "cite" ]
    If [ Left (Get (LayoutName) ; 1) = "r" ]
    #
    #If not in find mode, so on regular tag layout...
    If [ $$findMode = "" ]
    #from 1 to 2
    If [ Left ( TEMP::layoutLtagR ; 4 ) = "more" ]
    Set Field [ TEMP::layoutRtagCite; "less" & Get (LayoutName) ]
    #from 2 to 1
    Else
    Set Field [ TEMP::layoutRtagCite; "more" & Get (LayoutName) ]
    End If
    End If
    #
    #If in find mode, so on a find layout...
    If [ $$findMode ≠ "" ]
    #from 1 to 2
    If [ Left ( TEMP::layoutRtagCiteFIND ; 4 ) = "more" ]
    Set Field [ TEMP::layoutRtagCiteFIND; "less" & Get (LayoutName) ]
    #from 2 to 1
    Else
    Set Field [ TEMP::layoutRtagCiteFIND; "more" & Get (LayoutName) ]
    End If
    End If
    #
    End If
    #
    #
    End If
    #
    #Turn back on essential scripts.
    Set Variable [ $$stopLoadTagRecord ]
    Set Variable [ $$stopLockCheck ]
    #
    #Bring selected record to the top.
    Scroll Window [ End ]
    Sort Records [ ] [ No dialog ]
    #

Fields used in this script

    TEMP::layoutLtagK
    TEMP::layoutLtagN
    TEMP::InventoryLibraryYN
    TEMP::layoutLtagL
    TEMP::layoutLtagLFIND
    TEMP::layoutLtagR
    TEMP::layoutLtagRFIND
    TEMP::layoutRtagK
    TEMP::layoutRtagN
    TEMP::DefaultmoreORLessLayoutNode
    TEMP::layoutRtagCiteFIND
    TEMP::layoutRtagCite

Scripts used in this script

Layouts used in this script

    ltagNK2
    ltagNK3
    ltagNK4
    ltagNK5
    ltagNK1
    ltagNKs2
    ltagNKs3
    ltagNKs5
    ltagNKs4
    ltagNKs1
    learnMenu4RefCite
    learnMenu4noPicRefCite
    learnMenu4RefCiteFindTL
    learnMenu4NoPicRefCiteFindTL
    learnMenu3Cite
    learnMenu3CiteS
    learnFindCite
    learnFindCiteS
    ReferenceMenu2SkeywordOrNode2
    ReferenceMenu2keywordOrNode2
    ReferenceMenu2SkeywordOrNode3
    ReferenceMenu2keywordOrNode3
    ReferenceMenu2SkeywordOrNode4
    ReferenceMenu2keywordOrNode4
    ReferenceMenu2SkeywordOrNode5
    ReferenceMenu2keywordOrNode5
    ReferenceMenu2SkeywordOrNode1
    ReferenceMenu2keywordOrNode1
    defaultNodeS2
    defaultNode2
    defaultNodeS3
    defaultNode3
    defaultNodeS4
    defaultNode4
    defaultNode1
    ReferenceMenu3Cite
    ReferenceMenu3CiteNoPicture
    ReferenceMenu3CiteFind
    ReferenceMenu3CiteFindS

Tables used in this script

    TEMP

Table occurrences used by this script

    TEMP

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [toggleTagMenuWindowView]	Parent Folder: [tagMenu]	Next Script: [zoomSetup]
Script Name	unzoomSetup
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    Move/Resize Window [ Current Window; Height: Get (ScreenHeight); Width: 700; Top: 0; Left: 0 ]
    Set Variable [ $left; Value:Get ( WindowLeft ) ]
    Set Variable [ $width; Value:Get ( WindowWidth) ]
    Set Zoom Level [ 100%; Camera: Back; Resolution: Full ]
    Select Window [ Name: "Tag Menus"; Current file ]
    If [ Get (LastError) = 112 ]
    New Window [ Name: "Tag Menus"; Width: 333; Left: 0; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “setupTestSection” (testSection) ]
    End If
    Set Zoom Level [ 100%; Camera: Back; Resolution: Full ]
    Move/Resize Window [ Current Window; Height: Get (ScreenHeight); Width: 333; Top: 0; Left: If ( $left + $width + 333 > Get ( ScreenWidth ) ; Get ( ScreenWidth ) - 333 ; $left + $width ) ]
    Select Window [ Name: "Setup"; Current file ]

Fields used in this script

Scripts used in this script

Layouts used in this script

    setupTestSection

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [unzoomSetup]	Parent Folder: [tagMenu]
Script Name	zoomSetup
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    Move/Resize Window [ Current Window; Height: Get (ScreenHeight); Width: 700; Top: 0; Left: 0 ]
    Set Variable [ $left; Value:Get ( WindowLeft ) ]
    Set Variable [ $width; Value:Get ( WindowWidth) ]
    Set Zoom Level [ 150% ]
    Select Window [ Name: "Tag Menus"; Current file ]
    If [ Get (LastError) = 112 ]
    New Window [ Name: "Tag Menus"; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “setupTestSection” (testSection) ]
    End If
    Set Zoom Level [ 150% ]
    Move/Resize Window [ Current Window; Height: Get (ScreenHeight); Width: 490; Top: 0; Left: If ( $left + $width > Get ( ScreenWidth ) - 490; Get ( ScreenWidth ) - 490 ; $left + $width ) ]
    Select Window [ Name: "Setup"; Current file ]

Fields used in this script

Scripts used in this script

Layouts used in this script

    setupTestSection

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


menuFind
	Parent Folder: [menuFind]	Next Script: [menuCitationFind]
Script Name	menuBrainstormFind
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    learnFind
    learnSFind
    learnKeywordOrNodeFind
    learnKeywordOrNodeSFind
    learnFindTest
    learnFindSTest
    learnFindBrainstorm
    learnFindStuffBrainstorm
    learnFindCite
    learnFindCiteS
    learnFindStuffCite
    learnMenu4NoPicRefCiteFindTL
    learnMenu4RefCiteFindTL
    learnMenu4RefStuffCiteFindTL

Scripts that use this script

Script Definition
Script Steps

    #
    #Set citationMatch to color menu button with inUse color.
    Set Variable [ $$citationMatch; Value:"brainstorm" ]
    #
    #Goto correct layout.
    If [ Left (Get (LayoutName) ; 1) = "l" ]
    Go to Layout [ “learnFindBrainstorm” (tagMenus) ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “learnFindStuffBrainstorm” (tagMenus) ]
    End If
    Else If [ Left (Get (LayoutName) ; 1) = "r" ]
    Go to Layout [ “learnFindBrainstorm” (tagMenus) ]
    End If
    #
    #Find brainstorm tags.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Enter Find Mode [ ]
    Set Field [ tagMenus::match; $$citationMatch ]
    Perform Find [ ]
    #
    #Sort into groups.
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::tag; ascending ] [ Restore; No dialog ]
    #
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    Set Variable [ $$stopLoadTagRecord ]

Fields used in this script

    TEMP::InventoryLibraryYN
    tagMenus::match
    tagMenuGroup::orderOrLibraryType
    tagMenuGroup::name
    tagMenus::tag

Scripts used in this script

Layouts used in this script

    learnFindBrainstorm
    learnFindStuffBrainstorm

Tables used in this script

    TEMP
    tag
    tagGroup

Table occurrences used by this script

    TEMP
    tagMenuGroup
    tagMenus

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [menuBrainstormFind]	Parent Folder: [menuFind]	Next Script: [menuCopyrightFind]
Script Name	menuCitationFind
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferenceMenuFind
    ReferenceMenu3CiteFind
    ReferenceMenu3CiteFindS
    ReferenceMenu2keywordOrNodeFind

Scripts that use this script

Script Definition
Script Steps

    #
    #Set citationMatch to color menu button with inUse color.
    Set Variable [ $$citationMatch; Value:"cite" ]
    Set Variable [ $$stoploadCitation; Value:1 ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Freeze Window
    #
    #Set testlearn internal reference field conditional
    #formatting to transparent.
    Set Variable [ $$internal ]
    #
    #
    #If no layout preference is set, then on iDevices
    #go the layout with no pictures, and to the
    #layout with pictures on desktop computers.
    If [ TEMP::layoutRtagCiteFIND = "" ]
    If [ Get (SystemPlatform) = 3 ]
    Go to Layout [ “ReferenceMenu3CiteFindS” (reference) ]
    Set Field [ TEMP::layoutRtagCiteFIND; "more" & Get (LayoutName) ]
    Else
    Go to Layout [ “ReferenceMenu3CiteFind” (reference) ]
    Set Field [ TEMP::layoutRtagCiteFIND; "less" & Get (LayoutName) ]
    End If
    Else
    #
    #Go the layout the user has selected.
    Go to Layout [ Middle ( TEMP::layoutRtagCiteFIND ; 5 ; 42 ) ]
    End If
    #
    #
    #Find references for reference module.
    Show All Records
    #
    #Omit locked records, which are the copyright
    #images used by default copyright tags.
    Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: reference::lock: “lock” ] [ Restore ]
    #
    #Sort and go to the first record. Due to bugs,
    #two sorts are required to get to the
    #first record.
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::date; descending testlearn::timestamp; descending ] [ Restore; No dialog ]
    If [ TEMP::InventoryLibraryYN = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagKeywordPrimary::orderOrLock; based on value list: “order Pulldown List” tagKeywordPrimary::tag; ascending reference::referenceShort; ascending ] [ Restore; No dialog ]
    Else
    #There is no cite menu for inventory libraries,
    #so no need to perform a sort.
    End If
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    Set Variable [ $$stoploadCitation ]
    #
    #Go to citation record's current selection or to first record.
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    #
    Set Variable [ $$stoploadCitation ]
    Set Variable [ $$stopLoadTagRecord ]
    #

Fields used in this script

    TEMP::layoutRtagCiteFIND
    reference::lock
    testlearn::date
    testlearn::timestamp
    TEMP::InventoryLibraryYN
    tagKeywordPrimary::orderOrLock
    tagKeywordPrimary::tag
    reference::referenceShort

Scripts used in this script

Layouts used in this script

    ReferenceMenu3CiteFindS
    ReferenceMenu3CiteFind

Tables used in this script

    TEMP
    reference
    tag
    testlearn

Table occurrences used by this script

    TEMP
    reference
    tagKeywordPrimary
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [menuCitationFind]	Parent Folder: [menuFind]	Next Script: [menuKeyFind]
Script Name	menuCopyrightFind
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferenceMenuFind
    ReferenceMenu3CiteFind
    ReferenceMenu3CiteFindS
    ReferenceMenu2keywordOrNodeFind

Scripts that use this script

Script Definition
Script Steps

    #
    #Set citationMatch to color menu button with inUse color.
    Set Variable [ $$citationMatch; Value:"copyright" ]
    #
    #Goto correct layout.
    If [ Left (Get (LayoutName) ; 1) = "l" ]
    Go to Layout [ “learnFind” (tagMenus) ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “learnSFind” (tagMenus) ]
    End If
    Else If [ Left (Get (LayoutName) ; 1) = "r" ]
    Go to Layout [ “ReferenceMenuFind” (tagMenus) ]
    End If
    #
    #Find Permission tags. Permission tags are available to all library sections.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Enter Find Mode [ ]
    Set Field [ tagMenus::match; $$citationMatch ]
    Perform Find [ ]
    #
    #Sort according to current users wishes.
    If [ TEMP::sortCopyright = "cat" or TEMP::sortCopyright = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    Else If [ TEMP::sortCopyright = "abc" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenus::tag; ascending ] [ Restore; No dialog ]
    End If
    #
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    Set Variable [ $$stopLoadTagRecord ]
    #

Fields used in this script

    TEMP::InventoryLibraryYN
    tagMenus::match
    TEMP::sortCopyright
    tagMenuGroup::orderOrLibraryType
    tagMenuGroup::name
    tagMenus::orderOrLock
    tagMenus::tag

Scripts used in this script

Layouts used in this script

    learnFind
    learnSFind
    ReferenceMenuFind

Tables used in this script

    TEMP
    tag
    tagGroup

Table occurrences used by this script

    TEMP
    tagMenuGroup
    tagMenus

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [menuCopyrightFind]	Parent Folder: [menuFind]	Next Script: [menuLearnFind]
Script Name	menuKeyFind
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferenceMenuFind
    ReferenceMenu3CiteFind
    ReferenceMenu3CiteFindS
    ReferenceMenu2keywordOrNodeFind
    ReferenceMenu2SkeywordOrNodeFind
    learnFind
    learnKeywordOrNodeFind
    learnFindTest
    learnFindBrainstorm
    learnFindCite
    learnFindCiteS
    learnMenu4NoPicRefCiteFindTL
    learnMenu4RefCiteFindTL

Scripts that use this script

Script Definition
Script Steps

    #
    #Set citationMatch to color menu button with inUse color.
    Set Variable [ $$citationMatch; Value:"key" ]
    #
    #Do not load tag records until the end of script
    #to prevent flashing of window and to speed up
    #script.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    #
    #Goto correct layout.
    If [ Left (Get (LayoutName) ; 1) = "l" ]
    Go to Layout [ “learnKeywordOrNodeFind” (tagMenus) ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “learnKeywordOrNodeSFind” (tagMenus) ]
    End If
    Else If [ Left (Get (LayoutName) ; 1) = "r" ]
    Go to Layout [ “ReferenceMenu2keywordOrNodeFind” (tagMenus) ]
    End If
    #
    #Find key tags for library section.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Enter Find Mode [ ]
    Set Field [ tagMenus::match; $$citationMatch ]
    Perform Find [ ]
    #
    #Sort according to current users wishes.
    If [ TEMP::sortKey = "cat" or TEMP::sortKey = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    Else If [ TEMP::sortKey = "abc" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenus::tag; ascending ] [ Restore; No dialog ]
    End If
    #
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    Set Variable [ $$stopLoadTagRecord ]

Fields used in this script

    TEMP::InventoryLibraryYN
    tagMenus::match
    TEMP::sortKey
    tagMenuGroup::orderOrLibraryType
    tagMenuGroup::name
    tagMenus::orderOrLock
    tagMenus::tag

Scripts used in this script

Layouts used in this script

    learnKeywordOrNodeFind
    learnKeywordOrNodeSFind
    ReferenceMenu2keywordOrNodeFind

Tables used in this script

    TEMP
    tag
    tagGroup

Table occurrences used by this script

    TEMP
    tagMenuGroup
    tagMenus

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [menuKeyFind]	Parent Folder: [menuFind]	Next Script: [menuMediumFind]
Script Name	menuLearnFind
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    learnFind
    learnSFind
    learnKeywordOrNodeFind
    learnFindTest
    learnFindSTest
    learnFindBrainstorm
    learnFindCite
    learnFindCiteS
    learnMenu4NoPicRefCiteFindTL
    learnMenu4RefCiteFindTL
    learnMenu4RefStuffCiteFindTL

Scripts that use this script

Script Definition
Script Steps

    #
    #Set citationMatch to color menu button with inUse color.
    Set Variable [ $$citationMatch; Value:"learn" ]
    #
    #Set testlearn internal reference field conditional
    #formatting to transparent.
    Set Variable [ $$internal ]
    #
    #
    #Go to layout with no pictures.
    Go to Layout [ “learnMenu4NoPicRefCiteFindTL” (testlearn) ]
    #
    #
    #Find learn records that can be referenced.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    Enter Find Mode [ ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Set Field [ testlearn::brainstormCasePoint; "1" ]
    Else
    Set Field [ testlearn::filterFind; "main" ]
    End If
    Perform Find [ ]
    #
    #Go to correct layout.
    If [ TEMP::InventoryLibraryYN = "" ]
    #Idea Mode
    #
    If [ TEMP::layoutLtagLFIND = "" ]
    #If no layout preference is set, then on iDevices
    #go the layout with no pictures, and to the
    #layout with pictures on desktop computers.
    If [ Get (SystemPlatform) = 3 ]
    Go to Layout [ “learnMenu4NoPicRefCiteFindTL” (testlearn) ]
    Set Field [ TEMP::layoutLtagLFIND; "more" & Get (LayoutName) ]
    Else
    Go to Layout [ “learnMenu4RefCiteFindTL” (testlearn) ]
    Set Field [ TEMP::layoutLtagLFIND; "less" & Get (LayoutName) ]
    End If
    Else
    #
    #Go the layout the user has selected.
    Go to Layout [ Middle ( TEMP::layoutLtagLFIND ; 5 ; 42 ) ]
    End If
    #
    Else
    #Inventory Mode
    #
    #Go the layout the user has selected.
    Go to Layout [ “learnMenu4RefStuffCiteFindTL” (testlearn) ]
    End If
    #
    #Sort records.
    If [ TEMP::InventoryLibraryYN = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::date; descending testlearn::timestamp; descending ] [ Restore; No dialog ]
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::concatenateSTUFFcontainer; ascending ] [ Restore; No dialog ]
    End If
    #
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    Set Variable [ $$stopLoadTagRecord ]
    #

Fields used in this script

    TEMP::InventoryLibraryYN
    testlearn::brainstormCasePoint
    testlearn::filterFind
    TEMP::layoutLtagLFIND
    testlearn::date
    testlearn::timestamp
    testlearn::concatenateSTUFFcontainer

Scripts used in this script

Layouts used in this script

    learnMenu4NoPicRefCiteFindTL
    learnMenu4RefCiteFindTL
    <Missing Layout>
    learnMenu4RefStuffCiteFindTL

Tables used in this script

    TEMP
    testlearn

Table occurrences used by this script

    TEMP
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [menuLearnFind]	Parent Folder: [menuFind]	Next Script: [menuNodeFind]
Script Name	menuMediumFind
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #Set citationMatch to color menu button with inUse color.
    Set Variable [ $$citationMatch; Value:"medium" ]
    #
    #Do not load tag records until the end of script
    #to prevent flashing of window and to speed up
    #script.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    #
    #Goto correct layout.
    If [ Left (Get (LayoutName) ; 1) = "l" ]
    Go to Layout [ “learnFind” (tagMenus) ]
    Else If [ Left (Get (LayoutName) ; 1) = "r" ]
    Go to Layout [ “ReferenceMenuFind” (tagMenus) ]
    End If
    #
    #Find medium tags. Medium tags are available to all library sections.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Enter Find Mode [ ]
    Set Field [ tagMenus::match; $$citationMatch ]
    Perform Find [ ]
    #
    #Sort according to current users wishes.
    If [ TEMP::sortMedium = "cat" or TEMP::sortMedium = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    Else If [ TEMP::sortMedium = "abc" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenus::tag; ascending ] [ Restore; No dialog ]
    End If
    #
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    Set Variable [ $$stopLoadTagRecord ]

Fields used in this script

    tagMenus::match
    TEMP::sortMedium
    tagMenuGroup::orderOrLibraryType
    tagMenuGroup::name
    tagMenus::orderOrLock
    tagMenus::tag

Scripts used in this script

Layouts used in this script

    learnFind
    ReferenceMenuFind

Tables used in this script

    TEMP
    tag
    tagGroup

Table occurrences used by this script

    TEMP
    tagMenuGroup
    tagMenus

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [menuMediumFind]	Parent Folder: [menuFind]	Next Script: [menuPathFind]
Script Name	menuNodeFind
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferenceMenuFind
    ReferenceMenu3CiteFind
    ReferenceMenu3CiteFindS
    ReferenceMenu2keywordOrNodeFind
    learnFind
    learnSFind
    learnKeywordOrNodeFind
    learnKeywordOrNodeSFind
    learnFindTest
    learnFindSTest
    learnFindBrainstorm
    learnFindStuffBrainstorm
    learnFindCite
    learnFindCiteS
    learnFindStuffCite
    learnMenu4NoPicRefCiteFindTL
    learnMenu4RefCiteFindTL
    learnMenu4RefStuffCiteFindTL

Scripts that use this script

Script Definition
Script Steps

    #
    #Set citationMatch to color menu button with inUse color.
    Set Variable [ $$citationMatch; Value:"node" ]
    #
    #Do not load tag records until the end of script
    #to prevent flashing of window and to speed up
    #script.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    #
    #Goto correct layout.
    If [ Left (Get (LayoutName) ; 1) = "l" ]
    Go to Layout [ “learnKeywordOrNodeFind” (tagMenus) ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “learnKeywordOrNodeSFind” (tagMenus) ]
    End If
    Else If [ Left (Get (LayoutName) ; 1) = "r" ]
    Go to Layout [ “ReferenceMenu2keywordOrNodeFind” (tagMenus) ]
    End If
    #
    #Find node tags.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Enter Find Mode [ ]
    Set Field [ tagMenus::match; $$citationMatch ]
    #
    #In Learn section only show creator nodes,
    #as these are the only nodes that can create
    #or edit learn records.
    If [ Left (Get (LayoutName) ; 1) = "l" ]
    Set Field [ tagMenus::textStyleOrCreatorNodeFlag; 123456789 ]
    End If
    #
    Perform Find [ ]
    #
    #Sort according to current users wishes.
    If [ TEMP::sortNode = "cat" or TEMP::sortNode = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    Else If [ TEMP::sortNode = "abc" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenus::tag; ascending ] [ Restore; No dialog ]
    End If
    #
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    Set Variable [ $$stopLoadTagRecord ]

Fields used in this script

    TEMP::InventoryLibraryYN
    tagMenus::match
    tagMenus::textStyleOrCreatorNodeFlag
    TEMP::sortNode
    tagMenuGroup::orderOrLibraryType
    tagMenuGroup::name
    tagMenus::orderOrLock
    tagMenus::tag

Scripts used in this script

Layouts used in this script

    learnKeywordOrNodeFind
    learnKeywordOrNodeSFind
    ReferenceMenu2keywordOrNodeFind

Tables used in this script

    TEMP
    tag
    tagGroup

Table occurrences used by this script

    TEMP
    tagMenuGroup
    tagMenus

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [menuNodeFind]	Parent Folder: [menuFind]	Next Script: [menuPublicationFind]
Script Name	menuPathFind
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferenceMenuFind
    ReferenceMenu3CiteFind
    ReferenceMenu3CiteFindS
    ReferenceMenu2keywordOrNodeFind

Scripts that use this script

Script Definition
Script Steps

    #
    #Set citationMatch to color menu button with inUse color.
    Set Variable [ $$citationMatch; Value:"path" ]
    #
    #Goto correct layout.
    If [ Left (Get (LayoutName) ; 1) = "l" ]
    Go to Layout [ “learnFind” (tagMenus) ]
    Else If [ Left (Get (LayoutName) ; 1) = "r" ]
    Go to Layout [ “ReferenceMenuFind” (tagMenus) ]
    End If
    #
    #Find Path tags. Path tags are available to all library sections.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Enter Find Mode [ ]
    Set Field [ tagMenus::match; "Path" ]
    Perform Find [ ]
    #
    #Sort according to current users wishes.
    If [ TEMP::sortPath = "cat" or TEMP::sortPath = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    Else If [ TEMP::sortPath = "abc" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenus::tag; ascending ] [ Restore; No dialog ]
    End If
    #
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    Set Variable [ $$stopLoadTagRecord ]

Fields used in this script

    tagMenus::match
    TEMP::sortPath
    tagMenuGroup::orderOrLibraryType
    tagMenuGroup::name
    tagMenus::orderOrLock
    tagMenus::tag

Scripts used in this script

Layouts used in this script

    learnFind
    ReferenceMenuFind

Tables used in this script

    TEMP
    tag
    tagGroup

Table occurrences used by this script

    TEMP
    tagMenuGroup
    tagMenus

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [menuPathFind]	Parent Folder: [menuFind]	Next Script: [menuPublisherFind]
Script Name	menuPublicationFind
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferenceMenuFind
    ReferenceMenu3CiteFind
    ReferenceMenu3CiteFindS
    ReferenceMenu2keywordOrNodeFind

Scripts that use this script

Script Definition
Script Steps

    #
    #Set citationMatch to color menu button with inUse color.
    Set Variable [ $$citationMatch; Value:"publication" ]
    #
    #Goto correct layout.
    Go to Layout [ “ReferenceMenuFind” (tagMenus) ]
    #
    #Find publication tags.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Enter Find Mode [ ]
    Set Field [ tagMenus::match; "publication" ]
    Perform Find [ ]
    #
    #Sort according to current users wishes.
    If [ TEMP::sortPublication = "cat" or TEMP::sortPublication = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    Else If [ TEMP::sortPublication = "abc" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenus::tag; ascending ] [ Restore; No dialog ]
    End If
    #
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    Set Variable [ $$stopLoadTagRecord ]
    #

Fields used in this script

    tagMenus::match
    TEMP::sortPublication
    tagMenuGroup::orderOrLibraryType
    tagMenuGroup::name
    tagMenus::orderOrLock
    tagMenus::tag

Scripts used in this script

Layouts used in this script

    ReferenceMenuFind

Tables used in this script

    TEMP
    tag
    tagGroup

Table occurrences used by this script

    TEMP
    tagMenuGroup
    tagMenus

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [menuPublicationFind]	Parent Folder: [menuFind]	Next Script: [menuReferenceFind]
Script Name	menuPublisherFind
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    ReferenceMenuFind
    ReferenceMenu3CiteFind
    ReferenceMenu3CiteFindS
    ReferenceMenu2keywordOrNodeFind

Scripts that use this script

Script Definition
Script Steps

    #
    #Set citationMatch to color menu button with inUse color.
    Set Variable [ $$citationMatch; Value:"publisher" ]
    #
    #Goto correct layout.
    Go to Layout [ “ReferenceMenuFind” (tagMenus) ]
    #
    #Find publisher tags.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Enter Find Mode [ ]
    Set Field [ tagMenus::match; $$citationMatch ]
    Perform Find [ ]
    #
    #Sort according to current users wishes.
    If [ TEMP::sortPublisher = "cat" or TEMP::sortPublisher = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    Else If [ TEMP::sortPublisher = "abc" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenus::tag; ascending ] [ Restore; No dialog ]
    End If
    #
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    Set Variable [ $$stopLoadTagRecord ]

Fields used in this script

    tagMenus::match
    TEMP::sortPublisher
    tagMenuGroup::orderOrLibraryType
    tagMenuGroup::name
    tagMenus::orderOrLock
    tagMenus::tag

Scripts used in this script

Layouts used in this script

    ReferenceMenuFind

Tables used in this script

    TEMP
    tag
    tagGroup

Table occurrences used by this script

    TEMP
    tagMenuGroup
    tagMenus

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [menuPublisherFind]	Parent Folder: [menuFind]	Next Script: [menuTestFind]
Script Name	menuReferenceFind
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    learnFind
    learnSFind
    learnKeywordOrNodeFind
    learnKeywordOrNodeSFind
    learnFindTest
    learnFindSTest
    learnFindBrainstorm
    learnFindStuffBrainstorm
    learnFindCite
    learnFindCiteS
    learnFindStuffCite
    learnMenu4NoPicRefCiteFindTL
    learnMenu4RefCiteFindTL
    learnMenu4RefStuffCiteFindTL

Scripts that use this script

Script Definition
Script Steps

    #
    #Set citationMatch to color menu button with inUse color.
    Set Variable [ $$citationMatch; Value:"ref" ]
    #
    #Set testlearn internal reference field conditional
    #formatting to transparent.
    Set Variable [ $$internal ]
    #
    #
    #Goto correct layout.
    If [ TEMP::InventoryLibraryYN = "" ]
    #Idea Mode
    #
    #If no layout preference is set, then on iDevices
    #go the layout with no pictures, and to the
    #layout with pictures on desktop computers.
    If [ TEMP::layoutLtagRFIND = "" ]
    If [ Get (SystemPlatform) = 3 ]
    Go to Layout [ “learnFindCiteS” (reference) ]
    Set Field [ TEMP::layoutLtagRFIND; "more" & Get (LayoutName) ]
    Else
    Go to Layout [ “learnFindCite” (reference) ]
    Set Field [ TEMP::layoutLtagRFIND; "less" & Get (LayoutName) ]
    End If
    Else
    #
    #Go the layout the user has selected.
    Go to Layout [ Middle ( TEMP::layoutLtagRFIND ; 5 ; 42 ) ]
    End If
    #
    Else
    #Inventory Mode
    #
    #Go the location tag layout.
    Go to Layout [ “learnFindStuffCite” (reference) ]
    End If
    #
    #
    #Find References for the Learn module.
    If [ TEMP::InventoryLibraryYN = "" ]
    #
    #If in idea mode then show only references user
    #has selected to show in the Learn module.
    Enter Find Mode [ ]
    Set Field [ reference::showInLearn; "show in learn" ]
    Perform Find [ ]
    #
    Else
    #
    #If in inventory mode then show all references
    #(except the locked references).
    Enter Find Mode [ ]
    Set Field [ tagInventoryLocation::match; "location" ]
    Perform Find [ ]
    #
    End If
    #
    #
    #Sort records.
    If [ TEMP::InventoryLibraryYN = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagKeywordPrimary::orderOrLock; based on value list: “order Pulldown List” tagKeywordPrimary::tag; ascending reference::referenceShort; ascending ] [ Restore; No dialog ]
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagKeywordPrimary::orderOrLock; based on value list: “order Pulldown List” tagKeywordPrimary::tag; ascending reference::publicationYearOrStuffOrderNumber; based on value list: “order Pulldown List” reference::Title; ascending ] [ Restore; No dialog ]
    End If
    #
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    Set Variable [ $$stopLoadTagRecord ]

Fields used in this script

    TEMP::InventoryLibraryYN
    TEMP::layoutLtagRFIND
    reference::showInLearn
    tagInventoryLocation::match
    tagKeywordPrimary::orderOrLock
    tagKeywordPrimary::tag
    reference::referenceShort
    reference::publicationYearOrStuffOrderNumber

Scripts used in this script

Layouts used in this script

    learnFindCiteS
    learnFindCite
    learnFindStuffCite

Tables used in this script

    TEMP
    reference
    tag
    tag

Table occurrences used by this script

    TEMP
    reference
    tagInventoryLocation
    tagKeywordPrimary

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [menuReferenceFind]	Parent Folder: [menuFind]	Next Script: [cancelFind]
Script Name	menuTestFind
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    learnFind
    learnSFind
    learnKeywordOrNodeFind
    learnFindTest
    learnFindSTest
    learnFindBrainstorm
    learnFindCite
    learnFindCiteS
    learnMenu4NoPicRefCiteFindTL
    learnMenu4RefCiteFindTL
    learnMenu4RefStuffCiteFindTL

Scripts that use this script

Script Definition
Script Steps

    #
    #Set citationMatch to color menu button with inUse color.
    Set Variable [ $$citationMatch; Value:"test" ]
    #
    #Goto correct layout.
    If [ Left (Get (LayoutName) ; 1) = "l" ]
    Go to Layout [ “learnFindTest” (testSubsectionTemplate) ]
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Go to Layout [ “learnFindSTest” (testSubsectionTemplate) ]
    End If
    Else If [ Left (Get (LayoutName) ; 1) = "r" ]
    Go to Layout [ “learnFindTest” (testSubsectionTemplate) ]
    End If
    #
    #Find test subsection tags.
    Show All Records
    #
    #Sort into groups.
    Sort Records [ Keep records in sorted order; Specified Sort Order: testSubsectionGroup::orderOrLibraryType; based on value list: “order Pulldown List” testSubsectionGroup::name; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” testSubsectionTemplate::order; ascending testSubsectionTemplate::name; ascending ] [ Restore; No dialog ]
    #
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    Set Variable [ $$stopLoadTagRecord ]

Fields used in this script

    TEMP::InventoryLibraryYN
    testSubsectionGroup::orderOrLibraryType
    testSubsectionGroup::name
    tagMenus::orderOrLock
    testSubsectionTemplate::order
    testSubsectionTemplate::name

Scripts used in this script

Layouts used in this script

    learnFindTest
    learnFindSTest

Tables used in this script

    TEMP
    tag
    tagGroup
    testSubsectionTemplate

Table occurrences used by this script

    TEMP
    tagMenus
    testSubsectionGroup
    testSubsectionTemplate

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [menuTestFind]	Parent Folder: [menuFind]
Script Name	cancelFind
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    referenceMenuFINDref
    referenceFINDNK
    referenceSFINDNK
    learnMenuFINDref
    learnMenuFINDrefLearn
    learnMenuFINDstuffRef
    ltagFINDNK
    ltagFINDstuffNK

Scripts that use this script

Script Definition
Script Steps

    Enter Browse Mode

Fields used in this script

Scripts used in this script

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


probablyNotInUse
	Parent Folder: [probablyNotInUse]
Script Name	newTag
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #If node is currenlty locked then stop script,
    #and inform the user.
    Perform Script [ “stopNewRecordsBeingCreatedByLockedNode” ]
    #
    #Not sure where this script is used? Can
    #probably be replaced with newTagMenuTag
    #script, and then deleted. Testing required.
    #
    #
    Set Variable [ $rule; Value:tagTable::kGroupOrTest ]
    New Record/Request
    Set Field [ tagTable::kGroupOrTest; $rule ]
    Go to Field [ tagTable::tag ]
    #

Fields used in this script

    tagTable::kGroupOrTest
    tagTable::tag

Scripts used in this script

    stopNewRecordsBeingCreatedByLockedNode

Layouts used in this script

Tables used in this script

    tag

Table occurrences used by this script

    tagTable

Custom Functions used by this script

Custom menu set used by this script


test

report
	Parent Folder: [report]	Next Script: [deleteRowOfPhotosFromReport]
Script Name	CHUNK_gotoTestSubsectionViaPulldown
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    gotoReport
    deleteReportTestResult

Script Definition
Script Steps

    #
    #basic administration tasks
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Set Field [ TEMP::ktestSection; "" ]
    #
    #clear the $$finding and $window variables
    Set Variable [ $$finding ]
    Set Variable [ $$window ]
    Set Variable [ $testSubject; Value:report::ktestSubject ]
    #
    #Determine report page to go to.
    If [ $$goToFirstReportPage = "" ]
    Set Variable [ $testSubsection; Value:TEMP::ktestSubsection ]
    Else
    Set Variable [ $testSubsection; Value:$$goToFirstReportPage ]
    Set Variable [ $$goToFirstReportPage ]
    End If
    #
    #clear global fields for creating new test result
    #records, but put in current timestamp to help
    #user understand how info sould be put into
    #the timestample field and for easy editing,
    #changing date, time, etc.
    Set Field [ testlearnReportTags::kgtestSection; "" ]
    Set Field [ TEMP::testSubsectionNameForSubject; "" ]
    Set Field [ TEMP::TimeStamp; Get ( CurrentTimeStamp ) ]
    Enter Find Mode [ ]
    Set Field [ report::ktestSubject; $testSubject ]
    Set Field [ report::ktestSubsection; $testSubsection ]
    Set Field [ report::kreportNumber; $$reportNumber ]
    Perform Find [ ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: report::ktestSubsection; ascending ] [ Restore; No dialog ]
    #
    Set Field [ TEMP::showFavorites; "" ]
    Set Field [ TEMP::ktestSubsection; report::ktestSubsection ]
    Set Variable [ $$testSubsection; Value:report::ktestSubsection ]
    Set Field [ TEMP::ktestItemSubsection; report::ktestSubsection ]
    Set Field [ TEMP::ktestItemSubsection; reportSubsection::ktestItemGroup ]
    Set Field [ TEMP::testSubsectionName; reportSubsection::name ]
    #
    #Close info reference window if open.
    Close Window [ Name: "Reference"; Current file ]
    #
    Select Window [ Name: "Tag Menus"; Current file ]
    If [ Get (LastError) = 112 ]
    New Window [ Name: "Tag Menus"; Height: Get ( ScreenHeight ); Width: 330; Left: 0; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    End If
    #
    #Resize window just in case user was looking
    #at a test info record with references.
    Move/Resize Window [ Name: "Tag Menus"; Current file; Width: Get (ScreenWidth) - 594; Left: 594 ]
    #
    #See if there are any informational
    #(Learn module) records tagged
    #to this test subsection.
    Go to Layout [ “tableTestLearn” (testlearn) ]
    Enter Find Mode [ ]
    Set Field [ testlearn::kctestSubsectionInfo; "###" & $$testSubsection ]
    Perform Find [ ]
    #
    #If there are information records, then set this
    #variable below to inform the user of this fact
    #by highlighting the info button on the
    #Test Menus layout.
    If [ Get (FoundCount) ≠ 0 ]
    Set Variable [ $$thereIsInfoForThisSubsection; Value:1 ]
    Else
    Set Variable [ $$thereIsInfoForThisSubsection ]
    End If
    #
    #
    #Now find test results for this subsection.
    Set Variable [ $$stopLoadTestResultRecord; Value:1 ]
    Go to Layout [ “reportTestResult” (testlearnReportTags) ]
    Enter Find Mode [ ]
    Set Field [ testlearnReportTags::ktestSubject; TEMP::kdefaultNodeTestSubject ]
    Set Field [ testlearnReportTags::ktestSubsection; TEMP::ktestSubsection ]
    Set Field [ testlearnReportTags::kreportNumber; TEMP::reportNumber ]
    Perform Find [ ]
    #
    #Go to the locked layout if the test subject, primary node, or primary nodes creator is locked.
    If [ ReportResultTestSubject::orderOrLock ≠ "" or TEMP::primaryNodeIsLocked ≠ "" //or //TEMP::primaryNodesCreatorNodeIsLocked ≠ "" ]
    Go to Layout [ “reportTestResultLocked” (testlearnReportTags) ]
    End If
    #
    #Sort button script uses the "order" text to tell
    #it to perform the next sort by date instead of
    #by order number which is the default sort.
    Set Variable [ $$citationMatch; Value:"testResult" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearnReportTags::orderTestResult; based on value list: “testPulldownListANDsortOrderList” testlearnReportTags::timestamp; descending ] [ Restore; No dialog ]
    #
    #Load up test results variables.
    Set Variable [ $$stopLoadTestResultRecord; Value:1 ]
    Go to Record/Request/Page [ First ]
    #
    #Reset test result temp fields.
    Set Field [ TEMP::TLTestSort; "order" ]
    Set Field [ TEMP::TimeStamp; "" ]
    #
    #Return to report window.
    Select Window [ Name: "Report"; Current file ]
    #
    #Set subsection lock variable to prevent user
    #from going to edit subsection template,
    #and hide edit/new button as user cannot edit
    #locked subsection info or test-item records.
    If [ testSubsectionGroupNodeLock3::orderOrLock ≠ "" or $$testSubjectIsLocked ≠ "" ]
    Set Field [ TEMP::testItemMenuShowTheWordLock; "Lock" ]
    Else If [ testSubsectionGroupNodeLock3::orderOrLock = "" and $$testSubjectIsLocked = "" ]
    Set Field [ TEMP::testItemMenuShowTheWordLock; "" ]
    End If
    #
    #Get name of node who locked subsection.
    If [ testSubsectionGroupNodeLock3::orderOrLock ≠ "" ]
    Set Variable [ $$testSubsectionIsLocked; Value:testSubsectionGroupNodeLock3::tag ]
    Else If [ testSubsectionGroupNodeLock3::orderOrLock = "" ]
    Set Variable [ $$testSubsectionIsLocked ]
    End If
    #
    #

Fields used in this script

    TEMP::ktestSection
    report::ktestSubject
    TEMP::ktestSubsection
    testlearnReportTags::kgtestSection
    TEMP::testSubsectionNameForSubject
    TEMP::TimeStamp
    report::ktestSubsection
    report::kreportNumber
    TEMP::showFavorites
    TEMP::ktestItemSubsection
    reportSubsection::ktestItemGroup
    reportSubsection::name
    TEMP::testSubsectionName
    testlearn::kctestSubsectionInfo
    TEMP::kdefaultNodeTestSubject
    testlearnReportTags::ktestSubject
    testlearnReportTags::ktestSubsection
    TEMP::reportNumber
    testlearnReportTags::kreportNumber
    ReportResultTestSubject::orderOrLock
    TEMP::primaryNodeIsLocked
    testlearnReportTags::orderTestResult
    testlearnReportTags::timestamp
    TEMP::TLTestSort
    testSubsectionGroupNodeLock3::orderOrLock
    TEMP::testItemMenuShowTheWordLock
    testSubsectionGroupNodeLock3::tag

Scripts used in this script

Layouts used in this script

    tableTestLearn
    reportTestResult
    reportTestResultLocked

Tables used in this script

    TEMP
    report
    tag
    testSubsectionTemplate
    testlearn
    testlearn

Table occurrences used by this script

    ReportResultTestSubject
    TEMP
    report
    reportSubsection
    testSubsectionGroupNodeLock3
    testlearn
    testlearnReportTags

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [CHUNK_gotoTestSubsectionViaPulldown]	Parent Folder: [report]	Next Script: [deleteSetupItems]
Script Name	deleteRowOfPhotosFromReport
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    PrintReportEdit

Scripts that use this script

Script Definition
Script Steps

    #
    If [ Get (RecordNumber) = 1 ]
    Exit Script [ ]
    End If
    If [ report::kTag1 ≠ "" or report::kTag2 ≠ "" or report::kTag3 ≠ "" or report::kTag4 ≠ "" ]
    Show Custom Dialog [ Title: "!"; Message: "You may delete this row only after clearing all photo slots."; Default Button: “OK”, Commit: “Yes” ]
    Halt Script
    End If
    Set Variable [ $delete; Value:Get (RecordNumber) ]
    Refresh Window
    Show Custom Dialog [ Message: "Delete this row of photos?"; Default Button: “cancel”, Commit: “Yes”; Button 2: “OK”, Commit: “No” ]
    If [ Get ( LastMessageChoice ) = 2 ]
    Delete Record/Request [ No dialog ]
    End If
    Set Variable [ $delete ]
    Refresh Window
    #

Fields used in this script

    report::kTag1
    report::kTag2
    report::kTag3
    report::kTag4

Scripts used in this script

Layouts used in this script

Tables used in this script

    report

Table occurrences used by this script

    report

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [deleteRowOfPhotosFromReport]	Parent Folder: [report]	Next Script: [deleteTestSectionTemplate]
Script Name	deleteSetupItems
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    Go to Object [ Object Name: "item" ]
    If [ testSubsectionTemplate::_LtestSubsection ≠ "" ]
    Show Custom Dialog [ Title: "!"; Message: "You can delete this record only after you delete all items assigned to this subsection in these sections."; Default Button: “OK”, Commit: “Yes” ]
    Go to Field [ ]
    Halt Script
    End If
    Go to Field [ ]
    Delete Record/Request

Fields used in this script

    testSubsectionTemplate::_LtestSubsection

Scripts used in this script

Layouts used in this script

Tables used in this script

    testSubsectionTemplate

Table occurrences used by this script

    testSubsectionTemplate

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [deleteSetupItems]	Parent Folder: [report]	Next Script: [gotoDefaultsOrReport]
Script Name	deleteTestSectionTemplate
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    setupTestSection

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #If there are no section templates, then stop
    #this script.
    If [ Get (FoundCount) = 0 ]
    Exit Script [ ]
    End If
    #
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Set Variable [ $testSection; Value:testSection::_Ltag ]
    Set Variable [ $recordNumber; Value:Get (RecordNumber) ]
    #
    If [ testSectionCreatorLock::orderOrLock ≠ "" ]
    Show Custom Dialog [ Message: "This record is locked. Go the node that created it — " & testSectionCreatorLock::tag & " — in the setup tag window and enter the password to unlock it so that you can delete it."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #Highlight section template user is trying to delete.
    Set Variable [ $delete; Value:testSection::_Ltag ]
    #
    Go to Layout [ “TEMP” (TEMP) ]
    Show All Records
    Delete All Records [ No dialog ]
    #
    Go to Layout [ “tableTestSectionFromTemplate” (testSectionCreatedFromATemplate) ]
    Enter Find Mode [ ]
    Set Field [ testSectionCreatedFromATemplate::ksectionTemplate; $testSection ]
    Perform Find [ ]
    #
    #If section's using this template then inform
    #user of where and prevent its deletion.
    If [ Get (LastError) ≠ 401 ]
    Loop
    Set Variable [ $useList; Value:TextColor( testSubjectName::tag & ¶ & "test " & testSectionCreatedFromATemplate::reportNumber & " | " ; RGB(102;102;102)) & testSectionCreatedFromATemplate::name ]
    Go to Layout [ “TEMP” (TEMP) ]
    New Record/Request
    Set Field [ TEMP::DeleteMessageInTempWindow1; $useList ]
    Go to Layout [ “tableTestSectionFromTemplate” (testSectionCreatedFromATemplate) ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    Go to Layout [ original layout ]
    New Window [ Name: " "; Width: 360; Left: Get ( WindowWidth ) - 360; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “TEMP” (TEMP) ]
    View As [ View as List ]
    #
    #Eliminate duplicate template records.
    Sort Records [ Keep records in sorted order; Specified Sort Order: TEMP::DeleteMessageInTempWindow1; ascending ] [ Restore; No dialog ]
    Go to Record/Request/Page [ First ]
    Loop
    Set Variable [ $testSection; Value:TEMP::DeleteMessageInTempWindow1 ]
    Go to Record/Request/Page [ Next; Exit after last ]
    If [ TEMP::DeleteMessageInTempWindow1 = $testSection ]
    Omit Record
    #
    #NOTE: Omit by default moves to the next record
    #so to go to the next record after an omission,
    #the script must go to the previous record.
    Go to Record/Request/Page [ Previous ]
    End If
    End Loop
    #
    Show/Hide Toolbars [ Lock; Hide ]
    Show/Hide Text Ruler [ Hide ]
    #
    #Due to a bug in FM13, window must first be
    #moved back into the screen area before the
    #calculation of the current screen's
    #dimensions can be taken.
    Move/Resize Window [ Current Window; Top: 0; Left: 0 ]
    Set Field [ TEMP::Message; "This section template has been used to create test-subject, custom-named, test sections shown below. 1) Click 'back'. 2) Click 'edit/new'. 3) Click on a section, shown below. 4) Click 'x'. 5) Repeat until all are deleted." ]
    Pause/Resume Script [ Indefinitely ]
    Close Window [ Current Window ]
    Set Variable [ $delete ]
    Refresh Window
    Exit Script [ ]
    End If
    #
    #If the section template is not in use, then
    #make sure user really wants to delete it.
    Go to Layout [ original layout ]
    Go to Field [ ]
    Go to Record/Request/Page [ $recordNumber ] [ No dialog ]
    Set Variable [ $delete; Value:testSection::_Ltag ]
    Set Variable [ $name; Value:testSection::tag ]
    Refresh Window
    Show Custom Dialog [ Title: "!"; Message: "Delete " & $name & "?"; Default Button: “Cancel”, Commit: “Yes”; Button 2: “Delete”, Commit: “No” ]
    #
    // If [ Get (FoundCount) = 1 ]
    // Show Custom Dialog [ Title: "!"; Message: "Delete " & $name & "?"; Default Button: “Cancel”, Commit: “Yes”; Button 2: “Delete”, Commit: “No” ]
    // End If
    #
    #If user decides to delete it then do so.
    If [ Get ( LastMessageChoice ) = 2 ]
    #
    #First remove its key from all test records that
    #have it.
    New Window [ Height: 1; Width: 1; Top: 10000; Left: 10000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “tableTestSubsectionTemplates” (testSubsectionTemplate) ]
    Enter Find Mode [ ]
    Set Field [ testSubsectionTemplate::kcsections; $delete ]
    Perform Find [ ]
    Loop
    Set Field [ testSubsectionTemplate::kcsections; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used If ( ValueCount ( testSubsectionTemplate::kcsections ) ≠ ValueCount ( Substitute ( testSubsectionTemplate::kcsections ; $delete & "¶" ; "" ) ) ; Substitute ( testSubsectionTemplate::kcsections ; $delete & "¶" ; "" ) ; Substitute ( testSubsectionTemplate::kcsections ; $delete ; "" ) ) ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    Close Window [ Current Window ]
    #
    #Delete this test section template.
    Delete Record/Request [ No dialog ]
    End If
    #
    #If user cancels delete, then stop the delete process.
    Set Variable [ $delete ]
    Refresh Window
    #

Fields used in this script

    testSection::_Ltag
    testSectionCreatorLock::orderOrLock
    testSectionCreatorLock::tag
    testSectionCreatedFromATemplate::ksectionTemplate
    testSubjectName::tag
    testSectionCreatedFromATemplate::reportNumber
    testSectionCreatedFromATemplate::name
    TEMP::DeleteMessageInTempWindow1
    TEMP::Message
    testSection::tag
    testSubsectionTemplate::kcsections

Scripts used in this script

Layouts used in this script

    TEMP
    tableTestSectionFromTemplate
    tableTestSubsectionTemplates

Tables used in this script

    TEMP
    tag
    tag
    testSectionCreatedFromATemplate
    testSubsectionTemplate

Table occurrences used by this script

    TEMP
    testSection
    testSectionCreatedFromATemplate
    testSectionCreatorLock
    testSubjectName
    testSubsectionTemplate

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [deleteTestSectionTemplate]	Parent Folder: [report]	Next Script: [gotoReport]
Script Name	gotoDefaultsOrReport
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    learn0
    learnStuff0
    learn1
    learnStuff1
    learn2
    learnStuff2
    learn3
    learnStuff3
    learn4
    learnStuff4
    learn5
    learnStuff5
    learnTest
    learnSTest

Scripts that use this script

Script Definition
Script Steps

    #
    #Select window Learn, in case the user clicked
    #the back button on the Test Tag Menu.
    Select Window [ Name: "Learn"; Current file ]
    #
    #
    #
    #Set in copyAndpastTags script.
    Set Variable [ $$copyAndpastTagsRECORD ]
    #
    #Clear main record node lock variable.
    Set Variable [ $$lockedMainLearnRecord ]
    #
    #Determine what module is active and then go
    #to the setup module if ...
    If [ $$learnRecord = "" and $$testTagRecord = "" ]
    #
    #If user is in tag field and has changed spelling
    #exit this tag record, otherwise current reference record
    #will get deleted by the spelling check script.
    Select Window [ Name: "Tag Menus"; Current file ]
    Go to Field [ ]
    #
    #Check for any dragged changes to tag spellings.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Go to Layout [ “ltagSCRIPTloops” (tagMenus) ]
    Show All Records
    Set Variable [ $$stopLoadTagRecord ]
    Perform Script [ “CHUNK_checkForDraggedPasteChanges” ]
    #
    #Go to default tags layout
    #and load up defaults.
    Perform Script [ “defaultsAll” ]
    #
    #Change main window to Setup.
    Select Window [ Name: "References"; Current file ]
    Select Window [ Name: "Learn"; Current file ]
    Set Window Title [ Current Window; New Title: "Setup" ]
    Move/Resize Window [ Current Window; Height: Get (ScreenHeight); Width: Get (ScreenWidth) / 2; Top: 0; Left: 0 ]
    Go to Layout [ “defaultSetup” (librarySetupReferenceMain) ]
    #
    #Clear variables that where set
    #in other modules.
    Go to Field [ ]
    Set Variable [ $$citationitem; Value:tempSetup::klibrary ]
    Set Variable [ $$citationMatch ]
    Set Variable [ $$node ]
    Set Variable [ $$tagBrainstorm ]
    Set Variable [ $$tagTest ]
    Set Variable [ $$citationRecord ]
    Set Variable [ $$primaryNode ]
    Set Variable [ $$medium ]
    Set Variable [ $$copyright ]
    Set Variable [ $$Path ]
    Set Variable [ $$cite ]
    Set Variable [ $$ref ]
    Set Variable [ $$PrimaryKey ]
    Set Variable [ $$Key ]
    Set Variable [ $$OtherKey ]
    Set Variable [ $$RecordID ]
    #
    Set Field [ TEMP::ktestSubsection; "" ]
    #
    Set Variable [ $$findMode ]
    Set Variable [ $$firstFind ]
    Set Variable [ $$firstFindOther ]
    Set Variable [ $$found ]
    Set Variable [ $$foundOther ]
    Set Variable [ $$findLayout ]
    Exit Script [ ]
    #
    #
    #
    Else If [ $$learnRecord ≠ "" and $$testTagRecord = "" ]
    Set Window Title [ Current Window; New Title: "Report" ]
    Go to Layout [ “PrintReportEdit” (report) ]
    Scroll Window [ Home ]
    #
    Enter Find Mode [ ]
    Set Field [ report::ktestSubject; $$testSubject ]
    Set Field [ report::kreportNumber; $$reportNumber ]
    Set Field [ report::ktestSubsection; $$returnItem ]
    Perform Find [ ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: report::ktestSubsection; ascending ] [ Restore; No dialog ]
    #
    View As [ View as List ]
    Scroll Window [ Home ]
    #
    #Just in case user went to a different item before
    #returning to this item, put the item being tested
    #back in the temp field.
    Set Field [ TEMP::ktestSubsection; $$returnItem ]
    Set Field [ TEMP::testSubsectionName; $$returnItemName ]
    #
    #If user is in tag field and has changed spelling
    #exit this tag record, otherwise current reference record
    #will get deleted by the spelling check script.
    Select Window [ Name: "Tag Menus"; Current file ]
    Go to Field [ ]
    #
    #Check for any dragged changes to tag spellings.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Go to Layout [ “ltagSCRIPTloops” (tagMenus) ]
    Show All Records
    Set Variable [ $$stopLoadTagRecord ]
    Perform Script [ “CHUNK_checkForDraggedPasteChanges” ]
    #
    #Now find discoveries for this report item.
    Set Variable [ $$stoploadtestinfo; Value:1 ]
    Go to Layout [ “reportTagInfo” (testlearnReportTags) ]
    Perform Script [ “reportTagInfo” ]
    #
    #Clear this variable, which is needed only
    #when going to edit Learn info records.
    If [ TEMP::InventoryLibraryYN = "" ]
    Set Variable [ $$doNotOpenReferenceWindow ]
    End If
    #
    #Now go the test record the user was on.
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ testlearnReportTags::_Ltestlearn = $$learnRecord ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    Set Variable [ $$stoploadtestinfo ]
    Set Variable [ $$returnItem ]
    Set Variable [ $$learnRecord ]
    Perform Script [ “loadTestInfo” ]
    #
    Else If [ $$learnRecord = "" and $$testTagRecord ≠ "" ]
    Set Window Title [ Current Window; New Title: "Test" ]
    #
    #Prevent test records from loading to speed up
    #this script.
    Set Variable [ $$stopLoadTestRecord; Value:1 ]
    #
    #find and show all test records.
    Go to Layout [ “testResult0” (testlearn) ]
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Enter Find Mode [ ]
    Set Field [ testlearn::ktestSubject; $$testSubject ]
    Set Field [ testlearn::ktestSubsection; $$returnItem ]
    Set Field [ testlearn::kreportNumber; $$reportNumber ]
    Perform Find [ ]
    #
    #Just in case user went to a different item before
    #returning to this item, put the item being tested
    #back in the temp field.
    Set Field [ TEMP::ktestSubsection; $$returnItem ]
    Set Field [ TEMP::testSubsectionName; $$returnItemName ]
    #
    #This field does show up elsewhere but I am not
    #sure after what it does. My bad for not making
    #thorough comments during earlier developement.
    Set Field [ testSubsectionForSubject::gtestSectionNameGlobal; TextStyleAdd ( TEMP::testSubsectionNameForSubject ; Lowercase ) ]
    #
    #Create new test record if there are none.
    #( I know, there where records here when the
    # the user went to edit them, but the user
    # could have deleted all of them, so it makes
    # to leave this step in for in case that unlikely
    # thing happened ).
    If [ Get (LastError) = 401 ]
    Perform Script [ “newTestResult” ]
    #
    #If there is OK or NA record, change it into a test
    #record. (NA and OK records tell the user they
    #have inspected an item and found it OK or not
    #needing to be tested. If OK, the user has decided
    #not to record any details. So a record exist
    #but it is not being used to record details.
    #These next steps will turn that non-test record
    #into a test record.)
    Else If [ Get (FoundCount) = 1 and $$testSection = testlearn::ktestSection and testlearn::kreportNumber = $$reportNumber and testlearn::countOfONESubsectionsTestResults = "N/A" or Get (FoundCount) = 1 and $$testSection = testlearn::ktestSection and testlearn::kreportNumber = $$reportNumber and testlearn::countOfONESubsectionsTestResults = "OK" or Get (FoundCount) = 1 and $$testSection = testlearn::ktestSection and testlearn::kreportNumber = $$reportNumber and testlearn::countOfONESubsectionsTestResults = "★" ]
    #
    #If there is OK or NA record, change it into a test
    #by change NA or OK to 1, as in 1 test record.
    Set Field [ testlearn::countOfONESubsectionsTestResults; 1 ]
    #
    #increase number of test records for item overall
    #from zero to 1.
    Set Field [ testlearn::countOfALLSubsectionsTestResults; 1 ]
    Go to Layout [ “testResult0” (testlearn) ]
    End If
    #
    #Group records by test subject location.
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::subsectionCustomName; ascending testlearn::_Number; ascending ] [ Restore; No dialog ]
    #
    #Omit all NA, OK, and star records if any (these
    #records function as visual indicators of having
    #made a decision not to create a test record
    #because NA = it was not applicable, OK=it was
    #fine, and star symbol = because a test record
    #already created duplicates the finding in this
    #test subject location),
    Go to Record/Request/Page [ First ]
    Loop
    If [ testlearn::countOfONESubsectionsTestResults = "N/A" or testlearn::countOfONESubsectionsTestResults = "OK" or testlearn::countOfONESubsectionsTestResults = "★" ]
    Omit Record
    Go to Record/Request/Page [ Previous ]
    End If
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Now go the test record the user was on.
    Go to Record/Request/Page [ Last ]
    Loop
    Exit Loop If [ testlearn::_Ltestlearn = $$testLearnRecord ]
    Go to Record/Request/Page [ Previous; Exit after last ]
    End Loop
    #
    #Set the numbers for the navigation arrows
    #at the top of the screen: record # / total #.
    Set Field [ testlearn::recordnumberglobal; Get (RecordNumber) ]
    Set Field [ testlearn::recordcountglobal; Get (FoundCount) ]
    #
    #If the test subject or the primary node is
    #locked go the locked layout.
    If [ testSubsectionTestSubjectLock::orderOrLock = "0" or TEMP::primaryNodeIsLocked ≠ "" // or //TEMP::primaryNodesCreatorNodeIsLocked ≠ "" ]
    Go to Layout [ "testResultLOCKED" & Right ( TEMP::layoutTmain ; 1) ]
    Else
    Go to Layout [ "testResult" & Right ( TEMP::layoutTmain ; 1) ]
    End If
    #
    #Conditionally format current test record and tags.
    Set Variable [ $$sopLoadTestRecord ]
    Perform Script [ “loadTestResultRecord” ]
    #
    #Find all details for this item.
    Select Window [ Name: "Tag Menus"; Current file ]
    Perform Script [ “reportTagInfo” ]
    #
    #Clear this variable, which is needed only
    #when going to edit Learn info records.
    If [ TEMP::InventoryLibraryYN = "" ]
    Set Variable [ $$doNotOpenReferenceWindow ]
    End If
    #
    #Now go the test record the user was on.
    Set Variable [ $$stoploadtestinfo; Value:1 ]
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ testlearnReportTags::_Ltestlearn = $$testTagRecord ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Load up the current records variables.
    Set Variable [ $$stoploadtestinfo ]
    Perform Script [ “loadTestInfo” ]
    #
    #Clear the variables specific to this script.
    Set Variable [ $$returnItem ]
    Set Variable [ $$testTagRecord ]
    Set Variable [ $$testLearnRecord ]
    #
    End If

Fields used in this script

    tempSetup::klibrary
    TEMP::ktestSubsection
    report::ktestSubject
    report::kreportNumber
    report::ktestSubsection
    TEMP::testSubsectionName
    TEMP::InventoryLibraryYN
    testlearnReportTags::_Ltestlearn
    testlearn::ktestSubject
    testlearn::ktestSubsection
    testlearn::kreportNumber
    TEMP::testSubsectionNameForSubject
    testSubsectionForSubject::gtestSectionNameGlobal
    testlearn::ktestSection
    testlearn::countOfONESubsectionsTestResults
    testlearn::countOfALLSubsectionsTestResults
    testlearn::subsectionCustomName
    testlearn::_Number
    testlearn::_Ltestlearn
    testlearn::recordnumberglobal
    testlearn::recordcountglobal
    testSubsectionTestSubjectLock::orderOrLock
    TEMP::primaryNodeIsLocked
    TEMP::layoutTmain

Scripts used in this script

    CHUNK_checkForDraggedPasteChanges
    defaultsAll
    reportTagInfo
    loadTestInfo
    newTestResult
    loadTestResultRecord

Layouts used in this script

    ltagSCRIPTloops
    defaultSetup
    PrintReportEdit
    reportTagInfo
    testResult0
    <Missing Layout>

Tables used in this script

    TEMP
    TEMP
    report
    tag
    testSubsectionTemplate
    testlearn
    testlearn

Table occurrences used by this script

    TEMP
    report
    tempSetup
    testSubsectionForSubject
    testSubsectionTestSubjectLock
    testlearn
    testlearnReportTags

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [gotoDefaultsOrReport]	Parent Folder: [report]	Next Script: [insertCaption1]
Script Name	gotoReport
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultTest

Scripts that use this script

    printThingReport

Script Definition
Script Steps

    #
    #
    #If there is no report number or test subject
    #name, halt the script.
    If [ TEMP::reportNumber = "" ]
    Go to Field [ TEMP::reportNumber ] [ Select/perform ]
    Halt Script
    Else If [ testSectionCreatedFromATemplate::name = "" ]
    Halt Script
    End If
    #
    #basic administration tasks
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Set Field [ TEMP::ktestSection; "" ]
    Set Variable [ $$TSRecordNumber; Value:Get (RecordNumber) ]
    Set Variable [ $$stopLoadReportRecord; Value:1 ]
    Set Variable [ $$pictureWIndowColor; Value:"report" ]
    #
    #This variable stops the info button's script in
    #the Test and Report sections from opening a
    #Reference window, which is useful in idea
    #libraries to show references of ideas. In a
    #things library, reference records are used as
    #location records and each learn record can
    #have only one location, so showing a Reference
    #window in an inventory library would not be useful.
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Set Variable [ $$doNotOpenReferenceWindow; Value:1 ]
    Else
    Set Variable [ $$doNotOpenReferenceWindow ]
    End If
    #
    #Set subsection lock variable to prevent user
    #from going to edit subsection template
    #section, and set hide test edit/new button field
    #which results in hiding that button, since it
    #cannot be used when locked.
    If [ testSubjectName::orderOrLock ≠ "" ]
    Set Variable [ $$testSubjectIsLocked; Value:testSubjectName::tag ]
    Set Field [ tempSetup::testSubjectNodeIsLocked; 1 ]
    Else
    Set Variable [ $$testSubjectIsLocked ]
    Set Field [ tempSetup::testSubjectNodeIsLocked; "" ]
    End If
    #
    #Clear sort so when user click's button it will
    #resort records by order number.
    Set Field [ TEMP::TLTestSort; "" ]
    #
    #For correct conditional formatting on report
    #info screens, clear the citation variable.
    Set Variable [ $$main ]
    #
    #used for item pulldown selection on report layout
    Set Field [ TEMP::kdefaultNodeTestSubject; testSectionCreatedFromATemplate::ktestSubjectNode ]
    Set Field [ TEMP::DEFAULTNodeTestSubjectName; testSubjectName::tag ]
    Set Field [ TEMP::kabout; TEMP::kdefaultNodeTestSubject ]
    Set Variable [ $$testSubject; Value:TEMP::kdefaultNodeTestSubject ]
    #
    #clear global fields for creating new discovery
    #records, but put in current timestamp to help
    #user understand how info should be put into
    #the timestample field and for easy editing,
    #changing date, time, etc.
    Set Field [ testlearnReportTags::kgtestSection; "" ]
    Set Field [ TEMP::testSubsectionNameForSubject; "" ]
    Set Field [ TEMP::TimeStamp; Get ( CurrentTimeStamp ) ]
    Set Variable [ $$reportNumber; Value:testSectionCreatedFromATemplate::reportNumber ]
    Set Field [ TEMP::reportNumber; testSectionCreatedFromATemplate::reportNumber ]
    #
    #Get header information.
    Set Field [ TEMP::testAndReportMainWindowHeader; tempSetup::userLibraryName & " | " & testSubjectName::tag & " | " & "Report " & $$reportNumber ]
    #
    #Change window name to Report.
    Set Window Title [ Current Window; New Title: "Report" ]
    #
    #Resize Report window to fit layout.
    Go to Layout [ “PrintReportEdit” (report) ]
    Adjust Window [ Resize to Fit ]
    #
    #find all report pages first, then sort them alphabetically
    #and go to the first records. Use this one to find
    #only report records for this item.
    Enter Find Mode [ ]
    Set Field [ report::ktestSubject; $$testSubject ]
    Set Field [ report::kreportNumber; $$reportNumber ]
    Perform Find [ ]
    If [ Get (LastError) = 401 ]
    Perform Script [ “returnToTestSetup” ]
    Show Custom Dialog [ Message: "No test results to report on. 1) Click any test button under this report button, and 2) then click any test sub-section button to create reportable test-result records."; Default Button: “OK”, Commit: “Yes” ]
    Set Variable [ $$stopLoadReportRecord ]
    Exit Script [ ]
    End If
    Set Variable [ $$stopLoadReportRecord ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: reportSubsection::name; ascending ] [ Restore; No dialog ]
    Go to Record/Request/Page [ First ]
    #
    #Use this first record to find
    #only report records for this item.
    Set Field [ TEMP::testSubsectionName; reportSubsection::name ]
    Set Field [ TEMP::ktestSubsection; report::ktestSubsection ]
    Set Field [ TEMP::ktestItemSubsection; report::ktestSubsection ]
    Set Variable [ $$testSubsection; Value:report::ktestSubsection ]
    Set Variable [ $$first; Value:report::ktestSubsection ]
    #
    #If the test subject or the primary node is
    #locked then go to the locked report layout.
    If [ reportTestSubjectLock::orderOrLock = "0" or TEMP::primaryNodeIsLocked ≠ "" // or //TEMP::primaryNodesCreatorNodeIsLocked ≠ "" ]
    Go to Layout [ “PrintReportLock” (report) ]
    End If
    #
    #Now find test results for the report subsection.
    Perform Script [ “CHUNK_gotoTestSubsectionViaPulldown” ]
    #

Fields used in this script

    TEMP::reportNumber
    testSectionCreatedFromATemplate::name
    TEMP::ktestSection
    TEMP::InventoryLibraryYN
    testSubjectName::orderOrLock
    testSubjectName::tag
    tempSetup::testSubjectNodeIsLocked
    TEMP::TLTestSort
    testSectionCreatedFromATemplate::ktestSubjectNode
    TEMP::kdefaultNodeTestSubject
    TEMP::DEFAULTNodeTestSubjectName
    TEMP::kabout
    testlearnReportTags::kgtestSection
    TEMP::testSubsectionNameForSubject
    TEMP::TimeStamp
    testSectionCreatedFromATemplate::reportNumber
    tempSetup::userLibraryName
    TEMP::testAndReportMainWindowHeader
    report::ktestSubject
    report::kreportNumber
    reportSubsection::name
    TEMP::testSubsectionName
    report::ktestSubsection
    TEMP::ktestSubsection
    TEMP::ktestItemSubsection
    reportTestSubjectLock::orderOrLock
    TEMP::primaryNodeIsLocked

Scripts used in this script

    returnToTestSetup
    CHUNK_gotoTestSubsectionViaPulldown

Layouts used in this script

    PrintReportEdit
    PrintReportLock

Tables used in this script

    TEMP
    TEMP
    report
    tag
    testSectionCreatedFromATemplate
    testSubsectionTemplate
    testlearn

Table occurrences used by this script

    TEMP
    report
    reportSubsection
    reportTestSubjectLock
    tempSetup
    testSectionCreatedFromATemplate
    testSubjectName
    testlearnReportTags

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [gotoReport]	Parent Folder: [report]	Next Script: [insertCaption2]
Script Name	insertCaption1
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    If [ report::kTag1 ≠ "" ]
    Set Field [ report::PictureCaptionInsteadOfPicture; testlearnReportTags::note ]
    Go to Field [ ]
    Else
    Set Field [ report::PictureCaptionInsteadOfPicture; "" ]
    Go to Field [ ]
    End If

Fields used in this script

    report::kTag1
    testlearnReportTags::note
    report::PictureCaptionInsteadOfPicture

Scripts used in this script

Layouts used in this script

Tables used in this script

    report
    testlearn

Table occurrences used by this script

    report
    testlearnReportTags

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [insertCaption1]	Parent Folder: [report]	Next Script: [insertCaption3]
Script Name	insertCaption2
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    If [ report::kTag2 ≠ "" ]
    Set Field [ report::PictureCaptionInsteadOfPicture[2]; testlearnReportTags 2::note ]
    Go to Field [ ]
    Else
    Set Field [ report::PictureCaptionInsteadOfPicture[2]; "" ]
    Go to Field [ ]
    End If

Fields used in this script

    report::kTag2
    testlearnReportTags 2::note
    report::PictureCaptionInsteadOfPicture

Scripts used in this script

Layouts used in this script

Tables used in this script

    report
    testlearn

Table occurrences used by this script

    report
    testlearnReportTags 2

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [insertCaption2]	Parent Folder: [report]	Next Script: [insertCaption4]
Script Name	insertCaption3
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    If [ report::kTag3 ≠ "" ]
    Set Field [ report::PictureCaptionInsteadOfPicture[3]; testlearnReportTags 3::note ]
    Go to Field [ ]
    Else
    Set Field [ report::PictureCaptionInsteadOfPicture[3]; "" ]
    Go to Field [ ]
    End If

Fields used in this script

    report::kTag3
    testlearnReportTags 3::note
    report::PictureCaptionInsteadOfPicture

Scripts used in this script

Layouts used in this script

Tables used in this script

    report
    testlearn

Table occurrences used by this script

    report
    testlearnReportTags 3

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [insertCaption3]	Parent Folder: [report]	Next Script: [newRowOfPhotos]
Script Name	insertCaption4
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    If [ report::kTag4 ≠ "" ]
    Set Field [ report::PictureCaptionInsteadOfPicture[4]; testlearnReportTags 4::note ]
    Go to Field [ ]
    Else
    Set Field [ report::PictureCaptionInsteadOfPicture[4]; "" ]
    Go to Field [ ]
    End If

Fields used in this script

    report::kTag4
    testlearnReportTags 4::note
    report::PictureCaptionInsteadOfPicture

Scripts used in this script

Layouts used in this script

Tables used in this script

    report
    testlearn

Table occurrences used by this script

    report
    testlearnReportTags 4

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [insertCaption4]	Parent Folder: [report]	Next Script: [nextPage]
Script Name	newRowOfPhotos
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    PrintReportEdit

Scripts that use this script

Script Definition
Script Steps

    #
    #If node is currenlty locked then stop script,
    #and inform the user.
    Perform Script [ “stopNewRecordsBeingCreatedByLockedNode” ]
    #
    Set Variable [ $testSubsection; Value:report::ktestSubsection ]
    #
    #create new report record and put in all required information
    New Record/Request
    Set Field [ report::ktestSubject; $$testSubject ]
    Set Field [ report::ktestSubsection; $$testSubsection ]
    Set Field [ report::kreportNumber; $$reportNumber ]
    #
    #IMPORTANT!!! Commit record or else it will
    #not be deleted if user suddently decides to
    #delete the last test result record.
    Commit Records/Requests
    #

Fields used in this script

    report::ktestSubsection
    report::ktestSubject
    report::kreportNumber

Scripts used in this script

    stopNewRecordsBeingCreatedByLockedNode

Layouts used in this script

Tables used in this script

    report

Table occurrences used by this script

    report

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [newRowOfPhotos]	Parent Folder: [report]	Next Script: [openDetailWindow !!! FINISH LATER !!!]
Script Name	nextPage
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    Set Variable [ $$first ]
    Set Variable [ $$last; Value:testSubsectionTemplate::_LtestSubsection ]
    Go to Record/Request/Page [ Next ]
    If [ $$last ≠ testSubsectionTemplate::_LtestSubsection or Get (LastError) = 101 ]
    Set Field [ TEMP::theme; testSubsectionTemplate::name ]
    Perform Script [ “loadSetupTestSubsection” ]
    End If
    Go to Field [ ]

Fields used in this script

    testSubsectionTemplate::_LtestSubsection
    testSubsectionTemplate::name
    TEMP::theme

Scripts used in this script

    loadSetupTestSubsection

Layouts used in this script

Tables used in this script

    TEMP
    testSubsectionTemplate

Table occurrences used by this script

    TEMP
    testSubsectionTemplate

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [nextPage]	Parent Folder: [report]	Next Script: [pagePulldown]
Script Name	openDetailWindow !!! FINISH LATER !!!
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    Go to Field [ ]
    Set Variable [ $$ID; Value:testSubsectionTemplate::_LtestSubsection ]
    Set Variable [ $workwindow; Value:Get (WindowName) ]
    Set Variable [ $left; Value:Get ( WindowLeft ) ]
    Set Variable [ $width; Value:Get ( WindowWidth) ]
    Select Window [ Name: $workwindow; Current file ]
    Set Field [ TEMP::ktestItemSubsection; testSubsectionTemplate::ktestItemGroup ]
    Set Field [ TEMP::ktestItemSubsectionOLD; testSubsectionTemplate::ktestItemGroup ]
    Set Field [ TEMP::ktestSubsection; testSubsectionTemplate::_LtestSubsection ]
    Set Field [ TEMP::testSubsectionName; testSubsectionTemplate::name ]
    Set Field [ TEMP::userLibraryName; testSubsectionLibraryName::name ]
    Select Window [ Name: "Details"; Current file ]
    If [ Get (LastError) = 112 ]
    If [ Get (WindowZoomLevel) = 100 ]
    New Window [ Name: "Details"; Height: Get (ScreenHeight); Width: 333; Left: If ( $left + $width + 333 > Get ( ScreenWidth ) ; Get ( ScreenWidth ) - 333 ; $left + $width ); Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Else If [ Get (WindowZoomLevel) = 150 ]
    New Window [ Name: "Details"; Height: Get (ScreenHeight); Width: 490; Left: If ( $left + $width > Get ( ScreenWidth ) - 490; Get ( ScreenWidth ) - 490 ; $left + $width ); Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    End If
    Go to Layout [ “setupTestItem” (tagMenus) ]
    End If
    #
    Set Variable [ $layout; Value:Get (LayoutName) ]
    Set Variable [ $$attributeReturnLayout; Value:Get (LayoutName) ]
    #Find all details for this item.
    Go to Layout [ “testMenuTestItemMORE” (tagMenus) ]
    // Set Variable [ $$citationMatch; Value:testSubsectionTemplate::_LtestSubsection ]
    #
    #Find detail tags for library section.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Enter Find Mode [ ]
    Set Field [ tagMenus::kGroupOrTest; TEMP::ktestItemSubsection ]
    Perform Find [ ]
    #
    #If no records exist then create one.
    If [ Get (FoundCount)=0 ]
    Perform Script [ “newTagMenuTagGroup” ]
    End If
    #
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuTestItemGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuTestItemGroup::name; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    #
    Go to Record/Request/Page [ First ]
    #
    #Find all locations for this item.
    #New items will not have any locations assigned so
    #error caputer needs to be turned on.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Go to Layout [ “setupTestSection” (testSection) ]
    View As [ View as Form ]
    Enter Find Mode [ ]
    Set Field [ testSubsectionTemplate::_LtestSubsection; $$ID ]
    Perform Find [ ]
    #
    Go to Layout [ $layout ]
    Refresh Window

Fields used in this script

    testSubsectionTemplate::_LtestSubsection
    testSubsectionTemplate::ktestItemGroup
    TEMP::ktestItemSubsection
    TEMP::ktestItemSubsectionOLD
    TEMP::ktestSubsection
    testSubsectionTemplate::name
    TEMP::testSubsectionName
    testSubsectionLibraryName::name
    TEMP::userLibraryName
    tagMenus::kGroupOrTest
    tagMenuTestItemGroup::orderOrLibraryType
    tagMenuTestItemGroup::name
    tagMenus::orderOrLock
    tagMenus::tag

Scripts used in this script

    newTagMenuTagGroup

Layouts used in this script

    setupTestItem
    testMenuTestItemMORE
    setupTestSection
    <Missing Layout>

Tables used in this script

    TEMP
    tag
    tagGroup
    tagGroup
    testSubsectionTemplate

Table occurrences used by this script

    TEMP
    tagMenuTestItemGroup
    tagMenus
    testSubsectionLibraryName
    testSubsectionTemplate

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [openDetailWindow !!! FINISH LATER !!!]	Parent Folder: [report]	Next Script: [previewReport]
Script Name	pagePulldown
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    Go to Field [ ]
    Set Variable [ $$first ]
    Set Variable [ $$last ]
    Set Variable [ $record; Value:TEMP::ktestSubsection ]
    If [ testSubsectionTemplate::_LtestSubsection = $record ]
    Exit Script [ ]
    End If
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ testSubsectionTemplate::_LtestSubsection = $record ]
    Go to Record/Request/Page [ Next ]
    End Loop
    Perform Script [ “loadSetupTestSubsection” ]

Fields used in this script

    TEMP::ktestSubsection
    testSubsectionTemplate::_LtestSubsection

Scripts used in this script

    loadSetupTestSubsection

Layouts used in this script

Tables used in this script

    TEMP
    testSubsectionTemplate

Table occurrences used by this script

    TEMP
    testSubsectionTemplate

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [pagePulldown]	Parent Folder: [report]	Next Script: [previousPage]
Script Name	previewReport
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    PrintReportEdit
    PrintReportLock

Scripts that use this script

Script Definition
Script Steps

    #
    #Exit field and clear preview viewing variable.
    #This variable is soley there to allow admin
    #users to test the print preview layout in the
    #new window that is opened for it by this
    #script. When it is active, the variable causes
    #the preview window's script to close it when
    #the user exits preview mode, and when clear,
    #an admin user can exit preview mode and the
    #will window will stay open. That is all this
    #variable is for.
    # Of course, in testing sometimes this
    #variable is left active, and thus the preview
    #window closes right after is opened by this
    #script, so it is essential that this variable is
    #cleared at the beginning of this script, so as
    #not to confuse admin testers.
    Go to Field [ ]
    Set Variable [ $$preview ]
    #
    #Make sure only one preview window is open.
    Close Window [ Name: "Print Preview"; Current file ]
    New Window [ Name: "Print Preview"; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “PrintReportPreview” (report) ]
    #
    #Perform the sort show layout's headers
    #and footers.
    Sort Records [ Keep records in sorted order; Specified Sort Order: ruleTestReport::name; ascending reportSubsection::name; ascending ] [ Restore; No dialog ]
    Show/Hide Toolbars [ Lock; Show ]
    #
    #Go the first page.
    Set Variable [ $page; Value:Get (PageNumber) ]
    Enter Preview Mode
    Go to Record/Request/Page [ $page ] [ No dialog ]
    #
    #Tell the user why they cannot see web
    #or movie media.
    Show Custom Dialog [ Message: "NOTE: Only pictures in the Library or pictures linked to a file on a harddrive are printable. FileMaker won't print web or movie files. "; Default Button: “OK”, Commit: “Yes” ]
    #
    #Tell the user how to close this window and
    #how to go to different pages if there is more
    #than one page to preview.
    Show Custom Dialog [ Message: "Click the 'exit preview' button to close this window. Click the page numbers (upper left corner) to see additional pages if there are any."; Default Button: “OK”, Commit: “Yes” ]
    #
    #Change menu to allow user to enter browse mode
    #which makes the 'exit preview' button clickable.
    #Menu also adds ability to browse records, which
    #is essential for allowing user to browse pages of report.
    Install Menu Set [ “HGT Preview” ]
    #
    #Set preview variable so when user click's the
    #'exit preview' button this window will close.
    Set Variable [ $$preview; Value:1 ]
    #

Fields used in this script

    ruleTestReport::name
    reportSubsection::name

Scripts used in this script

Layouts used in this script

    PrintReportPreview

Tables used in this script

    tagGroup
    testSubsectionTemplate

Table occurrences used by this script

    reportSubsection
    ruleTestReport

Custom Functions used by this script

Custom menu set used by this script

    HGT Preview


Previous Script: [previewReport]	Parent Folder: [report]	Next Script: [removeTestResultOrInfoRecordFromReport]
Script Name	previousPage
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    Set Variable [ $$last ]
    Set Variable [ $$first; Value:testSubsectionTemplate::_LtestSubsection ]
    Go to Record/Request/Page [ Previous ]
    If [ $$first ≠ testSubsectionTemplate::_LtestSubsection or Get (LastError) = 101 ]
    Set Field [ TEMP::theme; testSubsectionTemplate::name ]
    Perform Script [ “loadSetupTestSubsection” ]
    Refresh Window
    End If
    Go to Field [ ]

Fields used in this script

    testSubsectionTemplate::_LtestSubsection
    testSubsectionTemplate::name
    TEMP::theme

Scripts used in this script

    loadSetupTestSubsection

Layouts used in this script

Tables used in this script

    TEMP
    testSubsectionTemplate

Table occurrences used by this script

    TEMP
    testSubsectionTemplate

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [previousPage]	Parent Folder: [report]	Next Script: [reportCopyPastPart1]
Script Name	removeTestResultOrInfoRecordFromReport
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    clearpicture1
    clearpicture2
    clearpicture3
    clearpicture4

Script Definition
Script Steps

    #
    #If user is trying to clear a blank field
    #stop the script
    If [ Get (ActiveFieldContents) = "" ]
    Go to Field [ ]
    Halt Script
    End If
    #
    #
    #Copy tag record's key; then clear it
    #from its current slot.
    Set Variable [ $clear; Value:Get ( ActiveFieldContents ) ]
    Clear [ ] [ Select ]
    Go to Field [ ]
    #
    #
    #Find this cleared tag record
    #in the Tag Menus window.
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    #Turn off record load script.
    Set Variable [ $$stopLoadTestResultRecord; Value:1 ]
    #
    #First, check if record is a test result.
    If [ Get (LayoutName) ≠ "reportTestResult" ]
    #
    #Find all test results for this subsection.
    Go to Layout [ “reportTestResult” (testlearnReportTags) ]
    Enter Find Mode [ ]
    Set Field [ testlearnReportTags::ktestSubject; TEMP::kdefaultNodeTestSubject ]
    Set Field [ testlearnReportTags::ktestSubsection; TEMP::ktestSubsection ]
    Set Field [ testlearnReportTags::kreportNumber; TEMP::reportNumber ]
    Perform Find [ ]
    Set Variable [ $$citationMatch; Value:"testResult" ]
    #
    #Sort based on users current sort for
    #test result records.
    If [ TEMP::TLTestSort = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearnReportTags::date; descending testlearnReportTags::timestamp; descending ] [ Restore; No dialog ]
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearnReportTags::orderTestResult; based on value list: “testPulldownListANDsortOrderList” testlearnReportTags::timestamp; descending ] [ Restore; No dialog ]
    End If
    End If
    Go to Field [ ]
    #
    #If it not selected, find and select it.
    If [ $clear ≠ testlearnReportTags::_Ltestlearn ]
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ $clear = testlearnReportTags::_Ltestlearn ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    End If
    #
    #Turn back on record load script.
    Set Variable [ $$stopLoadTestResultRecord ]
    #
    #If it is a test result record, return to the
    #Report window and halt this script allowing
    #the user to continue editing the report.
    If [ $clear = testlearnReportTags::_Ltestlearn ]
    #If it is a test result record, note that
    #it is not in use.
    Set Field [ testlearnReportTags::kcInUseOnReportSubsection; "" ]
    #
    Perform Script [ “loadReportTestResultRecord” ]
    Refresh Window
    #
    Select Window [ Name: "Report"; Current file ]
    Halt Script
    End If
    #
    #
    #
    #If it is not a test result record, then it must
    #be an info record. Find this record and
    #then return to the Report window and halt
    #this script.
    If [ $clear ≠ testlearnReportTags::_Ltestlearn ]
    #
    #Turn off record load script and find
    #all info records for this test section.
    Set Variable [ $$stopPart3InProgress; Value:1 ]
    Perform Script [ “reportTagInfo” ]
    #
    #Find and select cleared test info record.
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ $clear = testlearnReportTags::_Ltestlearn ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Start to remove its key from this info record's
    #keychain of pasted info records pasted
    #on reports.
    Set Variable [ $inUse; Value:testlearnReportTags::kcInUseOnReportSubsection ]
    #
    #Find out how many times its was used on the
    #same report as a user can copy a learn record
    #and paste it multiple times.
    Set Variable [ $numberOfTimesUsedOnSameReport; Value:ValueCount ( FilterValues ( testlearnReportTags::kcInUseOnReportSubsection ; $$testSubsection & $$testSubject & $$reportNumber & ¶ ) ) ]
    #
    #Remove all copies of the key.
    Set Field [ testlearnReportTags::kcInUseOnReportSubsection; Substitute ( testlearnReportTags::kcInUseOnReportSubsection ; $$testSubsection & $$testSubject & $$reportNumber & ¶ ; "" ) ]
    Set Variable [ $inUse; Value:testlearnReportTags::kcInUseOnReportSubsection ]
    #
    #If it was used more than 1 time, put back
    #the other copies still in use.
    If [ $numberOfTimesUsedOnSameReport - 1 > 0 ]
    Set Variable [ $countDown; Value:$numberOfTimesUsedOnSameReport - 1 ]
    Loop
    Set Field [ testlearnReportTags::kcInUseOnReportSubsection; $inUse & $$testSubsection & $$testSubject & $$reportNumber & ¶ ]
    Set Variable [ $inUse; Value:testlearnReportTags::kcInUseOnReportSubsection ]
    Set Variable [ $countDown; Value:$countDown - 1 ]
    Exit Loop If [ $countDown = 0 ]
    End Loop
    End If
    #
    #Turn back on record load script.
    Set Variable [ $$stopPart3InProgress ]
    #
    #Reset conditional formatting variables, then
    #return to the Report window and halt
    #this script.
    Perform Script [ “loadTestInfo” ]
    #
    Select Window [ Name: "Report"; Current file ]
    Halt Script
    End If
    #

Fields used in this script

    TEMP::kdefaultNodeTestSubject
    testlearnReportTags::ktestSubject
    TEMP::ktestSubsection
    testlearnReportTags::ktestSubsection
    TEMP::reportNumber
    testlearnReportTags::kreportNumber
    TEMP::TLTestSort
    testlearnReportTags::date
    testlearnReportTags::timestamp
    testlearnReportTags::orderTestResult
    testlearnReportTags::_Ltestlearn
    testlearnReportTags::kcInUseOnReportSubsection

Scripts used in this script

    loadReportTestResultRecord
    reportTagInfo
    loadTestInfo

Layouts used in this script

    reportTestResult

Tables used in this script

    TEMP
    testlearn

Table occurrences used by this script

    TEMP
    testlearnReportTags

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [removeTestResultOrInfoRecordFromReport]	Parent Folder: [report]	Next Script: [reportCopyPastPart3]
Script Name	reportCopyPastPart1
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    reportTestResult
    reportTagInfo

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Stop this script if any of the following are true:
    #
    #Test subject is locked.
    If [ $$testSubjectIsLocked ≠ "" and Get ( LayoutName ) ≠ "defaultTest" and Get ( LayoutName ) ≠ "learnTest" ]
    Show Custom Dialog [ Message: "The test subject — " & $$testSubjectIsLocked & " — is locked. To unlock, A) go back to the setup node tag menu. B) Select this test subject. C) Click 'lock' and enter the password."; Default Button: “OK”, Commit: “No” ]
    Set Variable [ $exit; Value:1 ]
    End If
    #
    #Primary node is locked.
    If [ TEMP::primaryNodeIsLocked ≠ "" ]
    If [ $exit = "" ]
    Show Custom Dialog [ Message: "The default primary node — " & TEMP::DEFAULTNodePrimaryName & " — is locked. Go to the Default Node Tag Menu and A) click 'lock' to unlock it, B) select an unlocked node for the primary node, or C) create a new primary node."; Default Button: “OK”, Commit: “No” ]
    Else
    Show Custom Dialog [ Message: "ALSO, the default primary node — " & TEMP::DEFAULTNodePrimaryName & " — is locked. Go to the Default Node Tag Menu and A) click 'lock' to unlock it, B) select an unlocked node for the primary node, or C) create a new primary node."; Default Button: “OK”, Commit: “No” ]
    End If
    Set Variable [ $exit; Value:1 ]
    End If
    #
    #If any of the above are true, then
    #exit this script.
    If [ $exit = 1 ]
    Exit Script [ ]
    End If
    #
    #
    If [ $$finding ≠ "" ]
    Set Variable [ $$Finding ]
    Go to Field [ ]
    Refresh Window
    Select Window [ Name: "Report"; Current file ]
    Refresh Window
    Select Window [ Name: "Tag Menus"; Current file ]
    Exit Script [ ]
    End If
    #
    If [ testlearnReportTags::ktestSubject & $$reportNumber & "¶" = FilterValues ( testlearnReportTags::kcInUseOnReportSubsection ; $$testSubject & $$reportNumber) ]
    Go to Field [ ]
    Show Custom Dialog [ Title: "!"; Message: "Already in use on this section of the report. Click on " & testlearnReportTags::_Number & " on the Report screen to begin the process of moving it to a different slot. Click on a different slot to complete the move."; Default Button: “OK”, Commit: “No” ]
    Halt Script
    End If
    Set Variable [ $$finding; Value:testlearnReportTags::_Ltestlearn ]
    Set Variable [ $$findingCaption; Value:testlearnReportTags::note ]
    Set Variable [ $$window; Value:"Tag Menus" ]
    Go to Field [ ]
    Refresh Window
    Select Window [ Name: "Report"; Current file ]
    Refresh Window
    #

Fields used in this script

    TEMP::primaryNodeIsLocked
    TEMP::DEFAULTNodePrimaryName
    testlearnReportTags::ktestSubject
    testlearnReportTags::kcInUseOnReportSubsection
    testlearnReportTags::_Number
    testlearnReportTags::_Ltestlearn
    testlearnReportTags::note

Scripts used in this script

Layouts used in this script

Tables used in this script

    TEMP
    testlearn

Table occurrences used by this script

    TEMP
    testlearnReportTags

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [reportCopyPastPart1]	Parent Folder: [report]	Next Script: [reportExitOnRecordLoad]
Script Name	reportCopyPastPart3
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    reportCopyPastPart2Tag1
    reportCopyPastPart2Tag2
    reportCopyPastPart2Tag3
    reportCopyPastPart2Tag4

Script Definition
Script Steps

    #
    #
    #BEGIN A
    #
    #COPY record key on Report window.
    #
    If [ Get ( ActiveFieldName ) = "kTag1" and $$finding = "" or Get ( ActiveFieldName ) = "kTag2" and $$finding = "" or Get ( ActiveFieldName ) = "kTag3" and $$finding = "" or Get ( ActiveFieldName ) = "kTag4" and $$finding = "" ]
    #
    #If record slot is blank, there is nothing
    #to copy so exit this script.
    If [ $$finding = "" and Get (ActiveFieldContents) = "" ]
    Go to Field [ ]
    Halt Script
    End If
    #
    #Copy tag record's key; then clear it
    #from its current slot.
    Set Variable [ $$finding; Value:Get ( ActiveFieldContents ) ]
    Set Variable [ $$window; Value:"Report" ]
    Refresh Window
    Clear [ ] [ Select ]
    Go to Field [ ]
    #
    #Find this copied tag record in
    #the Tag Menus window.
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    #Turn off record load script.
    Set Variable [ $$stopLoadTestResultRecord; Value:1 ]
    #
    #First, check if record is a test result.
    If [ Get (LayoutName) ≠ "reportTestResult" ]
    #
    #Find all test results for this subsection.
    Go to Layout [ “reportTestResult” (testlearnReportTags) ]
    Enter Find Mode [ ]
    Set Field [ testlearnReportTags::ktestSubject; TEMP::kdefaultNodeTestSubject ]
    Set Field [ testlearnReportTags::ktestSubsection; TEMP::ktestSubsection ]
    Set Field [ testlearnReportTags::kreportNumber; TEMP::reportNumber ]
    Perform Find [ ]
    Set Variable [ $$citationMatch; Value:"testResult" ]
    #
    #Sort based on users current sort for
    #test result records.
    If [ TEMP::TLTestSort = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearnReportTags::date; descending testlearnReportTags::timestamp; descending ] [ Restore; No dialog ]
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearnReportTags::orderTestResult; based on value list: “testPulldownListANDsortOrderList” testlearnReportTags::timestamp; descending ] [ Restore; No dialog ]
    End If
    End If
    Go to Field [ ]
    #
    #If it not selected, find and select it.
    If [ $$finding ≠ testlearnReportTags::_Ltestlearn ]
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ $$finding = testlearnReportTags::_Ltestlearn ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    End If
    #
    #Turn back on record load script.
    Set Variable [ $$stopLoadTestResultRecord ]
    #
    #If it is a test result record, return to the
    #Report window and halt this script allowing
    #the user to paste the test result into a
    #yellow slot.
    If [ $$finding = testlearnReportTags::_Ltestlearn ]
    #
    #If it is a test result record, note that
    #it is copied and not in use.
    Set Field [ testlearnReportTags::kcInUseOnReportSubsection; "" ]
    #
    Perform Script [ “loadReportTestResultRecord” ]
    #
    Select Window [ Name: "Report"; Current file ]
    Halt Script
    End If
    #
    #
    #
    #If it is not a test result record, then it must
    #be an info record. Find this record and
    #then return to the Report window and halt
    #this script allowing the user to paste its key
    #into a yellow slot.
    If [ $$finding ≠ testlearnReportTags::_Ltestlearn ]
    #
    #Turn off record load script and find
    #all info records for this test section.
    Set Variable [ $$stopPart3InProgress; Value:1 ]
    Perform Script [ “reportTagInfo” ]
    #
    #Find and select copied test info record.
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ $$finding = testlearnReportTags::_Ltestlearn ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Start to remove its key from this info record's
    #keychain of pasted info records pasted
    #on reports.
    Set Variable [ $inUse; Value:testlearnReportTags::kcInUseOnReportSubsection ]
    #
    #Find out how many times its was used on the
    #same report as a user can copy a learn record
    #and paste it multiple times.
    Set Variable [ $numberOfTimesUsedOnSameReport; Value:ValueCount ( FilterValues ( testlearnReportTags::kcInUseOnReportSubsection ; $$testSubsection & $$testSubject & $$reportNumber & ¶ ) ) ]
    #
    #Remove all copies of the key.
    Set Field [ testlearnReportTags::kcInUseOnReportSubsection; Substitute ( testlearnReportTags::kcInUseOnReportSubsection ; $$testSubsection & $$testSubject & $$reportNumber & ¶ ; "" ) ]
    Set Variable [ $inUse; Value:testlearnReportTags::kcInUseOnReportSubsection ]
    #
    #If it was used more than 1 time, put back
    #the other copies still in use.
    If [ $numberOfTimesUsedOnSameReport - 1 > 0 ]
    Set Variable [ $countDown; Value:$numberOfTimesUsedOnSameReport - 1 ]
    Loop
    Set Field [ testlearnReportTags::kcInUseOnReportSubsection; $inUse & $$testSubsection & $$testSubject & $$reportNumber & ¶ ]
    Set Variable [ $inUse; Value:testlearnReportTags::kcInUseOnReportSubsection ]
    Set Variable [ $countDown; Value:$countDown - 1 ]
    Exit Loop If [ $countDown = 0 ]
    End Loop
    End If
    #
    #Turn back on record load script.
    Set Variable [ $$stopPart3InProgress ]
    #
    #Reset conditional formatting variables, then
    #return to the Report window and halt
    #this script allowing the user to paste
    #the info record's key into a yellow slot.
    Perform Script [ “loadTestInfo” ]
    #
    Select Window [ Name: "Report"; Current file ]
    Halt Script
    End If
    #
    #END A
    #
    #
    #
    #
    #
    #BEGIN B
    #
    #PASTE record key copied from the Report
    #window into a BLANK slot.
    #
    Else If [ Get ( ActiveFieldName ) = "kTag1" and Get ( ActiveFieldContents )="" and $$finding ≠ "" and $$window = "Report" or Get ( ActiveFieldName ) = "kTag2" and Get ( ActiveFieldContents )="" and $$finding ≠ "" and $$window = "Report" or Get ( ActiveFieldName ) = "kTag3" and Get ( ActiveFieldContents )="" and $$finding ≠ "" and $$window = "Report" or Get ( ActiveFieldName ) = "kTag4" and Get ( ActiveFieldContents )="" and $$finding ≠ "" and $$window = "Report" ]
    #
    #Paste record key selected into blank slot.
    Set Field [ $$finding ]
    Go to Field [ ]
    #
    #Find this pasted tag record
    #in the Tag Menus window.
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    #Turn off record load script.
    Set Variable [ $$stopLoadTestResultRecord; Value:1 ]
    #
    #First, check if record is a test result.
    If [ Get (LayoutName) ≠ "reportTestResult" ]
    #
    #Find all test results for this subsection.
    Go to Layout [ “reportTestResult” (testlearnReportTags) ]
    Enter Find Mode [ ]
    Set Field [ testlearnReportTags::ktestSubject; TEMP::kdefaultNodeTestSubject ]
    Set Field [ testlearnReportTags::ktestSubsection; TEMP::ktestSubsection ]
    Set Field [ testlearnReportTags::kreportNumber; TEMP::reportNumber ]
    Perform Find [ ]
    Set Variable [ $$citationMatch; Value:"testResult" ]
    #
    #Sort based on users current sort for
    #test result records.
    If [ TEMP::TLTestSort = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearnReportTags::date; descending testlearnReportTags::timestamp; descending ] [ Restore; No dialog ]
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearnReportTags::orderTestResult; based on value list: “testPulldownListANDsortOrderList” testlearnReportTags::timestamp; descending ] [ Restore; No dialog ]
    End If
    End If
    #
    #Find the copied record, if it is not selected.
    If [ $$finding ≠ testlearnReportTags::_Ltestlearn ]
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ $$finding = testlearnReportTags::_Ltestlearn ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    End If
    #
    #Turn back on record load script.
    Set Variable [ $$stopLoadTestResultRecord ]
    #
    #If it is a test result record, note that
    #it is now in use.
    If [ $$finding = testlearnReportTags::_Ltestlearn ]
    Set Field [ testlearnReportTags::kcInUseOnReportSubsection; $$testSubject & $$reportNumber & "¶" ]
    #
    #Return to the Report window and
    #halt this script after clearing yellow
    #conditional formatting variables.
    Set Variable [ $$finding ]
    Set Variable [ $$window ]
    Perform Script [ “loadReportTestResultRecord” ]
    #
    Select Window [ Name: "Report"; Current file ]
    Refresh Window
    Halt Script
    End If
    #
    #
    #
    #If it is not a test result record, then it must
    #be an info record. Find this record and
    #then return to the Report window and halt
    #this script after noting that this info record is
    #being used on this test subject's report.
    If [ $$finding ≠ testlearnReportTags::_Ltestlearn ]
    #
    #Turn off record load script and find
    #all info records for this test section.
    Set Variable [ $$stopPart3InProgress; Value:1 ]
    Perform Script [ “reportTagInfo” ]
    #
    #Find and select copied test info record.
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ $$finding = testlearnReportTags::_Ltestlearn ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Insert test-subject's key and report number
    #into this info record's keychain.
    Set Variable [ $inUse; Value:testlearnReportTags::kcInUseOnReportSubsection ]
    Set Field [ testlearnReportTags::kcInUseOnReportSubsection; $inUse & $$testSubsection & $$testSubject & $$reportNumber & ¶ ]
    #
    #Turn back on record load script.
    Set Variable [ $$stopPart3InProgress ]
    #
    #Return to the Report window and
    #halt this script after clearing yellow
    #conditional formatting variables.
    Set Variable [ $$finding ]
    Set Variable [ $$window ]
    Perform Script [ “loadTestInfo” ]
    #
    Select Window [ Name: "Report"; Current file ]
    Refresh Window
    Halt Script
    End If
    #
    #END B
    #
    #
    #
    #
    #
    #BEGIN C
    #
    #PASTE record key copied from Report window
    #into an OCCUPIED slot.
    #
    #If user has selected to insert a copied finding from the Report window,
    #into a slot already occupied,
    #PREVENT USER FROM DOING SO. DISABLE PART C.
    Else If [ Get ( ActiveFieldName ) = "kTag1" and Get ( ActiveFieldContents ) ≠ "" and $$window = "Report" or Get ( ActiveFieldName ) = "kTag2" and Get ( ActiveFieldContents ) ≠ "" and $$window = "Report" or Get ( ActiveFieldName ) = "kTag3" and Get ( ActiveFieldContents ) ≠ "" and $$window = "Report" or Get ( ActiveFieldName ) = "kTag4" and Get ( ActiveFieldContents ) ≠ ""and $$window = "Report" ]
    Go to Field [ ]
    #
    #Inform user that they can past only
    #into empty slots.
    Show Custom Dialog [ Message: "Click the X button to clear this slot before pasting anything into it."; Default Button: “OK”, Commit: “No” ]
    Exit Script [ ]
    #
    #END C
    #
    #
    #
    #
    #
    #BEGIN D
    #
    #PASTE record key copied from Tag Menus
    #window into an OCCUPIED slot.
    #
    #Prevent pasting keys into occupied slots.
    Else If [ Get ( ActiveFieldName ) = "kTag1" and Get ( ActiveFieldContents ) ≠ "" and $$window = "Tag Menus" or Get ( ActiveFieldName ) = "kTag2" and Get ( ActiveFieldContents ) ≠ "" and $$window = "Tag Menus" or Get ( ActiveFieldName ) = "kTag3" and Get ( ActiveFieldContents ) ≠ "" and $$window = "Tag Menus" or Get ( ActiveFieldName ) = "kTag4" and Get ( ActiveFieldContents ) ≠ ""and $$window = "Tag Menus" ]
    Go to Field [ ]
    #
    #Inform user that they can past only
    #into empty slots.
    Show Custom Dialog [ Message: "Click the X button to clear this slot before pasting anything into it."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #END D
    #
    #
    #
    #
    #
    #BEGIN E
    #
    #PASTE record key copied from Tag Menus
    #into a BLANK slot.
    #
    #Paste record key selected blank slot.
    Set Field [ $$finding ]
    Set Field [ $$finding ]
    Go to Field [ ]
    #
    #Find and this pasted tag record
    #in the Tag Menus window.
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    #Turn off record load script.
    Set Variable [ $$stopLoadTestResultRecord; Value:1 ]
    #
    #First, check if record is a test result.
    If [ Get (LayoutName) ≠ "reportTestResult" ]
    #
    #Find all test results for this subsection.
    Go to Layout [ “reportTestResult” (testlearnReportTags) ]
    Enter Find Mode [ ]
    Set Field [ testlearnReportTags::ktestSubject; TEMP::kdefaultNodeTestSubject ]
    Set Field [ testlearnReportTags::ktestSubsection; TEMP::ktestSubsection ]
    Set Field [ testlearnReportTags::kreportNumber; TEMP::reportNumber ]
    Perform Find [ ]
    Set Variable [ $$citationMatch; Value:"testResult" ]
    #
    #Sort based on users current sort for
    #test result records.
    If [ TEMP::TLTestSort = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearnReportTags::date; descending testlearnReportTags::timestamp; descending ] [ Restore; No dialog ]
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearnReportTags::orderTestResult; based on value list: “testPulldownListANDsortOrderList” testlearnReportTags::timestamp; descending ] [ Restore; No dialog ]
    End If
    End If
    Go to Field [ ]
    #
    #Find the copied record, if it is not selected.
    If [ $$finding ≠ testlearnReportTags::_Ltestlearn ]
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ $$finding = testlearnReportTags::_Ltestlearn ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    End If
    #
    #Turn back on record load script.
    Set Variable [ $$stopLoadTestResultRecord ]
    #
    #If it is a test result record, note that
    #it is now in use.
    If [ $$finding = testlearnReportTags::_Ltestlearn ]
    Set Field [ testlearnReportTags::kcInUseOnReportSubsection; $$testSubject & $$reportNumber & "¶" ]
    #
    #Return to the Report window and
    #halt this script after clearing yellow
    #conditional formatting variables.
    Set Variable [ $$finding ]
    Set Variable [ $$window ]
    Perform Script [ “loadReportTestResultRecord” ]
    #
    Select Window [ Name: "Report"; Current file ]
    Refresh Window
    Halt Script
    End If
    #
    #
    #
    #If it is not a test result record, then it must
    #be an info record. Find this record and
    #then return to the Report window and halt
    #this script after noting that this info record is
    #being used on this test subject's report.
    If [ $$finding ≠ testlearnReportTags::_Ltestlearn ]
    #
    #Turn off record load script and find
    #all info records for this test section.
    Set Variable [ $$stopPart3InProgress; Value:1 ]
    Perform Script [ “reportTagInfo” ]
    #
    #Find and select copied test info record.
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ $$finding = testlearnReportTags::_Ltestlearn ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Insert test-subject's key and report number
    #into this info record's keychain.
    Set Variable [ $inUse; Value:testlearnReportTags::kcInUseOnReportSubsection ]
    Set Field [ testlearnReportTags::kcInUseOnReportSubsection; $inUse & $$testSubsection & $$testSubject & $$reportNumber & ¶ ]
    #
    #Turn back on record load script.
    Set Variable [ $$stopPart3InProgress ]
    #
    #Return to the Report window and
    #halt this script after clearing yellow
    #conditional formatting variables.
    Set Variable [ $$finding ]
    Set Variable [ $$window ]
    Perform Script [ “loadTestInfo” ]
    #
    Select Window [ Name: "Report"; Current file ]
    Refresh Window
    Halt Script
    End If
    #
    #END E
    #

Fields used in this script

    TEMP::kdefaultNodeTestSubject
    testlearnReportTags::ktestSubject
    TEMP::ktestSubsection
    testlearnReportTags::ktestSubsection
    TEMP::reportNumber
    testlearnReportTags::kreportNumber
    TEMP::TLTestSort
    testlearnReportTags::date
    testlearnReportTags::timestamp
    testlearnReportTags::orderTestResult
    testlearnReportTags::_Ltestlearn
    testlearnReportTags::kcInUseOnReportSubsection

Scripts used in this script

    loadReportTestResultRecord
    reportTagInfo
    loadTestInfo

Layouts used in this script

    reportTestResult

Tables used in this script

    TEMP
    testlearn

Table occurrences used by this script

    TEMP
    testlearnReportTags

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [reportCopyPastPart3]	Parent Folder: [report]	Next Script: [reportPreviewClose]
Script Name	reportExitOnRecordLoad
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    If [ $$stopLoadReportRecord = 1 ]
    Exit Script [ ]
    End If
    Go to Field [ ]

Fields used in this script

Scripts used in this script

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [reportExitOnRecordLoad]	Parent Folder: [report]	Next Script: [reportTagInfo]
Script Name	reportPreviewClose
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #Close print preview window and change menu
    #set, so user can no longer change records and
    #no longer sees 'Browse Mode' edit menu option.
    If [ $$preview = 1 ]
    Close Window [ Current Window ]
    Install Menu Set [ “HGT” ]
    End If
    Set Variable [ $$preview ]

Fields used in this script

Scripts used in this script

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script

    HGT


Previous Script: [reportPreviewClose]	Parent Folder: [report]	Next Script: [reportTestResult]
Script Name	reportTagInfo
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    testMenuTestItem
    reportTestResult
    reportTestResultLocked
    reportTagItem

Scripts that use this script

    gotoDefaultsOrReport
    removeTestResultOrInfoRecordFromReport
    reportCopyPastPart3

Script Definition
Script Steps

    #
    #Admin tasks.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    #
    #Turn off record load scripts.
    Set Variable [ $$stoploadtestinfo; Value:1 ]
    Set Variable [ $$stoploadCitation; Value:1 ]
    #
    #Note if in testing or reporting mode.
    If [ Left ( Get (LayoutName) ; 6 ) = "report" ]
    Set Variable [ $reportLayout; Value:1 ]
    Else If [ Left ( Get (LayoutName) ; 6 ) ≠ "report" ]
    Set Variable [ $testLayout; Value:1 ]
    End If
    Go to Layout [ “reportTagInfo” (testlearnReportTags) ]
    #
    #Go to testinfo layout.
    Enter Find Mode [ ]
    #
    #Find and show all informational
    #(Learn module) records tagged
    #to this test section.
    Set Field [ testlearnReportTags::kctestSubsectionInfo; "###" & $$testSubsection ]
    Perform Find [ ]
    #
    #Clear brainstorm and test tags.
    Set Variable [ $$tagBrainstorm ]
    Set Variable [ $$tagtest ]
    Set Variable [ $$tagRecordID ]
    Set Variable [ $$tagEdit ]
    #
    #Now refind these same records on this
    #testlearn layout to perform the next part of
    #this script.
    Go to Layout [ “learn2” (testlearn) ]
    Enter Find Mode [ ]
    Set Field [ testlearn::kctestSubsectionInfo; "###" & $$testSubsection ]
    Perform Find [ ]
    #
    #The order number is the left three digits of a
    #brainstorm or test record lock number. ( Remember
    #each record in the database has lock number or
    #ID number. To open the lock and see any record's
    #contents requires a key number that fits the lock.
    #So if a lock number is 123, then the key that will
    #fit this lock is 123 too. ) Because the brainstorm
    #and test key fields (think of key chains) may
    #have several keys, because any one learn record
    #may be part of more than one brainstorm or test,
    #the system must check each learn record's keys
    #one at a time to see if any fit the current brainstorm
    #or test's lock. So beginning with number one
    #the system checks each key.
    # The left most 3 numbers are order
    #numbers which the next script will copy,
    #paste into the records' testOrder fields, and
    #then sort based on this these temporary test
    #order numbers.
    Set Variable [ $$citationMatch; Value:"test" ]
    Set Variable [ $$tagTest; Value:$$testSubsection ]
    Perform Script [ “sortTestOrBrainstormTaggedLearnRecords” ]
    #
    If [ $reportLayout = 1 ]
    Go to Layout [ “reportTagInfo” (testlearnReportTags) ]
    Else If [ $testLayout = 1 ]
    Go to Layout [ “testInfo” (testlearnReportTags) ]
    End If
    #
    #Sort button script uses the "order" text to tell
    #it to perform the next sort by date instead of
    #by order number which is the default sort.
    Set Field [ TEMP::TLTestSort; "order" ]
    #
    #Sort the records by order field.
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearnReportTags::orderTestInformation; based on value list: “order Pulldown List” testlearnReportTags::timestamp; descending ] [ Restore; No dialog ]
    #
    #Return to record user was on at
    #the start of this script.
    Go to Record/Request/Page [ First ]
    Scroll Window [ Home ]
    #
    #Turn loadcitation script back on and exit script.
    Set Variable [ $$stoploadtestinfo ]
    Set Variable [ $$stoploadCitation ]
    Perform Script [ “loadTestInfo” ]
    #
    #

Fields used in this script

    testlearnReportTags::kctestSubsectionInfo
    testlearn::kctestSubsectionInfo
    TEMP::TLTestSort
    testlearnReportTags::orderTestInformation
    testlearnReportTags::timestamp

Scripts used in this script

    sortTestOrBrainstormTaggedLearnRecords
    loadTestInfo

Layouts used in this script

    reportTagInfo
    learn2
    testInfo

Tables used in this script

    TEMP
    testlearn

Table occurrences used by this script

    TEMP
    testlearn
    testlearnReportTags

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [reportTagInfo]	Parent Folder: [report]	Next Script: [showPicture1]
Script Name	reportTestResult
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    reportTestResult
    reportTestResultLocked
    reportTagItem
    reportTagInfo

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #If there are information records, then set this
    #variable below to inform the user of this fact
    #by highlighting the info button on the
    #Test Menus layout, but only if user is on the
    #testInfo layout.
    If [ Get(LayoutName) = "testInfo" or Get(LayoutName) = "reportTagInfo" ]
    If [ Get (FoundCount) ≠ 0 ]
    Set Variable [ $$thereIsInfoForThisSubsection; Value:1 ]
    Else
    Set Variable [ $$thereIsInfoForThisSubsection ]
    End If
    End If
    #
    #
    #Find all test results for this subsection.
    Set Variable [ $$stopLoadTestResultRecord; Value:1 ]
    Go to Layout [ “reportTestResult” (testlearnReportTags) ]
    Enter Find Mode [ ]
    Set Field [ testlearnReportTags::ktestSubject; TEMP::kdefaultNodeTestSubject ]
    Set Field [ testlearnReportTags::ktestSubsection; TEMP::ktestSubsection ]
    Set Field [ testlearnReportTags::kreportNumber; TEMP::reportNumber ]
    Perform Find [ ]
    Set Variable [ $$citationMatch; Value:"testResult" ]
    #
    #
    #Go to the locked layout if the primary node
    #is locked.
    If [ TEMP::primaryNodeIsLocked ≠ "" // or // TEMP::primaryNodesCreatorNodeIsLocked ≠ "" ]
    Go to Layout [ “reportTestResultLocked” (testlearnReportTags) ]
    End If
    #
    #
    #Go to the locked layout if the test subject
    #is locked.
    If [ ReportResultTestSubject::orderOrLock ≠ "" ]
    Go to Layout [ “reportTestResultLocked” (testlearnReportTags) ]
    End If
    #
    #
    #Sort based on users current sort for
    #test result records.
    If [ TEMP::TLTestSort = "" ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearnReportTags::date; descending testlearnReportTags::timestamp; descending ] [ Restore; No dialog ]
    Else
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearnReportTags::orderTestResult; based on value list: “testPulldownListANDsortOrderList” testlearnReportTags::timestamp; descending ] [ Restore; No dialog ]
    End If
    #
    Go to Record/Request/Page [ First ]
    Set Field [ TEMP::TimeStamp; "" ]
    Set Variable [ $$main ]
    Set Variable [ $$stopLoadTestResultRecord ]
    #
    #Load up the variables for the current record,
    #and if neccessary resize the windows.
    Perform Script [ “loadReportTestResultRecord” ]
    #
    #

Fields used in this script

    TEMP::kdefaultNodeTestSubject
    testlearnReportTags::ktestSubject
    TEMP::ktestSubsection
    testlearnReportTags::ktestSubsection
    TEMP::reportNumber
    testlearnReportTags::kreportNumber
    TEMP::primaryNodeIsLocked
    ReportResultTestSubject::orderOrLock
    TEMP::TLTestSort
    testlearnReportTags::date
    testlearnReportTags::timestamp
    testlearnReportTags::orderTestResult
    TEMP::TimeStamp

Scripts used in this script

    loadReportTestResultRecord

Layouts used in this script

    reportTestResult
    reportTestResultLocked

Tables used in this script

    TEMP
    tag
    testlearn

Table occurrences used by this script

    ReportResultTestSubject
    TEMP
    testlearnReportTags

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [reportTestResult]	Parent Folder: [report]	Next Script: [showPicture2]
Script Name	showPicture1
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    PrintReportEdit
    PrintReportLock

Scripts that use this script

Script Definition
Script Steps

    #
    #Show picture in picture window...
    Set Variable [ $$PictureOnReportLayout; Value:testlearnReportTags::_Ltestlearn ]
    Set Variable [ $$fileLocation; Value:Case ( testlearnReportTags::picture ≠ "" ; "TLpicture" ; Case ( refTestShowMedia::picture ≠ "" ; "database" ; refTestShowMedia::kfileLocation ≠ "" and refTestShowMedia::fileName ≠ "" and refTestShowMedia::showMedia = "" ; "harddrive" ; refTestShowMedia::URL ≠ "" and refTestShowMedia::showMedia ≠ "" ; "web" ; "none" ) ) ]
    #
    #... if there is a picture to show.
    If [ $$PictureOnReportLayout ≠ "" and $$fileLocation ≠ "none" ]
    Perform Script [ “showCitationPicture1inNewWindow” ]
    #
    #Otherwise, do nothing.
    Else
    Set Variable [ $$PictureOnReportLayout ]
    Set Variable [ $$fileLocation ]
    #
    #Inform user about how to add media.
    Show Custom Dialog [ Message: "To add a picture or movie to this slot 1) select a test result in the Tag Menus window that has media. 2) Click this result's copy button. 3) Return to this Report window. 4) Click in the highlighted space below."; Default Button: “OK”, Commit: “Yes” ]
    End If

Fields used in this script

    testlearnReportTags::_Ltestlearn
    testlearnReportTags::picture
    refTestShowMedia::picture
    refTestShowMedia::kfileLocation
    refTestShowMedia::fileName
    refTestShowMedia::showMedia
    refTestShowMedia::URL

Scripts used in this script

    showCitationPicture1inNewWindow

Layouts used in this script

Tables used in this script

    reference
    testlearn

Table occurrences used by this script

    refTestShowMedia
    testlearnReportTags

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [showPicture1]	Parent Folder: [report]	Next Script: [showPicture3]
Script Name	showPicture2
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    PrintReportEdit
    PrintReportLock

Scripts that use this script

Script Definition
Script Steps

    #
    #Show picture in picture window...
    Set Variable [ $$PictureOnReportLayout; Value:testlearnReportTags 2::_Ltestlearn ]
    Set Variable [ $$fileLocation; Value:Case ( testlearnReportTags 2::picture ≠ "" ; "TLpicture" ; Case ( refShowMediaReport 2::picture ≠ "" ; "database" ; refShowMediaReport 2::kfileLocation ≠ "" and refShowMediaReport 2::fileName ≠ "" and refShowMediaReport 2::showMedia = "" ; "harddrive" ; refShowMediaReport 2::URL ≠ "" and refShowMediaReport 2::showMedia ≠ "" ; "web" ; "none" ) ) ]
    #
    #... if there is a picture to show.
    If [ $$PictureOnReportLayout ≠ "" and $$fileLocation ≠ "none" ]
    Perform Script [ “showCitationPicture1inNewWindow” ]
    #
    #Otherwise, do nothing.
    Else
    Set Variable [ $$PictureOnReportLayout ]
    Set Variable [ $$fileLocation ]
    #
    #Inform user about how to add media.
    Show Custom Dialog [ Message: "To add a picture or movie to this slot 1) select a test result in the Tag Menus window that has media. 2) Click this result's copy button. 3) Return to this Report window. 4) Click in the highlighted space below."; Default Button: “OK”, Commit: “No” ]
    End If

Fields used in this script

    testlearnReportTags 2::_Ltestlearn
    testlearnReportTags 2::picture
    refShowMediaReport 2::picture
    refShowMediaReport 2::kfileLocation
    refShowMediaReport 2::fileName
    refShowMediaReport 2::showMedia
    refShowMediaReport 2::URL

Scripts used in this script

    showCitationPicture1inNewWindow

Layouts used in this script

Tables used in this script

    reference
    testlearn

Table occurrences used by this script

    refShowMediaReport 2
    testlearnReportTags 2

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [showPicture2]	Parent Folder: [report]	Next Script: [showPicture4]
Script Name	showPicture3
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    PrintReportEdit
    PrintReportLock

Scripts that use this script

Script Definition
Script Steps

    #
    #Show picture in picture window...
    Set Variable [ $$PictureOnReportLayout; Value:testlearnReportTags 3::_Ltestlearn ]
    Set Variable [ $$fileLocation; Value:Case ( testlearnReportTags 3::picture ≠ "" ; "TLpicture" ; Case ( refShowMediaReport 3::picture ≠ "" ; "database" ; refShowMediaReport 3::kfileLocation ≠ "" and refShowMediaReport 3::fileName ≠ "" and refShowMediaReport 3::showMedia = "" ; "harddrive" ; refShowMediaReport 3::URL ≠ "" and refShowMediaReport 3::showMedia ≠ "" ; "web" ; "none" ) ) ]
    #
    #... if there is a picture to show.
    If [ $$PictureOnReportLayout ≠ "" and $$fileLocation ≠ "none" ]
    Perform Script [ “showCitationPicture1inNewWindow” ]
    #
    #Otherwise, do nothing.
    Else
    Set Variable [ $$PictureOnReportLayout ]
    Set Variable [ $$fileLocation ]
    #
    #Inform user about how to add media.
    Show Custom Dialog [ Message: "To add a picture or movie to this slot 1) select a test result in the Tag Menus window that has media. 2) Click this result's copy button. 3) Return to this Report window. 4) Click in the highlighted space below."; Default Button: “OK”, Commit: “No” ]
    End If

Fields used in this script

    testlearnReportTags 3::_Ltestlearn
    testlearnReportTags 3::picture
    refShowMediaReport 3::picture
    refShowMediaReport 3::kfileLocation
    refShowMediaReport 3::fileName
    refShowMediaReport 3::showMedia
    refShowMediaReport 3::URL

Scripts used in this script

    showCitationPicture1inNewWindow

Layouts used in this script

Tables used in this script

    reference
    testlearn

Table occurrences used by this script

    refShowMediaReport 3
    testlearnReportTags 3

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [showPicture3]	Parent Folder: [report]	Next Script: [sortReport]
Script Name	showPicture4
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    PrintReportEdit
    PrintReportLock

Scripts that use this script

Script Definition
Script Steps

    #
    #Show picture in picture window...
    Set Variable [ $$PictureOnReportLayout; Value:testlearnReportTags 4::_Ltestlearn ]
    Set Variable [ $$fileLocation; Value:Case ( testlearnReportTags 4::picture ≠ "" ; "TLpicture" ; Case ( refShowMediaReport 4::picture ≠ "" ; "database" ; refShowMediaReport 4::kfileLocation ≠ "" and refShowMediaReport 4::fileName ≠ "" and refShowMediaReport 4::showMedia = "" ; "harddrive" ; refShowMediaReport 4::URL ≠ "" and refShowMediaReport 4::showMedia ≠ "" ; "web" ; "none" ) ) ]
    #
    #... if there is a picture to show.
    If [ $$PictureOnReportLayout ≠ "" and $$fileLocation ≠ "none" ]
    Perform Script [ “showCitationPicture1inNewWindow” ]
    #
    #Otherwise, do nothing.
    Else
    Set Variable [ $$PictureOnReportLayout ]
    Set Variable [ $$fileLocation ]
    #
    #Inform user about how to add media.
    Show Custom Dialog [ Message: "To add a picture or movie to this slot 1) select a test result in the Tag Menus window that has media. 2) Click this result's copy button. 3) Return to this Report window. 4) Click in the highlighted space below."; Default Button: “OK”, Commit: “No” ]
    End If

Fields used in this script

    testlearnReportTags 4::_Ltestlearn
    testlearnReportTags 4::picture
    refShowMediaReport 4::picture
    refShowMediaReport 4::kfileLocation
    refShowMediaReport 4::fileName
    refShowMediaReport 4::showMedia
    refShowMediaReport 4::URL

Scripts used in this script

    showCitationPicture1inNewWindow

Layouts used in this script

Tables used in this script

    reference
    testlearn

Table occurrences used by this script

    refShowMediaReport 4
    testlearnReportTags 4

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [showPicture4]	Parent Folder: [report]	Next Script: [unzoomReport]
Script Name	sortReport
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    Sort Records [ Keep records in sorted order; Specified Sort Order: report::ktestSubsection; ascending ] [ Restore; No dialog ]

Fields used in this script

    report::ktestSubsection

Scripts used in this script

Layouts used in this script

Tables used in this script

    report

Table occurrences used by this script

    report

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [sortReport]	Parent Folder: [report]	Next Script: [zoomReport]
Script Name	unzoomReport
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #basic administration tasks
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Set Variable [ $$first ]
    Set Variable [ $$last; Value:report::ktestSubsection ]
    Set Field [ TEMP::ktestSection; "" ]
    #clear the $$finding and $window variables
    Set Variable [ $$finding ]
    Set Variable [ $$window ]
    Set Variable [ $testSubject; Value:report::ktestSubject ]
    Set Variable [ $testSubsection; Value:report::ktestSubsection ]
    #basic administration tasks
    Select Window [ Name: "Tag Menus"; Current file ]
    If [ Get (LastError) = 112 ]
    New Window [ Name: "Tag Menu"; Height: Get ( ScreenHeight ); Width: Get ( ScreenWidth ) / 2; Top: 0; Left: Get ( ScreenWidth ) / 2; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “reportTestResult” (testlearnReportTags) ]
    Enter Find Mode [ ]
    Set Field [ testlearnReportTags::ktestSubject; $testSubject ]
    Set Field [ testlearnReportTags::ktestSubsection; $testSubsection ]
    Set Field [ testlearnReportTags::kreportNumber; $$reportNumber ]
    Perform Find [ ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearnReportTags::subsectionCustomName; ascending testlearnReportTags::timestamp; ascending testlearnReportTags::_Ltestlearn; ascending ] [ Restore; No dialog ]
    End If
    Move/Resize Window [ Current Window; Height: Get ( ScreenHeight ); Width: Get ( ScreenWidth ) / 2; Top: 0; Left: Get ( ScreenWidth ) / 2 ]
    Set Zoom Level [ 100%; Camera: Back; Resolution: Full ]
    // If [ Get (WindowZoomLevel) = 100 ]
    // Move/Resize Window [ Current Window; Height: Get ( ScreenHeight ); Width: 480; Top: 0; Left: 0 ]
    // Set Zoom Level [ 150% ]
    // Else If [ Get (WindowZoomLevel) = 150 ]
    // Move/Resize Window [ Current Window; Height: Get ( ScreenHeight ); Width: 634; Top: 0; Left: 0 ]
    // Set Zoom Level [ 200%; Camera: Back; Resolution: Full; Types: Code 39, Code 93, Code 128, EAN-8, EAN-13, EAN/UPC Composite, GS1 2-Digit Add-On, GS1 5-Digit Add-On, GS1 DataBar Expanded, GS1 DataBar (RSS), ITF-14, ISBN-10 (from EAN-13), ISBN-13 (from EAN-13), QR Code, UPC-A, UPC-E, Codabar ]
    // Else If [ Get (WindowZoomLevel) = 200 ]
    // Move/Resize Window [ Current Window; Height: Get ( ScreenHeight ); Width: 942; Top: 0; Left: 0 ]
    // Set Zoom Level [ 300% ]
    // End If
    Select Window [ Name: "Report"; Current file ]
    Move/Resize Window [ Current Window; Height: Get ( ScreenHeight ); Width: Get ( ScreenWidth ) / 2; Top: 0; Left: 0 ]
    Set Zoom Level [ 100%; Camera: Back; Resolution: Full ]

Fields used in this script

    report::ktestSubsection
    TEMP::ktestSection
    report::ktestSubject
    testlearnReportTags::ktestSubject
    testlearnReportTags::ktestSubsection
    testlearnReportTags::kreportNumber
    testlearnReportTags::subsectionCustomName
    testlearnReportTags::timestamp
    testlearnReportTags::_Ltestlearn

Scripts used in this script

Layouts used in this script

    reportTestResult

Tables used in this script

    TEMP
    report
    testlearn

Table occurrences used by this script

    TEMP
    report
    testlearnReportTags

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [unzoomReport]	Parent Folder: [report]
Script Name	zoomReport
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #basic administration tasks
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Set Variable [ $$first ]
    Set Variable [ $$last; Value:report::ktestSubsection ]
    Set Field [ TEMP::ktestSection; "" ]
    #clear the $$finding and $window variables
    Set Variable [ $$finding ]
    Set Variable [ $$window ]
    Set Variable [ $testSubject; Value:report::ktestSubject ]
    Set Variable [ $testSubsection; Value:report::ktestSubsection ]
    #basic administration tasks
    Select Window [ Name: "Tag Menus"; Current file ]
    If [ Get (LastError) = 112 ]
    New Window [ Name: "Tag Menus"; Height: Get ( ScreenHeight ); Width: 480; Top: 0; Left: 0; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “reportTestResult” (testlearnReportTags) ]
    Enter Find Mode [ ]
    Set Field [ testlearnReportTags::ktestSubject; $testSubject ]
    Set Field [ testlearnReportTags::ktestSubsection; $testSubsection ]
    Set Field [ testlearnReportTags::kreportNumber; $$reportNumber ]
    Perform Find [ ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearnReportTags::subsectionCustomName; ascending testlearnReportTags::timestamp; ascending testlearnReportTags::_Ltestlearn; ascending ] [ Restore; No dialog ]
    End If
    Set Zoom Level [ 150% ]
    Move/Resize Window [ Current Window; Height: Get ( ScreenHeight ); Width: If ( Get (ScreenWidth) - 933 - 492 ≥ 0 ; Get ( ScreenWidth ) - 933 ; 492 ); Top: 0; Left: If ( Get (ScreenWidth) - 933 - 492 ≥ 0 ; 933 ; Get (ScreenWidth) - 492 ) ]
    // If [ Get (WindowZoomLevel) = 100 ]
    // Move/Resize Window [ Current Window; Height: Get ( ScreenHeight ); Width: 480; Top: 0; Left: 0 ]
    // Set Zoom Level [ 150% ]
    // Else If [ Get (WindowZoomLevel) = 150 ]
    // Move/Resize Window [ Current Window; Height: Get ( ScreenHeight ); Width: 634; Top: 0; Left: 0 ]
    // Set Zoom Level [ 200%; Camera: Back; Resolution: Full; Types: Code 39, Code 93, Code 128, EAN-8, EAN-13, EAN/UPC Composite, GS1 2-Digit Add-On, GS1 5-Digit Add-On, GS1 DataBar Expanded, GS1 DataBar (RSS), ITF-14, ISBN-10 (from EAN-13), ISBN-13 (from EAN-13), QR Code, UPC-A, UPC-E, Codabar ]
    // Else If [ Get (WindowZoomLevel) = 200 ]
    // Move/Resize Window [ Current Window; Height: Get ( ScreenHeight ); Width: 942; Top: 0; Left: 0 ]
    // Set Zoom Level [ 300% ]
    // End If
    Select Window [ Name: "Report"; Current file ]
    Move/Resize Window [ Current Window; Height: Get ( ScreenHeight ); Width: 933; Top: 0; Left: 0 ]
    Set Zoom Level [ 150% ]
    If [ Get (LastError) = 112 ]
    Exit Script [ ]
    End If

Fields used in this script

    report::ktestSubsection
    TEMP::ktestSection
    report::ktestSubject
    testlearnReportTags::ktestSubject
    testlearnReportTags::ktestSubsection
    testlearnReportTags::kreportNumber
    testlearnReportTags::subsectionCustomName
    testlearnReportTags::timestamp
    testlearnReportTags::_Ltestlearn

Scripts used in this script

Layouts used in this script

    reportTestResult

Tables used in this script

    TEMP
    report
    testlearn

Table occurrences used by this script

    TEMP
    report
    testlearnReportTags

Custom Functions used by this script

Custom menu set used by this script


print
	Parent Folder: [print]	Next Script: [CHUNK_insertPageNumbersBackOnePage]
Script Name	CHUNK_insertPageNumbers
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    pageNumbering

Scripts that use this script

Script Definition
Script Steps

    Set Variable [ $$theme; Value:reportSubsection::ksubsectionGroup ]
    If [ $$themepage = 1 ]
    Set Field [ report::pagenumberTheme; TEMP::pageNumber ]
    Set Variable [ $$themepage; Value:2 ]
    Refresh Window
    Else If [ $$themepage = 2 ]
    Set Field [ report::pagenumberItem; TEMP::pageNumber ]
    Go to Record/Request/Page [ Next ]
    Set Field [ report::CurrentRecord; Get ( RecordID ) ]
    End If
    If [ $$theme ≠ reportSubsection::ksubsectionGroup ]
    Set Variable [ $$themepage; Value:1 ]
    Set Field [ report::CurrentRecord; Get ( RecordID ) ]
    Refresh Window
    End If

Fields used in this script

    reportSubsection::ksubsectionGroup
    TEMP::pageNumber
    report::pagenumberTheme
    report::pagenumberItem
    report::CurrentRecord

Scripts used in this script

Layouts used in this script

Tables used in this script

    TEMP
    report
    testSubsectionTemplate

Table occurrences used by this script

    TEMP
    report
    reportSubsection

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [CHUNK_insertPageNumbers]	Parent Folder: [print]	Next Script: [CHUNK_insertPageNumbersForwardOnePage]
Script Name	CHUNK_insertPageNumbersBackOnePage
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    pageNumbering

Scripts that use this script

Script Definition
Script Steps

    Select Window [ Name: "Report"; Current file ]
    Go to Record/Request/Page [ Previous ]
    Set Variable [ $page; Value:Get ( PageNumber ) ]
    Set Field [ TEMP::pageNumber; $page ]
    Select Window [ Name: "Numbers"; Current file ]

Fields used in this script

    TEMP::pageNumber

Scripts used in this script

Layouts used in this script

Tables used in this script

    TEMP

Table occurrences used by this script

    TEMP

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [CHUNK_insertPageNumbersBackOnePage]	Parent Folder: [print]	Next Script: [CHUNK_pageNumberItem]
Script Name	CHUNK_insertPageNumbersForwardOnePage
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    pageNumbering

Scripts that use this script

Script Definition
Script Steps

    Select Window [ Name: "Report"; Current file ]
    Go to Record/Request/Page [ Next ]
    Set Variable [ $page; Value:Get ( PageNumber ) ]
    Set Field [ TEMP::pageNumber; $page ]
    Select Window [ Name: "Numbers"; Current file ]

Fields used in this script

    TEMP::pageNumber

Scripts used in this script

Layouts used in this script

Tables used in this script

    TEMP

Table occurrences used by this script

    TEMP

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [CHUNK_insertPageNumbersForwardOnePage]	Parent Folder: [print]	Next Script: [CHUNK_pageNumberTheme]
Script Name	CHUNK_pageNumberItem
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    Set Variable [ $$themepage; Value:2 ]
    Set Field [ report::CurrentRecord; Get ( RecordID ) ]
    Go to Field [ ]

Fields used in this script

    report::CurrentRecord

Scripts used in this script

Layouts used in this script

Tables used in this script

    report

Table occurrences used by this script

    report

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [CHUNK_pageNumberItem]	Parent Folder: [print]	Next Script: [printThingReport]
Script Name	CHUNK_pageNumberTheme
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    Set Variable [ $$themepage; Value:1 ]
    Set Field [ report::CurrentRecord; Get ( RecordID ) ]
    Go to Field [ ]

Fields used in this script

    report::CurrentRecord

Scripts used in this script

Layouts used in this script

Tables used in this script

    report

Table occurrences used by this script

    report

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [CHUNK_pageNumberTheme]	Parent Folder: [print]	Next Script: [TOC]
Script Name	printThingReport
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    Set Variable [ $record; Value:Get (RecordNumber) ]
    Close Window [ Name: "Tag Menus"; Current file ]
    #find all contact records, sort them, enter preview (print) mode
    Go to Layout [ “PrintReport” (report) ]
    Set Variable [ $testSubject; Value:report::ktestSubject ]
    Enter Find Mode [ ]
    Set Field [ report::ktestSubject; $testSubject ]
    Set Field [ report::kreportNumber; $$reportNumber ]
    Perform Find [ ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: ruleTestReport::name; ascending reportSubsection::name; ascending ] [ Restore; No dialog ]
    Go to Record/Request/Page [ First ]
    #
    #allow user to preview report will clicking a button in
    #a new window to input page numbers for each item
    Enter Preview Mode
    Set Window Title [ Current Window; New Title: "Report" ]
    Move/Resize Window [ Name: "Report"; Current file; Width: Get ( ScreenWidth ) / 2; Left: 0 ]
    New Window [ Name: "Numbers"; Width: Get ( ScreenWidth ) / 2; Left: Get ( ScreenWidth ) / 2; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Enter Browse Mode
    // Arrange All Windows [ Tile Vertically ]
    Go to Layout [ “pageNumbering” (report) ]
    Go to Record/Request/Page [ First ]
    Set Field [ report::pagenumberTheme; 1 ]
    Set Field [ report::CurrentRecord; Get ( RecordID ) ]
    Set Variable [ $$themepage; Value:2 ]
    Set Field [ TEMP::pageNumber; 1 ]
    Select Window [ Name: "Numbers"; Current file ]
    Loop
    Set Variable [ $duplicate; Value:report::ktestSubsection ]
    Go to Record/Request/Page [ Next; Exit after last ]
    If [ report::ktestSubsection = $duplicate ]
    Omit Record
    Go to Record/Request/Page [ Previous ]
    End If
    End Loop
    Scroll Window [ Home ]
    Go to Record/Request/Page [ First ]
    Pause/Resume Script [ Indefinitely ]
    #refind all report records omitted for page numbering
    Enter Find Mode [ ]
    Set Field [ report::ktestSubject; $testSubject ]
    Set Field [ report::kreportNumber; $$reportNumber ]
    Perform Find [ ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: ruleTestReport::name; ascending reportSubsection::name; ascending ] [ Restore; No dialog ]
    Go to Record/Request/Page [ First ]
    #now save the TOC to every report record in case the one showing gets deleted.
    Set Variable [ $TOC; Value:report::TOC ]
    Set Variable [ $TOCnumbers; Value:report::TOCnumbers ]
    Go to Record/Request/Page [ First ]
    Loop
    Set Field [ report::TOC; $TOC ]
    Set Field [ report::TOCnumbers; $TOCnumbers ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    Set Variable [ $path; Value:Get ( TemporaryPath ) ]
    Close Window [ Name: "Report"; Current file ]
    Adjust Window [ Resize to Fit ]
    Set Zoom Level [ 100%; Camera: Back; Resolution: Full ]
    Go to Layout [ “reportCover” (report) ]
    Enter Browse Mode
    Go to Record/Request/Page [ First ]
    Pause/Resume Script [ Indefinitely ]
    #
    #pdf report cover
    Set Variable [ $cover; Value:report::ReportCover ]
    Set Variable [ $pdf; Value:report::ReportPDFtitle ]
    Go to Record/Request/Page [ First ]
    Set Variable [ $printcover; Value:report::_Lreport ]
    Loop
    Set Field [ report::ReportCover; $cover ]
    Set Field [ report::ReportPDFtitle; $pdf ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    Enter Find Mode [ ]
    Set Field [ report::_Lreport; $printcover ]
    Perform Find [ ]
    If [ Left ( Get (ApplicationVersion) ; 3) = "run" and Get ( SystemPlatform ) ≠ 3 ]
    Show Custom Dialog [ Message: "The report cover, table of contents, and report should now be saved as 3 PDFs. In the print dialogue box select the PDF option (bottom left corner) and save this first PDF as cover."; Default Button: “OK”, Commit: “No” ]
    Print [ Records being browsed; All Pages; Orientation: Portrait; Paper size: 8.5" x 11" ] [ Restore: Bluetooth ]
    Else If [ Left ( Get (ApplicationVersion) ; 3) ≠ "run" or Get ( SystemPlatform ) = 3 ]
    Print Setup [ Orientation: Portrait; Paper size: 8.5" x 11" ] [ Restore; No dialog ]
    Save Records as PDF [ File Name: “$path/$pdf”; Current record ] [ Document - Compatibility: Acrobat 5 and later ] [ Pages - Number Pages From: 1; Include: All pages ] [ Security - Printing: High Resolution; Editing: Any except extracting pages; Enable copying; Enable Screen Reader ] [ Initial View - Show: Pages Panel and Page; Page Layout: Default; Magnification: 100% ] [ Restore; No dialog ]
    End If
    #
    #pdf table of contents
    Go to Layout [ “TOCpdf” (report) ]
    Enter Find Mode [ ]
    Set Field [ report::ktestSubject; $testSubject ]
    Set Field [ report::kreportNumber; $$reportNumber ]
    Perform Find [ ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: report::TOC; ascending ruleTestReport::name; ascending reportSubsection::name; ascending ] [ Restore; No dialog ]
    Go to Record/Request/Page [ First ]
    Loop
    Set Variable [ $duplicate; Value:report::ktestSubsection ]
    Go to Record/Request/Page [ Next; Exit after last ]
    If [ report::ktestSubsection = $duplicate ]
    Omit Record
    Go to Record/Request/Page [ Previous ]
    End If
    End Loop
    Enter Preview Mode
    If [ Left ( Get (ApplicationVersion) ; 3) = "run" and Get ( SystemPlatform ) ≠ 3 ]
    Show Custom Dialog [ Message: "Save this second PDF as TOC."; Default Button: “OK”, Commit: “No” ]
    Print [ Records being browsed; All Pages; Orientation: Portrait; Paper size: 8.5" x 11" ] [ Restore: EPSON WorkForce 630 ]
    Else If [ Left ( Get (ApplicationVersion) ; 3) ≠ "run" or Get ( SystemPlatform ) = 3 ]
    Save Records as PDF [ File Name: “$path/$pdf”; Records being browsed ] [ Document - Compatibility: Acrobat 5 and later ] [ Pages - Number Pages From: 1; Include: All pages ] [ Security - Printing: High Resolution; Editing: Any except extracting pages; Enable copying; Enable Screen Reader ] [ Initial View - Show: Pages Panel and Page; Page Layout: Default; Magnification: 100% ] [ Restore; Append; No dialog ]
    End If
    #
    #pdf report
    Go to Layout [ “PrintReport” (report) ]
    Enter Find Mode [ ]
    Set Field [ report::ktestSubject; $testSubject ]
    Set Field [ report::kreportNumber; $$reportNumber ]
    Perform Find [ ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: ruleTestReport::name; ascending reportSubsection::name; ascending ] [ Restore; No dialog ]
    Go to Record/Request/Page [ First ]
    Enter Preview Mode
    If [ Left ( Get (ApplicationVersion) ; 3) = "run" and Get ( SystemPlatform ) ≠ 3 ]
    Show Custom Dialog [ Message: "Save this third PDF as Report."; Default Button: “OK”, Commit: “No” ]
    Print [ Records being browsed; All Pages; Orientation: Portrait; Paper size: 8.5" x 11" ] [ Restore: EPSON WorkForce 630 ]
    Show Custom Dialog [ Message: "Open up all three PDFs. Drag the cover and TOC page thumbnails into the Report.pdf along with any other PDF thumbnails you wish from Preview's sidebar. Save this PDF. Trash the other two."; Default Button: “OK”, Commit: “No” ]
    Else If [ Left ( Get (ApplicationVersion) ; 3) ≠ "run" or Get ( SystemPlatform ) = 3 ]
    Save Records as PDF [ File Name: “$path/$pdf”; Automatically open; Records being browsed ] [ Document - Compatibility: Acrobat 5 and later ] [ Pages - Number Pages From: 1; Include: All pages ] [ Security - Printing: High Resolution; Editing: Any except extracting pages; Enable copying; Enable Screen Reader ] [ Initial View - Show: Pages Panel and Page; Page Layout: Default; Magnification: 100% ] [ Restore; Append; No dialog ]
    End If
    Set Window Title [ Current Window; New Title: "Setup" ]
    Move/Resize Window [ Name: "Setup"; Current file; Width: Get (ScreenWidth) / 2; Top: 0; Left: 0 ]
    Go to Layout [ “defaultSetup” (librarySetupReferenceMain) ]
    New Window [ Name: "Tag Menus"; Width: Get (ScreenWidth) / 2; Left: Get (ScreenWidth) / 2; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “defaultTest” (testSectionCreatedFromATemplate) ]
    // Perform Script [ “templateTestSectionMenu” ]
    Perform Script [ “gotoReport” ]
    Go to Record/Request/Page [ $record ] [ No dialog ]

Fields used in this script

    report::ktestSubject
    report::kreportNumber
    ruleTestReport::name
    reportSubsection::name
    report::pagenumberTheme
    report::CurrentRecord
    TEMP::pageNumber
    report::ktestSubsection
    report::TOC
    report::TOCnumbers
    report::ReportCover
    report::ReportPDFtitle
    report::_Lreport

Scripts used in this script

    templateTestSectionMenu
    gotoReport

Layouts used in this script

    PrintReport
    pageNumbering
    reportCover
    TOCpdf
    defaultSetup
    defaultTest

Tables used in this script

    TEMP
    report
    tagGroup
    testSubsectionTemplate

Table occurrences used by this script

    TEMP
    report
    reportSubsection
    ruleTestReport

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [printThingReport]	Parent Folder: [print]
Script Name	TOC
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    Set Variable [ $record; Value:Get (RecordNumber) ]
    Set Variable [ $TOCnumber; Value:report::TOCnumbers ]
    Set Variable [ $TOC; Value:report::TOC ]
    Go to Field [ ]
    Go to Record/Request/Page [ First ]
    Loop
    Set Field [ report::TOCnumbers; $TOCnumber ]
    Set Field [ report::TOC; $TOC ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    Go to Record/Request/Page [ $record ] [ No dialog ]
    Go to Field [ ]

Fields used in this script

    report::TOCnumbers
    report::TOC

Scripts used in this script

Layouts used in this script

Tables used in this script

    report

Table occurrences used by this script

    report

Custom Functions used by this script

Custom menu set used by this script


probablyNotInUse
	Parent Folder: [probablyNotInUse]
Script Name	newAttribute
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

Fields used in this script

Scripts used in this script

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


setup
	Parent Folder: [setup]	Next Script: [deleteSubsectionFromUserTest]
Script Name	deleteSubsection
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    setupTestSubsection

Scripts that use this script

Script Definition
Script Steps

    #
    #This script is for deleting a test
    #subsection template.
    #
    #
    If [ testSectionCreatorLock::orderOrLock ≠ "" ]
    Show Custom Dialog [ Message: "This record is locked. Go the node that created it — " & testSectionCreatorLock::tag & " — in the setup tag window and enter the password to unlock it so that you can delete it."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #Set variables to conditionally format record to
    #to be deleted and to supply name for warning
    #messages, and to speed up script.
    Set Variable [ $delete; Value:testSubsectionTemplate::_LtestSubsection ]
    Refresh Window
    Set Variable [ $$tagTest; Value:testSubsectionTemplate::_LtestSubsection ]
    Set Variable [ $$ID; Value:"ignore" ]
    If [ testSubsectionTemplate::name = "" ]
    Set Field [ testSubsectionTemplate::name; testSubsectionTemplate::_LtestSubsection ]
    End If
    Go to Field [ ]
    Set Variable [ $$stopLoadTestResultRecord; Value:1 ]
    Set Variable [ $$stopLoadTestRecord; Value:1 ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Set Variable [ $$stopDeleteTest; Value:1 ]
    Set Variable [ $$stopTest; Value:1 ]
    #
    #Check if item is in use as test tag on any Report
    #records, and if so stop the script.
    #
    New Window [ Name: " "; Height: 1; Width: 1; Top: -10000; Left: -10000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    // New Window [ Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “TEMP” (TEMP) ]
    Show All Records
    Delete All Records [ No dialog ]
    #
    Go to Layout [ “reportTestResult” (testlearnReportTags) ]
    Enter Find Mode [ ]
    Set Field [ testlearnReportTags::ktestSubsection; $delete ]
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Perform Find [ ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: ReportResultTestSubject::tag; ascending ] [ Restore; No dialog ]
    Go to Record/Request/Page [ First ]
    #
    #If records are found using test, then tell the
    #user on which reports they where found.
    If [ Get (FoundCount) ≠ 0 ]
    Loop
    Set Variable [ $useList; Value: TextColor( ReportResultTestSubject::tag & " | test " & testlearnReportTags::kreportNumber ; RGB(102;102;102)) & ¶ & testlearnReportTags::countOfONESubsectionsTestResults & " in section " & TextColor( tagReportTestSubjectSectionNAME::name ; RGB(0;0;0)) ]
    Set Variable [ $subSection; Value:testlearnReportTags::subsectionCustomName ]
    Go to Layout [ “TEMP” (TEMP) ]
    New Record/Request
    Set Field [ TEMP::DeleteMessageInTempWindow1; $useList ]
    Go to Layout [ “reportTestResult” (testlearnReportTags) ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    Go to Layout [ “TEMP” (TEMP) ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: TEMP::DeleteMessageInTempWindow1; ascending ] [ Restore; No dialog ]
    View As [ View as List ]
    #
    Move/Resize Window [ Current Window; Top: 0; Left: 0 ]
    Move/Resize Window [ Current Window; Height: Get ( ScreenHeight ); Width: 360; Top: 0; Left: Get ( ScreenWidth ) - ( Get ( ScreenWidth )/2 + 360) ]
    Set Field [ TEMP::Message; "Test results have been made using the sub-section template " & $subSection & ". To delete it, first delete the test results made in the test-subject's test-sections below, which use this template." ]
    Pause/Resume Script [ Indefinitely ]
    Close Window [ Current Window ]
    Set Variable [ $delete ]
    Set Variable [ $$stopLoadTestResultRecord ]
    Set Variable [ $$stopLoadTestRecord ]
    Set Variable [ $$stopLoadTagRecord ]
    Set Variable [ $$stopDeleteTest ]
    Set Variable [ $$stopTest ]
    Set Variable [ $$tagTest ]
    Set Variable [ $$ID; Value:testSubsectionTemplate::_LtestSubsection ]
    Refresh Window
    Exit Script [ ]
    Else
    Set Variable [ $$stopLoadTestResultRecord ]
    Set Variable [ $$stopLoadTestRecord ]
    Set Variable [ $$stopLoadTagRecord ]
    Set Variable [ $$stopDeleteTest ]
    Set Variable [ $$stopTest ]
    Set Variable [ $$ID; Value:testSubsectionTemplate::_LtestSubsection ]
    End If
    #
    #
    #Check if item is in use as test tag on any Learn
    #records, and if so stop the script.
    Set Variable [ $$stopLoadCitation; Value:1 ]
    Go to Layout [ “learn2” (testlearn) ]
    #
    Set Window Title [ Current Window; New Title: "Learn" ]
    #
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Enter Find Mode [ ]
    Set Field [ testlearn::filterFind; "main" ]
    Set Field [ testlearn::kctestSubsectionInfo; "###" & $$tagTest ]
    Perform Find [ ]
    Set Variable [ $$stopLoadCitation ]
    #
    #If records are found using test, then stop script.
    If [ Get (FoundCount) ≠ 0 ]
    Move/Resize Window [ Current Window; Height: Get ( ScreenHeight ); Width: 360; Top: 0; Left: Get ( ScreenWidth ) - ( Get ( ScreenWidth )/2 + 360) ]
    Show Custom Dialog [ Message: "This general inquiry is linked to at least one learn record. To delete it 1) go to the learn module, 2) click 'test' in its tag-menus window, 3) select it, 4) untag it from all learn records, 5) return to test setup, 6) and delete it."; Default Button: “OK”, Commit: “Yes” ]
    #
    Close Window [ Current Window ]
    Set Variable [ $delete ]
    Set Variable [ $$stopLoadTestRecord ]
    Set Variable [ $$stopLoadTagRecord ]
    Set Variable [ $$stopDeleteTest ]
    Set Variable [ $$stopTest ]
    Set Variable [ $$tagTest ]
    Set Variable [ $$ID; Value:testSubsectionTemplate::_LtestSubsection ]
    Refresh Window
    #
    Exit Script [ ]
    End If
    #
    Close Window [ Current Window ]
    #
    #If no records were found using this test, then
    #user may delete it. First the record is highlighted
    #in red and the user is asked if they really intend
    #to delete this record.
    Set Variable [ $delete; Value:testSubsectionTemplate::_LtestSubsection ]
    Refresh Window
    Scroll Window [ To Selection ]
    Go to Field [ ]
    Show Custom Dialog [ Message: "Delete " & testSubsectionTemplate::name & "?"; Default Button: “Cancel”, Commit: “Yes”; Button 2: “Delete”, Commit: “No” ]
    #
    #If the user cancels the delete, then everything
    #goes back to the way it was before the delete
    #was started.
    If [ Get ( LastMessageChoice ) = 1 ]
    Set Variable [ $delete ]
    Set Variable [ $$stopLoadTestRecord ]
    Set Variable [ $$stopLoadTagRecord ]
    Set Variable [ $$stopDeleteTest ]
    Set Variable [ $$stopTest ]
    Set Variable [ $$tagTest ]
    Set Variable [ $$ID; Value:testSubsectionTemplate::_LtestSubsection ]
    Refresh Window
    Exit Script [ ]
    End If
    #
    #If the user presses 'delete' the system will now
    #check if this test is the last test in its test group.
    If [ Get ( LastMessageChoice ) = 2 ]
    #
    Set Variable [ $$stopLoadTestRecord; Value:1 ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Set Variable [ $$stopDeleteTest; Value:1 ]
    Set Variable [ $$stopTest; Value:1 ]
    #
    New Window [ Height: 1; Width: 1; Top: -1000; Left: -1000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    // New Window [ Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    #
    #Set variables to find and remove all tests in
    #a group and its key from all test items.
    Set Variable [ $group; Value:testSubsectionTemplate::ksubsectionGroup ]
    Set Variable [ $testSubsection; Value:testSubsectionTemplate::_LtestSubsection ]
    #
    #Find all tests in this test group.
    Go to Layout [ “tableTestSubsectionTemplates” (testSubsectionTemplate) ]
    Enter Find Mode [ ]
    Set Field [ testSubsectionTemplate::ksubsectionGroup; $group ]
    Perform Find [ ]
    #
    #If the test is the last test, the user is informed
    #of this and asked if knowing this they want to
    #delete both the test and the test group, since
    #a test group cannot exist without at least one test
    #in it.
    If [ Get (FoundCount) = 1 ]
    #
    Close Window [ Current Window ]
    #
    Set Variable [ $deleteGroup; Value:$delete ]
    Refresh Window
    Show Custom Dialog [ Title: "!"; Message: "If you delete this group's last test, it will also be deleted."; Default Button: “Cancel”, Commit: “Yes”; Button 2: “Delete”, Commit: “No” ]
    #
    #If the user cancels the delete, then everything
    #goes back to the way it was before the delete
    #was started.
    If [ Get ( LastMessageChoice ) = 1 ]
    Set Variable [ $delete ]
    Set Variable [ $deleteGroup ]
    Set Variable [ $$stopLoadTestRecord ]
    Set Variable [ $$stopLoadTagRecord ]
    Set Variable [ $$stopDeleteTest ]
    Set Variable [ $$stopTest ]
    Set Variable [ $$tagTest ]
    Set Variable [ $$ID; Value:testSubsectionTemplate::_LtestSubsection ]
    Refresh Window
    Exit Script [ ]
    End If
    #
    #If the user pressed delete then first the
    #test group is deleted.
    #
    New Window [ Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    #
    Go to Layout [ “tableTagGroup” (testSubsectionGroup) ]
    Enter Find Mode [ ]
    Set Field [ testSubsectionGroup::_Lgroup; $group ]
    Perform Find [ ]
    Delete Record/Request [ No dialog ]
    End If
    #
    End If
    #
    #Remove test's key from test-items that
    #have more than one test's key.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Go to Layout [ “setupTestItem” (tagMenus) ]
    Enter Find Mode [ ]
    Set Field [ tagMenuTestItemGroup::match; $testSubsection & ¶ ]
    Perform Find [ ]
    Go to Record/Request/Page [ First ]
    Loop
    #If an item has only one test key, do not
    #remove it. In the next step these test items
    # will be found and deleted along with the
    #test-item groups to which they belong.
    If [ ValueCount (tagMenuTestItemGroup::match) > 1 ]
    Set Variable [ $match; Value:tagMenuTestItemGroup::match ]
    Set Field [ tagMenuTestItemGroup::match; Substitute ( $match ; $testSubsection & "¶" ; "" ) ]
    End If
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Delete the test items that are only linked
    #to this test.
    Enter Find Mode [ ]
    Set Field [ tagMenuTestItemGroup::match; $testSubsection & ¶ ]
    Perform Find [ ]
    Delete All Records [ No dialog ]
    #
    #Delete the test-item groups that now have no
    #test items in them, and are no longer linked
    #to any tests.
    Go to Layout [ “tableTagGroup” (testSubsectionGroup) ]
    Enter Find Mode [ ]
    Set Field [ testSubsectionGroup::match; $testSubsection & ¶ ]
    Perform Find [ ]
    Delete All Records [ No dialog ]
    Set Variable [ $$stopLoadTagRecord ]
    #
    #Finally, delete the test itself.
    Go to Layout [ “tableTestSubsectionTemplates” (testSubsectionTemplate) ]
    Enter Find Mode [ ]
    Set Field [ testSubsectionTemplate::_LtestSubsection; $testSubsection ]
    Perform Find [ ]
    Delete Record/Request [ No dialog ]
    Close Window [ Current Window ]
    #
    #Load current test's information.
    Set Variable [ $$stopLoadTestRecord ]
    Set Variable [ $$stopLoadTagRecord ]
    Set Variable [ $$stopDeleteTest ]
    Set Variable [ $$stopTest ]
    Set Variable [ $$tagTest ]
    Set Variable [ $$ID ]
    Perform Script [ “loadSetupTestSubsection” ]
    #

Fields used in this script

    testSectionCreatorLock::orderOrLock
    testSectionCreatorLock::tag
    testSubsectionTemplate::_LtestSubsection
    testSubsectionTemplate::name
    testlearnReportTags::ktestSubsection
    ReportResultTestSubject::tag
    testlearnReportTags::kreportNumber
    testlearnReportTags::countOfONESubsectionsTestResults
    tagReportTestSubjectSectionNAME::name
    testlearnReportTags::subsectionCustomName
    TEMP::DeleteMessageInTempWindow1
    TEMP::Message
    testlearn::filterFind
    testlearn::kctestSubsectionInfo
    testSubsectionTemplate::ksubsectionGroup
    testSubsectionGroup::_Lgroup
    tagMenuTestItemGroup::match
    testSubsectionGroup::match

Scripts used in this script

    loadSetupTestSubsection

Layouts used in this script

    TEMP
    reportTestResult
    learn2
    tableTestSubsectionTemplates
    tableTagGroup
    setupTestItem

Tables used in this script

    TEMP
    tag
    tagGroup
    tagGroup
    testSectionCreatedFromATemplate
    testSubsectionTemplate
    testlearn
    testlearn

Table occurrences used by this script

    ReportResultTestSubject
    TEMP
    tagMenuTestItemGroup
    tagReportTestSubjectSectionNAME
    testSectionCreatorLock
    testSubsectionGroup
    testSubsectionTemplate
    testlearn
    testlearnReportTags

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [deleteSubsection]	Parent Folder: [setup]	Next Script: [deleteTestItem]
Script Name	deleteSubsectionFromUserTest
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultTestNewSection

Scripts that use this script

Script Definition
Script Steps

    #
    #If there are no records, halt this script.
    If [ testSectionCreatedFromATemplate::_LtestSection = "" ]
    Halt Script
    End If
    #
    #If the sub-section has test results, halt the
    #script and explain to the user why.
    If [ testSectionCreatedFromATemplate::inUse ≠ "" ]
    Show Custom Dialog [ Message: "Delete all test results made in this section before deleting it. To do this, 1) click its green test button. 2) Click on each sub-section with test results. 3) Delete all results you find."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #
    #Test subject is locked.
    If [ testSubjectName::orderOrLock ≠ "" ]
    Set Variable [ $$highlightTestSubject; Value:1 ]
    Refresh Window
    #
    #Get the current test subject's name.
    Show Custom Dialog [ Message: "The test subject — " & testSubjectName::tag & " — is locked. To unlock, A) go back to the setup node tag menu. B) Select this test subject. C) Click 'lock' and enter the password."; Default Button: “OK”, Commit: “Yes” ]
    Set Variable [ $$highlightTestSubject ]
    Refresh Window
    Halt Script
    End If
    #
    #
    #Highlight sub-section and ask user if they
    #really want to delete it.
    Set Variable [ $testSubject; Value:testSectionCreatedFromATemplate::ktestSubjectNode ]
    Set Variable [ $reportNumber; Value:testSectionCreatedFromATemplate::reportNumber ]
    Set Variable [ $delete; Value:testSectionCreatedFromATemplate::_LtestSection ]
    Go to Field [ ]
    Refresh Window
    Show Custom Dialog [ Message: "Delete test section " & Quote ( testSectionCreatedFromATemplate::name ) & " for " & testSubjectName::tag & "'s test #" & testSectionCreatedFromATemplate::reportNumber & "?"; Default Button: “Cancel”, Commit: “Yes”; Button 2: “Delete”, Commit: “No” ]
    #
    #If the user cancels the delete, then everything
    #goes back to the way it was before the delete
    #was started.
    If [ Get ( LastMessageChoice ) = 1 ]
    Set Variable [ $delete ]
    Set Variable [ $deleteGroup ]
    Refresh Window
    Exit Script [ ]
    End If
    #
    #If the user presses 'delete' the system will now
    #check if it is the last sub-section in for
    #this test.
    If [ Get ( LastMessageChoice ) = 2 ]
    Set Variable [ $$stopLoadTestRecord; Value:1 ]
    New Window [ Height: 1; Width: 1; Top: -1000; Left: -1000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    // New Window [ Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Set Variable [ $$stopLoadTestRecord ]
    #
    #Find all sub-sections for this test.
    Enter Find Mode [ ]
    Set Field [ testSectionCreatedFromATemplate::ktestSubjectNode; $testSubject ]
    Set Field [ testSectionCreatedFromATemplate::reportNumber; $reportNumber ]
    Perform Find [ ]
    Set Variable [ $foundCount; Value:Get (FoundCount) ]
    Close Window [ Current Window ]
    #
    #If this is the last subjection, let the user know
    #that if deleted this test will also be deleted.
    If [ $foundCount = 1 ]
    Set Variable [ $deleteGroup; Value:$delete ]
    Refresh Window
    Show Custom Dialog [ Message: "If you delete test# " & $reportNumber & "'s last section, it will also be deleted."; Default Button: “Cancel”, Commit: “Yes”; Button 2: “Delete”, Commit: “No” ]
    #
    #If the user cancels the delete, then everything
    #goes back to the way it was before the delete
    #was started.
    If [ Get ( LastMessageChoice ) = 1 ]
    Set Variable [ $delete ]
    Set Variable [ $deleteGroup ]
    Refresh Window
    Exit Script [ ]
    End If
    End If
    End If
    #
    #If the user approves of the delete, then delete
    #this sub-section. NOTE: There really is no
    #test that any sub-section belongs to. The
    #sort is simply grouping all sub-sections by
    #their report number, so it looks like they are
    #under a group. Thus, deleting the last sub-
    #section with particular test number will also
    #cause the appearance of its test number to
    #disappear.
    Delete Record/Request [ No dialog ]
    #

Fields used in this script

    testSectionCreatedFromATemplate::_LtestSection
    testSectionCreatedFromATemplate::inUse
    testSubjectName::orderOrLock
    testSubjectName::tag
    testSectionCreatedFromATemplate::ktestSubjectNode
    testSectionCreatedFromATemplate::reportNumber
    testSectionCreatedFromATemplate::name

Scripts used in this script

Layouts used in this script

Tables used in this script

    tag
    testSectionCreatedFromATemplate

Table occurrences used by this script

    testSectionCreatedFromATemplate
    testSubjectName

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [deleteSubsectionFromUserTest]	Parent Folder: [setup]	Next Script: [duplicateSectionFromTemplate]
Script Name	deleteTestItem
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    setupTestItem
    testMenuTestItemEdit
    testMenuTestItemMORE

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #If there are no tests, then stop this script as there
    #are no test to create things for.
    If [ TEMP::ktestSubsection = "" ]
    Show Custom Dialog [ Message: "There are no tests."; Default Button: “OK”, Commit: “No” ]
    Exit Script [ ]
    End If
    #
    #
    #I shifted record lock-logic from individual
    #records to groups of records, which is why
    #this code is disabled.
    // If [ tagCreatorLock::orderOrLock ≠ "" ]
    // Show Custom Dialog [ Message: "This record is locked. Go the node that created it — " & tagCreatorLock::tag & " — in the setup tag window and enter the password to unlock it so that you can delete it."; Default Button: “OK”, Commit: “Yes” ]
    // Exit Script [ ]
    // End If
    #
    #If the node that created this group is locked
    #the group even if items in it where not created
    #by this node.
    If [ nodeLockTestTagItemGroup::orderOrLock ≠ "" ]
    Show Custom Dialog [ Message: "All items in this group are locked. Go the node that created this group — " & nodeLockTestTagItemGroup::tag & " — in the setup tag window and enter the password to unlock it so that you can delete items in it."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #If there are no items to delete, exit this script.
    If [ Get (FoundCount) = 0 ]
    Exit Script [ ]
    End If
    #
    #Get variables needed for delete and delete messages.
    Set Variable [ $delete; Value:tagMenus::_Ltag ]
    Set Variable [ $group; Value:tagMenuTestItemGroup::_Lgroup ]
    Set Variable [ $groupName; Value:If ( Char ( tagMenuTestItemGroup::name ) ≤ 20 ; tagMenuTestItemGroup::name ; Left ( tagMenuTestItemGroup::name ; 20 ) & "..." ) ]
    Set Variable [ $testItemName; Value:If ( Char ( tagMenus::tag ) ≤ 20 ; tagMenus::tag ; Left ( tagMenus::tag ; 20 ) & "..." ) ]
    If [ tagMenus::textStyleOrCreatorNodeFlag = "1" ]
    Set Field [ tagMenus::tag; TextColor ( tagMenus::tag ; RGB ( 255 ; 255 ; 255 ) ) ]
    Else If [ tagMenus::textStyleOrCreatorNodeFlag = "2" ]
    Set Field [ tagMenus::tag; TextColor ( tagMenus::tag ; RGB ( 255 ; 255 ; 255 ) ) ]
    Else If [ tagMenus::textStyleOrCreatorNodeFlag = "3" ]
    Set Field [ tagMenus::tag; TextColor ( tagMenus::tag ; RGB ( 255 ; 255 ; 255 ) ) ]
    End If
    Refresh Window
    #
    #BEGIN: LEGACY STRATEGY for finding test results
    #in use that did not provide enough information.
    // #find and show all test records that might be using
    // #this item.
    // New Window [ Height: 1; Width: 1; Top: -1000; Left: -1000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    // Set Variable [ $$stopLoadTestRecord; Value:1 ]
    // Go to Layout [ “testResult0” (testlearn) ]
    // Set Error Capture [ On ]
    // Allow User Abort [ Off ]
    // Enter Find Mode [ ]
    // Set Field [ testlearn::kctestResultCheckedItems; $delete ]
    // Perform Find [ ]
    // #
    // Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::kreportNumber; ascending ] [ Restore; No dialog ]
    // Go to Record/Request/Page [ First ]
    // #
    // #Check if test item is in use by any test result records.
    // #Also capture how many results there are using
    // #item, and what general inquiries use this specifc inquiry.
    // Loop
    // Set Variable [ $number; Value:1 ]
    // Loop
    // If [ FilterValues ( GetValue ( testlearn::kctestResultCheckedItems ; $number ) ; $delete & "¶" ) = $delete & ¶ ]
    // Set Variable [ $addToInUse; Value:$inUse ]
    // Set Variable [ $inUse; Value:1 + $addToInUse ]
    // Set Variable [ $number; Value:"exit" ]
    // Set Variable [ $setNumberOfReports; Value:Case ( $report = "" ; 1 ; $report = testlearn::kreportNumber ; 1 ; $report ≠ testlearn::kreportNumber and Filter ($report ; testlearn::kreportNumber ) ≠ testlearn::kreportNumber ; $numberOfReports + 1 ; Filter ($report ; testlearn::kreportNumber ) = testlearn::kreportNumber ; $numberOfReports ; "error" ) ]
    // Set Variable [ $numberOfReports; Value:$setNumberOfReports ]
    // Set Variable [ $setReportNumber; Value:Case ( $report = "" ; testlearn::kreportNumber ; $report = testlearn::kreportNumber ; testlearn::kreportNumber ; $report ≠ testlearn::kreportNumber and Filter ($report ; testlearn::kreportNumber ) ≠ testlearn::kreportNumber ; $report & ", " & testlearn::kreportNumber ; testlearn::kreportNumber = Filter ($report ; testlearn::kreportNumber ) ; $report ; "error" ) ]
    // Set Variable [ $report; Value:$setReportNumber ]
    // End If
    // #
    // #If number was set to exit or if no keys exist, then
    // #exit loop.
    // Exit Loop If [ GetValue ( testlearn::kctestResultCheckedItems ; $number ) = "" ]
    // #
    // #If variable looked at did not match then raise the number
    // #to view the next variable.
    // Set Variable [ $add; Value:$number ]
    // Set Variable [ $number; Value:$add + 1 ]
    // End Loop
    // Go to Record/Request/Page [ Next; Exit after last ]
    // End Loop
    // Set Variable [ $report; Value:Case ( Filter ( Right ( $report ; 3 ) ; "," ) = "," ; Replace ( $report; Length ( $report ) - 2 ; 1 ; " and" ) ; Filter ( Right ( $report ; 4 ) ; "," ) = "," ; Replace ( $report; Length ( $report ) - 3 ; 1 ; " and" ) ; Filter ( Right ( $report ; 5 ) ; "," ) = "," ; Replace ( $report; Length ( $report ) - 4 ; 1 ; " and" ) ; $report ) ]
    // Set Variable [ $$stopLoadTestRecord ]
    // Close Window [ Current Window ]
    // #
    // #If in use the stop script.
    // If [ $inUse ≠ "" ]
    // Set Variable [ $cannotDelete; Value:$delete ]
    // Refresh Window
    // Show Custom Dialog [ Message: If ( $inUse = 1 ; "This specific inquiry is used as a check-off-the-list item for 1 test result in test " & $report & " in the test module. Uncheck it from this test result to delete it." ; "This specific inquiry is used as a check-off-the-list item for " & $inUse & " test results" & If ( $numberOfReports = 1 ; " in test " ; " between tests " ) & $report & " in the test module. Uncheck it from all " & $inUse & " results to delete it." ); Default Button: “OK”, Commit: “Yes” ]
    // Set Variable [ $cannotDelete ]
    // Set Variable [ $delete ]
    // Refresh Window
    // Exit Script [ ]
    // End If
    #END: LEGACY STRATEGY for finding test results
    #in use that did not provide enough information.
    #
    #
    Set Variable [ $$stopLoadTestRecord; Value:1 ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Set Variable [ $$stopDeleteTest; Value:1 ]
    Set Variable [ $$stopTest; Value:1 ]
    New Window [ Name: " "; Height: 1; Width: 1; Top: -10000; Left: -10000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “TEMP” (TEMP) ]
    Show All Records
    Delete All Records [ No dialog ]
    #
    #Go to the table layout, which has no load
    #record script triggers, and then find out if
    #this item is in use.
    Go to Layout [ “tableTestLearn” (testlearn) ]
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Enter Find Mode [ ]
    Set Field [ testlearn::kctestResultCheckedItems; $delete ]
    Perform Find [ ]
    #
    #If this item is found to be in use, then inform
    #user of where and prevent its deletion.
    If [ Get (LastError) ≠ 401 ]
    Loop
    Set Variable [ $useList; Value:TextColor( tagTLTestSubject::tag & " | test " & testlearn::kreportNumber & ¶ & "section " ;RGB(102;102;102)) & testSectionTemplateName::name & ¶ & TextColor( "sub-section " ;RGB(102;102;102)) & testlearn::subsectionCustomName ]
    Go to Layout [ “TEMP” (TEMP) ]
    New Record/Request
    Set Field [ TEMP::DeleteMessageInTempWindow1; $useList ]
    Go to Layout [ “testResult0” (testlearn) ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    Go to Layout [ “TEMP” (TEMP) ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: TEMP::DeleteMessageInTempWindow1; ascending ] [ Restore; No dialog ]
    View As [ View as List ]
    #
    Show/Hide Toolbars [ Lock; Hide ]
    Show/Hide Text Ruler [ Hide ]
    Move/Resize Window [ Current Window; Top: 0; Left: 0 ]
    Move/Resize Window [ Current Window; Height: Get ( ScreenHeight ); Width: 360; Top: 0; Left: Get ( ScreenWidth ) - ( Get ( ScreenWidth )/2 + 360) ]
    Set Field [ TEMP::Message; "Before the highlighted test item can be deleted, it must unchecked " & ¶ & "(in the test module) from test results in the test sub-sections below." ]
    Pause/Resume Script [ Indefinitely ]
    Close Window [ Current Window ]
    Set Variable [ $delete ]
    Set Variable [ $$stopLoadTestRecord ]
    Set Variable [ $$stopLoadTagRecord ]
    Set Variable [ $$stopDeleteTest ]
    Set Variable [ $$stopTest ]
    If [ tagMenus::textStyleOrCreatorNodeFlag = "1" ]
    Set Field [ tagMenus::tag; TextColor ( tagMenus::tag ; RGB ( 99 ; 99 ; 99 ) ) ]
    Else If [ tagMenus::textStyleOrCreatorNodeFlag = "2" ]
    Set Field [ tagMenus::tag; TextColorRemove ( tagMenus::tag ; RGB ( 255 ; 255 ; 255 ) ) ]
    Else If [ tagMenus::textStyleOrCreatorNodeFlag = "3" ]
    Set Field [ tagMenus::tag; TextColor ( tagMenus::tag ; RGB ( 99 ; 99 ; 99 ) ) ]
    End If
    Refresh Window
    If [ tagMenus::notesOrCopyright = "T" or tagMenus::notesOrCopyright = "FT" ]
    Show Custom Dialog [ Message: "Before you can uncheck it, you will need to turn it back into a check item. Click the " & tagMenus::copyrightTextLockedORtextTitem & " button to the left."; Default Button: “OK”, Commit: “Yes” ]
    End If
    Exit Script [ ]
    Else
    Close Window [ Current Window ]
    Set Variable [ $$stopLoadTestRecord ]
    Set Variable [ $$stopLoadTagRecord ]
    Set Variable [ $$stopDeleteTest ]
    Set Variable [ $$stopTest ]
    End If
    #
    #
    #
    #Exit any fields and then contionally format field
    #to be deleted by this script.
    Go to Field [ ]
    Refresh Window
    Show Custom Dialog [ Message: "Delete " & $testItemName & "?"; Default Button: “Cancel”, Commit: “Yes”; Button 2: “Delete”, Commit: “No” ]
    Refresh Window
    #
    #If the user says yes, first make sure the record
    #is not the last record in its group. If it is and
    #the system deleted the record without deleting
    #the group too, this group would become
    #an orphan as only groups that have records
    #attached to them show up for the user to add
    #more records to them. So the group
    #record must also be deleted if this is the last
    #test item under it.
    If [ Get ( LastMessageChoice ) = 2 ]
    New Window [ Name: "delete tag"; Height: 1; Width: 1; Top: -1000; Left: -1000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “tableTag” (tagTable) ]
    Enter Find Mode [ ]
    Set Field [ tagTable::kGroupOrTest; $group ]
    Perform Find [ ]
    #
    #If there are more records under this cateogry
    #then the system deletes the current record without
    #any more user input.
    If [ Get (FoundCount) ≠ 1 ]
    Close Window [ Name: "Delete Tag"; Current file ]
    Delete Record/Request [ No dialog ]
    Set Variable [ $delete ]
    Set Variable [ $group ]
    Refresh Window
    Exit Script [ ]
    #
    #BUT if only one record is found user is asked
    #if they want to delete the category too.
    Else If [ Get (FoundCount) = 1 ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Set Variable [ $deleteGroup; Value:$group ]
    Refresh Window
    #
    #The records are sorted by category to show
    #the user which category is going to be deleted.
    // If [ TEMP::sortTestItem ≠ "cat" ]
    // Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuGroup::name; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuTestItemGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuTestItemGroup::_Lgroup; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    // End If
    #
    #Show user warning message dependening on
    #whether or not this group is part of other test's
    #test-item lists.
    If [ ValueCount ( tagMenuTestItemGroup::match ) > 1 ]
    Show Custom Dialog [ Message: "Deleting " & $testItemName & " will also delete its group ' " & $groupName & "' as it is the last item in this group."; Default Button: “Cancel”, Commit: “Yes”; Button 2: “Delete”, Commit: “No” ]
    If [ Get ( LastMessageChoice ) = 2 ]
    Show Custom Dialog [ Message: "This group — " & $groupName & " — is used by " & ValueCount ( tagMenuTestItemGroup::match ) - 1 & " other subsection's. OPTION 1: Delete it from ALL subsections. OPTION 2: Cancel delete and UNLINK it from just this subsection — " & TEMP::testSubsectionName & "."; Default Button: “Cancel”, Commit: “Yes”; Button 2: “Delete”, Commit: “No” ]
    End If
    Else If [ ValueCount ( tagMenuTestItemGroup::match ) = 1 ]
    Show Custom Dialog [ Message: "Deleting " & $testItemName & " will also delete its group ' " & $groupName & "' as it is the last item in this group."; Default Button: “Cancel”, Commit: “Yes”; Button 2: “Delete”, Commit: “No” ]
    End If
    #
    #If the user says yes, then delete both the tag and
    #the category record.
    If [ Get ( LastMessageChoice ) = 2 ]
    Delete Record/Request [ No dialog ]
    Select Window [ Name: "delete tag"; Current file ]
    Go to Layout [ “tableTagGroup” (testSubsectionGroup) ]
    Enter Find Mode [ ]
    Set Field [ testSubsectionGroup::_Lgroup; $group ]
    Perform Find [ ]
    Delete Record/Request [ No dialog ]
    Close Window [ Name: "Delete Tag"; Current file ]
    End If
    End If
    End If
    Set Variable [ $delete ]
    Set Variable [ $deleteGroup ]
    If [ tagMenus::textStyleOrCreatorNodeFlag = "1" ]
    Set Field [ tagMenus::tag; TextColor ( tagMenus::tag ; RGB ( 99 ; 99 ; 99 ) ) ]
    Else If [ tagMenus::textStyleOrCreatorNodeFlag = "2" ]
    Set Field [ tagMenus::tag; TextColorRemove ( tagMenus::tag ; RGB ( 255 ; 255 ; 255 ) ) ]
    Else If [ tagMenus::textStyleOrCreatorNodeFlag = "3" ]
    Set Field [ tagMenus::tag; TextColor ( tagMenus::tag ; RGB ( 99 ; 99 ; 99 ) ) ]
    End If
    Refresh Window

Fields used in this script

    TEMP::ktestSubsection
    tagCreatorLock::orderOrLock
    tagCreatorLock::tag
    nodeLockTestTagItemGroup::orderOrLock
    nodeLockTestTagItemGroup::tag
    tagMenus::_Ltag
    tagMenuTestItemGroup::_Lgroup
    tagMenuTestItemGroup::name
    tagMenus::tag
    tagMenus::textStyleOrCreatorNodeFlag
    testlearn::kctestResultCheckedItems
    testlearn::kreportNumber
    tagTLTestSubject::tag
    testSectionTemplateName::name
    testlearn::subsectionCustomName
    TEMP::DeleteMessageInTempWindow1
    TEMP::Message
    tagMenus::notesOrCopyright
    tagMenus::copyrightTextLockedORtextTitem
    tagTable::kGroupOrTest
    TEMP::sortTestItem
    tagMenuGroup::orderOrLibraryType
    tagMenuGroup::name
    tagMenus::orderOrLock
    tagMenuTestItemGroup::orderOrLibraryType
    tagMenuTestItemGroup::match
    TEMP::testSubsectionName
    testSubsectionGroup::_Lgroup

Scripts used in this script

Layouts used in this script

    testResult0
    TEMP
    tableTestLearn
    tableTag
    tableTagGroup

Tables used in this script

    TEMP
    tag
    tag
    tag
    tagGroup
    tagGroup
    testSectionCreatedFromATemplate
    testlearn

Table occurrences used by this script

    TEMP
    nodeLockTestTagItemGroup
    tagCreatorLock
    tagMenuGroup
    tagMenuTestItemGroup
    tagMenus
    tagTLTestSubject
    tagTable
    testSectionTemplateName
    testSubsectionGroup
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [deleteTestItem]	Parent Folder: [setup]	Next Script: [gotoSetupTest_Template]
Script Name	duplicateSectionFromTemplate
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultTestNewSection

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #If there are no record's to duplicate,
    #halt script.
    If [ Get (FoundCount) = 0 ]
    Halt Script
    End If
    #
    #If node is currenlty locked then stop script,
    #and inform the user.
    Perform Script [ “stopNewRecordsBeingCreatedByLockedNode” ]
    #
    #If the primary default node is unselected,
    #inform user and stop script.
    If [ tempSetup::kdefaultNodePrimary = "" ]
    Set Variable [ $$highlightTestSection; Value:1 ]
    Refresh Window
    Show Custom Dialog [ Message: "Select yourself (the node responsible) from Tag Menus window."; Default Button: “OK”, Commit: “No” ]
    Halt Script
    End If
    #
    #If the defautl test-subject node is unselected,
    #inform user and stop script.
    If [ TEMP::kdefaultNodeTestSubject = "" ]
    Set Variable [ $$highlightTestSection; Value:1 ]
    Refresh Window
    Show Custom Dialog [ Message: "All tests must have a test subject. 1) Click 'tag' above and then in the tags-menu window 2) click 'node'. 3) Select a node to be your test subject, or create a new node, and then 4) click the 'TS' button next to it."; Default Button: “OK”, Commit: “No” ]
    Halt Script
    End If
    #
    #If the defautl test-subject node doesn't
    #match the selected test's test subject,
    #inform the user.
    If [ testSectionCreatedFromATemplate::ktestSubjectNode ≠ TEMP::kdefaultNodeTestSubject ]
    Show Custom Dialog [ Message: testSubjectName::tag & "'s — test " & testSectionCreatedFromATemplate::reportNumber & " — will be duplicated for — " & TEMP::DEFAULTNodeTestSubjectName & "."; Default Button: “OK”, Commit: “Yes”; Button 2: “cancel”, Commit: “No” ]
    Else
    #
    #So instead of asking the user if they really
    #want to duplicate a tag, which makes a user
    #seem stupid, this question performs the
    #same function (are you sure) by informing
    #them how long it will take, giving them
    #opportunity to cancel this script.
    Show Custom Dialog [ Message: "Duplicating test " & testSectionCreatedFromATemplate::reportNumber & " for — " & TEMP::DEFAULTNodeTestSubjectName & " — will take just a few seconds."; Default Button: “OK”, Commit: “Yes”; Button 2: “cancel”, Commit: “No” ]
    End If
    #
    #Exit script if user clicks cancel.
    If [ Get ( LastMessageChoice ) = 2 ]
    Exit Script [ ]
    End If
    #
    #Get this test's identifying keys: test subject,
    #and number.
    Set Variable [ $testSubjectOld; Value:testSectionCreatedFromATemplate::ktestSubjectNode ]
    Set Variable [ $testNumberOld; Value:testSectionCreatedFromATemplate::reportNumber ]
    #
    #Get selected test subject's highest
    #test number.
    Set Variable [ $$stopLoadTestRecord; Value:1 ]
    New Window [ Name: "Duplicate Test"; Height: 1; Width: 1; Top: 10000; Left: 10000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    // New Window [ Name: "Duplicate Test"; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Enter Find Mode [ ]
    Set Field [ testSectionCreatedFromATemplate::ktestSubjectNode; TEMP::kdefaultNodeTestSubject ]
    Perform Find [ ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testSectionCreatedFromATemplate::reportNumber; descending ] [ Restore; No dialog ]
    Go to Record/Request/Page [ First ]
    Set Variable [ $newTestNumber; Value:testSectionCreatedFromATemplate::reportNumber + 1 ]
    #
    #Now get the test records to be duplicated.
    Enter Find Mode [ ]
    Set Field [ testSectionCreatedFromATemplate::ktestSubjectNode; $testSubjectOld ]
    Set Field [ testSectionCreatedFromATemplate::reportNumber; $testNumberOld ]
    Perform Find [ ]
    #
    #Create duplicate test records for the default
    #test subject.
    Go to Record/Request/Page [ First ]
    #
    Loop
    Set Variable [ $testSectionID; Value:testSectionCreatedFromATemplate::ksectionTemplate ]
    Set Variable [ $testSectionName; Value:testSectionCreatedFromATemplate::name ]
    #
    Select Window [ Name: "Setup"; Current file ]
    New Record/Request
    #
    Set Field [ testSectionCreatedFromATemplate::ksectionTemplate; $testSectionID ]
    Set Field [ testSectionCreatedFromATemplate::name; $testSectionName ]
    Set Field [ testSectionCreatedFromATemplate::reportNumber; $newTestNumber ]
    Set Field [ testSectionCreatedFromATemplate::ktestSubjectNode; TEMP::kdefaultNodeTestSubject ]
    Set Field [ testSectionCreatedFromATemplate::kcreatorNode; TEMP::kdefaultNodePrimary ]
    #
    Select Window [ Name: "Duplicate Test"; Current file ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Go to the duplicated test's first record.
    Close Window [ Name: "Duplicate Test"; Current file ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testSubjectName::tag; ascending testSectionCreatedFromATemplate::reportNumber; descending testSectionCreatedFromATemplate::order; based on value list: “order Pulldown List” testSectionCreatedFromATemplate::name; ascending ] [ Restore; No dialog ]
    Scroll Window [ Home ]
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ testSectionCreatedFromATemplate::ktestSubjectNode = TEMP::kdefaultNodeTestSubject ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Load it up.
    Set Variable [ $$stopLoadTestRecord ]
    Perform Script [ “loadTestSubjectTestSection” ]
    #

Fields used in this script

    tempSetup::kdefaultNodePrimary
    TEMP::kdefaultNodeTestSubject
    testSectionCreatedFromATemplate::ktestSubjectNode
    testSubjectName::tag
    testSectionCreatedFromATemplate::reportNumber
    TEMP::DEFAULTNodeTestSubjectName
    testSectionCreatedFromATemplate::ksectionTemplate
    testSectionCreatedFromATemplate::name
    TEMP::kdefaultNodePrimary
    testSectionCreatedFromATemplate::kcreatorNode
    testSectionCreatedFromATemplate::order

Scripts used in this script

    stopNewRecordsBeingCreatedByLockedNode
    loadTestSubjectTestSection

Layouts used in this script

Tables used in this script

    TEMP
    TEMP
    tag
    testSectionCreatedFromATemplate

Table occurrences used by this script

    TEMP
    tempSetup
    testSectionCreatedFromATemplate
    testSubjectName

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [duplicateSectionFromTemplate]	Parent Folder: [setup]	Next Script: [gotoSetupTest_TestSubjectTest]
Script Name	gotoSetupTest_Template
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultTest
    learnTest
    learnSTest
    testMenuTestItem
    reportTagItem

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Prevent user from going to the edit test
    #template section, when user has come here
    #from a Test or Report window. The scripts do
    #work to allow this, but it gives the user too
    #many options, and they can lose focus on
    #editing the current subsection's info, which is
    #why they have come here when the come from
    #the Report or Test windows.
    # Taking away this option here is just an
    #inconvenience, as the user can return to the
    #Setup Section and edit test templates.
    # The user is still allowed to go edit
    #templates from the Learn Section, when their
    #work is focused in the Learn Section versus
    #focused in the Test Section, and they have
    #just briefly come to the Learn Section to make
    #some quick edits, before returning the
    #Test Section.
    If [ ( $$testTagRecord = "" and $$learnRecord = "" ) = 0 ]
    // Show Custom Dialog [ Message: "Going to the test-template edit-section of the library is not allowed when coming here from Test or Report sections. Click the back buttons until you return to Library Setup. Then from Setup, go to the Test Template edit section."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #
    #
    #
    #
    #BEGIN: Stop this script if any of the following are true:
    #
    #If there are no test sections to go to from
    #the learn layout.
    If [ Left (Get (LayoutName) ; 5 ) = "learn" and Get (FoundCount) = 0 ]
    Exit Script [ ]
    End If
    #
    #Test subject is locked.
    #
    #NOTE: Although changing associated learn
    #and test item records cannot affect a test
    #subjects test result or report records, further
    #testing and so time is required to insure no
    #problems occur as a result of allowing users to
    #edit learn and test subsection records when
    #navigating from locked Test Section item and
    #info Tag Menus layouts.
    If [ $$testSubjectIsLocked ≠ "" and Get ( LayoutName ) ≠ "defaultTest" and Get ( LayoutName ) ≠ "learnTest" ]
    Show Custom Dialog [ Message: "The test subject — " & $$testSubjectIsLocked & " — is locked. To unlock, A) go back to the setup node tag menu. B) Select this test subject. C) Click 'lock' and enter the password."; Default Button: “OK”, Commit: “No” ]
    Set Variable [ $exit; Value:1 ]
    End If
    #
    #Primary node is locked.
    If [ TEMP::primaryNodeIsLocked ≠ "" ]
    If [ $exit = "" ]
    Show Custom Dialog [ Message: "The default primary node — " & TEMP::DEFAULTNodePrimaryName & " — is locked. Go to the Default Node Tag Menu and A) click 'lock' to unlock it, B) select an unlocked node for the primary node, or C) create a new primary node."; Default Button: “OK”, Commit: “No” ]
    Else
    Show Custom Dialog [ Message: "ALSO, the default primary node — " & TEMP::DEFAULTNodePrimaryName & " — is locked. Go to the Default Node Tag Menu and A) click 'lock' to unlock it, B) select an unlocked node for the primary node, or C) create a new primary node."; Default Button: “OK”, Commit: “No” ]
    End If
    Set Variable [ $exit; Value:1 ]
    End If
    #
    #Subsection is locked by its creator node.
    If [ $$testSubsectionIsLocked ≠ "" and Get ( LayoutName ) ≠ "defaultTest" or testSectionCreatorLock::orderOrLock ≠ "" and Get ( LayoutName ) ≠ "defaultTest" ]
    #
    If [ $exit = "" ]
    If [ Left (Get (LayoutName) ; 5 ) = "learn" ]
    Show Custom Dialog [ Message: "This test subsection's creator node — " & testSectionCreatorLock::tag & " — is locked. Go to the Default Node Tag Menu and click 'lock' to unlock it."; Default Button: “OK”, Commit: “Yes” ]
    Else
    Show Custom Dialog [ Message: "You can use all of this subsection's test items, but not edit them as this subsection is locked by its creator — " & $$testSubsectionIsLocked & ". If you know this node's password, you can unlock it on the Setup section's node menu."; Default Button: “OK”, Commit: “Yes” ]
    End If
    Set Variable [ $exit; Value:1 ]
    End If
    #
    End If
    #
    #If any of the above are true, then
    #exit this script.
    If [ $exit = 1 ]
    Exit Script [ ]
    End If
    #
    #
    #END: Stop this script if any of the following are true:
    #
    #
    #
    #
    #
    #Make sure script is starting in the
    #Tag Menus window.
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    #Clear citation match variable as effects the
    #exit field scripts in the test section.
    Set Variable [ $$citationMatch ]
    #
    #Stop the spell checking script to
    #speed things up.
    Set Variable [ $$stopTest; Value:1 ]
    #
    #Capture record ID so system can return user
    #after editing is complete.
    Set Variable [ $$recordNumber; Value:Get (RecordNumber) ]
    #
    #Capture test and test item IDs so system can
    #reset them. During edit user may go to a
    #different test record, thus changing these temp IDs.
    If [ Get (LayoutName) = "learnTest" ]
    Set Variable [ $$itemID; Value:testSubsectionTemplate::_LtestSubsection ]
    Else
    Set Variable [ $$itemID; Value:TEMP::ktestSubsection ]
    End If
    Set Variable [ $$detailID; Value:TEMP::ktestItemSubsection ]
    #
    #Capture layoutname so system can return user
    #after editing is complete.
    Set Variable [ $$module; Value:Get (LayoutName) ]
    #
    #Go to section tag menu so section script
    #steps below will work properly.
    Go to Layout [ “setupTestSection” (testSection) ]
    #
    #If coming from the library's Test Setup layout,
    #show user the library's test sections.
    If [ Left ( $$module ; 7 ) = "default" ]
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    View As [ View as List ]
    Enter Find Mode [ ]
    Set Field [ testSection::match; "testSection" ]
    Perform Find [ ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testSection::tag; ascending ] [ Restore; No dialog ]
    Go to Record/Request/Page [ First ]
    End If
    #
    #
    #
    #Capture record ID so system can return user
    #after editing is complete.
    Select Window [ Name: "Learn"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Setup"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Test"; Current file ]
    If [ Get (LastError) = 112 ]
    Select Window [ Name: "Report"; Current file ]
    End If
    End If
    Else If [ Get (LastError) ≠ 112 ]
    Set Variable [ $$LearnEdit; Value:testlearn::_Ltestlearn ]
    End If
    #
    #
    If [ Get (WindowName) ≠ "Setup" ]
    Set Variable [ $editingOneSubsection; Value:1 ]
    End If
    #
    #Take user to test setup layout and find all
    #test subsection templates. If coming from
    #Library Setup window, if coming from a Test
    #Tag Menus window or Report Tag Menus
    #window, then only find the one subsection
    #showing in that Tag Menus window.
    Set Variable [ $$ID; Value:"ignore" ]
    Go to Layout [ “setupTestSubsection” (testSubsectionTemplate) ]
    Set Window Title [ Current Window; New Title: "Test Templates" ]
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    If [ $editingOneSubsection ≠ 1 ]
    Show All Records
    Else
    Enter Find Mode [ ]
    Set Field [ testSubsectionTemplate::_LtestSubsection; $$itemID ]
    Perform Find [ ]
    End If
    #
    #If no test exist, then make sure Tag Menus
    #also shows no section templates.
    If [ Get (LastError) = 401 ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Perform Find [ Specified Find Requests: Find Records; Criteria: tagMenus::_Ltag: “"findNOrecords"” ] [ Restore ]
    Select Window [ Name: "Setup"; Current file ]
    #
    #Turn back on spell check script.
    Set Variable [ $$stopTest ]
    #
    Exit Script [ ]
    End If
    Sort Records [ Keep records in sorted order; Specified Sort Order: testSubsectionGroup::orderOrLibraryType; based on value list: “order Pulldown List” testSubsectionGroup::name; ascending testSubsectionTemplate::order; based on value list: “order Pulldown List” testSubsectionTemplate::name; ascending ] [ Restore; No dialog ]
    Scroll Window [ Home ]
    Go to Record/Request/Page [ First ]
    #
    #Conditionally format item and its tags.
    Set Variable [ $$ID ]
    If [ $editingOneSubsection = 1 ]
    Show Custom Dialog [ Message: "Test items can ONLY be added and removed from the subsection being edited. To edit ALL subsections' test items, 1) click the back buttons until you return to Library Setup. 2) Click Test, and 3) click 2-3-4 templates."; Default Button: “OK”, Commit: “Yes” ]
    End If
    Perform Script [ “loadSetupTestSubsection” ]
    #
    #If coming from the test or report module show
    #user the Tag Menus window as they probably
    #want to edit a tag or add a new tag.
    If [ $$module = "testMenuTestItem" or $$module = "reportTagItem" ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Perform Script [ “menuTestItem” ]
    End If
    #
    #Turn back on spell check script.
    Set Variable [ $$stopTest ]
    #
    #

Fields used in this script

    TEMP::primaryNodeIsLocked
    TEMP::DEFAULTNodePrimaryName
    testSectionCreatorLock::orderOrLock
    testSectionCreatorLock::tag
    testSubsectionTemplate::_LtestSubsection
    TEMP::ktestSubsection
    TEMP::ktestItemSubsection
    testSection::match
    testSection::tag
    testlearn::_Ltestlearn
    tagMenus::_Ltag
    testSubsectionGroup::orderOrLibraryType
    testSubsectionGroup::name
    testSubsectionTemplate::order
    testSubsectionTemplate::name

Scripts used in this script

    loadSetupTestSubsection
    menuTestItem

Layouts used in this script

    setupTestSection
    setupTestSubsection

Tables used in this script

    TEMP
    tag
    tag
    tag
    tagGroup
    testSubsectionTemplate
    testlearn

Table occurrences used by this script

    TEMP
    tagMenus
    testSection
    testSectionCreatorLock
    testSubsectionGroup
    testSubsectionTemplate
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [gotoSetupTest_Template]	Parent Folder: [setup]	Next Script: [gotoTechView]
Script Name	gotoSetupTest_TestSubjectTest
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultTest

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #If the PRIMARY node is currenlty locked then
    #stop this script, and inform the user.
    If [ TEMP::primaryNodeIsLocked ≠ "" ]
    Show Custom Dialog [ Message: "The default primary node — " & TEMP::DEFAULTNodePrimaryName & " — is locked. Go to the Default Node Tag Menu and A) click 'lock' to unlock it, B) select an unlocked node for the primary node, or C) create a new primary node."; Default Button: “OK”, Commit: “No” ]
    Exit Script [ ]
    End If
    #
    Go to Layout [ “defaultTestNewSection” (testSectionCreatedFromATemplate) ]
    #

Fields used in this script

    TEMP::primaryNodeIsLocked
    TEMP::DEFAULTNodePrimaryName

Scripts used in this script

Layouts used in this script

    defaultTestNewSection

Tables used in this script

    TEMP

Table occurrences used by this script

    TEMP

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [gotoSetupTest_TestSubjectTest]	Parent Folder: [setup]	Next Script: [gotoTestSubject_CreationDateField]
Script Name	gotoTechView
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    testSetupTechView
    setupTestItemTechView

Scripts that use this script

Script Definition
Script Steps

    If [ $$techView = 1 ]
    Select Window [ Name: "Setup"; Current file ]
    Go to Layout [ “setupTestSubsection” (testSubsectionTemplate) ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Go to Layout [ “setupTestItem” (tagMenus) ]
    Set Variable [ $$techView ]
    Else
    Select Window [ Name: "Setup"; Current file ]
    Go to Layout [ “testSetupTechView” (testSubsectionTemplate) ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Go to Layout [ “setupTestItemTechView” (tagMenus) ]
    Set Variable [ $$techView; Value:1 ]
    End If

Fields used in this script

Scripts used in this script

Layouts used in this script

    setupTestSubsection
    setupTestItem
    testSetupTechView
    setupTestItemTechView

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [gotoTechView]	Parent Folder: [setup]	Next Script: [gotoTestSubject_SectionField]
Script Name	gotoTestSubject_CreationDateField
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultTestNewSection

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Test subject is not locked.
    If [ testSubjectName::orderOrLock = "" ]
    Go to Field [ testSectionCreatedFromATemplate::creationDate ]
    End If
    #
    #

Fields used in this script

    testSubjectName::orderOrLock
    testSectionCreatedFromATemplate::creationDate

Scripts used in this script

Layouts used in this script

Tables used in this script

    tag
    testSectionCreatedFromATemplate

Table occurrences used by this script

    testSectionCreatedFromATemplate
    testSubjectName

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [gotoTestSubject_CreationDateField]	Parent Folder: [setup]	Next Script: [linkOrUnlinkTestItemGroupToTestItemList]
Script Name	gotoTestSubject_SectionField
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultTestNewSection

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #Test subject is locked.
    If [ testSubjectName::orderOrLock ≠ "" ]
    Go to Field [ testSectionCreatedFromATemplate::nameOnTestResult ]
    #Test subject is not locked.
    Else
    Go to Field [ testSectionCreatedFromATemplate::name ]
    End If
    #
    #

Fields used in this script

    testSubjectName::orderOrLock
    testSectionCreatedFromATemplate::nameOnTestResult
    testSectionCreatedFromATemplate::name

Scripts used in this script

Layouts used in this script

Tables used in this script

    tag
    testSectionCreatedFromATemplate

Table occurrences used by this script

    testSectionCreatedFromATemplate
    testSubjectName

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [gotoTestSubject_SectionField]	Parent Folder: [setup]	Next Script: [loadSetupTestSection]
Script Name	linkOrUnlinkTestItemGroupToTestItemList
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Go to Field [ ]
    #
    #If subsection is locked stop its test item list
    #from being changed, other than added to.
    If [ $$lockedMainSubsectionRecord ≠ "" ]
    Show Custom Dialog [ Message: "This subsection is locked. Go to the Setup node menu and enter the password for the node — " & tagCreatorLock::tag & " — to unlock it."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #Exit script if any of the current groups test items
    #are in use. ( At a later date, improve this script
    # so it finds the specific records in use and informs
    # user of them specficially so user can find
    # them and know how many their are. )
    #
    #find and show all test records that might be using
    #any item in this group.
    Set Variable [ $$stopLoadTestRecord; Value:1 ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Set Variable [ $$stopDeleteTest; Value:1 ]
    Set Variable [ $$stopTest; Value:1 ]
    #
    #Capture group key to be linked to or unlinked
    #from the link pulldown selection the user just made.
    Set Variable [ $group; Value:addTestItemGroup::addTestItemGroup ]
    Set Variable [ $groupHighlight; Value:addTestItemGroup::addTestItemGroup ]
    Set Field [ addTestItemGroup::addTestItemGroup; "" ]
    New Window [ Name: "Test Results"; Height: 1; Width: 1; Top: -10000; Left: -10000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    // New Window [ Name: "Test Results"; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Enter Find Mode [ ]
    Set Field [ tagMenuTestItemGroup::_Lgroup; $group ]
    Perform Find [ ]
    #
    #Create a variable keychain of all test items that could
    #be used.
    Go to Record/Request/Page [ First ]
    Loop
    Set Variable [ $addToCheck; Value:$check ]
    Set Variable [ $check; Value:tagMenus::_Ltag & ¶ & $addToCheck ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Check each specific inquiry in its group to
    #see if any are being used as check-of-the-
    #list items for the selected general inquiry in
    #the Setup window.
    Go to Layout [ “testResult0” (testlearn) ]
    Enter Find Mode [ ]
    Set Field [ testlearn::ktestSubsection; TEMP::ktestSubsection ]
    Perform Find [ ]
    #
    #Go the first record.
    Go to Record/Request/Page [ First ]
    #
    #Prepare the message window, by clearing all
    #records from the last time it was used.
    Go to Layout [ “TEMP” (TEMP) ]
    Show All Records
    Delete All Records [ No dialog ]
    Go to Layout [ “testResult0” (testlearn) ]
    #
    #The first loop checks for each test item.
    Set Variable [ $groupNumber; Value:1 ]
    #
    #The first loop checks link of test-item group
    #to the selected subsection currently using it.
    Loop
    Set Variable [ $item; Value:GetValue ( $check ; $groupNumber ) ]
    #
    #Second loop checks if any of the test items in
    #the group are used (checked off) for any test
    #result records.
    Loop
    Set Variable [ $number; Value:1 ]
    Loop
    If [ FilterValues ( GetValue ( testlearn::kctestResultCheckedItems ; $number ) ; $item & ¶ ) = $item & ¶ ]
    #
    Set Variable [ $addToInUse; Value:$inUse ]
    Set Variable [ $inUse; Value:$addToInUse & $item & ¶ ]
    #
    Set Variable [ $useList; Value:tagTLTestSubject::tag & " | test/report " & TextColor( TextStyleAdd ( testlearn::kreportNumber; "" ) ;RGB(0;0;0)) & ¶ & "section " & TextColor( TextStyleAdd ( testSectionTemplateName::name; "" ) ;RGB(0;0;0)) & ¶ & "title " & TextColor( TextStyleAdd ( testlearn::subsectionCustomName; "" ) ;RGB(0;0;0)) ]
    Go to Layout [ “TEMP” (TEMP) ]
    New Record/Request
    Set Field [ TEMP::DeleteMessageInTempWindow1; $useList ]
    Go to Layout [ “testResult0” (testlearn) ]
    End If
    #
    #If number was set to exit or if no keys exist, then
    #exit loop.
    Exit Loop If [ GetValue ( testlearn::kctestResultCheckedItems ; $number ) = "" ]
    #
    #If variable looked at did not match then raise the number
    #to view the next variable.
    Set Variable [ $add; Value:$number ]
    Set Variable [ $number; Value:$add + 1 ]
    End Loop
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #If no more items in group then exit loop.
    Exit Loop If [ GetValue ( $check ; $groupNumber ) = "" ]
    #
    #If variable looked at did not match then raise the number
    #to view the next variable.
    Set Variable [ $addToGroup; Value:$groupNumber ]
    Set Variable [ $groupNumber; Value:$addToGroup + 1 ]
    Go to Record/Request/Page [ First ]
    End Loop
    #
    #
    If [ $inUse ≠ "" ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    Select Window [ Name: "Test Results"; Current file ]
    Go to Layout [ “TEMP” (TEMP) ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: TEMP::DeleteMessageInTempWindow1; ascending ] [ Restore; No dialog ]
    View As [ View as List ]
    #
    Show/Hide Toolbars [ Lock; Hide ]
    Show/Hide Text Ruler [ Hide ]
    #
    #Due to a bug in FM13, window must first be
    #moved back into the screen area before the
    #calculation of the current screen's
    #dimensions can be taken.
    Move/Resize Window [ Current Window; Top: 0; Left: 0 ]
    Move/Resize Window [ Name: "Test Results"; Current file; Height: Get ( ScreenHeight ); Width: 360; Top: 0; Left: Get ( ScreenWidth ) - ( Get ( ScreenWidth )/2 + 360) ]
    Set Field [ TEMP::Message; "To unlink this specific-inquiry group, uncheck the highlighted specific inquires (in the test module) from the test results below." ]
    Pause/Resume Script [ Indefinitely ]
    Close Window [ Current Window ]
    Set Variable [ $delete ]
    Set Variable [ $cannotDelete ]
    Set Variable [ $groupHighlight ]
    Set Variable [ $$stopLoadTestRecord ]
    Set Variable [ $$stopLoadTagRecord ]
    Set Variable [ $$stopDeleteTest ]
    Set Variable [ $$stopTest ]
    Refresh Window
    Exit Script [ ]
    #
    Else
    Close Window [ Current Window ]
    Set Variable [ $$stopLoadTestRecord ]
    Set Variable [ $$stopLoadTagRecord ]
    Set Variable [ $$stopDeleteTest ]
    Set Variable [ $$stopTest ]
    #
    End If
    #
    #
    #Open a new window and find this test item group.
    New Window [ Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “tableTagGroup” (testSubsectionGroup) ]
    Enter Find Mode [ ]
    Set Field [ testSubsectionGroup::_Lgroup; $group ]
    Perform Find [ ]
    #
    #Capture current list of testList keys.
    Set Variable [ $match; Value:testSubsectionGroup::match ]
    #
    #Remove the key from the list of test-item
    #group keys, unless it only belongs to this list,
    #in which case tell user that rather than
    #unlinking it, the list needs to be deleted
    #or linked to another test before unlinking it
    #from the current test's list.
    If [ TEMP::ktestItemSubsection & "¶" = FilterValues ( $match ; TEMP::ktestItemSubsection & "¶" ) ]
    #
    #Determine if test-item group belongs to more
    #than one test.
    If [ ValueCount ( testSubsectionGroup::match ) = 1 ]
    Close Window [ Current Window ]
    Go to Field [ ]
    Show Custom Dialog [ Message: "This group cannot be unlinked because it is only linked to this test-item list and unlinking it would orphan it. Option 1: delete all items in group to remove it. Option 2: link it to another test and then unlink it from this test."; Default Button: “OK”, Commit: “No” ]
    Set Variable [ $groupHighlight ]
    Refresh Window
    Exit Script [ ]
    Else If [ ValueCount ( testSubsectionGroup::match ) ≠ 1 ]
    Set Field [ testSubsectionGroup::match; Substitute ( $match ; TEMP::ktestItemSubsection & "¶" ; "" ) ]
    Close Window [ Current Window ]
    End If
    #
    #Add the key to list of test keys, if it is not currently
    #part of this list.
    Else If [ TEMP::ktestItemSubsection & "¶" ≠ FilterValues ( $match ; TEMP::ktestItemSubsection & "¶" ) ]
    Set Field [ testSubsectionGroup::match; TEMP::ktestItemSubsection & ¶ & $match ]
    Set Variable [ $newGrouphasBeenAdded; Value:1 ]
    Close Window [ Current Window ]
    End If
    #
    #Show newly added group and its test items.
    Perform Script [ “menuTestItem” ]
    #
    #Take user to group added.
    If [ $newGrouphasBeenAdded ]
    If [ $group = tagMenuTestItemGroup::_Lgroup ]
    Set Variable [ $$stopLoadTagRecord ]
    Exit Script [ ]
    End If
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ $group = tagMenuTestItemGroup::_Lgroup ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    Set Variable [ $$stopLoadTagRecord ]
    Perform Script [ “loadTagRecord” ]
    End If
    #
    #

Fields used in this script

    tagCreatorLock::tag
    addTestItemGroup::addTestItemGroup
    tagMenuTestItemGroup::_Lgroup
    tagMenus::_Ltag
    TEMP::ktestSubsection
    testlearn::ktestSubsection
    testlearn::kctestResultCheckedItems
    tagTLTestSubject::tag
    testlearn::kreportNumber
    testSectionTemplateName::name
    testlearn::subsectionCustomName
    TEMP::DeleteMessageInTempWindow1
    TEMP::Message
    testSubsectionGroup::_Lgroup
    testSubsectionGroup::match
    TEMP::ktestItemSubsection

Scripts used in this script

    menuTestItem
    loadTagRecord

Layouts used in this script

    testResult0
    TEMP
    tableTagGroup

Tables used in this script

    TEMP
    TEMP
    tag
    tag
    tagGroup
    testSectionCreatedFromATemplate
    testlearn

Table occurrences used by this script

    TEMP
    addTestItemGroup
    tagCreatorLock
    tagMenuTestItemGroup
    tagMenus
    tagTLTestSubject
    testSectionTemplateName
    testSubsectionGroup
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [linkOrUnlinkTestItemGroupToTestItemList]	Parent Folder: [setup]	Next Script: [loadSetupTestSubsection]
Script Name	loadSetupTestSection
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    If [ $$stopTest = 1 ]
    Exit Script [ ]
    End If
    #
    #Set all variables needed for performing various
    #scripts while in test setup mode.
    Set Variable [ $$setupTestSection ]
    Refresh Window
    Select Window [ Name: "Test Templates"; Current file ]
    Refresh Window
    Select Window [ Name: "Tag Menus"; Current file ]

Fields used in this script

Scripts used in this script

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [loadSetupTestSection]	Parent Folder: [setup]	Next Script: [loadTestSubjectTestSection]
Script Name	loadSetupTestSubsection
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    checkTestSectionSubsectionAndItemRecordSpellings
    nextPage
    pagePulldown
    previousPage
    deleteSubsection
    gotoSetupTest_Template

Script Definition
Script Steps

    #
    #
    #Stop script if needed to speed up other scripts.
    If [ $$ID = testSubsectionTemplate::_LtestSubsection or $$ID = "ignore" or $$stopDeleteTest = 1 or $$goBackToSetup = 1 ]
    Exit Script [ ]
    End If
    #
    #Set all variables needed for performing various
    #scripts while in test setup mode.
    Set Variable [ $$ID; Value:testSubsectionTemplate::_LtestSubsection ]
    Set Variable [ $$stopTest; Value:1 ]
    Go to Field [ ]
    Set Variable [ $$stopTest ]
    #
    // #Remove section hightlight if turned on.
    // Set Variable [ $$setupTestSection ]
    #
    #Note if record is locked to protect its tags.
    If [ testSectionCreatorLock::orderOrLock ≠ "" ]
    Set Variable [ $$lockedMainSubsectionRecord; Value:testSectionCreatorLock::tag ]
    Else
    Set Variable [ $$lockedMainSubsectionRecord ]
    End If
    #
    #Get subsection's group key for the 'move'
    #button script.
    Set Variable [ $$subsectionGroupOLD; Value:testSubsectionTemplate::ksubsectionGroup ]
    #
    #The test item list temp fields allow users to switch
    #from their current list to another list.
    Set Field [ TEMP::ktestItemSubsection; testSubsectionTemplate::ktestItemGroup ]
    Set Field [ TEMP::ktestItemSubsectionOLD; testSubsectionTemplate::ktestItemGroup ]
    #
    Set Field [ TEMP::ktestSubsection; testSubsectionTemplate::_LtestSubsection ]
    Set Field [ TEMP::mTag; TEMP::ktestSubsection ]
    #
    #Used on Tag Menus window item layout for switch.
    Set Field [ TEMP::testSubsectionName; testSubsectionTemplate::name ]
    Set Variable [ $$subsectionSections; Value:testSubsectionTemplate::kcsections ]
    #
    #
    #
    #Get the name of the test for the test item list
    #name temp field.
    #
    #The reason for this whole section of the script
    #(getting a test name) is that there is no relationship
    #that can be made that would match the key of
    #of the named test to this test and thus unlock
    #and so allow the layout to show this test's name.
    #This is because the key to unlock the display of
    #a test's name is in a keychain field where many
    #keys may exist in a list. Filemaker cannot match
    #a lock in one table to list of keys in another table.
    #There must be only one key in a field in order
    #for Filemaker to know which key to use in a lock.
    #The database does not have the intellegence or
    #programming to search through a list of keys
    #to make a match to a lock field in another table.
    #Thus, in order to display the name of the test in use
    #we must have the system put that name in a temp
    #field with global storage, which then allows it
    #to be displayed on any layout where that temp
    #field is displayed. No relationship between the
    #the temp table and the layout's table is required
    #as long as the temp field is a global field, meaning
    #all data in the field is the same for every record
    #in the temp table.
    #
    #If the test list belongs (has the key that fits the
    #test's lock) then set the temp field with this test's name.
    If [ testSubsectionTemplate::_LtestSubsection = testSubsectionTemplate::ktestItemGroup ]
    #
    #Set a temp field with this test's name. This name
    #field will then be used to show this test's name on
    #the Tag Menus layout for setupTestItems.
    Set Field [ TEMP::ktestSubsectionName; testSubsectionTemplate::name ]
    #
    #If the test list does not belong to this test
    #(has the key that fits A DIFFERENT test's lock)
    #then set the temp field with this other test's name.
    Else If [ testSubsectionTemplate::_LtestSubsection ≠ testSubsectionTemplate::ktestItemGroup ]
    #
    #Get the ID of the current record so it can be
    #looped back to.
    Set Variable [ $currentTest; Value:testSubsectionTemplate::_LtestSubsection ]
    #
    #Turn of the record load triggered scripts
    #to speed up this loop search.
    Set Variable [ $$ID; Value:"ignore" ]
    Set Variable [ $$stopTest; Value:1 ]
    New Window [ Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    #
    #Go to the first record and then test it and every
    #other record until the test in question is found.
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ testSubsectionTemplate::_LtestSubsection = TEMP::ktestItemSubsection ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Set a temp field with this test's name. This name
    #field will then be used to show this test's name on
    #the Tag Menus layout for setupTestItems.
    Set Field [ TEMP::ktestSubsectionName; testSubsectionTemplate::name ]
    #
    #Update key used for the move pulldown.
    Set Field [ TEMP::mTag; TEMP::ktestItemSubsection ]
    #
    #go back to current test.
    Close Window [ Current Window ]
    Set Variable [ $$ID; Value:$currentTest ]
    Set Variable [ $$stopTest ]
    Refresh Window
    End If
    #
    #If the user has come to this screen from the test item
    #window, then the itemName variable needs to be updated.
    If [ $$itemName ≠ "" ]
    Set Variable [ $$itemName; Value:TEMP::ktestSubsectionName ]
    End If
    #
    Select Window [ Name: "Tag Menus"; Current file ]
    If [ Get (LastError) = 112 ]
    New Window [ Name: "Tag Menus"; Height: Get (ScreenHeight); Width: Get (ScreenWidth) / 2; Left: Get (ScreenWidth) / 2; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “setupTestSection” (testSection) ]
    End If
    #
    #Find test items for test if user is currently looking
    #at test items on the Tag Menus window.
    If [ Get (LayoutName) = "setupTestItem" or Get (LayoutName) = "setupTestItemLOCKED" ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    #
    #If subsection is locked go the locked
    #versus unlocked layout.
    If [ $$lockedMainSubsectionRecord ≠ "" ]
    Go to Layout [ “setupTestItemLOCKED” (tagMenus) ]
    Else
    Go to Layout [ “setupTestItem” (tagMenus) ]
    End If
    #
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Enter Find Mode [ ]
    Set Field [ tagMenuTestItemGroup::match; TEMP::ktestItemSubsection & ¶ ]
    Perform Find [ ]
    Set Variable [ $$stopLoadTagRecord ]
    #
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuTestItemGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuTestItemGroup::name; ascending tagMenuTestItemGroup::_Lgroup; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    Scroll Window [ Home ]
    Go to Record/Request/Page [ First ]
    #
    #
    #Ask the user if they would like to see the
    #whole test item when they click on one or not
    #(they just want to go to that tag record).
    If [ $$rememberTestItemChoice ≠ 1 and Get(FoundCount) ≠ 0 ]
    Show Custom Dialog [ Message: "Show all a test-item's text when you first click directly on the text, or just go to the record?"; Default Button: “JustGo”, Commit: “No”; Button 2: “ShowAll”, Commit: “No” ]
    #
    If [ Get (LastMessageChoice) = 1 ]
    Set Variable [ $$showAll ]
    #
    Else If [ Get (LastMessageChoice) = 2 ]
    Set Variable [ $$showAll; Value:1 ]
    End If
    #
    #Ask if user would like their choice to be
    #remembered for this session (until the library
    #is restarted).
    Show Custom Dialog [ Message: "Remember this decision for this session (if yes, you will not be asked again until you restart the library)?"; Default Button: “Remember”, Commit: “Yes”; Button 2: “Forget”, Commit: “No” ]
    #
    If [ Get (LastMessageChoice) = 1 ]
    Set Variable [ $$rememberTestItemChoice; Value:1 ]
    End If
    End If
    #
    #
    End If
    #
    #Refresh window in case user was on section layout.
    Refresh Window
    #
    #Return to setup window and refresh it to highlight
    #current record.
    Select Window [ Name: "Test Templates"; Current file ]
    Refresh Window
    #
    #
    Perform Script [ “exit” ]
    #
    #Stop dragged spelling changes check. It's too
    #annoying. It is run when user leaves the
    #template section.
    If [ $$module ≠ "testMenuTestItem" and $$module ≠ "reportTagItem" ]
    Halt Script
    End If
    #

Fields used in this script

    testSubsectionTemplate::_LtestSubsection
    testSectionCreatorLock::orderOrLock
    testSectionCreatorLock::tag
    testSubsectionTemplate::ksubsectionGroup
    testSubsectionTemplate::ktestItemGroup
    TEMP::ktestItemSubsection
    TEMP::ktestItemSubsectionOLD
    TEMP::ktestSubsection
    TEMP::mTag
    testSubsectionTemplate::name
    TEMP::testSubsectionName
    testSubsectionTemplate::kcsections
    TEMP::ktestSubsectionName
    tagMenuTestItemGroup::match
    tagMenuTestItemGroup::orderOrLibraryType
    tagMenuTestItemGroup::name
    tagMenuTestItemGroup::_Lgroup
    tagMenus::orderOrLock
    tagMenus::tag

Scripts used in this script

    exit

Layouts used in this script

    setupTestSection
    setupTestItemLOCKED
    setupTestItem

Tables used in this script

    TEMP
    tag
    tagGroup
    testSubsectionTemplate

Table occurrences used by this script

    TEMP
    tagMenuTestItemGroup
    tagMenus
    testSectionCreatorLock
    testSubsectionTemplate

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [loadSetupTestSubsection]	Parent Folder: [setup]	Next Script: [moveSubsectionToOtherGroup]
Script Name	loadTestSubjectTestSection
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    duplicateSectionFromTemplate
    newSectionFromTemplate

Script Definition
Script Steps

    #
    #Stop script if running a delete check.
    If [ $$stopLoadTestRecord = 1 ]
    Exit Script [ ]
    End If
    #
    #Admin tasks.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #Turn off highlights when leaving editsection
    #layout (called defaultTestNewSection).
    Set Variable [ $$highlightTestSection ]
    Refresh Window
    #
    #If no section-templates exist then clear the
    #section-template key and name fields.
    If [ ValueListItems ( Get ( FileName ) ; "defaultSectionTemplates" ) = "" ]
    Set Field [ TEMP::DEFAULTSectionName; "" ]
    Set Field [ TEMP::kdefaultSectionTemplate; "" ]
    End If
    #
    #If no records exist then stop the script.
    If [ Get (FoundCount) = 0 and $$stopFocusLoad = "" or Get (FoundCount) ≠ 0 and $$stopFocusLoad = 1 or $$stopSetReportNumber = 1 ]
    Exit Script [ ]
    End If
    #
    #Set default test number so any new sections
    #will be add to the selected test.
    Set Field [ TEMP::reportNumber; testSectionCreatedFromATemplate::reportNumber ]
    Go to Field [ ]
    #
    #Set test subject variable for conditionally
    #formatting the selected test.
    Set Variable [ $$testSubject; Value:testSectionCreatedFromATemplate::ktestSubjectNode ]
    Refresh Window
    #
    // #Pause prevents accidental click of
    // #section pulldown button after 'edit/newtest'
    // #button is clicked.
    // Set Variable [ $$pause; Value:1 ]
    // Pause/Resume Script [ Duration (seconds): .5 ]
    // Set Variable [ $$pause ]
    #

Fields used in this script

    TEMP::DEFAULTSectionName
    TEMP::kdefaultSectionTemplate
    testSectionCreatedFromATemplate::reportNumber
    TEMP::reportNumber
    testSectionCreatedFromATemplate::ktestSubjectNode

Scripts used in this script

Layouts used in this script

Tables used in this script

    TEMP
    testSectionCreatedFromATemplate

Table occurrences used by this script

    TEMP
    testSectionCreatedFromATemplate

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [loadTestSubjectTestSection]	Parent Folder: [setup]	Next Script: [newSection]
Script Name	moveSubsectionToOtherGroup
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #This script is for moving a test subsection
    #to a different group.
    #
    #
    #Admin tasks.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #If there is only one group, exit script.
    If [ ValueCount ( ValueListItems ( Get ( FileName ) ; "templateSubsectionGroups" ) ) = 1 ]
    Go to Field [ ]
    Exit Script [ ]
    End If
    #
    #If node is currenlty locked then stop script, inform user.
    If [ testSectionCreatorLock::orderOrLock ≠ "" ]
    Set Field [ testSubsectionTemplate::ksubsectionGroup; $$subsectionGroupOLD ]
    Go to Field [ ]
    Show Custom Dialog [ Message: "This record is locked. Go the node that created it -- " & testSectionCreatorLock::tag & " -- in the setup tag window and enter the password to unlock it so that you can move it."; Default Button: “OK”, Commit: “No” ]
    Exit Script [ ]
    End If
    #
    Set Variable [ $$moveItem; Value:testSubsectionTemplate::_LtestSubsection ]
    Refresh Window
    #
    #Stop test record load script to speed up script.
    Set Variable [ $$ID; Value:"ignore" ]
    Set Variable [ $$stopTest; Value:1 ]
    #
    #Get the newly selected group's ID number.
    Set Variable [ $newSubSectionGroup; Value:testSubsectionTemplate::ksubsectionGroup ]
    #
    #Reset the test's group ID with its old group ID
    #number grabbed by the system in part 1 of
    #this script, just in case the user decides to cancel
    #move and the test needs to stay put.
    Set Field [ testSubsectionTemplate::ksubsectionGroup; $$subsectionGroupOLD ]
    Go to Field [ ]
    #
    #Check if this is the last test in the test group.
    New Window [ Height: 1; Width: 1; Top: -10000; Left: -10000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “tableTestSubsectionTemplates” (testSubsectionTemplate) ]
    Enter Find Mode [ ]
    Set Field [ testSubsectionTemplate::ksubsectionGroup; $$subsectionGroupOLD ]
    Perform Find [ ]
    If [ Get (FoundCount) = 1 ]
    Close Window [ Current Window ]
    Set Variable [ $deleteGroup; Value:TEMP::ktestSubsection ]
    Refresh Window
    #
    #If it is the last item inform user that after the move
    #the old group will be deleted unless the user
    #creates a new item for this group before moving
    #the old item.
    Show Custom Dialog [ Title: "!"; Message: "The group — " & testSubsectionGroup::name & " — will be deleted if you complete this move. If you want to keep it: 1) click cancel, 2) create a new general inquiry for this group, then 3) perform the move."; Default Button: “Cancel”, Commit: “Yes”; Button 2: “move”, Commit: “No” ]
    If [ Get ( LastMessageChoice ) = 1 ]
    Set Variable [ $$stopTest ]
    Set Variable [ $$moveItem ]
    Set Variable [ $deleteGroup ]
    Set Variable [ $$ID; Value:testSubsectionTemplate::_LtestSubsection ]
    Refresh Window
    Go to Field [ ]
    Exit Script [ ]
    End If
    #
    #If the user decides to go ahead with the move,
    #first delete the old group.
    New Window [ Height: 1; Width: 1; Top: -10000; Left: -10000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    #
    Go to Layout [ “tableTagGroup” (testSubsectionGroup) ]
    Enter Find Mode [ ]
    Set Field [ testSubsectionGroup::_Lgroup; $$subsectionGroupOLD ]
    Perform Find [ ]
    Delete Record/Request [ No dialog ]
    #
    End If
    #
    #Close window opened to perform find, and then
    #set group ID of test with the new groups ID number.
    Close Window [ Current Window ]
    Set Field [ testSubsectionTemplate::ksubsectionGroup; $newSubSectionGroup ]
    Set Variable [ $$subsectionGroupOLD; Value:testSubsectionTemplate::ksubsectionGroup ]
    Go to Field [ ]
    #
    #Section window on selected record.
    Scroll Window [ Home ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testSubsectionGroup::orderOrLibraryType; based on value list: “order Pulldown List” testSubsectionGroup::name; ascending testSubsectionTemplate::order; based on value list: “order Pulldown List” testSubsectionTemplate::name; ascending ] [ Restore; No dialog ]
    #
    #Turn back on the loadrecord script. The current
    #record's info does not need to be reloaded of course
    #because it is still the current record.
    Set Variable [ $$stopTest ]
    Set Variable [ $$ID; Value:testSubsectionTemplate::_LtestSubsection ]
    Go to Field [ ]
    #
    #Turn off the move highlight.
    Set Variable [ $$moveItem ]
    Refresh Window
    #

Fields used in this script

    testSectionCreatorLock::orderOrLock
    testSubsectionTemplate::ksubsectionGroup
    testSectionCreatorLock::tag
    testSubsectionTemplate::_LtestSubsection
    TEMP::ktestSubsection
    testSubsectionGroup::name
    testSubsectionGroup::_Lgroup
    testSubsectionGroup::orderOrLibraryType
    testSubsectionTemplate::order
    testSubsectionTemplate::name

Scripts used in this script

Layouts used in this script

    tableTestSubsectionTemplates
    tableTagGroup

Tables used in this script

    TEMP
    tag
    tagGroup
    testSubsectionTemplate

Table occurrences used by this script

    TEMP
    testSectionCreatorLock
    testSubsectionGroup
    testSubsectionTemplate

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [moveSubsectionToOtherGroup]	Parent Folder: [setup]	Next Script: [newSectionFromTemplate]
Script Name	newSection
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    setupTestSection

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #If node is currenlty locked then stop script,
    #and inform the user.
    Perform Script [ “stopNewRecordsBeingCreatedByLockedNode” ]
    #
    #Create new section that can be added to
    #any subject's test.
    New Record/Request
    Set Field [ testSection::match; "testSection" ]
    Set Field [ testSection::tag; "section_template" ]
    Set Field [ testSection::tagSpelling; "section_template" ]
    Set Field [ testSection::kRecordCreatorNode; TEMP::kdefaultNodePrimary ]
    Go to Field [ testSection::tag ]
    #

Fields used in this script

    testSection::match
    testSection::tag
    testSection::tagSpelling
    TEMP::kdefaultNodePrimary
    testSection::kRecordCreatorNode

Scripts used in this script

    stopNewRecordsBeingCreatedByLockedNode

Layouts used in this script

Tables used in this script

    TEMP
    tag

Table occurrences used by this script

    TEMP
    testSection

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [newSection]	Parent Folder: [setup]	Next Script: [newSubsection]
Script Name	newSectionFromTemplate
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultTestNewSection

Scripts that use this script

Script Definition
Script Steps

    #
    #Pause prevents accidental click of
    #section pulldown button after 'edit/newtest'
    #button is clicked on main test layout.
    If [ $$pause = 1 ]
    Exit Script [ ]
    End If
    #
    #If node is currenlty locked then stop script,
    #and inform the user.
    Perform Script [ “stopNewRecordsBeingCreatedByLockedNode” ]
    #
    #Do not allow user to create a new section if...
    #
    #...section is not selected.
    If [ TEMP::kdefaultSectionTemplate= "" or TEMP::DEFAULTSectionName = "" ]
    Set Variable [ $$highlightTestSection; Value:1 ]
    Refresh Window
    If [ ValueListItems ( Get ( FileName ) ; "defaultSectionTemplates" ) = "" ]
    Show Custom Dialog [ Message: "There are no test-section templates available for creating new test sections. To create some 1) click 'back', then 2) click 'section-templatesetup' and finally 3) click 'new' to create your first test-section template. 4) Customize it to meet your needs."; Default Button: “OK”, Commit: “Yes” ]
    Halt Script
    End If
    If [ TEMP::DEFAULTSectionName = "" ]
    Show Custom Dialog [ Message: "Click 'select test section' now highlighted for you, and then select a test-section template from the pulldown menu that will appear. Your selected template will be used to create sections that you can add to any test."; Default Button: “OK”, Commit: “Yes” ]
    Else
    Show Custom Dialog [ Message: "Click '" & TEMP::DEFAULTSectionName & "', and then re-select a test-section template from the pulldown menu that will appear."; Default Button: “OK”, Commit: “Yes” ]
    End If
    Halt Script
    #
    #...report number is not selected.
    Else If [ TEMP::reportNumber = "" ]
    Set Variable [ $$highlightTestSection; Value:1 ]
    Refresh Window
    Show Custom Dialog [ Message: "Click '#' now highlighted for you, and then select the test's number that you want to add a new test-section to from the pulldown menu that will appear."; Default Button: “OK”, Commit: “Yes” ]
    Halt Script
    #
    #...test subject is not selected.
    Else If [ TEMP::kdefaultNodeTestSubject = "" ]
    Set Variable [ $$highlightTestSection; Value:1 ]
    Refresh Window
    Show Custom Dialog [ Message: "All tests must have a test subject. 1) Click 'tag' above and then in the tags-menu window 2) click 'node'. 3) Select a node to be your test subject, or create a new node, and then 4) click the 'TS' button next to it."; Default Button: “OK”, Commit: “Yes” ]
    Halt Script
    #
    #...test subject is selected, but is locked.
    Else If [ testSubjectName::orderOrLock ≠ "" ]
    Set Variable [ $$highlightTestSection; Value:1 ]
    Refresh Window
    #
    #Get the current test subject's name.
    Show Custom Dialog [ Message: "The test subject — " & testSubjectName::tag & " — is locked. To unlock, A) go back to the setup node tag menu. B) Select this test subject. C) Click 'lock' and enter the password."; Default Button: “OK”, Commit: “Yes” ]
    Halt Script
    End If
    #
    #If the defautl test-subject node doesn't
    #match the current users selected test
    #section's test-subject, inform the user.
    If [ testSectionCreatedFromATemplate::ktestSubjectNode ≠ TEMP::kdefaultNodeTestSubject ]
    Show Custom Dialog [ Message: "This new test section will be created for " & TEMP::DEFAULTNodeTestSubjectName & "."; Default Button: “OK”, Commit: “No”; Button 2: “cancel”, Commit: “No” ]
    If [ Get (LastMessageChoice) = 2 ]
    Halt Script
    End If
    End If
    #
    #Had to capture report number as variable or
    #stop record load script which would replace
    #the default number selection with nothing
    #upon new record creation.
    Set Variable [ $reportNumber; Value:TEMP::reportNumber ]
    #
    #Load up new record after it is fully created.
    Set Variable [ $$stopLoadTestRecord; Value:1 ]
    #
    #Create new record.
    New Record/Request
    Set Field [ testSectionCreatedFromATemplate::ksectionTemplate; TEMP::kdefaultSectionTemplate ]
    Set Field [ testSectionCreatedFromATemplate::reportNumber; $reportNumber ]
    Set Field [ testSectionCreatedFromATemplate::name; TEMP::DEFAULTSectionName ]
    Set Field [ testSectionCreatedFromATemplate::ktestSubjectNode; TEMP::kdefaultNodeTestSubject ]
    Set Field [ testSectionCreatedFromATemplate::kcreatorNode; TEMP::kdefaultNodePrimary ]
    #
    #Sort records so if user had selected a record
    #under a different test subject than the one
    #the record was just created for, this new
    #record will re-sort under its test subject.
    Sort Records [ Keep records in sorted order; Specified Sort Order: testSubjectName::tag; ascending testSectionCreatedFromATemplate::reportNumber; descending testSectionCreatedFromATemplate::order; based on value list: “order Pulldown List” testSectionCreatedFromATemplate::name; ascending ] [ Restore; No dialog ]
    #
    #Load up this new test section.
    Set Variable [ $$stopLoadTestRecord ]
    Perform Script [ “loadTestSubjectTestSection” ]
    #
    #Allow the user the change
    #this section's name.
    Go to Field [ testSectionCreatedFromATemplate::name ]
    #

Fields used in this script

    TEMP::kdefaultSectionTemplate
    TEMP::DEFAULTSectionName
    TEMP::reportNumber
    TEMP::kdefaultNodeTestSubject
    testSubjectName::orderOrLock
    testSubjectName::tag
    testSectionCreatedFromATemplate::ktestSubjectNode
    TEMP::DEFAULTNodeTestSubjectName
    testSectionCreatedFromATemplate::ksectionTemplate
    testSectionCreatedFromATemplate::reportNumber
    testSectionCreatedFromATemplate::name
    TEMP::kdefaultNodePrimary
    testSectionCreatedFromATemplate::kcreatorNode
    testSectionCreatedFromATemplate::order

Scripts used in this script

    stopNewRecordsBeingCreatedByLockedNode
    loadTestSubjectTestSection

Layouts used in this script

Tables used in this script

    TEMP
    tag
    testSectionCreatedFromATemplate

Table occurrences used by this script

    TEMP
    testSectionCreatedFromATemplate
    testSubjectName

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [newSectionFromTemplate]	Parent Folder: [setup]	Next Script: [newSubsectionGroup]
Script Name	newSubsection
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    setupTestSubsection

Scripts that use this script

Script Definition
Script Steps

    #
    #If node is currenlty locked then stop script,
    #and inform the user.
    Perform Script [ “stopNewRecordsBeingCreatedByLockedNode” ]
    #
    #Stop spell check script.
    Set Variable [ $$stopTest; Value:1 ]
    #
    #If there are no subsections, then create a new
    #subsection group first and then a test for that
    #group. All subsections belong to a group.
    If [ Get (FoundCount) = 0 ]
    Perform Script [ “newSubsectionGroup” ]
    Exit Script [ ]
    End If
    #
    #Set variables needed to create new subsection.
    Set Variable [ $$ID; Value:"ignore" ]
    Set Variable [ $group; Value:testSubsectionTemplate::ksubsectionGroup ]
    #
    #Copy current item's order number.
    Set Variable [ $orderNumber; Value:testSubsectionTemplate::order ]
    #
    #
    #Create new subsection.
    New Record/Request
    #( a test subsection group field is neccessary because a section
    # may have more than one test subsection group, and so trying
    # to find a test subsection group using the section key and
    # the testSubsection match field would find all groups
    # when we need the system to find one group. )
    Set Field [ testSubsectionTemplate::ksubsectionGroup; $group ]
    #
    #Set order number if any.
    Set Field [ testSubsectionTemplate::order; $orderNumber ]
    #
    #This new subsections key is placed in its test
    #item key field to create future test items
    #belonging in this subsection.
    Set Field [ testSubsectionTemplate::ktestItemGroup; testSubsectionTemplate::_LtestSubsection ]
    #
    #Subsections do not need unique names. Unlike other
    #names, the names of subsections if named the same
    #will not confuse the system. I don't think it will
    #confuse the user either, but I am including steps to
    #require a unique name so when locked by creator
    #the name can be revereted back to orignal name.
    Set Field [ testSubsectionTemplate::name; "subsection_template" & testSubsectionTemplate::_LtestSubsection ]
    Set Field [ testSubsectionTemplate::nameSpelling; "subsection_template" & testSubsectionTemplate::_LtestSubsection ]
    Set Field [ testSubsectionTemplate::kcreatorNode; TEMP::kdefaultNodePrimary ]
    #
    #
    #
    #Set temp variables for next part of script.
    #
    #The subsection's item list temp fields allow
    #users to switch from their current list to
    #another list.
    Set Field [ TEMP::ktestItemSubsection; testSubsectionTemplate::ktestItemGroup ]
    Set Field [ TEMP::ktestItemSubsectionOLD; testSubsectionTemplate::ktestItemGroup ]
    #
    #Used on tag menus to unlock buttons and link
    #new records to test.
    Set Field [ TEMP::ktestSubsection; testSubsectionTemplate::_LtestSubsection ]
    #
    #Used on Tag Menus window item layout for switch.
    Set Field [ TEMP::testSubsectionName; testSubsectionTemplate::name ]
    #
    #Used on Tag Menus window section layout for conditional
    #formatting.
    Set Variable [ $$subsectionSections; Value:testSubsectionTemplate::kcsections ]
    #
    #
    #Go to the tag menus window.
    Select Window [ Name: "Tag Menus"; Current file ]
    If [ Get (LastError) = 112 ]
    New Window [ Name: "Tag Menus"; Height: Get (ScreenHeight); Width: Get (ScreenWidth) / 2; Left: Get (ScreenWidth) / 2; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “setupTestSection” (testSection) ]
    End If
    #
    #Remember layout user is currently seeing in
    #the tag menu window, so user can be returned
    #to it at the end of the script.
    Set Variable [ $layout; Value:Get (LayoutName) ]
    #
    #Assign section to subsection as each
    #subsection must be in at least one section.
    Perform Script [ “menuTestSection” ]
    If [ Get (FoundCount) = 0 ]
    Set Variable [ $layout ]
    Go to Layout [ “setupTestSection” (testSection) ]
    New Record/Request
    Set Field [ testSection::match; "testSection" ]
    Set Field [ testSection::tag; "section_template" ]
    Set Field [ testSection::tagSpelling; "section_template" ]
    Perform Script [ “menuTestSection” ]
    End If
    Go to Record/Request/Page [ First ]
    Perform Script [ “linkOrUnlinkTestSection” ]
    #
    #Go to selected tag menu window layout.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Set Variable [ $$stopLoadTagRecord ]
    Go to Layout [ $layout ]
    #
    #Set variables for new record.
    Select Window [ Name: "Test Templates"; Current file ]
    Set Variable [ $$ID; Value:testSubsectionTemplate::_LtestSubsection ]
    #
    #Sort records.
    Scroll Window [ Home ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testSubsectionGroup::orderOrLibraryType; based on value list: “order Pulldown List” testSubsectionGroup::name; ascending testSubsectionTemplate::order; based on value list: “order Pulldown List” testSubsectionTemplate::name; ascending ] [ Restore; No dialog ]
    Go to Field [ testSubsectionTemplate::name ] [ Select/perform ]
    #
    #Start spell check script.
    Set Variable [ $$stopTest ]
    #

Fields used in this script

    testSubsectionTemplate::ksubsectionGroup
    testSubsectionTemplate::order
    testSubsectionTemplate::_LtestSubsection
    testSubsectionTemplate::ktestItemGroup
    testSubsectionTemplate::name
    testSubsectionTemplate::nameSpelling
    TEMP::kdefaultNodePrimary
    testSubsectionTemplate::kcreatorNode
    TEMP::ktestItemSubsection
    TEMP::ktestItemSubsectionOLD
    TEMP::ktestSubsection
    TEMP::testSubsectionName
    testSubsectionTemplate::kcsections
    testSection::match
    testSection::tag
    testSection::tagSpelling
    testSubsectionGroup::orderOrLibraryType
    testSubsectionGroup::name

Scripts used in this script

    stopNewRecordsBeingCreatedByLockedNode
    newSubsectionGroup
    menuTestSection
    linkOrUnlinkTestSection

Layouts used in this script

    setupTestSection
    <Missing Layout>

Tables used in this script

    TEMP
    tag
    tagGroup
    testSubsectionTemplate

Table occurrences used by this script

    TEMP
    testSection
    testSubsectionGroup
    testSubsectionTemplate

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [newSubsection]	Parent Folder: [setup]	Next Script: [newTestItem]
Script Name	newSubsectionGroup
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    setupTestSubsection

Scripts that use this script

    newSubsection

Script Definition
Script Steps

    #
    #This script is creates test subsection groups.
    #
    #
    #If node is currenlty locked then stop script,
    #and inform the user.
    Perform Script [ “stopNewRecordsBeingCreatedByLockedNode” ]
    #
    #Stop spell check script.
    Set Variable [ $$stopTest; Value:1 ]
    #
    #Copy current group's order number.
    Set Variable [ $orderNumber; Value:testSubsectionGroup::orderOrLibraryType ]
    #
    #Create new general inquiry group.
    Go to Layout [ “tableTagGroup” (testSubsectionGroup) ]
    New Record/Request
    Set Field [ testSubsectionGroup::orderOrLibraryType; $orderNumber ]
    Set Field [ testSubsectionGroup::match; "testSubsection" ]
    Set Field [ testSubsectionGroup::kRecordCreatorNode; TEMP::kdefaultNodePrimary ]
    #
    #Each group must have a unique name and
    #the nameSpelling field is used when the user
    #changes the name to a name already in use at
    #which point the nameSpelling name can revert
    #the user back to the former name (as the name
    #field contains the duplicate name which is not
    #allowed).
    Set Field [ testSubsectionGroup::name; "subsection_group" & testSubsectionGroup::_Lgroup ]
    Set Field [ testSubsectionGroup::nameSpellingEXCEPTForTestItemGroup; "subsection_group" & testSubsectionGroup::_Lgroup ]
    Set Variable [ $group; Value:testSubsectionGroup::_Lgroup ]
    #
    #Create new general inquiry for this group.
    Set Variable [ $$ID; Value:"ignore" ]
    Go to Layout [ “setupTestSubsection” (testSubsectionTemplate) ]
    New Record/Request
    Set Variable [ $loopToNewRecord; Value:testSubsectionTemplate::_LtestSubsection ]
    Set Field [ testSubsectionTemplate::ksubsectionGroup; $group ]
    #
    #A new test-item list is created with each new test.
    #This key field can be changed so that the test-item
    #list for another test can be used.
    Set Field [ testSubsectionTemplate::ktestItemGroup; testSubsectionTemplate::_LtestSubsection ]
    #
    #Tests do not need unique names. Unlike other
    #names, the names of tests if named the same
    #will not confuse the system. I don't think it will
    #confuse the user either, but I am including steps to
    #require a unique name so when locked name can
    #be revereted back to orignal name.
    Set Field [ testSubsectionTemplate::name; "subsection_template" & testSubsectionTemplate::_LtestSubsection ]
    Set Field [ testSubsectionTemplate::nameSpelling; "subsection_template" & testSubsectionTemplate::_LtestSubsection ]
    Set Field [ testSubsectionTemplate::kcreatorNode; TEMP::kdefaultNodePrimary ]
    #
    #
    #
    #Set temp variables for next part of script.
    #
    #The test item list temp fields allow users to switch
    #from their current list to another list.
    Set Field [ TEMP::ktestItemSubsection; testSubsectionTemplate::ktestItemGroup ]
    Set Field [ TEMP::ktestItemSubsectionOLD; testSubsectionTemplate::ktestItemGroup ]
    #
    #Used on tag menus to unlock buttons and link
    #new records to test.
    Set Field [ TEMP::ktestSubsection; testSubsectionTemplate::_LtestSubsection ]
    #
    #Used on Tag Menus window item layout for switch.
    Set Field [ TEMP::testSubsectionName; testSubsectionTemplate::name ]
    #
    #Used on Tag Menus window section layout for conditional
    #formatting.
    Set Variable [ $$subsectionSections; Value:testSubsectionTemplate::kcsections ]
    #
    #
    #Go to the tag menus window.
    Select Window [ Name: "Tag Menus"; Current file ]
    If [ Get (LastError) = 112 ]
    New Window [ Name: "Tag Menus"; Height: Get (ScreenHeight); Width: Get (ScreenWidth) / 2; Left: Get (ScreenWidth) / 2; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “setupTestSection” (testSection) ]
    End If
    #
    #Remember layout user is currently seeing in
    #the tag menu window, so user can be returned
    #to it at the end of the script.
    Set Variable [ $layout; Value:Get (LayoutName) ]
    #
    #Assign section to test item as each test must have
    #at least one section.
    Perform Script [ “menuTestSection” ]
    If [ Get (FoundCount) = 0 ]
    Set Variable [ $layout ]
    Go to Layout [ “setupTestSection” (testSection) ]
    New Record/Request
    Set Field [ testSection::match; "testSection" ]
    Set Field [ testSection::tag; "test-section_template" ]
    Set Field [ testSection::tagSpelling; "test-section_template" ]
    Perform Script [ “menuTestSection” ]
    End If
    Go to Record/Request/Page [ First ]
    Perform Script [ “linkOrUnlinkTestSection” ]
    #
    #Go to selected tag menu window layout.
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Set Variable [ $$stopLoadTagRecord ]
    Go to Layout [ $layout ]
    #
    #Set variables for new record.
    Select Window [ Name: "Test Templates"; Current file ]
    Set Variable [ $$ID; Value:testSubsectionTemplate::_LtestSubsection ]
    #
    #Sort records.
    Scroll Window [ Home ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testSubsectionGroup::orderOrLibraryType; based on value list: “order Pulldown List” testSubsectionGroup::name; ascending testSubsectionTemplate::order; based on value list: “order Pulldown List” testSubsectionTemplate::name; ascending ] [ Restore; No dialog ]
    Go to Field [ testSubsectionTemplate::name ] [ Select/perform ]
    #
    #Start spell check script.
    Set Variable [ $$stopTest ]
    #

Fields used in this script

    testSubsectionGroup::orderOrLibraryType
    testSubsectionGroup::match
    TEMP::kdefaultNodePrimary
    testSubsectionGroup::kRecordCreatorNode
    testSubsectionGroup::_Lgroup
    testSubsectionGroup::name
    testSubsectionGroup::nameSpellingEXCEPTForTestItemGroup
    testSubsectionTemplate::_LtestSubsection
    testSubsectionTemplate::ksubsectionGroup
    testSubsectionTemplate::ktestItemGroup
    testSubsectionTemplate::name
    testSubsectionTemplate::nameSpelling
    testSubsectionTemplate::kcreatorNode
    TEMP::ktestItemSubsection
    TEMP::ktestItemSubsectionOLD
    TEMP::ktestSubsection
    TEMP::testSubsectionName
    testSubsectionTemplate::kcsections
    testSection::match
    testSection::tag
    testSection::tagSpelling
    testSubsectionTemplate::order

Scripts used in this script

    stopNewRecordsBeingCreatedByLockedNode
    menuTestSection
    linkOrUnlinkTestSection

Layouts used in this script

    tableTagGroup
    setupTestSubsection
    setupTestSection
    <Missing Layout>

Tables used in this script

    TEMP
    tag
    tagGroup
    testSubsectionTemplate

Table occurrences used by this script

    TEMP
    testSection
    testSubsectionGroup
    testSubsectionTemplate

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [newSubsectionGroup]	Parent Folder: [setup]	Next Script: [newTestItemGroup]
Script Name	newTestItem
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    setupTestItem
    testMenuTestItemEdit
    testMenuTestItemMORE

Scripts that use this script

Script Definition
Script Steps

    #This script is for creating a test item.
    #
    #If the node that created this group is locked
    #prevent new items be created for it even by a
    #node that is not locked.
    If [ nodeLockTestTagItemGroup::orderOrLock ≠ "" ]
    Show Custom Dialog [ Message: "This group is locked. Go the node that created this group — " & nodeLockTestTagItemGroup::tag & " — in the setup tag window and enter the password to unlock it so that you can create items for it."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #If node is currenlty locked then stop script,
    #and inform the user.
    Perform Script [ “stopNewRecordsBeingCreatedByLockedNode” ]
    #
    #Stop this script if there are no subsections
    #for which to create test items.
    If [ TEMP::ktestSubsection = "" ]
    Show Custom Dialog [ Message: "All test items must belong to (be linked to) at least one test subsection. Create one now, and then you can create new test items and test-item groups for it."; Default Button: “OK”, Commit: “No” ]
    Exit Script [ ]
    End If
    #
    #If there are no test items, then create a new test
    #item group first and then a test for that group.
    #All test items belong to test item groups, not
    #tests. This allows test item groups to be added
    #to other test's test-item lists.
    If [ Get (FoundCount) = 0 ]
    Perform Script [ “newTestItemGroup” ]
    Exit Script [ ]
    End If
    #
    #Capturet he current item's type and style
    #to apply to the new item.
    Set Variable [ $checkORtextORform; Value:Case ( tagMenus::notesOrCopyright ≠ "" ; tagMenus::notesOrCopyright ; "✓" ) ]
    Set Variable [ $style; Value:tagMenus::textStyleOrCreatorNodeFlag ]
    #
    #Copy current item's style setting.
    Set Variable [ $style; Value:tagMenus::textStyleOrCreatorNodeFlag ]
    #
    #Copy current item's order number.
    Set Variable [ $orderNumber; Value:tagMenus::orderOrLock ]
    #
    #Create an item for this goup of test items.
    New Record/Request
    Set Field [ tagMenus::match; "testItem" ]
    Set Field [ tagMenus::orderOrLock; $orderNumber ]
    Set Field [ tagMenus::orderOrLock[2]; $orderNumber ]
    Set Field [ tagMenus::textStyleOrCreatorNodeFlag; $style ]
    Set Field [ tagMenus::notesOrCopyright; $checkORtextORform ]
    Set Field [ tagMenus::kGroupOrTest; GetNthRecord ( tagMenus::kGroupOrTest ; Get (RecordNumber) - 1 ) ]
    Set Field [ tagMenus::tag; "test-item" & tagMenus::_Ltag ]
    Set Field [ tagMenus::tagSpelling; "test-item" & tagMenus::_Ltag ]
    Set Field [ tagMenus::kRecordCreatorNode; TEMP::kdefaultNodePrimary ]
    Go to Field [ ]
    #
    #Apply tag style.
    If [ tagMenus::textStyleOrCreatorNodeFlag = "1" ]
    Set Field [ tagMenus::tag; Trim (tagMenus::tag) ]
    Set Field [ tagMenus::tag; TextFont ( tagMenus::tag ; "Georgia" ) ]
    Set Field [ tagMenus::tag; TextColor ( tagMenus::tag ; RGB ( 99 ; 99 ; 99 ) ) ]
    Else If [ tagMenus::textStyleOrCreatorNodeFlag = "2" ]
    Set Field [ tagMenus::tag; Trim (tagMenus::tag) ]
    Set Field [ tagMenus::tag; TextFont ( tagMenus::tag ; "Arial" ) ]
    Set Field [ tagMenus::tag; TextColorRemove ( tagMenus::tag ; RGB ( 99 ; 99 ; 99 ) ) ]
    Else If [ tagMenus::textStyleOrCreatorNodeFlag = "3" ]
    Set Field [ tagMenus::tag; Trim (tagMenus::tag) ]
    Set Field [ tagMenus::tag; TextSize ( tagMenus::tag ; 20 ) ]
    Set Field [ tagMenus::tag; TextFont ( tagMenus::tag ; "Arial" ) ]
    Set Field [ tagMenus::tag; TextStyleAdd ( tagMenus::tag ; Bold ) ]
    Set Field [ tagMenus::tag; TextColor ( tagMenus::tag ; RGB ( 99 ; 99 ; 99 ) ) ]
    End If
    Go to Field [ tagMenus::tag ] [ Select/perform ]
    #

Fields used in this script

    nodeLockTestTagItemGroup::orderOrLock
    nodeLockTestTagItemGroup::tag
    TEMP::ktestSubsection
    tagMenus::notesOrCopyright
    tagMenus::textStyleOrCreatorNodeFlag
    tagMenus::orderOrLock
    tagMenus::match
    tagMenus::kGroupOrTest
    tagMenus::_Ltag
    tagMenus::tag
    tagMenus::tagSpelling
    TEMP::kdefaultNodePrimary
    tagMenus::kRecordCreatorNode

Scripts used in this script

    stopNewRecordsBeingCreatedByLockedNode
    newTestItemGroup

Layouts used in this script

Tables used in this script

    TEMP
    tag
    tag

Table occurrences used by this script

    TEMP
    nodeLockTestTagItemGroup
    tagMenus

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [newTestItem]	Parent Folder: [setup]	Next Script: [newTestSectionTemplatePulldownCheck]
Script Name	newTestItemGroup
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    setupTestItem
    testMenuTestItemEdit
    testMenuTestItemMORE

Scripts that use this script

    newTestItem

Script Definition
Script Steps

    #
    #This script creates test item groups.
    #
    #
    #If node is currenlty locked then stop script,
    #and inform the user.
    Perform Script [ “stopNewRecordsBeingCreatedByLockedNode” ]
    #
    #If there are no general test inquires, then
    #stop this script as there are no general inquires
    # to create specific inquires for.
    If [ TEMP::ktestSubsection = "" ]
    Show Custom Dialog [ Message: "All test items must belong to (be linked to) at least one test subsection. Create one now, and then you can create new test items and test-item groups for it."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #Capturet he current item's type and style
    #to apply to the new item.
    Set Variable [ $checkORtextORform; Value:Case ( tagMenus::notesOrCopyright ≠ "" ; tagMenus::notesOrCopyright ; "✓" ) ]
    Set Variable [ $style; Value:tagMenus::textStyleOrCreatorNodeFlag ]
    #
    #Copy current group's order number.
    Set Variable [ $orderNumber; Value:tagMenuTestItemGroup::orderOrLibraryType ]
    #
    #Create new test item group record.
    Go to Layout [ “tableTagGroup” (testSubsectionGroup) ]
    New Record/Request
    #
    #
    #BEGIN !!!!!!!!!!!!!!!!!!!!!!!!!!!
    #READ CAREFULLY!!! nameSpelling field used differently!!!
    #Each test-item group must have a unique name and
    #the nameSpellingTestItemGroup field is used when the user
    #changes the name to a name already in use at
    #which point the nameSpellingTestItemGroup name can revert
    #the user back to the former name (as the name
    #field contains the duplicate name which is not
    #allowed).
    Set Field [ testSubsectionGroup::orderOrLibraryType; $orderNumber ]
    Set Field [ testSubsectionGroup::orderOrLibraryType[2]; $orderNumber ]
    Set Variable [ $group; Value:testSubsectionGroup::_Lgroup ]
    Set Field [ testSubsectionGroup::name; "test-item_group" & testSubsectionGroup::_Lgroup ]
    Set Field [ testSubsectionGroup::kRecordCreatorNode; TEMP::kdefaultNodePrimary ]
    Set Field [ testSubsectionGroup::nameSpellingFORTestItemGroup; "test-item_group" & testSubsectionGroup::_Lgroup ]
    #
    #
    Set Field [ testSubsectionGroup::match; TEMP::ktestSubsection & ¶ ]
    #
    #NEVER CHANGE!!! This is the key field for the
    #link pulldown menu. If you decide to change
    #it, you'll have to create a script to change it in
    #in older library's group records which will have
    #the spelling of the old key and thus not show
    #up any longer once the key is changed.
    Set Field [ testSubsectionGroup::nameSpellingEXCEPTForTestItemGroup; "testItemGroup" ]
    #END !!!!!!!!!!!!!!!!!!!!!!!!!!!
    #
    #Create a test item for this goup as all groups must
    #have at least one item. Item layout is sorted by
    #by group and then item and groups are only
    #shown as subheaders. So without an item
    #even if a group it existed it would not show up.
    Go to Layout [ original layout ]
    New Record/Request
    Set Field [ tagMenus::match; "testItem" ]
    Set Field [ tagMenus::notesOrCopyright; $checkORtextORform ]
    Set Field [ tagMenus::kGroupOrTest; $group ]
    Set Field [ tagMenus::tag; "test-item" & tagMenus::_Ltag ]
    Set Field [ tagMenus::textStyleOrCreatorNodeFlag; $style ]
    Set Field [ tagMenus::tagSpelling; "test-item" & tagMenus::_Ltag ]
    Set Field [ tagMenus::kRecordCreatorNode; TEMP::kdefaultNodePrimary ]
    #
    #Apply tag style.
    If [ tagMenus::textStyleOrCreatorNodeFlag = "1" ]
    Set Field [ tagMenus::tag; Trim (tagMenus::tag) ]
    Set Field [ tagMenus::tag; TextFont ( tagMenus::tag ; "Georgia" ) ]
    Set Field [ tagMenus::tag; TextColor ( tagMenus::tag ; RGB ( 99 ; 99 ; 99 ) ) ]
    Else If [ tagMenus::textStyleOrCreatorNodeFlag = "2" ]
    Set Field [ tagMenus::tag; Trim (tagMenus::tag) ]
    Set Field [ tagMenus::tag; TextFont ( tagMenus::tag ; "Arial" ) ]
    Set Field [ tagMenus::tag; TextColorRemove ( tagMenus::tag ; RGB ( 99 ; 99 ; 99 ) ) ]
    Else If [ tagMenus::textStyleOrCreatorNodeFlag = "3" ]
    Set Field [ tagMenus::tag; Trim (tagMenus::tag) ]
    Set Field [ tagMenus::tag; TextSize ( tagMenus::tag ; 20 ) ]
    Set Field [ tagMenus::tag; TextFont ( tagMenus::tag ; "Arial" ) ]
    Set Field [ tagMenus::tag; TextStyleAdd ( tagMenus::tag ; Bold ) ]
    Set Field [ tagMenus::tag; TextColor ( tagMenus::tag ; RGB ( 99 ; 99 ; 99 ) ) ]
    End If
    #
    #Must be sorted to show the group
    #for this first test item and when it's
    #out of sight.
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuTestItemGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuTestItemGroup::_Lgroup; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    Scroll Window [ Home ]
    #
    #Load up all tag variables.
    Perform Script [ “loadTagRecord” ]
    Go to Field [ tagMenus::tag ] [ Select/perform ]
    #

Fields used in this script

    TEMP::ktestSubsection
    tagMenus::notesOrCopyright
    tagMenus::textStyleOrCreatorNodeFlag
    tagMenuTestItemGroup::orderOrLibraryType
    testSubsectionGroup::orderOrLibraryType
    testSubsectionGroup::_Lgroup
    testSubsectionGroup::name
    TEMP::kdefaultNodePrimary
    testSubsectionGroup::kRecordCreatorNode
    testSubsectionGroup::nameSpellingFORTestItemGroup
    testSubsectionGroup::match
    testSubsectionGroup::nameSpellingEXCEPTForTestItemGroup
    tagMenus::match
    tagMenus::kGroupOrTest
    tagMenus::_Ltag
    tagMenus::tag
    tagMenus::tagSpelling
    tagMenus::kRecordCreatorNode
    tagMenuTestItemGroup::_Lgroup
    tagMenus::orderOrLock

Scripts used in this script

    stopNewRecordsBeingCreatedByLockedNode
    loadTagRecord

Layouts used in this script

    tableTagGroup

Tables used in this script

    TEMP
    tag
    tagGroup

Table occurrences used by this script

    TEMP
    tagMenuTestItemGroup
    tagMenus
    testSubsectionGroup

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [newTestItemGroup]	Parent Folder: [setup]	Next Script: [showSubsectionsInThisSection]
Script Name	newTestSectionTemplatePulldownCheck
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #If there are no test sections created,
    #tell the user this, and how to create some.
    If [ ValueListItems ( Get ( FileName ) ; "defaultSectionTemplates" ) = "" ]
    Show Custom Dialog [ Message: "There are no test-section templates available for creating new test sections. To create some 1) click 'back', then 2) click 'section-templatesetup' and finally 3) click 'new' to create your first test-section template. 4) Customize it to meet your needs."; Default Button: “OK”, Commit: “Yes” ]
    Go to Field [ ]
    Exit Script [ ]
    End If
    #
    #

Fields used in this script

Scripts used in this script

Layouts used in this script

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [newTestSectionTemplatePulldownCheck]	Parent Folder: [setup]
Script Name	showSubsectionsInThisSection
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    setupTestSection

Scripts that use this script

Script Definition
Script Steps

    #
    #
    Go to Field [ ]
    #Set all variables needed for performing various
    #scripts while in test setup mode.
    If [ $$setupTestSection = "" ]
    Set Variable [ $$setupTestSection; Value:testSection::_Ltag ]
    Set Variable [ $setupTestSectionName; Value:testSection::tag ]
    Go to Field [ ]
    #
    #
    Set Variable [ $$stopTest; Value:1 ]
    New Window [ Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Set Variable [ $$stopTest ]
    Go to Layout [ “tableTestSubsectionTemplates” (testSubsectionTemplate) ]
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    Enter Find Mode [ ]
    Set Field [ testSubsectionTemplate::kcsections; $$setupTestSection ]
    Perform Find [ ]
    Set Variable [ $numberInThisSection; Value:Get (FoundCount) ]
    Close Window [ Current Window ]
    #
    Refresh Window
    #
    #
    #
    If [ $numberInThisSection = 0 ]
    #
    Set Variable [ $$setupTestSection ]
    Show Custom Dialog [ Message: "There are no subsections in this test section — " & $setupTestSectionName & "."; Default Button: “OK”, Commit: “Yes” ]
    Refresh Window
    #
    Else
    Select Window [ Name: "Test Templates"; Current file ]
    Refresh Window
    If [ $numberInThisSection = 1 ]
    Show Custom Dialog [ Message: "The " & $numberInThisSection & " subsection in this test section — " & $setupTestSectionName & " — is now highlighed."; Default Button: “OK”, Commit: “Yes” ]
    Else
    Show Custom Dialog [ Message: "All " & $numberInThisSection & " subsections in this test section — " & $setupTestSectionName & " — are now highlighed."; Default Button: “OK”, Commit: “Yes” ]
    End If
    End If
    Else
    Set Variable [ $$setupTestSection ]
    Select Window [ Name: "Test Templates"; Current file ]
    Refresh Window
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    End If

Fields used in this script

    testSection::_Ltag
    testSection::tag
    testSubsectionTemplate::kcsections

Scripts used in this script

Layouts used in this script

    tableTestSubsectionTemplates

Tables used in this script

    tag
    testSubsectionTemplate

Table occurrences used by this script

    testSection
    testSubsectionTemplate

Custom Functions used by this script

Custom menu set used by this script


probablyNotInUse
	Parent Folder: [probablyNotInUse]
Script Name	moveTestItemToNewTestGroupStep1
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #This script is for moving a test item
    #to different item group.
    #
    #
    #If there is only one group, exit script.
    If [ ValueCount ( ValueListItems ( Get ( FileName ) ; "templateSubsectionGroups" ) ) = 1 ]
    Go to Field [ ]
    Exit Script [ ]
    End If
    #
    #If node is currenlty locked then stop script, inform user.
    If [ testSectionCreatorLock::orderOrLock ≠ "" ]
    Go to Field [ ]
    Show Custom Dialog [ Message: "This record is locked. Go the node that created it -- " & testSectionCreatorLock::tag & " -- in the setup tag window and enter the password to unlock it so that you can move it."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    Set Variable [ $$groupOLD; Value:testSubsectionTemplate::ksubsectionGroup ]
    Set Variable [ $$moveItem; Value:testSubsectionTemplate::_LtestSubsection ]
    Refresh Window

Fields used in this script

    testSectionCreatorLock::orderOrLock
    testSectionCreatorLock::tag
    testSubsectionTemplate::ksubsectionGroup
    testSubsectionTemplate::_LtestSubsection

Scripts used in this script

Layouts used in this script

Tables used in this script

    tag
    testSubsectionTemplate

Table occurrences used by this script

    testSectionCreatorLock
    testSubsectionTemplate

Custom Functions used by this script

Custom menu set used by this script


test
	Parent Folder: [test]	Next Script: [CHUNK_findLearnRecordsReferences]
Script Name	CHUNK_countTestResults
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #Add 1 to test results count.
    Set Variable [ $count; Value:testlearn::countOfALLSubsectionsTestResults ]
    Set Field [ testlearn::countOfALLSubsectionsTestResults; $count + 1 ]

Fields used in this script

    testlearn::countOfALLSubsectionsTestResults

Scripts used in this script

Layouts used in this script

Tables used in this script

    testlearn

Table occurrences used by this script

    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [CHUNK_countTestResults]	Parent Folder: [test]	Next Script: [deleteReportTestResult]
Script Name	CHUNK_findLearnRecordsReferences
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    learn4
    learn4EDIT
    learn4EDITLocked

Scripts that use this script

    gotoLearnQV
    loadTestInfo

Script Definition
Script Steps

    #
    #
    #Admin tasks.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #If the learn record has references then make sure
    #the Reference window is open, and then load up
    #its reference records, otherwise exit the script.
    If [ Get (LayoutTableName) = "testlearnReportTags" ]
    If [ testlearnReportTags::kcreference = "" or ValueCount ( testlearnReportTags::kcreference ) - Length ( Filter ( testlearnReportTags::kcreference ; "L" ) ) = 0 ]
    Exit Script [ ]
    End If
    Else
    If [ testlearn::kcreference = "" or ValueCount ( testlearn::kcreference ) - Length ( Filter ( testlearn::kcreference ; "L" ) ) = 0 ]
    Exit Script [ ]
    End If
    End If
    #
    #Prevent halting to loadTagRecord script.
    Go to Field [ ]
    Set Variable [ $$doNotHaltOtherScripts; Value:1 ]
    Set Variable [ $$stopWhenLoadingInfoRecordReferences; Value:1 ]
    #
    #Capture the keys of the references load.
    If [ Get (LayoutTableName) = "testlearnReportTags" ]
    Set Variable [ $references; Value:testlearnReportTags::kcreference ]
    Else
    Set Variable [ $references; Value:testlearn::kcreference ]
    End If
    #
    #Determine how many references there are.
    If [ Get (LayoutTableName) = "testlearnReportTags" ]
    Set Variable [ $numberOfReferences; Value:ValueCount ( testlearnReportTags::kcreference ) ]
    Else
    Set Variable [ $numberOfReferences; Value:ValueCount ( testlearn::kcreference ) ]
    End If
    #
    #Prevent loading up records.
    Set Variable [ $$stoploadtestinfo; Value:1 ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    #
    #In the test section, go the Reference window
    #or open one up if neccessary.
    If [ Get (LayoutTableName) = "testlearnReportTags" ]
    Select Window [ Name: "Reference"; Current file ]
    If [ Get ( LastError ) = 112 ]
    If [ $$pictureWindowColor = "test" ]
    New Window [ Name: "Reference"; Width: Get ( ScreenWidth ) / 3; Left: ( Get ( ScreenWidth ) / 3 ) * 2; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Else
    New Window [ Name: "Reference"; Width: 290; Left: Get ( ScreenWidth ) - 290; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    End If
    End If
    #
    #Go the layout for info references.
    Go to Layout [ “TestInfoReference” (reference) ]
    #
    #
    Else
    #In the learn section, go to the Tag Menus
    #window and the reference layout.
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    #See if user has selected requested menu.
    If [ Get (LayoutTableName) ≠ "reference" ]
    #
    #Menu NOT selected.
    Go to Layout [ “learnMenu3CiteS” (reference) ]
    End If
    End If
    #
    #Turn back on record load script.
    Set Variable [ $$stoploadtestinfo ]
    #
    #Find the first reference. NOTE: It may be this
    #first reference is a learn reference, and so no
    #records will be found, but this is OK. This first
    #find clears out any records that may have
    #been found previously, and replaces them with
    #the outcome of this first find, which if none is,
    #again, OK. Then next find step expands on
    #this find, so to speed things up, it will not look
    #for learn references, BUT if this step did not
    #look for learn records, the script would in
    #effect skip this first find and so leave in place
    #the records found previously. Very Bad!
    #NOTE: I've had a lot of caffeine.
    Enter Find Mode [ ]
    Set Field [ reference::_Lreference; GetValue ( $references ; $numberOfReferences ) ]
    Perform Find [ ]
    #
    #If there is more than one reference, then load
    #find them one-at-time until all have been found.
    Loop
    Set Variable [ $numberOfReferences; Value:$numberOfReferences - 1 ]
    #
    Exit Loop If [ $numberOfReferences = 0 ]
    #
    #Only find references from the Reference section.
    If [ Right ( GetValue ( $references ; $numberOfReferences ) ; 1 ) ≠ "L" ]
    Enter Find Mode [ ]
    Set Field [ reference::_Lreference; GetValue ( $references ; $numberOfReferences ) ]
    Extend Found Set [ ]
    End If
    #
    End Loop
    #
    #Sort the references by keyword (subject).
    Perform Script [ “sortRefBySubject” ]
    #
    #In the test section ...
    #Resize the Reference window along with the
    #other windows. The Test and Report sections
    #have different window size requirements.
    If [ Get (WindowName) = "Reference" ]
    If [ $$pictureWindowColor = "test" ]
    Move/Resize Window [ Name: "Test"; Current file; Width: Get ( ScreenWidth ) / 3; Left: 0 ]
    Move/Resize Window [ Name: "Tag Menus"; Current file; Width: Get ( ScreenWidth ) / 3; Left: Get ( ScreenWidth ) / 3 ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Else
    Select Window [ Name: "Tag Menus"; Current file ]
    If [ Get ( ScreenWidth ) - 884 < 334 ]
    Move/Resize Window [ Name: "Tag Menus"; Current file; Width: 334; Left: 594 ]
    Else
    Move/Resize Window [ Name: "Tag Menus"; Current file; Width: Get ( ScreenWidth ) - 884; Left: 594 ]
    End If
    End If
    #
    #Turn back on info record record's load script.
    Set Variable [ $$stopWhenLoadingInfoRecordReferences ]
    #
    #
    Else
    #In the learn section ...
    #Clear brainstorm and test tags so there conditional
    #formatting in the Learn window is removed.
    Go to Field [ ]
    Set Variable [ $$tagBrainstorm ]
    Set Variable [ $$tagtest ]
    Set Variable [ $$tagRecordID ]
    Set Variable [ $$tagEdit ]
    Set Field [ TEMP::TLBrainstormSort; "" ]
    Set Field [ TEMP::TLTestSort; "" ]
    #
    #Set citationMatch to color menu button with inUse color.
    Set Variable [ $$citationMatch; Value:"ref" ]
    #Goto correct layout.
    #
    #If no layout preference is set, then on iDevices
    #go the layout with no pictures, and to the
    #layout with pictures on desktop computers.
    If [ TEMP::layoutLtagR = "" ]
    If [ Get (SystemPlatform) = 3 ]
    Go to Layout [ “learnMenu3CiteS” (reference) ]
    Set Field [ TEMP::layoutLtagR; "more" & Get (LayoutName) ]
    Else
    Go to Layout [ “learnMenu3Cite” (reference) ]
    Set Field [ TEMP::layoutLtagR; "less" & Get (LayoutName) ]
    End If
    Else
    #
    #Go the layout the user has selected.
    Go to Layout [ Middle ( TEMP::layoutLtagR ; 5 ; 42 ) ]
    End If
    Set Variable [ $$stopLoadTagRecord ]
    Perform Script [ “loadTagRecord” ]
    End If
    #
    #

Fields used in this script

    testlearnReportTags::kcreference
    testlearn::kcreference
    reference::_Lreference
    TEMP::TLBrainstormSort
    TEMP::TLTestSort
    TEMP::layoutLtagR

Scripts used in this script

    sortRefBySubject
    loadTagRecord

Layouts used in this script

    TestInfoReference
    learnMenu3CiteS
    learnMenu3Cite
    <Missing Layout>

Tables used in this script

    TEMP
    reference
    testlearn

Table occurrences used by this script

    TEMP
    reference
    testlearn
    testlearnReportTags

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [CHUNK_findLearnRecordsReferences]	Parent Folder: [test]	Next Script: [deleteTestResult]
Script Name	deleteReportTestResult
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    reportTestResult

Scripts that use this script

Script Definition
Script Steps

    #basic administration tasks
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    #
    If [ testlearnReportTags::_Ltestlearn = "" ]
    Halt Script
    End If
    #
    #If node is currenlty locked then stop script, inform user.
    If [ ReportResultTestSubject::orderOrLock ≠ "" ]
    Show Custom Dialog [ Message: "The test subject — " & ReportResultTestSubject::tag & " — is locked, so all this node's test results are locked too. Go back to Setup to unlock it."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    If [ testlearnReportTags::kcInUseOnReportSubsection ≠ "" ]
    Show Custom Dialog [ Title: "!"; Message: testlearnReportTags::_Number & " is in use on " & testlearnReportTags::inUseNumberOfTimes & If ( testlearnReportTags::inUseNumberOfTimes = 1 ; " report and must be removed before it can be deleted." ; " reports and must be removed from all of them before it can be deleted." ); Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #make to be deleted record red and capture info for delete
    Set Variable [ $delete; Value:testlearnReportTags::_Ltestlearn ]
    Set Variable [ $record; Value:Get (RecordNumber) ]
    Set Variable [ $TempTestSection; Value:testlearnReportTags::ktestSection ]
    Set Variable [ $TempReportNumber; Value:testlearnReportTags::kreportNumber ]
    Set Variable [ $TempTestSubject; Value:testlearnReportTags::ktestSubject ]
    Go to Field [ ]
    Refresh Window
    #
    #
    If [ testlearnReportTags::ktestSubject + testlearnReportTags::kreportNumber = $$testSubject + $$reportNumber ]
    Show Custom Dialog [ Message: "Delete evidence number " & testlearnReportTags::_Number & " ?"; Default Button: “Cancel”, Commit: “Yes”; Button 2: “Delete”, Commit: “No” ]
    End If
    #
    #
    If [ Get ( LastMessageChoice ) = 2 ]
    #
    #
    #
    If [ Get ( FoundCount ) = 1 ]
    Show Custom Dialog [ Title: "!"; Message: "Deleting this last piece of evidence will delete this page of the report too, do you wish to proceed? If you wish to keep this report page then add new evidence before deleting this evidence."; Default Button: “Cancel”, Commit: “Yes”; Button 2: “Delete”, Commit: “No” ]
    If [ Get ( LastMessageChoice ) = 2 ]
    Delete Record/Request [ No dialog ]
    Else If [ Get ( LastMessageChoice ) = 1 ]
    Set Variable [ $delete ]
    Refresh Window
    Exit Script [ ]
    End If
    #If there is only one test result then delete the
    #report page to which it belongs.
    Go to Layout [ “PrintReportEdit” (report) ]
    Enter Find Mode [ ]
    Set Field [ report::ktestSubject; $TempTestSubject ]
    Set Field [ report::ktestSubsection; $$testSubsection ]
    Set Field [ report::kreportNumber; $TempReportNumber ]
    Perform Find [ ]
    Delete All Records [ No dialog ]
    Set Variable [ $delete ]
    #See if this was the only test result.
    Go to Layout [ “testSCRIPTloops” (testlearn) ]
    Enter Find Mode [ ]
    Set Field [ testlearn::ktestSection; $TempTestSection ]
    Set Field [ testlearn::kreportNumber; $TempReportNumber ]
    Perform Find [ ]
    #Unlock test IF this deleted result was
    #the only test result in this test section.
    If [ Get ( LastError ) = 401 ]
    Go to Layout [ “tableTestSectionFromTemplate” (testSectionCreatedFromATemplate) ]
    Enter Find Mode [ ]
    Set Field [ testSectionCreatedFromATemplate::_LtestSection; $TempTestSection ]
    Set Field [ testSectionCreatedFromATemplate::reportNumber; $TempReportNumber ]
    Perform Find [ ]
    Set Field [ testSectionCreatedFromATemplate::inUse; "" ]
    #refind all test section records for current library report number
    Enter Find Mode [ ]
    Set Field [ testSectionCreatedFromATemplate::ktestSubjectNode; $TempTestSubject ]
    Set Field [ testSectionCreatedFromATemplate::reportNumber; $$reportNumber ]
    Perform Find [ ]
    Go to Layout [ “testingSubsectionMenu” (testSubsectionForSubject) ]
    #Set this test as pending testing.
    If [ testSubsectionForSubject::kgtestSection = $TempTestSection ]
    Set Field [ testSubsectionForSubject::gprogressGlobal; "status: pending" ]
    End If
    End If
    #See if there are any other tests in this
    #report with results.
    Select Window [ Name: "Report"; Current file ]
    If [ ValueListItems ( Get ( FileName ) ; "reportTestSubsections" ) = "" ]
    #If none, then return to main test layout.
    Perform Script [ “returnToTestSetup” ]
    Exit Script [ ]
    Else
    #If there are results in other sections then go
    #to the first one of those sections.
    Set Variable [ $$goToFirstReportPage; Value:GetValue ( ValueListItems ( Get ( FileName ) ; "reportTestSubsections" ) ; 1 ) ]
    Perform Script [ “CHUNK_gotoTestSubsectionViaPulldown” ]
    Exit Script [ ]
    End If
    End If
    #
    #
    #
    #switch back to this layout so don't have reassign
    #fields for inspection layout. (script was written for
    #findings layout)
    Go to Layout [ “reportTestResult” (testlearnReportTags) ]
    Go to Record/Request/Page [ $record ] [ No dialog ]
    Delete Record/Request [ No dialog ]
    Go to Layout [ “testSCRIPTloops” (testlearn) ]
    #GET ID INFO as is from different location
    #Unlock Item Location
    #zero out findings for item for this contact's location
    #
    #decrease number of findings for item for this contact's location
    Go to Layout [ “testSCRIPTloops” (testlearn) ]
    Enter Find Mode [ ]
    Set Field [ testlearn::ktestSection; $TempTestSection ]
    Set Field [ testlearn::kreportNumber; $TempReportNumber ]
    Perform Find [ ]
    #Unlock Item Location
    If [ Get ( LastError ) = 401 ]
    Go to Layout [ “tableTestSectionFromTemplate” (testSectionCreatedFromATemplate) ]
    Enter Find Mode [ ]
    Set Field [ testSectionCreatedFromATemplate::_LtestSection; $TempTestSection ]
    Perform Find [ ]
    Set Field [ testSectionCreatedFromATemplate::inUse; "" ]
    Else If [ Get (LastError) ≠ 401 ]
    Go to Layout [ “testResult0” (testlearn) ]
    Enter Find Mode [ ]
    Set Field [ testlearn::ktestSubsection; $$testSubsection ]
    Set Field [ testlearn::ktestSection; $TempTestSection ]
    Set Field [ testlearn::kreportNumber; $TempReportNumber ]
    Perform Find [ ]
    Go to Record/Request/Page [ First ]
    Set Variable [ $number; Value:Get (FoundCount) ]
    Loop
    Set Field [ testlearn::countOfONESubsectionsTestResults; $number ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    End If
    Go to Layout [ “testResult0” (testlearn) ]
    Enter Find Mode [ ]
    Set Field [ testlearn::ktestSubsection; $$testSubsection ]
    Set Field [ testlearn::kreportNumber; $TempReportNumber ]
    Set Field [ testlearn::ktestSubject; $TempTestSubject ]
    Perform Find [ ]
    Set Variable [ $number; Value:Get (FoundCount) ]
    Go to Record/Request/Page [ First ]
    Loop
    Set Field [ testlearn::countOfALLSubsectionsTestResults; $number ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    End If
    Go to Layout [ “reportTestResult” (testlearnReportTags) ]
    Set Variable [ $delete ]
    Refresh Window

Fields used in this script

    testlearnReportTags::_Ltestlearn
    ReportResultTestSubject::orderOrLock
    ReportResultTestSubject::tag
    testlearnReportTags::kcInUseOnReportSubsection
    testlearnReportTags::_Number
    testlearnReportTags::inUseNumberOfTimes
    testlearnReportTags::ktestSection
    testlearnReportTags::kreportNumber
    testlearnReportTags::ktestSubject
    report::ktestSubject
    report::ktestSubsection
    report::kreportNumber
    testlearn::ktestSection
    testlearn::kreportNumber
    testSectionCreatedFromATemplate::_LtestSection
    testSectionCreatedFromATemplate::reportNumber
    testSectionCreatedFromATemplate::inUse
    testSectionCreatedFromATemplate::ktestSubjectNode
    testSubsectionForSubject::kgtestSection
    testSubsectionForSubject::gprogressGlobal
    testlearn::ktestSubsection
    testlearn::countOfONESubsectionsTestResults
    testlearn::ktestSubject
    testlearn::countOfALLSubsectionsTestResults

Scripts used in this script

    returnToTestSetup
    CHUNK_gotoTestSubsectionViaPulldown

Layouts used in this script

    PrintReportEdit
    testSCRIPTloops
    tableTestSectionFromTemplate
    testingSubsectionMenu
    reportTestResult
    testResult0

Tables used in this script

    report
    tag
    testSectionCreatedFromATemplate
    testSubsectionTemplate
    testlearn

Table occurrences used by this script

    ReportResultTestSubject
    report
    testSectionCreatedFromATemplate
    testSubsectionForSubject
    testlearn
    testlearnReportTags

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [deleteReportTestResult]	Parent Folder: [test]	Next Script: [done]
Script Name	deleteTestResult
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    testResult0
    testResult1
    testResult2
    testResult3
    testResult4
    testResult5

Scripts that use this script

Script Definition
Script Steps

    #
    If [ testlearn::_Ltestlearn = "" ]
    Halt Script
    End If
    #
    #If node is currenlty locked then stop script, inform user.
    If [ tagTLTestSubject::orderOrLock ≠ "" ]
    Show Custom Dialog [ Message: "The test subject — " & tagTLTestSubject::tag & " — is locked, so all this node's test results are locked too. Go back to Setup to unlock it."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #Prevent test results in use on report from
    #being deleted. Tell users how to remove
    #them from the report.
    If [ testlearn::kcInUseOnReportSubsection ≠ "" ]
    Show Custom Dialog [ Message: "Remove from report " & testlearn::kreportNumber & " to delete. 1) Go back to the main test window. 2) Click the 'report' button. In the Report window, 3) click the 'switchtest' button. 4) Select this section. 5) Scroll down to find and click the 'x' button next to result " & testlearn::_Number & "."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    Set Variable [ $delete; Value:testlearn::_Ltestlearn ]
    Set Variable [ $record; Value:Get (RecordNumber) ]
    Set Variable [ $TempTestSection; Value:testlearn::ktestSection ]
    Set Variable [ $TempReportNumber; Value:testlearn::kreportNumber ]
    Set Variable [ $TempTestSubject; Value:testlearn::ktestSubject ]
    Go to Field [ ]
    Refresh Window
    #
    #Tell user what section they are about to delete
    #result from, and give them the opportunity to
    #cancel the delete.
    If [ testlearn::ktestSection = $$testSection ]
    Show Custom Dialog [ Message: "Delete this section's number " & testlearn::recordnumberglobal & " test result?"; Default Button: “Cancel”, Commit: “Yes”; Button 2: “Delete”, Commit: “No” ]
    Else
    Show Custom Dialog [ Message: "Delete another section's (" & testSectionTemplateName::name & ") number " & testlearn::recordnumberglobal & " test result?"; Default Button: “Cancel”, Commit: “Yes”; Button 2: “Delete”, Commit: “No” ]
    End If
    #
    #If users cancels the delete then reset the window.
    If [ Get ( LastMessageChoice ) = 1 ]
    Set Variable [ $delete ]
    Refresh Window
    Exit Script [ ]
    End If
    #
    #If the result has test items checked off its list,
    #then inform the user of this and see if they
    #really want to delete it.
    If [ ValueCount ( testlearn::kctestResultCheckedItems ) ≠ 0 ]
    Set Variable [ $testItemsCheckedOffTheList; Value:ValueCount ( testlearn::kctestResultCheckedItems ) ]
    Select Window [ Name: "Tag Menus"; Current file ]
    If [ $testItemsCheckedOffTheList = 1 ]
    Show Custom Dialog [ Message: "Just to be sure, so far " & $testItemsCheckedOffTheList & " checklist item has been checked off this test result's list. Continue deleting it?"; Default Button: “Cancel”, Commit: “Yes”; Button 2: “Delete”, Commit: “No” ]
    Else
    Show Custom Dialog [ Message: "Just to be sure, so far " & $testItemsCheckedOffTheList & " checklist items have been checked off this test result's list. Continue deleting it?"; Default Button: “Cancel”, Commit: “Yes”; Button 2: “Delete”, Commit: “No” ]
    End If
    Select Window [ Name: "Test"; Current file ]
    End If
    #
    #Delete record if user clicks 'delete'.
    If [ Get ( LastMessageChoice ) = 2 ]
    Set Variable [ $$stopLoadTestRecord; Value:1 ]
    Go to Record/Request/Page [ Last ]
    #
    #If last test result, then delete report page for it.
    If [ Get (RecordNumber) = 1 ]
    Delete Record/Request [ No dialog ]
    Go to Layout [ “PrintReportEdit” (report) ]
    #
    Enter Find Mode [ ]
    Set Field [ report::ktestSubject; $TempTestSubject ]
    Set Field [ report::ktestSubsection; $$testSubsection ]
    Set Field [ report::kreportNumber; $TempReportNumber ]
    Perform Find [ ]
    Delete All Records [ No dialog ]
    Set Variable [ $delete ]
    #
    #Mark the template as no longer in use.
    #First, see if there are any N/A, or OK records.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    Go to Layout [ “testSCRIPTloops” (testlearn) ]
    Enter Find Mode [ ]
    Set Field [ testlearn::ktestSection; $TempTestSection ]
    Set Field [ testlearn::kreportNumber; $TempReportNumber ]
    Perform Find [ ]
    #
    #If there are no records at all mark in use "".
    If [ Get ( LastError ) = 401 ]
    Go to Layout [ “tableTestSectionFromTemplate” (testSectionCreatedFromATemplate) ]
    Enter Find Mode [ ]
    Set Field [ testSectionCreatedFromATemplate::_LtestSection; $TempTestSection ]
    Set Field [ testSectionCreatedFromATemplate::reportNumber; $TempReportNumber ]
    Perform Find [ ]
    Set Field [ testSectionCreatedFromATemplate::inUse; "" ]
    #
    #Refind all template records with this report number.
    Enter Find Mode [ ]
    Set Field [ testSectionCreatedFromATemplate::ktestSubjectNode; $TempTestSubject ]
    Set Field [ testSectionCreatedFromATemplate::reportNumber; $$reportNumber ]
    Perform Find [ ]
    Go to Layout [ “testingSubsectionMenu” (testSubsectionForSubject) ]
    #
    #Because no test results where found mark the
    #status as pending.
    If [ testSubsectionForSubject::kgtestSection = $TempTestSection ]
    Set Field [ testSubsectionForSubject::gprogressGlobal; "status: pending" ]
    End If
    End If
    #
    #
    #
    #
    #Decrease number of results for this test on
    #ALL test templates for subject's test number x.
    Go to Layout [ “testSCRIPTloops” (testlearn) ]
    Set Error Capture [ On ]
    Enter Find Mode [ ]
    Set Field [ testlearn::ktestSubsection; $$testSubsection ]
    Set Field [ testlearn::ktestSubject; $$testSubject ]
    Set Field [ testlearn::kreportNumber; $$reportNumber ]
    #
    #This find range will insure only records with numbers
    #will be found (no NA or OK records).
    Set Field [ testlearn::countOfONESubsectionsTestResults; "0...99999999999999" ]
    Perform Find [ ]
    Set Variable [ $number; Value:Get (FoundCount) ]
    #
    #Now find all the subject's report section records
    #including NA and OK records and update total
    #results amount.
    Enter Find Mode [ ]
    Set Field [ testlearn::ktestSubsection; $$testSubsection ]
    Set Field [ testlearn::ktestSubject; $$testSubject ]
    Set Field [ testlearn::kreportNumber; $$reportNumber ]
    Go to Record/Request/Page [ First ]
    Perform Find [ ]
    Loop
    Set Field [ testlearn::countOfALLSubsectionsTestResults; $number ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    Go to Layout [ “testResult0” (testlearn) ]
    #
    Go to Layout [ “testingSubsectionMenu” (testSubsectionForSubject) ]
    Set Field [ testSubsectionForSubject::gtestSectionNameGlobal; $$testSectionName ]
    #
    #Change the Tag Menus window to the
    #blank layout and return to Test window.
    Select Window [ Name: "Tag Menus"; Current file ]
    Go to Layout [ “testMenuNoTag” (TEMP) ]
    Select Window [ Name: "Test"; Current file ]
    Exit Script [ ]
    End If
    #
    #If there is more than one record then just
    #delete this one.
    Go to Record/Request/Page [ $record ] [ No dialog ]
    Delete Record/Request [ No dialog ]
    #
    #Decrease number of test results shown.
    Set Field [ testlearn::recordnumberglobal; Get (RecordNumber) ]
    Set Field [ testlearn::recordcountglobal; Get (FoundCount) ]
    #
    #Decrease number of results for this test on this
    #ONE test template for this test subject.
    Set Error Capture [ On ]
    Go to Layout [ “testSCRIPTloops” (testlearn) ]
    Enter Find Mode [ ]
    Set Field [ testlearn::ktestSubsection; $$testSubsection ]
    Set Field [ testlearn::ktestSubject; $$testSubject ]
    Set Field [ testlearn::ktestSection; $$testSection ]
    Perform Find [ ]
    Go to Record/Request/Page [ First ]
    Set Variable [ $number; Value:Get (FoundCount) ]
    Loop
    Set Field [ testlearn::countOfONESubsectionsTestResults; $number ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #
    #Decrease number of results for this test on
    #ALL test templates for subject's test number x.
    Go to Layout [ “testSCRIPTloops” (testlearn) ]
    Set Error Capture [ On ]
    Enter Find Mode [ ]
    Set Field [ testlearn::ktestSubsection; $$testSubsection ]
    Set Field [ testlearn::ktestSubject; $$testSubject ]
    Set Field [ testlearn::kreportNumber; $$reportNumber ]
    #
    #This find range will insure only records with numbers
    #will be found (no NA or OK records).
    Set Field [ testlearn::countOfONESubsectionsTestResults; "0...99999999999999" ]
    Perform Find [ ]
    Set Variable [ $number; Value:Get (FoundCount) ]
    #
    #Now find all the subject's report records
    #including NA and OK records and update total
    #results amount.
    Enter Find Mode [ ]
    Set Field [ testlearn::ktestSubsection; $$testSubsection ]
    Set Field [ testlearn::ktestSubject; $$testSubject ]
    Set Field [ testlearn::kreportNumber; $$reportNumber ]
    Go to Record/Request/Page [ First ]
    Perform Find [ ]
    Loop
    Set Field [ testlearn::countOfALLSubsectionsTestResults; $number ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    Go to Layout [ "testResult" & Right ( TEMP::layoutTmain ; 1) ]
    #
    #Go to the record showing after delete and load
    #its set of variables.
    Go to Record/Request/Page [ testlearn::recordnumberglobal ] [ No dialog ]
    Set Variable [ $$stopLoadTestRecord ]
    Perform Script [ “loadTestResultRecord” ]
    #
    Exit Script [ ]
    End If
    #
    #If users cancels the delete then reset the window.
    Set Variable [ $delete ]
    Refresh Window
    #

Fields used in this script

    testlearn::_Ltestlearn
    tagTLTestSubject::orderOrLock
    tagTLTestSubject::tag
    testlearn::kcInUseOnReportSubsection
    testlearn::kreportNumber
    testlearn::_Number
    testlearn::ktestSection
    testlearn::ktestSubject
    testlearn::recordnumberglobal
    testSectionTemplateName::name
    testlearn::kctestResultCheckedItems
    report::ktestSubject
    report::ktestSubsection
    report::kreportNumber
    testSectionCreatedFromATemplate::_LtestSection
    testSectionCreatedFromATemplate::reportNumber
    testSectionCreatedFromATemplate::inUse
    testSectionCreatedFromATemplate::ktestSubjectNode
    testSubsectionForSubject::kgtestSection
    testSubsectionForSubject::gprogressGlobal
    testlearn::ktestSubsection
    testlearn::countOfONESubsectionsTestResults
    testlearn::countOfALLSubsectionsTestResults
    testSubsectionForSubject::gtestSectionNameGlobal
    testlearn::recordcountglobal
    TEMP::layoutTmain

Scripts used in this script

    loadTestResultRecord

Layouts used in this script

    PrintReportEdit
    testSCRIPTloops
    tableTestSectionFromTemplate
    testingSubsectionMenu
    testResult0
    testMenuNoTag
    <Missing Layout>

Tables used in this script

    TEMP
    report
    tag
    testSectionCreatedFromATemplate
    testSectionCreatedFromATemplate
    testSubsectionTemplate
    testlearn

Table occurrences used by this script

    TEMP
    report
    tagTLTestSubject
    testSectionCreatedFromATemplate
    testSectionTemplateName
    testSubsectionForSubject
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [deleteTestResult]	Parent Folder: [test]	Next Script: [exitAndOrderTestResults]
Script Name	done
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    testingSubsectionMenu

Scripts that use this script

Script Definition
Script Steps

    #basic administration tasks
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Freeze Window
    Go to Layout [ “testSCRIPTloops” (testlearn) ]
    Enter Find Mode [ ]
    Set Field [ testlearn::ktestSubject; $$testSubject ]
    Set Field [ testlearn::ktestSection; $$testSection ]
    Set Field [ testSubsectionForSubject::kcsections; $$testSectionTemplate ]
    Perform Find [ ]
    If [ Get ( LastError ) = 401 ]
    Go to Layout [ “testingSubsectionMenu” (testSubsectionForSubject) ]
    Exit Script [ ]
    End If
    Go to Layout [ “tableTestSectionFromTemplate” (testSectionCreatedFromATemplate) ]
    Enter Find Mode [ ]
    Set Field [ testSectionCreatedFromATemplate::_LtestSection; $$testSection ]
    Perform Find [ ]
    If [ testSectionCreatedFromATemplate::inUse = "t" ]
    Set Field [ testSectionCreatedFromATemplate::inUse; "d" ]
    Go to Layout [ “testingSubsectionMenu” (testSubsectionForSubject) ]
    Set Field [ testSubsectionForSubject::gprogressGlobal; "status: done" ]
    Exit Script [ ]
    End If
    Set Field [ testSectionCreatedFromATemplate::inUse; "t" ]
    Go to Layout [ “testingSubsectionMenu” (testSubsectionForSubject) ]
    Set Field [ testSubsectionForSubject::gprogressGlobal; "status: in progress" ]

Fields used in this script

    testlearn::ktestSubject
    testlearn::ktestSection
    testSubsectionForSubject::kcsections
    testSectionCreatedFromATemplate::_LtestSection
    testSectionCreatedFromATemplate::inUse
    testSubsectionForSubject::gprogressGlobal

Scripts used in this script

Layouts used in this script

    testSCRIPTloops
    testingSubsectionMenu
    tableTestSectionFromTemplate

Tables used in this script

    testSectionCreatedFromATemplate
    testSubsectionTemplate
    testlearn

Table occurrences used by this script

    testSectionCreatedFromATemplate
    testSubsectionForSubject
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [done]	Parent Folder: [test]	Next Script: [gotoTestResults]
Script Name	exitAndOrderTestResults
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    Go to Field [ ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearnReportTags::orderTestResult; based on value list: “order Pulldown List” testlearnReportTags::subsectionCustomName; ascending testlearnReportTags::timestamp; ascending testlearnReportTags::_Ltestlearn; ascending ] [ Restore; No dialog ]

Fields used in this script

    testlearnReportTags::orderTestResult
    testlearnReportTags::subsectionCustomName
    testlearnReportTags::timestamp
    testlearnReportTags::_Ltestlearn

Scripts used in this script

Layouts used in this script

Tables used in this script

    testlearn

Table occurrences used by this script

    testlearnReportTags

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [exitAndOrderTestResults]	Parent Folder: [test]	Next Script: [gotoTestSubsections]
Script Name	gotoTestResults
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    testingSubsectionMenu

Scripts that use this script

Script Definition
Script Steps

    #
    If [ $$stopLoadingTestSubSection = 1 ]
    Set Variable [ $$stopLoadingTestSubSection ]
    Exit Script [ ]
    End If
    #
    #Do not allow a test that has no results to be
    #started if its test subject is locked.
    If [ testSubsectionTestSubjectLock::orderOrLock = "0" and testResultsReportSection::countOfALLSubsectionsTestResults = "" ]
    Show Custom Dialog [ Message: "The test subject — " & $$testSubjectIsLocked & " — is locked. To unlock, A) go back to the setup node tag menu. B) Select this test subject. C) Click 'lock' and enter the password."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #
    #Set both a variable and temp field with item ID
    #or Lock number. Eventually need to pick one
    #or the other, but due to current deadline that
    #cleanup will have to come later.
    Set Variable [ $$testSubsection; Value:testSubsectionForSubject::_LtestSubsection ]
    Set Field [ TEMP::ktestSubsection; testSubsectionForSubject::_LtestSubsection ]
    #
    #Set initial test item list to check so when user clicks
    #on the button next to an item it turns green instead
    #inserting its text into the test discovery's text box.
    Set Field [ TEMP::textORcheck; "check" ]
    #
    #Set detail temp fields for use on Tag Menus window.
    Set Field [ TEMP::ktestItemSubsection; testSubsectionForSubject::ktestItemGroup ]
    Set Field [ TEMP::ktestItemSubsectionOLD; testSubsectionForSubject::ktestItemGroup ]
    #
    #Set subsection lock variable to prevent user
    #from going to edit subsection template
    #section, and set hide test edit/new button field
    #which results in hiding that button, since it
    #cannot be used when locked.
    If [ testSubsectionGroupNodeLock2::orderOrLock ≠ "" ]
    Set Variable [ $$testSubsectionIsLocked; Value:testSubsectionGroupNodeLock2::tag ]
    Set Field [ TEMP::testItemMenuShowTheWordLock; "Lock" ]
    Else If [ testSubsectionGroupNodeLock2::orderOrLock = "" ]
    Set Variable [ $$testSubsectionIsLocked ]
    Set Field [ TEMP::testItemMenuShowTheWordLock; "" ]
    End If
    #
    #Prevent test records from loading to speed up
    #this script.
    Set Variable [ $$stopLoadTestRecord; Value:1 ]
    #
    #This field does show up elsewhere but I am not
    #sure after what it does. My bad for not making
    #thorough comments during earlier developement.
    Set Field [ testSubsectionForSubject::gtestSectionNameGlobal; TextStyleAdd ( TEMP::testSubsectionNameForSubject ; Lowercase ) ]
    #
    #Find and show all test records.
    If [ TEMP::layoutTmain = "" ]
    Set Field [ TEMP::layoutTmain; "moretestResult0" ]
    End If
    #
    #If the test subject or the primary node is
    #locked go the locked layout.
    If [ testSubsectionTestSubjectLock::orderOrLock = "0" or TEMP::primaryNodeIsLocked ≠ "" // or //TEMP::primaryNodesCreatorNodeIsLocked ≠ "" ]
    Go to Layout [ "testResultLOCKED" & Right ( TEMP::layoutTmain ; 1) ]
    Else
    Go to Layout [ "testResult" & Right ( TEMP::layoutTmain ; 1) ]
    End If
    #
    #Prevent error messages when no records
    #are found.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Enter Find Mode [ ]
    #
    #See if there are any informational
    #(Learn module) records tagged
    #to this test subsection.
    Set Field [ testlearn::kctestSubsectionInfo; "###" & $$testSubsection ]
    Perform Find [ ]
    #
    #If there are information records, then set this
    #variable below to inform the user of this fact
    #by highlighting the info button on the
    #Test Menus layout.
    If [ Get (FoundCount) ≠ 0 ]
    Set Variable [ $$thereIsInfoForThisSubsection; Value:1 ]
    Else
    Set Variable [ $$thereIsInfoForThisSubsection ]
    End If
    #
    #Now find all test results for this test in all
    #subsections using this subsection template.
    Enter Find Mode [ ]
    Set Field [ testlearn::ktestSubject; $$testSubject ]
    Set Field [ testlearn::ktestSubsection; $$testSubsection ]
    Set Field [ testlearn::kreportNumber; $$reportNumber ]
    #
    #This find range will insure only records with numbers
    #will be found (no NA or OK records).
    Set Field [ testlearn::countOfONESubsectionsTestResults; "0...99999999999999" ]
    Perform Find [ ]
    #
    #Create new test record if there are none.
    If [ Get (FoundCount) = 0 ]
    #If node is currenlty locked then stop script,
    #and inform the user.
    Perform Script [ “stopNewRecordsBeingCreatedByLockedNode” ]
    Perform Script [ “newTestResult” ]
    #
    #Find all test items for this test result.
    Select Window [ Name: "Tag Menus"; Current file ]
    Perform Script [ “menuTestItem” ]
    #
    #Return to Test window.
    Select Window [ Name: "Test"; Current file ]
    Exit Script [ ]
    End If
    #
    #Group records by test subject location.
    Go to Record/Request/Page [ Last ]
    Loop
    If [ testlearn::countOfONESubsectionsTestResults = "N/A" or testlearn::countOfONESubsectionsTestResults = "OK" or testlearn::countOfONESubsectionsTestResults = "★" ]
    Omit Record
    End If
    Go to Record/Request/Page [ Previous; Exit after last ]
    End Loop
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::subsectionCustomName; ascending testlearn::_Number; ascending ] [ Restore; No dialog ]
    #
    #Now go the last test record for this test location
    #if any. It will be conditionally formatted green,
    #while other location records will be yellow and
    #records from other tests for this item will be blue.
    #Blue records indicate a favorite record.
    Go to Record/Request/Page [ Last ]
    Loop
    Exit Loop If [ testlearn::ktestSection = $$testSection ]
    Go to Record/Request/Page [ Previous; Exit after last ]
    End Loop
    #
    #Set the numbers for the navigation arrows
    #at the top of the screen: record # / total #.
    Set Field [ testlearn::recordnumberglobal; Get (RecordNumber) ]
    Set Field [ testlearn::recordcountglobal; Get (FoundCount) ]
    #
    #Conditionally format current test record and tags.
    Set Variable [ $$stopLoadTestRecord ]
    Perform Script [ “loadTestResultRecord” ]
    Set Variable [ $$loadTestItemRecord; Value:testlearn::kctestResultCheckedItems ]
    #
    #Find all test items for this test result.
    Select Window [ Name: "Tag Menus"; Current file ]
    Perform Script [ “menuTestItem” ]
    #
    #Return to Test window.
    Select Window [ Name: "Test"; Current file ]
    #

Fields used in this script

    testSubsectionTestSubjectLock::orderOrLock
    testResultsReportSection::countOfALLSubsectionsTestResults
    testSubsectionForSubject::_LtestSubsection
    TEMP::ktestSubsection
    TEMP::textORcheck
    testSubsectionForSubject::ktestItemGroup
    TEMP::ktestItemSubsection
    TEMP::ktestItemSubsectionOLD
    testSubsectionGroupNodeLock2::orderOrLock
    testSubsectionGroupNodeLock2::tag
    TEMP::testItemMenuShowTheWordLock
    TEMP::testSubsectionNameForSubject
    testSubsectionForSubject::gtestSectionNameGlobal
    TEMP::layoutTmain
    TEMP::primaryNodeIsLocked
    testlearn::kctestSubsectionInfo
    testlearn::ktestSubject
    testlearn::ktestSubsection
    testlearn::kreportNumber
    testlearn::countOfONESubsectionsTestResults
    testlearn::subsectionCustomName
    testlearn::_Number
    testlearn::ktestSection
    testlearn::recordnumberglobal
    testlearn::recordcountglobal
    testlearn::kctestResultCheckedItems

Scripts used in this script

    stopNewRecordsBeingCreatedByLockedNode
    newTestResult
    menuTestItem
    loadTestResultRecord

Layouts used in this script

Tables used in this script

    TEMP
    tag
    testSubsectionTemplate
    testlearn
    testlearn

Table occurrences used by this script

    TEMP
    testResultsReportSection
    testSubsectionForSubject
    testSubsectionGroupNodeLock2
    testSubsectionTestSubjectLock
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [gotoTestResults]	Parent Folder: [test]	Next Script: [identifyTestsThatHaveResults]
Script Name	gotoTestSubsections
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    defaultTest

Scripts that use this script

Script Definition
Script Steps

    #
    #If there is no report number or test subject
    #name, halt the script.
    If [ TEMP::reportNumber = "" ]
    Go to Field [ TEMP::reportNumber ] [ Select/perform ]
    Halt Script
    Else If [ testSectionCreatedFromATemplate::name = "" ]
    Halt Script
    End If
    #
    #basic administration tasks
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Set Variable [ $$TSRecordNumber; Value:Get (RecordNumber) ]
    Go to Field [ ]
    #
    #This variable stops the info button's script in
    #the Test and Report sections from opening a
    #Reference window, which is useful in idea
    #libraries to show references of ideas. In a
    #things library, reference records are used as
    #location records and each learn record can
    #have only one location, so showing a Reference
    #window in an inventory library would not be useful.
    If [ TEMP::InventoryLibraryYN ≠ "" ]
    Set Variable [ $$doNotOpenReferenceWindow; Value:1 ]
    Else
    Set Variable [ $$doNotOpenReferenceWindow ]
    End If
    #
    #If test subject is locked, note this by getting
    #the name for display in warning messages.
    If [ testSubjectName::orderOrLock ≠ "" ]
    Set Variable [ $$testSubjectIsLocked; Value:testSubjectName::tag ]
    Set Field [ tempSetup::testSubjectNodeIsLocked; 1 ]
    Else
    Set Variable [ $$testSubjectIsLocked ]
    Set Field [ tempSetup::testSubjectNodeIsLocked; "" ]
    End If
    #
    #Change the default to the selected subject.
    Set Field [ TEMP::kdefaultNodeTestSubject; testSectionCreatedFromATemplate::ktestSubjectNode ]
    Set Field [ TEMP::DEFAULTNodeTestSubjectName; testSubjectName::tag ]
    Set Variable [ $status; Value:testSectionCreatedFromATemplate::inUse ]
    Set Variable [ $$timeRecord; Value:Get ( RecordNumber ) ]
    Set Variable [ $$pictureWIndowColor; Value:"test" ]
    #
    #!!!need to go through database and remove all variables like $$reportnumber that are used in mulitple scripts and make it a temp field.
    Set Variable [ $$reportnumber; Value:testSectionCreatedFromATemplate::reportNumber ]
    Set Field [ TEMP::reportNumber; testSectionCreatedFromATemplate::reportNumber ]
    Set Variable [ $$testSubject; Value:TEMP::kdefaultNodeTestSubject ]
    #
    #note general or canned location user identified
    Set Variable [ $$testSectionName; Value: TextStyleAdd ( testSectionCreatedFromATemplate::name ; Titlecase ) ]
    Set Field [ TEMP::testSubsectionNameForSubject; TextStyleAdd ( $$testSectionName ; Titlecase ) ]
    #
    #note new location ID number and name user created for this specific location in the contact's building
    Set Variable [ $$testSection; Value:testSectionCreatedFromATemplate::_LtestSection ]
    Set Variable [ $$testSectionTemplate; Value:testSectionCreatedFromATemplate::ksectionTemplate ]
    #
    #Goto no tag layout in Tag Menus as the test
    #selection screen does not show any records
    #that the user might want to tag.
    #
    #I thought about closing the Tag Menus
    #window, but in testing it was odd, and so better
    #just to keep the window open and show no tags
    #but do change its layout to the look and feel
    #of the layouts the user will see in test mode
    #in the Tag Menus window.
    Select Window [ Name: "Tag Menus"; Current file ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Go to Layout [ “testMenuNoTag” (TEMP) ]
    Set Variable [ $$stopLoadTagRecord ]
    #
    #Return to main window to complete script.
    Select Window [ Name: "Setup"; Current file ]
    Set Field [ TEMP::testAndReportMainWindowHeader; tempSetup::userLibraryName & " | " & TEMP::DEFAULTNodeTestSubjectName ]
    Set Window Title [ Current Window; New Title: "Test" ]
    Go to Layout [ “testingSubsectionMenu” (testSubsectionForSubject) ]
    Enter Find Mode [ ]
    #
    #Now find and show all canned inspection
    #test-subsections that are part of this test section.
    Set Field [ testSubsectionForSubject::kcsections; $$testSectionTemplate ]
    Perform Find [ ]
    If [ Get ( FoundCount ) = 0 ]
    Go to Layout [ “defaultTest” (testSectionCreatedFromATemplate) ]
    Perform Script [ “returnToTestSetup” ]
    Show Custom Dialog [ Message: "This test section has no subsections to test. To add some, 1) click 'edit/newtemplate'. 2) Select a subsection. 3) In the Tag Menus window, click the button next to this test section to add it. Repeat 2 and 3 to add additional subsections."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    Sort Records [ Keep records in sorted order; Specified Sort Order: testSubsectionGroupForSubject::orderOrLibraryType; based on value list: “order Pulldown List” testSubsectionGroupForSubject::name; ascending testSubsectionForSubject::order; based on value list: “order Pulldown List” testSubsectionForSubject::name; ascending ] [ Restore; No dialog ]
    Go to Record/Request/Page [ First ]
    Set Variable [ $$stopLoadingTestSubSection ]
    Set Field [ testSubsectionForSubject::gtestSectionNameGlobal; $$testSectionName ]
    Set Field [ testSubsectionForSubject::kgtestSection; $$testSection ]
    Set Field [ testSubsectionForSubject::gtestSubjectNameGlobal; $$testsubjectName ]
    Set Field [ testSubsectionForSubject::kgreportNumber; $$reportNumber ]
    Set Field [ testSubsectionForSubject::kgtestSubject; TEMP::kdefaultNodeTestSubject ]
    If [ $status = "" ]
    Set Field [ testSubsectionForSubject::gprogressGlobal; "status: pending" ]
    Scroll Window [ Home ]
    Exit Script [ ]
    Else If [ $status = "t" ]
    Set Field [ testSubsectionForSubject::gprogressGlobal; "status: in progress" ]
    Scroll Window [ Home ]
    Exit Script [ ]
    End If
    Set Field [ testSubsectionForSubject::gprogressGlobal; "status: done" ]
    Scroll Window [ Home ]

Fields used in this script

    TEMP::reportNumber
    testSectionCreatedFromATemplate::name
    TEMP::InventoryLibraryYN
    testSubjectName::orderOrLock
    testSubjectName::tag
    tempSetup::testSubjectNodeIsLocked
    testSectionCreatedFromATemplate::ktestSubjectNode
    TEMP::kdefaultNodeTestSubject
    TEMP::DEFAULTNodeTestSubjectName
    testSectionCreatedFromATemplate::inUse
    testSectionCreatedFromATemplate::reportNumber
    TEMP::testSubsectionNameForSubject
    testSectionCreatedFromATemplate::_LtestSection
    testSectionCreatedFromATemplate::ksectionTemplate
    tempSetup::userLibraryName
    TEMP::testAndReportMainWindowHeader
    testSubsectionForSubject::kcsections
    testSubsectionGroupForSubject::orderOrLibraryType
    testSubsectionGroupForSubject::name
    testSubsectionForSubject::order
    testSubsectionForSubject::name
    testSubsectionForSubject::gtestSectionNameGlobal
    testSubsectionForSubject::kgtestSection
    testSubsectionForSubject::gtestSubjectNameGlobal
    testSubsectionForSubject::kgreportNumber
    testSubsectionForSubject::kgtestSubject
    testSubsectionForSubject::gprogressGlobal

Scripts used in this script

    returnToTestSetup

Layouts used in this script

    testMenuNoTag
    testingSubsectionMenu
    defaultTest

Tables used in this script

    TEMP
    TEMP
    tag
    tagGroup
    testSectionCreatedFromATemplate
    testSubsectionTemplate

Table occurrences used by this script

    TEMP
    tempSetup
    testSectionCreatedFromATemplate
    testSubjectName
    testSubsectionForSubject
    testSubsectionGroupForSubject

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [gotoTestSubsections]	Parent Folder: [test]	Next Script: [informUserHowToEditLockedLayoutText]
Script Name	identifyTestsThatHaveResults
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    testingSubsectionMenu

Scripts that use this script

Script Definition
Script Steps

    #
    #Stop script if user just navigated/clicked
    #to this record.
    If [ $$stopLoadingTestSubSection = 1 ]
    Set Variable [ $$stopLoadingTestSubSection ]
    Exit Script [ ]
    End If
    #
    #If there are no test results, exit this script.
    If [ testResultsReportSection::countOfALLSubsectionsTestResults = "" ]
    Exit Script [ ]
    End If
    #
    #Set variables to conditionally format record to
    #to be deleted and to supply name for warning
    #messages, and to speed up script.
    Set Variable [ $delete; Value:testSubsectionForSubject::_LtestSubsection ]
    Refresh Window
    Set Variable [ $$tagTest; Value:testSubsectionForSubject::_LtestSubsection ]
    Set Variable [ $$ID; Value:"ignore" ]
    Set Variable [ $subSection; Value:testSubsectionForSubject::name ]
    Go to Field [ ]
    Set Variable [ $$stopLoadTestResultRecord; Value:1 ]
    Set Variable [ $$stopLoadTestRecord; Value:1 ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Set Variable [ $$stopDeleteTest; Value:1 ]
    Set Variable [ $$stopTest; Value:1 ]
    #
    #Find all test results for every instance of this
    #subsection used by this test.
    New Window [ Name: " "; Height: 1; Width: 1; Top: -10000; Left: -10000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    // New Window [ Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    #
    #Insure current test subsection has correct
    #number of results.
    Go to Layout [ “testSCRIPTloops” (testlearn) ]
    Enter Find Mode [ ]
    Set Field [ testlearn::ktestSubsection; $$testSubsection ]
    Set Field [ testlearn::ktestSubject; $$testSubject ]
    Set Field [ testlearn::ktestSection; $$testSection ]
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Perform Find [ ]
    Go to Record/Request/Page [ First ]
    Set Variable [ $number; Value:Get (FoundCount) ]
    Loop
    Set Field [ testlearn::countOfONESubsectionsTestResults; $number ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Prepare test result summary layout by deleting
    #the last result summaries.
    Go to Layout [ “TestResultSections” (TEMP) ]
    Show All Records
    Delete All Records [ No dialog ]
    #
    #Find all current test results in all subsections
    #for this subject's test section.
    Go to Layout [ “reportTestResult” (testlearnReportTags) ]
    Enter Find Mode [ ]
    Set Field [ testlearnReportTags::ktestSubsection; $delete ]
    Set Field [ testlearnReportTags::ktestSubject; $$testSubject ]
    Set Field [ testlearnReportTags::kreportNumber; $$reportNumber ]
    #
    #This find range will insure only records with numbers
    #will be found (no NA or OK records).
    Set Field [ testlearnReportTags::countOfONESubsectionsTestResults; "0...99999999999999" ]
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Perform Find [ ]
    #
    #Capture found count to update total upon
    #returning to the testing subsection menu.
    Set Variable [ $updateTotalTestResults; Value:Get (FoundCount) ]
    #
    #If test results are found, then tell the
    #user on which reports they where found.
    If [ Get (FoundCount) ≠ 0 ]
    #
    Loop
    Set Variable [ $useList; Value:testlearnReportTags::countOfONESubsectionsTestResults & " in " & TextColor( TextStyleAdd ( tagReportTestSubjectSectionNAME::name; "" ) ;RGB(0;0;0)) ]
    Set Variable [ $sortBySectionName; Value:tagReportTestSubjectSectionNAME::name ]
    Set Variable [ $keepIdenticallySpelledSectionsSeparate; Value:testlearnReportTags::ktestSection ]
    Go to Layout [ “TestResultSections” (TEMP) ]
    New Record/Request
    Set Field [ TEMP::DeleteMessageInTempWindow2[2]; $useList ]
    Set Field [ TEMP::DeleteMessageInTempWindow2; $sortBySectionName ]
    Set Field [ TEMP::DeleteMessageInTempWindow1; $keepIdenticallySpelledSectionsSeparate ]
    Go to Layout [ “reportTestResult” (testlearnReportTags) ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    Go to Layout [ “TestResultSections” (TEMP) ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: TEMP::DeleteMessageInTempWindow2; ascending TEMP::DeleteMessageInTempWindow1; ascending ] [ Restore; No dialog ]
    View As [ View as List ]
    #
    #Due to a bug in FM13, window must first be
    #moved back into the screen area before the
    #calculation of the current screen's
    #dimensions can be taken.
    Move/Resize Window [ Current Window; Top: 0; Left: 0 ]
    Move/Resize Window [ Current Window; Height: Get ( ScreenHeight ); Width: 360; Top: 0; Left: Get ( ScreenWidth ) - ( Get ( ScreenWidth )/2 + 360) ]
    Set Field [ TEMP::Message; "Sub-section " & $subSection & " has test results in the following sections of test " & testSubsectionForSubject::kgreportNumber & "." ]
    Pause/Resume Script [ Indefinitely ]
    Set Variable [ $$stopLoadingTestSubSection ]
    Set Variable [ $$stopLoadTestResultRecord ]
    Set Variable [ $$stopLoadTestRecord ]
    Set Variable [ $$stopLoadTagRecord ]
    Set Variable [ $$stopDeleteTest ]
    Set Variable [ $$stopTest ]
    Set Variable [ $$tagTest ]
    Set Variable [ $$ID; Value:testSubsectionTemplate::_LtestSubsection ]
    Else
    Set Variable [ $$stopLoadingTestSubSection ]
    Set Variable [ $$stopLoadTestResultRecord ]
    Set Variable [ $$stopLoadTestRecord ]
    Set Variable [ $$stopLoadTagRecord ]
    Set Variable [ $$stopDeleteTest ]
    Set Variable [ $$stopTest ]
    Set Variable [ $$ID; Value:testSubsectionTemplate::_LtestSubsection ]
    End If
    #
    #Close the summary report window, return user
    #to the testing sections menu and update the
    #total of test results for all subsections in this
    #users current test.
    Close Window [ Current Window ]
    Select Window [ Name: "Test"; Current file ]
    Set Field [ testResultsReportSection::countOfALLSubsectionsTestResults; $updateTotalTestResults ]
    #
    #

Fields used in this script

    testResultsReportSection::countOfALLSubsectionsTestResults
    testSubsectionForSubject::_LtestSubsection
    testSubsectionForSubject::name
    testlearn::ktestSubsection
    testlearn::ktestSubject
    testlearn::ktestSection
    testlearn::countOfONESubsectionsTestResults
    testlearnReportTags::ktestSubsection
    testlearnReportTags::ktestSubject
    testlearnReportTags::kreportNumber
    testlearnReportTags::countOfONESubsectionsTestResults
    tagReportTestSubjectSectionNAME::name
    testlearnReportTags::ktestSection
    TEMP::DeleteMessageInTempWindow2
    TEMP::DeleteMessageInTempWindow1
    testSubsectionForSubject::kgreportNumber
    TEMP::Message
    testSubsectionTemplate::_LtestSubsection

Scripts used in this script

Layouts used in this script

    testSCRIPTloops
    TestResultSections
    reportTestResult

Tables used in this script

    TEMP
    testSectionCreatedFromATemplate
    testSubsectionTemplate
    testlearn
    testlearn

Table occurrences used by this script

    TEMP
    tagReportTestSubjectSectionNAME
    testResultsReportSection
    testSubsectionForSubject
    testSubsectionTemplate
    testlearn
    testlearnReportTags

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [identifyTestsThatHaveResults]	Parent Folder: [test]	Next Script: [inspectAddProblemToFinding]
Script Name	informUserHowToEditLockedLayoutText
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #Inform user how to edit a test item if the try
    #to edit one while in the testing or report
    #section. This is not allowed, so when the
    #user does edit an item they see the copyright
    #for the item, which is only displayed in the
    #edit section.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    If [ Get ( LayoutTableName ) = "tagMenus" and $$citationMatch ≠ "copyright" and $$showCopyrightLockMessage = "" ]
    Show Custom Dialog [ Message: "To edit a test item, click the 'edit/new' button. Selecting and copying item text is allowed."; Default Button: “OK”, Commit: “Yes” ]
    Else If [ $$citationMatch = "copyright" and tagCreatorLock::orderOrLock ≠ "" or $$showCopyrightLockMessage = 1 and tagCreatorLock::orderOrLock ≠ "" ]
    Show Custom Dialog [ Message: "This copyright was copy, pasted, and locked by " & tagCreatorLock::tag & ". Selecting and copying its text is allowed. Click the 'web' button to see the original. To unlock it, go the default node menu and enter the password for " & tagCreatorLock::tag & "."; Default Button: “OK”, Commit: “Yes” ]
    Else If [ $$citationMatch = "copyright" and tagMenus::orderOrLock = "lock" or $$showCopyrightLockMessage = 1 and tagMenus::orderOrLock = "lock" ]
    Show Custom Dialog [ Message: "This is a Library " & TEMP::versionNumber & " copy of a copyright and cannot be changed. Selecting and copying its text is allowed. Click the 'web' button to see the original."; Default Button: “OK”, Commit: “Yes” ]
    Else
    Show Custom Dialog [ Message: "To edit test information, click 'back' and then click" & ¶ & "the 'edit/new' button. Selecting and copying text is allowed."; Default Button: “OK”, Commit: “Yes” ]
    End If
    #
    #The halt script step stops FileMaker from
    #displaying its own error message.
    Halt Script
    #

Fields used in this script

    tagCreatorLock::orderOrLock
    tagCreatorLock::tag
    tagMenus::orderOrLock
    TEMP::versionNumber

Scripts used in this script

Layouts used in this script

Tables used in this script

    TEMP
    tag

Table occurrences used by this script

    TEMP
    tagCreatorLock
    tagMenus

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [informUserHowToEditLockedLayoutText]	Parent Folder: [test]	Next Script: [inspectNextRecord]
Script Name	inspectAddProblemToFinding
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    Set Field [ testlearn::note; testlearn::note & ¶ & tagDetails::tag ]

Fields used in this script

    testlearn::note
    tagDetails::tag

Scripts used in this script

Layouts used in this script

Tables used in this script

    tag
    testlearn

Table occurrences used by this script

    tagDetails
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [inspectAddProblemToFinding]	Parent Folder: [test]	Next Script: [inspectPreviousRecord]
Script Name	inspectNextRecord
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    testResult0
    testResultLOCKED0
    testResult1
    testResultLOCKED1
    testResult2
    testResultLOCKED2
    testResult3
    testResultLOCKED3
    testResult4
    testResultLOCKED4
    testResult5
    testResultLOCKED5

Scripts that use this script

Script Definition
Script Steps

    Go to Field [ ]
    Go to Record/Request/Page [ Next ]
    Set Field [ testlearn::recordnumberglobal; Get (RecordNumber) ]
    Set Field [ testlearn::recordcountglobal; Get (FoundCount) ]

Fields used in this script

    testlearn::recordnumberglobal
    testlearn::recordcountglobal

Scripts used in this script

Layouts used in this script

Tables used in this script

    testlearn

Table occurrences used by this script

    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [inspectNextRecord]	Parent Folder: [test]	Next Script: [linkOrUnlinkTestSection]
Script Name	inspectPreviousRecord
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    testResult0
    testResultLOCKED0
    testResult1
    testResultLOCKED1
    testResult2
    testResultLOCKED2
    testResult3
    testResultLOCKED3
    testResult4
    testResultLOCKED4
    testResult5
    testResultLOCKED5

Scripts that use this script

Script Definition
Script Steps

    Go to Field [ ]
    Go to Record/Request/Page [ Previous ]
    Set Field [ testlearn::recordnumberglobal; Get (RecordNumber) ]
    Set Field [ testlearn::recordcountglobal; Get (FoundCount) ]

Fields used in this script

    testlearn::recordnumberglobal
    testlearn::recordcountglobal

Scripts used in this script

Layouts used in this script

Tables used in this script

    testlearn

Table occurrences used by this script

    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [inspectPreviousRecord]	Parent Folder: [test]	Next Script: [loadSubsection]
Script Name	linkOrUnlinkTestSection
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    setupTestSection

Scripts that use this script

    newSubsection
    newSubsectionGroup

Script Definition
Script Steps

    #
    #
    #Prevent locked subsection's section links
    #from being changed.
    If [ $$lockedMainSubsectionRecord ≠ "" ]
    Show Custom Dialog [ Message: "Locked subsections cannot have their section links changed. Select its creator node — " & $$lockedMainSubsectionRecord & " — in setup, and enter the password to unlock it."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #
    #If tag has not yet been selected, then link it.
    Set Variable [ $sectionTemplate; Value:testSection::_Ltag ]
    Go to Field [ ]
    Select Window [ Name: "Test Templates"; Current file ]
    Set Variable [ $testTemplate; Value:testSubsectionTemplate::_LtestSubsection ]
    If [ $sectionTemplate & ¶ ≠ FilterValues ( testSubsectionTemplate::kcsections ; $sectionTemplate & "¶" ) ]
    #
    Set Variable [ $currentSectionTemplates; Value:testSubsectionTemplate::kcsections ]
    Set Field [ testSubsectionTemplate::kcsections; $sectionTemplate & "¶" & $currentSectionTemplates ]
    #
    #Reset conditional formatting variable for sections.
    Set Variable [ $$subsectionSections; Value:testSubsectionTemplate::kcsections ]
    Go to Field [ ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    Exit Script [ ]
    End If
    #
    #
    #
    #Find all sections that use this section template.
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Set Variable [ $recordNumber; Value:Get (RecordNumber) ]
    #
    #Highlight section user is trying to delete.
    Set Variable [ $delete; Value:testSection::_Ltag ]
    #
    #
    Set Variable [ $$stopTest; Value:1 ]
    Set Variable [ $$ID; Value:"ignore" ]
    Set Variable [ $$stopLoadTestRecord; Value:1 ]
    New Window [ Name: " "; Width: 360; Left: Get ( WindowWidth ) - 360; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “TEMP” (TEMP) ]
    Show All Records
    Delete All Records [ No dialog ]
    #
    Go to Layout [ “tableTestSectionFromTemplate” (testSectionCreatedFromATemplate) ]
    Enter Find Mode [ ]
    Set Field [ testSectionCreatedFromATemplate::inUse; "t" ]
    Set Field [ testSectionCreatedFromATemplate::ksectionTemplate; $sectionTemplate ]
    Perform Find [ ]
    #
    #For each section found, find its test records, and
    #see if any of their test records use the test template
    #that you wish to remove this section template.
    If [ Get (LastError) ≠ 401 ]
    Go to Record/Request/Page [ First ]
    Loop
    Set Variable [ $testSection; Value:testSectionCreatedFromATemplate::_LtestSection ]
    Set Variable [ $sectionName; Value:testSectionCreatedFromATemplate::name ]
    Go to Layout [ “testResult0” (testlearn) ]
    Enter Find Mode [ ]
    Set Field [ testlearn::ktestSection; $testSection ]
    Set Field [ testlearn::ktestSubsection; $testTemplate ]
    Perform Find [ ]
    If [ Get (LastError) ≠ 401 ]
    Set Variable [ $useList; Value:"test subject " & tagTLTestSubject::tag & ¶ & "test " & TextColor( TextStyleAdd ( testlearn::kreportNumber; "" ) ;RGB(0;0;0)) & " | section " & TextColor( TextStyleAdd ( $sectionName; "" ) ;RGB(0;0;0)) ]
    Go to Layout [ “TEMP” (TEMP) ]
    New Record/Request
    Set Field [ TEMP::DeleteMessageInTempWindow1; $useList ]
    End If
    Go to Layout [ “tableTestSectionFromTemplate” (testSectionCreatedFromATemplate) ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    If [ $useList ≠ "" ]
    Go to Layout [ “TEMP” (TEMP) ]
    View As [ View as List ]
    #
    #eliminate duplicate location records
    Sort Records [ Keep records in sorted order; Specified Sort Order: TEMP::DeleteMessageInTempWindow1; ascending ] [ Restore; No dialog ]
    Go to Record/Request/Page [ First ]
    Loop
    Set Variable [ $sectionTemplate; Value:TEMP::DeleteMessageInTempWindow1 ]
    Go to Record/Request/Page [ Next; Exit after last ]
    If [ TEMP::DeleteMessageInTempWindow1 = $sectionTemplate ]
    Omit Record
    #
    #Omit by default moves to the next record
    #in order to test actual next record the database
    #must move up one record.
    #
    Go to Record/Request/Page [ Previous ]
    #then the script can move down to test this record when it repeats
    End If
    End Loop
    #
    Show/Hide Toolbars [ Lock; Hide ]
    Show/Hide Text Ruler [ Hide ]
    Set Field [ TEMP::Message; "Before the highlighted test section-template can be unlinked, the test records in the test sections created using it (listed below) must be deleted from the testing window." ]
    Pause/Resume Script [ Indefinitely ]
    Close Window [ Current Window ]
    Set Variable [ $delete ]
    Set Variable [ $$stopTest ]
    Set Variable [ $$ID; Value:$testTemplate ]
    Set Variable [ $$stopLoadTestRecord ]
    Refresh Window
    Exit Script [ ]
    End If
    Close Window [ Current Window ]
    Else
    Close Window [ Current Window ]
    End If
    Set Variable [ $delete ]
    Set Variable [ $$stopTest ]
    Set Variable [ $$ID; Value:$testTemplate ]
    Set Variable [ $$stopLoadTestRecord ]
    Refresh Window
    #
    #
    #
    Select Window [ Name: "Test Templates"; Current file ]
    #
    #If tag has been selected, then unlink it.
    Set Variable [ $currentSectionTemplates; Value:testSubsectionTemplate::kcsections ]
    Set Field [ testSubsectionTemplate::kcsections; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used If ( ValueCount ( $currentSectionTemplates ) ≠ ValueCount ( Substitute ( $currentSectionTemplates ; $sectionTemplate & "¶" ; "" ) ) ; Substitute ( $currentSectionTemplates ; $sectionTemplate & "¶" ; "" ) ; "" ) ]
    #
    #Reset conditional formatting variable for sections.
    Set Variable [ $$subsectionSections; Value:testSubsectionTemplate::kcsections ]
    Go to Field [ ]
    #
    #Return to Tag Menus window.
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    #

Fields used in this script

    testSection::_Ltag
    testSubsectionTemplate::_LtestSubsection
    testSubsectionTemplate::kcsections
    testSectionCreatedFromATemplate::inUse
    testSectionCreatedFromATemplate::ksectionTemplate
    testSectionCreatedFromATemplate::_LtestSection
    testSectionCreatedFromATemplate::name
    testlearn::ktestSection
    testlearn::ktestSubsection
    tagTLTestSubject::tag
    testlearn::kreportNumber
    TEMP::DeleteMessageInTempWindow1
    TEMP::Message

Scripts used in this script

Layouts used in this script

    TEMP
    tableTestSectionFromTemplate
    testResult0

Tables used in this script

    TEMP
    tag
    tag
    testSectionCreatedFromATemplate
    testSubsectionTemplate
    testlearn

Table occurrences used by this script

    TEMP
    tagTLTestSubject
    testSection
    testSectionCreatedFromATemplate
    testSubsectionTemplate
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [linkOrUnlinkTestSection]	Parent Folder: [test]	Next Script: [loadTestInfo]
Script Name	loadSubsection
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #Used on testing subjection selection layout,
    #which the library goes to after the user clicks
    #a 'test' button on the setup test layout.
    #
    #Prevents user activating any buttons, until the
    #record is loaded.
    Set Variable [ $$stopLoadingTestSubSection; Value:1 ]
    #
    #Prepare to enter in subsection if user clicks
    #this subsection's button.
    Set Variable [ $$testSubsection; Value:testSubsectionForSubject::_LtestSubsection ]
    Set Variable [ $$testSubsectionName; Value:testSubsectionForSubject::name ]
    Set Field [ TEMP::testSubsectionName; testSubsectionForSubject::name ]
    Set Field [ TEMP::ktestSubsection; testSubsectionForSubject::_LtestSubsection ]
    #
    Go to Field [ ]
    #

Fields used in this script

    testSubsectionForSubject::_LtestSubsection
    testSubsectionForSubject::name
    TEMP::testSubsectionName
    TEMP::ktestSubsection

Scripts used in this script

Layouts used in this script

Tables used in this script

    TEMP
    testSubsectionTemplate

Table occurrences used by this script

    TEMP
    testSubsectionForSubject

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [loadSubsection]	Parent Folder: [test]	Next Script: [loadTestResultRecord]
Script Name	loadTestInfo
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    gotoDefaultsOrReport
    removeTestResultOrInfoRecordFromReport
    reportCopyPastPart3
    reportTagInfo

Script Definition
Script Steps

    #
    #This first section is key to stopping this script
    #when another script for example loops thru
    #many records each of which would trigger this
    #script and really slow down the program and
    #create strobe effect that is really irritating to
    #look at.
    If [ $$stoploadtestinfo = 1 or $$stopPart3InProgress = 1 ]
    Exit Script [ ]
    End If
    #
    #Admin tasks.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #Reset conditional formatting variables.
    Set Variable [ $$RecordID; Value:Get (RecordID) ]
    Set Variable [ $$infoPictureUsedOnThisTestSubSection ]
    Set Variable [ $$main; Value:testlearnReportTags::_Ltestlearn ]
    Go to Field [ ]
    #
    #Get this record's test tag keys, used by sort
    #order number script.
    Set Variable [ $$test; Value:testlearnReportTags::kctestSubsectionInfo ]
    #
    #Look thru the report picture fields to see if
    #any of them are using this info record's
    #picture or text.
    If [ testlearnReportTags::inUseNumberOfTimes > 0 ]
    Set Variable [ $$stoploadtestinfo; Value:1 ]
    New Window [ Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “tableReport” (report) ]
    #
    #See if any picture 1 slots use this info.
    Enter Find Mode [ ]
    Set Field [ report::ktestSubject; $$testSubject ]
    Set Field [ report::ktestSubsection; $$testSubsection ]
    Set Field [ report::kreportNumber; $$reportNumber ]
    Set Field [ report::kTag1; $$main ]
    Perform Find [ ]
    #
    If [ Get (FoundCount) > 0 ]
    Set Variable [ $$infoPictureUsedOnThisTestSubSection; Value:1 ]
    Set Variable [ $$stoploadtestinfo ]
    Close Window [ Current Window ]
    End If
    #
    #See if any picture 2 slots use this info.
    If [ $$infoPictureUsedOnThisTestSubSection = "" ]
    Enter Find Mode [ ]
    Set Field [ report::ktestSubject; $$testSubject ]
    Set Field [ report::ktestSubsection; $$testSubsection ]
    Set Field [ report::kreportNumber; $$reportNumber ]
    Set Field [ report::kTag2; $$main ]
    Perform Find [ ]
    #
    If [ Get (FoundCount) > 0 ]
    Set Variable [ $$infoPictureUsedOnThisTestSubSection; Value:1 ]
    Set Variable [ $$stoploadtestinfo ]
    Close Window [ Current Window ]
    End If
    End If
    #
    #See if any picture 3 slots use this info.
    If [ $$infoPictureUsedOnThisTestSubSection = "" ]
    Enter Find Mode [ ]
    Set Field [ report::ktestSubject; $$testSubject ]
    Set Field [ report::ktestSubsection; $$testSubsection ]
    Set Field [ report::kreportNumber; $$reportNumber ]
    Set Field [ report::kTag3; $$main ]
    Perform Find [ ]
    #
    If [ Get (FoundCount) > 0 ]
    Set Variable [ $$infoPictureUsedOnThisTestSubSection; Value:1 ]
    Set Variable [ $$stoploadtestinfo ]
    Close Window [ Current Window ]
    End If
    End If
    #
    #See if any picture 4 slots use this info.
    If [ $$infoPictureUsedOnThisTestSubSection = "" ]
    Enter Find Mode [ ]
    Set Field [ report::ktestSubject; $$testSubject ]
    Set Field [ report::ktestSubsection; $$testSubsection ]
    Set Field [ report::kreportNumber; $$reportNumber ]
    Set Field [ report::kTag4; $$main ]
    Perform Find [ ]
    #
    If [ Get (FoundCount) > 0 ]
    Set Variable [ $$infoPictureUsedOnThisTestSubSection; Value:1 ]
    End If
    #
    #Close this search window whether pictures
    #are found in the number 4 slot or no pictures
    #are found.
    Set Variable [ $$stoploadtestinfo ]
    Close Window [ Current Window ]
    End If
    End If
    #
    #Refresh conditional formatting in both
    #windows and return to Tag Menus window.
    Select Window [ Name: "Report"; Current file ]
    If [ Get ( LastError ) = 0 ]
    Set Variable [ $$userReportColorsInTextWindow; Value:1 ]
    Else
    Set Variable [ $$userReportColorsInTextWindow ]
    End If
    Refresh Window
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    #
    #Allow user to click into selected record's
    #text window.
    Set Variable [ $$stopOpenNewTextWindow ]
    #
    #Prevent the opening of the record's text
    #window when user goes to the record.
    Set Variable [ $$stopOpenNewTextWindow; Value:1 ]
    #
    #Only open a Reference window if the selected
    #info record has references, and if the user is
    #not in the process of going to the Learn
    #module to edit info records attached to
    #this subsection.
    If [ $$doNotOpenReferenceWindow ≠ 1 and ValueCount ( testlearnReportTags::kcreference ) - Length ( Filter ( testlearnReportTags::kcreference ; "L" ) ) > 0 ]
    Perform Script [ “CHUNK_findLearnRecordsReferences” ]
    #
    #
    #If there are no reference records for this info
    #record, then make sure to close the Reference
    #window (if opened for the last info record
    #selected) and resize the two remaining windows.
    Else
    Close Window [ Name: "Reference"; Current file ]
    If [ $$pictureWindowColor = "test" ]
    Move/Resize Window [ Name: "Test"; Current file; Width: Get ( ScreenWidth ) / 2; Left: 0 ]
    Move/Resize Window [ Name: "Tag Menus"; Current file; Width: Get ( ScreenWidth ) / 2; Left: Get ( ScreenWidth ) / 2 ]
    #
    #The size of the Tag Menus window in the Report
    #section can be larger than half the window width.
    Else
    Move/Resize Window [ Name: "Tag Menus"; Current file; Width: Get (ScreenWidth) - 594; Left: 594 ]
    End If
    Select Window [ Name: "Tag Menus"; Current file ]
    End If
    #
    #

Fields used in this script

    testlearnReportTags::_Ltestlearn
    testlearnReportTags::kctestSubsectionInfo
    testlearnReportTags::inUseNumberOfTimes
    report::ktestSubject
    report::ktestSubsection
    report::kreportNumber
    report::kTag1
    report::kTag2
    report::kTag3
    report::kTag4
    testlearnReportTags::kcreference

Scripts used in this script

    CHUNK_findLearnRecordsReferences

Layouts used in this script

    tableReport

Tables used in this script

    report
    testlearn

Table occurrences used by this script

    report
    testlearnReportTags

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [loadTestInfo]	Parent Folder: [test]	Next Script: [newTestResult]
Script Name	loadTestResultRecord
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    gotoDefaultsOrReport
    deleteTestResult
    gotoTestResults
    newTestResult

Script Definition
Script Steps

    #
    #
    #Admin tasks.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    #
    #Prevents script from running to speed up other
    #scripts that keep calling it up by looping thru
    #multiple records.
    If [ $$stopLoadTestRecord = 1 ]
    Exit Script [ ]
    End If
    #
    #Set record's variables.
    Set Variable [ $$evidenceToBeTagged; Value:testlearn::_Ltestlearn ]
    Set Variable [ $$taggedEvidence; Value:testlearn::kcKeywordOther ]
    #Clear before loading any item keys.
    Set Variable [ $$checkedTestItem ]
    Set Variable [ $$checkedTestItem; Value:testlearn::kctestResultCheckedItems ]
    #
    #Get return window name, and the refresh
    #conditonal formatting in the Tag Menus
    #window, and return this test record window.
    Set Variable [ $windowName; Value:Get (WindowName) ]
    Select Window [ Name: "Tag Menus"; Current file ]
    Refresh Window
    #
    #When a user creates a new test result, this
    #variable becomes active, so when this script
    #runs, it will perform the create form script.
    #This is done by this load script to reduce the
    #flashing back-and-forth between windows.
    #Since the load script is on the Tag Menus
    #window where this create form script starts, it
    #is most efficient if it is started here.
    If [ $$addFormToNewTestResult ≠ "" ]
    Perform Script [ “createFormOutOf_FT_TestItems” ]
    Set Variable [ $$addFormToNewTestResult ]
    End If
    #
    #Return to the test or report window.
    Select Window [ Name: $windowName; Current file ]
    Refresh Window
    #
    #

Fields used in this script

    testlearn::_Ltestlearn
    testlearn::kcKeywordOther
    testlearn::kctestResultCheckedItems

Scripts used in this script

    createFormOutOf_FT_TestItems

Layouts used in this script

Tables used in this script

    testlearn

Table occurrences used by this script

    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [loadTestResultRecord]	Parent Folder: [test]	Next Script: [reportNewTestResult]
Script Name	newTestResult
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    testResult0
    testResult1
    testResult2
    testResult3
    testResult4
    testResult5

Scripts that use this script

    gotoDefaultsOrReport
    gotoTestResults

Script Definition
Script Steps

    #
    #If node is currenlty locked then stop script,
    #and inform the user.
    Perform Script [ “stopNewRecordsBeingCreatedByLockedNode” ]
    #
    #basic administration tasks
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Set Variable [ $$stopLoadTestRecord; Value:1 ]
    #
    #If there is a possible form in the current
    #record's text field that the user may want
    #to insert into the new record copy it.
    Set Variable [ $noteForPossibleUseInNewRecord; Value:testlearn::note ]
    #
    #Find the NA record for this test subsection if
    #there is one.
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Enter Find Mode [ ]
    Set Field [ testlearn::ktestSubject; $$testSubject ]
    Set Field [ testlearn::ktestSubsection; $$testSubsection ]
    Set Field [ testlearn::kreportNumber; $$reportNumber ]
    Set Field [ testlearn::countOfONESubsectionsTestResults; "N/A" ]
    Perform Find [ ]
    #
    #Find the OK record for this test subsection if
    #there is one.
    Enter Find Mode [ ]
    Set Field [ testlearn::ktestSubject; $$testSubject ]
    Set Field [ testlearn::ktestSubsection; $$testSubsection ]
    Set Field [ testlearn::kreportNumber; $$reportNumber ]
    Set Field [ testlearn::countOfONESubsectionsTestResults; "OK" ]
    Extend Found Set [ ]
    #
    #Delete the OK or NA record if found. This
    #action removes what is now a useless record.
    #
    If [ testlearn::ktestSection = $$testSection and testlearn::countOfONESubsectionsTestResults = "N/A" and testlearn::kreportNumber = $$reportNumber or testlearn::ktestSection = $$testSection and testlearn::countOfONESubsectionsTestResults = "OK" and testlearn::kreportNumber = $$reportNumber or testlearn::ktestSection = $$testSection and testlearn::countOfONESubsectionsTestResults = "★" and testlearn::kreportNumber = $$reportNumber ]
    Delete Record/Request [ No dialog ]
    End If
    #
    #Create a new test result for this subsection.
    New Record/Request
    Set Field [ testlearn::ktestSubject; $$testSubject ]
    Set Field [ testlearn::ktestSection; $$testSection ]
    Set Field [ testlearn::kreportNumber; $$reportNumber ]
    Set Field [ testlearn::subsectionCustomName; $$testSubsectionName ]
    Set Field [ testlearn::ktestSubsection; $$testSubsection ]
    Set Field [ testlearn::kRecordCreatorNode; TEMP::kdefaultNodePrimary ]
    Set Field [ testlearn::dateModify; Get ( CurrentTimeStamp ) ]
    Set Field [ testlearn::kcopyright; TEMP::kdefaultCopyright ]
    #
    #Get this new records ID number.
    Set Variable [ $newRecordID; Value:testlearn::_Ltestlearn ]
    #
    #Increase number of results for this subsection.
    Go to Layout [ “testSCRIPTloops” (testlearn) ]
    Enter Find Mode [ ]
    Set Field [ testlearn::ktestSubsection; $$testSubsection ]
    Set Field [ testlearn::ktestSubject; $$testSubject ]
    Set Field [ testlearn::ktestSection; $$testSection ]
    Perform Find [ ]
    Go to Record/Request/Page [ First ]
    Set Variable [ $number; Value:Get (FoundCount) ]
    Loop
    Set Field [ testlearn::countOfONESubsectionsTestResults; $number ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Increase number of results for ALL subsections
    #in this test.
    Go to Layout [ “testSCRIPTloops” (testlearn) ]
    Set Error Capture [ On ]
    Enter Find Mode [ ]
    Set Field [ testlearn::ktestSubsection; $$testSubsection ]
    Set Field [ testlearn::ktestSubject; $$testSubject ]
    Set Field [ testlearn::kreportNumber; $$reportNumber ]
    #
    #This find range will insure only test result
    #records will be found (no NA or OK records).
    Set Field [ testlearn::countOfONESubsectionsTestResults; "0...99999999999999" ]
    Perform Find [ ]
    #
    Set Variable [ $number; Value:Get (FoundCount) ]
    #
    #Now find all the subject's report section records
    #including NA and OK records update total
    #results amount. NOTE: This done because in
    #some test sections there may only be an NA or
    #OK record in which to display test result totals
    #that inlcude other sections.
    Enter Find Mode [ ]
    Set Field [ testlearn::ktestSubsection; $$testSubsection ]
    Set Field [ testlearn::ktestSubject; $$testSubject ]
    Set Field [ testlearn::kreportNumber; $$reportNumber ]
    Go to Record/Request/Page [ First ]
    Perform Find [ ]
    #
    #Update the total results number for all subsections.
    Loop
    Set Field [ testlearn::countOfALLSubsectionsTestResults; $number ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Now refind just the test results records for this
    #test subsection for the user to view.
    Set Error Capture [ On ]
    Enter Find Mode [ ]
    Set Field [ testlearn::ktestSubsection; $$testSubsection ]
    Set Field [ testlearn::ktestSubject; $$testSubject ]
    Set Field [ testlearn::kreportNumber; $$reportNumber ]
    #
    #This find range will insure only records with numbers
    #will be found (no NA or OK records).
    Set Field [ testlearn::countOfONESubsectionsTestResults; "0...99999999999999" ]
    Perform Find [ ]
    #
    #Set conditional formatting on main test layout
    #informing user that this subsection has results.
    Go to Layout [ “tableTestSectionFromTemplate” (testSectionCreatedFromATemplate) ]
    Enter Find Mode [ ]
    Set Field [ testSectionCreatedFromATemplate::_LtestSection; $$testSection ]
    Perform Find [ ]
    Set Field [ testSectionCreatedFromATemplate::inUse; "t" ]
    #
    #Now refind all subsections user has created on
    #the main test layout.
    Enter Find Mode [ ]
    Set Field [ testSectionCreatedFromATemplate::ktestSubjectNode; $$testSubject ]
    Set Field [ testSectionCreatedFromATemplate::reportNumber; $$ReportNumber ]
    Perform Find [ ]
    #
    #See if a report record exists for this subsection.
    Set Variable [ $$stopLoadReportRecord; Value:1 ]
    Go to Layout [ “PrintReportEdit” (report) ]
    Enter Find Mode [ ]
    Set Field [ report::ktestSubject; $$testSubject ]
    Set Field [ report::ktestSubsection; $$testSubsection ]
    Set Field [ report::kreportNumber; $$reportNumber ]
    Perform Find [ ]
    #
    #Create new report record if none exists.
    If [ Get (LastError) = 401 ]
    New Record/Request
    Set Field [ report::ktestSubject; $$testSubject ]
    Set Field [ report::ktestSubsection; $$testSubsection ]
    Set Field [ report::kreportNumber; $$reportNumber ]
    End If
    #
    #Make test status is changed from pending to
    #in progress.
    Set Variable [ $$stopLoadReportRecord ]
    Go to Layout [ “testingSubsectionMenu” (testSubsectionForSubject) ]
    Set Field [ testSubsectionForSubject::gprogressGlobal; "status: in progress" ]
    #Return to the test results layout and go to
    #new record.
    Go to Layout [ "testResult" & Right ( TEMP::layoutTmain ; 1) ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearn::timestamp; ascending testlearn::subsectionCustomName; ascending testlearn::_Number; ascending ] [ Restore; No dialog ]
    Go to Record/Request/Page [ Last ]
    #
    #Make sure it is the new record.
    If [ $newRecordID ≠ testlearn::_Ltestlearn ]
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ $newRecordID = testlearn::_Ltestlearn ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    End If
    #
    #Load new record's variables.
    Set Variable [ $$stopLoadTestRecord ]
    Set Field [ testlearn::recordcountglobal; Get (FoundCount) ]
    #
    Set Field [ testlearn::recordnumberglobal; Get (RecordNumber) ]
    #
    #If this subsection has test items for a form
    #then put the form into this new test items
    #note field, unless there was copy of the form
    #in the previous record, in which case ask the
    #user if they want to use this previous copy
    #or load a fresh form.
    If [ $$noFT_ItemsFound = "" ]
    If [ $noteForPossibleUseInNewRecord ≠ "" ]
    Set Field [ testlearn::note; $noteForPossibleUseInNewRecord ]
    Show Custom Dialog [ Message: "Use a copy the form you where just viewing (now shown), OR create a new form for this record?"; Default Button: “copy”, Commit: “Yes”; Button 2: “new”, Commit: “No” ]
    #Use Copy
    If [ Get ( LastMessageChoice ) = 1 ]
    If [ Filter ( $noteForPossibleUseInNewRecord ; "!" ) ≠ "" ]
    Show Custom Dialog [ Message: "Remove exclamation points — ! — from the copied form? (Remove them if you use them to indicated you completed an item on the form)"; Default Button: “remove”, Commit: “Yes”; Button 2: “keep”, Commit: “No” ]
    If [ Get ( LastMessageChoice ) = 1 ]
    Set Field [ testlearn::note; Substitute ( $noteForPossibleUseInNewRecord ; "!" ; "" ) ]
    End If
    End If
    #Create New
    Else
    Set Field [ testlearn::note; "" ]
    Set Variable [ $$addFormToNewTestResult; Value:1 ]
    End If
    Else
    Set Variable [ $$addFormToNewTestResult; Value:1 ]
    End If
    End If
    #
    #Load up the variables for this new test result.
    Perform Script [ “loadTestResultRecord” ]
    #
    #

Fields used in this script

    testlearn::note
    testlearn::ktestSubject
    testlearn::ktestSubsection
    testlearn::kreportNumber
    testlearn::countOfONESubsectionsTestResults
    testlearn::ktestSection
    testlearn::subsectionCustomName
    TEMP::kdefaultNodePrimary
    testlearn::kRecordCreatorNode
    testlearn::dateModify
    TEMP::kdefaultCopyright
    testlearn::kcopyright
    testlearn::_Ltestlearn
    testlearn::countOfALLSubsectionsTestResults
    testSectionCreatedFromATemplate::_LtestSection
    testSectionCreatedFromATemplate::inUse
    testSectionCreatedFromATemplate::ktestSubjectNode
    testSectionCreatedFromATemplate::reportNumber
    report::ktestSubject
    report::ktestSubsection
    report::kreportNumber
    testSubsectionForSubject::gprogressGlobal
    TEMP::layoutTmain
    testlearn::timestamp
    testlearn::_Number
    testlearn::recordcountglobal
    testlearn::recordnumberglobal

Scripts used in this script

    stopNewRecordsBeingCreatedByLockedNode
    loadTestResultRecord

Layouts used in this script

    testSCRIPTloops
    tableTestSectionFromTemplate
    PrintReportEdit
    testingSubsectionMenu
    <Missing Layout>

Tables used in this script

    TEMP
    report
    testSectionCreatedFromATemplate
    testSubsectionTemplate
    testlearn

Table occurrences used by this script

    TEMP
    report
    testSectionCreatedFromATemplate
    testSubsectionForSubject
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [newTestResult]	Parent Folder: [test]	Next Script: [returnToInspectionItems]
Script Name	reportNewTestResult
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    reportTestResult

Scripts that use this script

Script Definition
Script Steps

    #
    #If node is currenlty locked then stop script,
    #and inform the user.
    Perform Script [ “stopNewRecordsBeingCreatedByLockedNode” ]
    #
    #basic administration tasks
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    If [ testlearnReportTags::kgtestSection = "" ]
    Show Custom Dialog [ Title: "!"; Message: "Select a test section by 1) clicking on the USE button under a picture or by 2) clicking the test section button (next to new button)."; Default Button: “OK”, Commit: “Yes” ]
    Halt Script
    End If
    #
    #
    Set Variable [ $$stopLoadTestResultRecord; Value:1 ]
    #
    New Record/Request
    Set Field [ testlearnReportTags::ktestSubject; $$testSubject ]
    Set Field [ testlearnReportTags::ktestSection; TEMP::ktestSection ]
    Set Field [ testlearnReportTags::kreportNumber; TEMP::reportNumber ]
    Set Field [ testlearnReportTags::subsectionCustomName; $$subsectionCustomName ]
    Set Field [ testlearnReportTags::ktestSubsection; TEMP::ktestSubsection ]
    Set Field [ testlearnReportTags::timestamp; TEMP::TimeStamp ]
    Set Field [ testlearnReportTags::kNodePrimary; TEMP::kdefaultNodePrimary ]
    Set Field [ testlearnReportTags::kRecordCreatorNode; TEMP::kdefaultNodePrimary ]
    Set Field [ testlearnReportTags::dateModify; Get ( CurrentTimeStamp ) ]
    Set Field [ testlearnReportTags::kcopyright; TEMP::kdefaultCopyright ]
    #
    #Note the new record ID so after sort the
    #the database will be able to select it.
    Set Variable [ $kpn; Value:testlearnReportTags::_Ltestlearn ]
    #
    #Increase number of findings for item for
    #this subject's location.
    Go to Layout [ “testSCRIPTloops” (testlearn) ]
    Enter Find Mode [ ]
    Set Field [ testlearn::ktestSubject; $$testSubject ]
    Set Field [ testlearn::ktestSection; $$testSection ]
    Set Field [ testlearn::ktestSubsection; $$testSubsection ]
    Perform Find [ ]
    Go to Record/Request/Page [ First ]
    Set Variable [ $number; Value:Get (FoundCount) ]
    Loop
    Set Field [ testlearn::countOfONESubsectionsTestResults; $number ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Increase number of test results.
    Enter Find Mode [ ]
    Set Field [ testlearn::ktestSubject; $$testSubject ]
    Set Field [ testlearn::ktestSubsection; $$testSubsection ]
    Set Field [ testlearn::kreportNumber; $$reportNumber ]
    Perform Find [ ]
    Go to Record/Request/Page [ First ]
    Set Variable [ $number; Value:Get (FoundCount) ]
    Loop
    Set Field [ testlearn::countOfALLSubsectionsTestResults; $number ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Lock item's section so it cannot be deleted
    #unless all findings for it are deleted.
    Go to Layout [ “tableTestSectionFromTemplate” (testSectionCreatedFromATemplate) ]
    Enter Find Mode [ ]
    Set Field [ testSectionCreatedFromATemplate::_LtestSection; $$testSection ]
    Perform Find [ ]
    Set Field [ testSectionCreatedFromATemplate::inUse; "t" ]
    #
    #Refind all section records for this session.
    Enter Find Mode [ ]
    Set Field [ testSectionCreatedFromATemplate::ktestSubjectNode; $$testSubject ]
    Set Field [ testSectionCreatedFromATemplate::reportNumber; $$ReportNumber ]
    Perform Find [ ]
    Go to Layout [ original layout ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: testlearnReportTags::subsectionCustomName; ascending testlearnReportTags::timestamp; ascending testlearnReportTags::_Ltestlearn; ascending ] [ Restore; No dialog ]
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ testlearnReportTags::_Ltestlearn = $kpn ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Set conditional formatting variables, turn on
    #the load script, and then go to the result's
    #note field.
    Set Variable [ $$RecordID; Value:Get (RecordID) ]
    Set Variable [ $$main; Value:testlearnReportTags::_Ltestlearn ]
    Set Variable [ $$stopLoadTestResultRecord ]
    Go to Field [ testlearnReportTags::note ]
    #

Fields used in this script

    testlearnReportTags::kgtestSection
    testlearnReportTags::ktestSubject
    TEMP::ktestSection
    testlearnReportTags::ktestSection
    TEMP::reportNumber
    testlearnReportTags::kreportNumber
    testlearnReportTags::subsectionCustomName
    TEMP::ktestSubsection
    testlearnReportTags::ktestSubsection
    TEMP::TimeStamp
    testlearnReportTags::timestamp
    TEMP::kdefaultNodePrimary
    testlearnReportTags::kNodePrimary
    testlearnReportTags::kRecordCreatorNode
    testlearnReportTags::dateModify
    TEMP::kdefaultCopyright
    testlearnReportTags::kcopyright
    testlearnReportTags::_Ltestlearn
    testlearn::ktestSubject
    testlearn::ktestSection
    testlearn::ktestSubsection
    testlearn::countOfONESubsectionsTestResults
    testlearn::kreportNumber
    testlearn::countOfALLSubsectionsTestResults
    testSectionCreatedFromATemplate::_LtestSection
    testSectionCreatedFromATemplate::inUse
    testSectionCreatedFromATemplate::ktestSubjectNode
    testSectionCreatedFromATemplate::reportNumber
    testlearnReportTags::note

Scripts used in this script

    stopNewRecordsBeingCreatedByLockedNode

Layouts used in this script

    testSCRIPTloops
    tableTestSectionFromTemplate

Tables used in this script

    TEMP
    testSectionCreatedFromATemplate
    testlearn

Table occurrences used by this script

    TEMP
    testSectionCreatedFromATemplate
    testlearn
    testlearnReportTags

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [reportNewTestResult]	Parent Folder: [test]	Next Script: [returnToSubsections]
Script Name	returnToInspectionItems
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    Go to Layout [ “testingSubsectionMenu” (testSubsectionForSubject) ]
    Enter Find Mode [ ]
    Set Field [ testSubsectionForSubject::kcsections; $$genlocation ]
    Perform Find [ ]
    Sort Records [ ] [ No dialog ]

Fields used in this script

    testSubsectionForSubject::kcsections

Scripts used in this script

Layouts used in this script

    testingSubsectionMenu

Tables used in this script

    testSubsectionTemplate

Table occurrences used by this script

    testSubsectionForSubject

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [returnToInspectionItems]	Parent Folder: [test]	Next Script: [returnToTestSetup]
Script Name	returnToSubsections
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    testResult0
    testResultLOCKED0
    testResult1
    testResultLOCKED1
    testResult2
    testResultLOCKED2
    testResult3
    testResultLOCKED3
    testResult4
    testResultLOCKED4
    testResult5
    testResultLOCKED5

Scripts that use this script

    stopLockedNodesRecordsBeingDeleted
    stopNewRecordsBeingCreatedByLockedNode

Script Definition
Script Steps

    #
    #Close any open test item reference windows
    #and resize the two remaining windows.
    Close Window [ Name: "Reference"; Current file ]
    Move/Resize Window [ Name: "Test"; Current file; Width: Get ( ScreenWidth ) / 2; Left: 0 ]
    Move/Resize Window [ Name: "Tag Menus"; Current file; Width: Get ( ScreenWidth ) / 2; Left: Get ( ScreenWidth ) / 2 ]
    Select Window [ Name: "Tag Menus"; Current file ]
    #
    #Return to this test's subsection menu, setting
    #the Tag Menus window to show no tags,
    #because there are no tags to show.
    Go to Layout [ “testMenuNoTag” (TEMP) ]
    Select Window [ Name: "Test"; Current file ]
    Set Field [ TEMP::showFavorites; "" ]
    Go to Layout [ “testingSubsectionMenu” (testSubsectionForSubject) ]
    Set Variable [ $$stopLoadingTestSubSection ]

Fields used in this script

    TEMP::showFavorites

Scripts used in this script

Layouts used in this script

    testMenuNoTag
    testingSubsectionMenu

Tables used in this script

    TEMP

Table occurrences used by this script

    TEMP

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [returnToSubsections]	Parent Folder: [test]	Next Script: [testInfoOpenTextNewWindow]
Script Name	returnToTestSetup
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    testingSubsectionMenu
    PrintReportEdit
    PrintReportLock

Scripts that use this script

    gotoReport
    deleteReportTestResult
    gotoTestSubsections

Script Definition
Script Steps

    #
    #If on test screen, see if any sections have results.
    If [ Get (LayoutName) = "testingSubsectionMenu" ]
    Set Variable [ $testInUseCheck; Value:1 ]
    Go to Record/Request/Page [ First ]
    Loop
    If [ testResultsTestSection::countOfONESubsectionsTestResults ≠ "" ]
    Set Variable [ $InUse; Value:1 ]
    End If
    Exit Loop If [ testResultsTestSection::countOfONESubsectionsTestResults ≠ "" ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    End If
    #
    #Close any open test item reference windows.
    #NOTE: This is next loop is a work around to
    #deal with the Reference window issue.
    #Basically, there are several scripts that may
    #open Reference windows for Info records that
    #have references. Rather than try to figure out all
    #the ways this occurs (easy with time), this loop
    #just closes as many Reference windows as are
    #currently open. Not the best solution, but it
    #works and I really want to close out work on this
    #4.0beta version and move on.
    Loop
    If [ ValueCount ( FilterValues ( WindowNames ( Get ( FileName ) ) ; "Reference" ) ) > 0 ]
    Close Window [ Name: "Reference"; Current file ]
    Set Variable [ $resizeTagMenusWindow; Value:1 ]
    End If
    Exit Loop If [ ValueCount ( FilterValues ( WindowNames ( Get ( FileName ) ) ; "Reference" ) ) = 0 ]
    End Loop
    #
    #Turn off this subsection menu variable.
    #Prevents user activating any buttons, until a
    #subsection record is loaded.
    Set Variable [ $$stopLoadingTestSubSection ]
    #
    #Turn of the test subject lock variable.
    Set Variable [ $$testSubjectIsLocked ]
    #
    #Go to the Setup Test layout.
    Go to Layout [ “defaultTest” (testSectionCreatedFromATemplate) ]
    Set Window Title [ Current Window; New Title: "Setup" ]
    #
    #Make sure window fills half of the screen.
    Move/Resize Window [ Current Window; Height: Get (ScreenHeight); Width: Get (ScreenWidth) / 2; Top: 0; Left: 0 ]
    #
    #Go to Tag Menus window.
    Select Window [ Name: "Tag Menus"; Current file ]
    If [ Get (LastError) = 112 ]
    New Window [ Name: "Tag Menus"; Height: Get (ScreenHeight); Width: Get (ScreenWidth) / 2; Top: 0; Left: Get (ScreenWidth) / 2; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    End If
    #
    #Make sure window to fills half of the screen.
    Move/Resize Window [ Current Window; Height: Get (ScreenHeight); Width: Get (ScreenWidth) / 2; Top: 0; Left: Get (ScreenWidth) / 2 ]
    #
    Go to Layout [ “defaultsAll” (tempSetup) ]
    Perform Script [ “defaultsAll” ]
    #
    #Find all created test section records.
    Select Window [ Name: "Setup"; Current file ]
    Go to Layout [ “defaultTest” (testSectionCreatedFromATemplate) ]
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    Show All Records
    #
    #Sort
    Sort Records [ Keep records in sorted order; Specified Sort Order: testSubjectName::tag; ascending testSectionCreatedFromATemplate::reportNumber; descending testSectionCreatedFromATemplate::order; based on value list: “order Pulldown List” testSectionCreatedFromATemplate::name; ascending ] [ Restore; No dialog ]
    #
    #Go to selected test subsection record.
    Go to Record/Request/Page [ $$TSRecordNumber ] [ No dialog ]
    Set Variable [ $$tagtest ]
    Set Variable [ $$testSubsection ]
    Set Variable [ $$TSRecordNumber ]
    Set Variable [ $$pictureWIndowColor ]
    #
    #Conditionally format records.
    If [ $InUse = "" and $testInUseCheck = 1 ]
    Set Field [ testSectionCreatedFromATemplate::inUse; "" ]
    Else If [ $InUse = 1 and $testInUseCheck = 1 and testSectionCreatedFromATemplate::inUse ≠ "d" ]
    Set Field [ testSectionCreatedFromATemplate::inUse; "t" ]
    End If
    #

Fields used in this script

    testResultsTestSection::countOfONESubsectionsTestResults
    testSubjectName::tag
    testSectionCreatedFromATemplate::reportNumber
    testSectionCreatedFromATemplate::order
    testSectionCreatedFromATemplate::name
    testSectionCreatedFromATemplate::inUse

Scripts used in this script

    defaultsAll

Layouts used in this script

    defaultTest
    defaultsAll

Tables used in this script

    tag
    testSectionCreatedFromATemplate
    testlearn

Table occurrences used by this script

    testResultsTestSection
    testSectionCreatedFromATemplate
    testSubjectName

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [returnToTestSetup]	Parent Folder: [test]	Next Script: [testItemCheckOrTextOrForm]
Script Name	testInfoOpenTextNewWindow
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    testInfo
    reportTagInfo

Scripts that use this script

Script Definition
Script Steps

    #
    #Prevent the opening of the record's text
    #window when user goes to the record.
    If [ $$stopOpenNewTextWindow = 1 ]
    Set Variable [ $$stopOpenNewTextWindow ]
    Exit Script [ ]
    End If
    #
    #Stop record load script while new window
    #is opened.
    Go to Field [ ]
    Set Variable [ $$stoploadtestinfo; Value:1 ]
    New Window [ Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    #
    #If record is locked go to locked layout.
    If [ $$lockedMainLearnRecord = "" ]
    Scroll Window [ Home ]
    Go to Layout [ “testInfoText” (testlearnReportTags) ]
    #
    Else If [ $$lockedMainLearnRecord ≠ "" ]
    Go to Layout [ “testInfoTextLocked” (testlearnReportTags) ]
    End If
    #
    #Turn back on record load script and pause
    #while user looks at text.
    Set Variable [ $$stopLoadTestInfo ]
    Pause/Resume Script [ Indefinitely ]
    #

Fields used in this script

Scripts used in this script

Layouts used in this script

    testInfoText
    testInfoTextLocked

Tables used in this script

Table occurrences used by this script

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [testInfoOpenTextNewWindow]	Parent Folder: [test]	Next Script: [testItemCheckTemplateButton]
Script Name	testItemCheckOrTextOrForm
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

    testItemCheckTemplateButton
    testItemTextOrFormTemplateButton

Script Definition
Script Steps

    #
    #On the test-item layout, set this stop check
    #or text variable to allows the user to click into
    #this field for the purpose of navigating to a
    #new record without changing the check or
    #text mark status.
    If [ $$stopCheckOrTest = 1 ]
    Set Variable [ $$stopCheckOrTest ]
    Exit Script [ ]
    End If
    #
    #Prevent user from changing check/text
    #status of locked records.
    If [ tagCreatorLock::orderOrLock ≠ "" ]
    Show Custom Dialog [ Message: "This record is locked. Go the node that created it — " & tagCreatorLock::tag & " — in the setup tag window and enter the password to unlock it."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #
    #Prevent the test check items from being
    #turned into T or FT items if they are
    #in use as check items.
    If [ tagMenus::notesOrCopyright = "✓" ]
    #Get variables needed for delete and delete messages.
    Set Variable [ $delete; Value:tagMenus::_Ltag ]
    Set Variable [ $group; Value:tagMenuTestItemGroup::_Lgroup ]
    Set Variable [ $groupName; Value:If ( Char ( tagMenuTestItemGroup::name ) ≤ 20 ; tagMenuTestItemGroup::name ; Left ( tagMenuTestItemGroup::name ; 20 ) & "..." ) ]
    Set Variable [ $testItemName; Value:If ( Char ( tagMenus::tag ) ≤ 20 ; tagMenus::tag ; Left ( tagMenus::tag ; 20 ) & "..." ) ]
    #
    #
    Set Variable [ $$stopLoadTestRecord; Value:1 ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Set Variable [ $$stopDeleteTest; Value:1 ]
    Set Variable [ $$stopTest; Value:1 ]
    New Window [ Name: " "; Height: 1; Width: 1; Top: -10000; Left: -10000; Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    Go to Layout [ “TEMP” (TEMP) ]
    Show All Records
    Delete All Records [ No dialog ]
    #
    Go to Layout [ “tableTestLearn” (testlearn) ]
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    Enter Find Mode [ ]
    Set Field [ testlearn::kctestResultCheckedItems; $delete ]
    Perform Find [ ]
    #
    #If this section is found to be in use, then inform
    #user of where and prevent its deletion.
    If [ Get (LastError) ≠ 401 ]
    Loop
    Set Variable [ $useList; Value:TextColor( tagTLTestSubject::tag & " | test " & testlearn::kreportNumber & ¶ & "section " ;RGB(102;102;102)) & testSectionTemplateName::name & ¶ & TextColor( "sub-section " ;RGB(102;102;102)) & testlearn::subsectionCustomName ]
    Go to Layout [ “TEMP” (TEMP) ]
    New Record/Request
    Set Field [ TEMP::DeleteMessageInTempWindow1; $useList ]
    Go to Layout [ “testResult0” (testlearn) ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    Go to Layout [ “TEMP” (TEMP) ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: TEMP::DeleteMessageInTempWindow1; ascending ] [ Restore; No dialog ]
    View As [ View as List ]
    #
    Show/Hide Toolbars [ Lock; Hide ]
    Show/Hide Text Ruler [ Hide ]
    #
    #Due to a bug in FM13, window must first be
    #moved back into the screen area before the
    #calculation of the current screen's
    #dimensions can be taken.
    Move/Resize Window [ Current Window; Top: 0; Left: 0 ]
    Move/Resize Window [ Current Window; Height: Get ( ScreenHeight ); Width: 360; Top: 0; Left: Get ( ScreenWidth ) - ( Get ( ScreenWidth )/2 + 360) ]
    Set Field [ TEMP::Message; "Before the highlighted test item can be turned into a T or FT item, it must unchecked " & "(in the test module) from test results in the test sub-sections below." ]
    Pause/Resume Script [ Indefinitely ]
    Close Window [ Current Window ]
    Set Variable [ $delete ]
    Set Variable [ $$stopLoadTestRecord ]
    Set Variable [ $$stopLoadTagRecord ]
    Set Variable [ $$stopDeleteTest ]
    Set Variable [ $$stopTest ]
    Refresh Window
    Exit Script [ ]
    Else
    Close Window [ Current Window ]
    Set Variable [ $delete ]
    Set Variable [ $$stopLoadTestRecord ]
    Set Variable [ $$stopLoadTagRecord ]
    Set Variable [ $$stopDeleteTest ]
    Set Variable [ $$stopTest ]
    Refresh Window
    End If
    End If
    #
    #
    #Change this test item's check or text mark
    #status. This status determines if and when
    #the test item's button is clicked a check is put
    #next to it or its text is copied and pasted into
    #a test results text field.
    Set Field [ tagMenus::notesOrCopyright; Case ( tagMenus::match = "testItem" ; Case ( tagMenus::notesOrCopyright = "" ; "✓" ; Case ( tagMenus::notesOrCopyright = "✓" ; "T" ; Case ( tagMenus::notesOrCopyright = "T" ; "FT" ; Case ( tagMenus::notesOrCopyright = "FT" ; "✓" ) ) ) ) ) ]
    Commit Records/Requests
    If [ tagMenus::notesOrCopyright = "✓" ]
    Set Field [ tagMenus::textStyleOrCreatorNodeFlag; "" ]
    Set Field [ tagMenus::tag; Trim (tagMenus::tag) ]
    Set Field [ tagMenus::tag; TextFontRemove ( tagMenus::tag ) ]
    Set Field [ tagMenus::tag; TextSizeRemove ( tagMenus::tag ; 20 ) ]
    Set Field [ tagMenus::tag; TextStyleRemove ( tagMenus::tag ; Bold ) ]
    Set Field [ tagMenus::tag; TextColorRemove ( tagMenus::tag ; RGB ( 99 ; 99 ; 99 ) ) ]
    #
    #Now force FileMaker to update formatting in
    #the tagSpelling field, which is what shows the
    #tag when the checkmark symbol is used.
    Set Field [ tagMenus::tagSpelling; tagMenus::tag ]
    End If
    Refresh Window
    #
    #

Fields used in this script

    tagCreatorLock::orderOrLock
    tagCreatorLock::tag
    tagMenus::notesOrCopyright
    tagMenus::_Ltag
    tagMenuTestItemGroup::_Lgroup
    tagMenuTestItemGroup::name
    tagMenus::tag
    testlearn::kctestResultCheckedItems
    tagTLTestSubject::tag
    testlearn::kreportNumber
    testSectionTemplateName::name
    testlearn::subsectionCustomName
    TEMP::DeleteMessageInTempWindow1
    TEMP::Message
    tagMenus::match
    tagMenus::textStyleOrCreatorNodeFlag
    tagMenus::tagSpelling

Scripts used in this script

Layouts used in this script

    TEMP
    tableTestLearn
    testResult0

Tables used in this script

    TEMP
    tag
    tag
    tagGroup
    testSectionCreatedFromATemplate
    testlearn

Table occurrences used by this script

    TEMP
    tagCreatorLock
    tagMenuTestItemGroup
    tagMenus
    tagTLTestSubject
    testSectionTemplateName
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [testItemCheckOrTextOrForm]	Parent Folder: [test]	Next Script: [testItemStyles]
Script Name	testItemCheckTemplateButton
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    setupTestItem

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #If a check is showing change the item into text
    #or form item.
    If [ tagMenus::notesOrCopyright = "✓" ]
    Perform Script [ “testItemCheckOrTextOrForm” ]
    #
    #
    #If no check (no button) is showing then
    #go to the text field, which is what the user is
    #seeing when then click here.
    Else
    Go to Field [ tagMenus::tag ]
    End If
    #
    #

Fields used in this script

    tagMenus::notesOrCopyright
    tagMenus::tag

Scripts used in this script

    testItemCheckOrTextOrForm

Layouts used in this script

Tables used in this script

    tag

Table occurrences used by this script

    tagMenus

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [testItemCheckTemplateButton]	Parent Folder: [test]	Next Script: [testItemTextOrFormTemplateButton]
Script Name	testItemStyles
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    setupTestItem

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #If the node that created this group is locked
    #prevent new items be created for it even by a
    #node that is not locked.
    If [ nodeLockTestTagItemGroup::orderOrLock ≠ "" ]
    Show Custom Dialog [ Message: "This group is locked. To format items, go the node that created this group — " & nodeLockTestTagItemGroup::tag & " — in the setup tag window and enter the password."; Default Button: “OK”, Commit: “Yes” ]
    Exit Script [ ]
    End If
    #
    #
    #Apply style to text and note/flag style number.
    If [ tagMenus::notesOrCopyright = "T" or tagMenus::notesOrCopyright = "FT" ]
    If [ tagMenus::textStyleOrCreatorNodeFlag = "" ]
    Set Field [ tagMenus::textStyleOrCreatorNodeFlag; "1" ]
    Set Field [ tagMenus::tag; Trim (tagMenus::tag) ]
    Set Field [ tagMenus::tag; TextFont ( tagMenus::tag ; "Georgia" ) ]
    Set Field [ tagMenus::tag; TextColor ( tagMenus::tag ; RGB ( 99 ; 99 ; 99 ) ) ]
    Else If [ tagMenus::textStyleOrCreatorNodeFlag = "1" ]
    Set Field [ tagMenus::textStyleOrCreatorNodeFlag; "2" ]
    Set Field [ tagMenus::tag; Trim (tagMenus::tag) ]
    Set Field [ tagMenus::tag; TextFont ( tagMenus::tag ; "Arial" ) ]
    Set Field [ tagMenus::tag; TextColorRemove ( tagMenus::tag ; RGB ( 99 ; 99 ; 99 ) ) ]
    Else If [ tagMenus::textStyleOrCreatorNodeFlag = "2" ]
    Set Field [ tagMenus::textStyleOrCreatorNodeFlag; "3" ]
    Set Field [ tagMenus::tag; Trim (tagMenus::tag) ]
    Set Field [ tagMenus::tag; TextSize ( tagMenus::tag ; 20 ) ]
    Set Field [ tagMenus::tag; TextFont ( tagMenus::tag ; "Arial" ) ]
    Set Field [ tagMenus::tag; TextStyleAdd ( tagMenus::tag ; Bold ) ]
    Set Field [ tagMenus::tag; TextColor ( tagMenus::tag ; RGB ( 99 ; 99 ; 99 ) ) ]
    Else If [ tagMenus::textStyleOrCreatorNodeFlag = "3" ]
    Set Field [ tagMenus::textStyleOrCreatorNodeFlag; "" ]
    Set Field [ tagMenus::tag; Trim (tagMenus::tag) ]
    Set Field [ tagMenus::tag; TextFontRemove ( tagMenus::tag ) ]
    Set Field [ tagMenus::tag; TextSizeRemove ( tagMenus::tag ; 20 ) ]
    Set Field [ tagMenus::tag; TextStyleRemove ( tagMenus::tag ; Bold ) ]
    Set Field [ tagMenus::tag; TextColorRemove ( tagMenus::tag ; RGB ( 99 ; 99 ; 99 ) ) ]
    Else
    Set Field [ tagMenus::textStyleOrCreatorNodeFlag; "" ]
    End If
    Else
    Show Custom Dialog [ Message: "Only text (T) and form (FT) items can be formatted as headers. To turn this item into a text item, click on the check mark. (You may have to click it twice.)"; Default Button: “OK”, Commit: “Yes” ]
    End If
    #

Fields used in this script

    nodeLockTestTagItemGroup::orderOrLock
    nodeLockTestTagItemGroup::tag
    tagMenus::notesOrCopyright
    tagMenus::textStyleOrCreatorNodeFlag
    tagMenus::tag

Scripts used in this script

Layouts used in this script

Tables used in this script

    tag
    tag

Table occurrences used by this script

    nodeLockTestTagItemGroup
    tagMenus

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [testItemStyles]	Parent Folder: [test]	Next Script: [testSubsectionNA]
Script Name	testItemTextOrFormTemplateButton
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    setupTestItem

Scripts that use this script

Script Definition
Script Steps

    #
    #
    #If a T is showing change the item into an FT
    #item, and if an FT is showing change the item
    #into a check item.
    If [ tagMenus::notesOrCopyright = "FT" or tagMenus::notesOrCopyright = "T" ]
    Perform Script [ “testItemCheckOrTextOrForm” ]
    #
    #
    #If neither a T or FT (no button) is showing then
    #go to the text field, which is what the user is
    #seeing when then click here.
    Else
    Go to Field [ tagMenus::tag ]
    End If
    #
    #

Fields used in this script

    tagMenus::notesOrCopyright
    tagMenus::tag

Scripts used in this script

    testItemCheckOrTextOrForm

Layouts used in this script

Tables used in this script

    tag

Table occurrences used by this script

    tagMenus

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [testItemTextOrFormTemplateButton]	Parent Folder: [test]	Next Script: [toggleTestWindowView]
Script Name	testSubsectionNA
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    testingSubsectionMenu

Scripts that use this script

Script Definition
Script Steps

    #
    If [ $$stopLoadingTestSubSection = 1 ]
    Set Variable [ $$stopLoadingTestSubSection ]
    Exit Script [ ]
    End If
    #
    #If node is currenlty locked then stop script,
    #and inform the user.
    Perform Script [ “stopNewRecordsBeingCreatedByLockedNode” ]
    #
    #This script creates test a result that is not
    #shown as a test result.
    # Instead, this record is used to show an
    #N/A or OK next to a test subsection to indicate
    #that this subsection does not apply or doesn't
    #require evidence of results to indicate that it is
    #OK. If the user decides to not show the OK or
    #N/A, then this script deletes this test result
    #record, which enables the display of the N/A
    #or OK on the test subsection menu layout.
    #
    #
    #basic administration tasks
    Set Error Capture [ On ]
    Allow User Abort [ Off ]
    If [ testResultsTestSection::_Ltestlearn = "" ]
    Freeze Window
    New Window [ Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    #note item's ID number and name
    Set Variable [ $$testSubsection; Value:testSubsectionForSubject::_LtestSubsection ]
    Set Variable [ $$testSubsectionName; Value:testSubsectionForSubject::name ]
    Set Field [ TEMP::testSubsectionName ]
    Go to Layout [ “testSCRIPTloops” (testlearn) ]
    New Record/Request
    Set Field [ testlearn::ktestSubject; TEMP::kdefaultNodeTestSubject ]
    Set Field [ testlearn::ktestSection; $$testSection ]
    Set Field [ testlearn::kreportNumber; $$reportNumber ]
    Set Field [ testlearn::subsectionCustomName; $$testSectionName ]
    Set Field [ testlearn::ktestSubsection; $$testSubsection ]
    #lock item location so it cannot be deleted unless all findings for it are deleted
    Go to Layout [ “tableTestSectionFromTemplate” (testSectionCreatedFromATemplate) ]
    Enter Find Mode [ ]
    Set Field [ testSectionCreatedFromATemplate::_LtestSection; $$testSection ]
    Perform Find [ ]
    Set Field [ testSectionCreatedFromATemplate::inUse; "t" ]
    #refind all location records for this session
    Enter Find Mode [ ]
    Set Field [ testSectionCreatedFromATemplate::ktestSubjectNode; TEMP::kdefaultNodeTestSubject ]
    Perform Find [ ]
    Go to Layout [ “testingSubsectionMenu” (testSubsectionForSubject) ]
    Set Field [ testResultsTestSection::countOfONESubsectionsTestResults; "N/A" ]
    Set Field [ testSubsectionForSubject::gprogressGlobal; "status: in progress" ]
    Go to Field [ ]
    Close Window [ Current Window ]
    Set Variable [ $$stopLoadingTestSubSection ]
    Exit Script [ ]
    Else If [ testResultsTestSection::countOfONESubsectionsTestResults = "" and testResultsTestSection::_Ltestlearn ≠ "" ]
    Set Field [ testResultsTestSection::countOfONESubsectionsTestResults; "N/A" ]
    Go to Layout [ “testingSubsectionMenu” (testSubsectionForSubject) ]
    Set Field [ testSubsectionForSubject::gprogressGlobal; "status: in progress" ]
    Set Field [ TEMP::testSubsectionName ]
    Go to Field [ ]
    Set Variable [ $$stopLoadingTestSubSection ]
    Exit Script [ ]
    Else If [ testResultsTestSection::countOfONESubsectionsTestResults = "N/A" ]
    Set Field [ testResultsTestSection::countOfONESubsectionsTestResults; "OK" ]
    Go to Layout [ “testingSubsectionMenu” (testSubsectionForSubject) ]
    Set Field [ testSubsectionForSubject::gprogressGlobal; "status: in progress" ]
    Set Field [ TEMP::testSubsectionName ]
    Go to Field [ ]
    Set Variable [ $$stopLoadingTestSubSection ]
    Exit Script [ ]
    Else If [ testResultsTestSection::countOfONESubsectionsTestResults = "N/A" or testResultsTestSection::countOfONESubsectionsTestResults = "OK" ]
    #
    #
    #Disable star symbol.
    // If [ testResultsReportSection::countOfALLSubsectionsTestResults = "" ]
    If [ testResultsReportSection::countOfALLSubsectionsTestResults = "" or testResultsReportSection::countOfALLSubsectionsTestResults ≠ "" ]
    Set Field [ TEMP::testSubsectionName ]
    // Show Custom Dialog [ Title: "FYI"; Message: "Use the star symbol to referr to other assessment findings. You currently do not have any for this item."; Default Button: “OK”, Commit: “No” ]
    Set Field [ testResultsTestSection::countOfONESubsectionsTestResults; "" ]
    Go to Field [ ]
    Freeze Window
    New Window [ Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    #note item's ID number and name
    Set Variable [ $$testSubsection; Value:testSubsectionForSubject::_LtestSubsection ]
    #
    Go to Layout [ “testSCRIPTloops” (testlearn) ]
    Enter Find Mode [ ]
    Set Field [ testlearn::ktestSubject; TEMP::kdefaultNodeTestSubject ]
    Set Field [ testlearn::ktestSection; $$testSection ]
    Set Field [ testlearn::ktestSubsection; $$testSubsection ]
    Perform Find [ ]
    #
    Delete Record/Request [ No dialog ]
    #Unlock Item Location
    Enter Find Mode [ ]
    Set Field [ testlearn::ktestSubject; TEMP::kdefaultNodeTestSubject ]
    Set Field [ testlearn::ktestSection; $$testSection ]
    Perform Find [ ]
    #
    If [ Get ( LastError ) = 401 ]
    Go to Layout [ “tableTestSectionFromTemplate” (testSectionCreatedFromATemplate) ]
    Enter Find Mode [ ]
    Set Field [ testSectionCreatedFromATemplate::_LtestSection; $$testSection ]
    Perform Find [ ]
    Set Field [ testSectionCreatedFromATemplate::inUse; "" ]
    #refind all location records for this session
    Enter Find Mode [ ]
    Set Field [ testSectionCreatedFromATemplate::ktestSubjectNode; TEMP::kdefaultNodeTestSubject ]
    Perform Find [ ]
    Go to Layout [ “testingSubsectionMenu” (testSubsectionForSubject) ]
    #
    Set Field [ testSubsectionForSubject::gprogressGlobal; "status: pending" ]
    End If
    Close Window [ Current Window ]
    Set Variable [ $$stopLoadingTestSubSection ]
    Exit Script [ ]
    End If
    Set Field [ testResultsTestSection::countOfONESubsectionsTestResults; "★" ]
    Go to Layout [ “testingSubsectionMenu” (testSubsectionForSubject) ]
    Set Field [ testSubsectionForSubject::gprogressGlobal; "status: in progress" ]
    Go to Field [ ]
    Set Variable [ $$stopLoadingTestSubSection ]
    Exit Script [ ]
    Else If [ testResultsTestSection::countOfONESubsectionsTestResults ≠ "N/A" and testResultsTestSection::countOfONESubsectionsTestResults ≠ "OK" and testResultsTestSection::countOfONESubsectionsTestResults ≠ "★" ]
    Set Field [ TEMP::testSubsectionName ]
    Go to Layout [ “testingSubsectionMenu” (testSubsectionForSubject) ]
    Set Field [ testSubsectionForSubject::gprogressGlobal; "status: in progress" ]
    Go to Field [ ]
    Set Variable [ $$stopLoadingTestSubSection ]
    Exit Script [ ]
    End If
    Freeze Window
    New Window [ Style: Document; Close: “Yes”; Minimize: “Yes”; Maximize: “Yes”; Zoom Control Area: “Yes”; Resize: “Yes” ]
    #note item's ID number and name
    Set Variable [ $$testSubsection; Value:testSubsectionForSubject::_LtestSubsection ]
    Set Field [ TEMP::testSubsectionName ]
    Go to Layout [ “testSCRIPTloops” (testlearn) ]
    Enter Find Mode [ ]
    Set Field [ testlearn::ktestSubject; TEMP::kdefaultNodeTestSubject ]
    Set Field [ testlearn::ktestSection; $$testSection ]
    Set Field [ testlearn::ktestSubsection; $$testSubsection ]
    Perform Find [ ]
    Delete Record/Request [ No dialog ]
    #Unlock Item Location
    Enter Find Mode [ ]
    Set Field [ testlearn::ktestSubject; TEMP::kdefaultNodeTestSubject ]
    Set Field [ testlearn::ktestSection; $$testSection ]
    Perform Find [ ]
    If [ Get ( LastError ) = 401 ]
    Go to Layout [ “tableTestSectionFromTemplate” (testSectionCreatedFromATemplate) ]
    Enter Find Mode [ ]
    Set Field [ testSectionCreatedFromATemplate::_LtestSection; $$testSection ]
    Perform Find [ ]
    Set Field [ testSectionCreatedFromATemplate::inUse; "" ]
    #refind all location records for this session
    Enter Find Mode [ ]
    Set Field [ testSectionCreatedFromATemplate::ktestSubjectNode; TEMP::kdefaultNodeTestSubject ]
    Perform Find [ ]
    Go to Layout [ “testingSubsectionMenu” (testSubsectionForSubject) ]
    Set Field [ testSubsectionForSubject::gprogressGlobal; "status: pending" ]
    End If
    Set Variable [ $$stopLoadingTestSubSection ]
    Close Window [ Current Window ]

Fields used in this script

    testResultsTestSection::_Ltestlearn
    testSubsectionForSubject::_LtestSubsection
    testSubsectionForSubject::name
    TEMP::testSubsectionName
    TEMP::kdefaultNodeTestSubject
    testlearn::ktestSubject
    testlearn::ktestSection
    testlearn::kreportNumber
    testlearn::subsectionCustomName
    testlearn::ktestSubsection
    testSectionCreatedFromATemplate::_LtestSection
    testSectionCreatedFromATemplate::inUse
    testSectionCreatedFromATemplate::ktestSubjectNode
    testResultsTestSection::countOfONESubsectionsTestResults
    testSubsectionForSubject::gprogressGlobal
    testResultsReportSection::countOfALLSubsectionsTestResults

Scripts used in this script

    stopNewRecordsBeingCreatedByLockedNode

Layouts used in this script

    testSCRIPTloops
    tableTestSectionFromTemplate
    testingSubsectionMenu

Tables used in this script

    TEMP
    testSectionCreatedFromATemplate
    testSubsectionTemplate
    testlearn
    testlearn
    testlearn

Table occurrences used by this script

    TEMP
    testResultsReportSection
    testResultsTestSection
    testSectionCreatedFromATemplate
    testSubsectionForSubject
    testlearn

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [testSubsectionNA]	Parent Folder: [test]	Next Script: [testResultInformationPulldown]
Script Name	toggleTestWindowView
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    testResult0
    testResultLOCKED0
    testResult1
    testResultLOCKED1
    testResult2
    testResultLOCKED2
    testResult3
    testResultLOCKED3
    testResult4
    testResultLOCKED4
    testResult5
    testResultLOCKED5

Scripts that use this script

Script Definition
Script Steps

    #
    #Reveal more or fewer pictures and links for tag.
    #First toggle from current view to next view.
    #Turn off loadRecord script to speed up process.
    Set Variable [ $$stopLoadTestRecord; Value:1 ]
    #
    #from 0 to 1
    If [ Right ( Get (LayoutName) ; 1) = 0 and Left ( TEMP::layoutTmain ; 4 ) = "more" ]
    If [ TEMP::testSubjectNodeIsLocked = "" and TEMP::primaryNodeIsLocked = "" ]
    Go to Layout [ “testResult1” (testlearn) ]
    Else
    Go to Layout [ “testResultLOCKED1” (testlearn) ]
    End If
    #
    #from 1 to 2
    Else If [ Right ( Get (LayoutName) ; 1) = 1 and Left ( TEMP::layoutTmain ; 4 ) = "more" ]
    If [ TEMP::testSubjectNodeIsLocked = "" and TEMP::primaryNodeIsLocked = "" ]
    Go to Layout [ “testResult2” (testlearn) ]
    Else
    Go to Layout [ “testResultLOCKED2” (testlearn) ]
    End If
    #
    #from 2 to 3
    Else If [ Right ( Get (LayoutName) ; 1) = 2 and Left ( TEMP::layoutTmain ; 4 ) = "more" ]
    If [ TEMP::testSubjectNodeIsLocked = "" and TEMP::primaryNodeIsLocked = "" ]
    Go to Layout [ “testResult3” (testlearn) ]
    Else
    Go to Layout [ “testResultLOCKED3” (testlearn) ]
    End If
    #
    #from 3 to 4
    Else If [ Right ( Get (LayoutName) ; 1) = 3 and Left ( TEMP::layoutTmain ; 4 ) = "more" ]
    If [ TEMP::testSubjectNodeIsLocked = "" and TEMP::primaryNodeIsLocked = "" ]
    Go to Layout [ “testResult4” (testlearn) ]
    Else
    Go to Layout [ “testResultLOCKED4” (testlearn) ]
    End If
    #
    #from 4 to 5
    Else If [ Right ( Get (LayoutName) ; 1) = 4 and Left ( TEMP::layoutTmain ; 4 ) = "more" ]
    If [ TEMP::testSubjectNodeIsLocked = "" and TEMP::primaryNodeIsLocked = "" ]
    Go to Layout [ “testResult5” (testlearn) ]
    Else
    Go to Layout [ “testResultLOCKED5” (testlearn) ]
    End If
    #
    #from 5 to 4
    Else If [ Right ( Get (LayoutName) ; 1) = 5 and Left ( TEMP::layoutTmain ; 4 ) = "less" ]
    If [ TEMP::testSubjectNodeIsLocked = "" and TEMP::primaryNodeIsLocked = "" ]
    Go to Layout [ “testResult4” (testlearn) ]
    Else
    Go to Layout [ “testResultLOCKED4” (testlearn) ]
    End If
    #
    #from 4 to 3
    Else If [ Right ( Get (LayoutName) ; 1) = 4 and Left ( TEMP::layoutTmain ; 4 ) = "less" ]
    If [ TEMP::testSubjectNodeIsLocked = "" and TEMP::primaryNodeIsLocked = "" ]
    Go to Layout [ “testResult3” (testlearn) ]
    Else
    Go to Layout [ “testResultLOCKED3” (testlearn) ]
    End If
    #
    #from 3 to 2
    Else If [ Right ( Get (LayoutName) ; 1) = 3 and Left ( TEMP::layoutTmain ; 4 ) = "less" ]
    If [ TEMP::testSubjectNodeIsLocked = "" and TEMP::primaryNodeIsLocked = "" ]
    Go to Layout [ “testResult2” (testlearn) ]
    Else
    Go to Layout [ “testResultLOCKED2” (testlearn) ]
    End If
    #
    #from 2 to 1
    Else If [ Right ( Get (LayoutName) ; 1) = 2 and Left ( TEMP::layoutTmain ; 4 ) = "less" ]
    If [ TEMP::testSubjectNodeIsLocked = "" and TEMP::primaryNodeIsLocked = "" ]
    Go to Layout [ “testResult1” (testlearn) ]
    Else
    Go to Layout [ “testResultLOCKED1” (testlearn) ]
    End If
    #
    #from 1 to 0
    Else If [ Right ( Get (LayoutName) ; 1) = 1 and Left ( TEMP::layoutTmain ; 4 ) = "less" ]
    If [ TEMP::testSubjectNodeIsLocked = "" and TEMP::primaryNodeIsLocked = "" ]
    Go to Layout [ “testResult0” (testlearn) ]
    Else
    Go to Layout [ “testResultLOCKED0” (testlearn) ]
    End If
    End If
    #
    #Remember layout user is on so they can be
    #returned to correct view.
    #
    #Turn on loadRecord script needed for other scripts.
    Set Variable [ $$stopLoadTestRecord ]
    #
    #from 0 to 1
    If [ Right ( Get (LayoutName) ; 1) = 1 and Left ( TEMP::layoutTmain ; 4 ) = "more" ]
    Set Field [ TEMP::layoutTmain; "more" & Get (LayoutName) ]
    #from 1 to 2
    Else If [ Right ( Get (LayoutName) ; 1) = 2 and Left ( TEMP::layoutTmain ; 4 ) = "more" ]
    Set Field [ TEMP::layoutTmain; "more" & Get (LayoutName) ]
    #from 2 to 3
    Else If [ Right ( Get (LayoutName) ; 1) = 3 and Left ( TEMP::layoutTmain ; 4 ) = "more" ]
    Set Field [ TEMP::layoutTmain; "more" & Get (LayoutName) ]
    #from 3 to 4
    Else If [ Right ( Get (LayoutName) ; 1) = 4 and Left ( TEMP::layoutTmain ; 4 ) = "more" ]
    Set Field [ TEMP::layoutTmain; "more" & Get (LayoutName) ]
    #from 4 to 5
    Else If [ Right ( Get (LayoutName) ; 1) = 5 and Left ( TEMP::layoutTmain ; 4 ) = "more" ]
    Set Field [ TEMP::layoutTmain; "less" & Get (LayoutName) ]
    #from 5 to 4
    Else If [ Right ( Get (LayoutName) ; 1) = 4 and Left ( TEMP::layoutTmain ; 4 ) = "less" ]
    Set Field [ TEMP::layoutTmain; "less" & Get (LayoutName) ]
    #from 4 to 3
    Else If [ Right ( Get (LayoutName) ; 1) = 3 and Left ( TEMP::layoutTmain ; 4 ) = "less" ]
    Set Field [ TEMP::layoutTmain; "less" & Get (LayoutName) ]
    #from 3 to 2
    Else If [ Right ( Get (LayoutName) ; 1) = 2 and Left ( TEMP::layoutTmain ; 4 ) = "less" ]
    Set Field [ TEMP::layoutTmain; "less" & Get (LayoutName) ]
    #from 2 to 1
    Else If [ Right ( Get (LayoutName) ; 1) = 1 and Left ( TEMP::layoutTmain ; 4 ) = "less" ]
    Set Field [ TEMP::layoutTmain; "less" & Get (LayoutName) ]
    #from 1 to 0
    Else If [ Right ( Get (LayoutName) ; 1) = 0 and Left ( TEMP::layoutTmain ; 4 ) = "less" ]
    Set Field [ TEMP::layoutTmain; "more" & Get (LayoutName) ]
    End If
    #
    #

Fields used in this script

    TEMP::layoutTmain
    TEMP::testSubjectNodeIsLocked
    TEMP::primaryNodeIsLocked

Scripts used in this script

Layouts used in this script

    testResult1
    testResultLOCKED1
    testResult2
    testResultLOCKED2
    testResult3
    testResultLOCKED3
    testResult4
    testResultLOCKED4
    testResult5
    testResultLOCKED5
    testResult0
    testResultLOCKED0

Tables used in this script

    TEMP

Table occurrences used by this script

    TEMP

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [toggleTestWindowView]	Parent Folder: [test]	Next Script: [useSubsectionAndCurrentTimeStamp]
Script Name	testResultInformationPulldown
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #Set up new test result fields with the selected
    #section's name and key.
    Set Field [ TEMP::testSubsectionNameForSubject; PulldownTestSectionName::name ]
    Set Field [ TEMP::ktestSection; PulldownTestSectionName::_LtestSection ]
    Set Variable [ $$subsectionCustomName; Value:TEMP::testSubsectionName ]
    Set Field [ testlearnReportTags::kgtestSection; PulldownTestSectionName::_LtestSection ]
    Go to Field [ ]
    #

Fields used in this script

    PulldownTestSectionName::name
    TEMP::testSubsectionNameForSubject
    PulldownTestSectionName::_LtestSection
    TEMP::ktestSection
    TEMP::testSubsectionName
    testlearnReportTags::kgtestSection

Scripts used in this script

Layouts used in this script

Tables used in this script

    TEMP
    testSectionCreatedFromATemplate
    testlearn

Table occurrences used by this script

    PulldownTestSectionName
    TEMP
    testlearnReportTags

Custom Functions used by this script

Custom menu set used by this script


Previous Script: [testResultInformationPulldown]	Parent Folder: [test]
Script Name	useSubsectionAndCurrentTimeStamp
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

    reportTestResult

Scripts that use this script

Script Definition
Script Steps

    #
    #Set up new test result information with this
    #result's information.
    Set Field [ TEMP::testSubsectionNameForSubject; tagReportTestSubjectSectionNAME::name ]
    Set Field [ TEMP::ktestSection; testlearnReportTags::ktestSection ]
    Set Variable [ $$subsectionCustomName; Value:testlearnReportTags::subsectionCustomName ]
    Set Field [ testlearnReportTags::kgtestSection; testlearnReportTags::ktestSection ]
    Set Field [ TEMP::TimeStamp; testlearnReportTags::timestamp ]

Fields used in this script

    tagReportTestSubjectSectionNAME::name
    TEMP::testSubsectionNameForSubject
    testlearnReportTags::ktestSection
    TEMP::ktestSection
    testlearnReportTags::subsectionCustomName
    testlearnReportTags::kgtestSection
    testlearnReportTags::timestamp
    TEMP::TimeStamp

Scripts used in this script

Layouts used in this script

Tables used in this script

    TEMP
    testSectionCreatedFromATemplate
    testlearn

Table occurrences used by this script

    TEMP
    tagReportTestSubjectSectionNAME
    testlearnReportTags

Custom Functions used by this script

Custom menu set used by this script


probablyNotInUse
	Parent Folder: [probablyNotInUse]
Script Name	switchTestList
Run script with full access privileges	Off
Include In Menu	No
Layouts that use this script

Scripts that use this script

Script Definition
Script Steps

    #
    #If the user selected the list currently showing then
    #stop the script.
    If [ TEMP::ktestItemSubsection = TEMP::ktestItemSubsectionOLD ]
    Go to Field [ ]
    Exit Script [ ]
    End If
    #
    #switch to the selected test, which may or may
    #not have a test-item list.
    Allow User Abort [ Off ]
    Set Error Capture [ On ]
    Set Variable [ $$stopLoadTagRecord; Value:1 ]
    Enter Find Mode [ ]
    Set Field [ tagMenuTestItemGroup::match; TEMP::ktestItemSubsection ]
    Perform Find [ ]
    #
    #If there is no list, then inform the user of this fact
    #at the end of the script, after the name of the list
    #is updated. To do that capture the 401 error message.
    If [ Get (LastError) = 401 ]
    Set Variable [ $emptyList; Value:1 ]
    End If
    Set Variable [ $$stopLoadTagRecord ]
    Sort Records [ Keep records in sorted order; Specified Sort Order: tagMenuTestItemGroup::orderOrLibraryType; based on value list: “order Pulldown List” tagMenuTestItemGroup::_Lgroup; ascending tagMenus::orderOrLock; based on value list: “order Pulldown List” tagMenus::tag; ascending ] [ Restore; No dialog ]
    #
    #assign newly selected test item list to test
    Select Window [ Name: "Setup"; Current file ]
    Set Field [ testSubsectionTemplate::ktestItemGroup; TEMP::ktestItemSubsection ]
    #
    #get the switched-to-test's name.
    #
    #The reason for this whole section of the script
    #(getting a test name) is that there is no relationship
    #that can be made that would match the key of
    #of the named test to this test and thus unlock
    #and so allow the layout to show this test name.
    #This is because the key to unlock the display of
    #a test's name is in a keychain field where many
    #keys may exist in list. Filemaker cannot match
    #a lock in one table to list of keys in another table.
    #There must be only one key in a field in order
    #for Filemaker to know which key to use in a lock.
    #The database does not have the intellegence or
    #programming to search through a list of keys
    #to make a match to a lock field in another table.
    #Thus, in order to display the name of the test in use
    #we must have the system put that name in a temp
    #field with global storage, which then allows it
    #to be displayed on any layout where that temp
    #field is displayed. No relationship between the
    #the temp table and the layout's table is required
    #as long as the temp field is a global field, meaning
    #all data in the field is the same for every record
    #in the temp table.
    #
    #Get the ID of the current record so it can be
    #looped back to.
    Set Variable [ $currentTest; Value:testSubsectionTemplate::_LtestSubsection ]
    #
    #Turn of the record load triggered script to speed
    #up this loop search.
    Set Variable [ $$ID; Value:"ignore" ]
    #
    #Go to the first record and then test it and every
    #other record until the test in question is found.
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ testSubsectionTemplate::_LtestSubsection = TEMP::ktestItemSubsection ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    #
    #Set a temp field with this test's name. This name
    #field will then be used to show this test's name on
    #the Tag Menus layout for setupTestItems.
    Set Field [ TEMP::ktestSubsectionName; testSubsectionTemplate::name ]
    #
    #go back to current test.
    Go to Record/Request/Page [ First ]
    Loop
    Exit Loop If [ testSubsectionTemplate::_LtestSubsection = $currentTest ]
    Go to Record/Request/Page [ Next; Exit after last ]
    End Loop
    Set Variable [ $$ID; Value:$currentTest ]
    Refresh Window
    #
    #make new and old tag keys identical, so when
    #a switch is made this copy can be used as the old key
    #in the first part of this script. Switching automatically
    #replaces the current key with whatever is selected,
    #thus the need to preserve a copy now, before a switch is made.
    Set Field [ TEMP::ktestItemSubsectionOLD; TEMP::ktestItemSubsection ]
    #
    #Update key used for the move pulldown to the new test.
    Set Field [ TEMP::mTag; TEMP::ktestItemSubsection ]
    #
    #return to tag layout and show all selected items
    Select Window [ Name: "Tag Menus"; Current file ]
    Go to Layout [ “setupTestItem” (tagMenus) ]
    Scroll Window [ Home ]
    Go to Field [ ]
    #
    #If list is empty, now tell the user this so they don't
    #think the system failed because nothing was found.
    If [ $emptyList = 1 ]
    Show Custom Dialog [ Message: "This test-item list contains no test items. You are welcome to create new ones."; Default Button: “OK”, Commit: “No” ]
    End If

Fields used in this script

    TEMP::ktestItemSubsection
    TEMP::ktestItemSubsectionOLD
    tagMenuTestItemGroup::match
    tagMenuTestItemGroup::orderOrLibraryType
    tagMenuTestItemGroup::_Lgroup
    tagMenus::orderOrLock
    tagMenus::tag
    testSubsectionTemplate::ktestItemGroup
    testSubsectionTemplate::_LtestSubsection
    testSubsectionTemplate::name
    TEMP::ktestSubsectionName
    TEMP::mTag

Scripts used in this script

Layouts used in this script

    setupTestItem

Tables used in this script

    TEMP
    tag
    tagGroup
    testSubsectionTemplate

Table occurrences used by this script

    TEMP
    tagMenuTestItemGroup
    tagMenus
    testSubsectionTemplate

Custom Functions used by this script

Custom menu set used by this script
